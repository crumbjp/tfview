!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=322)}([function(t,e,n){"use strict";var r={};n.r(r),n.d(r,"copyModel",(function(){return q})),n.d(r,"listModels",(function(){return L})),n.d(r,"moveModel",(function(){return W})),n.d(r,"removeModel",(function(){return P})),n.d(r,"browserFiles",(function(){return tt})),n.d(r,"browserHTTPRequest",(function(){return lt})),n.d(r,"concatenateArrayBuffers",(function(){return p.d})),n.d(r,"decodeWeights",(function(){return p.e})),n.d(r,"encodeWeights",(function(){return p.f})),n.d(r,"fromMemory",(function(){return ht})),n.d(r,"getLoadHandlers",(function(){return v})),n.d(r,"getModelArtifactsInfoForJSON",(function(){return p.g})),n.d(r,"getSaveHandlers",(function(){return y})),n.d(r,"http",(function(){return ct})),n.d(r,"isHTTPScheme",(function(){return st})),n.d(r,"loadWeights",(function(){return it})),n.d(r,"registerLoadRouter",(function(){return b})),n.d(r,"registerSaveRouter",(function(){return g})),n.d(r,"weightsLoaderFactory",(function(){return at})),n.d(r,"withSaveHandler",(function(){return pt}));var i={};n.r(i),n.d(i,"confusionMatrix",(function(){return xt}));var a={};n.r(a),n.d(a,"toPixels",(function(){return At})),n.d(a,"fromPixels",(function(){return Ct}));var o={};n.r(o),n.d(o,"prepareAndValidate",(function(){return Et}));var s={};n.r(s),n.d(s,"assertParamsValid",(function(){return jt})),n.d(s,"maskToAxes",(function(){return Nt})),n.d(s,"computeOutShape",(function(){return Tt})),n.d(s,"stridesWithElidedDims",(function(){return Ft})),n.d(s,"getNormalizedAxes",(function(){return Mt})),n.d(s,"startIndicesWithElidedDims",(function(){return $t})),n.d(s,"stopIndicesWithElidedDims",(function(){return Rt})),n.d(s,"stridesForAxis",(function(){return Bt})),n.d(s,"startForAxis",(function(){return zt})),n.d(s,"stopForAxis",(function(){return Lt})),n.d(s,"isSliceContinous",(function(){return Pt})),n.d(s,"computeFlatOffset",(function(){return qt})),n.d(s,"parseSliceParams",(function(){return Wt})),n.d(s,"sliceInfo",(function(){return Ut}));var u={};n.r(u),n.d(u,"Serializable",(function(){return Vt})),n.d(u,"SerializationMap",(function(){return Gt})),n.d(u,"registerClass",(function(){return Ht}));var c={};n.r(c),n.d(c,"segOpComputeOptimalWindowSize",(function(){return on})),n.d(c,"computeOutShape",(function(){return sn})),n.d(c,"collectGatherOpShapeInfo",(function(){return un}));var l={};n.r(l),n.d(l,"slice_util",(function(){return s})),n.d(l,"upcastType",(function(){return ve.c})),n.d(l,"prepareAndValidate",(function(){return Et})),n.d(l,"validateUpdateShape",(function(){return St.validateUpdateShape})),n.d(l,"validateInput",(function(){return St.validateInput})),n.d(l,"calculateShapes",(function(){return St.calculateShapes})),n.d(l,"segment_util",(function(){return c})),n.d(l,"castTensor",(function(){return cn})),n.d(l,"reshapeTensor",(function(){return ln})),n.d(l,"fromUint8ToStringArray",(function(){return dn})),n.d(l,"fromStringArrayToUint8",(function(){return fn})),n.d(l,"axesAreInnerMostDims",(function(){return Ce.b})),n.d(l,"combineLocations",(function(){return Ce.c})),n.d(l,"computeOutAndReduceShapes",(function(){return Ce.d})),n.d(l,"expandShapeToKeepDim",(function(){return Ce.e})),n.d(l,"assertAxesAreInnerMostDims",(function(){return Ce.a})),n.d(l,"getAxesPermutation",(function(){return Ce.f})),n.d(l,"getUndoAxesPermutation",(function(){return Ce.h})),n.d(l,"getInnerMostAxes",(function(){return Ce.g})),n.d(l,"getBroadcastDims",(function(){return Ee.b})),n.d(l,"getReductionAxes",(function(){return Ee.c})),n.d(l,"assertAndGetBroadcastShape",(function(){return Ee.a})),n.d(l,"assertParamsConsistent",(function(){return Se})),n.d(l,"computeOutShape",(function(){return je})),n.d(l,"computeDilation2DInfo",(function(){return Ne.d})),n.d(l,"computePool2DInfo",(function(){return Ne.e})),n.d(l,"computePool3DInfo",(function(){return Ne.f})),n.d(l,"computeConv2DInfo",(function(){return Ne.a})),n.d(l,"computeConv3DInfo",(function(){return Ne.b})),n.d(l,"computeDefaultPad",(function(){return Ne.c})),n.d(l,"tupleValuesAreOne",(function(){return Ne.i})),n.d(l,"eitherStridesOrDilationsAreOne",(function(){return Ne.h})),n.d(l,"convertConv2DDataFormat",(function(){return Ne.g})),n.d(l,"getFusedDyActivation",(function(){return Te.c})),n.d(l,"getFusedBiasGradient",(function(){return Te.b})),n.d(l,"applyActivation",(function(){return Te.a})),n.d(l,"shouldFuse",(function(){return Te.d})),n.d(l,"PARALLELIZE_THRESHOLD",(function(){return Fe})),n.d(l,"computeOptimalWindowSize",(function(){return De})),n.d(l,"getImageCenter",(function(){return Ie})),n.d(l,"getReshaped",(function(){return Me})),n.d(l,"getPermuted",(function(){return $e})),n.d(l,"getReshapedPermuted",(function(){return Re})),n.d(l,"getSliceBeginCoords",(function(){return Be})),n.d(l,"getSliceSize",(function(){return ze})),n.d(l,"SELU_SCALEALPHA",(function(){return Le})),n.d(l,"SELU_SCALE",(function(){return Pe})),n.d(l,"ERF_P",(function(){return qe})),n.d(l,"ERF_A1",(function(){return We})),n.d(l,"ERF_A2",(function(){return Ue})),n.d(l,"ERF_A3",(function(){return Ve})),n.d(l,"ERF_A4",(function(){return Ge})),n.d(l,"ERF_A5",(function(){return He})),n.d(l,"warn",(function(){return Xe})),n.d(l,"log",(function(){return Ke})),n.d(l,"mergeRealAndImagArrays",(function(){return Ye})),n.d(l,"splitRealAndImagArrays",(function(){return Je})),n.d(l,"complexWithEvenIndex",(function(){return Ze})),n.d(l,"complexWithOddIndex",(function(){return Qe})),n.d(l,"getComplexWithIndex",(function(){return tn})),n.d(l,"assignToTypedArray",(function(){return en})),n.d(l,"exponents",(function(){return nn})),n.d(l,"exponent",(function(){return rn})),n.d(l,"prepareSplitSize",(function(){return an}));var d={};n.r(d),n.d(d,"nonMaxSuppressionV3Impl",(function(){return pn.a})),n.d(d,"nonMaxSuppressionV4Impl",(function(){return pn.b})),n.d(d,"nonMaxSuppressionV5Impl",(function(){return pn.c})),n.d(d,"whereImpl",(function(){return mn.a}));var f=n(5),h=(n(150),n(23)),p=n(39);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class m{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==m.instance&&(m.instance=new m),m.instance}static registerSaveRouter(t){m.getInstance().saveRouters.push(t)}static registerLoadRouter(t){m.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return m.getHandlers(t,"save")}static getLoadHandlers(t,e){return m.getHandlers(t,"load",e)}static getHandlers(t,e,n){const r=[];return("load"===e?m.getInstance().loadRouters:m.getInstance().saveRouters).forEach(e=>{const i=e(t,n);null!==i&&r.push(i)}),r}}const g=t=>m.registerSaveRouter(t),b=t=>m.registerLoadRouter(t),y=t=>m.getSaveHandlers(t),v=(t,e)=>m.getLoadHandlers(t,e)
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */;function x(){if(!Object(h.c)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"==typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function w(t){const e=t.result;e.createObjectStore("models_store",{keyPath:"modelPath"}),e.createObjectStore("model_info_store",{keyPath:"modelPath"})}class k{constructor(t){if(this.indexedDB=x(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise((t,n)=>{const r=this.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=()=>w(r),r.onsuccess=()=>{const i=r.result;if(null==e){const e=i.transaction("models_store","readonly"),r=e.objectStore("models_store").get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return i.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));t(r.result.modelArtifacts)},r.onerror=t=>(i.close(),n(r.error)),e.oncomplete=()=>i.close()}else{const r=Object(p.g)(e),a=i.transaction("model_info_store","readwrite");let o=a.objectStore("model_info_store");const s=o.put({modelPath:this.modelPath,modelArtifactsInfo:r});let u;s.onsuccess=()=>{u=i.transaction("models_store","readwrite");const s=u.objectStore("models_store").put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:r});s.onsuccess=()=>t({modelArtifactsInfo:r}),s.onerror=t=>{o=a.objectStore("model_info_store");const e=o.delete(this.modelPath);e.onsuccess=()=>(i.close(),n(s.error)),e.onerror=t=>(i.close(),n(s.error))}},s.onerror=t=>(i.close(),n(s.error)),a.oncomplete=()=>{null==u?i.close():u.oncomplete=()=>i.close()}}},r.onerror=t=>n(r.error)})}}k.URL_SCHEME="indexeddb://";const O=t=>{return Object(h.c)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(k.URL_SCHEME)?(e=t.slice(k.URL_SCHEME.length),new k(e)):null;var e};m.registerSaveRouter(O),m.registerLoadRouter(O);class _{constructor(){this.indexedDB=x()}async listModels(){return new Promise((t,e)=>{const n=this.indexedDB.open("tensorflowjs",1);n.onupgradeneeded=()=>w(n),n.onsuccess=()=>{const r=n.result,i=r.transaction("model_info_store","readonly"),a=i.objectStore("model_info_store").getAll();a.onsuccess=()=>{const e={};for(const t of a.result)e[t.modelPath]=t.modelArtifactsInfo;t(e)},a.onerror=t=>(r.close(),e(a.error)),i.oncomplete=()=>r.close()},n.onerror=t=>e(n.error)})}async removeModel(t){var e;return t=(e=t).startsWith(k.URL_SCHEME)?e.slice(k.URL_SCHEME.length):e,new Promise((e,n)=>{const r=this.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=()=>w(r),r.onsuccess=()=>{const i=r.result,a=i.transaction("model_info_store","readwrite"),o=a.objectStore("model_info_store"),s=o.get(t);let u;s.onsuccess=()=>{if(null==s.result)return i.close(),n(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const r=o.delete(t),a=()=>{u=i.transaction("models_store","readwrite");const r=u.objectStore("models_store").delete(t);r.onsuccess=()=>e(s.result.modelArtifactsInfo),r.onerror=t=>n(s.error)};r.onsuccess=a,r.onerror=t=>(a(),i.close(),n(s.error))}},s.onerror=t=>(i.close(),n(s.error)),a.oncomplete=()=>{null==u?i.close():u.oncomplete=()=>i.close()}},r.onerror=t=>n(r.error)})}}var A=n(7);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C="tensorflowjs_models",E="info",S="model_topology",j="weight_specs",N="weight_data",T="model_metadata";function F(t){return{info:[C,t,E].join("/"),topology:[C,t,S].join("/"),weightSpecs:[C,t,j].join("/"),weightData:[C,t,N].join("/"),modelMetadata:[C,t,T].join("/")}}function D(t){const e=t.split("/");if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join("/")}class I{constructor(t){if(!Object(h.c)().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=F(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=Object(p.g)(t);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,Object(p.a)(t.weightData));const i={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};return null!=t.signature&&(i.signature=t.signature),null!=t.userDefinedMetadata&&(i.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(i.modelInitializer=t.modelInitializer),this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);e.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);e.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(null!=i){const t=JSON.parse(i);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,null!=t.signature&&(e.signature=t.signature),null!=t.userDefinedMetadata&&(e.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(e.modelInitializer=t.modelInitializer)}const a=this.LS.getItem(this.keys.weightData);if(null==a)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return e.weightData=Object(p.b)(a),e}}I.URL_SCHEME="localstorage://";const M=t=>{return Object(h.c)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(I.URL_SCHEME)?(e=t.slice(I.URL_SCHEME.length),new I(e)):null;var e};m.registerSaveRouter(M),m.registerLoadRouter(M);class ${constructor(){Object(A.b)(Object(h.c)().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),Object(A.b)("undefined"==typeof window||void 0!==window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},e=C+"/",n="/"+E;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(e)&&i.endsWith(n)){t[D(i)]=JSON.parse(this.LS.getItem(i))}}return t}async removeModel(t){var e;const n=F(t=(e=t).startsWith(I.URL_SCHEME)?e.slice(I.URL_SCHEME.length):e);if(null==this.LS.getItem(n.info))throw new Error(`Cannot find model at path '${t}'`);const r=JSON.parse(this.LS.getItem(n.info));return this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),r}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R{constructor(){this.managers={}}static getInstance(){return null==R.instance&&(R.instance=new R),R.instance}static registerManager(t,e){Object(A.b)(null!=t,()=>"scheme must not be undefined or null."),t.endsWith("://")&&(t=t.slice(0,t.indexOf("://"))),Object(A.b)(t.length>0,()=>"scheme must not be an empty string.");const n=R.getInstance();Object(A.b)(null==n.managers[t],()=>`A model store manager is already registered for scheme '${t}'.`),n.managers[t]=e}static getManager(t){const e=this.getInstance().managers[t];if(null==e)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(this.getInstance().managers)}}function B(t){if(-1===t.indexOf("://"))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+R.getSchemes().join(","));return{scheme:t.split("://")[0],path:t.split("://")[1]}}async function z(t,e,n=!1){Object(A.b)(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=m.getLoadHandlers(t);Object(A.b)(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),Object(A.b)(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const i=r[0],a=m.getSaveHandlers(e);Object(A.b)(a.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),Object(A.b)(a.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const o=a[0],s=B(t).scheme,u=B(t).path,c=s===B(t).scheme,l=await i.load();n&&c&&await R.getManager(s).removeModel(u);const d=await o.save(l);return n&&!c&&await R.getManager(s).removeModel(u),d.modelArtifactsInfo}async function L(){const t=R.getSchemes(),e={};for(const n of t){const t=await R.getManager(n).listModels();for(const r in t){e[n+"://"+r]=t[r]}}return e}async function P(t){const e=B(t);return R.getManager(e.scheme).removeModel(e.path)}async function q(t,e){return z(t,e,!1)}async function W(t,e){return z(t,e,!0)}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U{fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}}if(Object(h.c)().get("IS_BROWSER")){Object(h.c)().setPlatform("browser",new U);try{R.registerManager(I.URL_SCHEME,new $)}catch(t){}try{R.registerManager(k.URL_SCHEME,new _)}catch(t){}}n(357);var V=n(46),G=n(11),H=n(65),X=n(174),K=n(6);
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Object(f.b)();const Y={buffer:V.a,cast:G.a,clone:H.a,print:X.a};Object(K.e)(Y);function J(t){return new Promise(t=>setTimeout(t)).then(t)}class Z{constructor(t){if(!Object(h.c)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Z.URL_SCHEME)&&(t=t.slice(Z.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(t){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n};null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer);const i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),a=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor;if(a.download=this.modelTopologyFileName,a.href=i,await J(()=>a.dispatchEvent(new MouseEvent("click"))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=e,await J(()=>t.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Object(p.g)(t)}}}}Z.URL_SCHEME="downloads://";class Q{constructor(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}async load(){const t=this.files[0],e=this.files.slice(1);return new Promise((n,r)=>{const i=new FileReader;i.onload=i=>{const a=JSON.parse(i.target.result),o=a.modelTopology;if(null==o)return void r(new Error("modelTopology field is missing from file "+t.name));0===e.length&&n({modelTopology:o});const s=a.weightsManifest;if(null==s)return void r(new Error("weightManifest field is missing from file "+t.name));let u;try{u=this.checkManifestAndWeightFiles(s,e)}catch(t){return void r(t)}const c=[],l=[],d=[];s.forEach(t=>{t.paths.forEach(t=>{l.push(t),d.push(null)}),c.push(...t.weights)}),s.forEach(t=>{t.paths.forEach(t=>{const e=new FileReader;e.onload=e=>{const r=e.target.result,i=l.indexOf(t);if(d[i]=r,-1===d.indexOf(null)){const t={modelTopology:o,weightSpecs:c,weightData:Object(p.d)(d),format:a.format,generatedBy:a.generatedBy,convertedBy:a.convertedBy};null!=a.signature&&(t.signature=a.signature),null!=a.userDefinedMetadata&&(t.userDefinedMetadata=a.userDefinedMetadata),null!=a.modelInitializer&&(t.modelInitializer=a.modelInitializer),n(t)}},e.onerror=e=>r(`Failed to weights data from file of path '${t}'.`),e.readAsArrayBuffer(u[t])})})},i.onerror=e=>r(`Failed to read model topology and weights manifest JSON from file '${t.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),i.readAsText(t)})}checkManifestAndWeightFiles(t,e){const n=[],r=e.map(t=>Object(p.c)(t.name)),i={};for(const a of t)a.paths.forEach(t=>{const a=Object(p.c)(t);if(-1!==n.indexOf(a))throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),-1===r.indexOf(a))throw new Error(`Weight file with basename '${a}' is not provided.`);i[t]=e[r.indexOf(a)]});if(n.length!==e.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${e.length}).`);return i}}function tt(t){return new Q(t)}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function et(t,e,n,r){!function(t){Object(A.b)(null!=t&&Array.isArray(t)&&t.length>0,()=>"promises must be a none empty array")}(t),function(t,e){Object(A.b)(t>=0&&t<=1,()=>"Progress fraction must be in range [0, 1], but got startFraction "+t),Object(A.b)(e>=0&&e<=1,()=>"Progress fraction must be in range [0, 1], but got endFraction "+e),Object(A.b)(e>=t,()=>`startFraction must be no more than endFraction, but got startFraction ${t} and endFraction `+e)}(n=null==n?0:n,r=null==r?1:r);let i=0;return Promise.all(t.map(a=>(a.then(a=>{const o=n+ ++i/t.length*(r-n);return e(o),a}),a)))}m.registerSaveRouter(t=>Object(h.c)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Z.URL_SCHEME)?function(t="model"){return new Z(t)}(t.slice(Z.URL_SCHEME.length)):null);var nt=n(157);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function rt(t,e){null==e&&(e={});const n=null==e.fetchFunc?Object(h.c)().platform.fetch:e.fetchFunc,r=t.map(t=>n(t,e.requestInit,{isBinary:!0})),i=(null==e.onProgress?await Promise.all(r):await et(r,e.onProgress,0,.5)).map(t=>t.arrayBuffer());return null==e.onProgress?await Promise.all(i):await et(i,e.onProgress,.5,1)}async function it(t,e="",n,r){return at(t=>rt(t,{requestInit:r}))(t,e,n)}function at(t){return async(e,n="",r)=>{const i=e.map(()=>!1),a={},o=null!=r?r.map(()=>!1):[],s=[];if(e.forEach((t,e)=>{let n=0;t.weights.forEach(t=>{const u="quantization"in t?t.quantization.dtype:t.dtype,c=nt.a[u]*A.N(t.shape),l=()=>{i[e]=!0,null==a[e]&&(a[e]=[]),a[e].push({manifestEntry:t,groupOffset:n,sizeBytes:c})};null!=r?r.forEach((e,n)=>{e===t.name&&(l(),o[n]=!0)}):l(),s.push(t.name),n+=c})}),!o.every(t=>t)){const t=r.filter((t,e)=>!o[e]);throw new Error("Could not find weights in manifest with names: "+t.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".")}const u=i.reduce((t,e,n)=>(e&&t.push(n),t),[]),c=[];u.forEach(t=>{e[t].paths.forEach(t=>{const e=n+(n.endsWith("/")?"":"/")+t;c.push(e)})});const l=await t(c),d={};let f=0;return u.forEach(t=>{const n=e[t].paths.length;let r=0;for(let t=0;t<n;t++)r+=l[f+t].byteLength;const i=new ArrayBuffer(r),o=new Uint8Array(i);let s=0;for(let t=0;t<n;t++){const e=new Uint8Array(l[f+t]);o.set(e,s),s+=e.byteLength}a[t].forEach(t=>{const e=i.slice(t.groupOffset,t.groupOffset+t.sizeBytes),n=Object(p.e)(e,[t.manifestEntry]);for(const t in n)d[t]=n[t]}),f+=n}),d}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ot{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?(Object(A.b)("function"==typeof e.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=e.fetchFunc):this.fetch=Object(h.c)().platform.fetch,Object(A.b)(null!=t&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&Object(A.b)(2===t.length,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n};null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer),e.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin");const i=await this.fetch(this.path,e);if(i.ok)return{modelArtifactsInfo:Object(p.g)(t),responses:[i]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}async load(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code `+t.status+". Please verify this URL points to the model JSON of the model to load.");let e;try{e=await t.json()}catch(t){let e=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?e+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":e+=" Please make sure the server is serving valid JSON for this request.",new Error(e)}const n=e.modelTopology,r=e.weightsManifest,i=e.generatedBy,a=e.convertedBy,o=e.format,s=e.signature,u=e.userDefinedMetadata;if(null==n&&null==r)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);let c,l;if(null!=r){const t=await this.loadWeights(r);[c,l]=t}const d={modelTopology:n,weightSpecs:c,weightData:l,generatedBy:i,convertedBy:a,format:o};null!=s&&(d.signature=s),null!=u&&(d.userDefinedMetadata=u);const f=e.modelInitializer;return f&&(d.modelInitializer=f),d}async loadWeights(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),i=n>e?t.substring(n):"";return[r+"/",i]}(e),i=this.weightPathPrefix||n,a=[];for(const e of t)a.push(...e.weights);const o=[],s=[];for(const e of t)for(const t of e.paths)null!=this.weightUrlConverter?s.push(this.weightUrlConverter(t)):o.push(i+t+r);this.weightUrlConverter&&o.push(...await Promise.all(s));const u=await rt(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[a,Object(p.d)(u)]}}function st(t){return null!=t.match(ot.URL_SCHEME_REGEX)}ot.URL_SCHEME_REGEX=/^https?:\/\//;const ut=(t,e)=>{if("undefined"==typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every(t=>st(t)):st(t),n)return ct(t,e)}return null};function ct(t,e){return new ot(t,e)}function lt(t,e){return ct(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */m.registerSaveRouter(ut),m.registerLoadRouter(ut);class dt{constructor(t){this.modelArtifacts=t}async load(){return this.modelArtifacts}}class ft{constructor(t){this.saveHandler=t}async save(t){return this.saveHandler(t)}}function ht(t,e,n,r){if(1===arguments.length){return null!=t.modelTopology||null!=t.weightSpecs?new dt(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new dt({modelTopology:t}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new dt({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r})}function pt(t){return new ft(t)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var mt=n(1),gt=n(26),bt=n(111),yt=n(4),vt=n(50);const xt=Object(yt.b)({confusionMatrix_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n){const r=Object(mt.a)(t,"labels","confusionMatrix"),i=Object(mt.a)(e,"predictions","confusionMatrix");A.b(null==n||n>0&&Number.isInteger(n),()=>"If provided, numClasses must be a positive integer, but got "+n),A.b(1===r.rank,()=>"Expected the rank of labels to be 1, but got "+r.rank),A.b(1===i.rank,()=>"Expected the rank of predictions to be 1, but got "+i.rank),A.b(r.shape[0]===i.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${i.shape[0]}. Labels and predictions should have the same number of elements.`),A.b(n>0&&Number.isInteger(n),()=>"numClasses is required to be a positive integer, but got "+n);const a=Object(bt.a)(Object(G.a)(r,"int32"),n),o=Object(bt.a)(Object(G.a)(i,"int32"),n),s=Object(vt.a)(a),u=Object(gt.a)(s,o);return Object(G.a)(u,"int32")}});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wt=n(3),kt=n(67),Ot=n(201);
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
let _t;async function At(t,e){let n=Object(mt.a)(t,"img","toPixels");if(!(t instanceof K.a)){const t=n;n=Object(G.a)(t,"int32"),t.dispose()}if(2!==n.rank&&3!==n.rank)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const[r,i]=n.shape.slice(0,2),a=2===n.rank?1:n.shape[2];if(a>4||2===a)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);if("float32"!==n.dtype&&"int32"!==n.dtype)throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`);const o=await n.data(),s="float32"===n.dtype?255:1,u=new Uint8ClampedArray(i*r*4);for(let t=0;t<r*i;++t){const e=[0,0,0,255];for(let r=0;r<a;r++){const i=o[t*a+r];if("float32"===n.dtype){if(i<0||i>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${i}.`)}else if("int32"===n.dtype&&(i<0||i>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${i}.`);1===a?(e[0]=i*s,e[1]=i*s,e[2]=i*s):e[r]=i*s}const r=4*t;u[r+0]=Math.round(e[0]),u[r+1]=Math.round(e[1]),u[r+2]=Math.round(e[2]),u[r+3]=Math.round(e[3])}if(null!=e){e.width=i,e.height=r;const t=e.getContext("2d"),n=new ImageData(u,i,r);t.putImageData(n,0,0)}return n!==t&&n.dispose(),u}const Ct=Object(yt.b)({fromPixels_:function(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,a=!1,o=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement)i=!0;else if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement)a=!0;else{if(null==t.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);o=!0}if(i){const e=2;if(i&&t.readyState<e)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}if(null!=Object(kt.c)(wt.hb,f.a.backendName)){const n={pixels:t},r={numChannels:e};return f.a.runKernel(wt.hb,n,r)}const[s,u]=i?[t.videoWidth,t.videoHeight]:[t.width,t.height];let c,l;if(o?c=t.getContext("2d").getImageData(0,0,s,u).data:r||n?c=t.data:(a||i)&&(null==_t&&(_t=document.createElement("canvas").getContext("2d")),_t.canvas.width=s,_t.canvas.height=u,_t.drawImage(t,0,0,s,u),c=_t.getImageData(0,0,s,u).data),4===e)l=new Int32Array(c);else{const t=s*u;l=new Int32Array(t*e);for(let n=0;n<t;n++)for(let t=0;t<e;++t)l[n*e+t]=c[4*n+t]}const d=[u,s,e];return Object(Ot.a)(l,d,"int32")}});function Et(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==e.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(0===Object(A.N)(t.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const i=e.shape,a=i[i.length-1];let o=1;for(let t=0;t<i.length-1;++t)o*=i[t];const s=t.shape,u=i.slice();u.pop();let c=1;for(let t=a;t<n;++t)c*=s[t],u.push(s[t]);const l=[...Object(A.j)(t.shape).map(t=>t/c),1].slice(0,a);return[u,o,c,l]}var St=n(122);
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jt(t,e,n){const r=t.shape.length;A.b(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),A.b(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let i=0;i<r;++i)A.b(e[i]+n[i]<=t.shape[i],()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${e[i]+n[i]}) would overflow input.shape[${i}] (${t.shape[i]})`)}function Nt(t){const e=[];let n=0;for(;t>0;)1&t&&e.push(n),t/=2,n++;return e}function Tt(t,e,n){const r=[];for(let i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function Ft(t,e,n,r){const i=[...t];for(let t=i.length;t<r.length;t++)i.push(1);for(let t=0;t<n;t++)0===t?i[e]=1:(i.splice(e,0,1),i.pop());return i}function Dt(t,e,n){return n<=t?n:n-(e-1)}function It(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function Mt(t,e,n,r,i,a,o,s,u){const c=t.length;let l=new Array(c),d=new Array(c),f=new Array(c);if(e.length&&n>0){const u=e[0],c=n+1;l=$t(o,u,c,r,t),d=Rt(s,u,c,i,t),f=Ft(a,u,c,t)}else for(let e=0;e<c;e++)l[e]=zt(o,r,a,t,e,u),d[e]=Lt(s,i,a,t,e,u),f[e]=Bt(a,e,u);return{begin:l,end:d,strides:f}}function $t(t,e,n,r,i){const a=[...i],o=It(n,e);for(let i=0;i<a.length;i++)if(o.indexOf(i)>-1)a[i]=0;else{const o=Dt(e,n,i);let s=r[o];t&1<<o&&(s=0),a[i]=s}return a}function Rt(t,e,n,r,i){const a=[...i],o=It(n,e);for(let i=0;i<a.length;i++)if(o.indexOf(i)>-1)a[i]=Number.MAX_SAFE_INTEGER;else{const o=Dt(e,n,i);let s=r[o];t&1<<o&&(s=Number.MAX_SAFE_INTEGER),a[i]=s}for(let t=0;t<a.length;t++){const e=i[t];a[t]<0&&(a[t]+=e),a[t]=A.i(0,a[t],i[t])}return a}function Bt(t,e,n){let r=t[e];return(n&1<<e||null==r)&&(r=1),r}function zt(t,e,n,r,i,a){let o=e[i];const s=n[i]||1;(t&1<<i||a&1<<i||null==o)&&(o=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const u=r[i];return o<0&&(o+=u),o=A.i(0,o,u-1),o}function Lt(t,e,n,r,i,a){let o=e[i];const s=n[i]||1;(t&1<<i||a&1<<i||null==o)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const u=r[i];return o<0&&(o+=u),o=s>0?A.i(0,o,u):A.i(-1,o,u-1),o}function Pt(t,e,n){let r=n.length;for(let t=0;t<n.length;t++)if(n[t]>1){r=t;break}for(let i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function qt(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function Wt(t,e,n){let r;const i=t.shape.length;let a;return r="number"==typeof e?[e,...new Array(i-1).fill(0)]:e.length<i?e.concat(new Array(i-e.length).fill(0)):e.slice(),r.forEach(t=>{A.b(-1!==t,()=>"slice() does not support negative begin indexing.")}),a=null==n?new Array(i).fill(-1):"number"==typeof n?[n,...new Array(i-1).fill(-1)]:n.length<i?n.concat(new Array(i-n.length).fill(-1)):n,a=a.map((e,n)=>e>=0?e:(A.b(-1===e,()=>`Negative size values should be exactly -1 but got ${e} for the slice() size at index ${n}.`),t.shape[n]-r[n])),[r,a]}function Ut(t,e,n,r,i,a,o,s,u){let c=e.slice(),l=n.slice(),d=r;null==r&&(d=new Array(c.length));const f=Nt(o);if(f.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==o&&0!==s)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==o&&0!==u)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");const h=t.length-c.length,p=Nt(s),m=t.slice();p.forEach(t=>{c[t]=0,l[t]=1,m.splice(t,0,1)});const{begin:g,end:b,strides:y}=Mt(m,f,h,c,l,d,i,a,o);c=g,l=b,d=y;const v=Nt(u);v.forEach(t=>{l[t]=c[t]+1,d[t]=1});const x=Tt(c,l,d),w=x.filter((t,e)=>-1===v.indexOf(e));return{nonStrided:d.every(t=>1===t),$begin:c,$end:l,$strides:d,size:x,newShape:m,outShape:w}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vt{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class Gt{constructor(){this.classNameMap={}}static getMap(){return null==Gt.instance&&(Gt.instance=new Gt),Gt.instance}static register(t){Gt.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function Ht(t){Object(A.b)(null!=t.className,()=>"Class being registered does not have the static className property defined."),Object(A.b)("string"==typeof t.className,()=>"className is required to be a string, but got type "+typeof t.className),Object(A.b)(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),Gt.register(t)}var Xt=n(22),Kt=n(143),Yt=n(10);var Jt=n(19),Zt=n(12),Qt=n(14),te=n(9),ee=n(37),ne=n(24),re=n(21),ie=n(34),ae=n(15);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class oe extends Vt{minimize(t,e=!1,n){const{value:r,grads:i}=this.computeGradients(t,n);if(null!=n){const t=n.map(t=>({name:t.name,tensor:i[t.name]}));this.applyGradients(t)}else this.applyGradients(i);return Object(Jt.d)(i),e?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return Object(ie.f)(t,e)}dispose(){null!=this.iterations_&&Object(Jt.d)(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:Object(ae.a)(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(oe,Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class se extends oe{constructor(t,e,n=null){super(),this.learningRate=t,this.rho=e,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=f.a.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=f.a.registeredVariables[e];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:e+"/accum_grad",variable:Object(Jt.t)(()=>Object(re.a)(r).variable(!1))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:e+"/accum_var",variable:Object(Jt.t)(()=>Object(re.a)(r).variable(!1))});const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const a=this.accumulatedGrads[n].variable,o=this.accumulatedUpdates[n].variable;Object(Jt.t)(()=>{const t=Object(Zt.a)(Object(te.a)(a,this.rho),Object(te.a)(Object(ne.a)(i),1-this.rho)),e=Object(te.a)(Object(Qt.a)(Object(ee.a)(Object(Zt.a)(o,this.epsilon)),Object(ee.a)(Object(Zt.a)(a,this.epsilon))),i),n=Object(Zt.a)(Object(te.a)(o,this.rho),Object(te.a)(Object(ne.a)(e),1-this.rho));a.assign(t),o.assign(n);const s=Object(Zt.a)(Object(te.a)(e,-this.learningRate),r);r.assign(s)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(Object(Jt.d)(this.accumulatedGrads.map(t=>t.variable)),Object(Jt.d)(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){const e=(t=await this.extractIterations(t)).length/2;this.accumulatedGrads=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.accumulatedUpdates=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}se.className="Adadelta",Ht(se);var ue=n(124);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ce extends oe{constructor(t,e=.1){super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=f.a.registeredVariables[e];if(null==this.accumulatedGrads[n]){const t=!1;this.accumulatedGrads[n]={originalName:e+"/accumulator",variable:Object(Jt.t)(()=>Object(ue.a)(r.shape,this.initialAccumulatorValue).variable(t))}}const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const a=this.accumulatedGrads[n].variable;Object(Jt.t)(()=>{const t=Object(Zt.a)(a,Object(ne.a)(i));a.assign(t);const e=Object(Zt.a)(Object(te.a)(Object(Qt.a)(i,Object(ee.a)(Object(Zt.a)(t,f.a.backend.epsilon()))),-this.learningRate),r);r.assign(e)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&Object(Jt.d)(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);this.accumulatedGrads=t.map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}ce.className="Adagrad",Ht(ce);var le=n(47),de=n(13);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class fe extends oe{constructor(t,e,n,r=null){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Object(Jt.t)(()=>{this.accBeta1=Object(ae.a)(e).variable(),this.accBeta2=Object(ae.a)(n).variable()}),null==r&&(this.epsilon=f.a.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);Object(Jt.t)(()=>{const n=Object(de.a)(1,this.accBeta1),r=Object(de.a)(1,this.accBeta2);e.forEach((e,i)=>{const a=f.a.registeredVariables[e];null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:e+"/m",variable:Object(Jt.t)(()=>Object(re.a)(a).variable(!1))}),null==this.accumulatedSecondMoment[i]&&(this.accumulatedSecondMoment[i]={originalName:e+"/v",variable:Object(Jt.t)(()=>Object(re.a)(a).variable(!1))});const o=Array.isArray(t)?t[i].tensor:t[e];if(null==o)return;const s=this.accumulatedFirstMoment[i].variable,u=this.accumulatedSecondMoment[i].variable,c=Object(Zt.a)(Object(te.a)(s,this.beta1),Object(te.a)(o,1-this.beta1)),l=Object(Zt.a)(Object(te.a)(u,this.beta2),Object(te.a)(Object(ne.a)(o),1-this.beta2)),d=Object(Qt.a)(c,n),h=Object(Qt.a)(l,r);s.assign(c),u.assign(l);const p=Object(Zt.a)(Object(te.a)(Object(Qt.a)(d,Object(Zt.a)(Object(ee.a)(h),this.epsilon)),-this.learningRate),a);a.assign(p)}),this.accBeta1.assign(Object(te.a)(this.accBeta1,this.beta1)),this.accBeta2.assign(Object(te.a)(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Object(Jt.d)(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedSecondMoment&&Object(Jt.d)(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t),Object(Jt.t)(()=>{this.accBeta1.assign(Object(le.a)(this.beta1,this.iterations_+1)),this.accBeta2.assign(Object(le.a)(this.beta2,this.iterations_+1))});const e=t.length/2;this.accumulatedFirstMoment=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.accumulatedSecondMoment=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}fe.className="Adam",Ht(fe);var he=n(42),pe=n(77);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class me extends oe{constructor(t,e,n,r=null,i=0){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Object(Jt.t)(()=>{this.iteration=Object(ae.a)(0).variable(),this.accBeta1=Object(ae.a)(e).variable()}),null==r&&(this.epsilon=f.a.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);Object(Jt.t)(()=>{const n=Object(de.a)(1,this.accBeta1),r=Object(Qt.a)(-this.learningRate,Object(Zt.a)(Object(te.a)(this.iteration,this.decay),1));e.forEach((e,i)=>{const a=f.a.registeredVariables[e];null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:e+"/m",variable:Object(re.a)(a).variable(!1)}),null==this.accumulatedWeightedInfNorm[i]&&(this.accumulatedWeightedInfNorm[i]={originalName:e+"/v",variable:Object(re.a)(a).variable(!1)});const o=Array.isArray(t)?t[i].tensor:t[e];if(null==o)return;const s=this.accumulatedFirstMoment[i].variable,u=this.accumulatedWeightedInfNorm[i].variable,c=Object(Zt.a)(Object(te.a)(s,this.beta1),Object(te.a)(o,1-this.beta1)),l=Object(te.a)(u,this.beta2),d=Object(he.a)(o),h=Object(pe.a)(l,d);s.assign(c),u.assign(h);const p=Object(Zt.a)(Object(te.a)(Object(Qt.a)(r,n),Object(Qt.a)(c,Object(Zt.a)(h,this.epsilon))),a);a.assign(p)}),this.iteration.assign(Object(Zt.a)(this.iteration,1)),this.accBeta1.assign(Object(te.a)(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Object(Jt.d)(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedWeightedInfNorm&&Object(Jt.d)(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}me.className="Adamax",Ht(me);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ge extends oe{constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=Array.isArray(t)?t[n].tensor:t[e];if(null==r)return;const i=f.a.registeredVariables[e];Object(Jt.t)(()=>{const t=Object(Zt.a)(Object(te.a)(this.c,r),i);i.assign(t)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=Object(Jt.l)(Object(ae.a)(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(0!==(t=await this.extractIterations(t)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}ge.className="SGD",Ht(ge);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class be extends ge{constructor(t,e,n=!1){super(t),this.learningRate=t,this.momentum=e,this.useNesterov=n,this.accumulations=[],this.m=Object(ae.a)(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=f.a.registeredVariables[e];if(null==this.accumulations[n]){const t=!1;this.accumulations[n]={originalName:e+"/momentum",variable:Object(Jt.t)(()=>Object(re.a)(r).variable(t))}}const i=this.accumulations[n].variable,a=Array.isArray(t)?t[n].tensor:t[e];null!=a&&Object(Jt.t)(()=>{let t;const e=Object(Zt.a)(Object(te.a)(this.m,i),a);t=this.useNesterov?Object(Zt.a)(Object(te.a)(this.c,Object(Zt.a)(a,Object(te.a)(e,this.m))),r):Object(Zt.a)(Object(te.a)(this.c,e),r),i.assign(e),r.assign(t)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&Object(Jt.d)(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);this.accumulations=t.map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}be.className="Momentum",Ht(be);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ye extends oe{constructor(t,e=.9,n=0,r=null,i=!1){if(super(),this.learningRate=t,this.decay=e,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,null==r&&(this.epsilon=f.a.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=f.a.registeredVariables[e];null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:e+"/rms",variable:Object(Jt.t)(()=>Object(re.a)(r).variable(!1))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:e+"/momentum",variable:Object(Jt.t)(()=>Object(re.a)(r).variable(!1))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:e+"/mg",variable:Object(Jt.t)(()=>Object(re.a)(r).variable(!1))});const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const a=this.accumulatedMeanSquares[n].variable,o=this.accumulatedMoments[n].variable;Object(Jt.t)(()=>{const t=Object(Zt.a)(Object(te.a)(a,this.decay),Object(te.a)(Object(ne.a)(i),1-this.decay));if(this.centered){const e=this.accumulatedMeanGrads[n].variable,s=Object(Zt.a)(Object(te.a)(e,this.decay),Object(te.a)(i,1-this.decay)),u=Object(Qt.a)(Object(te.a)(i,this.learningRate),Object(ee.a)(Object(de.a)(t,Object(Zt.a)(Object(ne.a)(s),this.epsilon)))),c=Object(Zt.a)(Object(te.a)(o,this.momentum),u);a.assign(t),e.assign(s),o.assign(c);const l=Object(de.a)(r,c);r.assign(l)}else{const t=Object(Zt.a)(Object(te.a)(a,this.decay),Object(te.a)(Object(ne.a)(i),1-this.decay)),e=Object(Zt.a)(Object(te.a)(o,this.momentum),Object(Qt.a)(Object(te.a)(i,this.learningRate),Object(ee.a)(Object(Zt.a)(t,this.epsilon))));a.assign(t),o.assign(e);const n=Object(de.a)(r,e);r.assign(n)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&Object(Jt.d)(this.accumulatedMeanSquares.map(t=>t.variable)),null!=this.accumulatedMeanGrads&&this.centered&&Object(Jt.d)(this.accumulatedMeanGrads.map(t=>t.variable)),null!=this.accumulatedMoments&&Object(Jt.d)(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2;this.accumulatedMeanSquares=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.accumulatedMoments=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}ye.className="RMSProp",Ht(ye);var ve=n(96),xe=n(17),we=n(35);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ke{static sgd(t){return new ge(t)}static momentum(t,e,n=!1){return new be(t,e,n)}static rmsprop(t,e=.9,n=0,r=null,i=!1){return new ye(t,e,n,r,i)}static adam(t=.001,e=.9,n=.999,r=null){return new fe(t,e,n,r)}static adadelta(t=.001,e=.95,n=null){return new se(t,e,n)}static adamax(t=.002,e=.9,n=.999,r=null,i=0){return new me(t,e,n,r,i)}static adagrad(t,e=.1){return new ce(t,e)}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oe={sgd:ke.sgd,momentum:ke.momentum,adadelta:ke.adadelta,adagrad:ke.adagrad,rmsprop:ke.rmsprop,adamax:ke.adamax,adam:ke.adam};var _e=n(284),Ae=n(64),Ce=n(38),Ee=n(16);
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Se(t,e){const n=t[0].length;t.forEach((t,e)=>{A.b(t.length===n,()=>`Error in concat${n}D: rank of tensors[${e}] must be the same as the rank of the rest (${n})`)}),A.b(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((t,i)=>{for(let a=0;a<n;a++)A.b(a===e||t[a]===r[a],()=>`Error in concat${n}D: Shape of tensors[${i}] (${t}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function je(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}var Ne=n(27),Te=n(43);
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Fe=30;function De(t){return t<=Fe?t:Object(A.G)(t,Math.floor(Math.sqrt(t)))}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ie(t,e,n){return[n*("number"==typeof t?t:t[0]),e*("number"==typeof t?t:t[1])]}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Me(t,e,n,r=!0){let i=[];if(r)i=i.concat(e.slice(0)),i.push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);const n=e.length;for(let r=0;r<n;++r)i=i.concat([t[r+1]/e[r],e[r]]);i=i.concat(t.slice(n+1))}return i}function $e(t,e,n=!0){const r=[];if(n){r.push(e);for(let n=e+1;n<t;++n)n<=2*e?(r.push(n),r.push(n-(e+1))):r.push(n)}else{const n=[],i=[];for(let r=1;r<t;++r)r>=2*e+1||r%2==1?i.push(r):n.push(r);r.push(...n),r.push(0),r.push(...i)}return r}function Re(t,e,n,r=!0){const i=[];r?i.push(t[0]/n):i.push(t[0]*n);for(let n=1;n<t.length;++n)n<=e.length?r?i.push(e[n-1]*t[n]):i.push(t[n]/e[n-1]):i.push(t[n]);return i}function Be(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function ze(t,e,n){const r=t.slice(0,1);for(let i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Le=1.7580993408473768,Pe=1.0507009873554805,qe=.3275911,We=.254829592,Ue=-.284496736,Ve=1.421413741,Ge=-1.453152027,He=1.061405429;
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Xe(...t){Object(h.c)().getBool("IS_TEST")||console.warn(...t)}function Ke(...t){Object(h.c)().getBool("IS_TEST")||console.log(...t)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ye(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(2*t.length);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function Je(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function Ze(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let e=0;e<t.length;e+=4)n[Math.floor(e/4)]=t[e],r[Math.floor(e/4)]=t[e+1];return{real:n,imag:r}}function Qe(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let e=2;e<t.length;e+=4)n[Math.floor(e/4)]=t[e],r[Math.floor(e/4)]=t[e+1];return{real:n,imag:r}}function tn(t,e){return{real:t[2*e],imag:t[2*e+1]}}function en(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function nn(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let i=0;i<Math.ceil(t/2);i++){const a=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:n,imag:r}}function rn(t,e,n){const r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function an(t,e,n=0){let r=[];if("number"==typeof e)Object(A.b)(t.shape[n]%e==0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const i=e.reduce((t,e)=>(-1===e&&(t+=1),t),0);Object(A.b)(i<=1,()=>"There should be only one negative value in split array.");const a=e.indexOf(-1);if(-1!==a){const r=e.reduce((t,e)=>e>0?t+e:t);e[a]=t.shape[n]-r}Object(A.b)(t.shape[n]===e.reduce((t,e)=>t+e),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function on(t,e){let n,r=!1;for(t<=Fe?(n=t,r=!0):n=Object(A.G)(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=Object(A.G)(t,n+1);return n}function sn(t,e,n){const r=[],i=t.length;for(let a=0;a<i;a++)a!==e?r.push(t[a]):r.push(n);return r}function un(t,e,n,r){const i=e.shape.length,a=t.shape.length;if(0!==r&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>a)throw new Error(`batchDims (${r}) must be less than rank(x) (\n    ${a}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let n=0;n<r;++n)if(t.shape[n]!==e.shape[n])throw new Error(`x.shape[${n}]: ${t.shape[n]} should be equal to indices.shape[${n}]: ${e.shape[n]}.`);const o=t.shape[n],s=[];let u=1,c=1,l=1;for(let e=0;e<r;++e)s.push(t.shape[e]),u*=t.shape[e];for(let e=r;e<n;e++)s.push(t.shape[e]),c*=t.shape[e];for(let t=r;t<i;t++)s.push(e.shape[t]);for(let e=n+1;e<a;e++)s.push(t.shape[e]),l*=t.shape[e];return{batchSize:u,sliceSize:l,outerSize:c,dimSize:o,outputShape:s}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cn(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();const e=Object(Ae.a)(t.shape),r=Object(G.a)(t,"float32"),i=n.complex(r,e);return e.dispose(),r.dispose(),i}if(!Object(A.p)(t.dtype,e))return f.a.makeTensorFromDataId(t.dataId,t.shape,e);if("complex64"===t.dtype){const r=n.real(t),i=Object(G.a)(r,e);return r.dispose(),i}if("int32"===e)return n.int(t);if("bool"===e){const e=Object(ae.a)(0,t.dtype),r=n.notEqual(t,e);return e.dispose(),r}throw new Error(`Error in Cast: failed to cast ${t.dtype} to ${e}`)}function ln(t,e){return f.a.makeTensorFromDataId(t.dataId,e,t.dtype)}function dn(t){try{return t.map(t=>Object(Yt.decodeString)(t))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8, error: "+t)}}function fn(t){return t.map(t=>Object(Yt.encodeString)(t))}var hn=n(173),pn=n(76),mn=n(205),gn=n(153),bn=n(82);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const yn={kernelName:wt.a,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(te.a)(t,Object(bn.a)(Object(G.a)(n,"float32"),-1))}}};var vn=n(28);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xn={kernelName:wt.b,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Object(ne.a)(Object(G.a)(n,"float32")),r=Object(ee.a)(Object(de.a)(Object(ae.a)(1),e));return Object(vn.a)(Object(Qt.a)(t,r))}}}},wn={kernelName:wt.c,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Object(ee.a)(Object(de.a)(Object(ne.a)(Object(G.a)(n,"float32")),1));return Object(Qt.a)(t,e)}}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var kn=n(8),On=n(18);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const _n={kernelName:wt.d,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=Ee.a(n.shape,r.shape);return{a:()=>{let e=t;const r=Ee.c(n.shape,i);return r.length>0&&(e=Object(On.a)(e,r)),Object(kn.a)(e,n.shape)},b:()=>{let e=t;const n=Ee.c(r.shape,i);return n.length>0&&(e=Object(On.a)(e,n)),Object(kn.a)(e,r.shape)}}}},An={kernelName:wt.e,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((e,r)=>{n[r]=()=>t.clone()}),n}},Cn={kernelName:wt.h,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(re.a)(n)}}},En={kernelName:wt.i,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(re.a)(n)}}},Sn={kernelName:wt.j,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Qt.a)(t,Object(ee.a)(Object(de.a)(Object(ae.a)(1),Object(ne.a)(Object(G.a)(n,"float32")))))}}},jn={kernelName:wt.k,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Object(ee.a)(Object(Zt.a)(Object(ae.a)(1),Object(ne.a)(Object(G.a)(n,"float32"))));return Object(Qt.a)(t,e)}}}},Nn={kernelName:wt.m,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=Object(Ee.a)(n.shape,r.shape);return{a:()=>{const e=Object(Zt.a)(Object(ne.a)(n),Object(ne.a)(r));let a=Object(te.a)(t,Object(Qt.a)(r,e));const o=Object(Ee.c)(n.shape,i);return o.length>0&&(a=Object(On.a)(a,o)),Object(kn.a)(a,n.shape)},b:()=>{const e=Object(Zt.a)(Object(ne.a)(n),Object(ne.a)(r));let a=Object(vn.a)(Object(te.a)(t,Object(Qt.a)(n,e)));const o=Object(Ee.c)(r.shape,i);return o.length>0&&(a=Object(On.a)(a,o)),Object(kn.a)(a,r.shape)}}}},Tn={kernelName:wt.l,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Qt.a)(t,Object(Zt.a)(Object(ne.a)(Object(G.a)(n,"float32")),1))}}},Fn={kernelName:wt.n,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Qt.a)(t,Object(de.a)(Object(ae.a)(1),Object(ne.a)(Object(G.a)(n,"float32"))))}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dn=Object(yt.b)({avgPool3dGrad_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,r,i=[1,1,1],a,o){const s=Object(mt.a)(t,"dy","avgPool3dGrad"),u=Object(mt.a)(e,"input","avgPool3dGrad");let c=s,l=u,d=!1;4===u.rank&&(d=!0,c=Object(kn.a)(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),l=Object(kn.a)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),A.b(5===c.rank,()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+c.rank+"."),A.b(5===l.rank,()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+l.rank+"."),A.b(Ne.h(r,i),()=>`Error in avgPool3dGrad: Either strides or dilations must be 1. Got strides ${r} and dilations '${i}'`),null!=o&&A.b(A.v(a),()=>`Error in avgPool3dGrad: pad must be an integer when using, dimRoundingMode ${o} but got pad ${a}.`);const h={dy:c,input:l},p={filterSize:n,strides:r,dilations:i,pad:a,dimRoundingMode:o},m=f.a.runKernel(wt.q,h,p);return d?Object(kn.a)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),In={kernelName:wt.p,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:i,strides:a,dilations:o,pad:s,dimRoundingMode:u}=n,c=null==o?[1,1,1]:o;return{x:()=>Dn(t,r,i,a,c,s,u)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mn=Object(yt.b)({avgPoolGrad_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,r,i){const a=Object(mt.a)(t,"dy","avgPoolGrad"),o=Object(mt.a)(e,"input","avgPoolGrad");A.b(o.rank===a.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${a.rank})`);let s=o,u=a,c=!1;3===o.rank&&(c=!0,s=Object(kn.a)(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=Object(kn.a)(a,[1,a.shape[0],a.shape[1],a.shape[2]])),A.b(4===u.rank,()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+u.rank+"."),A.b(4===s.rank,()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+s.rank+".");const l={dy:u,input:s},d={filterSize:n,strides:r,pad:i},h=f.a.runKernel(wt.r,l,d);return c?Object(kn.a)(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),$n={kernelName:wt.o,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:i,strides:a,pad:o}=n;return{x:()=>Mn(t,r,i,a,o)}}},Rn={kernelName:wt.s,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,i]=e,{transposeA:a,transposeB:o}=n;return a||o?!a&&o?{a:()=>Object(gt.a)(t,i,!1,!1),b:()=>Object(gt.a)(t,r,!0,!1)}:a&&!o?{a:()=>Object(gt.a)(i,t,!1,!0),b:()=>Object(gt.a)(r,t,!1,!1)}:{a:()=>Object(gt.a)(i,t,!0,!0),b:()=>Object(gt.a)(t,r,!0,!0)}:{a:()=>Object(gt.a)(t,i,!1,!0),b:()=>Object(gt.a)(r,t,!0,!1)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Bn=n(103);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zn={kernelName:wt.t,gradFunc:(t,e,n)=>{const{blockShape:r,crops:i}=n;return{x:()=>Object(Bn.a)(t,r,i)}}},Ln={kernelName:wt.v,gradFunc:(t,e,n)=>{const r=n,i=r.inputShape,a=r.shape,o=Array.from(a);for(let t=i.length-1;t>=0;t--)if(i[t]===a[t])o[t]=1;else if(1!==i[t])throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${a}].`);const s=[];for(let t=0;t<o.length;t++)o[t]>1&&s.push(t);return{x:()=>Object(On.a)(t,s,!0)}}},Pn={kernelName:wt.w,gradFunc:t=>({x:()=>t.clone()})},qn={kernelName:wt.x,gradFunc:t=>({x:()=>Object(re.a)(t)})};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Wn=n(53),Un=n(54),Vn=n(58),Gn=n(36);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Hn={kernelName:wt.y,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:i,clipValueMax:a}=n;return{x:()=>Object(Gn.a)(Object(Vn.a)(Object(Wn.a)(r,i),Object(Un.a)(r,a)),t,Object(re.a)(t))}}},Xn={kernelName:wt.A,inputsToSave:["x"],gradFunc:yn.gradFunc};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Kn=n(73);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yn={kernelName:wt.B,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(t=>t.shape),{axis:i}=n,a=Object(A.I)(i,e[0].shape)[0],o=r.map(t=>t[a]);return Object(Kn.a)(t,o,a).map(t=>()=>t)}};var Jn=n(144),Zn=n(142);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Qn={kernelName:wt.C,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,{dilations:a,strides:o,pad:s,dataFormat:u}=n;return A.b(Ne.i(a),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`),{x:()=>Object(Zn.a)(r.shape,t,i,o,s,u),filter:()=>Object(Jn.a)(r,t,i.shape,o,s,u)}}};var tr=n(63);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const er={kernelName:wt.E,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,{strides:a,pad:o,dataFormat:s,dimRoundingMode:u}=n;return{dy:()=>Object(tr.a)(t,i,a,o,s,1,u),filter:()=>Object(Jn.a)(t,r,i.shape,a,o,s,u)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nr=Object(yt.b)({conv3DBackpropFilter_:function(t,e,n,r,i){let a=t;4===t.rank&&(a=Object(kn.a)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;4===o.rank&&(o=Object(kn.a)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),A.b(5===a.rank,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+a.shape+"."),A.b(5===o.rank,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+"."),A.b(5===n.length,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."),A.b(a.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${n[3]}.`),A.b(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const s={x:a,dy:o},u={strides:r,pad:i,filterShape:n};return f.a.runKernel(wt.G,s,u)}});var rr=n(206);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ir={kernelName:wt.F,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:i,pad:a}=n;A.b(Object(Ne.i)(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[o,s]=e;return{x:()=>Object(rr.a)(o.shape,t,s,i,a),filter:()=>nr(o,t,s.shape,i,a)}}};var ar=n(198);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const or={kernelName:wt.I,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(te.a)(Object(vn.a)(Object(ar.a)(Object(G.a)(n,"float32"))),t)}}};var sr=n(199);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ur={kernelName:wt.J,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(te.a)(Object(sr.a)(Object(G.a)(n,"float32")),t)}}};var cr=n(127);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lr={kernelName:wt.L,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i,exclusive:a,reverse:o}=n;return{x:()=>{const e=Object(Ce.f)([i],r.rank);let n=Object(cr.a)(t,i,a,!o);return null!=e&&(n=Object(vt.a)(n,e)),n}}}};var dr=n(210),fr=n(209);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const hr={kernelName:wt.O,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:i,pad:a,dimRoundingMode:o}=n,s=null==r?[1,1]:r;A.b(Ne.i(s),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);const[u,c]=e;return A.b(4===u.rank,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${u.rank}.`),A.b(4===c.rank,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),A.b(u.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),A.b(Ne.h(i,s),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${s}'.`),null!=o&&A.b(A.v(a),()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${a}.`),{x:()=>Object(fr.a)(u.shape,t,c,i,a,r,o),filter:()=>Object(dr.a)(u,t,c.shape,i,a,r,o)}}},pr={kernelName:wt.S,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,a={x:r,filter:i,dy:t},o={x:r,filter:i,dy:t};return{x:()=>f.a.runKernel(wt.U,a,n),filter:()=>f.a.runKernel(wt.T,o,n)}}},mr={kernelName:wt.V,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>f.a.runKernel(wt.W,r)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var gr=n(40);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const br={kernelName:wt.Y,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=Object(te.a)(Object(gr.a)(Object(vn.a)(Object(ne.a)(n))),2/Math.sqrt(Math.PI));return{x:()=>Object(te.a)(t,r)}}},yr={kernelName:wt.Z,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(te.a)(t,n)}}},vr={kernelName:wt.ab,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>Object(kn.a)(t,n.shape)}}},xr={kernelName:wt.bb,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(te.a)(t,Object(gr.a)(n))}}},wr={kernelName:wt.fb,gradFunc:t=>({x:()=>Object(re.a)(t)})},kr={kernelName:wt.gb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=Object(Ee.a)(n.shape,r.shape);return{a:()=>{const e=Object(Qt.a)(t,Object(G.a)(r,"float32")),a=Object(Ee.c)(n.shape,i);return a.length>0?Object(kn.a)(Object(On.a)(e,a),n.shape):e},b:()=>{let e=Object(te.a)(t,Object(G.a)(n,"float32"));const a=Object(Ee.c)(r.shape,i);a.length>0&&(e=Object(kn.a)(Object(On.a)(e,a),r.shape));const o=Object(ne.a)(r);return Object(vn.a)(Object(Qt.a)(e,Object(G.a)(o,"float32")))}}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Or=n(195),_r=n(86);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Ar={kernelName:wt.ib,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[i,a,o,s]=e,u=null==s?Object(ae.a)(1):s,c=Object(Ee.c)(a.shape,i.shape),l=[];if(1===a.rank){for(let t=0;t<i.shape.length-1;++t)l.push(i.shape[t]);l.push(1)}const d=Object(de.a)(i,a),f=Object(te.a)(t,u),h=Object(Or.a)(Object(Zt.a)(o,Object(ae.a)(r))),p=Object(te.a)(Object(te.a)(Object(te.a)(h,h),h),Object(ae.a)(-.5));return{x:()=>1===a.rank?Object(kn.a)(Object(te.a)(Object(te.a)(t,Object(_r.a)(Object(kn.a)(h,[1,1,1,a.shape[0]]),l)),u),i.shape):Object(kn.a)(Object(te.a)(Object(te.a)(t,h),u),i.shape),mean:()=>{let t=Object(te.a)(Object(te.a)(h,Object(ae.a)(-1)),f);return 1===a.rank&&(t=Object(On.a)(t,c)),Object(kn.a)(t,a.shape)},variance:()=>{let t=Object(te.a)(Object(te.a)(p,d),f);return 1===a.rank&&(t=Object(On.a)(t,c)),Object(kn.a)(t,a.shape)},scale:()=>{const e=Object(te.a)(d,h);let n=Object(te.a)(t,e);return 1===a.rank&&(n=Object(On.a)(n,c)),Object(kn.a)(n,a.shape)},offset:()=>{let e=t;return 1===a.rank&&(e=Object(On.a)(e,c)),Object(kn.a)(e,a.shape)}}}};var Cr=n(140);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Er={kernelName:wt.mb,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,i]=e,{axis:a}=n,o=Object(A.I)(a,r.shape)[0];return{x:()=>{const e=r.shape,n=i.size,s=e.slice(0,o),u=s.length,c=e.slice(a,e.length).slice(1),l=c.length,d=Sr(0,u),f=Sr(u+1,u+1+l),h=jr([s,[n],c]),p=Object(kn.a)(t,h),m=Object(kn.a)(i,[n]),g=jr([[u],d,f]),b=Object(vt.a)(p,g);let y=Object(Cr.a)(b,m,r.shape[o]);const v=Object(Ce.h)(g);return y=Object(vt.a)(y,v),y},indices:()=>i}}};function Sr(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function jr(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nr={kernelName:wt.ob,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Object(re.a)(n),b:()=>Object(re.a)(r)}}},Tr={kernelName:wt.qb,gradFunc:t=>({x:()=>Object(G.a)(t,"float32")})},Fr={kernelName:wt.sb,gradFunc:t=>({x:()=>Object(re.a)(t)})},Dr={kernelName:wt.tb,gradFunc:t=>({x:()=>Object(re.a)(t)})},Ir={kernelName:wt.ub,gradFunc:t=>({x:()=>Object(re.a)(t)})};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Mr=n(45);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $r={kernelName:wt.xb,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:i}=n,a=Object(Mr.a)(r,0);return{x:()=>Object(Gn.a)(a,t,Object(te.a)(t,i))}}},Rr={kernelName:wt.Cb,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Qt.a)(t,Object(Zt.a)(n,1))}}},Br={kernelName:wt.Bb,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Qt.a)(t,Object(G.a)(n,"float32"))}}},zr={kernelName:wt.Db,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n;return{logits:()=>{const e=Object(gr.a)(r);return Object(de.a)(t,Object(te.a)(Object(On.a)(t,i,!0),e))}}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lr=Object(yt.b)({localResponseNormalizationBackprop_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,r=5,i=1,a=1,o=.5){const s={x:t,y:e,dy:n},u={depthRadius:r,bias:i,alpha:a,beta:o};return f.a.runKernel(wt.wb,s,u)}}),Pr={kernelName:wt.vb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{depthRadius:a,bias:o,alpha:s,beta:u}=n;return{x:()=>Lr(r,i,t,a,o,s,u)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var qr=n(79);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wr(t,e,n,r){return e.rank<n.rank&&(e=Object(kn.a)(e,Ce.e(e.shape,r))),t.rank<n.rank&&(t=Object(kn.a)(t,Ce.e(t.shape,r))),{x:()=>Object(te.a)(t,Object(G.a)(Object(qr.a)(n,e),t.dtype))}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ur={kernelName:wt.Hb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:i}=r,a=e[0],o=Wr(t,e[1],a,A.I(i,a.shape));return{x:()=>o.x()}}};var Vr=n(99);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gr={kernelName:wt.Nb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Object(te.a)(t,Object(G.a)(Object(Wn.a)(n,r),"float32")),b:()=>Object(te.a)(t,Object(G.a)(Object(Vr.a)(n,r),"float32"))}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hr=Object(yt.b)({maxPool3dGrad_:function(t,e,n,r,i,a=[1,1,1],o,s){const u=Object(mt.a)(t,"dy","maxPool3dGrad"),c=Object(mt.a)(e,"input","maxPool3dGrad"),l=Object(mt.a)(n,"output","maxPool3dGrad");let d=u,h=c,p=l,m=!1;4===c.rank&&(m=!0,d=Object(kn.a)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),h=Object(kn.a)(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),p=Object(kn.a)(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),A.b(5===d.rank,()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+d.rank+"."),A.b(5===h.rank,()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+h.rank+"."),A.b(5===p.rank,()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+p.rank+"."),A.b(Ne.h(i,a),()=>`Error in maxPool3dGrad: Either strides or dilations must be 1. Got strides ${i} and dilations '${a}'`),null!=s&&A.b(A.v(o),()=>`Error in maxPool3dGrad: pad must be an integer when using, dimRoundingMode ${s} but got pad ${o}.`);const g={dy:d,input:h,output:p},b={filterSize:r,strides:i,dilations:a,pad:o,dimRoundingMode:s},y=f.a.runKernel(wt.Kb,g,b);return m?Object(kn.a)(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}}),Xr={kernelName:wt.Jb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{filterSize:a,strides:o,dilations:s,pad:u,dimRoundingMode:c}=n,l=null==s?[1,1,1]:s;return{x:()=>Hr(t,r,i,a,o,l,u,c)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kr=Object(yt.b)({maxPoolGrad_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,r,i,a,o){const s=Object(mt.a)(t,"dy","maxPoolGrad"),u=Object(mt.a)(e,"input","maxPoolGrad"),c=Object(mt.a)(n,"output","maxPoolGrad");A.b(u.rank===s.rank,()=>`Rank of input (${u.rank}) does not match rank of dy (${s.rank})`),A.b(4===s.rank,()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+s.rank+"."),A.b(4===u.rank,()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+u.rank+"."),null!=o&&A.b(A.v(a),()=>`Error in maxPoolGrad: pad must be an integer when using, dimRoundingMode ${o} but got pad ${a}.`);const l={dy:s,input:u,output:c},d={filterSize:r,strides:i,pad:a,dimRoundingMode:o};return f.a.runKernel(wt.Lb,l,d)}}),Yr={kernelName:wt.Ib,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{filterSize:a,strides:o,pad:s}=n;return{x:()=>Kr(t,r,i,a,o,s)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Jr=n(80);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zr={kernelName:wt.Ob,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n,a=A.I(i,r.shape),o=Object(Ce.d)(r.shape,a)[1],s=A.N(o);return{x:()=>{const e=r.shape.slice();a.forEach(t=>{e[t]=1});const n=Object(kn.a)(t,e);return Object(Qt.a)(Object(te.a)(n,Object(Jr.a)(r.shape,"float32")),s)}}}},Qr={kernelName:wt.Pb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:i}=r,[a,o]=e,s=Wr(t,o,a,A.I(i,a.shape));return{x:()=>s.x()}}},ti={kernelName:wt.Qb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Object(te.a)(t,Object(G.a)(Object(Un.a)(n,r),"float32")),b:()=>Object(te.a)(t,Object(G.a)(Object(Mr.a)(n,r),"float32"))}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ei=n(25);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ni={kernelName:wt.Rb,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:i}=n,a=i.map(t=>t[0]);return{x:()=>Object(ei.a)(t,a,r.shape)}}};var ri=n(129);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ii={kernelName:wt.Sb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=Object(Ee.a)(n.shape,r.shape);return{a:()=>{const e=Object(Ee.c)(n.shape,i);return e.length>0?Object(kn.a)(Object(On.a)(t,e),n.shape):t},b:()=>{const e=Object(te.a)(t,Object(vn.a)(Object(ri.a)(Object(Qt.a)(n,r)))),a=Object(Ee.c)(r.shape,i);return a.length>0?Object(kn.a)(Object(On.a)(e,a),r.shape):e}}}},ai={kernelName:wt.Ub,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=Object(Ee.a)(n.shape,r.shape);return{a:()=>{const e=Object(te.a)(t,Object(G.a)(r,"float32")),a=Object(Ee.c)(n.shape,i);return a.length>0?Object(kn.a)(Object(On.a)(e,a),n.shape):e},b:()=>{const e=Object(te.a)(t,Object(G.a)(n,"float32")),a=Object(Ee.c)(r.shape,i);return a.length>0?Object(kn.a)(Object(On.a)(e,a),r.shape):e}}}},oi={kernelName:wt.Vb,gradFunc:t=>({x:()=>Object(vn.a)(t)})},si={kernelName:wt.ac,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Object(Ae.a)(n.shape,"float32")}}},ui={kernelName:wt.bc,gradFunc:t=>({x:()=>Object(re.a)(t)})};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ci=n(83);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const li={kernelName:wt.cc,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return Object(ci.a)(t,r).map(t=>()=>t)}},di={kernelName:wt.dc,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:i}=n,a=i.map(t=>t[0]);return{x:()=>Object(ei.a)(t,a,r.shape)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var fi=n(72);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hi={kernelName:wt.fc,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,i]=e,a=n,o=r,s=Ee.a(a.shape,o.shape);return{a:()=>{const e=Object(G.a)(o,"float32");let n=Object(te.a)(t,Object(te.a)(e,Object(le.a)(a,Object(de.a)(e,Object(ae.a)(1)))));const r=Ee.c(a.shape,s);return r.length>0&&(n=Object(On.a)(n,r)),Object(kn.a)(n,a.shape)},b:()=>{const e=Object(Mr.a)(a,0),n=Object(Gn.a)(e,Object(fi.a)(a),Object(re.a)(a));let r=Object(te.a)(t,Object(te.a)(i,n));const u=Ee.c(o.shape,s);return u.length>0&&(r=Object(On.a)(r,u)),Object(kn.a)(r,o.shape)}}}},pi={kernelName:wt.gc,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,i=Object(Mr.a)(n,0);return{x:()=>Object(Gn.a)(i,t,Object(te.a)(t,r)),alpha:()=>{let e=Object(Gn.a)(i,Object(re.a)(t),Object(te.a)(t,n));const a=Object(Ee.c)(r.shape,t.shape);return a.length>0&&(e=Object(On.a)(e,a)),Object(kn.a)(e,r.shape)}}}},mi={kernelName:wt.kc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=Ee.a(n.shape,r.shape);return{a:()=>{const e=Object(Qt.a)(t,Object(G.a)(r,"float32")),a=Ee.c(n.shape,i);return a.length>0?Object(kn.a)(Object(On.a)(e,a),n.shape):e},b:()=>{let e=Object(te.a)(t,Object(G.a)(n,"float32"));const a=Ee.c(r.shape,i);a.length>0&&(e=Object(kn.a)(Object(On.a)(e,a),r.shape));const o=Object(ne.a)(r);return Object(vn.a)(Object(Qt.a)(e,Object(G.a)(o,"float32")))}}}},gi={kernelName:wt.lc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Qt.a)(t,Object(vn.a)(Object(ne.a)(n)))}}},bi={kernelName:wt.nc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=Object(te.a)(Object(Un.a)(n,6),Object(bn.a)(n));return{x:()=>Object(te.a)(t,Object(G.a)(r,"float32"))}}},yi={kernelName:wt.mc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(te.a)(t,Object(G.a)(Object(bn.a)(n),"float32"))}}},vi={kernelName:wt.oc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(kn.a)(t,n.shape)}}},xi={kernelName:wt.pc,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,i={dy:t,images:r};return{images:()=>f.a.runKernel(wt.qc,i,n)}}},wi={kernelName:wt.rc,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,i={dy:t,images:r};return{images:()=>f.a.runKernel(wt.sc,i,n)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ki=n(48);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oi={kernelName:wt.tc,gradFunc:(t,e,n)=>{const{dims:r}=n,i=Object(A.I)(r,t.shape);return{x:()=>Object(ki.a)(t,i)}}},_i={kernelName:wt.vc,gradFunc:t=>({x:()=>Object(re.a)(t)})},Ai={kernelName:wt.wc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(vn.a)(Object(Qt.a)(t,Object(te.a)(Object(le.a)(n,1.5),2)))}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ci=n(100);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ei={kernelName:wt.yc,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>Object(G.a)(Object(re.a)(n),"float32"),t:()=>Object(te.a)(t,Object(G.a)(n,t.dtype)),e:()=>Object(te.a)(t,Object(G.a)(Object(Ci.a)(n),t.dtype))}}},Si={kernelName:wt.zc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Object(Mr.a)(n,Object(ae.a)(0)),r=Object(ae.a)(Le),i=Object(ae.a)(Pe),a=Object(te.a)(t,i),o=Object(te.a)(Object(te.a)(t,r),Object(gr.a)(Object(G.a)(n,"float32")));return Object(Gn.a)(e,a,o)}}}},ji={kernelName:wt.Ac,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(te.a)(t,Object(te.a)(n,Object(de.a)(Object(ae.a)(1),n)))}}},Ni={kernelName:wt.Bc,gradFunc:t=>({x:()=>Object(re.a)(t)})};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ti=n(126);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fi={kernelName:wt.Cc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(te.a)(Object(Ti.a)(Object(G.a)(n,"float32")),t)}}};var Di=n(182);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ii={kernelName:wt.Dc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(te.a)(Object(Di.a)(Object(G.a)(n,"float32")),t)}}};var Mi=n(55);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $i={kernelName:wt.Ec,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:i,size:a}=n,o=r.shape,[s,u]=Wt(r,i,a),c=[];for(let e=0;e<t.rank;e++)c.push([s[e],o[e]-s[e]-u[e]]);return{x:()=>Object(Mi.a)(t,c)}}},Ri={kernelName:wt.Fc,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:i}=n,a=Object(te.a)(t,r);return{logits:()=>Object(de.a)(a,Object(te.a)(Object(On.a)(a,[i],!0),r))}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Bi=n(85);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zi={kernelName:wt.Gc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(te.a)(t,Object(Bi.a)(n))}}};var Li=n(97);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pi={kernelName:wt.Hc,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:i}=n;return{x:()=>Object(Li.a)(t,r,i)}}};var qi=n(31);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wi={kernelName:wt.Jc,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>Object(qi.a)(t,r)}}},Ui={kernelName:wt.Kc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Qt.a)(t,Object(te.a)(Object(ee.a)(Object(G.a)(n,"float32")),2))}}},Vi={kernelName:wt.Lc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(te.a)(t,Object(te.a)(Object(G.a)(n,"float32"),2))}}},Gi={kernelName:wt.Mc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=Object(ae.a)(2);return{a:()=>Object(te.a)(t,Object(te.a)(i,Object(de.a)(n,r))),b:()=>Object(te.a)(t,Object(te.a)(i,Object(de.a)(r,n)))}}},Hi={kernelName:wt.Nc,gradFunc:t=>({x:()=>Object(re.a)(t)})},Xi={kernelName:wt.Pc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=Ee.a(n.shape,r.shape);return{a:()=>{let e=t;const r=Ee.c(n.shape,i);return r.length>0&&(e=Object(On.a)(e,r)),Object(kn.a)(e,n.shape)},b:()=>{let e=t;const n=Ee.c(r.shape,i);return n.length>0&&(e=Object(On.a)(e,n)),Object(kn.a)(Object(vn.a)(e),r.shape)}}}},Ki={kernelName:wt.Qc,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,i=r.shape.slice(),{axis:a}=n;Object(A.I)(a,r.shape).forEach(t=>{i[t]=1});const o=Object(kn.a)(t,i),s=Object(te.a)(o,Object(Jr.a)(r.shape,"float32"));return{x:()=>s}}},Yi={kernelName:wt.Rc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Qt.a)(t,Object(ne.a)(Object(Ti.a)(n)))}}},Ji={kernelName:wt.Sc,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(te.a)(Object(de.a)(Object(ae.a)(1),Object(ne.a)(n)),t)}}},Zi={kernelName:wt.Tc,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:i}=n;return{x:()=>{let e=Object(re.a)(r);if(1===r.rank)for(let n=0;n<i[0];++n)e=Object(Zt.a)(e,Object(ei.a)(t,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)e=Object(Zt.a)(e,Object(ei.a)(t,[n*r.shape[0],a*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)for(let o=0;o<i[2];++o)e=Object(Zt.a)(e,Object(ei.a)(t,[n*r.shape[0],a*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)for(let o=0;o<i[2];++o)for(let s=0;s<i[3];++s)e=Object(Zt.a)(e,Object(ei.a)(t,[n*r.shape[0],a*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e}}}},Qi={kernelName:wt.Vc,gradFunc:(t,e,n)=>{const r=n,{perm:i}=r,a=Ce.h(i);return{x:()=>Object(vt.a)(t,a)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ta=n(59);
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ea={kernelName:wt.Xc,gradFunc:(t,e,n)=>{const r=n,{axis:i}=r;return{value:()=>Object(ta.a)(t,i)}}};var na=n(60),ra=n(98);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const ia=[yn,xn,wn,_n,An,Cn,En,Sn,jn,Nn,Tn,Fn,In,$n,Rn,zn,Ln,Pn,qn,Hn,Xn,Yn,er,Qn,ir,or,ur,lr,hr,pr,mi,mr,br,yr,vr,xr,kr,wr,Ar,Er,Nr,Tr,Fr,Dr,Ir,$r,Rr,Br,zr,Pr,Ur,Ur,Gr,Xr,Yr,Zr,Qr,ti,ni,ii,ai,oi,si,ui,li,di,di,hi,pi,gi,bi,yi,vi,xi,wi,Oi,_i,Ai,Ei,Si,ji,Ni,Fi,Ii,$i,Ri,zi,Pi,Pi,Wi,Wi,Ui,Gi,Vi,Hi,Xi,Ki,Yi,Ji,Zi,Qi,ea,{kernelName:wt.Yc,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>function(t,e){const n=Object(pe.a)(e,Object(re.a)(e)),r=Object(ra.a)(t,n);let i=Object(Wn.a)(e,Object(ae.a)(0,"int32"));const a=r.rank-i.rank;for(let t=0;t<a;++t)i=Object(na.a)(i,t+1);i=Object(Vn.a)(i,Object(Jr.a)(r.shape,"bool"));const o=Object(re.a)(r);return Object(Gn.a)(i,r,o)}(t,n)}}},{kernelName:wt.Zc,gradFunc:t=>({x:()=>Object(re.a)(t)})}];
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */for(const t of ia)Object(kt.e)(t);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.abs=function(){return this.throwIfDisposed(),Object(he.a)(this)};var aa=n(247);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.acos=function(){return this.throwIfDisposed(),Object(aa.a)(this)};var oa=n(248);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.acosh=function(){return this.throwIfDisposed(),Object(oa.a)(this)};var sa=n(281);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.addStrict=function(t){return this.throwIfDisposed(),Object(sa.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.add=function(t){return this.throwIfDisposed(),Object(Zt.a)(this,t)};var ua=n(175);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.all=function(t,e){return this.throwIfDisposed(),Object(ua.a)(this,t,e)};var ca=n(176);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.any=function(t,e){return this.throwIfDisposed(),Object(ca.a)(this,t,e)};var la=n(177);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.argMax=function(t){return this.throwIfDisposed(),Object(la.a)(this,t)};var da=n(178);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.argMin=function(t){return this.throwIfDisposed(),Object(da.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.asScalar=function(){return this.throwIfDisposed(),Object(A.b)(1===this.size,()=>"The array must have only 1 element."),Object(kn.a)(this,[])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.asType=function(t){return this.throwIfDisposed(),Object(G.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.as1D=function(){return this.throwIfDisposed(),Object(kn.a)(this,[this.size])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.as2D=function(t,e){return this.throwIfDisposed(),Object(kn.a)(this,[t,e])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),Object(kn.a)(this,[t,e,n])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),Object(kn.a)(this,[t,e,n,r])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),Object(kn.a)(this,[t,e,n,r,i])};var fa=n(250);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.asin=function(){return this.throwIfDisposed(),Object(fa.a)(this)};var ha=n(251);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.asinh=function(){return this.throwIfDisposed(),Object(ha.a)(this)};var pa=n(252);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.atan=function(){return this.throwIfDisposed(),Object(pa.a)(this)};var ma=n(179);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.atan2=function(t){return this.throwIfDisposed(),Object(ma.a)(this,t)};var ga=n(253);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.atanh=function(){return this.throwIfDisposed(),Object(ga.a)(this)};var ba=n(125);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),Object(ba.a)(this,t,e,n,r)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Object(Li.a)(this,t,e)};var ya=n(84);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.batchNorm=function(t,e,n,r,i){return this.throwIfDisposed(),Object(ya.a)(this,t,e,n,r,i)};var va=n(109);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.broadcastTo=function(t){return this.throwIfDisposed(),Object(va.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.cast=function(t){return this.throwIfDisposed(),Object(G.a)(this,t)};var xa=n(256);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.ceil=function(){return this.throwIfDisposed(),Object(xa.a)(this)};var wa=n(257);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Object(wa.a)(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof K.a&&(t=[t]),Object(qi.a)([this,...t],e)};var ka=n(180);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.conv1d=function(t,e,n,r,i,a){return this.throwIfDisposed(),Object(ka.a)(this,t,e,n,r,i,a)};var Oa=n(181);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),Object(Oa.a)(this,t,e,n,r,i)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.conv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),Object(tr.a)(this,t,e,n,r,i,a)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.cos=function(){return this.throwIfDisposed(),Object(Ti.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.cosh=function(){return this.throwIfDisposed(),Object(Di.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),Object(cr.a)(this,t,e,n)};var _a=n(183);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),Object(_a.a)(this,t,e)};var Aa=n(78);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.depthwiseConv2D=function(t,e,n,r,i,a){return Object(Jt.b)("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),Object(Aa.a)(this,t,e,n,r,i,a)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.depthwiseConv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),Object(Aa.a)(this,t,e,n,r,i,a)};var Ca=n(184);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.dilation2d=function(t,e,n,r,i){return this.throwIfDisposed(),Object(Ca.a)(this,t,e,n,r,i)};var Ea=n(185);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.divNoNan=function(t){return this.throwIfDisposed(),Object(Ea.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.divStrict=function(t){return this.throwIfDisposed(),Object(sa.b)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.div=function(t){return this.throwIfDisposed(),Object(Qt.a)(this,t)};var Sa=n(186);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.dot=function(t){return this.throwIfDisposed(),Object(Sa.a)(this,t)};var ja=n(128);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.elu=function(){return this.throwIfDisposed(),Object(ja.a)(this)};var Na=n(280);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.equalStrict=function(t){return this.throwIfDisposed(),Object(Na.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.equal=function(t){return this.throwIfDisposed(),Object(qr.a)(this,t)};var Ta=n(260);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.erf=function(){return this.throwIfDisposed(),Object(Ta.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.exp=function(){return this.throwIfDisposed(),Object(gr.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.expandDims=function(t){return this.throwIfDisposed(),Object(na.a)(this,t)};var Fa=n(261);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.expm1=function(){return this.throwIfDisposed(),Object(Fa.a)(this)};var Da=n(138);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.fft=function(){return this.throwIfDisposed(),Object(Da.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.flatten=function(){return this.throwIfDisposed(),Object(kn.a)(this,[this.size])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.floor=function(){return this.throwIfDisposed(),Object(ri.a)(this)};var Ia=n(123);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.floorDiv=function(t){return this.throwIfDisposed(),Object(Ia.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.gather=function(t,e){return this.throwIfDisposed(),Object(ra.a)(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),Object(Na.b)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.greaterEqual=function(t){return this.throwIfDisposed(),Object(Wn.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.greaterStrict=function(t){return this.throwIfDisposed(),Object(Na.c)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.greater=function(t){return this.throwIfDisposed(),Object(Mr.a)(this,t)};var Ma=n(113);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.ifft=function(){return this.throwIfDisposed(),Object(Ma.a)(this)};var $a=n(200);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.irfft=function(){return this.throwIfDisposed(),Object($a.a)(this)};var Ra=n(262);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.isFinite=function(){return this.throwIfDisposed(),Object(Ra.a)(this)};var Ba=n(263);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.isInf=function(){return this.throwIfDisposed(),Object(Ba.a)(this)};var za=n(264);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.isNaN=function(){return this.throwIfDisposed(),Object(za.a)(this)};var La=n(131);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.leakyRelu=function(t){return this.throwIfDisposed(),Object(La.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),Object(Na.d)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.lessEqual=function(t){return this.throwIfDisposed(),Object(Un.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.lessStrict=function(t){return this.throwIfDisposed(),Object(Na.e)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.less=function(t){return this.throwIfDisposed(),Object(Vr.a)(this,t)};var Pa=n(187);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),Object(Pa.a)(this,t,e,n,r)};var qa=n(266);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.logSigmoid=function(){return this.throwIfDisposed(),Object(qa.a)(this)};var Wa=n(267);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.logSoftmax=function(t){return this.throwIfDisposed(),Object(Wa.a)(this,t)};var Ua=n(132);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.logSumExp=function(t,e){return this.throwIfDisposed(),Object(Ua.a)(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.log=function(){return this.throwIfDisposed(),Object(fi.a)(this)};var Va=n(188);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.log1p=function(){return this.throwIfDisposed(),Object(Va.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.logicalAnd=function(t){return this.throwIfDisposed(),Object(Vn.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.logicalNot=function(){return this.throwIfDisposed(),Object(Ci.a)(this)};var Ga=n(133);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.logicalOr=function(t){return this.throwIfDisposed(),Object(Ga.a)(this,t)};var Ha=n(190);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.logicalXor=function(t){return this.throwIfDisposed(),Object(Ha.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Object(gt.a)(this,t,e,n)};var Xa=n(134);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),Object(Xa.a)(this,t,e,n,r)};var Ka=n(66);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.max=function(t,e){return this.throwIfDisposed(),Object(Ka.a)(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.maximumStrict=function(t){return this.throwIfDisposed(),Object(sa.c)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.maximum=function(t){return this.throwIfDisposed(),Object(pe.a)(this,t)};var Ya=n(89);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.mean=function(t,e){return this.throwIfDisposed(),Object(Ya.a)(this,t,e)};var Ja=n(110);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.min=function(t,e){return this.throwIfDisposed(),Object(Ja.a)(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.minimumStrict=function(t){return this.throwIfDisposed(),Object(sa.d)(this,t)};var Za=n(101);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.minimum=function(t){return this.throwIfDisposed(),Object(Za.a)(this,t)};var Qa=n(191);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),Object(Qa.a)(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.modStrict=function(t){return this.throwIfDisposed(),Object(sa.e)(this,t)};var to=n(135);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.mod=function(t){return this.throwIfDisposed(),Object(to.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.mulStrict=function(t){return this.throwIfDisposed(),Object(sa.f)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.mul=function(t){return this.throwIfDisposed(),Object(te.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.neg=function(){return this.throwIfDisposed(),Object(vn.a)(this)};var eo=n(141);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.norm=function(t,e,n){return this.throwIfDisposed(),Object(eo.a)(this,t,e,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),Object(Na.f)(this,t)};var no=n(102);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.notEqual=function(t){return this.throwIfDisposed(),Object(no.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),Object(bt.a)(this,t,e,n)};var ro=n(271);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.onesLike=function(){return this.throwIfDisposed(),Object(ro.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.pad=function(t,e){return this.throwIfDisposed(),Object(Mi.a)(this,t,e)};var io=n(192);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.pool=function(t,e,n,r,i){return this.throwIfDisposed(),Object(io.a)(this,t,e,n,r,i)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.powStrict=function(t){return this.throwIfDisposed(),Object(sa.g)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.pow=function(t){return this.throwIfDisposed(),Object(le.a)(this,t)};var ao=n(136);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.prelu=function(t){return this.throwIfDisposed(),Object(ao.a)(this,t)};var oo=n(193);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.prod=function(t,e){return this.throwIfDisposed(),Object(oo.a)(this,t,e)};var so=n(272);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.reciprocal=function(){return this.throwIfDisposed(),Object(so.a)(this)};var uo=n(81);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.relu=function(){return this.throwIfDisposed(),Object(uo.a)(this)};var co=n(137);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.relu6=function(){return this.throwIfDisposed(),Object(co.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.reshapeAs=function(t){return this.throwIfDisposed(),Object(kn.a)(this,t.shape)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.reshape=function(t){return this.throwIfDisposed(),Object(kn.a)(this,t)};var lo=n(208);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),Object(lo.a)(this,t,e,n)};var fo=n(207);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),Object(fo.a)(this,t,e,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.reverse=function(t){return this.throwIfDisposed(),Object(ki.a)(this,t)};var ho=n(139);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.rfft=function(){return this.throwIfDisposed(),Object(ho.a)(this)};var po=n(273);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.round=function(){return this.throwIfDisposed(),Object(po.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.rsqrt=function(){return this.throwIfDisposed(),Object(Or.a)(this)};var mo=n(196);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.selu=function(){return this.throwIfDisposed(),Object(mo.a)(this)};var go=n(197);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.separableConv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),Object(go.a)(this,t,e,n,r,i,a)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.sigmoid=function(){return this.throwIfDisposed(),Object(Bi.a)(this)};var bo=n(275);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.sign=function(){return this.throwIfDisposed(),Object(bo.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.sin=function(){return this.throwIfDisposed(),Object(ar.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.sinh=function(){return this.throwIfDisposed(),Object(sr.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.slice=function(t,e){return this.throwIfDisposed(),Object(ei.a)(this,t,e)};var yo=n(276);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.softmax=function(t){return this.throwIfDisposed(),Object(yo.a)(this,t)};var vo=n(189);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.softplus=function(){return this.throwIfDisposed(),Object(vo.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),Object(Bn.a)(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.split=function(t,e){return this.throwIfDisposed(),Object(Kn.a)(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.sqrt=function(){return this.throwIfDisposed(),Object(ee.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.square=function(){return this.throwIfDisposed(),Object(ne.a)(this)};var xo=n(104);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.squaredDifference=function(t){return this.throwIfDisposed(),Object(xo.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),Object(sa.h)(this,t)};var wo=n(105);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.squeeze=function(t){return this.throwIfDisposed(),Object(wo.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof K.a?[this,t]:[this,...t];return Object(ta.a)(n,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.step=function(t){return this.throwIfDisposed(),Object(bn.a)(this,t)};var ko=n(277);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.stridedSlice=function(t,e,n,r,i,a,o,s){return this.throwIfDisposed(),Object(ko.a)(this,t,e,n,r,i,a,o,s)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.subStrict=function(t){return this.throwIfDisposed(),Object(sa.i)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.sub=function(t){return this.throwIfDisposed(),Object(de.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.sum=function(t,e){return this.throwIfDisposed(),Object(On.a)(this,t,e)};var Oo=n(278);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.tan=function(){return this.throwIfDisposed(),Object(Oo.a)(this)};var _o=n(154);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.tanh=function(){return this.throwIfDisposed(),Object(_o.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.tile=function(t){return this.throwIfDisposed(),Object(_r.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.toBool=function(){return this.throwIfDisposed(),Object(G.a)(this,"bool")},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.toFloat=function(){return this.throwIfDisposed(),Object(G.a)(this,"float32")},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.toInt=function(){return this.throwIfDisposed(),Object(G.a)(this,"int32")};var Ao=n(202);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.topk=function(t,e){return this.throwIfDisposed(),Object(Ao.a)(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.transpose=function(t){return this.throwIfDisposed(),Object(vt.a)(this,t)};var Co=n(203);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */K.a.prototype.unique=function(t){return this.throwIfDisposed(),Object(Co.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),Object(Cr.a)(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.unstack=function(t){return this.throwIfDisposed(),Object(ci.a)(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.where=function(t,e){return this.throwIfDisposed(),Object(Gn.a)(t,this,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
K.a.prototype.zerosLike=function(){return this.throwIfDisposed(),Object(re.a)(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */n.d(e,"d",(function(){return se})),n.d(e,"e",(function(){return ce})),n.d(e,"f",(function(){return fe})),n.d(e,"g",(function(){return me})),n.d(e,"bc",(function(){return be})),n.d(e,"mc",(function(){return oe})),n.d(e,"tc",(function(){return ye})),n.d(e,"Lc",(function(){return ge})),n.d(e,"id",(function(){return K.a})),n.d(e,"jd",(function(){return K.b})),n.d(e,"qd",(function(){return K.c})),n.d(e,"vc",(function(){return ve.a})),n.d(e,"Rh",(function(){return ve.b})),n.d(e,"pi",(function(){return ve.c})),n.d(e,"zc",(function(){return we.a})),n.d(e,"re",(function(){return ie.a})),n.d(e,"if",(function(){return ie.b})),n.d(e,"jf",(function(){return ie.c})),n.d(e,"ri",(function(){return ie.d})),n.d(e,"si",(function(){return ie.e})),n.d(e,"ui",(function(){return ie.f})),n.d(e,"db",(function(){return h.b})),n.d(e,"Me",(function(){return h.c})),n.d(e,"ab",(function(){return h.a})),n.d(e,"vi",(function(){return"2.8.2"})),n.d(e,"og",(function(){return _e.a})),n.d(e,"Vd",(function(){return a})),n.d(e,"sf",(function(){return r})),n.d(e,"Sf",(function(){return i})),n.d(e,"lh",(function(){return u})),n.d(e,"ci",(function(){return Kt})),n.d(e,"qi",(function(){return Yt})),n.d(e,"Ld",(function(){return l})),n.d(e,"bi",(function(){return Xt})),n.d(e,"zh",(function(){return s})),n.d(e,"df",(function(){return o})),n.d(e,"ih",(function(){return St})),n.d(e,"we",(function(){return hn})),n.d(e,"yf",(function(){return d})),n.d(e,"Cb",(function(){return gn.b})),n.d(e,"Q",(function(){return gn.a})),n.d(e,"td",(function(){return xe.b})),n.d(e,"ud",(function(){return xe.c})),n.d(e,"vd",(function(){return xe.d})),n.d(e,"wd",(function(){return xe.e})),n.d(e,"xd",(function(){return xe.f})),n.d(e,"zd",(function(){return xe.h})),n.d(e,"Ad",(function(){return xe.i})),n.d(e,"Bd",(function(){return xe.j})),n.d(e,"Cd",(function(){return xe.k})),n.d(e,"Dd",(function(){return xe.l})),n.d(e,"Ed",(function(){return xe.m})),n.d(e,"Fd",(function(){return xe.n})),n.d(e,"Gd",(function(){return xe.o})),n.d(e,"Hd",(function(){return xe.p})),n.d(e,"Id",(function(){return xe.q})),n.d(e,"Jd",(function(){return xe.r})),n.d(e,"Md",(function(){return xe.s})),n.d(e,"Rd",(function(){return xe.x})),n.d(e,"Nd",(function(){return xe.t})),n.d(e,"Od",(function(){return xe.u})),n.d(e,"Pd",(function(){return xe.v})),n.d(e,"Qd",(function(){return xe.w})),n.d(e,"Sd",(function(){return xe.y})),n.d(e,"Ud",(function(){return xe.A})),n.d(e,"Wd",(function(){return xe.B})),n.d(e,"Xd",(function(){return xe.C})),n.d(e,"Yd",(function(){return xe.D})),n.d(e,"Zd",(function(){return xe.E})),n.d(e,"ae",(function(){return xe.F})),n.d(e,"be",(function(){return xe.G})),n.d(e,"ce",(function(){return xe.H})),n.d(e,"de",(function(){return xe.I})),n.d(e,"ee",(function(){return xe.J})),n.d(e,"fe",(function(){return xe.K})),n.d(e,"ge",(function(){return xe.L})),n.d(e,"he",(function(){return xe.M})),n.d(e,"ie",(function(){return xe.N})),n.d(e,"je",(function(){return xe.O})),n.d(e,"ke",(function(){return xe.P})),n.d(e,"le",(function(){return xe.Q})),n.d(e,"ne",(function(){return xe.R})),n.d(e,"oe",(function(){return xe.S})),n.d(e,"qe",(function(){return xe.U})),n.d(e,"se",(function(){return xe.V})),n.d(e,"ue",(function(){return xe.W})),n.d(e,"ve",(function(){return xe.X})),n.d(e,"xe",(function(){return xe.Y})),n.d(e,"ye",(function(){return xe.Z})),n.d(e,"Ce",(function(){return xe.ab})),n.d(e,"De",(function(){return xe.bb})),n.d(e,"Fe",(function(){return xe.db})),n.d(e,"He",(function(){return xe.fb})),n.d(e,"Ne",(function(){return xe.hb})),n.d(e,"Pe",(function(){return xe.jb})),n.d(e,"Qe",(function(){return xe.kb})),n.d(e,"Re",(function(){return xe.lb})),n.d(e,"Se",(function(){return xe.mb})),n.d(e,"Te",(function(){return xe.nb})),n.d(e,"Ve",(function(){return xe.pb})),n.d(e,"Ye",(function(){return xe.qb})),n.d(e,"Ze",(function(){return xe.rb})),n.d(e,"bf",(function(){return xe.tb})),n.d(e,"kf",(function(){return xe.vb})),n.d(e,"lf",(function(){return xe.wb})),n.d(e,"pf",(function(){return xe.Ab})),n.d(e,"uf",(function(){return xe.Eb})),n.d(e,"vf",(function(){return xe.Fb})),n.d(e,"wf",(function(){return xe.Gb})),n.d(e,"zf",(function(){return xe.Hb})),n.d(e,"Af",(function(){return xe.Ib})),n.d(e,"Bf",(function(){return xe.Jb})),n.d(e,"Ff",(function(){return xe.Nb})),n.d(e,"Gf",(function(){return xe.Ob})),n.d(e,"Hf",(function(){return xe.Pb})),n.d(e,"If",(function(){return xe.Qb})),n.d(e,"Jf",(function(){return xe.Rb})),n.d(e,"Kf",(function(){return xe.Sb})),n.d(e,"Lf",(function(){return xe.Tb})),n.d(e,"Mf",(function(){return xe.Ub})),n.d(e,"Nf",(function(){return xe.Vb})),n.d(e,"Of",(function(){return xe.Wb})),n.d(e,"Pf",(function(){return xe.Xb})),n.d(e,"Rf",(function(){return xe.Zb})),n.d(e,"Tf",(function(){return xe.ac})),n.d(e,"Uf",(function(){return xe.bc})),n.d(e,"Vf",(function(){return xe.cc})),n.d(e,"Wf",(function(){return xe.dc})),n.d(e,"Xf",(function(){return xe.ec})),n.d(e,"Zf",(function(){return xe.gc})),n.d(e,"bg",(function(){return xe.hc})),n.d(e,"cg",(function(){return xe.ic})),n.d(e,"eg",(function(){return xe.kc})),n.d(e,"fg",(function(){return xe.lc})),n.d(e,"hg",(function(){return xe.nc})),n.d(e,"jg",(function(){return xe.pc})),n.d(e,"lg",(function(){return xe.rc})),n.d(e,"mg",(function(){return xe.sc})),n.d(e,"ng",(function(){return xe.tc})),n.d(e,"qg",(function(){return xe.vc})),n.d(e,"sg",(function(){return xe.xc})),n.d(e,"tg",(function(){return xe.yc})),n.d(e,"ug",(function(){return xe.zc})),n.d(e,"wg",(function(){return xe.Bc})),n.d(e,"xg",(function(){return xe.Cc})),n.d(e,"yg",(function(){return xe.Dc})),n.d(e,"zg",(function(){return xe.Ec})),n.d(e,"Ag",(function(){return xe.Fc})),n.d(e,"Bg",(function(){return xe.Gc})),n.d(e,"Cg",(function(){return xe.Hc})),n.d(e,"Dg",(function(){return xe.Ic})),n.d(e,"Fg",(function(){return xe.Kc})),n.d(e,"Gg",(function(){return xe.Lc})),n.d(e,"Hg",(function(){return xe.Mc})),n.d(e,"Jg",(function(){return xe.Nc})),n.d(e,"Kg",(function(){return xe.Oc})),n.d(e,"Lg",(function(){return xe.Pc})),n.d(e,"Mg",(function(){return xe.Qc})),n.d(e,"Ng",(function(){return xe.Rc})),n.d(e,"Pg",(function(){return xe.Sc})),n.d(e,"Qg",(function(){return xe.Tc})),n.d(e,"Ug",(function(){return xe.Uc})),n.d(e,"Vg",(function(){return xe.Vc})),n.d(e,"Xg",(function(){return xe.Wc})),n.d(e,"Yg",(function(){return xe.Xc})),n.d(e,"Zg",(function(){return xe.Yc})),n.d(e,"ah",(function(){return xe.Zc})),n.d(e,"bh",(function(){return xe.ad})),n.d(e,"ch",(function(){return xe.bd})),n.d(e,"eh",(function(){return xe.dd})),n.d(e,"fh",(function(){return xe.ed})),n.d(e,"gh",(function(){return xe.fd})),n.d(e,"jh",(function(){return xe.hd})),n.d(e,"kh",(function(){return xe.id})),n.d(e,"oh",(function(){return xe.jd})),n.d(e,"ph",(function(){return xe.kd})),n.d(e,"qh",(function(){return xe.ld})),n.d(e,"sh",(function(){return xe.nd})),n.d(e,"th",(function(){return xe.od})),n.d(e,"uh",(function(){return xe.pd})),n.d(e,"vh",(function(){return xe.qd})),n.d(e,"wh",(function(){return xe.rd})),n.d(e,"xh",(function(){return xe.sd})),n.d(e,"yh",(function(){return xe.td})),n.d(e,"Ah",(function(){return xe.ud})),n.d(e,"Bh",(function(){return xe.vd})),n.d(e,"Ch",(function(){return xe.wd})),n.d(e,"Ue",(function(){return xe.ob})),n.d(e,"of",(function(){return xe.zb})),n.d(e,"tf",(function(){return xe.Db})),n.d(e,"dh",(function(){return xe.cd})),n.d(e,"Fh",(function(){return xe.zd})),n.d(e,"Gh",(function(){return xe.Ad})),n.d(e,"Hh",(function(){return xe.Bd})),n.d(e,"Ih",(function(){return xe.Cd})),n.d(e,"Kh",(function(){return xe.Ed})),n.d(e,"Lh",(function(){return xe.Fd})),n.d(e,"Mh",(function(){return xe.Gd})),n.d(e,"Nh",(function(){return xe.Hd})),n.d(e,"Oh",(function(){return xe.Id})),n.d(e,"Qh",(function(){return xe.Kd})),n.d(e,"Sh",(function(){return xe.Ld})),n.d(e,"Th",(function(){return xe.Md})),n.d(e,"Uh",(function(){return xe.Nd})),n.d(e,"Vh",(function(){return xe.Od})),n.d(e,"Wh",(function(){return xe.Pd})),n.d(e,"Xh",(function(){return xe.Qd})),n.d(e,"Yh",(function(){return xe.Rd})),n.d(e,"Zh",(function(){return xe.Sd})),n.d(e,"ai",(function(){return xe.Td})),n.d(e,"ei",(function(){return xe.Ud})),n.d(e,"gi",(function(){return xe.Vd})),n.d(e,"ji",(function(){return xe.Xd})),n.d(e,"ki",(function(){return xe.Yd})),n.d(e,"ni",(function(){return xe.Zd})),n.d(e,"oi",(function(){return xe.ae})),n.d(e,"ti",(function(){return xe.be})),n.d(e,"wi",(function(){return xe.ce})),n.d(e,"xi",(function(){return xe.de})),n.d(e,"yi",(function(){return xe.ee})),n.d(e,"zi",(function(){return xe.fe})),n.d(e,"vg",(function(){return xe.Ac})),n.d(e,"jc",(function(){return xe.a})),n.d(e,"qf",(function(){return xe.Bb})),n.d(e,"Ef",(function(){return xe.Mb})),n.d(e,"Qf",(function(){return xe.Yb})),n.d(e,"Eh",(function(){return xe.yd})),n.d(e,"af",(function(){return xe.sb})),n.d(e,"rh",(function(){return xe.md})),n.d(e,"hi",(function(){return Oe})),n.d(e,"Je",(function(){return Jt.g})),n.d(e,"Ie",(function(){return Jt.f})),n.d(e,"ze",(function(){return Jt.c})),n.d(e,"te",(function(){return Jt.b})),n.d(e,"Be",(function(){return Jt.e})),n.d(e,"Le",(function(){return Jt.h})),n.d(e,"ag",(function(){return Jt.m})),n.d(e,"Ig",(function(){return Jt.n})),n.d(e,"di",(function(){return Jt.t})),n.d(e,"Ae",(function(){return Jt.d})),n.d(e,"xf",(function(){return Jt.l})),n.d(e,"fi",(function(){return Jt.u})),n.d(e,"mh",(function(){return Jt.r})),n.d(e,"Og",(function(){return Jt.o})),n.d(e,"ef",(function(){return Jt.k})),n.d(e,"Wg",(function(){return Jt.q})),n.d(e,"We",(function(){return Jt.i})),n.d(e,"Xe",(function(){return Jt.j})),n.d(e,"Rg",(function(){return Jt.p})),n.d(e,"Kd",(function(){return Jt.a})),n.d(e,"nh",(function(){return Jt.s})),n.d(e,"gf",(function(){return kt.c})),n.d(e,"ff",(function(){return kt.b})),n.d(e,"hf",(function(){return kt.d})),n.d(e,"Tg",(function(){return kt.f})),n.d(e,"Sg",(function(){return kt.e})),n.d(e,"mi",(function(){return kt.h})),n.d(e,"li",(function(){return kt.g})),n.d(e,"me",(function(){return kt.a})),n.d(e,"a",(function(){return wt.a})),n.d(e,"b",(function(){return wt.b})),n.d(e,"c",(function(){return wt.c})),n.d(e,"h",(function(){return wt.d})),n.d(e,"i",(function(){return wt.e})),n.d(e,"j",(function(){return wt.f})),n.d(e,"k",(function(){return wt.g})),n.d(e,"l",(function(){return wt.h})),n.d(e,"m",(function(){return wt.i})),n.d(e,"n",(function(){return wt.j})),n.d(e,"o",(function(){return wt.k})),n.d(e,"p",(function(){return wt.l})),n.d(e,"r",(function(){return wt.n})),n.d(e,"q",(function(){return wt.m})),n.d(e,"s",(function(){return wt.o})),n.d(e,"v",(function(){return wt.r})),n.d(e,"t",(function(){return wt.p})),n.d(e,"u",(function(){return wt.q})),n.d(e,"w",(function(){return wt.s})),n.d(e,"x",(function(){return wt.t})),n.d(e,"y",(function(){return wt.u})),n.d(e,"z",(function(){return wt.v})),n.d(e,"A",(function(){return wt.w})),n.d(e,"B",(function(){return wt.x})),n.d(e,"C",(function(){return wt.y})),n.d(e,"D",(function(){return wt.z})),n.d(e,"E",(function(){return wt.A})),n.d(e,"F",(function(){return wt.B})),n.d(e,"G",(function(){return wt.C})),n.d(e,"H",(function(){return wt.D})),n.d(e,"I",(function(){return wt.E})),n.d(e,"J",(function(){return wt.F})),n.d(e,"K",(function(){return wt.G})),n.d(e,"L",(function(){return wt.H})),n.d(e,"M",(function(){return wt.I})),n.d(e,"N",(function(){return wt.J})),n.d(e,"P",(function(){return wt.L})),n.d(e,"O",(function(){return wt.K})),n.d(e,"R",(function(){return wt.M})),n.d(e,"S",(function(){return wt.N})),n.d(e,"T",(function(){return wt.O})),n.d(e,"U",(function(){return wt.P})),n.d(e,"V",(function(){return wt.Q})),n.d(e,"W",(function(){return wt.R})),n.d(e,"X",(function(){return wt.S})),n.d(e,"Z",(function(){return wt.U})),n.d(e,"Y",(function(){return wt.T})),n.d(e,"xc",(function(){return wt.kc})),n.d(e,"bb",(function(){return wt.V})),n.d(e,"cb",(function(){return wt.W})),n.d(e,"fb",(function(){return wt.Y})),n.d(e,"eb",(function(){return wt.X})),n.d(e,"gb",(function(){return wt.Z})),n.d(e,"hb",(function(){return wt.ab})),n.d(e,"ib",(function(){return wt.bb})),n.d(e,"jb",(function(){return wt.cb})),n.d(e,"kb",(function(){return wt.db})),n.d(e,"lb",(function(){return wt.eb})),n.d(e,"mb",(function(){return wt.fb})),n.d(e,"nb",(function(){return wt.gb})),n.d(e,"pb",(function(){return wt.ib})),n.d(e,"tb",(function(){return wt.mb})),n.d(e,"sb",(function(){return wt.lb})),n.d(e,"ub",(function(){return wt.nb})),n.d(e,"vb",(function(){return wt.ob})),n.d(e,"xb",(function(){return wt.qb})),n.d(e,"wb",(function(){return wt.pb})),n.d(e,"yb",(function(){return wt.rb})),n.d(e,"zb",(function(){return wt.sb})),n.d(e,"Ab",(function(){return wt.tb})),n.d(e,"Bb",(function(){return wt.ub})),n.d(e,"Fb",(function(){return wt.xb})),n.d(e,"Gb",(function(){return wt.yb})),n.d(e,"Hb",(function(){return wt.zb})),n.d(e,"Ib",(function(){return wt.Ab})),n.d(e,"Jb",(function(){return wt.Bb})),n.d(e,"Kb",(function(){return wt.Cb})),n.d(e,"Mb",(function(){return wt.Eb})),n.d(e,"Nb",(function(){return wt.Fb})),n.d(e,"Ob",(function(){return wt.Gb})),n.d(e,"Lb",(function(){return wt.Db})),n.d(e,"Db",(function(){return wt.vb})),n.d(e,"Eb",(function(){return wt.wb})),n.d(e,"Pb",(function(){return wt.Hb})),n.d(e,"Vb",(function(){return wt.Nb})),n.d(e,"Qb",(function(){return wt.Ib})),n.d(e,"Tb",(function(){return wt.Lb})),n.d(e,"Rb",(function(){return wt.Jb})),n.d(e,"Sb",(function(){return wt.Kb})),n.d(e,"Ub",(function(){return wt.Mb})),n.d(e,"Wb",(function(){return wt.Ob})),n.d(e,"Xb",(function(){return wt.Pb})),n.d(e,"Yb",(function(){return wt.Qb})),n.d(e,"Zb",(function(){return wt.Rb})),n.d(e,"ac",(function(){return wt.Sb})),n.d(e,"cc",(function(){return wt.Tb})),n.d(e,"dc",(function(){return wt.Ub})),n.d(e,"ec",(function(){return wt.Vb})),n.d(e,"ic",(function(){return wt.Zb})),n.d(e,"fc",(function(){return wt.Wb})),n.d(e,"gc",(function(){return wt.Xb})),n.d(e,"hc",(function(){return wt.Yb})),n.d(e,"lc",(function(){return wt.bc})),n.d(e,"kc",(function(){return wt.ac})),n.d(e,"nc",(function(){return wt.cc})),n.d(e,"oc",(function(){return wt.dc})),n.d(e,"pc",(function(){return wt.ec})),n.d(e,"qc",(function(){return wt.fc})),n.d(e,"rc",(function(){return wt.gc})),n.d(e,"sc",(function(){return wt.hc})),n.d(e,"uc",(function(){return wt.ic})),n.d(e,"wc",(function(){return wt.jc})),n.d(e,"yc",(function(){return wt.lc})),n.d(e,"Ac",(function(){return wt.mc})),n.d(e,"Cc",(function(){return wt.oc})),n.d(e,"Fc",(function(){return wt.rc})),n.d(e,"Gc",(function(){return wt.sc})),n.d(e,"Dc",(function(){return wt.pc})),n.d(e,"Ec",(function(){return wt.qc})),n.d(e,"Bc",(function(){return wt.nc})),n.d(e,"Hc",(function(){return wt.tc})),n.d(e,"Jc",(function(){return wt.vc})),n.d(e,"Kc",(function(){return wt.wc})),n.d(e,"Mc",(function(){return wt.xc})),n.d(e,"Nc",(function(){return wt.yc})),n.d(e,"Oc",(function(){return wt.zc})),n.d(e,"Tc",(function(){return wt.Ec})),n.d(e,"Rc",(function(){return wt.Cc})),n.d(e,"Sc",(function(){return wt.Dc})),n.d(e,"Qc",(function(){return wt.Bc})),n.d(e,"Pc",(function(){return wt.Ac})),n.d(e,"Vc",(function(){return wt.Gc})),n.d(e,"Zc",(function(){return wt.Kc})),n.d(e,"fd",(function(){return wt.Qc})),n.d(e,"Wc",(function(){return wt.Hc})),n.d(e,"Yc",(function(){return wt.Jc})),n.d(e,"Uc",(function(){return wt.Fc})),n.d(e,"bd",(function(){return wt.Mc})),n.d(e,"ad",(function(){return wt.Lc})),n.d(e,"ed",(function(){return wt.Pc})),n.d(e,"Xc",(function(){return wt.Ic})),n.d(e,"dd",(function(){return wt.Oc})),n.d(e,"gd",(function(){return wt.Rc})),n.d(e,"hd",(function(){return wt.Sc})),n.d(e,"kd",(function(){return wt.Tc})),n.d(e,"ld",(function(){return wt.Uc})),n.d(e,"md",(function(){return wt.Vc})),n.d(e,"nd",(function(){return wt.Wc})),n.d(e,"od",(function(){return wt.Xc})),n.d(e,"pd",(function(){return wt.Yc})),n.d(e,"rd",(function(){return wt.Zc})),n.d(e,"cd",(function(){return wt.Nc})),n.d(e,"ob",(function(){return wt.hb})),n.d(e,"Ic",(function(){return wt.uc})),n.d(e,"sd",(function(){return wt.ad})),n.d(e,"qb",(function(){return wt.jb})),n.d(e,"rb",(function(){return wt.kb})),n.d(e,"Td",(function(){return xe.z})),n.d(e,"Oe",(function(){return xe.ib})),n.d(e,"mf",(function(){return xe.xb})),n.d(e,"nf",(function(){return xe.yb})),n.d(e,"Cf",(function(){return xe.Kb})),n.d(e,"Df",(function(){return xe.Lb})),n.d(e,"rg",(function(){return xe.wc})),n.d(e,"yd",(function(){return xe.g})),n.d(e,"Ee",(function(){return xe.cb})),n.d(e,"Yf",(function(){return xe.fc})),n.d(e,"dg",(function(){return xe.jc})),n.d(e,"gg",(function(){return xe.mc})),n.d(e,"kg",(function(){return xe.qc})),n.d(e,"Eg",(function(){return xe.Jc})),n.d(e,"Jh",(function(){return xe.Dd})),n.d(e,"Ph",(function(){return xe.Jd})),n.d(e,"ii",(function(){return xe.Wd})),n.d(e,"pg",(function(){return xe.uc})),n.d(e,"ig",(function(){return xe.oc})),n.d(e,"hh",(function(){return xe.gd})),n.d(e,"Dh",(function(){return xe.xd})),n.d(e,"cf",(function(){return xe.ub})),n.d(e,"Ge",(function(){return xe.eb})),n.d(e,"Ke",(function(){return xe.gb})),n.d(e,"pe",(function(){return xe.T})),n.d(e,"rf",(function(){return xe.Cb}))},function(t,e,n){"use strict";n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return d}));var r=n(5),i=n(23),a=n(6),o=n(7),s=n(10);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e){let n=t;if(Object(o.A)(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||Object(o.A)(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&Object(i.c)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,r){if(r=r||[],!Array.isArray(e)&&!Object(o.A)(e))return void Object(o.b)(0===n.length,()=>`Element arr[${r.join("][")}] is a primitive, but should be an array/TypedArray of ${n[0]} elements`);Object(o.b)(n.length>0,()=>`Element arr[${r.join("][")}] should be a primitive, but is an array of ${e.length} elements`),Object(o.b)(e.length===n[0],()=>`Element arr[${r.join("][")}] should have ${n[0]} elements, but has ${e.length} elements`);const i=n.slice(1);for(let n=0;n<e.length;++n)t(e[n],i,r.concat(n))}(t,r,[]),r}function c(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function l(t,e,n,i="numeric"){if(t instanceof a.a)return c(i,t.dtype,e,n),t;let l=Object(o.r)(t);if("string"!==l&&["bool","int32","float32"].indexOf(i)>=0&&(l=i),c(i,l,e,n),null==t||!Object(o.A)(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t){const r=null==t?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${r}'`)}const d=u(t,l);Object(o.A)(t)||Array.isArray(t)||(t=[t]);const f="string"!==l?Object(s.toTypedArray)(t,l):Object(o.m)(t,[],!0);return r.a.makeTensor(f,d,l)}function d(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((t,i)=>l(t,`${e}[${i}]`,n,r))}},function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"g",(function(){return c})),n.d(e,"c",(function(){return l})),n.d(e,"a",(function(){return d}));var r=n(0);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(t,e,n,i,o){const s=e.inputParams[t];if(s&&void 0!==s.inputIndexStart){const t=s.inputIndexStart,u=0===s.inputIndexEnd?void 0:void 0===s.inputIndexEnd?t+1:s.inputIndexEnd;if("tensor"===s.type)return a(e.inputNames[s.inputIndexStart],n,i,o);if("tensors"===s.type){return e.inputNames.slice(t,u).map(t=>a(t,n,i,o))}const c=a(e.inputNames.slice(t)[0],n,i,o),l=c.dataSync();return"number"===s.type?l[0]:r.qi.toNestedArray(c.shape,l)}const u=e.attrParams[t];return u&&u.value}function a(t,e,n,r){const[i,a]=c(t);if(null!=r){const t=r.getHashTableHandleByName(i);if(null!=t)return t}const o=n.currentContextIds.find(t=>!!e[u(i,t)]);return void 0!==o?e[u(i,o)][a]:void 0}function o(t,e,n){return e[u(t,n.currentContextId)]}function s(t,e){const[n,r]=c(t);return[u(n,e&&e.currentContextId),r]}function u(t,e){return e?`${t}-${e}`:t}function c(t){const e=t.split(":");if(1===e.length)return[t,0];return[e[0],Number(e[e.length-1])]}function l(t,e,n){let r=i("pad",t,e,n);if("explicit"===r){r=i("explicitPaddings",t,e,n);const a=[[0,0],[0,0],[0,0],[0,0]];for(let t=0;t<4;t++)a[t][0]=r[2*t],a[t][1]=r[2*t+1];return a}return r}function d(t){return t.kept?t:Object(r.ae)(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return s})),n.d(e,"f",(function(){return u})),n.d(e,"g",(function(){return c})),n.d(e,"h",(function(){return l})),n.d(e,"i",(function(){return d})),n.d(e,"j",(function(){return f})),n.d(e,"k",(function(){return h})),n.d(e,"l",(function(){return p})),n.d(e,"n",(function(){return m})),n.d(e,"m",(function(){return g})),n.d(e,"o",(function(){return b})),n.d(e,"r",(function(){return y})),n.d(e,"p",(function(){return v})),n.d(e,"q",(function(){return x})),n.d(e,"s",(function(){return w})),n.d(e,"t",(function(){return k})),n.d(e,"u",(function(){return O})),n.d(e,"v",(function(){return _})),n.d(e,"w",(function(){return A})),n.d(e,"x",(function(){return C})),n.d(e,"y",(function(){return E})),n.d(e,"z",(function(){return S})),n.d(e,"A",(function(){return j})),n.d(e,"B",(function(){return N})),n.d(e,"C",(function(){return T})),n.d(e,"D",(function(){return F})),n.d(e,"E",(function(){return D})),n.d(e,"F",(function(){return I})),n.d(e,"G",(function(){return M})),n.d(e,"H",(function(){return $})),n.d(e,"I",(function(){return R})),n.d(e,"J",(function(){return B})),n.d(e,"L",(function(){return z})),n.d(e,"K",(function(){return L})),n.d(e,"M",(function(){return P})),n.d(e,"N",(function(){return q})),n.d(e,"O",(function(){return W})),n.d(e,"P",(function(){return U})),n.d(e,"Q",(function(){return V})),n.d(e,"R",(function(){return G})),n.d(e,"S",(function(){return H})),n.d(e,"U",(function(){return X})),n.d(e,"T",(function(){return K})),n.d(e,"kc",(function(){return Y})),n.d(e,"V",(function(){return J})),n.d(e,"W",(function(){return Z})),n.d(e,"Y",(function(){return Q})),n.d(e,"X",(function(){return tt})),n.d(e,"Z",(function(){return et})),n.d(e,"ab",(function(){return nt})),n.d(e,"bb",(function(){return rt})),n.d(e,"cb",(function(){return it})),n.d(e,"db",(function(){return at})),n.d(e,"eb",(function(){return ot})),n.d(e,"fb",(function(){return st})),n.d(e,"gb",(function(){return ut})),n.d(e,"ib",(function(){return ct})),n.d(e,"mb",(function(){return lt})),n.d(e,"lb",(function(){return dt})),n.d(e,"nb",(function(){return ft})),n.d(e,"ob",(function(){return ht})),n.d(e,"qb",(function(){return pt})),n.d(e,"pb",(function(){return mt})),n.d(e,"rb",(function(){return gt})),n.d(e,"sb",(function(){return bt})),n.d(e,"tb",(function(){return yt})),n.d(e,"ub",(function(){return vt})),n.d(e,"xb",(function(){return xt})),n.d(e,"yb",(function(){return wt})),n.d(e,"zb",(function(){return kt})),n.d(e,"Ab",(function(){return Ot})),n.d(e,"Bb",(function(){return _t})),n.d(e,"Cb",(function(){return At})),n.d(e,"Eb",(function(){return Ct})),n.d(e,"Fb",(function(){return Et})),n.d(e,"Gb",(function(){return St})),n.d(e,"Db",(function(){return jt})),n.d(e,"vb",(function(){return Nt})),n.d(e,"wb",(function(){return Tt})),n.d(e,"Hb",(function(){return Ft})),n.d(e,"Nb",(function(){return Dt})),n.d(e,"Ib",(function(){return It})),n.d(e,"Lb",(function(){return Mt})),n.d(e,"Jb",(function(){return $t})),n.d(e,"Kb",(function(){return Rt})),n.d(e,"Mb",(function(){return Bt})),n.d(e,"Ob",(function(){return zt})),n.d(e,"Pb",(function(){return Lt})),n.d(e,"Qb",(function(){return Pt})),n.d(e,"Rb",(function(){return qt})),n.d(e,"Sb",(function(){return Wt})),n.d(e,"Tb",(function(){return Ut})),n.d(e,"Ub",(function(){return Vt})),n.d(e,"Vb",(function(){return Gt})),n.d(e,"Zb",(function(){return Ht})),n.d(e,"Wb",(function(){return Xt})),n.d(e,"Xb",(function(){return Kt})),n.d(e,"Yb",(function(){return Yt})),n.d(e,"bc",(function(){return Jt})),n.d(e,"ac",(function(){return Zt})),n.d(e,"cc",(function(){return Qt})),n.d(e,"dc",(function(){return te})),n.d(e,"ec",(function(){return ee})),n.d(e,"fc",(function(){return ne})),n.d(e,"gc",(function(){return re})),n.d(e,"hc",(function(){return ie})),n.d(e,"ic",(function(){return ae})),n.d(e,"jc",(function(){return oe})),n.d(e,"lc",(function(){return se})),n.d(e,"mc",(function(){return ue})),n.d(e,"oc",(function(){return ce})),n.d(e,"rc",(function(){return le})),n.d(e,"sc",(function(){return de})),n.d(e,"pc",(function(){return fe})),n.d(e,"qc",(function(){return he})),n.d(e,"nc",(function(){return pe})),n.d(e,"tc",(function(){return me})),n.d(e,"vc",(function(){return ge})),n.d(e,"wc",(function(){return be})),n.d(e,"xc",(function(){return ye})),n.d(e,"yc",(function(){return ve})),n.d(e,"zc",(function(){return xe})),n.d(e,"Ec",(function(){return we})),n.d(e,"Cc",(function(){return ke})),n.d(e,"Dc",(function(){return Oe})),n.d(e,"Bc",(function(){return _e})),n.d(e,"Ac",(function(){return Ae})),n.d(e,"Gc",(function(){return Ce})),n.d(e,"Kc",(function(){return Ee})),n.d(e,"Qc",(function(){return Se})),n.d(e,"Hc",(function(){return je})),n.d(e,"Jc",(function(){return Ne})),n.d(e,"Fc",(function(){return Te})),n.d(e,"Mc",(function(){return Fe})),n.d(e,"Lc",(function(){return De})),n.d(e,"Pc",(function(){return Ie})),n.d(e,"Ic",(function(){return Me})),n.d(e,"Oc",(function(){return $e})),n.d(e,"Rc",(function(){return Re})),n.d(e,"Sc",(function(){return Be})),n.d(e,"Tc",(function(){return ze})),n.d(e,"Uc",(function(){return Le})),n.d(e,"Vc",(function(){return Pe})),n.d(e,"Wc",(function(){return qe})),n.d(e,"Xc",(function(){return We})),n.d(e,"Yc",(function(){return Ue})),n.d(e,"Zc",(function(){return Ve})),n.d(e,"Nc",(function(){return Ge})),n.d(e,"hb",(function(){return He})),n.d(e,"uc",(function(){return Xe})),n.d(e,"ad",(function(){return Ke})),n.d(e,"jb",(function(){return Ye})),n.d(e,"kb",(function(){return Je}));const r="Abs",i="Acos",a="Acosh",o="Add",s="AddN",u="All",c="Any",l="ArgMax",d="ArgMin",f="Asin",h="Asinh",p="Atan",m="Atanh",g="Atan2",b="AvgPool",y="AvgPoolGrad",v="AvgPool3D",x="AvgPool3DGrad",w="BatchMatMul",k="BatchToSpaceND",O="Bincount",_="BroadcastTo",A="Cast",C="Ceil",E="ClipByValue",S="Complex",j="ComplexAbs",N="Concat",T="Conv2D",F="Conv2DBackpropFilter",D="Conv2DBackpropInput",I="Conv3D",M="Conv3DBackpropFilterV2",$="Conv3DBackpropInputV2",R="Cos",B="Cosh",z="Cumsum",L="CropAndResize",P="DenseBincount",q="DepthToSpace",W="DepthwiseConv2dNative",U="DepthwiseConv2dNativeBackpropFilter",V="DepthwiseConv2dNativeBackpropInput",G="Diag",H="Dilation2D",X="Dilation2DBackpropInput",K="Dilation2DBackpropFilter",Y="RealDiv",J="Elu",Z="EluGrad",Q="Erf",tt="Equal",et="Exp",nt="ExpandDims",rt="Expm1",it="FFT",at="Fill",ot="FlipLeftRight",st="Floor",ut="FloorDiv",ct="FusedBatchNorm",lt="GatherV2",dt="GatherNd",ft="Greater",ht="GreaterEqual",pt="Identity",mt="IFFT",gt="Imag",bt="IsFinite",yt="IsInf",vt="IsNan",xt="LeakyRelu",wt="Less",kt="LessEqual",Ot="LinSpace",_t="Log",At="Log1p",Ct="LogicalAnd",Et="LogicalNot",St="LogicalOr",jt="LogSoftmax",Nt="LRN",Tt="LRNGrad",Ft="Max",Dt="Maximum",It="MaxPool",Mt="MaxPoolGrad",$t="MaxPool3D",Rt="MaxPool3DGrad",Bt="MaxPoolWithArgmax",zt="Mean",Lt="Min",Pt="Minimum",qt="MirrorPad",Wt="Mod",Ut="Multinomial",Vt="Multiply",Gt="Neg",Ht="NotEqual",Xt="NonMaxSuppressionV3",Kt="NonMaxSuppressionV4",Yt="NonMaxSuppressionV5",Jt="OnesLike",Zt="OneHot",Qt="Pack",te="PadV2",ee="Pool",ne="Pow",re="Prelu",ie="Prod",ae="Range",oe="Real",se="Reciprocal",ue="Relu",ce="Reshape",le="ResizeNearestNeighbor",de="ResizeNearestNeighborGrad",fe="ResizeBilinear",he="ResizeBilinearGrad",pe="Relu6",me="Reverse",ge="Round",be="Rsqrt",ye="ScatterNd",ve="Select",xe="Selu",we="Slice",ke="Sin",Oe="Sinh",_e="Sign",Ae="Sigmoid",Ce="Softplus",Ee="Sqrt",Se="Sum",je="SpaceToBatchND",Ne="SplitV",Te="Softmax",Fe="SquaredDifference",De="Square",Ie="Sub",Me="SparseToDense",$e="StridedSlice",Re="Tan",Be="Tanh",ze="Tile",Le="TopK",Pe="Transpose",qe="Unique",We="Unpack",Ue="UnsortedSegmentSum",Ve="ZerosLike",Ge="Step",He="FromPixels",Xe="RotateWithOffset",Ke="_FusedMatMul",Ye="FusedConv2D",Je="FusedDepthwiseConv2D"},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return o}));var r=n(5),i=n(7);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const a="__op";function o(t){const e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");let n=e[0];const o=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=a;const s=(...t)=>{r.a.startScope(n);try{const e=o(...t);return Object(i.x)(e)&&console.error("Cannot return a Promise inside of tidy."),r.a.endScope(e),e}catch(t){throw r.a.endScope(null),t}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}},function(t,e,n){"use strict";var r=n(153),i=n(23),a=n(156),o=n(3),s=n(67),u=n(7);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class c{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new d)}profileKernel(t,e,n){let r;const a=this.backendTimer.time(()=>{r=n()});if(Object(i.c)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let e=0;e<r.length;e++){const n=r[e];n.data().then(e=>{l(e,n.dtype,t)})}return{kernelName:t,outputs:r,inputs:e,timeMs:a.then(t=>t.kernelMs),extraInfo:a.then(t=>null!=t.getExtraProfileInfo?t.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:e,outputs:n,timeMs:r,inputs:i,extraInfo:a}=t;n.forEach(t=>{Promise.all([t.data(),r,a]).then(n=>{this.logger.logKernelProfile(e,t,n[0],n[1],i,n[2])})})}}function l(t,e,n){if("float32"!==e)return!1;for(let e=0;e<t.length;e++){const r=t[e];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class d{logKernelProfile(t,e,n,r,i,a){const o="number"==typeof r?u.L(r+"ms",9):r.error,s=u.L(t,25),c=e.rank,l=e.size,d=u.L(e.shape.toString(),14);let f="";for(const t in i){const n=i[t];if(null!=n){const r=n.shape||e.shape,i=r.length;f+=`${t}: ${i}D ${i>0?r:""} `}}console.log(`%c${s}\t%c${o}\t%c${c}D ${d}\t%c${l}\t%c${f}\t%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var f=n(6),h=n(22),p=n(10);n.d(e,"b",(function(){return b})),n.d(e,"a",(function(){return y}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class m{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class g{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new m}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e,n=1){return t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t);if(!(n?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new c(this.backendInstance),!0}setupRegisteredKernels(){Object(s.d)(this.backendName).forEach(t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){Object(s.d)(t).forEach(e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])})}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const n=e.factory();if(!n||n instanceof r.b||"function"!=typeof n.then)return this.registry[t]=n,{success:!0,asyncInit:!1};{const e=++this.pendingBackendInitId,r=n.then(n=>!(e<this.pendingBackendInitId)&&(this.registry[t]=n,this.pendingBackendInit=null,!0)).catch(n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,console.warn(`Initialization of backend ${t} failed`),console.warn(n.stack||n.message)),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(e){return console.warn(`Initialization of backend ${t} failed`),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:r,asyncInit:i}=this.initializeBackend(n);if(i||r)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e);r.disposeData(e),n.backend=t,t.move(e,i,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,r=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}return this.scopedRun(()=>this.startScope(r),()=>this.endScope(n),()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(t){throw e(),t}}nextTensorId(){return g.nextTensorId++}nextVariableId(){return g.nextVariableId++}clone(t){const e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],t=>({x:()=>{const e={x:t},n={dtype:"float32"};return y.runKernelFunc(e=>e.cast(t,"float32"),e,null,o.w,n)}}),[],{}),e}runKernel(t,e,n,r,i){return this.runKernelFunc(null,e,null,t,n,r,i)}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const r=this.backend.numDataIds();let i=0;n.forEach(t=>{i+="complex64"===t.dtype?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-i-a;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${t}'`)}runKernelFunc(t,e,n,r,i,a,o){let u,c=[];const l=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");const d=this.state.numBytes,f=this.state.numTensors;let h;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);const p=Object(s.c)(r,this.backendName);let m,g;if(null!=p)h=()=>{const t=this.backend.numDataIds();m=p.kernelFunc({inputs:e,attrs:i,backend:this.backend});const n=Array.isArray(m)?m:[m];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(r,t,n);const s=n.map(t=>{if(null!=t.rank)return t;const{dataId:e,shape:n,dtype:r}=t;return this.makeTensorFromDataId(e,n,r)});if(l){let t=this.getTensorsForGradient(r,e,s);if(null==t){null==o&&(o=[]);const e=s.filter((t,e)=>o[e]);t=(a||[]).slice().concat(e)}c=this.saveTensorsForBackwardMode(t)}return s};else{if(null==t)throw new Error(`Error running ${r}: Neither modular kernel nor forward func passed`);const e=t=>{l&&(c=t.map(t=>this.keep(this.clone(t))))};h=()=>{const n=this.backend.numDataIds();m=this.tidy(()=>t(this.backend,e));const i=Array.isArray(m)?m:[m];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(r,n,i),i}}return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(g=this.profiler.profileKernel(r,e,()=>h()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(g),u=g.outputs):u=h()}),l&&this.addTapeNode(r,e,u,n,c,i),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-d,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-f,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(t=>null!=e[t]?e[t].shape:null),outputShapes:u.map(t=>t.shape),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(m)?u:u[0]}saveTensorsForBackwardMode(t){return t.map(t=>this.keep(this.clone(t)))}getTensorsForGradient(t,e,n){const r=Object(s.b)(t);if(null!=r){const t=r.inputsToSave||[],i=r.outputsToSave||[];let a;r.saveAllInputs?(u.b(Array.isArray(e),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(e).map(t=>e[t])):a=t.map(t=>e[t]);const o=n.filter((t,e)=>i[e]);return a.concat(o)}return null}makeTensor(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let i=t;"string"===n&&u.z(t[0])&&(i=t.map(t=>p.encodeString(t)));const a=r.write(i,e,n),o=new f.a(e,n,a,this.nextTensorId());if(this.incRef(o,r),"string"===n){const t=this.state.tensorInfo.get(a),e=Object(u.f)(i);this.state.numBytes+=e-t.bytes,t.bytes=e}return o}makeTensorFromDataId(t,e,n,r){n=n||"float32";const i=new f.a(e,n,t,this.nextTensorId());return this.incRef(i,r),i}makeVariable(t,e=!0,n,r){n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));const i=new f.c(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}incRef(t,e){const n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*u.g(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n,refCount:0}),this.state.numBytes+=n}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof f.c||this.track(t)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;const e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(t=>t.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const t of this.state.activeProfile.kernels)t.kernelTimeMs=await t.kernelTimeMs,t.extraInfo=await t.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,r,i,a){const o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},c=Object(s.b)(t);null!=c&&(r=c.gradFunc),null!=r&&(o.gradient=t=>(t=t.map((t,e)=>{if(null==t){const t=n[e],r=u.F(t.size,t.dtype);return this.makeTensor(r,t.shape,t.dtype)}return t}),r(t.length>1?t:t[0],i,a))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=Object(h.getTensorsInContainer)(t),n=new Set(e.map(t=>t.id));for(let t=0;t<this.state.activeScope.track.length;t++){const e=this.state.activeScope.track[t];e.kept||n.has(e.id)||e.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach(t=>{t.kept||t.scopeId!==r.id||this.track(t)})}gradients(t,e,n,r=!1){if(u.b(e.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));u.b(i instanceof f.a,()=>"The result y returned by f() must be a tensor.");const a=function(t,e,n){const r={},i={};for(let t=0;t<e.length;t++)r[e[t].id]=!0;for(let n=0;n<t.length;n++){const a=t[n],o=a.inputs;for(const t in o){const n=o[t];let s=!1;for(let t=0;t<e.length;t++)if(r[n.id]){a.outputs.forEach(t=>r[t.id]=!0),s=!0,i[a.id]=!0;break}if(s)break}}const a={};a[n.id]=!0;const o={};for(let e=t.length-1;e>=0;e--){const n=t[e],r=n.inputs;for(let t=0;t<n.outputs.length;t++)if(a[n.outputs[t].id]){for(const t in r)a[r[t].id]=!0,o[n.id]=!0;break}}const s=[];for(let e=0;e<t.length;e++){const n=t[e];if(i[n.id]&&o[n.id]){const t={};for(const e in n.inputs){const i=n.inputs[e];r[i.id]&&(t[e]=i)}const e=Object.assign({},n);e.inputs=t,e.outputs=n.outputs,s.push(e)}}return s}(this.state.activeTape,e,i);if(!r&&0===a.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const t={};t[i.id]=null==n?function(t){const e=Object(u.D)(Object(u.N)(t),"float32");return y.makeTensor(e,t,"float32")}(i.shape):n,function(t,e,n,r){for(let i=e.length-1;i>=0;i--){const a=e[i],o=[];if(a.outputs.forEach(e=>{const n=t[e.id];null!=n?o.push(n):o.push(null)}),null==a.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const s=a.gradient(o);for(const e in a.inputs){if(!(e in s))throw new Error(`Cannot backprop through input ${e}. Available gradients found: ${Object.keys(s)}.`);const i=n(()=>s[e]());if("float32"!==i.dtype)throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${e} must have 'float32' dtype, but has '${i.dtype}'`);const o=a.inputs[e];if(!u.a(i.shape,o.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${e}' has shape '${i.shape}', which does not match the shape of the input '${o.shape}'`);if(null==t[o.id])t[o.id]=i;else{const e=t[o.id];t[o.id]=r(e,i),e.dispose()}}}}(t,a,t=>this.tidy(t),v);const r=e.map(e=>t[e.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(t=>{for(const e of t.saved)e.dispose()}),this.state.activeTape=null),{value:i,grads:r}})}customGrad(t){return u.b(u.u(t),()=>"The f passed in customGrad(f) must be a function."),(...e)=>{let n;u.b(e.every(t=>t instanceof f.a),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");const r={};return e.forEach((t,e)=>{r[e]=t}),this.runKernelFunc((r,i)=>(n=t(...e,i),u.b(n.value instanceof f.a,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),u.b(u.u(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),r,(t,r)=>{const i=n.gradFunc(t,r),a=Array.isArray(i)?i:[i];u.b(a.length===e.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),u.b(a.every(t=>t instanceof f.a),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const o={};return a.forEach((t,e)=>{o[e]=()=>t}),o})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}async time(t){const e=Object(p.now)(),n=await this.backend.time(t);return n.wallMs=Object(p.now)()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new m;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function b(){const t=Object(a.b)();if(null==t._tfengine){const e=new i.b(t);t._tfengine=new g(e)}return Object(i.d)(t._tfengine.ENV),Object(f.f)(()=>t._tfengine),t._tfengine}g.nextTensorId=0,g.nextVariableId=0;const y=b();function v(t,e){const n={a:t,b:e};return y.runKernel(o.d,n)}},function(t,e,n){"use strict";var r=n(7);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(t,e,n,i){const u=Object(r.j)(e),c=function(t,e,n,i){const o=Object(r.N)(e),u=i[i.length-1],c=new Array(u).fill(0),l=e.length,d="complex64"===n?s(t):t;if(l>1)for(let t=0;t<o/u;t++){const e=t*u;for(let t=0;t<u;t++)c[t]=Math.max(c[t],a(d[e+t],0,n).length)}return c}(t,e,n,u),l=e.length,d=function t(e,n,r,i,u,c=!0){const l="complex64"===r?2:1,d=n[0],f=n.length;if(0===f){if("complex64"===r){return[a(s(e)[0],0,r)]}return"bool"===r?[o(e[0])]:[e[0].toString()]}if(1===f){if(d>20){const t=3*l;let n=Array.from(e.slice(0,t)),i=Array.from(e.slice((d-3)*l,d*l));return"complex64"===r&&(n=s(n),i=s(i)),["["+n.map((t,e)=>a(t,u[e],r)).join(", ")+", ..., "+i.map((t,e)=>a(t,u[d-3+e],r)).join(", ")+"]"]}return["["+("complex64"===r?s(e):Array.from(e)).map((t,e)=>a(t,u[e],r)).join(", ")+"]"]}const h=n.slice(1),p=i.slice(1),m=i[0]*l,g=[];if(d>20){for(let n=0;n<3;n++){const i=n*m,a=i+m;g.push(...t(e.slice(i,a),h,r,p,u,!1))}g.push("...");for(let n=d-3;n<d;n++){const i=n*m,a=i+m;g.push(...t(e.slice(i,a),h,r,p,u,n===d-1))}}else for(let n=0;n<d;n++){const i=n*m,a=i+m;g.push(...t(e.slice(i,a),h,r,p,u,n===d-1))}const b=2===f?",":"";g[0]="["+g[0]+b;for(let t=1;t<g.length-1;t++)g[t]=" "+g[t]+b;let y=",\n";for(let t=2;t<f;t++)y+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(c?"":y),g}(t,e,n,u,c),f=["Tensor"];return i&&(f.push("  dtype: "+n),f.push("  rank: "+l),f.push(`  shape: [${e}]`),f.push("  values:")),f.push(d.map(t=>"    "+t).join("\n")),f.join("\n")}function a(t,e,n){let i;return i=Array.isArray(t)?parseFloat(t[0].toFixed(7))+" + "+parseFloat(t[1].toFixed(7))+"j":Object(r.z)(t)?`'${t}'`:"bool"===n?o(t):parseFloat(t.toFixed(7)).toString(),Object(r.L)(i,e)}function o(t){return 0===t?"false":"true"}function s(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var u=n(10);n.d(e,"b",(function(){return c})),n.d(e,"f",(function(){return h})),n.d(e,"e",(function(){return p})),n.d(e,"d",(function(){return m})),n.d(e,"a",(function(){return g})),n.d(e,"c",(function(){return b}));
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class c{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=r.N(t),null!=n){const t=n.length;r.b(t===this.size,()=>`Length of values '${t}' does not match the size inferred by the shape '${this.size}'.`)}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||r.n(e,this.size),this.strides=Object(r.j)(t)}set(t,...e){0===e.length&&(e=[0]),r.b(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`);const n=this.locToIndex(e);this.values[n]=t}get(...t){0===t.length&&(t=[0]);let e=0;for(const n of t){if(n<0||n>=this.shape[e]){const e=`Requested out of range element at ${t}.   Buffer shape=`+this.shape;throw new Error(e)}e++}let n=t[t.length-1];for(let e=0;e<t.length-1;++e)n+=this.strides[e]*t[e];return this.values[n]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return l().makeTensor(this.values,this.shape,this.dtype)}}let l=null,d=null,f=null;function h(t){l=t}function p(t){d=t}function m(t){f=t}class g{constructor(t,e,n,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=r.N(t),this.strides=Object(r.j)(t),this.dataId=n,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return d.buffer(this.shape,this.dtype,t)}bufferSync(){return d.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Object(r.S)(this.shape,t)}arraySync(){return Object(r.S)(this.shape,this.dataSync())}async data(){this.throwIfDisposed();const t=l().read(this.dataId);if("string"===this.dtype){const e=await t;try{return e.map(t=>u.decodeString(t))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataSync(){this.throwIfDisposed();const t=l().readSync(this.dataId);if("string"===this.dtype)try{return t.map(t=>u.decodeString(t))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await l().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(l().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return d.print(this,t)}clone(){return this.throwIfDisposed(),d.clone(this)}toString(t=!1){return i(this.dataSync(),this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),d.cast(this,t)}variable(t=!0,e,n){return this.throwIfDisposed(),l().makeVariable(this,t,e,n)}}Object.defineProperty(g,Symbol.hasInstance,{value:t=>!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed});class b extends g{constructor(t,e,n,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!r.a(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);l().disposeTensor(this),this.dataId=t.dataId,l().incRef(this,null)}dispose(){l().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(b,Symbol.hasInstance,{value:t=>t instanceof g&&null!=t.assign&&t.assign instanceof Function})},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function r(t){let e=t.length,n=0,r=0;for(;e>0;)r=Math.random()*e|0,e--,n=t[e],t[e]=t[r],t[r]=n}function i(t,e,n){return Math.max(t,Math.min(e,n))}function a(t){return t%2==0?t:t+1}function o(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function s(t,e){const n=Math.random();return e*n+(1-n)*t}function u(t,e){let n=0;for(let r=0;r<t.length;r++){const i=Number(t[r])-Number(e[r]);n+=i*i}return n}function c(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function l(t,e,n=""){c(m(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function d(t){c(null!=t,()=>"The input to the tensor constructor must be a non-null value.")}function f(t,e=[],n=!1){if(null==e&&(e=[]),Array.isArray(t)||N(t)&&!n)for(let r=0;r<t.length;++r)f(t[r],e,n);else e.push(t);return e}function h(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function p(t){return 0===t.length}function m(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function g(t){return t%1==0}function b(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function y(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function v(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return r(e),e}function x(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function w(t,e=(t=>0),n){return new Promise((r,i)=>{let a=0;const o=()=>{if(t())return void r();a++;const s=e(a);null!=n&&a>=n?i():setTimeout(o,s)};o()})}function k(t,e){let n=1,r=-1;for(let e=0;e<t.length;++e)if(t[e]>=0)n*=t[e];else if(-1===t[e]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${e}`);r=e}else if(t[e]<0)throw Error(`Shapes can not be < 0. Found ${t[e]} at dim ${e}`);if(-1===r){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(0===n)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!=0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const i=t.slice();return i[r]=e/n,i}function O(t,e){const n=e.length;return c((t=null==t?e.map((t,e)=>e):[].concat(t)).every(t=>t>=-n&&t<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis `+t),c(t.every(t=>g(t)),()=>"All values in axis param must be integers but got axis "+t),t.map(t=>t<0?n+t:t)}function _(t,e){const n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,a=null==e||i?null:O(e,t).sort();let o=0;for(let e=0;e<t.length;++e){if(null!=a){if(a[o]===e&&1!==t[e])throw new Error(`Can't squeeze axis ${e} since its dim '${t[e]}' is not 1`);(null==a[o]||a[o]>e)&&1===t[e]&&(n.push(t[e]),r.push(e)),a[o]<=e&&o++}1!==t[e]&&(n.push(t[e]),r.push(e))}return{newShape:n,keptDims:r}}function A(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function C(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function E(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function S(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function j(t,e){return"complex64"!==e&&(("float32"!==e||"complex64"===t)&&(("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)))}function N(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function T(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function F(t){if(null==t)return 0;let e=0;return t.forEach(t=>e+=t.length),e}function D(t){return"string"==typeof t||t instanceof String}function I(t){return"boolean"==typeof t}function M(t){return"number"==typeof t}function $(t){return Array.isArray(t)?$(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":M(t)?"float32":D(t)?"string":I(t)?"bool":"float32"}function R(t){return!!(t&&t.constructor&&t.call&&t.apply)}function B(t,e){for(let n=e;n<t;++n)if(t%n==0)return n;return t}function z(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function L(t,e){if(0===t.length)return e[0];const n=t.reduce((t,e)=>t*e);if(0===n)return[];if(n!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}.`);return function t(e,n,r){const i=new Array;if(1===n.length){const t=n[0];for(let n=0;n<t;n++)i[n]=r[e+n]}else{const a=n[0],o=n.slice(1),s=o.reduce((t,e)=>t*e);for(let n=0;n<a;n++)i[n]=t(e+n*s,o,r)}return i}(0,t,e)}function P(t,e){const n=q(t,e);for(let t=0;t<n.length;t++)n[t]=1;return n}function q(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function W(t,e){const n=t.reduce((t,e)=>t*e,1);if(null==e||"float32"===e)return L(t,new Float32Array(n));if("int32"===e)return L(t,new Int32Array(n));if("bool"===e)return L(t,new Uint8Array(n));throw new Error("Unknown data type "+e)}function U(t){t.forEach(e=>{c(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function V(t,e,n){if(0===e)return 0;if(1===e)return t[0];let r=t[t.length-1];for(let e=0;e<t.length-1;++e)r+=n[e]*t[e];return r}function G(t,e,n){if(0===e)return[];if(1===e)return[t];const r=new Array(e);for(let e=0;e<r.length-1;++e)r[e]=Math.floor(t/n[e]),t-=r[e]*n[e];return r[r.length-1]=t,r}function H(t){return t&&t.then&&"function"==typeof t.then}n.d(e,"M",(function(){return r})),n.d(e,"i",(function(){return i})),n.d(e,"H",(function(){return a})),n.d(e,"Q",(function(){return o})),n.d(e,"J",(function(){return s})),n.d(e,"l",(function(){return u})),n.d(e,"b",(function(){return c})),n.d(e,"e",(function(){return l})),n.d(e,"d",(function(){return d})),n.d(e,"m",(function(){return f})),n.d(e,"N",(function(){return h})),n.d(e,"y",(function(){return p})),n.d(e,"a",(function(){return m})),n.d(e,"v",(function(){return g})),n.d(e,"R",(function(){return b})),n.d(e,"O",(function(){return y})),n.d(e,"k",(function(){return v})),n.d(e,"L",(function(){return x})),n.d(e,"K",(function(){return w})),n.d(e,"s",(function(){return k})),n.d(e,"I",(function(){return O})),n.d(e,"P",(function(){return _})),n.d(e,"o",(function(){return A})),n.d(e,"n",(function(){return C})),n.d(e,"h",(function(){return E})),n.d(e,"B",(function(){return S})),n.d(e,"p",(function(){return j})),n.d(e,"A",(function(){return N})),n.d(e,"g",(function(){return T})),n.d(e,"f",(function(){return F})),n.d(e,"z",(function(){return D})),n.d(e,"t",(function(){return I})),n.d(e,"w",(function(){return M})),n.d(e,"r",(function(){return $})),n.d(e,"u",(function(){return R})),n.d(e,"G",(function(){return B})),n.d(e,"j",(function(){return z})),n.d(e,"S",(function(){return L})),n.d(e,"D",(function(){return P})),n.d(e,"F",(function(){return q})),n.d(e,"E",(function(){return W})),n.d(e,"c",(function(){return U})),n.d(e,"C",(function(){return V})),n.d(e,"q",(function(){return G})),n.d(e,"x",(function(){return H}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({reshape_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const n={x:Object(a.a)(t,"x","reshape","string_or_numeric")},o={shape:e};return r.a.runKernel(i.oc,n,o)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(4);const u=Object(s.b)({mul_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","mul"),s=Object(o.a)(e,"b","mul");[n,s]=Object(a.makeTypesMatch)(n,s);const u={a:n,b:s};return r.a.runKernel(i.Ub,u)}})},function(t,e,n){"use strict";n.r(e),n.d(e,"createScalarValue",(function(){return a})),n.d(e,"toTypedArray",(function(){return o})),n.d(e,"now",(function(){return s})),n.d(e,"fetch",(function(){return u})),n.d(e,"encodeString",(function(){return c})),n.d(e,"decodeString",(function(){return l}));var r=n(23),i=n(7);
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function a(t,e){return"string"===e?c(t):o([t],e)}function o(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=i.m(t)),Object(r.c)().getBool("DEBUG")&&i.h(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error("Unknown data type "+e)}function s(){return Object(r.c)().platform.now()}function u(t,e){return Object(r.c)().platform.fetch(t,e)}function c(t,e="utf-8"){return e=e||"utf-8",Object(r.c)().platform.encode(t,e)}function l(t,e="utf-8"){return e=e||"utf-8",Object(r.c)().platform.decode(t,e)}n.d(e,"shuffle",(function(){return i.M})),n.d(e,"clamp",(function(){return i.i})),n.d(e,"nearestLargerEven",(function(){return i.H})),n.d(e,"sum",(function(){return i.Q})),n.d(e,"randUniform",(function(){return i.J})),n.d(e,"distSquared",(function(){return i.l})),n.d(e,"assert",(function(){return i.b})),n.d(e,"assertShapesMatch",(function(){return i.e})),n.d(e,"assertNonNull",(function(){return i.d})),n.d(e,"flatten",(function(){return i.m})),n.d(e,"sizeFromShape",(function(){return i.N})),n.d(e,"isScalarShape",(function(){return i.y})),n.d(e,"arraysEqual",(function(){return i.a})),n.d(e,"isInt",(function(){return i.v})),n.d(e,"tanh",(function(){return i.R})),n.d(e,"sizeToSquarishShape",(function(){return i.O})),n.d(e,"createShuffledIndices",(function(){return i.k})),n.d(e,"rightPad",(function(){return i.L})),n.d(e,"repeatedTry",(function(){return i.K})),n.d(e,"inferFromImplicitShape",(function(){return i.s})),n.d(e,"parseAxisParam",(function(){return i.I})),n.d(e,"squeezeShape",(function(){return i.P})),n.d(e,"getTypedArrayFromDType",(function(){return i.o})),n.d(e,"getArrayFromDType",(function(){return i.n})),n.d(e,"checkConversionForErrors",(function(){return i.h})),n.d(e,"isValidDtype",(function(){return i.B})),n.d(e,"hasEncodingLoss",(function(){return i.p})),n.d(e,"isTypedArray",(function(){return i.A})),n.d(e,"bytesPerElement",(function(){return i.g})),n.d(e,"bytesFromStringArray",(function(){return i.f})),n.d(e,"isString",(function(){return i.z})),n.d(e,"isBoolean",(function(){return i.t})),n.d(e,"isNumber",(function(){return i.w})),n.d(e,"inferDtype",(function(){return i.r})),n.d(e,"isFunction",(function(){return i.u})),n.d(e,"nearestDivisor",(function(){return i.G})),n.d(e,"computeStrides",(function(){return i.j})),n.d(e,"toNestedArray",(function(){return i.S})),n.d(e,"makeOnesTypedArray",(function(){return i.D})),n.d(e,"makeZerosTypedArray",(function(){return i.F})),n.d(e,"makeZerosNestedTypedArray",(function(){return i.E})),n.d(e,"assertNonNegativeIntegerDimensions",(function(){return i.c})),n.d(e,"locToIndex",(function(){return i.C})),n.d(e,"indexToLoc",(function(){return i.q})),n.d(e,"isPromise",(function(){return i.x}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({cast_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const n=Object(a.a)(t,"x","cast");if(!o.B(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const s={x:n},u={dtype:e};return r.a.runKernel(i.w,s,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(4);const u=Object(s.b)({add_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","add"),s=Object(o.a)(e,"b","add");[n,s]=Object(a.makeTypesMatch)(n,s);const u={a:n,b:s};return r.a.runKernel(i.d,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(4);const u=Object(s.b)({sub_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","sub"),s=Object(o.a)(e,"b","sub");[n,s]=Object(a.makeTypesMatch)(n,s);const u={a:n,b:s};return r.a.runKernel(i.Pc,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(123),u=n(4);const c=Object(u.b)({div_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","div"),u=Object(o.a)(e,"b","div");if([n,u]=Object(a.makeTypesMatch)(n,u),"int32"===n.dtype&&"int32"===u.dtype)return Object(s.a)(n,u);const c={a:n,b:u};return r.a.runKernel(i.kc,c,{})}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(7),i=n(49);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function a(t,e){if((Object(r.A)(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&Object(r.A)(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Object(i.a)(t,[],[],e)}},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function r(t,e){const n=t.length,r=[];for(let i=0;i<n;i++){const a=n-1-i,o=t[a]||1;(e[e.length-1-i]||1)>1&&1===o&&r.unshift(a)}return r}function i(t,e){const n=[];for(let r=0;r<e.length;r++){const i=t[t.length-r-1],a=e.length-r-1,o=e[a];(null==i||1===i&&o>1)&&n.unshift(a)}return n}function a(t,e){const n=[],r=Math.max(t.length,e.length);for(let i=0;i<r;i++){let r=t[t.length-i-1];null==r&&(r=1);let a=e[e.length-i-1];if(null==a&&(a=1),1===r)n.unshift(a);else if(1===a)n.unshift(r);else{if(r!==a){throw Error(`Operands could not be broadcast together with shapes ${t} and ${e}.`)}n.unshift(r)}}return n}n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}))},function(t,e,n){"use strict";var r={};n.r(r),n.d(r,"conv2d",(function(){return Qn})),n.d(r,"depthwiseConv2d",(function(){return nr})),n.d(r,"matMul",(function(){return rr}));var i=n(42),a=n(247),o=n(248),s=n(12),u=n(249),c=n(175),l=n(176),d=n(177),f=n(178),h=n(250),p=n(251),m=n(252),g=n(179),b=n(253),y=n(125),v=n(254),x=n(1),w=n(31),k=n(26),O=n(9),_=n(4),A=n(85),C=n(25),E=n(154);const S=Object(_.b)({basicLSTMCell_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,r,i,a){const o=Object(x.a)(t,"forgetBias","basicLSTMCell"),u=Object(x.a)(e,"lstmKernel","basicLSTMCell"),c=Object(x.a)(n,"lstmBias","basicLSTMCell"),l=Object(x.a)(r,"data","basicLSTMCell"),d=Object(x.a)(i,"c","basicLSTMCell"),f=Object(x.a)(a,"h","basicLSTMCell"),h=Object(w.a)([l,f],1),p=Object(k.a)(h,u),m=Object(s.a)(p,c),g=m.shape[0],b=m.shape[1]/4,y=[g,b],v=Object(C.a)(m,[0,0],y),_=Object(C.a)(m,[0,b],y),S=Object(C.a)(m,[0,2*b],y),j=Object(C.a)(m,[0,3*b],y),N=Object(s.a)(Object(O.a)(Object(A.a)(v),Object(E.a)(_)),Object(O.a)(d,Object(A.a)(Object(s.a)(o,S))));return[N,Object(O.a)(Object(E.a)(N),Object(A.a)(j))]}});var j=n(97),N=n(84),T=n(7);const F=Object(_.b)({batchNorm2d_:function(t,e,n,r,i,a){const o=Object(x.a)(t,"x","batchNorm"),s=Object(x.a)(e,"mean","batchNorm"),u=Object(x.a)(n,"variance","batchNorm");let c,l;return null!=i&&(c=Object(x.a)(i,"scale","batchNorm")),null!=r&&(l=Object(x.a)(r,"offset","batchNorm")),T.b(2===o.rank,()=>"Error in batchNorm2D: x must be rank 2 but got rank "+o.rank+"."),T.b(2===s.rank||1===s.rank,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${s.rank}.`),T.b(2===u.rank||1===u.rank,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`),null!=c&&T.b(2===c.rank||1===c.rank,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),null!=l&&T.b(2===l.rank||1===l.rank,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${l.rank}.`),Object(N.a)(o,s,u,l,c,a)}});const D=Object(_.b)({batchNorm3d_:function(t,e,n,r,i,a){const o=Object(x.a)(t,"x","batchNorm"),s=Object(x.a)(e,"mean","batchNorm"),u=Object(x.a)(n,"variance","batchNorm");let c,l;return null!=i&&(c=Object(x.a)(i,"scale","batchNorm")),null!=r&&(l=Object(x.a)(r,"offset","batchNorm")),T.b(3===o.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+o.rank+"."),T.b(3===s.rank||1===s.rank,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${s.rank}.`),T.b(3===u.rank||1===u.rank,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`),null!=c&&T.b(3===c.rank||1===c.rank,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),null!=l&&T.b(3===l.rank||1===l.rank,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${l.rank}.`),Object(N.a)(o,s,u,l,c,a)}});const I=Object(_.b)({batchNorm4d_:function(t,e,n,r,i,a){const o=Object(x.a)(t,"x","batchNorm"),s=Object(x.a)(e,"mean","batchNorm"),u=Object(x.a)(n,"variance","batchNorm");let c,l;return null!=i&&(c=Object(x.a)(i,"scale","batchNorm")),null!=r&&(l=Object(x.a)(r,"offset","batchNorm")),T.b(4===o.rank,()=>"Error in batchNorm4D: x must be rank 4 but got rank "+o.rank+"."),T.b(4===s.rank||1===s.rank,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${s.rank}.`),T.b(4===u.rank||1===u.rank,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`),null!=c&&T.b(4===c.rank||1===c.rank,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),null!=l&&T.b(4===l.rank||1===l.rank,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${l.rank}.`),Object(N.a)(o,s,u,l,c,a)}});var M=n(255),$=n(109),R=n(46),B=n(11),z=n(256),L=n(257),P=n(65),q=n(57);const W=Object(_.b)({concat1d_:function(t){return Object(w.a)(t,0)}});const U=Object(_.b)({concat2d_:function(t,e){return Object(w.a)(t,e)}});const V=Object(_.b)({concat3d_:function(t,e){return Object(w.a)(t,e)}});const G=Object(_.b)({concat4d_:function(t,e){return Object(w.a)(t,e)}});var H=n(180),X=n(63),K=n(181),Y=n(258),J=n(206);const Z=Object(_.b)({conv3dTranspose_:function(t,e,n,r,i){const a=Object(x.a)(t,"x","conv3dTranspose"),o=Object(x.a)(e,"filter","conv3dTranspose");return Object(J.a)(n,a,o,r,i)}});var Q=n(126),tt=n(182),et=n(127),nt=n(259),rt=n(183),it=n(78),at=n(5),ot=n(3);const st=Object(_.b)({diag_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(x.a)(t,"x","diag")};return at.a.runKernel(ot.R,e)}});var ut=n(184),ct=n(14),lt=n(185),dt=n(186),ft=n(128),ht=n(79),pt=n(260),mt=n(40),gt=n(60),bt=n(261),yt=n(8),vt=n(86);const xt=Object(_.b)({eye_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,r="float32"){null==e&&(e=t);const i=Object(R.a)([t,e],r),a=t<=e?t:e;for(let t=0;t<a;++t)i.set(1,t,t);const o=Object(yt.a)(i.toTensor(),[t,e]);if(null==n)return o;if(1===n.length)return Object(vt.a)(Object(gt.a)(o,0),[n[0],1,1]);if(2===n.length)return Object(vt.a)(Object(gt.a)(Object(gt.a)(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return Object(vt.a)(Object(gt.a)(Object(gt.a)(Object(gt.a)(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}});var wt=n(124),kt=n(129),Ot=n(123),_t=n(98),At=n(45),Ct=n(53),Et=n(130),St=n(262),jt=n(263),Nt=n(264),Tt=n(131),Ft=n(99),Dt=n(54),It=n(265),Mt=n(187),$t=n(72),Rt=n(188),Bt=n(266),zt=n(267),Lt=n(132),Pt=n(58),qt=n(100),Wt=n(133),Ut=n(190),Vt=n(66),Gt=n(134),Ht=n(268),Xt=n(269),Kt=n(77),Yt=n(89),Jt=n(110),Zt=n(101),Qt=n(191),te=n(135),ee=n(38),ne=n(24),re=n(13);const ie=Object(_.b)({moments_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=null,n=!1){t=Object(x.a)(t,"x","moments");const r=Object(T.I)(e,t.shape),i=Object(Yt.a)(t,r,n);let a=i.shape;n||(a=Object(ee.e)(i.shape,r));const o=Object(ne.a)(Object(re.a)(Object(B.a)(t,"float32"),Object(yt.a)(i,a)));return{mean:i,variance:Object(Yt.a)(o,r,n)}}});const ae=Object(_.b)({multiRNNCell_:function(t,e,n,r){const i=Object(x.a)(e,"data","multiRNNCell"),a=Object(x.b)(n,"c","multiRNNCell"),o=Object(x.b)(r,"h","multiRNNCell");let s=i;const u=[];for(let e=0;e<t.length;e++){const n=t[e](s,a[e],o[e]);u.push(n[0]),u.push(n[1]),s=n[1]}const c=[],l=[];for(let t=0;t<u.length;t+=2)c.push(u[t]),l.push(u[t+1]);return[c,l]}});var oe=n(270),se=n(28),ue=n(102),ce=n(111),le=n(80),de=n(271);const fe=Object(_.b)({outerProduct_:function(t,e){const n=Object(x.a)(t,"v1","outerProduct"),r=Object(x.a)(e,"v2","outerProduct");T.b(1===n.rank&&1===r.rank,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const i=Object(yt.a)(n,[-1,1]),a=Object(yt.a)(r,[1,-1]);return Object(k.a)(i,a)}});var he=n(55);const pe=Object(_.b)({pad1d_:function(t,e,n=0){return Object(T.b)(2===e.length,()=>"Invalid number of paddings. Must be length of 2."),Object(he.a)(t,[e],n)}});const me=Object(_.b)({pad2d_:function(t,e,n=0){return Object(T.b)(2===e.length&&2===e[0].length&&2===e[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),Object(he.a)(t,e,n)}});const ge=Object(_.b)({pad3d_:function(t,e,n=0){return Object(T.b)(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),Object(he.a)(t,e,n)}});const be=Object(_.b)({pad4d_:function(t,e,n=0){return Object(T.b)(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),Object(he.a)(t,e,n)}});var ye=n(192),ve=n(47),xe=n(136),we=n(174),ke=n(193);const Oe=Object(_.b)({rand_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n){const r=Object(T.N)(t);let i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(let t=0;t<r;t++)i[t]=e();return at.a.makeTensor(i,t,n)}});var _e=n(107);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ae=Object(_.b)({randomGamma_:function(t,e,n=1,r="float32",i){if(null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);const a=new _e.b(e,n,r,i),o=Object(R.a)(t,r);for(let t=0;t<o.values.length;t++)o.values[t]=a.nextValue();return o.toTensor()}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ce=Object(_.b)({randomNormal_:function(t,e=0,n=1,r,i){if(null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);const a=new _e.a(e,n,r,!1,i),o=Object(R.a)(t,r);for(let t=0;t<o.values.length;t++)o.values[t]=a.nextValue();return o.toTensor()}});var Ee=n(194),Se=n(155),je=n(112),Ne=n(272),Te=n(81),Fe=n(137),De=n(48);const Ie=Object(_.b)({reverse1d_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e=Object(x.a)(t,"x","reverse");return T.b(1===e.rank,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Object(De.a)(e,0)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Me=Object(_.b)({reverse2d_:function(t,e){const n=Object(x.a)(t,"x","reverse");return T.b(2===n.rank,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Object(De.a)(n,e)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $e=Object(_.b)({reverse3d_:function(t,e){const n=Object(x.a)(t,"x","reverse");return T.b(3===n.rank,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Object(De.a)(n,e)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Re=Object(_.b)({reverse4d_:function(t,e){const n=Object(x.a)(t,"x","reverse");return T.b(4===n.rank,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Object(De.a)(n,e)}});var Be=n(273),ze=n(195),Le=n(15),Pe=n(196),qe=n(197),We=n(274),Ue=n(275),Ve=n(198),Ge=n(199);const He=Object(_.b)({slice1d_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n){const r=Object(x.a)(t,"x","slice1d");return T.b(1===r.rank,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Object(C.a)(r,[e],[n])}});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xe=Object(_.b)({slice2d_:function(t,e,n){const r=Object(x.a)(t,"x","slice2d");return T.b(2===r.rank,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Object(C.a)(r,e,n)}});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ke=Object(_.b)({slice3d_:function(t,e,n){const r=Object(x.a)(t,"x","slice3d");return T.b(3===r.rank,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Object(C.a)(r,e,n)}});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ye=Object(_.b)({slice4d_:function(t,e,n){const r=Object(x.a)(t,"x","slice4d");return T.b(4===r.rank,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Object(C.a)(r,e,n)}});var Je=n(276),Ze=n(189),Qe=n(103),tn=n(138),en=n(113),nn=n(200),rn=n(139),an=n(73),on=n(37),sn=n(104),un=n(105),cn=n(59),ln=n(82),dn=n(277),fn=n(18),hn=n(278),pn=n(106),mn=n(74),gn=n(49);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function bn(t,e,n){if(Object(T.d)(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const r=Object(x.c)(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Object(gn.a)(t,e,r,n)}var yn=n(201);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vn(t,e,n){if(Object(T.d)(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");const r=Object(x.c)(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Object(gn.a)(t,e,r,n)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xn(t,e,n){if(Object(T.d)(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");const r=Object(x.c)(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Object(gn.a)(t,e,r,n)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wn(t,e,n){if(Object(T.d)(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");const r=Object(x.c)(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,Object(gn.a)(t,e,r,n)}var kn=n(202),On=n(279),_n=n(203),An=n(140),Cn=n(83);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function En(t,e=!0,n,r){return at.a.makeVariable(t,e,n,r)}var Sn=n(36),jn=n(204),Nn=n(64),Tn=n(21);const Fn=
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
async function(t,e,n){const r=Object(x.a)(t,"tensor","boolMask"),i=Object(x.a)(e,"mask","boolMask","bool"),a=null==n?0:n,o=i.rank,s=r.shape;T.b(o>0,()=>"mask cannot be scalar"),T.e(s.slice(a,a+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let t=a;t<a+o;t++)u*=s[t];const c=s.slice(0,a).concat([u],s.slice(a+o)),l=Object(yt.a)(r,c),d=Object(yt.a)(i,[-1]),f=await Object(jn.a)(d),h=Object(un.a)(f,[1]),p=Object(_t.a)(l,h,a);return t!==r&&r.dispose(),e!==i&&i.dispose(),h.dispose(),l.dispose(),d.dispose(),f.dispose(),p};var Dn=n(280),In=n(281),Mn=n(50),$n=n(141),Rn=n(22);const Bn=Object(_.b)({movingAverage_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,r,i=!0){const a=Object(x.a)(t,"v","movingAverage"),o=Object(x.a)(e,"x","movingAverage"),u=Object(x.a)(n,"decay","movingAverage");Object(Rn.assertTypesMatch)(a,o),T.b(T.a(a.shape,o.shape),()=>"Shape mismatch in v and x");const c=Object(Le.a)(1),l=Object(re.a)(c,u);let d=Object(O.a)(Object(re.a)(o,a),l);if(i){T.b(null!=r,()=>"When using zeroDebias: true, step is required.");const t=Object(x.a)(r,"step","movingAverage");d=Object(ct.a)(d,Object(re.a)(c,Object(ve.a)(u,t)))}return Object(s.a)(a,d)}});var zn=n(282),Ln=n(294),Pn=n(283),qn=n(6);const Wn=Object(_.b)({dropout_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,r){const i=Object(x.a)(t,"x","dropout");if(T.b("float32"===i.dtype,()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),T.b(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),0===e)return t instanceof qn.a?i.clone():i;const a=
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){if(null==e)return t.shape.slice();if(T.a(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(i,n),o=1-e,u=Object(ct.a)(Object(kt.a)(Object(s.a)(Object(Ee.a)(a,0,1,"float32",r),o)),o);return Object(O.a)(i,u)}});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Un(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function Vn(t,e,n){const r=1-t%2,i=new Float32Array(t);for(let a=0;a<t;++a){const o=2*Math.PI*a/(t+r-1);i[a]=e-n*Math.cos(o)}return Object(mn.a)(i,"float32")}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gn=async function(t,e,n=1){const r=Object(x.a)(t,"predictions","inTopK"),i=Object(x.a)(e,"targets","inTopK");Object(T.b)(r.rank>1,()=>"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank),Object(T.b)(r.rank-1===i.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`),Object(T.e)(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=r.shape[r.shape.length-1];Object(T.b)(n>0&&n<=a,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${a}), but got ${n}`);const o=await r.data(),s=await i.data(),[u,c]=[o.length/a,a],l=Object(T.o)("bool",u);for(let t=0;t<u;t++){const e=t*c,r=o.subarray(e,e+c),i=[];for(let t=0;t<r.length;t++)i.push({value:r[t],index:t});i.sort((t,e)=>e.value-t.value),l[t]=0;for(let e=0;e<n;e++)if(i[e].index===s[t]){l[t]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),Object(pn.a)(l,i.shape,"bool")};var Hn=n(34),Xn=n(16),Kn=n(144),Yn=n(142),Jn=n(27),Zn=n(43);const Qn=Object(_.b)({fusedConv2d_:
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function({x:t,filter:e,strides:n,pad:r,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:o,bias:u,activation:c="linear",preluActivationWeights:l,leakyreluAlpha:d}){if(c=c||"linear",!1===Object(Zn.d)(at.a.state.gradientDepth,c)){let f=Object(X.a)(t,e,n,r,i,a,o);return null!=u&&(f=Object(s.a)(f,u)),Object(Zn.a)(f,c,l,d)}const f=Object(x.a)(t,"x","conv2d"),h=Object(x.a)(e,"filter","conv2d");let p=f,m=!1;3===f.rank&&(m=!0,p=Object(yt.a)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),T.b(4===p.rank,()=>"Error in fused conv2d: input must be rank 4, but got rank "+p.rank+"."),T.b(4===h.rank,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+h.rank+"."),null!=o&&T.b(T.v(r),()=>`Error in fused conv2d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${r}.`),T.b(p.shape[3]===h.shape[2],()=>`Error in conv2d: depth of input (${p.shape[3]}) must match input depth for filter ${h.shape[2]}.`),T.b(Jn.h(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),T.b("NHWC"===i,()=>`Error in conv2d: got dataFormat of ${i} but only NHWC is currently supported.`);const g=Jn.a(p.shape,h.shape,n,a,r,o);let b,y;null!=u&&(b=Object(x.a)(u,"bias","fused conv2d"),[b]=Object(Rn.makeTypesMatch)(b,f),Xn.a(g.outShape,b.shape)),null!=l&&(y=Object(x.a)(l,"prelu weights","fused conv2d"));const v=(t,e)=>{const[i,o,s,u]=e,l=Object(Zn.c)(t,s,c);T.b(Jn.i(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);const d=[Object(Yn.a)(o.shape,l,i,n,r),Object(Kn.a)(o,l,i.shape,n,r)];if(null!=u){const t=Object(Zn.b)(u,l);d.push(t)}return d},w={x:p,filter:h,bias:b,preluActivationWeights:y},k={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o,activation:c,leakyreluAlpha:d};if(null==u){return Object(Hn.a)((t,e,n)=>{let r=at.a.runKernel(ot.jb,w,k);return n([e,t,r]),m&&(r=Object(yt.a)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:v}})(p,h)}return Object(Hn.a)((t,e,n,r)=>{let i=at.a.runKernel(ot.jb,w,k);return r([e,t,i,n]),m&&(i=Object(yt.a)(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:v}})(p,h,b)}});var tr=n(210),er=n(209);const nr=Object(_.b)({fusedDepthwiseConv2d_:
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function({x:t,filter:e,strides:n,pad:r,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:o,bias:u,activation:c="linear",preluActivationWeights:l,leakyreluAlpha:d}){if(!1===Object(Zn.d)(at.a.state.gradientDepth,c)){let f=Object(it.a)(t,e,n,r,i,a,o);return null!=u&&(f=Object(s.a)(f,u)),Object(Zn.a)(f,c,l,d)}const f=Object(x.a)(t,"x","depthwiseConv2d"),h=Object(x.a)(e,"filter","depthwiseConv2d");let p=f,m=!1;3===f.rank&&(m=!0,p=Object(yt.a)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),T.b(4===p.rank,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${p.rank}.`),T.b(4===h.rank,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),T.b(p.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${p.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),null==a&&(a=[1,1]),T.b(Jn.h(n,a),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),null!=o&&T.b(T.v(r),()=>`Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode ${o} but got pad ${r}.`);const g=Jn.a(p.shape,h.shape,n,a,r,o,!0);let b,y;null!=u&&(b=Object(x.a)(u,"bias","fused conv2d"),[b]=Object(Rn.makeTypesMatch)(b,f),Xn.a(g.outShape,b.shape)),null!=l&&(y=Object(x.a)(l,"prelu weights","fused depthwiseConv2d"));const v=(t,e)=>{T.b(Jn.i(a),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[i,s,u,l]=e,d=Object(Zn.c)(t,u,c),f=Object(er.a)(s.shape,d,i,n,r,a,o),h=Object(tr.a)(s,d,i.shape,n,r,a,o);if(null!=l){return[f,h,Object(Zn.b)(b,d)]}return[f,h]},w={x:p,filter:h,bias:b,preluActivationWeights:y},k={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o,activation:c,leakyreluAlpha:d};if(null==u){return Object(Hn.a)((t,e,n)=>{let r=at.a.runKernel(ot.kb,w,k);return n([e,t,r]),m&&(r=Object(yt.a)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:v}})(p,h)}return Object(Hn.a)((t,e,n,r)=>{let i=at.a.runKernel(ot.kb,w,k);return r([e,t,i,n]),m&&(i=Object(yt.a)(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:v}})(p,h,b)}});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rr=Object(_.b)({fusedMatMul_:function({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:i,activation:a="linear",preluActivationWeights:o,leakyreluAlpha:u}){if(!1===Object(Zn.d)(at.a.state.gradientDepth,a)){let c=Object(k.a)(t,e,n,r);return null!=i&&(c=Object(s.a)(c,i)),Object(Zn.a)(c,a,o,u)}let c=Object(x.a)(t,"a","fused matMul"),l=Object(x.a)(e,"b","fused matMul");[c,l]=Object(Rn.makeTypesMatch)(c,l);const d=n?c.shape[c.rank-2]:c.shape[c.rank-1],f=r?l.shape[l.rank-1]:l.shape[l.rank-2],h=n?c.shape[c.rank-1]:c.shape[c.rank-2],p=r?l.shape[l.rank-2]:l.shape[l.rank-1],m=c.shape.slice(0,-2),g=l.shape.slice(0,-2),b=T.N(m),y=T.N(g);T.b(c.rank>=2&&l.rank>=2&&c.rank===l.rank,()=>`Error in fused matMul: inputs must have the same rank of at least 2, got ranks ${c.rank} and ${l.rank}.`),T.b(T.a(m,g),()=>`Error in fused matMul: outer dimensions (${m}) and (${g}) of Tensors with shapes ${c.shape} and `+l.shape+" must match."),T.b(d===f,()=>`Error in fused matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${c.shape} and ${l.shape} and transposeA=${n} and transposeB=${r} must match.`);const v=c.shape.slice(0,-2).concat([h,p]),w=n?Object(yt.a)(c,[b,d,h]):Object(yt.a)(c,[b,h,d]),O=r?Object(yt.a)(l,[y,p,f]):Object(yt.a)(l,[y,f,p]);let _,A;null!=i&&(_=Object(x.a)(i,"bias","fused matMul"),[_]=Object(Rn.makeTypesMatch)(_,c),Xn.a(v,_.shape)),null!=o&&(A=Object(x.a)(o,"prelu weights","fused matMul"));const C=(t,e)=>{const[o,s,u,c]=e,l=Object(Zn.c)(Object(yt.a)(t,u.shape),u,a);let d,f;if(n||r?!n&&r?(d=Object(k.a)(l,s,!1,!1),f=Object(k.a)(l,o,!0,!1)):n&&!r?(d=Object(k.a)(s,l,!1,!0),f=Object(k.a)(o,l,!1,!1)):(d=Object(k.a)(s,l,!0,!0),f=Object(k.a)(l,o,!0,!0)):(d=Object(k.a)(l,s,!1,!0),f=Object(k.a)(o,l,!0,!1)),null!=i){return[d,f,Object(Zn.b)(c,l)]}return[d,f]},E={a:w,b:O,bias:_,preluActivationWeights:A},S={transposeA:n,transposeB:r,activation:a,leakyreluAlpha:u};if(null==i){return Object(Hn.a)((t,e,n)=>{const r=at.a.runKernel(ot.ad,E,S);return n([t,e,r]),{value:Object(yt.a)(r,v),gradFunc:C}})(w,O)}return Object(Hn.a)((t,e,n,r)=>{const i=at.a.runKernel(ot.ad,E,S);return r([t,e,i,n]),{value:Object(yt.a)(i,v),gradFunc:C}})(w,O,_)}});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ir=Object(_.b)({hammingWindow_:function(t){return Vn(t,.54,.46)}});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ar=Object(_.b)({hannWindow_:function(t){return Vn(t,.5,.5)}});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const or=Object(_.b)({frame_:function(t,e,n,r=!1,i=0){let a=0;const o=[];for(;a+e<=t.size;)o.push(Object(C.a)(t,a,e)),a+=n;if(r)for(;a<t.size;){const r=a+e-t.size,s=Object(w.a)([Object(C.a)(t,a,e-r),Object(wt.a)([r],i)]);o.push(s),a+=n}return 0===o.length?bn([],[0,e]):Object(yt.a)(Object(w.a)(o),[o.length,e])}});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sr=Object(_.b)({stft_:function(t,e,n,r,i=ar){null==r&&(r=Un(e));const a=or(t,e,n),o=Object(O.a)(a,i(e)),s=[];for(let t=0;t<a.shape[0];t++)s.push(Object(rn.a)(Object(C.a)(o,[t,0],[1,e]),r));return Object(w.a)(s)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ur=Object(_.b)({cropAndResize_:function(t,e,n,r,i="bilinear",a=0){const o=Object(x.a)(t,"image","cropAndResize"),s=Object(x.a)(e,"boxes","cropAndResize","float32"),u=Object(x.a)(n,"boxInd","cropAndResize","int32"),c=s.shape[0];T.b(4===o.rank,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),T.b(2===s.rank&&4===s.shape[1],()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${s.shape}.`),T.b(1===u.rank&&u.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${s.shape}.`),T.b(2===r.length,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),T.b(r[0]>=1&&r[1]>=1,()=>"cropSize must be atleast [1,1], but was "+r),T.b("bilinear"===i||"nearest"===i,()=>"method must be bilinear or nearest, but was "+i);const l={image:o,boxes:s,boxInd:u},d={method:i,extrapolationValue:a,cropSize:r};return at.a.runKernel(ot.K,l,d)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cr=Object(_.b)({flipLeftRight_:function(t){const e=Object(x.a)(t,"image","flipLeftRight","float32");T.b(4===e.rank,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return at.a.runKernel(ot.eb,n,{})}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lr=Object(_.b)({rotateWithOffset_:function(t,e,n=0,r=.5){const i=Object(x.a)(t,"image","rotateWithOffset","float32");T.b(4===i.rank,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);const a={image:i},o={radians:e,fillValue:n,center:r};return at.a.runKernel(ot.uc,a,o)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dr(t,e,n,r,i,a){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==a&&(a=0);const o=t.shape[0];return n=Math.min(n,o),T.b(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),T.b(2===t.rank,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),T.b(4===t.shape[1],()=>"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]),T.b(1===e.rank,()=>"scores must be a 1D tensor"),T.b(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was `+e.shape[0]),T.b(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fr=Object(_.b)({nonMaxSuppression_:function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY){const a=Object(x.a)(t,"boxes","nonMaxSuppression"),o=Object(x.a)(e,"scores","nonMaxSuppression"),s=dr(a,o,n,r,i),u={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:i=s.scoreThreshold};return at.a.runKernel(ot.Wb,{boxes:a,scores:o},u)}});var hr=n(76);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pr=async function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY){const a=Object(x.a)(t,"boxes","nonMaxSuppressionAsync"),o=Object(x.a)(e,"scores","nonMaxSuppressionAsync"),s=dr(a,o,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;const u=await Promise.all([a.data(),o.data()]),c=u[0],l=u[1],{selectedIndices:d}=Object(hr.a)(c,l,n,r,i);return a!==t&&a.dispose(),o!==e&&o.dispose(),Object(mn.a)(d,"int32")};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mr=Object(_.b)({nonMaxSuppressionWithScore_:function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,a=0){const o=Object(x.a)(t,"boxes","nonMaxSuppression"),s=Object(x.a)(e,"scores","nonMaxSuppression"),u=dr(o,s,n,r,i,a),c={boxes:o,scores:s},l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:a=u.softNmsSigma},d=at.a.runKernel(ot.Yb,c,l);return{selectedIndices:d[0],selectedScores:d[1]}}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gr=async function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,a=0){const o=Object(x.a)(t,"boxes","nonMaxSuppressionAsync"),s=Object(x.a)(e,"scores","nonMaxSuppressionAsync"),u=dr(o,s,n,r,i,a);n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,a=u.softNmsSigma;const c=await Promise.all([o.data(),s.data()]),l=c[0],d=c[1],{selectedIndices:f,selectedScores:h}=Object(hr.c)(l,d,n,r,i,a);return o!==t&&o.dispose(),s!==e&&s.dispose(),{selectedIndices:Object(mn.a)(f,"int32"),selectedScores:Object(mn.a)(h)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const br=Object(_.b)({nonMaxSuppressionPadded_:function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,a=!1){const o=Object(x.a)(t,"boxes","nonMaxSuppression"),s=Object(x.a)(e,"scores","nonMaxSuppression"),u=dr(o,s,n,r,i,null),c={boxes:o,scores:s},l={maxOutputSize:u.maxOutputSize,iouThreshold:u.iouThreshold,scoreThreshold:u.scoreThreshold,padToMaxOutputSize:a},d=at.a.runKernel(ot.Xb,c,l);return{selectedIndices:d[0],validOutputs:d[1]}}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yr=async function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,a=!1){const o=Object(x.a)(t,"boxes","nonMaxSuppressionAsync"),s=Object(x.a)(e,"scores","nonMaxSuppressionAsync"),u=dr(o,s,n,r,i,null),c=u.maxOutputSize,l=u.iouThreshold,d=u.scoreThreshold,[f,h]=await Promise.all([o.data(),s.data()]),{selectedIndices:p,validOutputs:m}=Object(hr.b)(f,h,c,l,d,a);return o!==t&&o.dispose(),s!==e&&s.dispose(),{selectedIndices:Object(mn.a)(p,"int32"),validOutputs:Object(Le.a)(m,"int32")}};var vr=n(208),xr=n(207);const wr=Object(_.b)({bandPart_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n){Object(T.b)(e%1==0,()=>`bandPart(): numLower must be an integer, got ${e}.`),Object(T.b)(n%1==0,()=>`bandPart(): numUpper must be an integer, got ${n}.`);const r=Object(x.a)(t,"a","bandPart");Object(T.b)(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const i=r.shape,[a,o]=r.shape.slice(-2);if(!(e<=a))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${a}).`);if(!(n<=o))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`);e<0&&(e=a),n<0&&(n=o);const s=Object(yt.a)(Object(Se.a)(0,a,1,"int32"),[-1,1]),u=Object(Se.a)(0,o,1,"int32"),c=Object(re.a)(s,u),l=Object(Pt.a)(Object(Dt.a)(c,Object(Le.a)(+e,"int32")),Object(Ct.a)(c,Object(Le.a)(-n,"int32"))),d=Object(Nn.a)([a,o],r.dtype);return Object(yt.a)(Object(cn.a)(Object(Cn.a)(Object(yt.a)(r,[-1,a,o])).map(t=>Object(Sn.a)(l,t,d))),i)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kr=Object(_.b)({gramSchmidt_:function(t){let e;if(Array.isArray(t)){e=!1,Object(T.b)(null!=t&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const n=t[0].shape[0];for(let e=1;e<t.length;++e)Object(T.b)(t[e].shape[0]===n,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[e].shape[0]} vs. ${n})`)}else e=!0,t=Object(an.a)(t,t.shape[0],0).map(t=>Object(un.a)(t,[0]));Object(T.b)(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let e=0;e<t.length;++e)n.push(at.a.tidy(()=>{let t=r[e];if(e>0)for(let r=0;r<e;++r){const e=Object(O.a)(Object(fn.a)(Object(O.a)(n[r],t)),n[r]);t=Object(re.a)(t,e)}return Object(ct.a)(t,Object($n.a)(t,"euclidean"))}));return e?Object(cn.a)(n,0):n}});var Or=n(19);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _r(t,e=!1){return at.a.tidy(()=>{Object(T.b)(2===t.shape.length,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let i=xt(n),a=Object(P.a)(t);const o=bn([[1]],[1,1]);let s=Object(P.a)(o);const u=n>=r?r:n;for(let t=0;t<u;++t){const e=a,u=s,c=i;[s,a,i]=at.a.tidy(()=>{const e=Object(C.a)(a,[t,t],[n-t,1]),u=Object($n.a)(e),c=Object(C.a)(a,[t,t],[1,1]),l=Object(Sn.a)(Object(At.a)(c,0),bn([[-1]]),bn([[1]])),d=Object(re.a)(c,Object(O.a)(l,u)),f=Object(ct.a)(e,d);s=1===f.shape[0]?Object(P.a)(o):Object(w.a)([o,Object(C.a)(f,[1,0],[f.shape[0]-1,f.shape[1]])],0);const h=Object(se.a)(Object(ct.a)(Object(k.a)(l,d),u)),p=Object(C.a)(a,[t,0],[n-t,r]),m=Object(O.a)(h,s),g=Object(Mn.a)(s);if(0===t)a=Object(re.a)(p,Object(k.a)(m,Object(k.a)(g,p)));else{const e=Object(re.a)(p,Object(k.a)(m,Object(k.a)(g,p)));a=Object(w.a)([Object(C.a)(a,[0,0],[t,r]),e],0)}const b=Object(Mn.a)(m),y=Object(C.a)(i,[0,t],[n,i.shape[1]-t]);if(0===t)i=Object(re.a)(y,Object(k.a)(Object(k.a)(y,s),b));else{const e=Object(re.a)(y,Object(k.a)(Object(k.a)(y,s),b));i=Object(w.a)([Object(C.a)(i,[0,0],[n,t]),e],1)}return[s,a,i]}),Object(Or.d)([e,u,c])}return!e&&n>r&&(i=Object(C.a)(i,[0,0],[n,r]),a=Object(C.a)(a,[0,0],[r,r])),[i,a]})}const Ar=Object(_.b)({qr_:function(t,e=!1){if(Object(T.b)(t.rank>=2,()=>"qr() requires input tensor to have a rank >= 2, but got rank "+t.rank),2===t.rank)return _r(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((t,e)=>t*e),r=Object(Cn.a)(Object(yt.a)(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],a=[];r.forEach(t=>{const[n,r]=_r(t,e);i.push(n),a.push(r)});return[Object(yt.a)(Object(cn.a)(i,0),t.shape),Object(yt.a)(Object(cn.a)(a,0),t.shape)]}}});var Cr=n(35);const Er=Object(_.b)({computeWeightedLoss_:function(t,e,n=Cr.a.SUM_BY_NONZERO_WEIGHTS){const r=Object(x.a)(t,"losses","computeWeightedLoss");let i=null;null!=e&&(i=Object(x.a)(e,"weights","computeWeightedLoss"));const a=null==i?r:Object(O.a)(r,i);if(n===Cr.a.NONE)return a;if(n===Cr.a.SUM)return Object(fn.a)(a);if(n===Cr.a.MEAN){if(null==i)return Object(Yt.a)(a);{const t=r.size/i.size,e=Object(ct.a)(Object(fn.a)(a),Object(fn.a)(i));return t>1?Object(ct.a)(e,Object(Le.a)(t)):e}}if(n===Cr.a.SUM_BY_NONZERO_WEIGHTS){if(null==i)return Object(ct.a)(Object(fn.a)(a),Object(Le.a)(r.size));{const t=Object(O.a)(i,Object(le.a)(r.shape)),e=Object(B.a)(Object(fn.a)(Object(ue.a)(t,Object(Le.a)(0))),"float32");return Object(ct.a)(Object(fn.a)(a),e)}}throw Error("Unknown reduction: "+n)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sr=Object(_.b)({absoluteDifference_:function(t,e,n,r=Cr.a.SUM_BY_NONZERO_WEIGHTS){const a=Object(x.a)(t,"labels","absoluteDifference"),o=Object(x.a)(e,"predictions","absoluteDifference");let s=null;null!=n&&(s=Object(x.a)(n,"weights","absoluteDifference")),Object(T.e)(a.shape,o.shape,"Error in absoluteDifference: ");const u=Object(i.a)(Object(re.a)(a,o));return Er(u,s,r)}});const jr=Object(_.b)({cosineDistance_:function(t,e,n,r,i=Cr.a.SUM_BY_NONZERO_WEIGHTS){const a=Object(x.a)(t,"labels","cosineDistance"),o=Object(x.a)(e,"predictions","cosineDistance");let s=null;null!=r&&(s=Object(x.a)(r,"weights","cosineDistance")),Object(T.e)(a.shape,o.shape,"Error in cosineDistance: ");const u=Object(Le.a)(1),c=Object(re.a)(u,Object(fn.a)(Object(O.a)(a,o),n,!0));return Er(c,s,i)}});const Nr=Object(_.b)({hingeLoss_:function(t,e,n,r=Cr.a.SUM_BY_NONZERO_WEIGHTS){let i=Object(x.a)(t,"labels","hingeLoss");const a=Object(x.a)(e,"predictions","hingeLoss");let o=null;null!=n&&(o=Object(x.a)(n,"weights","hingeLoss")),Object(T.e)(i.shape,a.shape,"Error in hingeLoss: ");const s=Object(Le.a)(1);i=Object(re.a)(Object(O.a)(Object(Le.a)(2),i),s);const u=Object(Te.a)(Object(re.a)(s,Object(O.a)(i,a)));return Er(u,o,r)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tr=Object(_.b)({huberLoss_:function(t,e,n,r=1,a=Cr.a.SUM_BY_NONZERO_WEIGHTS){const o=Object(x.a)(t,"labels","huberLoss"),u=Object(x.a)(e,"predictions","huberLoss");let c=null;null!=n&&(c=Object(x.a)(n,"weights","huberLoss")),Object(T.e)(o.shape,u.shape,"Error in huberLoss: ");const l=Object(Le.a)(r),d=Object(i.a)(Object(re.a)(u,o)),f=Object(Zt.a)(d,l),h=Object(re.a)(d,f),p=Object(s.a)(Object(O.a)(Object(Le.a)(.5),Object(ne.a)(f)),Object(O.a)(l,h));return Er(p,c,a)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fr=Object(_.b)({logLoss_:function(t,e,n,r=1e-7,i=Cr.a.SUM_BY_NONZERO_WEIGHTS){const a=Object(x.a)(t,"labels","logLoss"),o=Object(x.a)(e,"predictions","logLoss");let u=null;null!=n&&(u=Object(x.a)(n,"weights","logLoss")),Object(T.e)(a.shape,o.shape,"Error in logLoss: ");const c=Object(Le.a)(1),l=Object(Le.a)(r),d=Object(se.a)(Object(O.a)(a,Object($t.a)(Object(s.a)(o,l)))),f=Object(O.a)(Object(re.a)(c,a),Object($t.a)(Object(s.a)(Object(re.a)(c,o),l))),h=Object(re.a)(d,f);return Er(h,u,i)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dr=Object(_.b)({meanSquaredError_:function(t,e,n,r=Cr.a.SUM_BY_NONZERO_WEIGHTS){const i=Object(x.a)(t,"labels","meanSquaredError"),a=Object(x.a)(e,"predictions","meanSquaredError");let o=null;null!=n&&(o=Object(x.a)(n,"weights","meanSquaredError")),Object(T.e)(i.shape,a.shape,"Error in meanSquaredError: ");const s=Object(sn.a)(i,a);return Er(s,o,r)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ir=Object(_.b)({sigmoidCrossEntropy_:function(t,e,n,r=0,a=Cr.a.SUM_BY_NONZERO_WEIGHTS){let o=Object(x.a)(t,"multiClassLabels","sigmoidCrossEntropy");const u=Object(x.a)(e,"logits","sigmoidCrossEntropy");let c=null;if(null!=n&&(c=Object(x.a)(n,"weights","sigmoidCrossEntropy")),Object(T.e)(o.shape,u.shape,"Error in sigmoidCrossEntropy: "),r>0){const t=Object(Le.a)(r),e=Object(Le.a)(1),n=Object(Le.a)(.5);o=Object(s.a)(Object(O.a)(o,Object(re.a)(e,t)),Object(O.a)(n,t))}const l=function(t,e){const n=Object(x.a)(t,"labels","sigmoidCrossEntropyWithLogits"),r=Object(x.a)(e,"logits","sigmoidCrossEntropyWithLogits");Object(T.e)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const a=Object(Te.a)(r),o=Object(O.a)(r,n),u=Object(Rt.a)(Object(mt.a)(Object(se.a)(Object(i.a)(r))));return Object(s.a)(Object(re.a)(a,o),u)}(o,u);return Er(l,c,a)}});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mr=Object(_.b)({softmaxCrossEntropy_:function(t,e,n,r=0,i=Cr.a.SUM_BY_NONZERO_WEIGHTS){let a=Object(x.a)(t,"onehotLabels","softmaxCrossEntropy");const o=Object(x.a)(e,"logits","softmaxCrossEntropy");let u=null;if(null!=n&&(u=Object(x.a)(n,"weights","softmaxCrossEntropy")),Object(T.e)(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const t=Object(Le.a)(r),e=Object(Le.a)(1),n=Object(Le.a)(a.shape[1]);a=Object(s.a)(Object(O.a)(a,Object(re.a)(e,t)),Object(ct.a)(t,n))}const c=function(t,e,n=-1){if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was `+n);return Object(Hn.a)((t,e,r)=>{const i=Object(Lt.a)(e,[n],!0),a=Object(re.a)(Object(B.a)(e,"float32"),i);r([t,a]);const o=Object(se.a)(Object(O.a)(a,t));return{value:Object(fn.a)(o,[n]),gradFunc:(t,e)=>{const[r,i]=e,a=Object(ee.e)(t.shape,[n]);return[Object(O.a)(Object(yt.a)(t,a),Object(re.a)(Object(B.a)(r,"float32"),Object(mt.a)(i))),Object(O.a)(Object(yt.a)(t,a),Object(re.a)(Object(mt.a)(i),Object(B.a)(r,"float32")))]}}})(t,e)}(a,o);return Er(c,u,i)}});n.d(e,"Bb",(function(){return Br})),n.d(e,"Mb",(function(){return zr})),n.d(e,"Yb",(function(){return Lr})),n.d(e,"yd",(function(){return $r})),n.d(e,"md",(function(){return Rr})),n.d(e,"b",(function(){return i.a})),n.d(e,"c",(function(){return a.a})),n.d(e,"d",(function(){return o.a})),n.d(e,"e",(function(){return s.a})),n.d(e,"f",(function(){return u.a})),n.d(e,"h",(function(){return c.a})),n.d(e,"i",(function(){return l.a})),n.d(e,"j",(function(){return d.a})),n.d(e,"k",(function(){return f.a})),n.d(e,"l",(function(){return h.a})),n.d(e,"m",(function(){return p.a})),n.d(e,"n",(function(){return m.a})),n.d(e,"o",(function(){return g.a})),n.d(e,"p",(function(){return b.a})),n.d(e,"q",(function(){return y.a})),n.d(e,"r",(function(){return v.a})),n.d(e,"s",(function(){return S})),n.d(e,"x",(function(){return j.a})),n.d(e,"t",(function(){return N.a})),n.d(e,"u",(function(){return F})),n.d(e,"v",(function(){return D})),n.d(e,"w",(function(){return I})),n.d(e,"y",(function(){return M.a})),n.d(e,"A",(function(){return $.a})),n.d(e,"B",(function(){return R.a})),n.d(e,"C",(function(){return B.a})),n.d(e,"D",(function(){return z.a})),n.d(e,"E",(function(){return L.a})),n.d(e,"F",(function(){return P.a})),n.d(e,"G",(function(){return q.a})),n.d(e,"H",(function(){return w.a})),n.d(e,"I",(function(){return W})),n.d(e,"J",(function(){return U})),n.d(e,"K",(function(){return V})),n.d(e,"L",(function(){return G})),n.d(e,"M",(function(){return H.a})),n.d(e,"N",(function(){return X.a})),n.d(e,"O",(function(){return K.a})),n.d(e,"P",(function(){return Y.a})),n.d(e,"Q",(function(){return Z})),n.d(e,"R",(function(){return Q.a})),n.d(e,"S",(function(){return tt.a})),n.d(e,"U",(function(){return et.a})),n.d(e,"V",(function(){return nt.a})),n.d(e,"W",(function(){return rt.a})),n.d(e,"X",(function(){return it.a})),n.d(e,"Y",(function(){return st})),n.d(e,"Z",(function(){return ut.a})),n.d(e,"ab",(function(){return ct.a})),n.d(e,"bb",(function(){return lt.a})),n.d(e,"db",(function(){return dt.a})),n.d(e,"fb",(function(){return ft.a})),n.d(e,"hb",(function(){return ht.a})),n.d(e,"jb",(function(){return pt.a})),n.d(e,"kb",(function(){return mt.a})),n.d(e,"lb",(function(){return gt.a})),n.d(e,"mb",(function(){return bt.a})),n.d(e,"nb",(function(){return xt})),n.d(e,"pb",(function(){return wt.a})),n.d(e,"qb",(function(){return kt.a})),n.d(e,"rb",(function(){return Ot.a})),n.d(e,"tb",(function(){return _t.a})),n.d(e,"vb",(function(){return At.a})),n.d(e,"wb",(function(){return Ct.a})),n.d(e,"Ab",(function(){return Et.a})),n.d(e,"Eb",(function(){return St.a})),n.d(e,"Fb",(function(){return jt.a})),n.d(e,"Gb",(function(){return Nt.a})),n.d(e,"Hb",(function(){return Tt.a})),n.d(e,"Ib",(function(){return Ft.a})),n.d(e,"Jb",(function(){return Dt.a})),n.d(e,"Nb",(function(){return It.a})),n.d(e,"Ob",(function(){return Mt.a})),n.d(e,"Pb",(function(){return $t.a})),n.d(e,"Qb",(function(){return Rt.a})),n.d(e,"Rb",(function(){return Bt.a})),n.d(e,"Sb",(function(){return zt.a})),n.d(e,"Tb",(function(){return Lt.a})),n.d(e,"Ub",(function(){return Pt.a})),n.d(e,"Vb",(function(){return qt.a})),n.d(e,"Wb",(function(){return Wt.a})),n.d(e,"Xb",(function(){return Ut.a})),n.d(e,"Zb",(function(){return k.a})),n.d(e,"ac",(function(){return Vt.a})),n.d(e,"bc",(function(){return Gt.a})),n.d(e,"cc",(function(){return Ht.a})),n.d(e,"dc",(function(){return Xt.a})),n.d(e,"ec",(function(){return Kt.a})),n.d(e,"gc",(function(){return Yt.a})),n.d(e,"hc",(function(){return Jt.a})),n.d(e,"ic",(function(){return Zt.a})),n.d(e,"kc",(function(){return Qt.a})),n.d(e,"lc",(function(){return te.a})),n.d(e,"nc",(function(){return ie})),n.d(e,"pc",(function(){return O.a})),n.d(e,"rc",(function(){return ae})),n.d(e,"sc",(function(){return oe.a})),n.d(e,"tc",(function(){return se.a})),n.d(e,"vc",(function(){return ue.a})),n.d(e,"xc",(function(){return ce.a})),n.d(e,"yc",(function(){return le.a})),n.d(e,"zc",(function(){return de.a})),n.d(e,"Bc",(function(){return fe})),n.d(e,"Cc",(function(){return he.a})),n.d(e,"Dc",(function(){return pe})),n.d(e,"Ec",(function(){return me})),n.d(e,"Fc",(function(){return ge})),n.d(e,"Gc",(function(){return be})),n.d(e,"Hc",(function(){return ye.a})),n.d(e,"Ic",(function(){return ve.a})),n.d(e,"Kc",(function(){return xe.a})),n.d(e,"Lc",(function(){return we.a})),n.d(e,"Mc",(function(){return ke.a})),n.d(e,"Nc",(function(){return Oe})),n.d(e,"Oc",(function(){return Ae})),n.d(e,"Pc",(function(){return Ce})),n.d(e,"Qc",(function(){return Ee.a})),n.d(e,"Rc",(function(){return Se.a})),n.d(e,"Sc",(function(){return je.a})),n.d(e,"Tc",(function(){return Ne.a})),n.d(e,"Uc",(function(){return Te.a})),n.d(e,"Vc",(function(){return Fe.a})),n.d(e,"Wc",(function(){return yt.a})),n.d(e,"Xc",(function(){return De.a})),n.d(e,"Yc",(function(){return Ie})),n.d(e,"Zc",(function(){return Me})),n.d(e,"ad",(function(){return $e})),n.d(e,"bd",(function(){return Re})),n.d(e,"dd",(function(){return Be.a})),n.d(e,"ed",(function(){return ze.a})),n.d(e,"fd",(function(){return Le.a})),n.d(e,"hd",(function(){return Pe.a})),n.d(e,"id",(function(){return qe.a})),n.d(e,"jd",(function(){return We.a})),n.d(e,"kd",(function(){return A.a})),n.d(e,"ld",(function(){return Ue.a})),n.d(e,"nd",(function(){return Ve.a})),n.d(e,"od",(function(){return Ge.a})),n.d(e,"pd",(function(){return C.a})),n.d(e,"qd",(function(){return He})),n.d(e,"rd",(function(){return Xe})),n.d(e,"sd",(function(){return Ke})),n.d(e,"td",(function(){return Ye})),n.d(e,"ud",(function(){return Je.a})),n.d(e,"vd",(function(){return Ze.a})),n.d(e,"wd",(function(){return Qe.a})),n.d(e,"ob",(function(){return tn.a})),n.d(e,"zb",(function(){return en.a})),n.d(e,"Db",(function(){return nn.a})),n.d(e,"cd",(function(){return rn.a})),n.d(e,"zd",(function(){return an.a})),n.d(e,"Ad",(function(){return on.a})),n.d(e,"Bd",(function(){return ne.a})),n.d(e,"Cd",(function(){return sn.a})),n.d(e,"Ed",(function(){return un.a})),n.d(e,"Fd",(function(){return cn.a})),n.d(e,"Gd",(function(){return ln.a})),n.d(e,"Hd",(function(){return dn.a})),n.d(e,"Id",(function(){return re.a})),n.d(e,"Kd",(function(){return fn.a})),n.d(e,"Ld",(function(){return hn.a})),n.d(e,"Md",(function(){return E.a})),n.d(e,"Nd",(function(){return pn.a})),n.d(e,"Od",(function(){return mn.a})),n.d(e,"Pd",(function(){return bn})),n.d(e,"Qd",(function(){return yn.a})),n.d(e,"Rd",(function(){return vn})),n.d(e,"Sd",(function(){return xn})),n.d(e,"Td",(function(){return wn})),n.d(e,"Ud",(function(){return vt.a})),n.d(e,"Vd",(function(){return kn.a})),n.d(e,"Xd",(function(){return On.a})),n.d(e,"Yd",(function(){return _n.a})),n.d(e,"Zd",(function(){return An.a})),n.d(e,"ae",(function(){return Cn.a})),n.d(e,"be",(function(){return En})),n.d(e,"ce",(function(){return Sn.a})),n.d(e,"de",(function(){return jn.a})),n.d(e,"ee",(function(){return Nn.a})),n.d(e,"fe",(function(){return Tn.a})),n.d(e,"z",(function(){return Fn})),n.d(e,"ib",(function(){return Dn.a})),n.d(e,"xb",(function(){return Dn.b})),n.d(e,"yb",(function(){return Dn.c})),n.d(e,"Kb",(function(){return Dn.d})),n.d(e,"Lb",(function(){return Dn.e})),n.d(e,"wc",(function(){return Dn.f})),n.d(e,"g",(function(){return In.a})),n.d(e,"cb",(function(){return In.b})),n.d(e,"fc",(function(){return In.c})),n.d(e,"jc",(function(){return In.d})),n.d(e,"mc",(function(){return In.e})),n.d(e,"qc",(function(){return In.f})),n.d(e,"Jc",(function(){return In.g})),n.d(e,"Dd",(function(){return In.h})),n.d(e,"Jd",(function(){return In.i})),n.d(e,"Wd",(function(){return Mn.a})),n.d(e,"uc",(function(){return $n.a})),n.d(e,"oc",(function(){return Bn})),n.d(e,"gd",(function(){return zn.a})),n.d(e,"xd",(function(){return Ln.a})),n.d(e,"ub",(function(){return Pn.a})),n.d(e,"eb",(function(){return Wn})),n.d(e,"gb",(function(){return Un})),n.d(e,"T",(function(){return Vn})),n.d(e,"Cb",(function(){return Gn})),n.d(e,"Ac",(function(){return _.b})),n.d(e,"a",(function(){return _.a})),n.d(e,"sb",(function(){return r}));
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const $r={fft:tn.a,ifft:en.a,rfft:rn.a,irfft:nn.a},Rr={hammingWindow:ir,hannWindow:ar,frame:or,stft:sr},Br={flipLeftRight:cr,resizeNearestNeighbor:xr.a,resizeBilinear:vr.a,rotateWithOffset:lr,cropAndResize:ur,nonMaxSuppression:fr,nonMaxSuppressionAsync:pr,nonMaxSuppressionWithScore:mr,nonMaxSuppressionWithScoreAsync:gr,nonMaxSuppressionPadded:br,nonMaxSuppressionPaddedAsync:yr},zr={bandPart:wr,gramSchmidt:kr,qr:Ar},Lr={absoluteDifference:Sr,computeWeightedLoss:Er,cosineDistance:jr,hingeLoss:Nr,huberLoss:Tr,logLoss:Fr,meanSquaredError:Dr,sigmoidCrossEntropy:Ir,softmaxCrossEntropy:Mr}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(11),s=n(4);const u=Object(s.b)({sum_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=null,n=!1){let s=Object(a.a)(t,"x","sum");"bool"===s.dtype&&(s=Object(o.a)(s,"int32"));const u={x:s},c={axis:e,keepDims:n};return r.a.runKernel(i.Qc,u,c)}})},function(t,e,n){"use strict";n.d(e,"g",(function(){return s})),n.d(e,"f",(function(){return u})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"e",(function(){return d})),n.d(e,"h",(function(){return f})),n.d(e,"m",(function(){return h})),n.d(e,"n",(function(){return p})),n.d(e,"t",(function(){return m})),n.d(e,"d",(function(){return g})),n.d(e,"l",(function(){return b})),n.d(e,"u",(function(){return y})),n.d(e,"r",(function(){return v})),n.d(e,"o",(function(){return x})),n.d(e,"k",(function(){return w})),n.d(e,"q",(function(){return k})),n.d(e,"i",(function(){return O})),n.d(e,"j",(function(){return _})),n.d(e,"p",(function(){return A})),n.d(e,"a",(function(){return C})),n.d(e,"s",(function(){return E}));var r=n(5),i=n(23),a=n(6),o=n(22);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(){Object(i.c)().set("PROD",!0)}function u(){Object(i.c)().set("DEBUG",!0)}function c(){Object(i.c)().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function l(t){Object(i.c)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function d(){r.a.disposeVariables()}function f(){return r.a}function h(){return r.a.memory()}function p(t){return r.a.profile(t)}function m(t,e){return r.a.tidy(t,e)}function g(t){Object(o.getTensorsInContainer)(t).forEach(t=>t.dispose())}function b(t){return r.a.keep(t)}function y(t){return r.a.time(t)}function v(t){return r.a.setBackend(t)}function x(){return r.a.ready()}function w(){return r.a.backendName}function k(t){r.a.removeBackend(t)}function O(t){return r.a.findBackend(t)}function _(t){return r.a.findBackendFactory(t)}function A(t,e,n=1){return r.a.registerBackend(t,e,n)}function C(){return r.a.backend}function E(t,e){Object(i.c)().setPlatform(t,e)}Object(a.d)(l)},function(t,e,n){"use strict";function r(t,e,n){return t.fields=e||[],t.fname=n,t}function i(t){return 1===t.length?a(t[0]):o(t)}const a=t=>function(e){return e[t]},o=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function s(t){throw Error(t)}function u(t){const e=[],n=t.length;let r,i,a,o=null,u=0,c="";function l(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i),c+=t.substring(++i,++i),r=i;else if(a===o)l(),o=null,u=-1;else{if(o)continue;r===u&&'"'===a||r===u&&"'"===a?(r=i+1,o=a):"."!==a||u?"["===a?(i>r&&l(),u=r=i+1):"]"===a&&(u||s("Access path missing open bracket: "+t),u>0&&l(),u=0,r=i+1):i>r?l():r=i+1}return u&&s("Access path missing closing bracket: "+t),o&&s("Access path missing closing quote: "+t),i>r&&(i++,l()),e}function c(t,e,n){const a=u(t);return t=1===a.length?a[0]:t,r((n&&n.get||i)(a),[t],e||t)}c("id"),r(t=>t,[],"identity");const l=r(()=>0,[],"zero"),d=r(()=>1,[],"one");r(()=>!0,[],"true"),r(()=>!1,[],"false");var f=Array.isArray;function h(t){return t[t.length-1]}function p(t){return null!=t?f(t)?t:[t]:[]}function m(t){return"function"==typeof t}function g(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const b=Object.prototype.hasOwnProperty;function y(t,e){return b.call(t,e)}var v=n(320),x=n(90),w=n(321),k=n(91),O=n(158),_=n(448),A=n(449),C=n(450),E=n(451),S=n(452),j=n(159),N=n(453),T=n(454),F=n(455),D=n(229),I=n(456);n.d(e,"a",(function(){return z})),n.d(e,"b",(function(){return L})),n.d(e,"c",(function(){return P})),n.d(e,"d",(function(){return q})),n.d(e,"e",(function(){return V})),n.d(e,"f",(function(){return W})),n.d(e,"g",(function(){return R})),n.d(e,"h",(function(){return $})),n.d(e,"i",(function(){return U})),n.d(e,"j",(function(){return G})),n.d(e,"k",(function(){return B})),n.d(e,"l",(function(){return M})),n.d(e,"m",(function(){return Q})),n.d(e,"n",(function(){return Rt})),n.d(e,"o",(function(){return mt})),n.d(e,"p",(function(){return wt})),n.d(e,"q",(function(){return _t})),n.d(e,"r",(function(){return Et})),n.d(e,"s",(function(){return Y})),n.d(e,"t",(function(){return X})),n.d(e,"u",(function(){return yt})),n.d(e,"v",(function(){return kt})),n.d(e,"w",(function(){return At})),n.d(e,"x",(function(){return St})),n.d(e,"y",(function(){return at})),n.d(e,"z",(function(){return ot})),n.d(e,"A",(function(){return tt}));const M="year",$="quarter",R="month",B="week",z="date",L="day",P="dayofyear",q="hours",W="minutes",U="seconds",V="milliseconds",G=[M,$,R,B,z,L,P,q,W,U,V],H=G.reduce((t,e,n)=>(t[e]=1+n,t),{});function X(t){const e=p(t).slice(),n={};e.length||s("Missing time unit."),e.forEach(t=>{y(H,t)?n[t]=1:s("Invalid time unit: ".concat(t,"."))});return(n[B]||n[L]?1:0)+(n[$]||n[R]||n[z]?1:0)+(n[P]?1:0)>1&&s("Incompatible time units: ".concat(t)),e.sort((t,e)=>H[t]-H[e]),e}const K={[M]:"%Y ",[$]:"Q%q ",[R]:"%b ",[z]:"%d ",[B]:"W%U ",[L]:"%a ",[P]:"%j ",[q]:"%H:00",[W]:"00:%M",[U]:":%S",[V]:".%L",["".concat(M,"-").concat(R)]:"%Y-%m ",["".concat(M,"-").concat(R,"-").concat(z)]:"%Y-%m-%d ",["".concat(q,"-").concat(W)]:"%H:%M"};function Y(t,e){const n=g({},K,e),r=X(t),i=r.length;let a,o,s="",u=0;for(u=0;u<i;)for(a=r.length;a>u;--a)if(o=r.slice(u,a).join("-"),null!=n[o]){s+=n[o],u=a;break}return s.trim()}const J=new Date;function Z(t){return J.setFullYear(t),J.setMonth(0),J.setDate(1),J.setHours(0,0,0,0),J}function Q(t){return et(new Date(t))}function tt(t){return nt(new Date(t))}function et(t){return v.a.count(Z(t.getFullYear())-1,t)}function nt(t){return x.b.count(Z(t.getFullYear())-1,t)}function rt(t){return Z(t).getDay()}function it(t,e,n,r,i,a,o){if(0<=t&&t<100){const s=new Date(-1,e,n,r,i,a,o);return s.setFullYear(t),s}return new Date(t,e,n,r,i,a,o)}function at(t){return st(new Date(t))}function ot(t){return ut(new Date(t))}function st(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return w.a.count(e-1,t)}function ut(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return k.b.count(e-1,t)}function ct(t){return J.setTime(Date.UTC(t,0,1)),J.getUTCDay()}function lt(t,e,n,r,i,a,o){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,r,i,a,o));return t.setUTCFullYear(n.y),t}return new Date(Date.UTC(t,e,n,r,i,a,o))}function dt(t,e,n,r,i){const a=e||1,o=h(t),s=(t,e,i)=>function(t,e,n,r){const i=n<=1?t:r?(e,i)=>r+n*Math.floor((t(e,i)-r)/n):(e,r)=>n*Math.floor(t(e,r)/n);return e?(t,n)=>e(i(t,n),n):i}(n[i=i||t],r[i],t===o&&a,e),u=new Date,c=function(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}(t),f=c[M]?s(M):function(t){return m(t)?t:()=>t}(2012),p=c[R]?s(R):c[$]?s($):l,g=c[B]&&c[L]?s(L,1,B+L):c[B]?s(B,1):c[L]?s(L,1):c[z]?s(z,1):c[P]?s(P,1):d,b=c[q]?s(q):l,y=c[W]?s(W):l,v=c[U]?s(U):l,x=c[V]?s(V):l;return function(t){u.setTime(+t);const e=f(u);return i(e,p(u),g(u,e),b(u),y(u),v(u),x(u))}}function ft(t,e,n){return e+7*t-(n+6)%7}const ht={[M]:t=>t.getFullYear(),[$]:t=>Math.floor(t.getMonth()/3),[R]:t=>t.getMonth(),[z]:t=>t.getDate(),[q]:t=>t.getHours(),[W]:t=>t.getMinutes(),[U]:t=>t.getSeconds(),[V]:t=>t.getMilliseconds(),[P]:t=>et(t),[B]:t=>nt(t),[B+L]:(t,e)=>ft(nt(t),t.getDay(),rt(e)),[L]:(t,e)=>ft(1,t.getDay(),rt(e))},pt={[$]:t=>3*t,[B]:(t,e)=>ft(t,0,rt(e))};function mt(t,e){return dt(t,e||1,ht,pt,it)}const gt={[M]:t=>t.getUTCFullYear(),[$]:t=>Math.floor(t.getUTCMonth()/3),[R]:t=>t.getUTCMonth(),[z]:t=>t.getUTCDate(),[q]:t=>t.getUTCHours(),[W]:t=>t.getUTCMinutes(),[U]:t=>t.getUTCSeconds(),[V]:t=>t.getUTCMilliseconds(),[P]:t=>st(t),[B]:t=>ut(t),[L]:(t,e)=>ft(1,t.getUTCDay(),ct(e)),[B+L]:(t,e)=>ft(ut(t),t.getUTCDay(),ct(e))},bt={[$]:t=>3*t,[B]:(t,e)=>ft(t,0,ct(e))};function yt(t,e){return dt(t,e||1,gt,bt,lt)}const vt={[M]:O.a,[$]:_.a.every(3),[R]:_.a,[B]:x.b,[z]:v.a,[L]:v.a,[P]:v.a,[q]:A.a,[W]:C.a,[U]:E.a,[V]:S.a},xt={[M]:j.a,[$]:N.a.every(3),[R]:N.a,[B]:k.b,[z]:w.a,[L]:w.a,[P]:w.a,[q]:T.a,[W]:F.a,[U]:E.a,[V]:S.a};function wt(t){return vt[t]}function kt(t){return xt[t]}function Ot(t,e,n){return t?t.offset(e,n):void 0}function _t(t,e,n){return Ot(wt(t),e,n)}function At(t,e,n){return Ot(kt(t),e,n)}function Ct(t,e,n,r){return t?t.range(e,n,r):void 0}function Et(t,e,n,r){return Ct(wt(t),e,n,r)}function St(t,e,n,r){return Ct(kt(t),e,n,r)}const jt=[M,R,z,q,W,U,V],Nt=jt.slice(0,-1),Tt=Nt.slice(0,-1),Ft=Tt.slice(0,-1),Dt=Ft.slice(0,-1),It=[M,R],Mt=[M],$t=[[Nt,1,1e3],[Nt,5,5e3],[Nt,15,15e3],[Nt,30,3e4],[Tt,1,6e4],[Tt,5,3e5],[Tt,15,9e5],[Tt,30,18e5],[Ft,1,36e5],[Ft,3,108e5],[Ft,6,216e5],[Ft,12,432e5],[Dt,1,864e5],[[M,B],1,6048e5],[It,1,2592e6],[It,3,7776e6],[Mt,1,31536e6]];function Rt(t){const e=t.extent,n=t.maxbins||40,r=Math.abs(function(t){return t&&h(t)-t[0]||0}(e))/n;let i,a,o=Object(D.a)(t=>t[2]).right($t,r);return o===$t.length?(i=Mt,a=Object(I.c)(e[0]/31536e6,e[1]/31536e6,n)):o?(o=$t[r/$t[o-1][2]<$t[o][2]/r?o-1:o],i=o[0],a=o[1]):(i=jt,a=Math.max(Object(I.c)(e[0],e[1],n),1)),{units:i,step:a}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({zerosLike_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","zerosLike")};return r.a.runKernel(i.Zc,e)}})},function(t,e,n){"use strict";n.r(e),n.d(e,"makeTypesMatch",(function(){return o})),n.d(e,"assertTypesMatch",(function(){return s})),n.d(e,"isTensorInList",(function(){return u})),n.d(e,"getTensorsInContainer",(function(){return c}));var r=n(6),i=n(96),a=n(7);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function o(t,e){if(t.dtype===e.dtype)return[t,e];const n=Object(i.c)(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function s(t,e){Object(a.b)(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function u(t,e){return e.some(e=>e.id===t.id)}function c(t){const e=[];return function t(e,n,i){if(null==e)return;if(e instanceof r.a)return void n.push(e);if(a=e,!Array.isArray(a)&&"object"!=typeof a)return;var a;const o=e;for(const e in o){const r=o[e];i.has(r)||(i.add(r),t(r,n,i))}}(t,e,new Set),e}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return o})),n.d(e,"d",(function(){return s}));var r=n(7);
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];console.warn(`Setting feature override from URL ${t}: ${e}.`),this.set(t,e)}}async getAsync(t){return t in this.flags||(this.flags[t]=await this.evaluateFlag(t)),this.flags[t]}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(Object(r.x)(e))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;const t=function(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...n)=>(function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("="))),e}(this.global.location.search);if("tfjsflags"in t){t.tfjsflags.split(",").forEach(t=>{const[e,n]=t.split(":");this.urlFlags[e]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${t}.`)}(e,n)})}}}function a(){return o}let o=null;function s(t){o=t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(5),i=n(1),a=n(4);const o=Object(a.b)({square_:
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e=Object(i.a)(t,"x","square");return r.a.runKernel("Square",{x:e},{})}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({slice_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n){const o=Object(a.a)(t,"x","slice","string_or_numeric");if(0===o.rank)throw new Error("Slicing scalar is not possible");const s={x:o},u={begin:e,size:n};return r.a.runKernel(i.Ec,s,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(4);const u=Object(s.b)({matMul_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n=!1,s=!1){let u=Object(o.a)(t,"a","matMul"),c=Object(o.a)(e,"b","matMul");[u,c]=Object(a.makeTypesMatch)(u,c);const l={a:u,b:c},d={transposeA:n,transposeB:s};return r.a.runKernel(i.s,l,d)}})},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function r(t,e,n,r,i="NHWC",a){return o(t,[...e,t[3]],n,a,r,null,null,m(i))}function i(t,e,n,r,i,a,s="channelsLast"){const[u,l]=c(e);let d;if("channelsLast"===s)d=[u,l,t[3],t[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);d=[u,l,t[1],t[1]]}return o(t,d,n,r,i,a,!1,s)}function a(t,e,n,r,i,a,o="NDHWC"){const[u,c,d]=l(e);let f,h;if("NDHWC"===o)h="channelsLast",f=[u,c,d,t[4],t[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat "+o);h="channelsFirst",f=[u,c,d,t[1],t[1]]}return s(t,f,n,r,i,!1,h,a)}function o(t,e,n,r,i,a,o=!1,s="channelsLast"){let[l,h,p,m]=[-1,-1,-1,-1];if("channelsLast"===s)[l,h,p,m]=t;else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);[l,m,h,p]=t}const[g,b,,y]=e,[v,x]=c(n),[w,k]=c(r),O=d(g,w),_=d(b,k),{padInfo:A,outHeight:C,outWidth:E}=function(t,e,n,r,i,a,o,s,c){let l,d,h;if("number"==typeof t){l={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};const i=function(t,e,n,r,i){null==r&&(r=u(t,e,n));const a=t[0],o=t[1],s=f((a-e+2*r)/n+1,i),c=f((o-e+2*r)/n+1,i);return[s,c]}([e,n],a,r,t,s);d=i[0],h=i[1]}else if("same"===t){d=Math.ceil(e/r),h=Math.ceil(n/i);const t=Math.max(0,(d-1)*r+a-e),s=Math.max(0,(h-1)*i+o-n),u=Math.floor(t/2),c=t-u,f=Math.floor(s/2);l={top:u,bottom:c,left:f,right:s-f,type:"SAME"}}else if("valid"===t)l={top:0,bottom:0,left:0,right:0,type:"VALID"},d=Math.ceil((e-a+1)/r),h=Math.ceil((n-o+1)/i);else{if("object"!=typeof t)throw Error("Unknown padding parameter: "+t);{const u="channelsLast"===c?t[1][0]:t[2][0],p="channelsLast"===c?t[1][1]:t[2][1],m="channelsLast"===c?t[2][0]:t[3][0],g="channelsLast"===c?t[2][1]:t[3][1];l={top:u,bottom:p,left:m,right:g,type:0===u&&0===p&&0===m&&0===g?"VALID":"EXPLICIT"},d=f((e-a+u+p)/r+1,s),h=f((n-o+m+g)/i+1,s)}}return{padInfo:l,outHeight:d,outWidth:h}}(i,h,p,v,x,O,_,a,s),S=o?y*m:y;let j;return"channelsFirst"===s?j=[l,S,C,E]:"channelsLast"===s&&(j=[l,C,E,S]),{batchSize:l,dataFormat:s,inHeight:h,inWidth:p,inChannels:m,outHeight:C,outWidth:E,outChannels:S,padInfo:A,strideHeight:v,strideWidth:x,filterHeight:g,filterWidth:b,effectiveFilterHeight:O,effectiveFilterWidth:_,dilationHeight:w,dilationWidth:k,inShape:t,outShape:j,filterShape:e}}function s(t,e,n,r,i,a=!1,o="channelsLast",s){let[c,h,p,m,g]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[c,h,p,m,g]=t;else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);[c,g,h,p,m]=t}const[b,y,v,,x]=e,[w,k,O]=l(n),[_,A,C]=l(r),E=d(b,_),S=d(y,A),j=d(v,C),{padInfo:N,outDepth:T,outHeight:F,outWidth:D}=function(t,e,n,r,i,a,o,s,c,l,d){let h,p,m,g;if("number"==typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};const a=function(t,e,n,r,i,a){null==i&&(i=u(t,e,r));const o=t[0],s=t[1],c=t[2],l=f((o-e+2*i)/r+1,a),d=f((s-e+2*i)/r+1,a),h=f((c-e+2*i)/r+1,a);return[l,d,h,n]}([e,n,r,1],s,1,i,t,d);p=a[0],m=a[1],g=a[2]}else if("same"===t){p=Math.ceil(e/i),m=Math.ceil(n/a),g=Math.ceil(r/o);const t=(p-1)*i+s-e,u=(m-1)*a+c-n,d=(g-1)*o+l-r,f=Math.floor(t/2),b=t-f,y=Math.floor(u/2),v=u-y,x=Math.floor(d/2);h={top:y,bottom:v,left:x,right:d-x,front:f,back:b,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((e-s+1)/i),m=Math.ceil((n-c+1)/a),g=Math.ceil((r-l+1)/o)}return{padInfo:h,outDepth:p,outHeight:m,outWidth:g}}(i,h,p,m,w,k,O,E,S,j,s),I=a?x*g:x;let M;return"channelsFirst"===o?M=[c,I,T,F,D]:"channelsLast"===o&&(M=[c,T,F,D,I]),{batchSize:c,dataFormat:o,inDepth:h,inHeight:p,inWidth:m,inChannels:g,outDepth:T,outHeight:F,outWidth:D,outChannels:I,padInfo:N,strideDepth:w,strideHeight:k,strideWidth:O,filterDepth:b,filterHeight:y,filterWidth:v,effectiveFilterDepth:E,effectiveFilterHeight:S,effectiveFilterWidth:j,dilationDepth:_,dilationHeight:A,dilationWidth:C,inShape:t,outShape:M,filterShape:e}}function u(t,e,n,r=1){const i=d(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function c(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function l(t){return"number"==typeof t?[t,t,t]:t}function d(t,e){return e<=1?t:t+(t-1)*(e-1)}function f(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function h(t){const[e,n,r]=c(t);return 1===e&&1===n&&1===r}function p(t,e){return h(t)||h(e)}function m(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat "+t)}n.d(e,"d",(function(){return r})),n.d(e,"e",(function(){return i})),n.d(e,"f",(function(){return a})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return u})),n.d(e,"i",(function(){return h})),n.d(e,"h",(function(){return p})),n.d(e,"g",(function(){return m}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({neg_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","neg")};return r.a.runKernel(i.Vb,e)}})},,function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=new Date,i=new Date;function a(t,e,n,o){function s(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return s.floor=function(e){return t(e=new Date(+e)),e},s.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},s.round=function(t){var e=s(t),n=s.ceil(t);return t-e<n-t?e:n},s.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},s.range=function(n,r,i){var a,o=[];if(n=s.ceil(n),i=null==i?1:Math.floor(i),!(n<r&&i>0))return o;do{o.push(a=new Date(+n)),e(n,i),t(n)}while(a<n&&n<r);return o},s.filter=function(n){return a((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(s.count=function(e,a){return r.setTime(+e),i.setTime(+a),t(r),t(i),Math.floor(n(r,i))},s.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?s.filter(o?function(e){return o(e)%t==0}:function(e){return s.count(0,e)%t==0}):s:null}),s}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(65),u=n(4);const c=Object(u.b)({concat_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=0){Object(o.b)(t.length>=1,()=>"Pass at least one tensor to concat");const n=Object(a.b)(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach(t=>{if("complex64"!==t.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${t.dtype}. `)}),1===n.length)return Object(s.a)(n[0]);const u=n,c={axis:e};return r.a.runKernel(i.B,u,c)}})},function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return s}));var r=1e3,i=6e4,a=36e5,o=864e5,s=6048e5},function(t,e,n){"use strict";function r(t,e,n){return t.fields=e||[],t.fname=n,t}function i(t){return 1===t.length?a(t[0]):o(t)}n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return m})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return b})),n.d(e,"e",(function(){return l})),n.d(e,"f",(function(){return p})),n.d(e,"g",(function(){return f})),n.d(e,"h",(function(){return y})),n.d(e,"i",(function(){return v})),n.d(e,"j",(function(){return w})),n.d(e,"k",(function(){return h})),n.d(e,"l",(function(){return k}));const a=t=>function(e){return e[t]},o=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function s(t){throw Error(t)}function u(t){const e=[],n=t.length;let r,i,a,o=null,u=0,c="";function l(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i),c+=t.substring(++i,++i),r=i;else if(a===o)l(),o=null,u=-1;else{if(o)continue;r===u&&'"'===a||r===u&&"'"===a?(r=i+1,o=a):"."!==a||u?"["===a?(i>r&&l(),u=r=i+1):"]"===a&&(u||s("Access path missing open bracket: "+t),u>0&&l(),u=0,r=i+1):i>r?l():r=i+1}return u&&s("Access path missing closing bracket: "+t),o&&s("Access path missing closing quote: "+t),i>r&&(i++,l()),e}function c(t,e,n){const a=u(t);return t=1===a.length?a[0]:t,r((n&&n.get||i)(a),[t],e||t)}c("id");const l=r(t=>t,[],"identity");r(()=>0,[],"zero"),r(()=>1,[],"one"),r(()=>!0,[],"true"),r(()=>!1,[],"false");var d=Array.isArray;function f(t){return t===Object(t)}function h(t){return null==t||""===t?null:+t}function p(t){return"function"==typeof t}function m(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const g=Object.prototype.hasOwnProperty;function b(t,e){return g.call(t,e)}function y(t){return d(t)?"["+t.map(y)+"]":f(t)||"string"==typeof t?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function v(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t}const x=t=>function(t){return"number"==typeof t}(t)||function(t){return"[object Date]"===Object.prototype.toString.call(t)}(t)?t:Date.parse(t);function w(t,e){return e=e||x,null==t||""===t?null:e(t)}function k(t){return null==t||""===t?null:t+""}},function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"f",(function(){return d})),n.d(e,"d",(function(){return c})),n.d(e,"e",(function(){return l})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return u}));var r=n(5),i=n(6),a=n(1),o=n(7);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){return o.b(o.u(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const i=Object(a.a)(e,"x","tf.grad","string_or_numeric"),s=null!=n?Object(a.a)(n,"dy","tf.grad"):null;return r.a.tidy(()=>{const{value:e,grads:n}=r.a.gradients(()=>t(i),[i],s);return null!=s&&o.e(e.shape,s.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),h(n),n[0]})}}function u(t){return o.b(o.u(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{o.b(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const i=Object(a.b)(e,"args","tf.grads","string_or_numeric"),s=null!=n?Object(a.a)(n,"dy","tf.grads"):null;return r.a.tidy(()=>{const{value:e,grads:n}=r.a.gradients(()=>t(...i),i,s);return null!=s&&o.e(e.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),h(n),n})}}function c(t){return o.b(o.u(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{o.b(e instanceof i.a,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),o.b(null==n||n instanceof i.a,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:a,value:s}=r.a.gradients(()=>t(e),[e],n);return h(a),{grad:a[0],value:s}}}function l(t){return o.b(o.u(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{o.b(Array.isArray(e)&&e.every(t=>t instanceof i.a),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),o.b(null==n||n instanceof i.a,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const a=r.a.gradients(()=>t(...e),e,n);return null!=n&&o.e(a.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),h(a.grads),a}}function d(t,e){o.b(o.u(t),()=>"The f passed in variableGrads(f) must be a function"),o.b(null==e||Array.isArray(e)&&e.every(t=>t instanceof i.c),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=null!=e;if(!n){e=[];for(const t in r.a.registeredVariables)e.push(r.a.registeredVariables[t])}const a=n?e.filter(t=>!t.trainable):null,s=e.length;e=e.filter(t=>t.trainable),o.b(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const{value:u,grads:c}=r.a.gradients(t,e,null,!0);o.b(c.some(t=>null!=t),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),o.b(0===u.rank,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${u.rank} tensor`);const l={};return e.forEach((t,e)=>{null!=c[e]&&(l[t.name]=c[e])}),null!=a&&a.forEach(t=>l[t.name]=null),{value:u,grads:l}}function f(t){return r.a.customGrad(t)}function h(t){if(t.filter(t=>null==t).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var r;n.d(e,"a",(function(){return r})),function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(109),u=n(16),c=n(4);const l=Object(c.b)({where_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n){const c=Object(a.a)(e,"a","where"),l=Object(a.a)(n,"b","where"),d=Object(a.a)(t,"condition","where","bool"),f=Object(u.a)(c.shape,l.shape),h=Object(s.a)(c,f),p=Object(s.a)(l,f);1===d.rank&&Object(o.b)(d.shape[0]===c.shape[0],()=>"The first dimension of `a` must match the size of `condition`."),1!==d.rank&&Object(o.e)(d.shape,p.shape,"Error in where: ");const m={condition:d,t:h,e:p};return r.a.runKernel(i.yc,m)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({sqrt_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","sqrt")};return r.a.runKernel(i.Kc,e)}})},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return s})),n.d(e,"a",(function(){return u})),n.d(e,"f",(function(){return c})),n.d(e,"h",(function(){return l})),n.d(e,"g",(function(){return d}));var r=n(7);
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function a(t,e,n){const r=t.length+e.length,i=[];let a=0,o=0;for(let s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[a++]):i.push(e[o++]);return i}function o(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map(e=>t[e])]}function s(t,e){return a(t,e.map(t=>1),e)}function u(t,e,n){r.b(i(e,n),()=>t+" supports only inner-most axes for now. "+`Got axes ${e} and rank-${n} input.`)}function c(t,e){if(i(t,e))return null;const n=[];for(let r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach(t=>n.push(t)),n}function l(t){return t.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}function d(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}},function(t,e,n){"use strict";(function(t){n.d(e,"f",(function(){return s})),n.d(e,"e",(function(){return u})),n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return h})),n.d(e,"d",(function(){return p})),n.d(e,"c",(function(){return m})),n.d(e,"g",(function(){return g}));var r=n(57),i=n(106),a=n(7),o=n(157);async function s(t,e){const n=[],r=[],i=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);for(let a=0;a<i.length;++a){const o=i[a],s=Array.isArray(t)?t[a].tensor:t[o];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error(`Unsupported dtype in weight '${o}': ${s.dtype}`);const u={name:o,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){const t=new Promise(async t=>{const e=await s.bytes(),n=e.reduce((t,e)=>t+e.length,0)+4*e.length,r=new Uint8Array(n);let i=0;for(let t=0;t<e.length;t++){const n=e[t],a=new Uint8Array(new Uint32Array([n.length]).buffer);r.set(a,i),i+=4,r.set(n,i),i+=n.length}t(r)});r.push(t)}else r.push(s.data());null!=e&&(u.group=e),n.push(u)}return{data:c(await Promise.all(r)),specs:n}}function u(t,e){const n={};let s,u=0;for(const c of e){const e=c.name,l=c.dtype,d=c.shape,f=Object(a.N)(d);let h;if("quantization"in c){const n=c.quantization;if("uint8"===n.dtype||"uint16"===n.dtype){if(!("min"in n)||!("scale"in n))throw new Error(`Weight ${c.name} with quantization ${n.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==n.dtype)throw new Error(`Weight ${c.name} has unknown quantization dtype ${n.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==l)throw new Error(`Weight ${c.name} is quantized with ${n.dtype} which only supports weights of type float32 not ${l}.`)}const r=o.a[n.dtype],i=t.slice(u,u+f*r),a="uint8"===n.dtype?new Uint8Array(i):new Uint16Array(i);if("float32"===l)if("uint8"===n.dtype||"uint16"===n.dtype){h=new Float32Array(a.length);for(let t=0;t<a.length;t++){const e=a[t];h[t]=e*n.scale+n.min}}else{if("float16"!==n.dtype)throw new Error(`Unsupported quantization type ${n.dtype} for weight type float32.`);void 0===s&&(s=b()),h=s(a)}else{if("int32"!==l)throw new Error(`Unsupported dtype in weight '${e}': ${l}`);if("uint8"!==n.dtype&&"uint16"!==n.dtype)throw new Error(`Unsupported quantization type ${n.dtype} for weight type int32.`);h=new Int32Array(a.length);for(let t=0;t<a.length;t++){const e=a[t];h[t]=Math.round(e*n.scale+n.min)}}u+=f*r}else if("string"===l){const e=Object(a.N)(c.shape);h=[];for(let n=0;n<e;n++){const e=new Uint32Array(t.slice(u,u+4))[0];u+=4;const n=new Uint8Array(t.slice(u,u+e));h.push(n),u+=e}}else{const a=o.a[l],s=t.slice(u,u+f*a);if("float32"===l)h=new Float32Array(s);else if("int32"===l)h=new Int32Array(s);else if("bool"===l)h=new Uint8Array(s);else{if("complex64"!==l)throw new Error(`Unsupported dtype in weight '${e}': ${l}`);{h=new Float32Array(s);const t=new Float32Array(h.length/2),a=new Float32Array(h.length/2);for(let e=0;e<t.length;e++)t[e]=h[2*e],a[e]=h[2*e+1];const o=Object(i.a)(t,d,"float32"),u=Object(i.a)(a,d,"float32");n[e]=Object(r.a)(o,u),o.dispose(),u.dispose()}}u+=f*a}"complex64"!==l&&(n[e]=Object(i.a)(h,d,l))}return n}function c(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));let e=0;const n=[];t.forEach(t=>{if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)});const r=new Uint8Array(e);let i=0;return n.forEach(t=>{r.set(new Uint8Array(t.buffer),i),i+=t.byteLength}),r.buffer}const l=void 0!==t&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function d(e){return l?t.byteLength(e):new Blob([e]).size}function f(e){if(l)return t.from(e).toString("base64");const n=new Uint8Array(e);let r="";for(let t=0,e=n.length;t<e;t++)r+=String.fromCharCode(n[t]);return btoa(r)}function h(e){if(l){const n=t.from(e,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}const n=atob(e),r=new Uint8Array(n.length);for(let t=0;t<n.length;++t)r.set([n.charCodeAt(t)],t);return r.buffer}function p(t){if(1===t.length)return t[0];let e=0;t.forEach(t=>{e+=t.byteLength});const n=new Uint8Array(e);let r=0;return t.forEach(t=>{n.set(new Uint8Array(t),r),r+=t.byteLength}),n.buffer}function m(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);const e=t.split("/");return e[e.length-1]}function g(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:d(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:d(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}function b(){const t=function(){const t=t=>{let e=t<<13,n=0;for(;0==(8388608&e);)n-=8388608,e<<=1;return e&=-8388609,n+=947912704,e|n},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}(),e=function(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}(),n=function(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}();return r=>{const i=new ArrayBuffer(4*r.length),a=new Uint32Array(i);for(let i=0;i<r.length;i++){const o=r[i],s=t[n[o>>10]+(1023&o)]+e[o>>10];a[i]=s}return new Float32Array(i)}}}).call(this,n(94).Buffer)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({exp_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","exp")};return r.a.runKernel(i.Z,e)}})},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return E})),n.d(e,"b",(function(){return S})),n.d(e,"c",(function(){return x})),n.d(e,"d",(function(){return w})),n.d(e,"e",(function(){return T})),n.d(e,"f",(function(){return N})),n.d(e,"g",(function(){return j})),n.d(e,"h",(function(){return b}));var r=n(33),i=n(440),a=n(231),o=n(62);const s=/^([A-Za-z]+:)?\/\//,u=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,c=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;async function l(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function d(t,e){e=Object(r.b)({},this.options,e);const n=this.fileAccess,i={href:null};let a,o,l;const d=u.test(t.replace(c,""));null!=t&&"string"==typeof t&&d||Object(r.a)("Sanitize failure, invalid URI: "+Object(r.h)(t));const f=s.test(t);return(l=e.baseURL)&&!f&&(t.startsWith("/")||"/"===l[l.length-1]||(t="/"+t),t=l+t),o=(a=t.startsWith("file://"))||"file"===e.mode||"http"!==e.mode&&!f&&n,a?t=t.slice("file://".length):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),o=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(i,"localFile",{value:!!o}),i.href=t,e.target&&(i.target=e.target+""),e.rel&&(i.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(i.crossOrigin=e.crossOrigin+""),i}function f(t){return t?e=>new Promise((n,r)=>{t.readFile(e,(t,e)=>{t?r(t):n(e)})}):h}async function h(){Object(r.a)("No file system access.")}function p(t){return t?async function(e,n){const i=Object(r.b)({},this.options.http,n),a=n&&n.response,o=await t(e,i);return o.ok?Object(r.f)(o[a])?o[a]():o.text():Object(r.a)(o.status+""+o.statusText)}:m}async function m(){Object(r.a)("No HTTP fetch method available.")}const g=t=>!(Number.isNaN(+t)||t instanceof Date),b={boolean:r.i,integer:r.k,number:r.k,date:r.j,string:r.l,unknown:r.e},y=[t=>"true"===t||"false"===t||!0===t||!1===t,t=>g(t)&&Number.isInteger(+t),g,t=>!Number.isNaN(Date.parse(t))],v=["boolean","integer","number","date"];function x(t,e){if(!t||!t.length)return"unknown";const n=t.length,r=y.length,i=y.map((t,e)=>e+1);for(let o,s,u=0,c=0;u<n;++u)for(s=e?t[u][e]:t[u],o=0;o<r;++o)if(i[o]&&(null!=(a=s)&&a==a)&&!y[o](s)&&(i[o]=0,++c,c===y.length))return"string";var a;return v[i.reduce((t,e)=>0===t?e:t,0)-1]}function w(t,e){return e.reduce((e,n)=>(e[n]=x(t,n),e),{})}function k(t){const e=function(e,n){const i={delimiter:t};return O(e,n?Object(r.b)(n,i):i)};return e.responseType="text",e}function O(t,e){return e.header&&(t=e.header.map(r.h).join(e.delimiter)+"\n"+t),Object(i.a)(e.delimiter).parse(t+"")}function _(e,n){const i=n&&n.property?Object(r.c)(n.property):r.e;return!Object(r.g)(e)||(a=e,"function"==typeof t&&Object(r.f)(t.isBuffer)&&t.isBuffer(a))?i(JSON.parse(e)):function(t,e){return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(i(e),n);var a}O.responseType="text",_.responseType="json";const A={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function C(t,e){let n,i,o,s;return t=_(t,e),e&&e.feature?(n=a.a,o=e.feature):e&&e.mesh?(n=a.b,o=e.mesh,s=A[e.filter]):Object(r.a)("Missing TopoJSON feature or mesh parameter."),i=(i=t.objects[o])?n(t,i,s):Object(r.a)("Invalid TopoJSON object: "+o),i&&i.features||[i]}C.responseType="json";const E={dsv:O,csv:k(","),tsv:k("\t"),json:_,topojson:C};function S(t,e){return arguments.length>1?(E[t]=e,this):Object(r.d)(E,t)?E[t]:null}function j(t){const e=S(t);return e&&e.responseType||"text"}function N(t,e,n,i){const a=S((e=e||{}).type||"json");return a||Object(r.a)("Unknown data format type: "+e.type),t=a(t,e),e.parse&&function(t,e,n,r){if(!t.length)return;const i=Object(o.e)();n=n||i.timeParse,r=r||i.utcParse;let a,s,u,c,l,d,f=t.columns||Object.keys(t[0]);"auto"===e&&(e=w(t,f));f=Object.keys(e);const h=f.map(t=>{const i=e[t];let a,o;if(i&&(i.startsWith("date:")||i.startsWith("utc:"))){a=i.split(/:(.+)?/,2),o=a[1],("'"===o[0]&&"'"===o[o.length-1]||'"'===o[0]&&'"'===o[o.length-1])&&(o=o.slice(1,-1));return("utc"===a[0]?r:n)(o)}if(!b[i])throw Error("Illegal format pattern: "+t+":"+i);return b[i]});for(u=0,l=t.length,d=f.length;u<l;++u)for(a=t[u],c=0;c<d;++c)s=f[c],a[s]=h[c](a[s])}(t,e.parse,n,i),Object(r.d)(t,"columns")&&delete t.columns,t}const T=function(t,e){return n=>({options:n||{},sanitize:d,load:l,fileAccess:!!e,file:f(e),http:p(t)})}("undefined"!=typeof fetch&&fetch,null)}).call(this,n(94).Buffer)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({abs_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e=Object(a.a)(t,"x","abs");if("complex64"===e.dtype){const t={x:e};return r.a.runKernel(i.A,t)}{const t={x:e};return r.a.runKernel(i.a,t)}}})},function(t,e,n){"use strict";n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return p})),n.d(e,"a",(function(){return m})),n.d(e,"d",(function(){return g}));var r=n(16),i=n(128),a=n(131),o=n(9),s=n(136),u=n(81),c=n(137),l=n(8),d=n(82),f=n(18);
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function h(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return Object(o.a)(t,Object(d.a)(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function p(t,e){let n=e;const i=r.c(t.shape,e.shape);return i.length>0&&(n=Object(f.a)(n,i)),Object(l.a)(n,t.shape)}function m(t,e,n,r){if("linear"===e)return t;if("relu"===e)return Object(u.a)(t);if("elu"===e)return Object(i.a)(t);if("relu6"===e)return Object(c.a)(t);if("prelu"===e)return Object(s.a)(t,n);if("leakyrelu"===e)return Object(a.a)(t,r);throw new Error(`Unknown fused activation ${e}.`)}const g=(t,e)=>!(t>0)||"linear"===e},function(t,e,n){"use strict";var r,i=n(0),a=n(87),o=n(68);function s(t){return t instanceof i.id?{value:t.clone(),recurse:!1}:Object(o.e)(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class u{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const e of t)this.push(e)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class c extends u{constructor(){super(c.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=2*this.capacity,e=new Array(t),n=this.length();for(let t=0;t<n;t++)e[t]=this.get(this.wrap(this.begin+t));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
function l(t){return new m(t)}function d(t){return new g(t)}function f(t,e){return new E(t,e)}function h(t,e=r.FAIL){return new S(t,e)}c.INITIAL_CAPACITY=32,n.d(e,"f",(function(){return l})),n.d(e,"e",(function(){return d})),n.d(e,"d",(function(){return f})),n.d(e,"g",(function(){return h})),n.d(e,"a",(function(){return p})),n.d(e,"b",(function(){return A})),n.d(e,"c",(function(){return r}));class p{async toArray(){const t=[];let e=await this.next();for(;!e.done;)t.push(e.value),e=await this.next();return t}async toArrayForTest(){const t=this.prefetch(100),e=[];let n=await t.next();for(;!n.done;)e.push(n.value),n=await t.next();return e}async resolveFully(){let t=await this.next();for(;!t.done;)t=await this.next()}async resolveWhile(t){let e=await this.next(),n=t(e.value);for(;!e.done&&n;)e=await this.next(),n=t(e.value)}handleErrors(t){return new O(this,t)}filter(t){return new w(this,t)}map(t){return new k(this,t)}mapAsync(t){return new _(this,t)}serialMapAsync(t){return new _(this,t).serial()}flatmap(t){return new C(this,t)}async forEachAsync(t){return this.map(t).resolveFully()}async serialForEach(t){return this.serialMapAsync(t).resolveWhile(t=>!0===t)}rowMajorBatch(t,e=!0){return new x(this,t,e)}columnMajorBatch(t,e=!0,n=o.f){return this.rowMajorBatch(t,e).map(t=>Object(o.d)(t,n))}concatenate(t,e){return new E(l([this,t]),e)}take(t){return t<0||null==t?this:new v(this,t)}skip(t){return t<0||null==t?this:new y(this,t)}prefetch(t){return new j(this,t)}shuffle(t,e){return new N(this,t,e)}serial(){return new b(this)}}class m extends p{constructor(t){super(),this.items=t,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:(e=t,Object(o.b)(e,s)),done:!1};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
var e}}class g extends p{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(t){throw t.message="Error thrown while iterating through a dataset: "+t.message,t}}}class b extends p{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> Serial"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class y extends p{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> Skip"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const t=await this.upstream.next();if(t.done)return t;i.Ae(t.value)}return this.upstream.next()}}class v extends p{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0}summary(){return this.upstream.summary()+" -> Take"}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class x extends p{constructor(t,e,n=!0){super(),this.upstream=t,this.batchSize=e,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> RowMajorBatch"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const t=[];for(;t.length<this.batchSize;){const e=await this.upstream.next();if(e.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(e.value)}return{value:t,done:!1}}}class w extends p{constructor(t,e){super(),this.upstream=t,this.predicate=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> Filter"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const t=await this.upstream.next();if(t.done||this.predicate(t.value))return t;i.Ae(t.value)}}}class k extends p{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return this.upstream.summary()+" -> Map"}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=i.bi.getTensorsInContainer(t.value),n=this.transform(t.value),r=i.bi.getTensorsInContainer(n);for(const t of e)i.bi.isTensorInList(t,r)||t.dispose();return{value:n,done:!1}}}class O extends p{constructor(t,e){super(),this.upstream=t,this.handler=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> handleErrors"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}}}class _ extends p{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return this.upstream.summary()+" -> AsyncMap"}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=i.bi.getTensorsInContainer(t.value),n=await this.transform(t.value),r=i.bi.getTensorsInContainer(n);for(const t of e)i.bi.isTensorInList(t,r)||t.dispose();return{value:n,done:!1}}}class A extends p{constructor(){super(),this.outputQueue=new c,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class C extends A{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return this.upstream.summary()+" -> Flatmap"}async pump(){const t=await this.upstream.next();if(t.done)return!1;const e=i.bi.getTensorsInContainer(t.value),n=this.transform(t.value),r=i.bi.getTensorsInContainer(n);this.outputQueue.pushAll(n);for(const t of e)i.bi.isTensorInList(t,r)||t.dispose();return!0}}class E extends p{constructor(t,e){super(),this.baseErrorHandler=e,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(t){if(await t,null==this.iterator){const t=await this.moreIterators.next();if(t.done)return{value:null,done:!0};this.iterator=t.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const e=await this.iterator.next();return e.done?(this.iterator=null,this.readFromChain(t)):e}}!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(r||(r={}));class S extends p{constructor(t,e=r.FAIL){super(),this.iterators=t,this.mismatchMode=e,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(t){await t;let e=0,n=0;const i=await Object(o.c)(this.iterators,(function(t){if(t instanceof p){return{value:t.next().then(t=>(e++,t.done&&n++,t.value)),recurse:!1}}return{value:null,recurse:!0}}));if(e===n)return{value:null,done:!0};if(n>0)switch(this.mismatchMode){case r.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case r.SHORTEST:return{value:null,done:!0};case r.LONGEST:}return this.count++,{value:i,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}}class j extends p{constructor(t,e){super(),this.upstream=t,this.bufferSize=e,this.buffer=new u(e)}summary(){return this.upstream.summary()+" -> Prefetch"}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class N extends j{constructor(t,e,n){super(t,e),this.upstream=t,this.windowSize=e,this.upstreamExhausted=!1,this.random=a.alea(n||i.qi.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const t=this.chooseIndex(),e=await this.buffer.shuffleExcise(t);if(!e.done)return this.refill(),e;this.upstreamExhausted=!0}return{value:null,done:!0}}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(16),u=n(4);const c=Object(u.b)({greater_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","greater"),u=Object(o.a)(e,"b","greater");[n,u]=Object(a.makeTypesMatch)(n,u),Object(s.a)(n.shape,u.shape);const c={a:n,b:u};return r.a.runKernel(i.nb,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(6),i=n(7);
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function a(t,e="float32",n){return e=e||"float32",i.c(t),new r.b(t,e,n)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(4);const u=Object(s.b)({pow_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"base","pow"),s=Object(o.a)(e,"exp","pow");[n,s]=Object(a.makeTypesMatch)(n,s);const u={a:n,b:s};return r.a.runKernel(i.fc,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({reverse_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const n={x:Object(a.a)(t,"x","reverse")},o={dims:e};return r.a.runKernel(i.tc,n,o)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(5),i=n(7),a=n(10);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function o(t,e,n,o){if(null==o&&(o=Object(i.r)(t)),"complex64"===o)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Object(i.A)(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){Object(i.c)(e);const t=Object(i.N)(e),r=Object(i.N)(n);Object(i.b)(t===r,()=>`Based on the provided shape, [${e}], the tensor should have ${t} values but has ${r}`);for(let t=0;t<n.length;++t){const r=n[t],a=t!==n.length-1||r!==Object(i.N)(e.slice(t));Object(i.b)(n[t]===e[t]||!a,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return Object(i.A)(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==o?Object(a.toTypedArray)(t,o):Object(i.m)(t,[],!0),r.a.makeTensor(t,e,o)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({transpose_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const n=Object(a.a)(t,"x","transpose");if(null==e&&(e=n.shape.map((t,e)=>e).reverse()),o.b(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of perm ${e}.`),e.forEach(t=>{o.b(t>=0&&t<n.rank,()=>"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e)}),n.rank<=1)return n.clone();const s={x:n},u={perm:e};return r.a.runKernel(i.Vc,s,u)}})},function(t,e,n){const r=n(165),{MAX_LENGTH:i,MAX_SAFE_INTEGER:a}=n(164),{re:o,t:s}=n(119),u=n(166),{compareIdentifiers:c}=n(217);class l{constructor(t,e){if(e=u(e),t instanceof l){if(t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError("Invalid Version: "+t);if(t.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",t,e),this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease;const n=t.trim().match(e.loose?o[s.LOOSE]:o[s.FULL]);if(!n)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>a||this.major<0)throw new TypeError("Invalid major version");if(this.minor>a||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>a||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(t=>{if(/^[0-9]+$/.test(t)){const e=+t;if(e>=0&&e<a)return e}return t}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(t){if(r("SemVer.compare",this.version,this.options,t),!(t instanceof l)){if("string"==typeof t&&t===this.version)return 0;t=new l(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof l||(t=new l(t,this.options)),c(this.major,t.major)||c(this.minor,t.minor)||c(this.patch,t.patch)}comparePre(t){if(t instanceof l||(t=new l(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let e=0;do{const n=this.prerelease[e],i=t.prerelease[e];if(r("prerelease compare",e,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++e)}compareBuild(t){t instanceof l||(t=new l(t,this.options));let e=0;do{const n=this.build[e],i=t.build[e];if(r("prerelease compare",e,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++e)}inc(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e),this.inc("pre",e);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let t=this.prerelease.length;for(;--t>=0;)"number"==typeof this.prerelease[t]&&(this.prerelease[t]++,t=-2);-1===t&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this}}t.exports=l},,function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(16),u=n(4);const c=Object(u.b)({greaterEqual_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","greaterEqual"),u=Object(o.a)(e,"b","greaterEqual");[n,u]=Object(a.makeTypesMatch)(n,u),Object(s.a)(n.shape,u.shape);const c={a:n,b:u};return r.a.runKernel(i.ob,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(16),u=n(4);const c=Object(u.b)({lessEqual_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","lessEqual"),u=Object(o.a)(e,"b","lessEqual");[n,u]=Object(a.makeTypesMatch)(n,u),Object(s.a)(n.shape,u.shape);const c={a:n,b:u};return r.a.runKernel(i.zb,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({pad_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n=0){const o=Object(a.a)(t,"x","pad");if(0===o.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},u={x:o};return r.a.runKernel(i.dc,u,s)}})},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return _})),n.d(e,"i",(function(){return C})),n.d(e,"c",(function(){return E})),n.d(e,"f",(function(){return S})),n.d(e,"e",(function(){return T})),n.d(e,"d",(function(){return F})),n.d(e,"k",(function(){return I})),n.d(e,"g",(function(){return M})),n.d(e,"h",(function(){return $})),n.d(e,"j",(function(){return R})),n.d(e,"b",(function(){return B}));var r=n(0),i=n(88),a=n(108),o=n(2),s=n(296),u=n(297),c=n(298),l=n(299),d=n(300),f=n(301),h=n(302),p=n(303),m=n(304),g=n(305),b=n(306),y=n(307),v=n(308),x=n(309),w=n(310),k=n(311),O=n(312);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class _{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[].concat(...[s,u,c,l,d,f,h,b,g,p,y,v,x,w,k,O,m].map(t=>t.json));this.opMappers=t.reduce((t,e)=>(t[e.tfOpName]=e,t),{})}transformGraph(t,e={}){const n=t.node,r=[],i=[],a=[],s=n.reduce((t,e)=>(t[e.name]=this.mapNode(e),e.op.startsWith("Placeholder")?r.push(t[e.name]):"Const"===e.op?i.push(t[e.name]):null!=e.input&&0!==e.input.length||a.push(t[e.name]),t),{});let u=[];const c=[];let l={},d={};null!=e&&(l=this.mapSignatureEntries(e.inputs),d=this.mapSignatureEntries(e.outputs));const f=Object.keys(s);f.forEach(t=>{const e=s[t];e.inputNames.forEach(t=>{const[n]=Object(o.b)(t);e.inputs.push(s[n]),s[n].children.push(e)})}),0===Object.keys(d).length?f.forEach(t=>{const e=s[t];0===e.children.length&&c.push(e)}):Object.keys(d).forEach(t=>{const[e]=Object(o.b)(t),n=s[e];null!=n&&(n.signatureKey=d[t],c.push(n))}),Object.keys(l).length>0?Object.keys(l).forEach(t=>{const[e]=Object(o.b)(t),n=s[e];n&&(n.signatureKey=l[t],u.push(n))}):u=r;let h={};null!=t.library&&null!=t.library.function&&(h=t.library.function.reduce((t,e)=>(t[e.signature.name]=this.mapFunction(e),t),{}));const p={nodes:s,inputs:u,outputs:c,weights:i,placeholders:r,signature:e,functions:h};return a.length>0&&(p.initNodes=a),p}mapSignatureEntries(t){return Object.keys(t||{}).reduce((e,n)=>(e[t[n].name]=n,e),{})}mapNode(t){const e=Object(a.b)(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});const n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map(t=>t.startsWith("^")?t.substr(1):t),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return null!=e.inputs&&(n.inputParams=e.inputs.reduce((t,e)=>(t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce((e,n)=>{const r=n.type;let i=void 0;switch(n.type){case"string":i=C(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=C(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":i=$(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=$(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":i=S(t.attr,n.tfName,n.defaultValue||0),void 0===i&&n.tfDeprecatedName&&(i=S(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":i=M(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=M(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":i=E(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=E(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":i=B(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=B(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":i=I(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=I(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":i=R(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=R(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":i=T(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=T(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":i=F(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=F(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":i=N(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=N(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${n.type} for op: ${t.op}`)}return e[n.name]={value:i,type:r},e},{})),n}mapFunction(t){const e=t.nodeDef,n=[];let r={};null!=e&&(r=e.reduce((t,e)=>(t[e.name]=this.mapNode(e),"Const"===e.op&&n.push(t[e.name]),t),{}));const i=[],a=[];t.signature.inputArg.forEach(t=>{const[e]=Object(o.b)(t.name),n={name:e,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:j(t.type),type:"dtype"}},children:[]};n.signatureKey=t.name,i.push(n),r[e]=n});Object.keys(r).forEach(t=>{const e=r[t];e.inputNames.forEach(t=>{const[n]=Object(o.b)(t);e.inputs.push(r[n]),r[n].children.push(e)})});const s=t.ret;t.signature.outputArg.forEach(t=>{const[e,n]=Object(o.b)(s[t.name]),i=r[e];null!=i&&(i.defaultOutput=n,a.push(i))});const u=this.mapArgsToSignature(t);return{nodes:r,inputs:i,outputs:a,weights:n,placeholders:[],signature:u}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((t,e)=>(t[e.name]=this.mapArgToTensorInfo(e),t),{}),outputs:t.signature.outputArg.reduce((e,n)=>(e[n.name]=this.mapArgToTensorInfo(n,t.ret),e),{})}}mapArgToTensorInfo(t,e){let n=t.name;return null!=e&&(n=e[n]),{name:n,dtype:t.type}}}function A(e,n){const i=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){const n=Object(r.Me)().global;if(void 0!==n.atob)return n.atob(e);if(void 0!==t)return new t(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return n?i:i.toLowerCase()}function C(t,e,n,r=!1){const i=t[e];return null!=i?A(i.s,r):n}function E(t,e,n){const r=t[e];return r?r.b:n}function S(t,e,n){const r=t[e]||{},i=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof i?i:parseInt(i,10)}function j(t){switch("string"==typeof t&&(t=i.a[t]),t){case i.a.DT_FLOAT:return"float32";case i.a.DT_INT32:case i.a.DT_INT64:case i.a.DT_INT8:case i.a.DT_UINT8:return"int32";case i.a.DT_BOOL:return"bool";case i.a.DT_DOUBLE:return"float32";case i.a.DT_STRING:return"string";default:return null}}function N(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function T(t,e,n){const r=t[e];return r&&r.type?j(r.type):n}function F(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(t=>j(t)):n}function D(t){if(!t.unknownRank)return null!=t.dim?t.dim.map(t=>"number"==typeof t.size?t.size:parseInt(t.size,10)):[]}function I(t,e,n){const r=t[e];return r&&r.shape?D(r.shape):n}function M(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(t=>"number"==typeof t?t:parseInt(t,10)):n}function $(t,e,n,r=!1){const i=t[e];return i&&i.list&&i.list.s?i.list.s.map(t=>A(t,r)):n}function R(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(t=>D(t)):n}function B(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}}).call(this,n(94).Buffer)},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({complex_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const n=Object(a.a)(t,"real","complex"),s=Object(a.a)(e,"imag","complex");o.e(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const u={real:n,imag:s};return r.a.runKernel(i.z,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(16),s=n(4);const u=Object(s.b)({logicalAnd_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const n=Object(a.a)(t,"a","logicalAnd","bool"),s=Object(a.a)(e,"b","logicalAnd","bool");Object(o.a)(n.shape,s.shape);const u={a:n,b:s};return r.a.runKernel(i.Eb,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({stack_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=0){const n=Object(a.b)(t,"tensors","stack","string_or_numeric");o.b(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&o.b(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,u={axis:e};return r.a.runKernel(i.cc,s,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({expandDims_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=0){const n=Object(a.a)(t,"x","expandDims","string_or_numeric");o.b(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},u={dim:e};return r.a.runKernel(i.ab,s,u)}})},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,n){"use strict";var r=n(456),i=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function a(t){if(!(e=i.exec(t)))throw new Error("invalid format: "+t);var e;return new o({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function o(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}a.prototype=o.prototype,o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};function s(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}var u,c,l,d,f=function(t){return(t=s(Math.abs(t)))?t[1]:NaN},h=function(t,e){var n=s(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},p={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>h(100*t,e),r:h,s:function(t,e){var n=s(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(u=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+s(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)},m=function(t){return t},g=Array.prototype.map,b=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],y=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?m:(e=g.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(t.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",c=void 0===t.numerals?m:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(g.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",d=void 0===t.minus?"":t.minus+"",h=void 0===t.nan?"NaN":t.nan+"";function y(t){var e=(t=a(t)).fill,n=t.align,f=t.sign,m=t.symbol,g=t.zero,y=t.width,v=t.comma,x=t.precision,w=t.trim,k=t.type;"n"===k?(v=!0,k="g"):p[k]||(void 0===x&&(x=12),w=!0,k="g"),(g||"0"===e&&"="===n)&&(g=!0,e="0",n="=");var O="$"===m?i:"#"===m&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",_="$"===m?o:/[%p]/.test(k)?l:"",A=p[k],C=/[defgprs%]/.test(k);function E(t){var i,a,o,l=O,p=_;if("c"===k)p=A(t)+p,t="";else{var m=(t=+t)<0||1/t<0;if(t=isNaN(t)?h:A(Math.abs(t),x),w&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),m&&0==+t&&"+"!==f&&(m=!1),l=(m?"("===f?f:d:"-"===f||"("===f?"":f)+l,p=("s"===k?b[8+u/3]:"")+p+(m&&"("===f?")":""),C)for(i=-1,a=t.length;++i<a;)if(48>(o=t.charCodeAt(i))||o>57){p=(46===o?s+t.slice(i+1):t.slice(i))+p,t=t.slice(0,i);break}}v&&!g&&(t=r(t,1/0));var E=l.length+t.length+p.length,S=E<y?new Array(y-E+1).join(e):"";switch(v&&g&&(t=r(S+t,S.length?y-p.length:1/0),S=""),n){case"<":t=l+t+p+S;break;case"=":t=l+S+t+p;break;case"^":t=S.slice(0,E=S.length>>1)+l+t+p+S.slice(E);break;default:t=S+l+t+p}return c(t)}return x=void 0===x?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x)),E.toString=function(){return t+""},E}return{format:y,formatPrefix:function(t,e){var n=y(((t=a(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(f(e)/3))),i=Math.pow(10,-r),o=b[8+r/3];return function(t){return n(i*t)+o}}}};c=y({thousands:",",grouping:[3],currency:["$",""]}),l=c.format,d=c.formatPrefix;var v=n(20);function x(t,e,n){return t.fields=e||[],t.fname=n,t}function w(t){return 1===t.length?k(t[0]):O(t)}const k=t=>function(e){return e[t]},O=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function _(t){throw Error(t)}function A(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||_("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&_("Access path missing closing bracket: "+t),o&&_("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function C(t,e,n){const r=A(t);return t=1===r.length?r[0]:t,x((n&&n.get||w)(r),[t],e||t)}C("id"),x(t=>t,[],"identity"),x(()=>0,[],"zero"),x(()=>1,[],"one"),x(()=>!0,[],"true"),x(()=>!1,[],"false");Array.isArray;function E(t){return t===Object(t)}function S(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}Object.prototype.hasOwnProperty;function j(t){return"string"==typeof t}var N=n(457),T=n(315);function F(t){const e={};return n=>e[n]||(e[n]=t(n))}function D(t){const e=F(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=a(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return r=e(n),i=e(".1f")(1)[1],t=>{const e=r(t),n=e.indexOf(i);if(n<0)return e;let a=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(e,n);const o=a<e.length?e.slice(a):"";for(;--a>n;)if("0"!==e[a]){++a;break}return e.slice(0,a)+o}}return e(n);var r,i},formatSpan(t,i,o,s){s=a(null==s?",f":s);const u=Object(r.c)(t,i,o),c=Math.max(Math.abs(t),Math.abs(i));let l;if(null==s.precision)switch(s.type){case"s":return isNaN(l=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(f(e)/3)))-f(Math.abs(t)))}(u,c))||(s.precision=l),n(s,c);case"":case"e":case"g":case"p":case"r":isNaN(l=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,f(e)-f(t))+1}(u,c))||(s.precision=l-("e"===s.type));break;case"f":case"%":isNaN(l=function(t){return Math.max(0,-f(Math.abs(t)))}(u))||(s.precision=l-2*("%"===s.type))}return e(s)}}}let I,M;function $(){return I=D({format:l,formatPrefix:d})}function R(t){return D(y(t))}function B(t){return arguments.length?I=R(t):I}function z(t,e,n){E(n=n||{})||_("Invalid time multi-format specifier: ".concat(n));const r=e(v.i),i=e(v.f),a=e(v.d),o=e(v.a),s=e(v.k),u=e(v.g),c=e(v.h),l=e(v.l),d=t(n[v.e]||".%L"),f=t(n[v.i]||":%S"),h=t(n[v.f]||"%I:%M"),p=t(n[v.d]||"%I %p"),m=t(n[v.a]||n[v.b]||"%a %d"),g=t(n[v.k]||"%b %d"),b=t(n[v.g]||"%B"),y=t(n[v.h]||"%B"),x=t(n[v.l]||"%Y");return t=>(r(t)<t?d:i(t)<t?f:a(t)<t?h:o(t)<t?p:u(t)<t?s(t)<t?m:g:l(t)<t?c(t)<t?b:y:x)(t)}function L(t){const e=F(t.format),n=F(t.utcFormat);return{timeFormat:t=>j(t)?e(t):z(e,v.p,t),utcFormat:t=>j(t)?n(t):z(n,v.v,t),timeParse:F(t.parse),utcParse:F(t.utcParse)}}function P(){return M=L({format:N.a,parse:N.b,utcFormat:N.c,utcParse:N.d})}function q(t){return L(Object(T.a)(t))}function W(t){return arguments.length?M=q(t):M}n.d(e,"a",(function(){return G})),n.d(e,"b",(function(){return V})),n.d(e,"c",(function(){return B})),n.d(e,"d",(function(){return H})),n.d(e,"e",(function(){return W})),$(),P();const U=(t,e)=>S({},t,e);function V(t,e){const n=t?R(t):B(),r=e?q(e):W();return U(n,r)}function G(t,e){const n=arguments.length;return n&&2!==n&&_("defaultLocale expects either zero or two arguments."),n?U(B(t),W(e)):U(B(),W())}function H(){return $(),P(),G()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(27),u=n(4),c=n(8);const l=Object(u.b)({conv2d_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,u,l="NHWC",d=[1,1],f){const h=Object(a.a)(t,"x","conv2d"),p=Object(a.a)(e,"filter","conv2d");let m=h,g=!1;3===h.rank&&(g=!0,m=Object(c.a)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),o.b(4===m.rank,()=>`Error in conv2d: input must be rank 4, but got rank ${m.rank}.`),o.b(4===p.rank,()=>"Error in conv2d: filter must be rank 4, but got rank "+p.rank+"."),null!=f&&o.b(o.v(u),()=>`Error in conv2d: pad must be an integer when using, dimRoundingMode ${f} but got pad ${u}.`);const b="NHWC"===l?m.shape[3]:m.shape[1];o.b(b===p.shape[2],()=>`Error in conv2d: depth of input (${b}) must match input depth for filter ${p.shape[2]}.`),o.b(s.h(n,d),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${d}'`);const y={x:m,filter:p},v={strides:n,pad:u,dataFormat:l,dilations:d,dimRoundingMode:f},x=r.a.runKernel(i.C,y,v);return g?Object(c.a)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(5),i=n(7),a=n(57);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function o(t,e="float32"){if("complex64"===e){const e=o(t,"float32"),n=o(t,"float32");return Object(a.a)(e,n)}const n=Object(i.F)(Object(i.N)(t),e);return r.a.makeTensor(n,t,e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({clone_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","clone","string_or_numeric")};return r.a.runKernel(i.qb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({max_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=null,n=!1){const o={x:Object(a.a)(t,"x","max")},s={reductionIndices:e,keepDims:n};return r.a.runKernel(i.Hb,o,s)}})},function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return u})),n.d(e,"d",(function(){return c})),n.d(e,"f",(function(){return l})),n.d(e,"e",(function(){return d})),n.d(e,"h",(function(){return f})),n.d(e,"g",(function(){return h})),n.d(e,"a",(function(){return p}));var r=n(23),i=n(156);
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const a=Object(i.a)("kernelRegistry",()=>new Map),o=Object(i.a)("gradRegistry",()=>new Map);function s(t,e){const n=m(t,e);return a.get(n)}function u(t){return o.get(t)}function c(t){const e=a.entries(),n=[];for(;;){const{done:r,value:i}=e.next();if(r)break;const[a,o]=i,[s]=a.split("_");s===t&&n.push(o)}return n}function l(t){const{kernelName:e,backendName:n}=t,r=m(e,n);a.has(r)&&console.warn(`The kernel '${e}' for backend '${n}' is already registered`),a.set(r,t)}function d(t){const{kernelName:e}=t;o.has(e)&&Object(r.c)().getBool("DEBUG")&&console.warn(`Overriding the gradient for '${e}'`),o.set(e,t)}function f(t,e){const n=m(t,e);if(!a.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);a.delete(n)}function h(t){if(!o.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);o.delete(t)}function p(t,e){c(t).forEach(t=>{l(Object.assign({},t,{backendName:e}))})}function m(t,e){return`${e}_${t}`}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"f",(function(){return s})),n.d(e,"c",(function(){return u})),n.d(e,"e",(function(){return c})),n.d(e,"a",(function(){return l}));var r=n(0);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function i(t,e){return a(t,e)}function a(t,e,n=new Map,r=new Set){if(null==t)return null;if(r.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);const i=e(t);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(c(t)){const i=Array.isArray(t)?[]:{};r.add(t);for(const o in t){const s=a(t[o],e,n,r);i[o]=s}return r.delete(t),i}throw new Error("Can't recurse into non-iterable type: "+t)}return n.set(t,i.value),i.value}function o(t,e=s){return function t(e,n,r=new Set){const i=e[0];if(r.has(i))throw new Error("Circular references are not supported.");const a=n(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(c(i)){const a=Array.isArray(i)?[]:{};r.add(i);for(const o in i){const i=e.map(t=>t[o]),s=t(i,n,r);a[o]=s}return r.delete(i),a}throw new Error("Can't recurse into non-iterable type: "+i)}return a.value}(t,e)}function s(t){return null===t?null:c(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}async function u(t,e){const n=new Map;a(t,e,n);for(const t of Array.from(n.keys())){const e=n.get(t);if(r.qi.isPromise(e)){const r=await e;n.set(t,r)}}return a(t,e,n)}function c(t){return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"==typeof t&&!(t instanceof r.id))}function l(t){return null==t||(null===(e=t)||"object"!=typeof e&&"function"!=typeof e)||Array.isArray(t)||"object"==typeof t&&t instanceof r.id||r.qi.isTypedArray(t);var e}},function(t,e,n){const r=n(51);t.exports=(t,e,n)=>new r(t,n).compare(new r(e,n))},function(t,e,n){class r{constructor(t,e){if(e=a(e),t instanceof r)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new r(t.raw,e);if(t instanceof o)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(t=>this.parseRange(t.trim())).filter(t=>t.length),!this.set.length)throw new TypeError("Invalid SemVer Range: "+t);if(this.set.length>1){const t=this.set[0];if(this.set=this.set.filter(t=>!p(t[0])),0===this.set.length)this.set=[t];else if(this.set.length>1)for(const t of this.set)if(1===t.length&&m(t[0])){this.set=[t];break}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();const e=`parseRange:${Object.keys(this.options).join(",")}:${t}`,n=i.get(e);if(n)return n;const r=this.options.loose,a=r?c[l.HYPHENRANGELOOSE]:c[l.HYPHENRANGE];t=t.replace(a,E(this.options.includePrerelease)),s("hyphen replace",t),t=t.replace(c[l.COMPARATORTRIM],d),s("comparator trim",t,c[l.COMPARATORTRIM]),t=(t=(t=t.replace(c[l.TILDETRIM],f)).replace(c[l.CARETTRIM],h)).split(/\s+/).join(" ");const u=r?c[l.COMPARATORLOOSE]:c[l.COMPARATOR],m=t.split(" ").map(t=>b(t,this.options)).join(" ").split(/\s+/).map(t=>C(t,this.options)).filter(this.options.loose?t=>!!t.match(u):()=>!0).map(t=>new o(t,this.options)),g=(m.length,new Map);for(const t of m){if(p(t))return[t];g.set(t.value,t)}g.size>1&&g.has("")&&g.delete("");const y=[...g.values()];return i.set(e,y),y}intersects(t,e){if(!(t instanceof r))throw new TypeError("a Range is required");return this.set.some(n=>g(n,e)&&t.set.some(t=>g(t,e)&&n.every(n=>t.every(t=>n.intersects(t,e)))))}test(t){if(!t)return!1;if("string"==typeof t)try{t=new u(t,this.options)}catch(t){return!1}for(let e=0;e<this.set.length;e++)if(S(this.set[e],t,this.options))return!0;return!1}}t.exports=r;const i=new(n(387))({max:1e3}),a=n(166),o=n(168),s=n(165),u=n(51),{re:c,t:l,comparatorTrimReplace:d,tildeTrimReplace:f,caretTrimReplace:h}=n(119),p=t=>"<0.0.0-0"===t.value,m=t=>""===t.value,g=(t,e)=>{let n=!0;const r=t.slice();let i=r.pop();for(;n&&r.length;)n=r.every(t=>i.intersects(t,e)),i=r.pop();return n},b=(t,e)=>(s("comp",t,e),t=w(t,e),s("caret",t),t=v(t,e),s("tildes",t),t=O(t,e),s("xrange",t),t=A(t,e),s("stars",t),t),y=t=>!t||"x"===t.toLowerCase()||"*"===t,v=(t,e)=>t.trim().split(/\s+/).map(t=>x(t,e)).join(" "),x=(t,e)=>{const n=e.loose?c[l.TILDELOOSE]:c[l.TILDE];return t.replace(n,(e,n,r,i,a)=>{let o;return s("tilde",t,e,n,r,i,a),y(n)?o="":y(r)?o=`>=${n}.0.0 <${+n+1}.0.0-0`:y(i)?o=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:a?(s("replaceTilde pr",a),o=`>=${n}.${r}.${i}-${a} <${n}.${+r+1}.0-0`):o=`>=${n}.${r}.${i} <${n}.${+r+1}.0-0`,s("tilde return",o),o})},w=(t,e)=>t.trim().split(/\s+/).map(t=>k(t,e)).join(" "),k=(t,e)=>{s("caret",t,e);const n=e.loose?c[l.CARETLOOSE]:c[l.CARET],r=e.includePrerelease?"-0":"";return t.replace(n,(e,n,i,a,o)=>{let u;return s("caret",t,e,n,i,a,o),y(n)?u="":y(i)?u=`>=${n}.0.0${r} <${+n+1}.0.0-0`:y(a)?u="0"===n?`>=${n}.${i}.0${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.0${r} <${+n+1}.0.0-0`:o?(s("replaceCaret pr",o),u="0"===n?"0"===i?`>=${n}.${i}.${a}-${o} <${n}.${i}.${+a+1}-0`:`>=${n}.${i}.${a}-${o} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${a}-${o} <${+n+1}.0.0-0`):(s("no pr"),u="0"===n?"0"===i?`>=${n}.${i}.${a}${r} <${n}.${i}.${+a+1}-0`:`>=${n}.${i}.${a}${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${a} <${+n+1}.0.0-0`),s("caret return",u),u})},O=(t,e)=>(s("replaceXRanges",t,e),t.split(/\s+/).map(t=>_(t,e)).join(" ")),_=(t,e)=>{t=t.trim();const n=e.loose?c[l.XRANGELOOSE]:c[l.XRANGE];return t.replace(n,(n,r,i,a,o,u)=>{s("xRange",t,n,r,i,a,o,u);const c=y(i),l=c||y(a),d=l||y(o),f=d;return"="===r&&f&&(r=""),u=e.includePrerelease?"-0":"",c?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&f?(l&&(a=0),o=0,">"===r?(r=">=",l?(i=+i+1,a=0,o=0):(a=+a+1,o=0)):"<="===r&&(r="<",l?i=+i+1:a=+a+1),"<"===r&&(u="-0"),n=`${r+i}.${a}.${o}${u}`):l?n=`>=${i}.0.0${u} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${a}.0${u} <${i}.${+a+1}.0-0`),s("xRange return",n),n})},A=(t,e)=>(s("replaceStars",t,e),t.trim().replace(c[l.STAR],"")),C=(t,e)=>(s("replaceGTE0",t,e),t.trim().replace(c[e.includePrerelease?l.GTE0PRE:l.GTE0],"")),E=t=>(e,n,r,i,a,o,s,u,c,l,d,f,h)=>`${n=y(r)?"":y(i)?`>=${r}.0.0${t?"-0":""}`:y(a)?`>=${r}.${i}.0${t?"-0":""}`:o?">="+n:`>=${n}${t?"-0":""}`} ${u=y(c)?"":y(l)?`<${+c+1}.0.0-0`:y(d)?`<${c}.${+l+1}.0-0`:f?`<=${c}.${l}.${d}-${f}`:t?`<${c}.${l}.${+d+1}-0`:"<="+u}`.trim(),S=(t,e,n)=>{for(let n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!n.includePrerelease){for(let n=0;n<t.length;n++)if(s(t[n].semver),t[n].semver!==o.ANY&&t[n].semver.prerelease.length>0){const r=t[n].semver;if(r.major===e.major&&r.minor===e.minor&&r.patch===e.patch)return!0}return!1}return!0}},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(291),a=n(292);e.getDrawArea=function(t){if(t instanceof HTMLElement)return t;if(i.isSurface(t))return t.drawArea;if(i.isSurfaceInfo(t)){return a.visor().surface({name:t.name,tab:t.tab,styles:t.styles}).drawArea}throw new Error("Not a drawable")},e.shallowEquals=function(t,e){const n=Object.getOwnPropertyNames(t),r=Object.getOwnPropertyNames(e);if(n.length!==r.length)return!1;for(let r=0;r<n.length;r++){const i=n[r];if(t[i]!==e[i])return!1}return!0},e.nextFrame=function(){return r(this,void 0,void 0,(function*(){yield new Promise(t=>requestAnimationFrame(t))}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({log_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","log")};return r.a.runKernel(i.Bb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({split_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n=0){const o={x:Object(a.a)(t,"x","split")},s={numOrSizeSplits:e,axis:n};return r.a.runKernel(i.Jc,o,s)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1),i=n(7),a=n(49);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function o(t,e){Object(i.d)(t);const n=Object(r.c)(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Object(a.a)(t,null,n,e)}},function(t,e,n){"use strict";n.r(e);var r=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},i=function(t){return(t=r(Math.abs(t)))?t[1]:NaN},a=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function o(t){return new s(t)}function s(t){if(!(e=a.exec(t)))throw new Error("invalid format: "+t);var e;this.fill=e[1]||" ",this.align=e[2]||">",this.sign=e[3]||"-",this.symbol=e[4]||"",this.zero=!!e[5],this.width=e[6]&&+e[6],this.comma=!!e[7],this.precision=e[8]&&+e[8].slice(1),this.trim=!!e[9],this.type=e[10]||""}o.prototype=s.prototype,s.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var u,c,l,d,f=function(t,e){var n=r(t,e);if(!n)return t+"";var i=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+i:i.length>a+1?i.slice(0,a+1)+"."+i.slice(a+1):i+new Array(a-i.length+2).join("0")},h={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return f(100*t,e)},r:f,s:function(t,e){var n=r(t,e);if(!n)return t+"";var i=n[0],a=n[1],o=a-(u=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,s=i.length;return o===s?i:o>s?i+new Array(o-s+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+r(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},p=function(t){return t},m=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],g=function(t){var e,n,r=t.grouping&&t.thousands?(e=t.grouping,n=t.thousands,function(t,r){for(var i=t.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(t.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}):p,a=t.currency,s=t.decimal,c=t.numerals?function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(t.numerals):p,l=t.percent||"%";function d(t){var e=(t=o(t)).fill,n=t.align,i=t.sign,d=t.symbol,f=t.zero,p=t.width,g=t.comma,b=t.precision,y=t.trim,v=t.type;"n"===v?(g=!0,v="g"):h[v]||(null==b&&(b=12),y=!0,v="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var x="$"===d?a[0]:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===d?a[1]:/[%p]/.test(v)?l:"",k=h[v],O=/[defgprs%]/.test(v);function _(t){var a,o,l,d=x,h=w;if("c"===v)h=k(t)+h,t="";else{var _=(t=+t)<0;if(t=k(Math.abs(t),b),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(i>0){if(!+t[r])break t;i=0}}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),_&&0==+t&&(_=!1),d=(_?"("===i?i:"-":"-"===i||"("===i?"":i)+d,h=("s"===v?m[8+u/3]:"")+h+(_&&"("===i?")":""),O)for(a=-1,o=t.length;++a<o;)if(48>(l=t.charCodeAt(a))||l>57){h=(46===l?s+t.slice(a+1):t.slice(a))+h,t=t.slice(0,a);break}}g&&!f&&(t=r(t,1/0));var A=d.length+t.length+h.length,C=A<p?new Array(p-A+1).join(e):"";switch(g&&f&&(t=r(C+t,C.length?p-h.length:1/0),C=""),n){case"<":t=d+t+h+C;break;case"=":t=d+C+t+h;break;case"^":t=C.slice(0,A=C.length>>1)+d+t+h+C.slice(A);break;default:t=C+d+t+h}return c(t)}return b=null==b?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b)),_.toString=function(){return t+""},_}return{format:d,formatPrefix:function(t,e){var n=d(((t=o(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(i(e)/3))),a=Math.pow(10,-r),s=m[8+r/3];return function(t){return n(a*t)+s}}}};function b(t){return c=g(t),l=c.format,d=c.formatPrefix,c}b({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var y=function(t){return Math.max(0,-i(Math.abs(t)))},v=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(i(e)/3)))-i(Math.abs(t)))},x=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,i(e)-i(t))+1};n.d(e,"formatDefaultLocale",(function(){return b})),n.d(e,"format",(function(){return l})),n.d(e,"formatPrefix",(function(){return d})),n.d(e,"formatLocale",(function(){return g})),n.d(e,"formatSpecifier",(function(){return o})),n.d(e,"precisionFixed",(function(){return y})),n.d(e,"precisionPrefix",(function(){return v})),n.d(e,"precisionRound",(function(){return x}))},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r(t,e,n){const r=function(t,e,n){return function(t,e,n){let r=0,i=t.length,a=0,o=!1;for(;r<i;){a=r+(i-r>>>1);const s=n(e,t[a]);s>0?r=a+1:(i=a,o=!s)}return o?r:-r-1}(t,e,n||i)}(t,e,n),a=r<0?-(r+1):r;t.splice(a,0,e)}function i(t,e){return t>e?1:t<e?-1:0}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function a(t,e,n,r,i){return u(t,e,n,r,i,0)}function o(t,e,n,r,i,a){return u(t,e,n,r,i,0,!1,a,!0)}function s(t,e,n,r,i,a){return u(t,e,n,r,i,a,!0)}function u(t,e,n,i,a,o,s=!1,u=!1,f=!1){const h=[];for(let t=0;t<e.length;t++)e[t]>a&&h.push({score:e[t],boxIndex:t,suppressBeginIndex:0});h.sort(d);const p=o>0?-.5/o:0,m=[],g=[];for(;m.length<n&&h.length>0;){const e=h.pop(),{score:n,boxIndex:o,suppressBeginIndex:s}=e;if(n<a)break;let u=!1;for(let n=m.length-1;n>=s;--n){const r=c(t,o,m[n]);if(r>=i){u=!0;break}if(e.score=e.score*l(i,p,r),e.score<=a)break}e.suppressBeginIndex=m.length,u||(e.score===n?(m.push(o),g.push(e.score)):e.score>a&&r(h,e,d))}const b=m.length,y=n-b;u&&y>0&&(m.push(...new Array(y).fill(0)),g.push(...new Array(y).fill(0)));const v={selectedIndices:m};return s&&(v.selectedScores=g),f&&(v.validOutputs=b),v}function c(t,e,n){const r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),l=Math.min(i[1],i[3]),d=Math.max(i[0],i[2]),f=Math.max(i[1],i[3]),h=(s-a)*(u-o),p=(d-c)*(f-l);if(h<=0||p<=0)return 0;const m=Math.max(a,c),g=Math.max(o,l),b=Math.min(s,d),y=Math.min(u,f),v=Math.max(b-m,0)*Math.max(y-g,0);return v/(h+p-v)}function l(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function d(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return s}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(16),u=n(11),c=n(4);const l=Object(c.b)({maximum_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","maximum"),c=Object(o.a)(e,"b","maximum");[n,c]=Object(a.makeTypesMatch)(n,c),"bool"===n.dtype&&(n=Object(u.a)(n,"int32"),c=Object(u.a)(c,"int32")),Object(s.a)(n.shape,c.shape);const l={a:n,b:c};return r.a.runKernel(i.Nb,l)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4),u=n(8);const c=Object(s.b)({depthwiseConv2d_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,s,c="NHWC",l=[1,1],d){const f=Object(a.a)(t,"x","depthwiseConv2d"),h=Object(a.a)(e,"filter","depthwiseConv2d");let p=f,m=!1;3===f.rank&&(m=!0,p=Object(u.a)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.b(4===p.rank,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${p.rank}.`),o.b(4===h.rank,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+h.rank+"."),o.b(p.shape[3]===h.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${p.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),null!=d&&o.b(o.v(s),()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${d} but got pad ${s}.`);const g={x:p,filter:h},b={strides:n,pad:s,dataFormat:c,dilations:l,dimRoundingMode:d},y=r.a.runKernel(i.O,g,b);return m?Object(u.a)(y,[y.shape[1],y.shape[2],y.shape[3]]):y}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(16),u=n(4);const c=Object(u.b)({equal_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","equal"),u=Object(o.a)(e,"b","equal");[n,u]=Object(a.makeTypesMatch)(n,u),Object(s.a)(n.shape,u.shape);const c={a:n,b:u};return r.a.runKernel(i.X,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(7),a=n(57),o=n(64);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e="float32"){if("complex64"===e){const e=s(t,"float32"),n=Object(o.a)(t,"float32");return Object(a.a)(e,n)}const n=Object(i.D)(Object(i.N)(t),e);return r.a.makeTensor(n,t,e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({relu_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","relu")};return r.a.runKernel(i.mc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({step_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=0){const n={x:Object(a.a)(t,"x","step")},o={alpha:e};return r.a.runKernel(i.Nc,n,o)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({unstack_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=0){const n=Object(a.a)(t,"x","unstack","string_or_numeric");o.b(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},u={axis:e};return r.a.runKernel(i.Xc,s,u)}})},function(t,e,n){"use strict";var r=n(5),i=n(3),a=n(1),o=n(7),s=n(8);var u=n(4);n.d(e,"a",(function(){return c}));const c=Object(u.b)({batchNorm_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,u,c,l){null==l&&(l=.001);const d=Object(a.a)(t,"x","batchNorm"),f=Object(a.a)(e,"mean","batchNorm"),h=Object(a.a)(n,"variance","batchNorm");let p,m;null!=c&&(p=Object(a.a)(c,"scale","batchNorm")),null!=u&&(m=Object(a.a)(u,"offset","batchNorm")),o.b(f.rank===h.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),o.b(null==m||f.rank===m.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),o.b(null==p||f.rank===p.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const g={x:function(t){let e;return e=0===t.rank||1===t.rank?Object(s.a)(t,[1,1,1,t.size]):2===t.rank?Object(s.a)(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?Object(s.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t,e}(d),scale:p,offset:m,mean:f,variance:h},b={varianceEpsilon:l},y=r.a.runKernel(i.ib,g,b);return Object(s.a)(y,d.shape)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({sigmoid_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","sigmoid")};return r.a.runKernel(i.Ac,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({tile_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const n=Object(a.a)(t,"x","tile","string_or_numeric");o.b(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},u={reps:e};return r.a.runKernel(i.Tc,s,u)}})},function(t,e,n){var r=n(360),i=n(361),a=n(362),o=n(363),s=n(364),u=n(365),c=n(366);c.alea=r,c.xor128=i,c.xorwow=a,c.xorshift7=o,c.xor4096=s,c.tychei=u,t.exports=c},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
var r,i;n.d(e,"a",(function(){return r})),function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(r||(r={})),function(t){let e;!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(e=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({mean_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=null,n=!1){const o={x:Object(a.a)(t,"x","mean")},s={axis:e,keepDims:n};return r.a.runKernel(i.Ob,o,s)}})},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return l}));var r=n(30),i=n(32);function a(t){return Object(r.a)((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*i.c)/i.e}))}var o=a(0),s=a(1),u=a(2),c=a(3),l=a(4),d=a(5),f=a(6);o.range,s.range,u.range,c.range,l.range,d.range,f.range},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return l}));var r=n(30),i=n(32);function a(t){return Object(r.a)((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/i.e}))}var o=a(0),s=a(1),u=a(2),c=a(3),l=a(4),d=a(5),f=a(6);o.range,s.range,u.range,c.range,l.range,d.range,f.range},,function(t,e){var n,r,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(t){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var u,c=[],l=!1,d=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):d=-1,c.length&&h())}function h(){if(!l){var t=s(f);l=!0;for(var e=c.length;e;){for(u=c,c=[];++d<e;)u&&u[d].run();d=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||l||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(336),i=n(337),a=n(338);function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return d(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=f(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),i=(t=s(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|h(e.length);return 0===(t=s(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):f(t,e);if("Buffer"===e.type&&a(e.data))return f(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function d(t,e){if(l(e),t=s(t,e<0?0:0|h(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|h(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function h(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return L(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return P(t).length;default:if(r)return L(t).length;e=(""+e).toLowerCase(),r=!0}}function m(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return j(this,e,n);case"utf8":case"utf-8":return C(this,e,n);case"ascii":return E(this,e,n);case"latin1":case"binary":return S(this,e,n);case"base64":return A(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function b(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:y(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):y(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(t,e,n,r,i){var a,o=1,s=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,s/=2,u/=2,n/=2}function c(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var l=-1;for(a=n;a<s;a++)if(c(t,a)===c(e,-1===l?0:a-l)){if(-1===l&&(l=a),a-l+1===u)return l*o}else-1!==l&&(a-=a-l),l=-1}else for(n+u>s&&(n=s-u),a=n;a>=0;a--){for(var d=!0,f=0;f<u;f++)if(c(t,a+f)!==c(e,f)){d=!1;break}if(d)return a}return-1}function v(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=e.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(e.substr(2*o,2),16);if(isNaN(s))return o;t[n+o]=s}return o}function x(t,e,n,r){return q(L(e,t.length-n),t,n,r)}function w(t,e,n,r){return q(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function k(t,e,n,r){return w(t,e,n,r)}function O(t,e,n,r){return q(P(e),t,n,r)}function _(t,e,n,r){return q(function(t,e){for(var n,r,i,a=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),r=n>>8,i=n%256,a.push(i),a.push(r);return a}(e,t.length-n),t,n,r)}function A(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function C(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var a,o,s,u,c=t[i],l=null,d=c>239?4:c>223?3:c>191?2:1;if(i+d<=n)switch(d){case 1:c<128&&(l=c);break;case 2:128==(192&(a=t[i+1]))&&(u=(31&c)<<6|63&a)>127&&(l=u);break;case 3:a=t[i+1],o=t[i+2],128==(192&a)&&128==(192&o)&&(u=(15&c)<<12|(63&a)<<6|63&o)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:a=t[i+1],o=t[i+2],s=t[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(u=(15&c)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,d=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=d}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return l(e),e<=0?s(t,e):void 0!==n?"string"==typeof r?s(t,e).fill(n,r):s(t,e).fill(n):s(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return d(null,t)},u.allocUnsafeSlow=function(t){return d(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,a=Math.min(n,r);i<a;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!a(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?C(this,0,t):m.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(e>>>=0),s=Math.min(a,o),c=this.slice(r,i),l=t.slice(e,n),d=0;d<s;++d)if(c[d]!==l[d]){a=c[d],o=l[d];break}return a<o?-1:o<a?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return b(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return b(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return v(this,t,e,n);case"utf8":case"utf-8":return x(this,t,e,n);case"ascii":return w(this,t,e,n);case"latin1":case"binary":return k(this,t,e,n);case"base64":return O(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,e,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function E(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function S(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function j(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=e;a<n;++a)i+=z(t[a]);return i}function N(t,e,n){for(var r=t.slice(e,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function T(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function F(t,e,n,r,i,a){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<a)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function D(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,a=Math.min(t.length-n,2);i<a;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function I(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,a=Math.min(t.length-n,4);i<a;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function M(t,e,n,r,i,a){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function $(t,e,n,r,a){return a||M(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function R(t,e,n,r,a){return a||M(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||T(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||T(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||T(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||T(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||T(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=e,i=1,a=this[t+--r];r>0&&(i*=256);)a+=this[t+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*e)),a},u.prototype.readInt8=function(t,e){return e||T(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||T(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||T(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||T(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||T(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||T(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||T(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||T(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||T(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||F(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[e]=255&t;++a<n&&(i*=256);)this[e+a]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||F(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):I(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);F(this,t,e,n,i-1,-i)}var a=0,o=1,s=0;for(this[e]=255&t;++a<n&&(o*=256);)t<0&&0===s&&0!==this[e+a-1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);F(this,t,e,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[e+a]=255&t;--a>=0&&(o*=256);)t<0&&0===s&&0!==this[e+a+1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):I(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return $(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return $(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return R(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return R(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,a=r-n;if(this===t&&n<e&&e<r)for(i=a-1;i>=0;--i)t[i+e]=this[i+n];else if(a<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+a),e);return a},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var a;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(a=e;a<n;++a)this[a]=t;else{var o=u.isBuffer(t)?t:L(new u(t,r).toString()),s=o.length;for(a=0;a<n-e;++a)this[a+e]=o[a%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function z(t){return t<16?"0"+t.toString(16):t.toString(16)}function L(t,e){var n;e=e||1/0;for(var r=t.length,i=null,a=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;a.push(n)}else if(n<2048){if((e-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function P(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function q(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(148))},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});const r=n(151),i=n(71),a={prepend:!1};e.subSurface=function(t,e,n={}){const o=i.getDrawArea(t),s=r.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),u=r.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),c=Object.assign({},a,n);let l=o.querySelector(`div[data-name=${e}]`);if(!l){if(l=document.createElement("div"),l.setAttribute("class",""+s),l.dataset.name=e,c.title){const t=document.createElement("div");t.setAttribute("class","subsurface-title "+u),t.innerText=c.title,l.appendChild(t)}c.prepend?o.insertBefore(l,o.firstChild):o.appendChild(l)}return l},e.getDefaultWidth=function(t){let e=0,n=t;for(;n&&0===n.clientWidth;)n=n.parentElement,e=50;return n.clientWidth-e},e.getDefaultHeight=function(t){return 0===t.clientHeight?200:t.clientHeight}},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var r,i,a,o,s;n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return l})),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(r||(r={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(i||(i={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(a||(a={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(o||(o={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(s||(s={}));const u={float32:o,int32:i,bool:a,complex64:s};function c(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return u[t][e]}function l(t){return c(t,"int32")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({batchToSpaceND_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n){const s=Object(a.a)(t,"x","batchToSpaceND"),u=e.reduce((t,e)=>t*e);o.b(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),o.b(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),o.b(s.shape[0]%u==0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${u}`);const c={x:s},l={blockShape:e,crops:n};return r.a.runKernel(i.t,c,l)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({gather_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n=0,o=0){const s={x:Object(a.a)(t,"x","gather"),indices:Object(a.a)(e,"indices","gather","int32")},u={axis:n,batchDims:o};return r.a.runKernel(i.mb,s,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(16),u=n(4);const c=Object(u.b)({less_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","less"),u=Object(o.a)(e,"b","less");[n,u]=Object(a.makeTypesMatch)(n,u),Object(s.a)(n.shape,u.shape);const c={a:n,b:u};return r.a.runKernel(i.yb,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({logicalNot_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","logicalNot","bool")};return r.a.runKernel(i.Fb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(16),u=n(11),c=n(4);const l=Object(c.b)({minimum_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","minimum"),c=Object(o.a)(e,"b","minimum");[n,c]=Object(a.makeTypesMatch)(n,c),"bool"===n.dtype&&(n=Object(u.a)(n,"int32"),c=Object(u.a)(c,"int32")),Object(s.a)(n.shape,c.shape);const l={a:n,b:c};return r.a.runKernel(i.Qb,l)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(16),u=n(4);const c=Object(u.b)({notEqual_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","notEqual"),u=Object(o.a)(e,"b","notEqual");[n,u]=Object(a.makeTypesMatch)(n,u),Object(s.a)(n.shape,u.shape);const c={a:n,b:u};return r.a.runKernel(i.Zb,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({spaceToBatchND_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n){const s=Object(a.a)(t,"x","spaceToBatchND");o.b(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),o.b(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),o.b(s.shape.reduce((t,r,i)=>i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const u={x:s},c={blockShape:e,paddings:n};return r.a.runKernel(i.Hc,u,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(16),u=n(4);const c=Object(u.b)({squaredDifference_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","squaredDifference"),u=Object(o.a)(e,"b","squaredDifference");[n,u]=Object(a.makeTypesMatch)(n,u),Object(s.a)(n.shape,u.shape);const c={a:n,b:u};return r.a.runKernel(i.Mc,c,{})}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(1),i=n(7),a=n(4),o=n(8);const s=Object(a.b)({squeeze_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const n=Object(r.a)(t,"x","squeeze");return Object(o.a)(n,Object(i.P)(n.shape,e).newShape)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1),i=n(49);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function a(t,e,n){const a=Object(r.c)(t,n);return Object(i.a)(t,e,a,n)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o}));var r=n(87);n(143);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class i{constructor(t,e,n,i,a){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const o=a||Math.random();this.random=r.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const t=this.nextVal;return this.nextVal=NaN,t}let t,e,n=!1;for(;!n;){let r,i,a;do{r=2*this.random()-1,i=2*this.random()-1,a=r*r+i*i}while(a>=1||0===a);const o=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*r*o,e=this.mean+this.stdDev*i*o,this.truncated&&!this.isValidTruncated(t)||(n=!0)}return this.truncated&&!this.isValidTruncated(e)||(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class a{constructor(t,e,n,a){this.alpha=t,this.beta=1/e,this.dtype=n;const o=a||Math.random();this.randu=r.alea(o.toString()),this.randn=new i(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,n,r,i,a;for(;;){do{r=this.randn.nextValue(),a=1+this.c*r}while(a<=0);if(a*=a*a,t=r*r,e=1-.331*t*t,n=.5*t+this.d*(1-a+Math.log(a)),i=this.randu(),i<e||Math.log(i)<n)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(t){return"float32"===this.dtype?t:Math.round(t)}}class o{constructor(t=0,e=1,n,i){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=n,null==i&&(i=Math.random()),"number"==typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=r.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}},function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return o}));
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r={};function i(t,e){const n={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e};r[t]=n}function a(t){return r[t]}function o(t){delete r[t]}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(1),o=n(65),s=n(4),u=n(8);const c=Object(s.b)({broadcastTo_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(a.a)(t,"broadcastTo","x");const s=n.shape;if(e.some(t=>!(t>0)||t%1!=0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const t=n.shape.slice();for(;t.length<e.length;)t.unshift(1);n=Object(u.a)(n,t)}const c=n.shape,l=Array.from(e);for(let t=e.length-1;t>=0;t--)if(c[t]===e[t])l[t]=1;else if(1!==n.shape[t])throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(0===l.map((t,e)=>t>1?e:-1).filter(t=>t>=0).length)return Object(o.a)(n);const d={x:n},f={reps:l};return r.a.runKernel(i.Tc,d,f)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({min_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=null,n=!1){const o={x:Object(a.a)(t,"x","min")},s={axis:e,keepDims:n};return r.a.runKernel(i.Pb,o,s)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({oneHot_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n=1,o=0){if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);const s={indices:Object(a.a)(t,"indices","oneHot","int32")},u={depth:e,onValue:n,offValue:o};return r.a.runKernel(i.ac,s,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({real_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={input:Object(a.a)(t,"input","real")};return r.a.runKernel(i.jc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(7),o=n(4);const s=Object(o.b)({ifft_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){Object(a.b)("complex64"===t.dtype,()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return r.a.runKernel(i.pb,e)}})},function(t,e,n){"use strict";t.exports=function(t,e){e||(e={}),"function"==typeof e&&(e={cmp:e});var n,r="boolean"==typeof e.cycles&&e.cycles,i=e.cmp&&(n=e.cmp,function(t){return function(e,r){var i={key:e,value:t[e]},a={key:r,value:t[r]};return n(i,a)}}),a=[];return function t(e){if(e&&e.toJSON&&"function"==typeof e.toJSON&&(e=e.toJSON()),void 0!==e){if("number"==typeof e)return isFinite(e)?""+e:"null";if("object"!=typeof e)return JSON.stringify(e);var n,o;if(Array.isArray(e)){for(o="[",n=0;n<e.length;n++)n&&(o+=","),o+=t(e[n])||"null";return o+"]"}if(null===e)return"null";if(-1!==a.indexOf(e)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=a.push(e)-1,u=Object.keys(e).sort(i&&i(e));for(o="",n=0;n<u.length;n++){var c=u[n],l=t(e[c]);l&&(o&&(o+=","),o+=JSON.stringify(c)+":"+l)}return a.splice(s,1),"{"+o+"}"}}(t)}},,function(t,e,n){var r,i=n(343),a=n(241),o=n(345),s=n(346),u=n(347);"undefined"!=typeof ArrayBuffer&&(r=n(348));var c="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),l="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),d=c||l;e.protocol=3;var f=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},h=i(f),p={type:"error",data:"parser error"},m=n(349);function g(t,e,n){for(var r=new Array(t.length),i=s(t.length,n),a=function(t,n,i){e(n,(function(e,n){r[t]=n,i(e,r)}))},o=0;o<t.length;o++)a(o,t[o],i)}e.encodePacket=function(t,n,r,i){"function"==typeof n&&(i=n,n=!1),"function"==typeof r&&(i=r,r=null);var a=void 0===t.data?void 0:t.data.buffer||t.data;if("undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);var i=t.data,a=new Uint8Array(i),o=new Uint8Array(1+i.byteLength);o[0]=f[t.type];for(var s=0;s<a.length;s++)o[s+1]=a[s];return r(o.buffer)}(t,n,i);if(void 0!==m&&a instanceof m)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);if(d)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);var i=new FileReader;return i.onload=function(){e.encodePacket({type:t.type,data:i.result},n,!0,r)},i.readAsArrayBuffer(t.data)}(t,n,r);var i=new Uint8Array(1);i[0]=f[t.type];var a=new m([i.buffer,t.data]);return r(a)}(t,n,i);if(a&&a.base64)return function(t,n){var r="b"+e.packets[t.type]+t.data.data;return n(r)}(t,i);var o=f[t.type];return void 0!==t.data&&(o+=r?u.encode(String(t.data),{strict:!1}):String(t.data)),i(""+o)},e.encodeBase64Packet=function(t,n){var r,i="b"+e.packets[t.type];if(void 0!==m&&t.data instanceof m){var a=new FileReader;return a.onload=function(){var t=a.result.split(",")[1];n(i+t)},a.readAsDataURL(t.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var o=new Uint8Array(t.data),s=new Array(o.length),u=0;u<o.length;u++)s[u]=o[u];r=String.fromCharCode.apply(null,s)}return i+=btoa(r),n(i)},e.decodePacket=function(t,n,r){if(void 0===t)return p;if("string"==typeof t){if("b"===t.charAt(0))return e.decodeBase64Packet(t.substr(1),n);if(r&&!1===(t=function(t){try{t=u.decode(t,{strict:!1})}catch(t){return!1}return t}(t)))return p;var i=t.charAt(0);return Number(i)==i&&h[i]?t.length>1?{type:h[i],data:t.substring(1)}:{type:h[i]}:p}i=new Uint8Array(t)[0];var a=o(t,1);return m&&"blob"===n&&(a=new m([a])),{type:h[i],data:a}},e.decodeBase64Packet=function(t,e){var n=h[t.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:t.substr(1)}};var i=r.decode(t.substr(1));return"blob"===e&&m&&(i=new m([i])),{type:n,data:i}},e.encodePayload=function(t,n,r){"function"==typeof n&&(r=n,n=null);var i=a(t);if(n&&i)return m&&!d?e.encodePayloadAsBlob(t,r):e.encodePayloadAsArrayBuffer(t,r);if(!t.length)return r("0:");g(t,(function(t,r){e.encodePacket(t,!!i&&n,!1,(function(t){r(null,function(t){return t.length+":"+t}(t))}))}),(function(t,e){return r(e.join(""))}))},e.decodePayload=function(t,n,r){if("string"!=typeof t)return e.decodePayloadAsBinary(t,n,r);var i;if("function"==typeof n&&(r=n,n=null),""===t)return r(p,0,1);for(var a,o,s="",u=0,c=t.length;u<c;u++){var l=t.charAt(u);if(":"===l){if(""===s||s!=(a=Number(s)))return r(p,0,1);if(s!=(o=t.substr(u+1,a)).length)return r(p,0,1);if(o.length){if(i=e.decodePacket(o,n,!1),p.type===i.type&&p.data===i.data)return r(p,0,1);if(!1===r(i,u+a,c))return}u+=a,s=""}else s+=l}return""!==s?r(p,0,1):void 0},e.encodePayloadAsArrayBuffer=function(t,n){if(!t.length)return n(new ArrayBuffer(0));g(t,(function(t,n){e.encodePacket(t,!0,!0,(function(t){return n(null,t)}))}),(function(t,e){var r=e.reduce((function(t,e){var n;return t+(n="string"==typeof e?e.length:e.byteLength).toString().length+n+2}),0),i=new Uint8Array(r),a=0;return e.forEach((function(t){var e="string"==typeof t,n=t;if(e){for(var r=new Uint8Array(t.length),o=0;o<t.length;o++)r[o]=t.charCodeAt(o);n=r.buffer}i[a++]=e?0:1;var s=n.byteLength.toString();for(o=0;o<s.length;o++)i[a++]=parseInt(s[o]);i[a++]=255;for(r=new Uint8Array(n),o=0;o<r.length;o++)i[a++]=r[o]})),n(i.buffer)}))},e.encodePayloadAsBlob=function(t,n){g(t,(function(t,n){e.encodePacket(t,!0,!0,(function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var r=new Uint8Array(t.length),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);t=r.buffer,e[0]=0}var a=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),o=new Uint8Array(a.length+1);for(i=0;i<a.length;i++)o[i]=parseInt(a[i]);if(o[a.length]=255,m){var s=new m([e.buffer,o.buffer,t]);n(null,s)}}))}),(function(t,e){return n(new m(e))}))},e.decodePayloadAsBinary=function(t,n,r){"function"==typeof n&&(r=n,n=null);for(var i=t,a=[];i.byteLength>0;){for(var s=new Uint8Array(i),u=0===s[0],c="",l=1;255!==s[l];l++){if(c.length>310)return r(p,0,1);c+=s[l]}i=o(i,2+c.length),c=parseInt(c);var d=o(i,0,c);if(u)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(t){var f=new Uint8Array(d);d="";for(l=0;l<f.length;l++)d+=String.fromCharCode(f[l])}a.push(d),i=o(i,c)}var h=a.length;a.forEach((function(t,i){r(e.decodePacket(t,n,!0),i,h)}))}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,n){const{MAX_SAFE_COMPONENT_LENGTH:r}=n(164),i=n(165),a=(e=t.exports={}).re=[],o=e.src=[],s=e.t={};let u=0;const c=(t,e,n)=>{const r=u++;i(r,e),s[t]=r,o[r]=e,a[r]=new RegExp(e,n?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${o[s.NUMERICIDENTIFIER]}|${o[s.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${o[s.NUMERICIDENTIFIERLOOSE]}|${o[s.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${o[s.PRERELEASEIDENTIFIER]}(?:\\.${o[s.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${o[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[s.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${o[s.BUILDIDENTIFIER]}(?:\\.${o[s.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${o[s.MAINVERSION]}${o[s.PRERELEASE]}?${o[s.BUILD]}?`),c("FULL",`^${o[s.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${o[s.MAINVERSIONLOOSE]}${o[s.PRERELEASELOOSE]}?${o[s.BUILD]}?`),c("LOOSE",`^${o[s.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",o[s.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),c("XRANGEIDENTIFIER",o[s.NUMERICIDENTIFIER]+"|x|X|\\*"),c("XRANGEPLAIN",`[v=\\s]*(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:${o[s.PRERELEASE]})?${o[s.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:${o[s.PRERELEASELOOSE]})?${o[s.BUILD]}?)?)?`),c("XRANGE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),c("COERCERTL",o[s.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${o[s.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",c("TILDE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${o[s.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",c("CARET",`^${o[s.LONECARET]}${o[s.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${o[s.LONECARET]}${o[s.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${o[s.GTLT]}\\s*(${o[s.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]}|${o[s.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${o[s.XRANGEPLAIN]})\\s+-\\s+(${o[s.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${o[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[s.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0.0.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},function(t,e,n){const{MAX_LENGTH:r}=n(164),{re:i,t:a}=n(119),o=n(51),s=n(166);t.exports=(t,e)=>{if(e=s(e),t instanceof o)return t;if("string"!=typeof t)return null;if(t.length>r)return null;if(!(e.loose?i[a.LOOSE]:i[a.FULL]).test(t))return null;try{return new o(t,e)}catch(t){return null}}},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"JsonPatchError",(function(){return D})),n.d(r,"deepClone",(function(){return I})),n.d(r,"getValueByPointer",(function(){return R})),n.d(r,"applyOperation",(function(){return B})),n.d(r,"applyPatch",(function(){return z})),n.d(r,"applyReducer",(function(){return L})),n.d(r,"validator",(function(){return P})),n.d(r,"validate",(function(){return q})),n.d(r,"_areEquals",(function(){return W}));var i={};n.r(i),n.d(i,"unobserve",(function(){return H})),n.d(i,"observe",(function(){return X})),n.d(i,"generate",(function(){return K})),n.d(i,"compare",(function(){return J}));var a={};n.r(a),n.d(a,"aggregate",(function(){return Li})),n.d(a,"bin",(function(){return Pi})),n.d(a,"collect",(function(){return Wi})),n.d(a,"compare",(function(){return Ui})),n.d(a,"countpattern",(function(){return Gi})),n.d(a,"cross",(function(){return Hi})),n.d(a,"density",(function(){return Ki})),n.d(a,"dotbin",(function(){return ta})),n.d(a,"expression",(function(){return na})),n.d(a,"extent",(function(){return ia})),n.d(a,"facet",(function(){return oa})),n.d(a,"field",(function(){return sa})),n.d(a,"filter",(function(){return ca})),n.d(a,"flatten",(function(){return la})),n.d(a,"fold",(function(){return da})),n.d(a,"formula",(function(){return fa})),n.d(a,"generate",(function(){return ha})),n.d(a,"impute",(function(){return ga})),n.d(a,"joinaggregate",(function(){return ba})),n.d(a,"kde",(function(){return ya})),n.d(a,"key",(function(){return va})),n.d(a,"load",(function(){return wa})),n.d(a,"lookup",(function(){return Oa})),n.d(a,"multiextent",(function(){return _a})),n.d(a,"multivalues",(function(){return Ca})),n.d(a,"params",(function(){return Sa})),n.d(a,"pivot",(function(){return ja})),n.d(a,"prefacet",(function(){return Na})),n.d(a,"project",(function(){return Ta})),n.d(a,"proxy",(function(){return Fa})),n.d(a,"quantile",(function(){return Da})),n.d(a,"relay",(function(){return Ia})),n.d(a,"sample",(function(){return Ma})),n.d(a,"sequence",(function(){return $a})),n.d(a,"sieve",(function(){return Ra})),n.d(a,"subflow",(function(){return aa})),n.d(a,"timeunit",(function(){return Ba})),n.d(a,"tupleindex",(function(){return La})),n.d(a,"values",(function(){return Pa})),n.d(a,"window",(function(){return Ga}));var o={};n.r(o),n.d(o,"interpolate",(function(){return Qu})),n.d(o,"interpolateArray",(function(){return Vu})),n.d(o,"interpolateBasis",(function(){return Fu})),n.d(o,"interpolateBasisClosed",(function(){return Du})),n.d(o,"interpolateDate",(function(){return Hu})),n.d(o,"interpolateDiscrete",(function(){return gl})),n.d(o,"interpolateHue",(function(){return bl})),n.d(o,"interpolateNumber",(function(){return Xu})),n.d(o,"interpolateNumberArray",(function(){return Wu})),n.d(o,"interpolateObject",(function(){return Ku})),n.d(o,"interpolateRound",(function(){return tc})),n.d(o,"interpolateString",(function(){return Zu})),n.d(o,"interpolateTransformCss",(function(){return kl})),n.d(o,"interpolateTransformSvg",(function(){return Ol})),n.d(o,"interpolateZoom",(function(){return Al})),n.d(o,"interpolateRgb",(function(){return zu})),n.d(o,"interpolateRgbBasis",(function(){return Pu})),n.d(o,"interpolateRgbBasisClosed",(function(){return qu})),n.d(o,"interpolateHsl",(function(){return El})),n.d(o,"interpolateHslLong",(function(){return Sl})),n.d(o,"interpolateLab",(function(){return ql})),n.d(o,"interpolateHcl",(function(){return Ul})),n.d(o,"interpolateHclLong",(function(){return Vl})),n.d(o,"interpolateCubehelix",(function(){return ed})),n.d(o,"interpolateCubehelixLong",(function(){return nd})),n.d(o,"piecewise",(function(){return al})),n.d(o,"quantize",(function(){return rd}));var s={};n.r(s),n.d(s,"bound",(function(){return Im})),n.d(s,"identifier",(function(){return $m})),n.d(s,"mark",(function(){return Rm})),n.d(s,"overlap",(function(){return Bm})),n.d(s,"render",(function(){return Vm})),n.d(s,"viewlayout",(function(){return fg}));var u={};n.r(u),n.d(u,"axisticks",(function(){return Nb})),n.d(u,"datajoin",(function(){return Tb})),n.d(u,"encode",(function(){return Db})),n.d(u,"legendentries",(function(){return Ib})),n.d(u,"linkpath",(function(){return zb})),n.d(u,"pie",(function(){return Ub})),n.d(u,"scale",(function(){return Hb})),n.d(u,"sortitems",(function(){return Jb})),n.d(u,"stack",(function(){return Qb}));var c={};n.r(c),n.d(c,"contour",(function(){return Hw})),n.d(c,"geojson",(function(){return Xw})),n.d(c,"geopath",(function(){return Kw})),n.d(c,"geopoint",(function(){return Yw})),n.d(c,"geoshape",(function(){return Jw})),n.d(c,"graticule",(function(){return Zw})),n.d(c,"heatmap",(function(){return Qw})),n.d(c,"isocontour",(function(){return Rw})),n.d(c,"kde2d",(function(){return Uw})),n.d(c,"projection",(function(){return ek}));var l={};n.r(l),n.d(l,"force",(function(){return sO}));var d={};n.r(d),n.d(d,"nest",(function(){return k_})),n.d(d,"pack",(function(){return S_})),n.d(d,"partition",(function(){return N_})),n.d(d,"stratify",(function(){return T_})),n.d(d,"tree",(function(){return I_})),n.d(d,"treelinks",(function(){return M_})),n.d(d,"treemap",(function(){return B_}));var f={};n.r(f),n.d(f,"loess",(function(){return J_})),n.d(f,"regression",(function(){return Q_}));var h={};n.r(h),n.d(h,"voronoi",(function(){return SA}));var p={};n.r(p),n.d(p,"wordcloud",(function(){return mC}));var m={};n.r(m),n.d(m,"crossfilter",(function(){return NC})),n.d(m,"resolvefilter",(function(){return TC}));var g={};n.r(g),n.d(g,"interpolate",(function(){return qF})),n.d(g,"interpolateArray",(function(){return NF})),n.d(g,"interpolateBasis",(function(){return bF})),n.d(g,"interpolateBasisClosed",(function(){return yF})),n.d(g,"interpolateDate",(function(){return FF})),n.d(g,"interpolateDiscrete",(function(){return WF})),n.d(g,"interpolateHue",(function(){return UF})),n.d(g,"interpolateNumber",(function(){return DF})),n.d(g,"interpolateNumberArray",(function(){return SF})),n.d(g,"interpolateObject",(function(){return IF})),n.d(g,"interpolateRound",(function(){return VF})),n.d(g,"interpolateString",(function(){return PF})),n.d(g,"interpolateTransformCss",(function(){return YF})),n.d(g,"interpolateTransformSvg",(function(){return JF})),n.d(g,"interpolateZoom",(function(){return tD})),n.d(g,"interpolateRgb",(function(){return _F})),n.d(g,"interpolateRgbBasis",(function(){return CF})),n.d(g,"interpolateRgbBasisClosed",(function(){return EF})),n.d(g,"interpolateHsl",(function(){return nD})),n.d(g,"interpolateHslLong",(function(){return rD})),n.d(g,"interpolateLab",(function(){return bD})),n.d(g,"interpolateHcl",(function(){return vD})),n.d(g,"interpolateHclLong",(function(){return xD})),n.d(g,"interpolateCubehelix",(function(){return AD})),n.d(g,"interpolateCubehelixLong",(function(){return CD})),n.d(g,"piecewise",(function(){return zT})),n.d(g,"quantize",(function(){return ED}));var b={};n.r(b),n.d(b,"version",(function(){return FC.a})),n.d(b,"accessor",(function(){return et})),n.d(b,"accessorName",(function(){return nt})),n.d(b,"accessorFields",(function(){return rt})),n.d(b,"id",(function(){return dt})),n.d(b,"identity",(function(){return ft})),n.d(b,"zero",(function(){return ht})),n.d(b,"one",(function(){return pt})),n.d(b,"truthy",(function(){return mt})),n.d(b,"falsy",(function(){return gt})),n.d(b,"logger",(function(){return Ot})),n.d(b,"None",(function(){return yt})),n.d(b,"Error",(function(){return vt})),n.d(b,"Warn",(function(){return xt})),n.d(b,"Info",(function(){return wt})),n.d(b,"Debug",(function(){return kt})),n.d(b,"mergeConfig",(function(){return Et})),n.d(b,"writeConfig",(function(){return St})),n.d(b,"panLinear",(function(){return Bt})),n.d(b,"panLog",(function(){return zt})),n.d(b,"panPow",(function(){return Lt})),n.d(b,"panSymlog",(function(){return Pt})),n.d(b,"zoomLinear",(function(){return Wt})),n.d(b,"zoomLog",(function(){return Ut})),n.d(b,"zoomPow",(function(){return Vt})),n.d(b,"zoomSymlog",(function(){return Gt})),n.d(b,"quarter",(function(){return Ht})),n.d(b,"utcquarter",(function(){return Xt})),n.d(b,"array",(function(){return Kt})),n.d(b,"clampRange",(function(){return Yt})),n.d(b,"compare",(function(){return Zt})),n.d(b,"constant",(function(){return re})),n.d(b,"debounce",(function(){return ie})),n.d(b,"error",(function(){return st})),n.d(b,"extend",(function(){return ae})),n.d(b,"extent",(function(){return oe})),n.d(b,"extentIndex",(function(){return se})),n.d(b,"fastmap",(function(){return de})),n.d(b,"field",(function(){return ct})),n.d(b,"flush",(function(){return fe})),n.d(b,"hasOwnProperty",(function(){return ce})),n.d(b,"inherits",(function(){return he})),n.d(b,"inrange",(function(){return pe})),n.d(b,"isArray",(function(){return _t})),n.d(b,"isBoolean",(function(){return me})),n.d(b,"isDate",(function(){return ge})),n.d(b,"isFunction",(function(){return Jt})),n.d(b,"isNumber",(function(){return be})),n.d(b,"isObject",(function(){return At})),n.d(b,"isRegExp",(function(){return ye})),n.d(b,"isString",(function(){return ve})),n.d(b,"key",(function(){return xe})),n.d(b,"lerp",(function(){return we})),n.d(b,"lruCache",(function(){return ke})),n.d(b,"merge",(function(){return Oe})),n.d(b,"pad",(function(){return Ae})),n.d(b,"peek",(function(){return Nt})),n.d(b,"repeat",(function(){return _e})),n.d(b,"span",(function(){return Ce})),n.d(b,"splitAccessPath",(function(){return ut})),n.d(b,"stringValue",(function(){return Ee})),n.d(b,"toBoolean",(function(){return Se})),n.d(b,"toDate",(function(){return Ne})),n.d(b,"toNumber",(function(){return Tt})),n.d(b,"toString",(function(){return Te})),n.d(b,"toSet",(function(){return Fe})),n.d(b,"truncate",(function(){return De})),n.d(b,"visitArray",(function(){return Ie})),n.d(b,"Dataflow",(function(){return zn})),n.d(b,"EventStream",(function(){return _n})),n.d(b,"Parameters",(function(){return yn})),n.d(b,"Pulse",(function(){return Nn})),n.d(b,"MultiPulse",(function(){return In})),n.d(b,"Operator",(function(){return wn})),n.d(b,"Transform",(function(){return Pn})),n.d(b,"changeset",(function(){return bn})),n.d(b,"ingest",(function(){return dn})),n.d(b,"isTuple",(function(){return un})),n.d(b,"definition",(function(){return Wn})),n.d(b,"transform",(function(){return Un})),n.d(b,"transforms",(function(){return qn})),n.d(b,"tupleid",(function(){return cn})),n.d(b,"scale",(function(){return MT})),n.d(b,"scheme",(function(){return MD})),n.d(b,"interpolate",(function(){return TD})),n.d(b,"interpolateColors",(function(){return jD})),n.d(b,"interpolateRange",(function(){return SD})),n.d(b,"quantizeInterpolator",(function(){return ND})),n.d(b,"projection",(function(){return _w})),n.d(b,"View",(function(){return dK})),n.d(b,"formatLocale",(function(){return nn.c})),n.d(b,"timeFormatLocale",(function(){return nn.e})),n.d(b,"locale",(function(){return nn.b})),n.d(b,"defaultLocale",(function(){return nn.a})),n.d(b,"resetDefaultLocale",(function(){return nn.d})),n.d(b,"expressionFunction",(function(){return _X})),n.d(b,"parse",(function(){return bQ})),n.d(b,"runtimeContext",(function(){return tK})),n.d(b,"bandwidthNRD",(function(){return Tr})),n.d(b,"bin",(function(){return Fr})),n.d(b,"bootstrapCI",(function(){return Mr})),n.d(b,"cumulativeLogNormal",(function(){return Yr})),n.d(b,"cumulativeNormal",(function(){return Ur})),n.d(b,"cumulativeUniform",(function(){return ni})),n.d(b,"densityLogNormal",(function(){return Kr})),n.d(b,"densityNormal",(function(){return Wr})),n.d(b,"densityUniform",(function(){return ei})),n.d(b,"dotbin",(function(){return $r})),n.d(b,"quantileLogNormal",(function(){return Jr})),n.d(b,"quantileNormal",(function(){return Vr})),n.d(b,"quantileUniform",(function(){return ri})),n.d(b,"quantiles",(function(){return jr})),n.d(b,"quartiles",(function(){return Nr})),n.d(b,"random",(function(){return Dr})),n.d(b,"randomInteger",(function(){return Br})),n.d(b,"randomKDE",(function(){return Hr})),n.d(b,"randomLCG",(function(){return Rr})),n.d(b,"randomLogNormal",(function(){return Zr})),n.d(b,"randomMixture",(function(){return Qr})),n.d(b,"randomNormal",(function(){return Gr})),n.d(b,"randomUniform",(function(){return ii})),n.d(b,"regressionExp",(function(){return di})),n.d(b,"regressionLinear",(function(){return ci})),n.d(b,"regressionLoess",(function(){return gi})),n.d(b,"regressionLog",(function(){return li})),n.d(b,"regressionPoly",(function(){return pi})),n.d(b,"regressionPow",(function(){return fi})),n.d(b,"regressionQuad",(function(){return hi})),n.d(b,"sampleCurve",(function(){return xi})),n.d(b,"sampleLogNormal",(function(){return Xr})),n.d(b,"sampleNormal",(function(){return qr})),n.d(b,"sampleUniform",(function(){return ti})),n.d(b,"setRandom",(function(){return Ir})),n.d(b,"DATE",(function(){return _i.a})),n.d(b,"DAY",(function(){return _i.b})),n.d(b,"DAYOFYEAR",(function(){return _i.c})),n.d(b,"HOURS",(function(){return _i.d})),n.d(b,"MILLISECONDS",(function(){return _i.e})),n.d(b,"MINUTES",(function(){return _i.f})),n.d(b,"MONTH",(function(){return _i.g})),n.d(b,"QUARTER",(function(){return _i.h})),n.d(b,"SECONDS",(function(){return _i.i})),n.d(b,"TIME_UNITS",(function(){return _i.j})),n.d(b,"WEEK",(function(){return _i.k})),n.d(b,"YEAR",(function(){return _i.l})),n.d(b,"dayofyear",(function(){return _i.m})),n.d(b,"timeBin",(function(){return _i.n})),n.d(b,"timeFloor",(function(){return _i.o})),n.d(b,"timeInterval",(function(){return _i.p})),n.d(b,"timeOffset",(function(){return _i.q})),n.d(b,"timeSequence",(function(){return _i.r})),n.d(b,"timeUnitSpecifier",(function(){return _i.s})),n.d(b,"timeUnits",(function(){return _i.t})),n.d(b,"utcFloor",(function(){return _i.u})),n.d(b,"utcInterval",(function(){return _i.v})),n.d(b,"utcOffset",(function(){return _i.w})),n.d(b,"utcSequence",(function(){return _i.x})),n.d(b,"utcdayofyear",(function(){return _i.y})),n.d(b,"utcweek",(function(){return _i.z})),n.d(b,"week",(function(){return _i.A})),n.d(b,"format",(function(){return en.a})),n.d(b,"formats",(function(){return en.b})),n.d(b,"inferType",(function(){return en.c})),n.d(b,"inferTypes",(function(){return en.d})),n.d(b,"loader",(function(){return en.e})),n.d(b,"read",(function(){return en.f})),n.d(b,"responseType",(function(){return en.g})),n.d(b,"typeParsers",(function(){return en.h})),n.d(b,"Bounds",(function(){return LS})),n.d(b,"Gradient",(function(){return RC})),n.d(b,"GroupItem",(function(){return WS})),n.d(b,"ResourceLoader",(function(){return US})),n.d(b,"Item",(function(){return qS})),n.d(b,"Scenegraph",(function(){return IN})),n.d(b,"Handler",(function(){return WN})),n.d(b,"Renderer",(function(){return GN})),n.d(b,"CanvasHandler",(function(){return rT})),n.d(b,"CanvasRenderer",(function(){return cT})),n.d(b,"SVGHandler",(function(){return fT})),n.d(b,"SVGRenderer",(function(){return hI})),n.d(b,"SVGStringRenderer",(function(){return EI})),n.d(b,"RenderType",(function(){return TI})),n.d(b,"renderModule",(function(){return DI})),n.d(b,"intersect",(function(){return II})),n.d(b,"Marks",(function(){return EN})),n.d(b,"boundClip",(function(){return zI})),n.d(b,"boundContext",(function(){return QS})),n.d(b,"boundStroke",(function(){return XS})),n.d(b,"boundItem",(function(){return SN})),n.d(b,"boundMark",(function(){return NN})),n.d(b,"pathCurves",(function(){return TE})),n.d(b,"pathSymbols",(function(){return XE})),n.d(b,"pathRectangle",(function(){return uS})),n.d(b,"pathTrail",(function(){return cS})),n.d(b,"pathParse",(function(){return IE})),n.d(b,"pathRender",(function(){return VE})),n.d(b,"point",(function(){return qN})),n.d(b,"domCreate",(function(){return RN})),n.d(b,"domFind",(function(){return BN})),n.d(b,"domChild",(function(){return zN})),n.d(b,"domClear",(function(){return LN})),n.d(b,"openTag",(function(){return uI})),n.d(b,"closeTag",(function(){return cI})),n.d(b,"font",(function(){return wN})),n.d(b,"fontFamily",(function(){return xN})),n.d(b,"fontSize",(function(){return mN})),n.d(b,"lineHeight",(function(){return gN})),n.d(b,"multiLineOffset",(function(){return yN})),n.d(b,"textMetrics",(function(){return cN})),n.d(b,"sceneEqual",(function(){return LI})),n.d(b,"pathEqual",(function(){return PI})),n.d(b,"sceneToJSON",(function(){return FN})),n.d(b,"sceneFromJSON",(function(){return DN})),n.d(b,"intersectPath",(function(){return lj})),n.d(b,"intersectPoint",(function(){return dj})),n.d(b,"intersectRule",(function(){return hj})),n.d(b,"intersectBoxLine",(function(){return pj})),n.d(b,"sceneZOrder",(function(){return Oj})),n.d(b,"sceneVisit",(function(){return _j})),n.d(b,"scenePickVisit",(function(){return Aj})),n.d(b,"resetSVGClipId",(function(){return BS})),n.d(b,"resetSVGDefIds",(function(){return qI}));var y={};n.r(y),n.d(y,"invalidSpec",(function(){return O2})),n.d(y,"FIT_NON_SINGLE",(function(){return _2})),n.d(y,"containerSizeNonSingle",(function(){return A2})),n.d(y,"containerSizeNotCompatibleWithAutosize",(function(){return C2})),n.d(y,"droppingFit",(function(){return E2})),n.d(y,"cannotProjectOnChannelWithoutField",(function(){return S2})),n.d(y,"cannotProjectAggregate",(function(){return j2})),n.d(y,"nearestNotSupportForContinuous",(function(){return N2})),n.d(y,"selectionNotSupported",(function(){return T2})),n.d(y,"selectionNotFound",(function(){return F2})),n.d(y,"SCALE_BINDINGS_CONTINUOUS",(function(){return D2})),n.d(y,"LEGEND_BINDINGS_PROJECT_LENGTH",(function(){return I2})),n.d(y,"noSameUnitLookup",(function(){return M2})),n.d(y,"noSuchRepeatedValue",(function(){return $2})),n.d(y,"columnsNotSupportByRowCol",(function(){return R2})),n.d(y,"CONCAT_CANNOT_SHARE_AXIS",(function(){return B2})),n.d(y,"unrecognizedParse",(function(){return z2})),n.d(y,"differentParse",(function(){return L2})),n.d(y,"invalidTransformIgnored",(function(){return P2})),n.d(y,"NO_FIELDS_NEEDS_AS",(function(){return q2})),n.d(y,"customFormatTypeNotAllowed",(function(){return W2})),n.d(y,"encodingOverridden",(function(){return U2})),n.d(y,"projectionOverridden",(function(){return V2})),n.d(y,"REPLACE_ANGLE_WITH_THETA",(function(){return G2})),n.d(y,"primitiveChannelDef",(function(){return H2})),n.d(y,"invalidFieldType",(function(){return X2})),n.d(y,"invalidFieldTypeForCountAggregate",(function(){return K2})),n.d(y,"invalidAggregate",(function(){return Y2})),n.d(y,"missingFieldType",(function(){return J2})),n.d(y,"droppingColor",(function(){return Z2})),n.d(y,"emptyFieldDef",(function(){return Q2})),n.d(y,"latLongDeprecated",(function(){return t3})),n.d(y,"LINE_WITH_VARYING_SIZE",(function(){return e3})),n.d(y,"incompatibleChannel",(function(){return n3})),n.d(y,"invalidEncodingChannel",(function(){return r3})),n.d(y,"facetChannelShouldBeDiscrete",(function(){return i3})),n.d(y,"facetChannelDropped",(function(){return a3})),n.d(y,"discreteChannelCannotEncode",(function(){return o3})),n.d(y,"lineWithRange",(function(){return s3})),n.d(y,"orientOverridden",(function(){return u3})),n.d(y,"CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN",(function(){return c3})),n.d(y,"RANGE_STEP_DEPRECATED",(function(){return l3})),n.d(y,"cannotUseScalePropertyWithNonColor",(function(){return d3})),n.d(y,"unaggregateDomainHasNoEffectForRawField",(function(){return f3})),n.d(y,"unaggregateDomainWithNonSharedDomainOp",(function(){return h3})),n.d(y,"unaggregatedDomainWithLogScale",(function(){return p3})),n.d(y,"cannotApplySizeToNonOrientedMark",(function(){return m3})),n.d(y,"scaleTypeNotWorkWithChannel",(function(){return g3})),n.d(y,"scaleTypeNotWorkWithFieldDef",(function(){return b3})),n.d(y,"scalePropertyNotWorkWithScaleType",(function(){return y3})),n.d(y,"scaleTypeNotWorkWithMark",(function(){return v3})),n.d(y,"stepDropped",(function(){return x3})),n.d(y,"mergeConflictingProperty",(function(){return w3})),n.d(y,"mergeConflictingDomainProperty",(function(){return k3})),n.d(y,"independentScaleMeansIndependentGuide",(function(){return O3})),n.d(y,"domainSortDropped",(function(){return _3})),n.d(y,"MORE_THAN_ONE_SORT",(function(){return A3})),n.d(y,"FACETED_INDEPENDENT_DIFFERENT_SOURCES",(function(){return C3})),n.d(y,"FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES",(function(){return E3})),n.d(y,"FACETED_INDEPENDENT_SAME_SOURCE",(function(){return S3})),n.d(y,"INVALID_CHANNEL_FOR_AXIS",(function(){return j3})),n.d(y,"cannotStackRangedMark",(function(){return N3})),n.d(y,"cannotStackNonLinearScale",(function(){return T3})),n.d(y,"stackNonSummativeAggregate",(function(){return F3})),n.d(y,"invalidTimeUnit",(function(){return D3})),n.d(y,"droppedDay",(function(){return I3})),n.d(y,"errorBarCenterAndExtentAreNotNeeded",(function(){return M3})),n.d(y,"errorBarCenterIsUsedWithWrongExtent",(function(){return $3})),n.d(y,"errorBarContinuousAxisHasCustomizedAggregate",(function(){return R3})),n.d(y,"errorBarCenterIsNotNeeded",(function(){return B3})),n.d(y,"errorBand1DNotSupport",(function(){return z3})),n.d(y,"channelRequiredForBinned",(function(){return L3})),n.d(y,"domainRequiredForThresholdScale",(function(){return P3}));var v={};n.r(v),n.d(v,"compile",(function(){return Vit})),n.d(v,"extractTransforms",(function(){return Hit})),n.d(v,"normalize",(function(){return y7})),n.d(v,"version",(function(){return Xit}));var x={};n.r(x),n.d(x,"dark",(function(){return Jit})),n.d(x,"excel",(function(){return Zit})),n.d(x,"fivethirtyeight",(function(){return Qit})),n.d(x,"ggplot2",(function(){return tat})),n.d(x,"googlecharts",(function(){return uat})),n.d(x,"latimes",(function(){return rat})),n.d(x,"quartz",(function(){return iat})),n.d(x,"urbaninstitute",(function(){return sat})),n.d(x,"version",(function(){return cat})),n.d(x,"vox",(function(){return aat}));function w(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function k(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}Object.create;Object.create;
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var O=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_=Object.prototype.hasOwnProperty;function A(t,e){return _.call(t,e)}function C(t){if(Array.isArray(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);e=[];for(var r in t)A(t,r)&&e.push(r);return e}function E(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function S(t){for(var e,n=0,r=t.length;n<r;){if(!((e=t.charCodeAt(n))>=48&&e<=57))return!1;n++}return!0}function j(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function N(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function T(t,e){var n=[t];for(var r in e){var i="object"==typeof e[r]?JSON.stringify(e[r],null,2):e[r];void 0!==i&&n.push(r+": "+i)}return n.join("\n")}var F=function(t){function e(e,n,r,i,a){var o=this.constructor,s=t.call(this,T(e,{name:n,index:r,operation:i,tree:a}))||this;return s.name=n,s.index=r,s.operation=i,s.tree=a,Object.setPrototypeOf(s,o.prototype),s.message=T(e,{name:n,index:r,operation:i,tree:a}),s}return O(e,t),e}(Error),D=F,I=E,M={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=R(n,this.path);r&&(r=E(r));var i=B(n,{op:"remove",path:this.from}).removed;return B(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=R(n,this.from);return B(n,{op:"add",path:this.path,value:E(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:W(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},$={add:function(t,e,n){return S(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){return{newDocument:n,removed:t.splice(e,1)[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:M.move,copy:M.copy,test:M.test,_get:M._get};function R(t,e){if(""==e)return t;var n={op:"_get",path:e};return B(t,n),n.value}function B(t,e,n,r,i,a){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===a&&(a=0),n&&("function"==typeof n?n(e,0,t,e.path):P(e,0)),""===e.path){var o={newDocument:t};if("add"===e.op)return o.newDocument=e.value,o;if("replace"===e.op)return o.newDocument=e.value,o.removed=t,o;if("move"===e.op||"copy"===e.op)return o.newDocument=R(t,e.from),"move"===e.op&&(o.removed=t),o;if("test"===e.op){if(o.test=W(t,e.value),!1===o.test)throw new D("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return o.newDocument=t,o}if("remove"===e.op)return o.removed=t,o.newDocument=null,o;if("_get"===e.op)return e.value=t,o;if(n)throw new D("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,e,t);return o}r||(t=E(t));var s=(e.path||"").split("/"),u=t,c=1,l=s.length,d=void 0,f=void 0,h=void 0;for(h="function"==typeof n?n:P;;){if(f=s[c],i&&"__proto__"==f)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===d&&(void 0===u[f]?d=s.slice(0,c).join("/"):c==l-1&&(d=e.path),void 0!==d&&h(e,0,t,d)),c++,Array.isArray(u)){if("-"===f)f=u.length;else{if(n&&!S(f))throw new D("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,e,t);S(f)&&(f=~~f)}if(c>=l){if(n&&"add"===e.op&&f>u.length)throw new D("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,e,t);if(!1===(o=$[e.op].call(e,u,f,t)).test)throw new D("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return o}}else if(f&&-1!=f.indexOf("~")&&(f=N(f)),c>=l){if(!1===(o=M[e.op].call(e,u,f,t)).test)throw new D("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return o}u=u[f]}}function z(t,e,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),n&&!Array.isArray(e))throw new D("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=E(t));for(var a=new Array(e.length),o=0,s=e.length;o<s;o++)a[o]=B(t,e[o],n,!0,i,o),t=a[o].newDocument;return a.newDocument=t,a}function L(t,e,n){var r=B(t,e);if(!1===r.test)throw new D("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function P(t,e,n,r){if("object"!=typeof t||null===t||Array.isArray(t))throw new D("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(!M[t.op])throw new D("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n);if("string"!=typeof t.path)throw new D("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(0!==t.path.indexOf("/")&&t.path.length>0)throw new D('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if(("move"===t.op||"copy"===t.op)&&"string"!=typeof t.from)throw new D("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new D("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&function t(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var n=0,r=e.length;n<r;n++)if(t(e[n]))return!0}else if("object"==typeof e){var i=C(e),a=i.length;for(n=0;n<a;n++)if(t(e[i[n]]))return!0}return!1}(t.value))throw new D("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n)if("add"==t.op){var i=t.path.split("/").length,a=r.split("/").length;if(i!==a+1&&i!==a)throw new D("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==r)throw new D("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if("move"===t.op||"copy"===t.op){var o=q([{op:"_get",path:t.from,value:void 0}],n);if(o&&"OPERATION_PATH_UNRESOLVABLE"===o.name)throw new D("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}function q(t,e,n){try{if(!Array.isArray(t))throw new D("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)z(E(e),E(t),n||!0);else{n=n||P;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(t){if(t instanceof D)return t;throw t}}function W(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){var n,r,i,a=Array.isArray(t),o=Array.isArray(e);if(a&&o){if((r=t.length)!=e.length)return!1;for(n=r;0!=n--;)if(!W(t[n],e[n]))return!1;return!0}if(a!=o)return!1;var s=Object.keys(t);if((r=s.length)!==Object.keys(e).length)return!1;for(n=r;0!=n--;)if(!e.hasOwnProperty(s[n]))return!1;for(n=r;0!=n--;)if(!W(t[i=s[n]],e[i]))return!1;return!0}return t!=t&&e!=e}
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var U=new WeakMap,V=function(t){this.observers=new Map,this.obj=t},G=function(t,e){this.callback=t,this.observer=e};function H(t,e){e.unobserve()}function X(t,e){var n,r=function(t){return U.get(t)}(t);if(r){var i=function(t,e){return t.observers.get(e)}(r,e);n=i&&i.observer}else r=new V(t),U.set(t,r);if(n)return n;if(n={},r.value=E(t),e){n.callback=e,n.next=null;var a=function(){K(n)},o=function(){clearTimeout(n.next),n.next=setTimeout(a)};"undefined"!=typeof window&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return n.patches=[],n.object=t,n.unobserve=function(){K(n),clearTimeout(n.next),function(t,e){t.observers.delete(e.callback)}(r,n),"undefined"!=typeof window&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},r.observers.set(e,new G(e,n)),n}function K(t,e){void 0===e&&(e=!1);var n=U.get(t.object);Y(n.value,t.object,t.patches,"",e),t.patches.length&&z(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function Y(t,e,n,r,i){if(e!==t){"function"==typeof e.toJSON&&(e=e.toJSON());for(var a=C(e),o=C(t),s=!1,u=o.length-1;u>=0;u--){var c=t[d=o[u]];if(!A(e,d)||void 0===e[d]&&void 0!==c&&!1===Array.isArray(e))Array.isArray(t)===Array.isArray(e)?(i&&n.push({op:"test",path:r+"/"+j(d),value:E(c)}),n.push({op:"remove",path:r+"/"+j(d)}),s=!0):(i&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}),!0);else{var l=e[d];"object"==typeof c&&null!=c&&"object"==typeof l&&null!=l?Y(c,l,n,r+"/"+j(d),i):c!==l&&(!0,i&&n.push({op:"test",path:r+"/"+j(d),value:E(c)}),n.push({op:"replace",path:r+"/"+j(d),value:E(l)}))}}if(s||a.length!=o.length)for(u=0;u<a.length;u++){var d;A(t,d=a[u])||void 0===e[d]||n.push({op:"add",path:r+"/"+j(d),value:E(e[d])})}}}function J(t,e,n){void 0===n&&(n=!1);var r=[];return Y(t,e,r,"",n),r}Object.assign({},r,i,{JsonPatchError:F,deepClone:E,escapePathComponent:j,unescapePathComponent:N});var Z=n(211),Q=n.n(Z),tt=n(228),et=function(t,e,n){return t.fields=e||[],t.fname=n,t};function nt(t){return null==t?null:t.fname}function rt(t){return null==t?null:t.fields}var it=function(t){return 1===t.length?at(t[0]):ot(t)};const at=t=>function(e){return e[t]},ot=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};var st=function(t){throw Error(t)},ut=function(t){var e,n,r,i=[],a=null,o=0,s=t.length,u="";function c(){i.push(u+t.substring(e,n)),u="",e=n+1}for(t+="",e=n=0;n<s;++n)if("\\"===(r=t[n]))u+=t.substring(e,n),u+=t.substring(++n,++n),e=n;else if(r===a)c(),a=null,o=-1;else{if(a)continue;e===o&&'"'===r||e===o&&"'"===r?(e=n+1,a=r):"."!==r||o?"["===r?(n>e&&c(),o=e=n+1):"]"===r&&(o||st("Access path missing open bracket: "+t),o>0&&c(),o=0,e=n+1):n>e?c():e=n+1}return o&&st("Access path missing closing bracket: "+t),a&&st("Access path missing closing quote: "+t),n>e&&(n++,c()),i},ct=function(t,e,n){const r=ut(t);return t=1===r.length?r[0]:t,et((n&&n.get||it)(r),[t],e||t)},lt=[],dt=ct("id"),ft=et((function(t){return t}),lt,"identity"),ht=et((function(){return 0}),lt,"zero"),pt=et((function(){return 1}),lt,"one"),mt=et((function(){return!0}),lt,"true"),gt=et((function(){return!1}),lt,"false");function bt(t,e,n){var r=[e].concat([].slice.call(n));console[t].apply(console,r)}var yt=0,vt=1,xt=2,wt=3,kt=4,Ot=function(t,e){var n=t||yt;return{level:function(t){return arguments.length?(n=+t,this):n},error:function(){return n>=vt&&bt(e||"error","ERROR",arguments),this},warn:function(){return n>=xt&&bt(e||"warn","WARN",arguments),this},info:function(){return n>=wt&&bt(e||"log","INFO",arguments),this},debug:function(){return n>=kt&&bt(e||"log","DEBUG",arguments),this}}},_t=Array.isArray,At=function(t){return t===Object(t)};const Ct=t=>"__proto__"!==t;function Et(...t){return t.reduce((t,e)=>{for(var n in e)if("signals"===n)t.signals=jt(t.signals,e.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;St(t,n,e[n],r)}return t},{})}function St(t,e,n,r){var i,a;if(Ct(e))if(At(n)&&!_t(n))for(i in a=At(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?St(a,i,n[i]):Ct(i)&&(a[i]=n[i]);else t[e]=n}function jt(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}var Nt=function(t){return t[t.length-1]},Tt=function(t){return null==t||""===t?null:+t};function Ft(t){return function(e){return t*Math.exp(e)}}function Dt(t){return function(e){return Math.log(t*e)}}function It(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Mt(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function $t(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Rt(t,e,n,r){var i=n(t[0]),a=n(Nt(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function Bt(t,e){return Rt(t,e,Tt,ft)}function zt(t,e){var n=Math.sign(t[0]);return Rt(t,e,Dt(n),Ft(n))}function Lt(t,e,n){return Rt(t,e,$t(n),$t(1/n))}function Pt(t,e,n){return Rt(t,e,It(n),Mt(n))}function qt(t,e,n,r,i){var a=r(t[0]),o=r(Nt(t)),s=null!=e?r(e):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function Wt(t,e,n){return qt(t,e,n,Tt,ft)}function Ut(t,e,n){var r=Math.sign(t[0]);return qt(t,e,n,Dt(r),Ft(r))}function Vt(t,e,n,r){return qt(t,e,n,$t(r),$t(1/r))}function Gt(t,e,n,r){return qt(t,e,n,It(r),Mt(r))}function Ht(t){return 1+~~(new Date(t).getMonth()/3)}function Xt(t){return 1+~~(new Date(t).getUTCMonth()/3)}var Kt=function(t){return null!=t?_t(t)?t:[t]:[]},Yt=function(t,e,n){var r,i=t[0],a=t[1];return a<i&&(r=a,a=i,i=r),(r=a-i)>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},Jt=function(t){return"function"==typeof t};var Zt=function(t,e,n){n=n||{},e=Kt(e)||[];const r=[],i=[],a={},o=n.comparator||te;return Kt(t).forEach((t,o)=>{null!=t&&(r.push("descending"===e[o]?-1:1),i.push(t=Jt(t)?t:ct(t,null,n)),(rt(t)||[]).forEach(t=>a[t]=1))}),0===i.length?null:et(o(i,r),Object.keys(a))};const Qt=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e==e?-1:e!=e&&t==t?1:0),te=(t,e)=>1===t.length?ee(t[0],e[0]):ne(t,e,t.length),ee=(t,e)=>function(n,r){return Qt(t(n),t(r))*e},ne=(t,e,n)=>(e.push(0),function(r,i){let a,o=0,s=-1;for(;0===o&&++s<n;)a=t[s],o=Qt(a(r),a(i));return o*e[s]});var re=function(t){return Jt(t)?t:function(){return t}},ie=function(t,e){var n,r;function i(){e(r),n=r=null}return function(e){r=e,n&&clearTimeout(n),n=setTimeout(i,t)}},ae=function(t){for(var e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r])t[n]=e[n];return t},oe=function(t,e){var n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!=r);r=t[++o]);for(i=a=r;o<n;++o)null!=(r=t[o])&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!=r);r=e(t[++o]));for(i=a=r;o<n;++o)null!=(r=e(t[o]))&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]},se=function(t,e){var n,r,i,a,o,s=-1,u=t.length;if(null==e){for(;++s<u;)if(null!=(r=t[s])&&r>=r){n=i=r;break}if(s===u)return[-1,-1];for(a=o=s;++s<u;)null!=(r=t[s])&&(n>r&&(n=r,a=s),i<r&&(i=r,o=s))}else{for(;++s<u;)if(null!=(r=e(t[s],s,t))&&r>=r){n=i=r;break}if(s===u)return[-1,-1];for(a=o=s;++s<u;)null!=(r=e(t[s],s,t))&&(n>r&&(n=r,a=s),i<r&&(i=r,o=s))}return[a,o]};const ue=Object.prototype.hasOwnProperty;var ce=function(t,e){return ue.call(t,e)},le={},de=function(t){var e,n,r={};function i(t){return ce(r,t)&&r[t]!==le}return e={size:0,empty:0,object:r,has:i,get:t=>i(t)?r[t]:void 0,set(t,n){return i(t)||(++e.size,r[t]===le&&--e.empty),r[t]=n,this},delete(t){return i(t)&&(--e.size,++e.empty,r[t]=le),this},clear(){e.size=e.empty=0,e.object=r={}},test(t){return arguments.length?(n=t,e):n},clean(){var t,i,a={},o=0;for(t in r)(i=r[t])===le||n&&n(i)||(a[t]=i,++o);e.size=o,e.empty=0,e.object=r=a}},t&&Object.keys(t).forEach((function(n){e.set(n,t[n])})),e},fe=function(t,e,n,r,i,a){if(!n&&0!==n)return a;var o,s,u=t[0],c=Nt(t),l=+n;return c<u&&(o=u,u=c,c=o),(o=Math.abs(e-u))<(s=Math.abs(c-e))&&o<=l?r:s<=l?i:a},he=function(t,e){var n=t.prototype=Object.create(e.prototype);return n.constructor=t,n},pe=function(t,e,n,r){var i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)},me=function(t){return"boolean"==typeof t},ge=function(t){return"[object Date]"===Object.prototype.toString.call(t)},be=function(t){return"number"==typeof t},ye=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},ve=function(t){return"string"==typeof t},xe=function(t,e,n){t&&(t=e?Kt(t).map(t=>t.replace(/\\(.)/g,"$1")):Kt(t));const r=t&&t.length,i=n&&n.get||it,a=t=>i(e?[t]:ut(t));let o;if(r)if(1===r){const e=a(t[0]);o=function(t){return""+e(t)}}else{const e=t.map(a);o=function(t){let n=""+e[0](t),i=0;for(;++i<r;)n+="|"+e[i](t);return n}}else o=function(){return""};return et(o,t,"key")},we=function(t,e){const n=t[0],r=Nt(t),i=+e;return i?1===i?r:n+i*(r-n):n};var ke=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},a=(i,a)=>(++r>t&&(n=e,e={},r=1),e[i]=a);return i(),{clear:i,has:t=>ce(e,t)||ce(n,t),get:t=>ce(e,t)?e[t]:ce(n,t)?a(t,n[t]):void 0,set:(t,n)=>ce(e,t)?e[t]=n:a(t,n)}},Oe=function(t,e,n,r){var i=e.length,a=n.length;if(!a)return e;if(!i)return n;for(var o=r||new e.constructor(i+a),s=0,u=0,c=0;s<i&&u<a;++c)o[c]=t(e[s],n[u])>0?n[u++]:e[s++];for(;s<i;++s,++c)o[c]=e[s];for(;u<a;++u,++c)o[c]=n[u];return o},_e=function(t,e){for(var n="";--e>=0;)n+=t;return n},Ae=function(t,e,n,r){var i=n||" ",a=t+"",o=e-a.length;return o<=0?a:"left"===r?_e(i,o)+a:"center"===r?_e(i,~~(o/2))+a+_e(i,Math.ceil(o/2)):a+_e(i,o)},Ce=function(t){return t&&Nt(t)-t[0]||0};function Ee(t){return _t(t)?"["+t.map(Ee)+"]":At(t)||ve(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}var Se=function(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t};function je(t){return be(t)||ge(t)?t:Date.parse(t)}var Ne=function(t,e){return e=e||je,null==t||""===t?null:e(t)},Te=function(t){return null==t||""===t?null:t+""},Fe=function(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=!0;return e},De=function(t,e,n,r){var i=null!=r?r:"",a=t+"",o=a.length,s=Math.max(0,e-i.length);return o<=e?a:"left"===n?i+a.slice(o-s):"center"===n?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i},Ie=function(t,e,n){if(t)if(e)for(var r,i=0,a=t.length;i<a;++i)(r=e(t[i]))&&n(r,i,t);else t.forEach(n)};function Me(t,e,n){return t.fields=e||[],t.fname=n,t}function $e(t){return 1===t.length?Re(t[0]):Be(t)}const Re=t=>function(e){return e[t]},Be=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function ze(t){throw Error(t)}function Le(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||ze("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&ze("Access path missing closing bracket: "+t),o&&ze("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function Pe(t,e,n){const r=Le(t);return t=1===r.length?r[0]:t,Me((n&&n.get||$e)(r),[t],e||t)}const qe=Pe("id"),We=Me(t=>t,[],"identity"),Ue=(Me(()=>0,[],"zero"),Me(()=>1,[],"one"),Me(()=>!0,[],"true"));Me(()=>!1,[],"false");function Ve(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}var Ge=Array.isArray;function He(t){return null!=t?Ge(t)?t:[t]:[]}function Xe(t){return"function"==typeof t}function Ke(t){return Xe(t)?t:()=>t}function Ye(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const Je=Object.prototype.hasOwnProperty;function Ze(t,e){return Je.call(t,e)}function Qe(t,e,n){const r=t.prototype=Object.create(e.prototype);return r.constructor=t,Ye(r,n)}function tn(t,e,n){if(t)if(e){const r=t.length;for(let i=0;i<r;++i){const r=e(t[i]);r&&n(r,i,t)}}else t.forEach(n)}var en=n(41),nn=n(62);function rn(t){const e=t||We,n=[],r={};return n.add=t=>{const i=e(t);return r[i]||(r[i]=1,n.push(t)),n},n.remove=t=>{const i=e(t);if(r[i]){r[i]=0;const e=n.indexOf(t);e>=0&&n.splice(e,1)}return n},n}async function an(t,e){try{await e(t)}catch(e){t.error(e)}}const on=Symbol("vega_id");let sn=1;function un(t){return!(!t||!cn(t))}function cn(t){return t[on]}function ln(t,e){return t[on]=e,t}function dn(t){const e=t===Object(t)?t:{data:t};return cn(e)?e:ln(e,sn++)}function fn(t){return hn(t,dn({}))}function hn(t,e){for(const n in t)e[n]=t[n];return e}function pn(t,e){return ln(e,cn(t))}function mn(t,e){return t?e?(n,r)=>t(n,r)||cn(e(n))-cn(e(r)):(e,n)=>t(e,n)||cn(e)-cn(n):null}function gn(t){return t&&t.constructor===bn}function bn(){const t=[],e=[],n=[],r=[],i=[];let a=null,o=!1;return{constructor:bn,insert(e){const n=He(e),r=n.length;for(let e=0;e<r;++e)t.push(n[e]);return this},remove(t){const n=Xe(t)?r:e,i=He(t),a=i.length;for(let t=0;t<a;++t)n.push(i[t]);return this},modify(t,e,r){const a={field:e,value:Ke(r)};return Xe(t)?(a.filter=t,i.push(a)):(a.tuple=t,n.push(a)),this},encode(t,e){return Xe(t)?i.push({filter:t,field:e}):n.push({tuple:t,field:e}),this},clean(t){return a=t,this},reflow(){return o=!0,this},pulse(s,u){const c={},l={};let d,f,h,p,m,g;for(d=0,f=u.length;d<f;++d)c[cn(u[d])]=1;for(d=0,f=e.length;d<f;++d)m=e[d],c[cn(m)]=-1;for(d=0,f=r.length;d<f;++d)p=r[d],u.forEach(t=>{p(t)&&(c[cn(t)]=-1)});for(d=0,f=t.length;d<f;++d)m=t[d],g=cn(m),c[g]?c[g]=1:s.add.push(dn(t[d]));for(d=0,f=u.length;d<f;++d)m=u[d],c[cn(m)]<0&&s.rem.push(m);function b(t,e,n){n?t[e]=n(t):s.encode=e,o||(l[cn(t)]=t)}for(d=0,f=n.length;d<f;++d)h=n[d],m=h.tuple,p=h.field,g=c[cn(m)],g>0&&(b(m,p,h.value),s.modifies(p));for(d=0,f=i.length;d<f;++d)h=i[d],p=h.filter,u.forEach(t=>{p(t)&&c[cn(t)]>0&&b(t,h.field,h.value)}),s.modifies(h.field);if(o)s.mod=e.length||r.length?u.filter(t=>c[cn(t)]>0):u.slice();else for(g in l)s.mod.push(l[g]);return(a||null==a&&(e.length||r.length))&&s.clean(!0),s}}}function yn(){Object.defineProperty(this,"_:mod:_",{writable:!0,value:{}})}yn.prototype={set(t,e,n,r){const i=this,a=i[t],o=i["_:mod:_"];return null!=e&&e>=0?(a[e]!==n||r)&&(a[e]=n,o[e+":"+t]=-1,o[t]=-1):(a!==n||r)&&(i[t]=n,o[t]=Ge(n)?1+n.length:-1),i},modified(t,e){const n=this["_:mod:_"];if(!arguments.length){for(const t in n)if(n[t])return!0;return!1}if(Ge(t)){for(let e=0;e<t.length;++e)if(n[t[e]])return!0;return!1}return null!=e&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){return this["_:mod:_"]={},this}};let vn=0;const xn=new yn;function wn(t,e,n,r){this.id=++vn,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}function kn(t){return function(e){const n=this.flags;return 0===arguments.length?!!(n&t):(this.flags=e?n|t:n&~t,this)}}wn.prototype={targets(){return this._targets||(this._targets=rn(qe))},set(t){return this.value!==t?(this.value=t,1):0},skip:kn(1),modified:kn(2),parameters(t,e,n){e=!1!==e;const r=this._argval=this._argval||new yn,i=this._argops=this._argops||[],a=[];let o,s,u,c;const l=(t,n,o)=>{o instanceof wn?(o!==this&&(e&&o.targets().add(this),a.push(o)),i.push({op:o,name:t,index:n})):r.set(t,n,o)};for(o in t)if(s=t[o],"pulse"===o)He(s).forEach(t=>{t instanceof wn?t!==this&&(t.targets().add(this),a.push(t)):ze("Pulse parameters must be operator instances.")}),this.source=s;else if(Ge(s))for(r.set(o,-1,Array(u=s.length)),c=0;c<u;++c)l(o,c,s[c]);else l(o,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),a},marshall(t){const e=this._argval||xn,n=this._argops;let r,i,a,o;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],a=r.op,o=a.modified()&&a.stamp===t,e.set(r.name,r.index,a.value,o);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return e},detach(){const t=this._argops;let e,n,r,i;if(t)for(e=0,n=t.length;e<n;++e)r=t[e],i=r.op,i._targets&&i._targets.remove(this)},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),r=e.call(this,n,t);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return t.StopPropagation}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t}};let On=0;function _n(t,e,n){this.id=++On,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function An(t,e,n){return new _n(t,e,n)}_n.prototype={_filter:Ue,_apply:We,targets(){return this._targets||(this._targets=rn(qe))},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,r=n?n.length:0;for(let t=0;t<r;++t)n[t].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(t){const e=An(t);return this.targets().add(e),e},apply(t){const e=An(null,t);return this.targets().add(e),e},merge(){const t=An();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},throttle(t){let e=-1;return this.filter(()=>{const n=Date.now();return n-e>t?(e=n,1):0})},debounce(t){const e=An();return this.targets().add(An(null,null,function(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(e(r),n=null),t)}}(t,t=>{const n=t.dataflow;e.receive(t),n&&n.run&&n.run()}))),e},between(t,e){let n=!1;return t.targets().add(An(null,null,()=>n=!0)),e.targets().add(An(null,null,()=>n=!1)),this.filter(()=>n)},detach(){}};const Cn={skip:!0};function En(t,e,n,r,i,a){const o=Ye({},a,Cn);let s,u;Xe(n)||(n=Ke(n)),void 0===r?s=e=>t.touch(n(e)):Xe(r)?(u=new wn(null,r,i,!1),s=e=>{u.evaluate(e);const r=n(e),i=u.value;gn(i)?t.pulse(r,i,a):t.update(r,i,o)}):s=e=>t.update(n(e),r,o),e.apply(s)}function Sn(t,e,n,r,i,a){if(void 0===r)e.targets().add(n);else{const o=a||{},s=new wn(null,function(t,e){return e=Xe(e)?e:Ke(e),t?function(n,r){const i=e(n,r);return t.skip()||(t.skip(i!==this.value).value=i),i}:e}(n,r),i,!1);s.modified(o.force),s.rank=e.rank,e.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),t.connect(n,[s]))}}const jn={};function Nn(t,e,n){this.dataflow=t,this.stamp=null==e?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Tn(t,e){const n=[];return tn(t,e,t=>n.push(t)),n}function Fn(t,e){const n={};return t.visit(e,t=>{n[cn(t)]=1}),t=>n[cn(t)]?null:t}function Dn(t,e){return t?(n,r)=>t(n,r)&&e(n,r):e}function In(t,e,n,r){const i=this,a=n.length;let o=0;this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n;for(let t=0;t<a;++t){const r=n[t];if(r.stamp===e){if(r.fields){const t=i.fields||(i.fields={});for(const e in r.fields)t[e]=1}r.changed(i.ADD)&&(o|=i.ADD),r.changed(i.REM)&&(o|=i.REM),r.changed(i.MOD)&&(o|=i.MOD)}}this.changes=o}function Mn(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}Nn.prototype={StopPropagation:jn,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(t){return new Nn(this.dataflow).init(this,t)},clone(){const t=this.fork(7);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(23)},addAll(){let t=this;return!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length||(t=new Nn(this.dataflow).init(this),t.add=t.source,t.rem=[]),t},init(t,e){const n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||64&e||(n.fields=t.fields),1&e?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),2&e?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),4&e?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),32&e?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length},reflow(t){if(t)return this.fork(7).reflow();const e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(4,Fn(this,1))),this},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans},modifies(t){const e=this.fields||(this.fields={});return Ge(t)?t.forEach(t=>e[t]=!0):e[t]=!0,this},modified(t,e){const n=this.fields;return!(!e&&!this.mod.length||!n)&&(arguments.length?Ge(t)?t.some(t=>n[t]):n[t]:!!n)},filter(t,e){const n=this;return 1&t&&(n.addF=Dn(n.addF,e)),2&t&&(n.remF=Dn(n.remF,e)),4&t&&(n.modF=Dn(n.modF,e)),16&t&&(n.srcF=Dn(n.srcF,e)),n},materialize(t){const e=this;return 1&(t=t||7)&&e.addF&&(e.add=Tn(e.add,e.addF),e.addF=null),2&t&&e.remF&&(e.rem=Tn(e.rem,e.remF),e.remF=null),4&t&&e.modF&&(e.mod=Tn(e.mod,e.modF),e.modF=null),16&t&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},visit(t,e){const n=this,r=e;if(16&t)return tn(n.source,n.srcF,r),n;1&t&&tn(n.add,n.addF,r),2&t&&tn(n.rem,n.remF,r),4&t&&tn(n.mod,n.modF,r);const i=n.source;if(8&t&&i){const t=n.add.length+n.mod.length;t===i.length||tn(i,t?Fn(n,5):n.srcF,r)}return n}},Qe(In,Nn,{fork(t){const e=new Nn(this.dataflow).init(this,t&this.NO_FIELDS);return void 0!==t&&(t&e.ADD&&this.visit(e.ADD,t=>e.add.push(t)),t&e.REM&&this.visit(e.REM,t=>e.rem.push(t)),t&e.MOD&&this.visit(e.MOD,t=>e.mod.push(t))),e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return n&&e.changes&e.MOD?Ge(t)?t.some(t=>n[t]):n[t]:0},filter(){ze("MultiPulse does not support filtering.")},materialize(){ze("MultiPulse does not support materialization.")},visit(t,e){const n=this,r=n.pulses,i=r.length;let a=0;if(t&n.SOURCE)for(;a<i;++a)r[a].visit(t,e);else for(;a<i;++a)r[a].stamp===n.stamp&&r[a].visit(t,e);return n}});const $n={skip:!1,force:!1};function Rn(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>(e.push(n),Bn(e,0,e.length-1,t)),pop:()=>{const n=e.pop();let r;return e.length?(r=e[0],e[0]=n,function(t,e,n){const r=e,i=t.length,a=t[e];let o,s=1+(e<<1);for(;s<i;)o=s+1,o<i&&n(t[s],t[o])>=0&&(s=o),t[e]=t[s],s=1+((e=s)<<1);t[e]=a,Bn(t,r,e,n)}(e,0,t)):r=n,r}}}function Bn(t,e,n,r){let i,a;const o=t[n];for(;n>e&&(a=n-1>>1,i=t[a],r(o,i)<0);)t[n]=i,n=a;return t[n]=o}function zn(){this.logger(function(t,e){let n=t||0;return{level(t){return arguments.length?(n=+t,this):n},error(){return n>=1&&Ve(e||"error","ERROR",arguments),this},warn(){return n>=2&&Ve(e||"warn","WARN",arguments),this},info(){return n>=3&&Ve(e||"log","INFO",arguments),this},debug(){return n>=4&&Ve(e||"log","DEBUG",arguments),this}}}()),this.logLevel(1),this._clock=0,this._rank=0,this._locale=Object(nn.a)();try{this._loader=Object(en.e)()}catch(t){}this._touched=rn(qe),this._input={},this._pulse=null,this._heap=Rn((t,e)=>t.qrank-e.qrank),this._postrun=[]}function Ln(t){return function(){return this._log[t].apply(this,arguments)}}function Pn(t,e){wn.call(this,t,null,e)}zn.prototype={stamp(){return this._clock},loader(t){return arguments.length?(this._loader=t,this):this._loader},locale(t){return arguments.length?(this._locale=t,this):this._locale},logger(t){return arguments.length?(this._log=t,this):this._log},error:Ln("error"),warn:Ln("warn"),info:Ln("info"),debug:Ln("debug"),logLevel:Ln("level"),cleanThreshold:1e4,add:function(t,e,n,r){let i,a=1;return t instanceof wn?i=t:t&&t.prototype instanceof wn?i=new t:Xe(t)?i=new wn(null,t):(a=0,i=new wn(t,e)),this.rank(i),a&&(r=n,n=e),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},connect:function(t,e){const n=t.rank,r=e.length;for(let i=0;i<r;++i)if(n<e[i].rank)return void this.rerank(t)},rank:function(t){t.rank=++this._rank},rerank:function(t){const e=[t];let n,r,i;for(;e.length;)if(this.rank(n=e.pop()),r=n._targets)for(i=r.length;--i>=0;)e.push(n=r[i]),n===t&&ze("Cycle detected in dataflow graph.")},pulse:function(t,e,n){this.touch(t,n||$n);const r=new Nn(this,this._clock+(this._pulse?0:1)),i=t.pulse&&t.pulse.source||[];return r.target=t,this._input[t.id]=e.pulse(r,i),this},touch:function(t,e){const n=e||$n;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this},update:function(t,e,n){const r=n||$n;return(t.set(e)||r.force)&&this.touch(t,r),this},changeset:bn,ingest:function(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e))},parse:function(t,e){const n=this.locale();return Object(en.f)(t,e,n.timeParse,n.utcParse)},preload:async function(t,e,n){const r=this,i=r._pending||function(t){let e;const n=new Promise(t=>e=t);return n.requests=0,n.done=()=>{0==--n.requests&&(t._pending=null,e(t))},t._pending=n}(r);i.requests+=1;const a=await r.request(e,n);return r.pulse(t,r.changeset().remove(Ue).insert(a.data||[])),i.done(),a},request:async function(t,e){const n=this;let r,i=0;try{r=await n.loader().load(t,{context:"dataflow",response:Object(en.g)(e&&e.type)});try{r=n.parse(r,e)}catch(e){i=-2,n.warn("Data ingestion failed",t,e)}}catch(e){i=-1,n.warn("Loading failed",t,e)}return{data:r,status:i}},events:function(t,e,n,r){const i=this,a=An(n,r),o=function(t){t.dataflow=i;try{a.receive(t)}catch(t){i.error(t)}finally{i.run()}};let s;s="string"==typeof t&&"undefined"!=typeof document?document.querySelectorAll(t):He(t);const u=s.length;for(let t=0;t<u;++t)s[t].addEventListener(e,o);return a},on:function(t,e,n,r,i){return(t instanceof wn?Sn:En)(this,t,e,n,r,i),this},evaluate:async function(t,e,n){const r=this,i=[];if(r._pulse)return Mn(r);if(r._pending&&await r._pending,e&&await an(r,e),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const a=++r._clock;r._pulse=new Nn(r,a,t),r._touched.forEach(t=>r._enqueue(t,!0)),r._touched=rn(qe);let o,s,u,c=0;try{for(;r._heap.size()>0;)o=r._heap.pop(),o.rank===o.qrank?(s=o.run(r._getPulse(o,t)),s.then?s=await s:s.async&&(i.push(s.async),s=jn),s!==jn&&o._targets&&o._targets.forEach(t=>r._enqueue(t)),++c):r._enqueue(o,!0)}catch(t){r._heap.clear(),u=t}if(r._input={},r._pulse=null,r.debug("Pulse ".concat(a,": ").concat(c," operators")),u&&(r._postrun=[],r.error(u)),r._postrun.length){const t=r._postrun.sort((t,e)=>e.priority-t.priority);r._postrun=[];for(let e=0;e<t.length;++e)await an(r,t[e].callback)}return n&&await an(r,n),i.length&&Promise.all(i).then(t=>r.runAsync(null,()=>{t.forEach(t=>{try{t(r)}catch(t){r.error(t)}})})),r},run:function(t,e,n){return this._pulse?Mn(this):(this.evaluate(t,e,n),this)},runAsync:async function(t,e,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(r,r),this._running},runAfter:function(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(t){this.error(t)}},_enqueue:function(t,e){const n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))},_getPulse:function(t,e){const n=t.source,r=this._clock;return n&&Ge(n)?new In(this,r,n.map(t=>t.pulse),e):this._input[t.id]||function(t,e){if(e&&e.stamp===t.stamp)return e;t=t.fork(),e&&e!==jn&&(t.source=e.source);return t}(this._pulse,n&&n.pulse)}},Qe(Pn,wn,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then(t=>this.pulse=t):e!==t.StopPropagation&&(this.pulse=e),e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},transform(){}});const qn={};function Wn(t){const e=Un(t);return e&&e.Definition||null}function Un(t){return t=t&&t.toLowerCase(),Ze(qn,t)?qn[t]:null}function Vn(t,e,n){return t.fields=e||[],t.fname=n,t}function Gn(t){return null==t?null:t.fname}function Hn(t){return null==t?null:t.fields}function Xn(t){return 1===t.length?Kn(t[0]):Yn(t)}const Kn=t=>function(e){return e[t]},Yn=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Jn(t){throw Error(t)}function Zn(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||Jn("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&Jn("Access path missing closing bracket: "+t),o&&Jn("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function Qn(t,e,n){const r=Zn(t);return t=1===r.length?r[0]:t,Vn((n&&n.get||Xn)(r),[t],e||t)}Qn("id");const tr=Vn(t=>t,[],"identity"),er=Vn(()=>0,[],"zero"),nr=(Vn(()=>1,[],"one"),Vn(()=>!0,[],"true"));Vn(()=>!1,[],"false");var rr=Array.isArray;function ir(t){return t[t.length-1]}function ar(t){return null==t||""===t?null:+t}function or(t){return null!=t?rr(t)?t:[t]:[]}function sr(t){return"function"==typeof t}const ur=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e==e?-1:e!=e&&t==t?1:0),cr=(t,e)=>1===t.length?lr(t[0],e[0]):dr(t,e,t.length),lr=(t,e)=>function(n,r){return ur(t(n),t(r))*e},dr=(t,e,n)=>(e.push(0),function(r,i){let a,o=0,s=-1;for(;0===o&&++s<n;)a=t[s],o=ur(a(r),a(i));return o*e[s]});function fr(t){return sr(t)?t:()=>t}function hr(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function pr(t,e){let n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!=r);r=t[++o]);for(i=a=r;o<n;++o)r=t[o],null!=r&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!=r);r=e(t[++o]));for(i=a=r;o<n;++o)r=e(t[o]),null!=r&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]}const mr=Object.prototype.hasOwnProperty;function gr(t,e){return mr.call(t,e)}const br={};function yr(t){let e,n={};function r(t){return gr(n,t)&&n[t]!==br}const i={size:0,empty:0,object:n,has:r,get:t=>r(t)?n[t]:void 0,set(t,e){return r(t)||(++i.size,n[t]===br&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=br),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const a=n[i];a===br||e&&e(a)||(t[i]=a,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach(e=>{i.set(e,t[e])}),i}function vr(t,e,n){const r=t.prototype=Object.create(e.prototype);return r.constructor=t,hr(r,n)}var xr=n(145);function wr(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function kr(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function Or(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}var _r=function(t){return null===t?NaN:+t};function Ar(t,e,n){if(r=(t=Float64Array.from(function*(t,e){if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(yield e);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n))).length){if((e=+e)<=0||r<2)return kr(t);if(e>=1)return wr(t);var r,i=(r-1)*e,a=Math.floor(i),o=wr(function t(e,n,r=0,i=e.length-1,a=xr.a){for(;i>r;){if(i-r>600){const o=i-r+1,s=n-r+1,u=Math.log(o),c=.5*Math.exp(2*u/3),l=.5*Math.sqrt(u*c*(o-c)/o)*(s-o/2<0?-1:1);t(e,n,Math.max(r,Math.floor(n-s*c/o+l)),Math.min(i,Math.floor(n+(o-s)*c/o+l)),a)}const o=e[n];let s=r,u=i;for(Or(e,r,n),a(e[i],o)>0&&Or(e,r,i);s<u;){for(Or(e,s,u),++s,--u;a(e[s],o)<0;)++s;for(;a(e[u],o)>0;)--u}0===a(e[r],o)?Or(e,r,u):(++u,Or(e,u,i)),u<=n&&(r=u+1),n<=u&&(i=u-1)}return e}(t,a).subarray(0,a+1));return o+(kr(t.subarray(a+1))-o)*(i-a)}}function Cr(t,e,n=_r){if(r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t);return o+(+n(t[a+1],a+1,t)-o)*(i-a)}}var Er=function(t,e){return Ar(t,.5,e)};function*Sr(t,e){if(null==e)for(let e of t)null!=e&&""!==e&&(e=+e)>=e&&(yield e);else{let n=-1;for(let r of t)r=e(r,++n,t),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function jr(t,e,n){const r=Float64Array.from(Sr(t,n));return r.sort(xr.a),e.map(t=>Cr(r,t))}function Nr(t,e){return jr(t,[.25,.5,.75],e)}function Tr(t,e){const n=t.length,r=function(t,e){const n=function(t,e){let n,r=0,i=0,a=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(n=e-i,i+=n/++r,a+=n*(e-i));else{let o=-1;for(let s of t)null!=(s=e(s,++o,t))&&(s=+s)>=s&&(n=s-i,i+=n/++r,a+=n*(s-i))}if(r>1)return a/(r-1)}(t,e);return n?Math.sqrt(n):n}(t,e),i=Nr(t,e),a=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,a)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function Fr(t){const e=t.maxbins||20,n=t.base||10,r=Math.log(n),i=t.divide||[5,2];let a,o,s,u,c,l,d=t.extent[0],f=t.extent[1];const h=t.span||f-d||Math.abs(d)||1;if(t.step)a=t.step;else if(t.steps){for(u=h/e,c=0,l=t.steps.length;c<l&&t.steps[c]<u;++c);a=t.steps[Math.max(0,c-1)]}else{for(o=Math.ceil(Math.log(e)/r),s=t.minstep||0,a=Math.max(s,Math.pow(n,Math.round(Math.log(h)/r)-o));Math.ceil(h/a)>e;)a*=n;for(c=0,l=i.length;c<l;++c)u=a/i[c],u>=s&&h/u<=e&&(a=u)}u=Math.log(a);const p=u>=0?0:1+~~(-u/r),m=Math.pow(n,-p-1);return(t.nice||void 0===t.nice)&&(u=Math.floor(d/a+m)*a,d=d<u?u-a:u,f=Math.ceil(f/a)*a),{start:d,stop:f===d?d+a:f,step:a}}var Dr=Math.random;function Ir(t){Dr=t}function Mr(t,e,n,r){if(!t.length)return[void 0,void 0];const i=Float64Array.from(Sr(t,r)),a=i.length,o=e;let s,u,c,l;for(c=0,l=Array(o);c<o;++c){for(s=0,u=0;u<a;++u)s+=i[~~(Dr()*a)];l[c]=s/a}return l.sort(xr.a),[Ar(l,n/2),Ar(l,1-n/2)]}function $r(t,e,n,r){r=r||(t=>t);const i=t.length,a=new Float64Array(i);let o,s=0,u=1,c=r(t[0]),l=c,d=c+e;for(;u<i;++u){if(o=r(t[u]),o>=d){for(l=(c+l)/2;s<u;++s)a[s]=l;d=o+e,c=o}l=o}for(l=(c+l)/2;s<u;++s)a[s]=l;return n?function(t,e){const n=t.length;let r,i,a=0,o=1;for(;t[a]===t[o];)++o;for(;o<n;){for(r=o+1;t[o]===t[r];)++r;if(t[o]-t[o-1]<e){for(i=o+(a+r-o-o>>1);i<o;)t[i++]=t[o];for(;i>o;)t[i--]=t[a]}a=o,o=r}return t}(a,e+e/4):a}function Rr(t){return function(){return(t=(1103515245*t+12345)%2147483647)/2147483647}}function Br(t,e){let n,r,i;null==e&&(e=t,t=0);const a={min(t){return arguments.length?(n=t||0,i=r-n,a):n},max(t){return arguments.length?(r=t||0,i=r-n,a):r},sample:()=>n+Math.floor(i*Dr()),pdf:t=>t===Math.floor(t)&&t>=n&&t<r?1/i:0,cdf(t){const e=Math.floor(t);return e<n?0:e>=r?1:(e-n+1)/i},icdf:t=>t>=0&&t<=1?n-1+Math.floor(t*i):NaN};return a.min(t).max(e)}const zr=Math.sqrt(2*Math.PI),Lr=Math.SQRT2;let Pr=NaN;function qr(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,a=0;if(Pr==Pr)i=Pr,Pr=NaN;else{do{i=2*Dr()-1,a=2*Dr()-1,n=i*i+a*a}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,Pr=a*r}return t+i*e}function Wr(t,e,n){const r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*zr)}function Ur(t,e,n){const r=(t-(e=e||0))/(n=null==n?1:n),i=Math.abs(r);let a;if(i>37)a=0;else{const t=Math.exp(-i*i/2);let e;i<7.07106781186547?(e=.0352624965998911*i+.700383064443688,e=e*i+6.37396220353165,e=e*i+33.912866078383,e=e*i+112.079291497871,e=e*i+221.213596169931,e=e*i+220.206867912376,a=t*e,e=.0883883476483184*i+1.75566716318264,e=e*i+16.064177579207,e=e*i+86.7807322029461,e=e*i+296.564248779674,e=e*i+637.333633378831,e=e*i+793.826512519948,e=e*i+440.413735824752,a/=e):(e=i+.65,e=i+4/e,e=i+3/e,e=i+2/e,e=i+1/e,a=t/e/2.506628274631)}return r>0?1-a:a}function Vr(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*Lr*function(t){let e,n=-Math.log((1-t)*(1+t));n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0;return e*t}(2*t-1)}function Gr(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>qr(n,r),pdf:t=>Wr(t,n,r),cdf:t=>Ur(t,n,r),icdf:t=>Vr(t,n,r)};return i.mean(t).stdev(e)}function Hr(t,e){const n=Gr();let r=0;const i={data(n){return arguments.length?(t=n,r=n?n.length:0,i.bandwidth(e)):t},bandwidth(n){return arguments.length?(!(e=n)&&t&&(e=Tr(t)),i):e},sample:()=>t[~~(Dr()*r)]+e*n.sample(),pdf(i){let a=0,o=0;for(;o<r;++o)a+=n.pdf((i-t[o])/e);return a/e/r},cdf(i){let a=0,o=0;for(;o<r;++o)a+=n.cdf((i-t[o])/e);return a/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(t)}function Xr(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+qr()*e)}function Kr(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*zr*t)}function Yr(t,e,n){return Ur(Math.log(t),e,n)}function Jr(t,e,n){return Math.exp(Vr(t,e,n))}function Zr(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Xr(n,r),pdf:t=>Kr(t,n,r),cdf:t=>Yr(t,n,r),icdf:t=>Jr(t,n,r)};return i.mean(t).stdev(e)}function Qr(t,e){let n,r=0;const i={weights(t){return arguments.length?(n=function(t){const e=[];let n,i=0;for(n=0;n<r;++n)i+=e[n]=null==t[n]?1:+t[n];for(n=0;n<r;++n)e[n]/=i;return e}(e=t||[]),i):e},distributions(n){return arguments.length?(n?(r=n.length,t=n):(r=0,t=[]),i.weights(e)):t},sample(){const e=Dr();let i=t[r-1],a=n[0],o=0;for(;o<r-1;a+=n[++o])if(e<a){i=t[o];break}return i.sample()},pdf(e){let i=0,a=0;for(;a<r;++a)i+=n[a]*t[a].pdf(e);return i},cdf(e){let i=0,a=0;for(;a<r;++a)i+=n[a]*t[a].cdf(e);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(t).weights(e)}function ti(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*Dr()}function ei(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function ni(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function ri(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function ii(t,e){let n,r;const i={min(t){return arguments.length?(n=t||0,i):n},max(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>ti(n,r),pdf:t=>ei(t,n,r),cdf:t=>ni(t,n,r),icdf:t=>ri(t,n,r)};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)}function ai(t,e,n,r){const i=r-t*t,a=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-a*t,a]}function oi(t,e,n,r){t=t.filter(t=>{let r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i}),r&&t.sort((t,n)=>e(t)-e(n));const i=t.length,a=new Float64Array(i),o=new Float64Array(i);let s,u,c,l=0,d=0,f=0;for(c of t)a[l]=s=+e(c),o[l]=u=+n(c),++l,d+=(s-d)/l,f+=(u-f)/l;for(l=0;l<i;++l)a[l]-=d,o[l]-=f;return[a,o,d,f]}function si(t,e,n,r){let i,a,o=-1;for(const s of t)i=e(s),a=n(s),null!=i&&(i=+i)>=i&&null!=a&&(a=+a)>=a&&r(i,a,++o)}function ui(t,e,n,r,i){let a=0,o=0;return si(t,e,n,(t,e)=>{const n=e-i(t),s=e-r;a+=n*n,o+=s*s}),1-a/o}function ci(t,e,n){let r=0,i=0,a=0,o=0,s=0;si(t,e,n,(t,e)=>{++s,r+=(t-r)/s,i+=(e-i)/s,a+=(t*e-a)/s,o+=(t*t-o)/s});const u=ai(r,i,a,o),c=t=>u[0]+u[1]*t;return{coef:u,predict:c,rSquared:ui(t,e,n,i,c)}}function li(t,e,n){let r=0,i=0,a=0,o=0,s=0;si(t,e,n,(t,e)=>{++s,t=Math.log(t),r+=(t-r)/s,i+=(e-i)/s,a+=(t*e-a)/s,o+=(t*t-o)/s});const u=ai(r,i,a,o),c=t=>u[0]+u[1]*Math.log(t);return{coef:u,predict:c,rSquared:ui(t,e,n,i,c)}}function di(t,e,n){const[r,i,a,o]=oi(t,e,n);let s,u,c,l=0,d=0,f=0,h=0,p=0;si(t,e,n,(t,e)=>{s=r[p++],u=Math.log(e),c=s*e,l+=(e*u-l)/p,d+=(c-d)/p,f+=(c*u-f)/p,h+=(s*c-h)/p});const[m,g]=ai(d/o,l/o,f/o,h/o),b=t=>Math.exp(m+g*(t-a));return{coef:[Math.exp(m-g*a),g],predict:b,rSquared:ui(t,e,n,o,b)}}function fi(t,e,n){let r=0,i=0,a=0,o=0,s=0,u=0;si(t,e,n,(t,e)=>{const n=Math.log(t),c=Math.log(e);++u,r+=(n-r)/u,i+=(c-i)/u,a+=(n*c-a)/u,o+=(n*n-o)/u,s+=(e-s)/u});const c=ai(r,i,a,o),l=t=>c[0]*Math.pow(t,c[1]);return c[0]=Math.exp(c[0]),{coef:c,predict:l,rSquared:ui(t,e,n,s,l)}}function hi(t,e,n){const[r,i,a,o]=oi(t,e,n),s=r.length;let u,c,l,d,f=0,h=0,p=0,m=0,g=0;for(u=0;u<s;)c=r[u],l=i[u++],d=c*c,f+=(d-f)/u,h+=(d*c-h)/u,p+=(d*d-p)/u,m+=(c*l-m)/u,g+=(d*l-g)/u;const b=p-f*f,y=f*b-h*h,v=(g*f-m*h)/y,x=(m*b-g*h)/y,w=-v*f,k=t=>v*(t-=a)*t+x*t+w+o;return{coef:[w-x*a+v*a*a+o,x-2*v*a,v],predict:k,rSquared:ui(t,e,n,o,k)}}function pi(t,e,n,r){if(1===r)return ci(t,e,n);if(2===r)return hi(t,e,n);const[i,a,o,s]=oi(t,e,n),u=i.length,c=[],l=[],d=r+1;let f,h,p,m,g;for(f=0;f<d;++f){for(p=0,m=0;p<u;++p)m+=Math.pow(i[p],f)*a[p];for(c.push(m),g=new Float64Array(d),h=0;h<d;++h){for(p=0,m=0;p<u;++p)m+=Math.pow(i[p],f+h);g[h]=m}l.push(g)}l.push(c);const b=function(t){const e=t.length-1,n=[];let r,i,a,o,s;for(r=0;r<e;++r){for(o=r,i=r+1;i<e;++i)Math.abs(t[r][i])>Math.abs(t[r][o])&&(o=i);for(a=r;a<e+1;++a)s=t[a][r],t[a][r]=t[a][o],t[a][o]=s;for(i=r+1;i<e;++i)for(a=e;a>=r;a--)t[a][i]-=t[a][r]*t[r][i]/t[r][r]}for(i=e-1;i>=0;--i){for(s=0,a=i+1;a<e;++a)s+=t[a][i]*n[a];n[i]=(t[e][i]-s)/t[i][i]}return n}(l),y=t=>{t-=o;let e=s+b[0]+b[1]*t+b[2]*t*t;for(f=3;f<d;++f)e+=b[f]*Math.pow(t,f);return e};return{coef:mi(d,b,-o,s),predict:y,rSquared:ui(t,e,n,s,y)}}function mi(t,e,n,r){const i=Array(t);let a,o,s,u;for(a=0;a<t;++a)i[a]=0;for(a=t-1;a>=0;--a)for(s=e[a],u=1,i[a]+=s,o=1;o<=a;++o)u*=(a+1-o)/o,i[a-o]+=s*Math.pow(n,o)*u;return i[0]+=r,i}function gi(t,e,n,r){const[i,a,o,s]=oi(t,e,n,!0),u=i.length,c=Math.max(2,~~(r*u)),l=new Float64Array(u),d=new Float64Array(u),f=new Float64Array(u).fill(1);for(let t=-1;++t<=2;){const e=[0,c-1];for(let t=0;t<u;++t){const n=i[t],r=e[0],o=e[1],s=n-i[r]>i[o]-n?r:o;let u=0,c=0,h=0,p=0,m=0;const g=1/Math.abs(i[s]-n||1);for(let t=r;t<=o;++t){const e=i[t],r=a[t],o=bi(Math.abs(n-e)*g)*f[t],s=e*o;u+=o,c+=s,h+=r*o,p+=r*s,m+=e*s}const[b,y]=ai(c/u,h/u,p/u,m/u);l[t]=b+y*n,d[t]=Math.abs(a[t]-l[t]),yi(i,t+1,e)}if(2===t)break;const n=Er(d);if(Math.abs(n)<1e-12)break;for(let t,e,r=0;r<u;++r)t=d[r]/(6*n),f[r]=t>=1?1e-12:(e=1-t*t)*e}return function(t,e,n,r){const i=t.length,a=[];let o,s=0,u=0,c=[];for(;s<i;++s)o=t[s]+n,c[0]===o?c[1]+=(e[s]-c[1])/++u:(u=0,c[1]+=r,c=[o,e[s]],a.push(c));return c[1]+=r,a}(i,l,o,s)}function bi(t){return(t=1-t*t*t)*t*t}function yi(t,e,n){const r=t[e];let i=n[0],a=n[1]+1;if(!(a>=t.length))for(;e>i&&t[a]-r<=r-t[i];)n[0]=++i,n[1]=a,++a}const vi=.1*Math.PI/180;function xi(t,e,n,r){n=n||25,r=Math.max(n,r||200);const i=e=>[e,t(e)],a=e[0],o=e[1],s=o-a,u=s/r,c=[i(a)],l=[];if(n===r){for(let t=1;t<r;++t)c.push(i(a+t/n*s));return c.push(i(o)),c}l.push(i(o));for(let t=n;--t>0;)l.push(i(a+t/n*s));let d=c[0],f=l[l.length-1];for(;f;){const t=i((d[0]+f[0])/2);t[0]-d[0]>=u&&wi(d,t,f)>vi?l.push(t):(d=f,c.push(f),l.pop()),f=l[l.length-1]}return c}function wi(t,e,n){const r=Math.atan2(n[1]-t[1],n[0]-t[0]),i=Math.atan2(e[1]-t[1],e[0]-t[0]);return Math.abs(r-i)}var ki=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a},Oi=n(229),_i=n(20);function Ai(t){return t&&t.length?1===t.length?t[0]:(e=t,t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}):function(){return""};var e}function Ci(t,e,n){return n||t+(e?"_"+e:"")}const Ei=()=>{},Si={init:Ei,add:Ei,rem:Ei,idx:0},ji={values:{init:t=>t.cell.store=!0,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.sum,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:void 0,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:void 0,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:void 0,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):void 0,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:void 0,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):void 0,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=void 0,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{(e<t.min||void 0===t.min)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)},req:["values"],idx:4},max:{init:t=>t.max=void 0,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{(e>t.max||void 0===t.max)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)},req:["values"],idx:4},argmin:{init:t=>t.argmin=void 0,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{e<t.min&&(t.argmin=n)},rem:(t,e)=>{e<=t.min&&(t.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=void 0,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{e>t.max&&(t.argmax=n)},rem:(t,e)=>{e>=t.max&&(t.argmax=void 0)},req:["max","values"],idx:3}},Ni=Object.keys(ji);function Ti(t,e){return ji[t](e)}function Fi(t,e){return t.idx-e.idx}function Di(){this.valid=0,this.missing=0,this._ops.forEach(t=>t.init(this))}function Ii(t,e){null!=t&&""!==t?t==t&&(++this.valid,this._ops.forEach(n=>n.add(this,t,e))):++this.missing}function Mi(t,e){null!=t&&""!==t?t==t&&(--this.valid,this._ops.forEach(n=>n.rem(this,t,e))):--this.missing}function $i(t){return this._out.forEach(e=>t[e.out]=e.value(this)),t}function Ri(t,e){const n=e||tr,r=function(t){const e={};t.forEach(t=>e[t.name]=t);const n=t=>{t.req&&t.req.forEach(t=>{e[t]||n(e[t]=ji[t]())})};return t.forEach(n),Object.values(e).sort(Fi)}(t),i=t.slice().sort(Fi);function a(t){this._ops=r,this._out=i,this.cell=t,this.init()}return a.prototype.init=Di,a.prototype.add=Ii,a.prototype.rem=Mi,a.prototype.set=$i,a.prototype.get=n,a.fields=t.map(t=>t.out),a}function Bi(t){this._key=t?Qn(t):cn,this.reset()}Ni.forEach(t=>{ji[t]=function(t,e){return n=>hr({name:t,out:n||t},Si,e)}(t,ji[t])});const zi=Bi.prototype;function Li(t){Pn.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}zi.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},zi.add=function(t){this._add.push(t)},zi.rem=function(t){this._rem.push(t)},zi.values=function(){if(this._get=null,0===this._rem.length)return this._add;const t=this._add,e=this._rem,n=this._key,r=t.length,i=e.length,a=Array(r-i),o={};let s,u,c;for(s=0;s<i;++s)o[n(e[s])]=1;for(s=0,u=0;s<r;++s)o[n(c=t[s])]?o[n(c)]=0:a[u++]=c;return this._rem=[],this._add=a},zi.distinct=function(t){const e=this.values(),n={};let r,i=e.length,a=0;for(;--i>=0;)r=t(e[i])+"",gr(n,r)||(n[r]=1,++a);return a},zi.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=function(t,e){const n=t.length;let r,i,a,o,s,u=-1;if(null==e){for(;++u<n;)if(i=t[u],null!=i&&i>=i){r=a=i;break}if(u===n)return[-1,-1];for(o=s=u;++u<n;)i=t[u],null!=i&&(r>i&&(r=i,o=u),a<i&&(a=i,s=u))}else{for(;++u<n;)if(i=e(t[u],u,t),null!=i&&i>=i){r=a=i;break}if(u===n)return[-1,-1];for(o=s=u;++u<n;)i=e(t[u],u,t),null!=i&&(r>i&&(r=i,o=u),a<i&&(a=i,s=u))}return[o,s]}(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext},zi.argmin=function(t){return this.extent(t)[0]||{}},zi.argmax=function(t){return this.extent(t)[1]||{}},zi.min=function(t){const e=this.extent(t)[0];return null!=e?t(e):void 0},zi.max=function(t){const e=this.extent(t)[1];return null!=e?t(e):void 0},zi.quartile=function(t){return this._get===t&&this._q||(this._q=Nr(this.values(),t),this._get=t),this._q},zi.q1=function(t){return this.quartile(t)[0]},zi.q2=function(t){return this.quartile(t)[1]},zi.q3=function(t){return this.quartile(t)[2]},zi.ci=function(t){return this._get===t&&this._ci||(this._ci=Mr(this.values(),1e3,.05,t),this._get=t),this._ci},zi.ci0=function(t){return this.ci(t)[0]},zi.ci1=function(t){return this.ci(t)[1]},Li.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Ni},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},vr(Li,Pn,{transform(t,e){const n=this,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.modified();return n.stamp=r.stamp,n.value&&(i||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(t):{},e.visit(e.SOURCE,t=>n.add(t))):(n.value=n.value||n.init(t),e.visit(e.REM,t=>n.rem(t)),e.visit(e.ADD,t=>n.add(t))),r.modifies(n._outputs),n._drop=!1!==t.drop,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),e.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const t=this,e=t.value,n=t._dnames,r=n.map(()=>({})),i=n.length;function a(t){let e,a,o,s;for(e in t)for(o=t[e].tuple,a=0;a<i;++a)r[a][s=o[n[a]]]=s}a(t._prev),a(e),function a(o,s,u){const c=n[u],l=r[u++];for(const n in l){const r=o?o+"|"+n:n;s[c]=l[n],u<i?a(r,s,u):e[r]||t.cell(r,s)}}("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],r={};function i(t){const n=or(Hn(t)),i=n.length;let a,o=0;for(;o<i;++o)r[a=n[o]]||(r[a]=1,e.push(a))}this._dims=or(t.groupby),this._dnames=this._dims.map(t=>{const e=Gn(t);return i(t),n.push(e),e}),this.cellkey=t.key?t.key:Ai(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const a=t.fields||[null],o=t.ops||["count"],s=t.as||[],u=a.length,c={};let l,d,f,h,p,m;for(u!==o.length&&Jn("Unmatched number of fields and aggregate ops."),m=0;m<u;++m)l=a[m],d=o[m],null==l&&"count"!==d&&Jn("Null aggregate field specified."),h=Gn(l),p=Ci(d,h,s[m]),n.push(p),"count"!==d?(f=c[h],f||(i(l),f=c[h]=[],f.field=l,this._measures.push(f)),"count"!==d&&(this._countOnly=!1),f.push(Ti(d,p))):this._counts.push(p);return this._measures=this._measures.map(t=>Ri(t,t.field)),{}},cellkey:Ai(),cell(t,e){let n=this.value[t];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){const t=this._measures,e=t.length;n.agg=Array(e);for(let r=0;r<e;++r)n.agg[r]=new t[r](n)}return n.store&&(n.data=new Bi),n},newtuple(t,e){const n=this._dnames,r=this._dims,i=r.length,a={};for(let e=0;e<i;++e)a[n[e]]=r[e](t);return e?pn(e.tuple,a):dn(a)},clean(){const t=this.value;for(const e in t)0===t[e].num&&delete t[e]},add(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(t);const r=n.agg;for(let e=0,n=r.length;e<n;++e)r[e].add(r[e].get(t),t)},rem(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(t);const r=n.agg;for(let e=0,n=r.length;e<n;++e)r[e].rem(r[e].get(t),t)},celltuple(t){const e=t.tuple,n=this._counts;t.store&&t.data.values();for(let r=0,i=n.length;r<i;++r)e[n[r]]=t.num;if(!this._countOnly){const n=t.agg;for(let t=0,r=n.length;t<r;++t)n[t].set(e)}return e},changes(t){const e=this._adds,n=this._mods,r=this._prev,i=this._drop,a=t.add,o=t.rem,s=t.mod;let u,c,l,d;if(r)for(c in r)u=r[c],i&&!u.num||o.push(u.tuple);for(l=0,d=this._alen;l<d;++l)a.push(this.celltuple(e[l])),e[l]=null;for(l=0,d=this._mlen;l<d;++l)u=n[l],(0===u.num&&i?o:s).push(this.celltuple(u)),n[l]=null;return this._alen=this._mlen=0,this._prev=null,t}});function Pi(t){Pn.call(this,null,t)}function qi(t,e,n){const r=t;let i=e||[],a=n||[],o={},s=0;return{add:t=>a.push(t),remove:t=>o[r(t)]=++s,size:()=>i.length,data:(t,e)=>(s&&(i=i.filter(t=>!o[r(t)]),o={},s=0),e&&t&&i.sort(t),a.length&&(i=t?function(t,e,n,r){const i=e.length,a=n.length;if(!a)return e;if(!i)return n;const o=r||new e.constructor(i+a);let s=0,u=0,c=0;for(;s<i&&u<a;++c)o[c]=t(e[s],n[u])>0?n[u++]:e[s++];for(;s<i;++s,++c)o[c]=e[s];for(;u<a;++u,++c)o[c]=n[u];return o}(t,i,a.sort(t)):i.concat(a),a=[]),i)}}function Wi(t){Pn.call(this,[],t)}function Ui(t){wn.call(this,null,Vi,t)}function Vi(t){return this.value&&!t.modified()?this.value:function(t,e,n){n=n||{},e=or(e)||[];const r=[],i=[],a={},o=n.comparator||cr;return or(t).forEach((t,o)=>{null!=t&&(r.push("descending"===e[o]?-1:1),i.push(t=sr(t)?t:Qn(t,null,n)),(Hn(t)||[]).forEach(t=>a[t]=1))}),0===i.length?null:Vn(o(i,r),Object.keys(a))}(t.fields,t.orders)}function Gi(t){Pn.call(this,null,t)}function Hi(t){Pn.call(this,null,t)}Pi.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},vr(Pi,Pn,{transform(t,e){const n=!1!==t.interval,r=this._bins(t),i=r.start,a=r.step,o=t.as||["bin0","bin1"],s=o[0],u=o[1];let c;return c=t.modified()?(e=e.reflow(!0)).SOURCE:e.modified(Hn(t.field))?e.ADD_MOD:e.ADD,e.visit(c,n?t=>{const e=r(t);t[s]=e,t[u]=null==e?null:i+a*(1+(e-i)/a)}:t=>t[s]=r(t)),e.modifies(n?o:s)},_bins(t){if(this.value&&!t.modified())return this.value;const e=t.field,n=Fr(t),r=n.step;let i,a,o=n.start,s=o+Math.ceil((n.stop-o)/r)*r;null!=(i=t.anchor)&&(a=i-(o+r*Math.floor((i-o)/r)),o+=a,s+=a);const u=function(t){let n=ar(e(t));return null==n?null:n<o?-1/0:n>s?1/0:(n=Math.max(o,Math.min(n,s-r)),o+r*Math.floor(1e-14+(n-o)/r))};return u.start=o,u.stop=n.stop,u.step=r,this.value=Vn(u,Hn(e),t.name||"bin_"+Gn(e))}}),Wi.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},vr(Wi,Pn,{transform(t,e){const n=e.fork(e.ALL),r=qi(cn,this.value,n.materialize(n.ADD).add),i=t.sort,a=e.changed()||i&&(t.modified("sort")||e.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(a),this.value=n.source=r.data(mn(i),a),e.source&&e.source.root&&(this.value.root=e.source.root),n}}),vr(Ui,wn),Gi.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},vr(Gi,Pn,{transform(t,e){const n=e=>n=>{for(var r,i=function(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase()}return t.match(n)}(s(n),t.case,a)||[],u=0,c=i.length;u<c;++u)o.test(r=i[u])||e(r)},r=this._parameterCheck(t,e),i=this._counts,a=this._match,o=this._stop,s=t.field,u=t.as||["text","count"],c=n(t=>i[t]=1+(i[t]||0)),l=n(t=>i[t]-=1);return r?e.visit(e.SOURCE,c):(e.visit(e.ADD,c),e.visit(e.REM,l)),this._finish(e,u)},_parameterCheck(t,e){let n=!1;return!t.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),!t.modified("pattern")&&this._match||(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(t,e){const n=this._counts,r=this._tuples||(this._tuples={}),i=e[0],a=e[1],o=t.fork(t.NO_SOURCE|t.NO_FIELDS);let s,u,c;for(s in n)u=r[s],c=n[s]||0,!u&&c?(r[s]=u=dn({}),u[i]=s,u[a]=c,o.add.push(u)):0===c?(u&&o.rem.push(u),n[s]=null,r[s]=null):u[a]!==c&&(u[a]=c,o.mod.push(u));return o.modifies(e)}}),Hi.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},vr(Hi,Pn,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.as||["a","b"],i=r[0],a=r[1],o=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter");let s=this.value;return o?(s&&(n.rem=s),s=e.materialize(e.SOURCE).source,n.add=this.value=function(t,e,n,r){for(var i,a,o=[],s={},u=t.length,c=0;c<u;++c)for(s[e]=a=t[c],i=0;i<u;++i)s[n]=t[i],r(s)&&(o.push(dn(s)),(s={})[e]=a);return o}(s,i,a,t.filter||nr)):n.mod=s,n.source=this.value,n.modifies(r)}});const Xi={kde:Hr,mixture:Qr,normal:Gr,lognormal:Zr,uniform:ii};function Ki(t){Pn.call(this,null,t)}const Yi=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Ji={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Yi},{name:"weights",type:"number",array:!0}]};function Zi(t,e){return t?t.map((t,n)=>e[n]||Gn(t)):null}function Qi(t,e,n){const r=[],i=t=>t(u);let a,o,s,u,c,l;if(null==e)r.push(t.map(n));else for(a={},o=0,s=t.length;o<s;++o)u=t[o],c=e.map(i),l=a[c],l||(a[c]=l=[],l.dims=c,r.push(l)),l.push(n(u));return r}Ki.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Yi.concat(Ji)},{name:"as",type:"string",array:!0,default:["value","density"]}]},vr(Ki,Pn,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=function t(e,n){const r=e.function;gr(Xi,r)||Jn("Unknown distribution function: "+r);const i=Xi[r]();for(const r in e)"field"===r?i.data((e.from||n()).map(e[r])):"distributions"===r?i[r](e[r].map(e=>t(e,n))):"function"==typeof i[r]&&i[r](e[r]);return i}(t.distribution,function(t){return()=>t.materialize(t.SOURCE).source}(e)),i=t.steps||t.minsteps||25,a=t.steps||t.maxsteps||200;let o=t.method||"pdf";"pdf"!==o&&"cdf"!==o&&Jn("Invalid density method: "+o),t.extent||r.data||Jn("Missing density extent parameter."),o=r[o];const s=t.as||["value","density"],u=xi(o,t.extent||pr(r.data()),i,a).map(t=>{const e={};return e[s[0]]=t[0],e[s[1]]=t[1],dn(e)});this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function ta(t){Pn.call(this,null,t)}ta.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};const ea=(t,e)=>{return((n=pr(t,e))&&ir(n)-n[0]||0)/30;var n};function na(t){wn.call(this,null,ra,t),this.modified(!0)}function ra(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:Vn(n=>e(n,t),Hn(e),Gn(e))}function ia(t){Pn.call(this,[void 0,void 0],t)}function aa(t,e){wn.call(this,t),this.parent=e,this.count=0}function oa(t){Pn.call(this,{},t),this._keys=yr();const e=this._targets=[];e.active=0,e.forEach=t=>{for(let n=0,r=e.active;n<r;++n)t(e[n],n,e)}}function sa(t){wn.call(this,null,ua,t)}function ua(t){return this.value&&!t.modified()?this.value:rr(t.name)?or(t.name).map(t=>Qn(t)):Qn(t.name,t.as)}function ca(t){Pn.call(this,yr(),t)}function la(t){Pn.call(this,[],t)}function da(t){Pn.call(this,[],t)}function fa(t){Pn.call(this,null,t)}function ha(t){Pn.call(this,[],t)}vr(ta,Pn,{transform(t,e){if(this.value&&!t.modified()&&!e.changed())return e;const n=e.materialize(e.SOURCE).source,r=Qi(e.source,t.groupby,tr),i=t.smooth||!1,a=t.field,o=t.step||ea(n,a),s=mn((t,e)=>a(t)-a(e)),u=t.as||"bin",c=r.length;let l,d=1/0,f=-1/0,h=0;for(;h<c;++h){const t=r[h].sort(s);l=-1;for(const e of $r(t,o,i,a))e<d&&(d=e),e>f&&(f=e),t[++l][u]=e}return this.value={start:d,stop:f,step:o},e.reflow(!0).modifies(u)}}),vr(na,wn),ia.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},vr(ia,Pn,{transform(t,e){const n=this.value,r=t.field,i=e.changed()||e.modified(r.fields)||t.modified("field");let a=n[0],o=n[1];if((i||null==a)&&(a=1/0,o=-1/0),e.visit(i?e.SOURCE:e.ADD,t=>{const e=ar(r(t));null!=e&&(e<a&&(a=e),e>o&&(o=e))}),!Number.isFinite(a)||!Number.isFinite(o)){let t=Gn(r);t&&(t=' for field "'.concat(t,'"')),e.dataflow.warn("Infinite extent".concat(t,": [").concat(a,", ").concat(o,"]")),a=o=void 0}this.value=[a,o]}}),vr(aa,wn,{connect(t){return this.detachSubflow=t.detachSubflow,this.targets().add(t),t.source=this},add(t){this.count+=1,this.value.add.push(t)},rem(t){this.count-=1,this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}}),vr(oa,Pn,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,r){const i=this.value;let a,o,s=gr(i,t)&&i[t];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(o=r||(o=this._group[t])&&o.tuple,a=n.dataflow,s=new aa(n.fork(n.NO_SOURCE),this),a.add(s).connect(e(a,t,o)),i[t]=s,this.activate(s)),s},clean(){const t=this.value;for(const e in t)if(0===t[e].count){const n=t[e].detachSubflow;n&&n(),delete t[e]}},initTargets(){const t=this._targets,e=t.length;for(let n=0;n<e&&null!=t[n];++n)t[n]=null;t.active=0},transform(t,e){const n=e.dataflow,r=t.key,i=t.subflow,a=this._keys,o=t.modified("key"),s=t=>this.subflow(t,i,e);return this._group=t.group||{},this.initTargets(),e.visit(e.REM,t=>{const e=cn(t),n=a.get(e);void 0!==n&&(a.delete(e),s(n).rem(t))}),e.visit(e.ADD,t=>{const e=r(t);a.set(cn(t),e),s(e).add(t)}),o||e.modified(r.fields)?e.visit(e.MOD,t=>{const e=cn(t),n=a.get(e),i=r(t);n===i?s(i).mod(t):(a.set(e,i),s(n).rem(t),s(i).add(t))}):e.changed(e.MOD)&&e.visit(e.MOD,t=>{s(a.get(cn(t))).mod(t)}),o&&e.visit(e.REFLOW,t=>{const e=cn(t),n=a.get(e),i=r(t);n!==i&&(a.set(e,i),s(n).rem(t),s(i).add(t))}),e.clean()?n.runAfter(()=>{this.clean(),a.clean()}):a.empty>n.cleanThreshold&&n.runAfter(a.clean),e}}),vr(sa,wn),ca.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},vr(ca,Pn,{transform(t,e){const n=e.dataflow,r=this.value,i=e.fork(),a=i.add,o=i.rem,s=i.mod,u=t.expr;let c=!0;function l(e){const n=cn(e),i=u(e,t),l=r.get(n);i&&l?(r.delete(n),a.push(e)):i||l?c&&i&&!l&&s.push(e):(r.set(n,1),o.push(e))}return e.visit(e.REM,t=>{const e=cn(t);r.has(e)?r.delete(e):o.push(t)}),e.visit(e.ADD,e=>{u(e,t)?a.push(e):r.set(cn(e),1)}),e.visit(e.MOD,l),t.modified()&&(c=!1,e.visit(e.REFLOW,l)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),la.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},vr(la,Pn,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=Zi(r,t.as||[]),a=t.index||null,o=i.length;return n.rem=this.value,e.visit(e.SOURCE,t=>{const e=r.map(e=>e(t)),s=e.reduce((t,e)=>Math.max(t,e.length),0);let u,c,l,d=0;for(;d<s;++d){for(c=fn(t),u=0;u<o;++u)c[i[u]]=null==(l=e[u][d])?null:l;a&&(c[a]=d),n.add.push(c)}}),this.value=n.source=n.add,a&&n.modifies(a),n.modifies(i)}}),da.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},vr(da,Pn,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=r.map(Gn),a=t.as||["key","value"],o=a[0],s=a[1],u=r.length;return n.rem=this.value,e.visit(e.SOURCE,t=>{for(let e,a=0;a<u;++a)e=fn(t),e[o]=i[a],e[s]=r[a](t),n.add.push(e)}),this.value=n.source=n.add,n.modifies(a)}}),fa.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},vr(fa,Pn,{transform(t,e){const n=t.expr,r=t.as,i=t.modified(),a=t.initonly?e.ADD:i?e.SOURCE:e.modified(n.fields)||e.modified(r)?e.ADD_MOD:e.ADD;return i&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(a,e=>e[r]=n(e,t))}}),vr(ha,Pn,{transform(t,e){const n=e.fork(e.ALL),r=t.generator;let i,a,o,s=this.value,u=t.size-s.length;if(u>0){for(i=[];--u>=0;)i.push(o=dn(r(t))),s.push(o);n.add=n.add.length?n.materialize(n.ADD).add.concat(i):i}else a=s.slice(0,-u),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,s=s.slice(-u);return n.source=this.value=s,n}});const pa={value:"value",median:Er,mean:function(t,e){let n=0,r=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(++n,r+=e);else{let i=-1;for(let a of t)null!=(a=e(a,++i,t))&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n},min:kr,max:wr},ma=[];function ga(t){Pn.call(this,[],t)}function ba(t){Li.call(this,t)}function ya(t){Pn.call(this,null,t)}function va(t){wn.call(this,null,xa,t)}function xa(t){return this.value&&!t.modified()?this.value:function(t,e,n){t&&(t=e?or(t).map(t=>t.replace(/\\(.)/g,"$1")):or(t));const r=t&&t.length,i=n&&n.get||Xn,a=t=>i(e?[t]:Zn(t));let o;if(r)if(1===r){const e=a(t[0]);o=function(t){return""+e(t)}}else{const e=t.map(a);o=function(t){let n=""+e[0](t),i=0;for(;++i<r;)n+="|"+e[i](t);return n}}else o=function(){return""};return Vn(o,t,"key")}(t.fields,t.flat)}function wa(t){Pn.call(this,[],t),this._pending=null}function ka(t,e,n){n.forEach(dn);const r=e.fork(e.NO_FIELDS&e.NO_SOURCE);return r.rem=t.value,t.value=r.source=r.add=n,t._pending=null,r.rem.length&&r.clean(!0),r}function Oa(t){Pn.call(this,{},t)}function _a(t){wn.call(this,null,Aa,t)}function Aa(t){if(this.value&&!t.modified())return this.value;const e=t.extents,n=e.length;let r,i,a=1/0,o=-1/0;for(r=0;r<n;++r)i=e[r],i[0]<a&&(a=i[0]),i[1]>o&&(o=i[1]);return[a,o]}function Ca(t){wn.call(this,null,Ea,t)}function Ea(t){return this.value&&!t.modified()?this.value:t.values.reduce((t,e)=>t.concat(e),[])}function Sa(t){Pn.call(this,null,t)}function ja(t){Li.call(this,t)}function Na(t){oa.call(this,t)}function Ta(t){Pn.call(this,null,t)}function Fa(t){Pn.call(this,null,t)}function Da(t){Pn.call(this,null,t)}ga.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},vr(ga,Pn,{transform(t,e){var n,r,i,a,o,s,u,c,l,d,f=e.fork(e.ALL),h=function(t){var e,n=t.method||pa.value;if(null!=pa[n])return n===pa.value?(e=void 0!==t.value?t.value:0,()=>e):pa[n];Jn("Unrecognized imputation method: "+n)}(t),p=function(t){const e=t.field;return t=>t?e(t):NaN}(t),m=Gn(t.field),g=Gn(t.key),b=(t.groupby||[]).map(Gn),y=function(t,e,n,r){var i,a,o,s,u,c,l,d,f=t=>t(d),h=[],p=r?r.slice():[],m={},g={};for(p.forEach((t,e)=>m[t]=e+1),s=0,l=t.length;s<l;++s)d=t[s],c=n(d),u=m[c]||(m[c]=p.push(c)),a=(i=e?e.map(f):ma)+"",(o=g[a])||(o=g[a]=[],h.push(o),o.values=i),o[u-1]=d;return h.domain=p,h}(e.source,t.groupby,t.key,t.keyvals),v=[],x=this.value,w=y.domain.length;for(o=0,c=y.length;o<c;++o)for(i=(n=y[o]).values,r=NaN,u=0;u<w;++u)if(null==n[u]){for(a=y.domain[u],d={_impute:!0},s=0,l=i.length;s<l;++s)d[b[s]]=i[s];d[g]=a,d[m]=Number.isNaN(r)?r=h(n,p):r,v.push(dn(d))}return v.length&&(f.add=f.materialize(f.ADD).add.concat(v)),x.length&&(f.rem=f.materialize(f.REM).rem.concat(x)),this.value=v,f}}),ba.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Ni},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},vr(ba,Li,{transform(t,e){const n=this,r=t.modified();let i;return n.value&&(r||e.modified(n._inputs,!0))?(i=n.value=r?n.init(t):{},e.visit(e.SOURCE,t=>n.add(t))):(i=n.value=n.value||this.init(t),e.visit(e.REM,t=>n.rem(t)),e.visit(e.ADD,t=>n.add(t))),n.changes(),e.visit(e.SOURCE,t=>{hr(t,i[n.cellkey(t)].tuple)}),e.reflow(r).modifies(this._outputs)},changes(){const t=this._adds,e=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(t[n]),t[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(e[n]),e[n]=null;this._alen=this._mlen=0}}),ya.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},vr(ya,Pn,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=Qi(r,t.groupby,t.field),a=(t.groupby||[]).map(Gn),o=t.bandwidth,s=t.cumulative?"cdf":"pdf",u=t.as||["value","density"],c=[];let l=t.extent,d=t.steps||t.minsteps||25,f=t.steps||t.maxsteps||200;"pdf"!==s&&"cdf"!==s&&Jn("Invalid density method: "+s),"shared"===t.resolve&&(l||(l=pr(r,t.field)),d=f=t.steps||f),i.forEach(e=>{const n=Hr(e,o)[s],r=t.counts?e.length:1;xi(n,l||pr(e),d,f).forEach(t=>{const n={};for(let t=0;t<a.length;++t)n[a[t]]=e.dims[t];n[u[0]]=t[0],n[u[1]]=t[1]*r,c.push(dn(n))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}}),vr(va,wn),vr(wa,Pn,{transform(t,e){const n=e.dataflow;if(this._pending)return ka(this,e,this._pending);if(function(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}(t))return e.StopPropagation;if(t.values)return ka(this,e,n.parse(t.values,t.format));if(t.async){return{async:n.request(t.url,t.format).then(t=>(this._pending=or(t.data),t=>t.touch(this)))}}return n.request(t.url,t.format).then(t=>ka(this,e,or(t.data)))}}),Oa.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},vr(Oa,Pn,{transform(t,e){const n=t.fields,r=t.index,i=t.values,a=null==t.default?null:t.default,o=t.modified(),s=n.length;let u,c,l,d=o?e.SOURCE:e.ADD,f=e,h=t.as;return i?(c=i.length,s>1&&!h&&Jn('Multi-field lookup requires explicit "as" parameter.'),h&&h.length!==s*c&&Jn('The "as" parameter has too few output field names.'),h=h||i.map(Gn),u=function(t){for(var e,o,u=0,l=0;u<s;++u)if(null==(o=r.get(n[u](t))))for(e=0;e<c;++e,++l)t[h[l]]=a;else for(e=0;e<c;++e,++l)t[h[l]]=i[e](o)}):(h||Jn("Missing output field names."),u=function(t){for(var e,i=0;i<s;++i)e=r.get(n[i](t)),t[h[i]]=null==e?a:e}),o?f=e.reflow(!0):(l=n.some(t=>e.modified(t.fields)),d|=l?e.MOD:0),e.visit(d,u),f.modifies(h)}}),vr(_a,wn),vr(Ca,wn),vr(Sa,Pn,{transform(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),ja.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Ni,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},vr(ja,Li,{_transform:Li.prototype.transform,transform(t,e){return this._transform(function(t,e){const n=t.field,r=t.value,i=("count"===t.op?"__count__":t.op)||"sum",a=Hn(n).concat(Hn(r)),o=function(t,e,n){const r={},i=[];return n.visit(n.SOURCE,e=>{const n=t(e);r[n]||(r[n]=1,i.push(n))}),i.sort(ur),e?i.slice(0,e):i}(n,t.limit||0,e);e.changed()&&t.set("__pivot__",null,null,!0);return{key:t.key,groupby:t.groupby,ops:o.map(()=>i),fields:o.map(t=>function(t,e,n,r){return Vn(r=>e(r)===t?n(r):NaN,r,t+"")}(t,n,r,a)),as:o.map(t=>t+""),modified:t.modified.bind(t)}}(t,e),e)}}),vr(Na,oa,{transform(t,e){const n=t.subflow,r=t.field,i=t=>this.subflow(cn(t),n,e,t);return(t.modified("field")||r&&e.modified(Hn(r)))&&Jn("PreFacet does not support field modification."),this.initTargets(),r?(e.visit(e.MOD,t=>{const e=i(t);r(t).forEach(t=>e.mod(t))}),e.visit(e.ADD,t=>{const e=i(t);r(t).forEach(t=>e.add(dn(t)))}),e.visit(e.REM,t=>{const e=i(t);r(t).forEach(t=>e.rem(t))})):(e.visit(e.MOD,t=>i(t).mod(t)),e.visit(e.ADD,t=>i(t).add(t)),e.visit(e.REM,t=>i(t).rem(t))),e.clean()&&e.runAfter(()=>this.clean()),e}}),Ta.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},vr(Ta,Pn,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=Zi(t.fields,t.as||[]),a=r?(t,e)=>function(t,e,n,r){for(let i=0,a=n.length;i<a;++i)e[r[i]]=n[i](t);return e}(t,e,r,i):hn;let o;return this.value?o=this.value:(e=e.addAll(),o=this.value={}),e.visit(e.REM,t=>{const e=cn(t);n.rem.push(o[e]),o[e]=null}),e.visit(e.ADD,t=>{const e=a(t,dn({}));o[cn(t)]=e,n.add.push(e)}),e.visit(e.MOD,t=>{n.mod.push(a(t,o[cn(t)]))}),n}}),vr(Fa,Pn,{transform(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}}),Da.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function Ia(t){Pn.call(this,null,t)}function Ma(t){Pn.call(this,[],t),this.count=0}function $a(t){Pn.call(this,null,t)}function Ra(t){Pn.call(this,null,t),this.modified(!0)}function Ba(t){Pn.call(this,null,t)}vr(Da,Pn,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed())return n.source=this.value,n;const i=Qi(e.materialize(e.SOURCE).source,t.groupby,t.field),a=(t.groupby||[]).map(Gn),o=[],s=t.step||.01,u=t.probs||ki(s/2,1-1e-14,s),c=u.length;return i.forEach(t=>{const e=jr(t,u);for(let n=0;n<c;++n){const i={};for(let e=0;e<a.length;++e)i[a[e]]=t.dims[e];i[r[0]]=u[n],i[r[1]]=e[n],o.push(dn(i))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=o,n}}),vr(Ia,Pn,{transform(t,e){let n,r;return this.value?r=this.value:(n=e=e.addAll(),r=this.value={}),t.derive&&(n=e.fork(e.NO_SOURCE),e.visit(e.REM,t=>{const e=cn(t);n.rem.push(r[e]),r[e]=null}),e.visit(e.ADD,t=>{const e=fn(t);r[cn(t)]=e,n.add.push(e)}),e.visit(e.MOD,t=>{const e=r[cn(t)];for(const r in t)e[r]=t[r],n.modifies(r);n.mod.push(e)})),n}}),Ma.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},vr(Ma,Pn,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.modified("size"),i=t.size,a=this.value.reduce((t,e)=>(t[cn(e)]=1,t),{});let o=this.value,s=this.count,u=0;function c(t){let e,r;o.length<i?o.push(t):(r=~~((s+1)*Dr()),r<o.length&&r>=u&&(e=o[r],a[cn(e)]&&n.rem.push(e),o[r]=t)),++s}if(e.rem.length&&(e.visit(e.REM,t=>{const e=cn(t);a[e]&&(a[e]=-1,n.rem.push(t)),--s}),o=o.filter(t=>-1!==a[cn(t)])),(e.rem.length||r)&&o.length<i&&e.source&&(u=s=o.length,e.visit(e.SOURCE,t=>{a[cn(t)]||c(t)}),u=-1),r&&o.length>i){const t=o.length-i;for(let e=0;e<t;++e)a[cn(o[e])]=-1,n.rem.push(o[e]);o=o.slice(t)}return e.mod.length&&e.visit(e.MOD,t=>{a[cn(t)]&&n.mod.push(t)}),e.add.length&&e.visit(e.ADD,c),(e.add.length||u<0)&&(n.add=o.filter(t=>!a[cn(t)])),this.count=s,this.value=n.source=o,n}}),$a.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},vr($a,Pn,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),r=t.as||"data";return n.rem=this.value?e.rem.concat(this.value):e.rem,this.value=ki(t.start,t.stop,t.step||1).map(t=>{const e={};return e[r]=t,dn(e)}),n.add=e.add.concat(this.value),n}}),vr(Ra,Pn,{transform(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});const za=["unit0","unit1"];function La(t){Pn.call(this,yr(),t)}function Pa(t){Pn.call(this,null,t)}Ba.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:_i.j,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:za}]},vr(Ba,Pn,{transform(t,e){const n=t.field,r=!1!==t.interval,i="utc"===t.timezone,a=this._floor(t,e),o=(i?_i.v:_i.p)(a.unit).offset,s=t.as||za,u=s[0],c=s[1],l=a.step;let d=a.start||1/0,f=a.stop||-1/0,h=e.ADD;return(t.modified()||e.modified(Hn(n)))&&(h=(e=e.reflow(!0)).SOURCE,d=1/0,f=-1/0),e.visit(h,t=>{const e=n(t);let i,s;null==e?(t[u]=null,r&&(t[c]=null)):(t[u]=i=s=a(e),r&&(t[c]=s=o(i,l)),i<d&&(d=i),s>f&&(f=s))}),a.start=d,a.stop=f,e.modifies(r?s:u)},_floor(t,e){const n="utc"===t.timezone,{units:r,step:i}=t.units?{units:t.units,step:t.step||1}:Object(_i.n)({extent:t.extent||pr(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins}),a=Object(_i.t)(r),o=this.value||{},s=(n?_i.u:_i.o)(a,i);return s.unit=ir(a),s.units=a,s.step=i,s.start=o.start,s.stop=o.stop,this.value=s}}),vr(La,Pn,{transform(t,e){const n=e.dataflow,r=t.field,i=this.value,a=t=>i.set(r(t),t);let o=!0;return t.modified("field")||e.modified(r.fields)?(i.clear(),e.visit(e.SOURCE,a)):e.changed()?(e.visit(e.REM,t=>i.delete(r(t))),e.visit(e.ADD,a)):o=!1,this.modified(o),i.empty>n.cleanThreshold&&n.runAfter(i.clean),e.fork()}}),vr(Pa,Pn,{transform(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(mn(t.sort)):e.source).map(t.field))}});const qa={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){const t=qa.rank(),e=t.next;return{init:t.init,next:t=>(e(t)-1)/(t.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{const n=e.data,r=e.compare;let i=e.index;if(t<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;t=i}return(1+t)/n.length}}},ntile:function(t,e){(e=+e)>0||Jn("ntile num must be greater than zero.");const n=qa.cume_dist(),r=n.next;return{init:n.init,next:t=>Math.ceil(e*r(t))}},lag:function(t,e){return e=+e||1,{next:n=>{const r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:n=>{const r=n.index+e,i=n.data;return r<i.length?t(i[r]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){return(e=+e)>0||Jn("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(e-1);return r<n.i1?t(n.data[r]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{const r=t(n.data[n.index]);return null!=r?e=r:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:r=>{const i=r.data;return r.index<=n?e:(n=function(t,e,n){for(let r=e.length;n<r;++n){if(null!=t(e[n]))return n}return-1}(t,i,r.index))<0?(n=i.length,e=null):e=t(i[n])}}}};const Wa=Object.keys(qa);function Ua(t){const e=or(t.ops),n=or(t.fields),r=or(t.params),i=or(t.as),a=this.outputs=[],o=this.windows=[],s={},u={},c=[],l=[];let d=!0;function f(t){or(Hn(t)).forEach(t=>s[t]=1)}f(t.sort),e.forEach((t,e)=>{const s=n[e],h=Gn(s),p=Ci(t,h,i[e]);if(f(s),a.push(p),gr(qa,t))o.push(function(t,e,n,r){const i=qa[t](e,n);return{init:i.init||er,update:function(t,e){e[r]=i.next(t)}}}(t,n[e],r[e],p));else{if(null==s&&"count"!==t&&Jn("Null aggregate field specified."),"count"===t)return void c.push(p);d=!1;let e=u[h];e||(e=u[h]=[],e.field=s,l.push(e)),e.push(Ti(t,p))}}),(c.length||l.length)&&(this.cell=function(t,e,n){t=t.map(t=>Ri(t,t.field));const r={num:0,agg:null,store:!1,count:e};if(!n)for(var i=t.length,a=r.agg=Array(i),o=0;o<i;++o)a[o]=new t[o](r);if(r.store)var s=r.data=new Bi;return r.add=function(t){if(r.num+=1,!n){s&&s.add(t);for(let e=0;e<i;++e)a[e].add(a[e].get(t),t)}},r.rem=function(t){if(r.num-=1,!n){s&&s.rem(t);for(let e=0;e<i;++e)a[e].rem(a[e].get(t),t)}},r.set=function(t){let i,o;for(s&&s.values(),i=0,o=e.length;i<o;++i)t[e[i]]=r.num;if(!n)for(i=0,o=a.length;i<o;++i)a[i].set(t)},r.init=function(){r.num=0,s&&s.reset();for(let t=0;t<i;++t)a[t].init()},r}(l,c,d)),this.inputs=Object.keys(s)}const Va=Ua.prototype;function Ga(t){Pn.call(this,{},t),this._mlen=0,this._mods=[]}function Ha(t,e,n,r){const i=r.sort,a=i&&!r.ignorePeers,o=r.frame||[null,0],s=t.data(n),u=s.length,c=a?Object(Oi.a)(i):null,l={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||fr(-1)};e.init();for(let t=0;t<u;++t)Xa(l,o,t,u),a&&Ka(l,c),e.update(l,s[t])}function Xa(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=null==e[0]?0:Math.max(0,n-Math.abs(e[0])),t.i1=null==e[1]?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function Ka(t,e){const n=t.i0,r=t.i1-1,i=t.compare,a=t.data,o=a.length-1;n>0&&!i(a[n],a[n-1])&&(t.i0=e.left(a,a[n])),r<o&&!i(a[r],a[r+1])&&(t.i1=e.right(a,a[r]))}function Ya(t,e,n){return t.fields=e||[],t.fname=n,t}function Ja(t){return 1===t.length?Za(t[0]):Qa(t)}Va.init=function(){this.windows.forEach(t=>t.init()),this.cell&&this.cell.init()},Va.update=function(t,e){const n=this.cell,r=this.windows,i=t.data,a=r&&r.length;let o;if(n){for(o=t.p0;o<t.i0;++o)n.rem(i[o]);for(o=t.p1;o<t.i1;++o)n.add(i[o]);n.set(e)}for(o=0;o<a;++o)r[o].update(t,e)},Ga.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Wa.concat(Ni)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},vr(Ga,Pn,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),r=mn(t.sort),i=Ai(t.groupby),a=t=>this.group(i(t));let o=this.state;o&&!n||(o=this.state=new Ua(t)),n||e.modified(o.inputs)?(this.value={},e.visit(e.SOURCE,t=>a(t).add(t))):(e.visit(e.REM,t=>a(t).remove(t)),e.visit(e.ADD,t=>a(t).add(t)));for(let e=0,n=this._mlen;e<n;++e)Ha(this._mods[e],o,r,t);return this._mlen=0,this._mods=[],e.reflow(n).modifies(o.outputs)},group(t){let e=this.value[t];return e||(e=this.value[t]=qi(cn),e.stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e}});const Za=t=>function(e){return e[t]},Qa=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function to(t){throw Error(t)}function eo(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||to("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&to("Access path missing closing bracket: "+t),o&&to("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function no(t,e,n){const r=eo(t);return t=1===r.length?r[0]:t,Ya((n&&n.get||Ja)(r),[t],e||t)}no("id"),Ya(t=>t,[],"identity"),Ya(()=>0,[],"zero"),Ya(()=>1,[],"one");const ro=Ya(()=>!0,[],"true");Ya(()=>!1,[],"false");var io=Array.isArray;function ao(t){return t===Object(t)}function oo(t){return t[t.length-1]}function so(t){return null==t||""===t?null:+t}function uo(t){return null!=t?io(t)?t:[t]:[]}function co(t){return"function"==typeof t}function lo(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const fo=Object.prototype.hasOwnProperty;function ho(t,e){return fo.call(t,e)}function po(t,e,n){const r=t.prototype=Object.create(e.prototype);return r.constructor=t,lo(r,n)}function mo(t){return"string"==typeof t}function go(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function bo(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function yo(t){this._context=t}yo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:bo(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:bo(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var vo=function(t){return new yo(t)},xo=function(){};function wo(t){this._context=t}wo.prototype={areaStart:xo,areaEnd:xo,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:bo(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var ko=function(t){return new wo(t)};function Oo(t){this._context=t}Oo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:bo(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var _o=function(t){return new Oo(t)};function Ao(t,e){this._basis=new yo(t),this._beta=e}Ao.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],a=e[0],o=t[n]-i,s=e[n]-a,u=-1;++u<=n;)r=u/n,this._basis.point(this._beta*t[u]+(1-this._beta)*(i+r*o),this._beta*e[u]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var Co=function t(e){function n(t){return 1===e?new yo(t):new Ao(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function Eo(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function So(t,e){this._context=t,this._k=(1-e)/6}So.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Eo(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Eo(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var jo=function t(e){function n(t){return new So(t,e)}return n.tension=function(e){return t(+e)},n}(0);function No(t,e){this._context=t,this._k=(1-e)/6}No.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Eo(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var To=function t(e){function n(t){return new No(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Fo(t,e){this._context=t,this._k=(1-e)/6}Fo.prototype={areaStart:xo,areaEnd:xo,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Eo(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Do=function t(e){function n(t){return new Fo(t,e)}return n.tension=function(e){return t(+e)},n}(0),Io=Math.abs,Mo=Math.atan2,$o=Math.cos,Ro=Math.max,Bo=Math.min,zo=Math.sin,Lo=Math.sqrt,Po=Math.PI,qo=Po/2,Wo=2*Po;function Uo(t){return t>1?0:t<-1?Po:Math.acos(t)}function Vo(t){return t>=1?qo:t<=-1?-qo:Math.asin(t)}function Go(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>1e-12){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>1e-12){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*c+t._x1*t._l23_2a-e*t._l12_2a)/l,o=(o*c+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function Ho(t,e){this._context=t,this._alpha=e}Ho.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:Go(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Xo=function t(e){function n(t){return e?new Ho(t,e):new So(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Ko(t,e){this._context=t,this._alpha=e}Ko.prototype={areaStart:xo,areaEnd:xo,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Go(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Yo=function t(e){function n(t){return e?new Ko(t,e):new Fo(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Jo(t,e){this._context=t,this._alpha=e}Jo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Go(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Zo=function t(e){function n(t){return e?new Jo(t,e):new No(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Qo(t){this._context=t}Qo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var ts=function(t){return new Qo(t)};function es(t){this._context=t}es.prototype={areaStart:xo,areaEnd:xo,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};var ns=function(t){return new es(t)};function rs(t){return t<0?-1:1}function is(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(rs(a)+rs(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function as(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function os(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,s=(a-r)/3;t._context.bezierCurveTo(r+s,i+s*e,a-s,o-s*n,a,o)}function ss(t){this._context=t}function us(t){this._context=new cs(t)}function cs(t){this._context=t}function ls(t){return new ss(t)}function ds(t){return new us(t)}function fs(t){this._context=t}function hs(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}ss.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:os(this,this._t0,as(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,os(this,as(this,n=is(this,t,e)),n);break;default:os(this,this._t0,n=is(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(us.prototype=Object.create(ss.prototype)).point=function(t,e){ss.prototype.point.call(this,e,t)},cs.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},fs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=hs(t),i=hs(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var ps=function(t){return new fs(t)};function ms(t,e){this._context=t,this._t=e}ms.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var gs=function(t){return new ms(t,.5)};function bs(t){return new ms(t,0)}function ys(t){return new ms(t,1)}const vs=Math.PI,xs=2*vs,ws=xs-1e-6;function ks(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Os(){return new ks}ks.prototype=Os.prototype={constructor:ks,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-t,u=r-e,c=a-t,l=o-e,d=c*c+l*l;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(d>1e-6)if(Math.abs(l*s-u*c)>1e-6&&i){var f=n-a,h=r-o,p=s*s+u*u,m=f*f+h*h,g=Math.sqrt(p),b=Math.sqrt(d),y=i*Math.tan((vs-Math.acos((p+d-m)/(2*g*b)))/2),v=y/b,x=y/g;Math.abs(v-1)>1e-6&&(this._+="L"+(t+v*c)+","+(e+v*l)),this._+="A"+i+","+i+",0,0,"+ +(l*f>c*h)+","+(this._x1=t+x*s)+","+(this._y1=e+x*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,a){t=+t,e=+e,a=!!a;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),u=t+o,c=e+s,l=1^a,d=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+c:(Math.abs(this._x1-u)>1e-6||Math.abs(this._y1-c)>1e-6)&&(this._+="L"+u+","+c),n&&(d<0&&(d=d%xs+xs),d>ws?this._+="A"+n+","+n+",0,1,"+l+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+l+","+(this._x1=u)+","+(this._y1=c):d>1e-6&&(this._+="A"+n+","+n+",0,"+ +(d>=vs)+","+l+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var _s=Os,As=function(t){return function(){return t}};function Cs(t){return t.innerRadius}function Es(t){return t.outerRadius}function Ss(t){return t.startAngle}function js(t){return t.endAngle}function Ns(t){return t&&t.padAngle}function Ts(t,e,n,r,i,a,o,s){var u=n-t,c=r-e,l=o-i,d=s-a,f=d*u-l*c;if(!(f*f<1e-12))return[t+(f=(l*(e-a)-d*(t-i))/f)*u,e+f*c]}function Fs(t,e,n,r,i,a,o){var s=t-n,u=e-r,c=(o?a:-a)/Lo(s*s+u*u),l=c*u,d=-c*s,f=t+l,h=e+d,p=n+l,m=r+d,g=(f+p)/2,b=(h+m)/2,y=p-f,v=m-h,x=y*y+v*v,w=i-a,k=f*m-p*h,O=(v<0?-1:1)*Lo(Ro(0,w*w*x-k*k)),_=(k*v-y*O)/x,A=(-k*y-v*O)/x,C=(k*v+y*O)/x,E=(-k*y+v*O)/x,S=_-g,j=A-b,N=C-g,T=E-b;return S*S+j*j>N*N+T*T&&(_=C,A=E),{cx:_,cy:A,x01:-l,y01:-d,x11:_*(i/w-1),y11:A*(i/w-1)}}var Ds=function(){var t=Cs,e=Es,n=As(0),r=null,i=Ss,a=js,o=Ns,s=null;function u(){var u,c,l=+t.apply(this,arguments),d=+e.apply(this,arguments),f=i.apply(this,arguments)-qo,h=a.apply(this,arguments)-qo,p=Io(h-f),m=h>f;if(s||(s=u=_s()),d<l&&(c=d,d=l,l=c),d>1e-12)if(p>Wo-1e-12)s.moveTo(d*$o(f),d*zo(f)),s.arc(0,0,d,f,h,!m),l>1e-12&&(s.moveTo(l*$o(h),l*zo(h)),s.arc(0,0,l,h,f,m));else{var g,b,y=f,v=h,x=f,w=h,k=p,O=p,_=o.apply(this,arguments)/2,A=_>1e-12&&(r?+r.apply(this,arguments):Lo(l*l+d*d)),C=Bo(Io(d-l)/2,+n.apply(this,arguments)),E=C,S=C;if(A>1e-12){var j=Vo(A/l*zo(_)),N=Vo(A/d*zo(_));(k-=2*j)>1e-12?(x+=j*=m?1:-1,w-=j):(k=0,x=w=(f+h)/2),(O-=2*N)>1e-12?(y+=N*=m?1:-1,v-=N):(O=0,y=v=(f+h)/2)}var T=d*$o(y),F=d*zo(y),D=l*$o(w),I=l*zo(w);if(C>1e-12){var M,$=d*$o(v),R=d*zo(v),B=l*$o(x),z=l*zo(x);if(p<Po&&(M=Ts(T,F,B,z,$,R,D,I))){var L=T-M[0],P=F-M[1],q=$-M[0],W=R-M[1],U=1/zo(Uo((L*q+P*W)/(Lo(L*L+P*P)*Lo(q*q+W*W)))/2),V=Lo(M[0]*M[0]+M[1]*M[1]);E=Bo(C,(l-V)/(U-1)),S=Bo(C,(d-V)/(U+1))}}O>1e-12?S>1e-12?(g=Fs(B,z,T,F,d,S,m),b=Fs($,R,D,I,d,S,m),s.moveTo(g.cx+g.x01,g.cy+g.y01),S<C?s.arc(g.cx,g.cy,S,Mo(g.y01,g.x01),Mo(b.y01,b.x01),!m):(s.arc(g.cx,g.cy,S,Mo(g.y01,g.x01),Mo(g.y11,g.x11),!m),s.arc(0,0,d,Mo(g.cy+g.y11,g.cx+g.x11),Mo(b.cy+b.y11,b.cx+b.x11),!m),s.arc(b.cx,b.cy,S,Mo(b.y11,b.x11),Mo(b.y01,b.x01),!m))):(s.moveTo(T,F),s.arc(0,0,d,y,v,!m)):s.moveTo(T,F),l>1e-12&&k>1e-12?E>1e-12?(g=Fs(D,I,$,R,l,-E,m),b=Fs(T,F,B,z,l,-E,m),s.lineTo(g.cx+g.x01,g.cy+g.y01),E<C?s.arc(g.cx,g.cy,E,Mo(g.y01,g.x01),Mo(b.y01,b.x01),!m):(s.arc(g.cx,g.cy,E,Mo(g.y01,g.x01),Mo(g.y11,g.x11),!m),s.arc(0,0,l,Mo(g.cy+g.y11,g.cx+g.x11),Mo(b.cy+b.y11,b.cx+b.x11),m),s.arc(b.cx,b.cy,E,Mo(b.y11,b.x11),Mo(b.y01,b.x01),!m))):s.arc(0,0,l,w,x,m):s.lineTo(D,I)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Po/2;return[$o(r)*n,zo(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:As(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:As(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:As(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:As(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:As(+t),u):i},u.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:As(+t),u):a},u.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:As(+t),u):o},u.context=function(t){return arguments.length?(s=null==t?null:t,u):s},u},Is=(Array.prototype.slice,function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)});function Ms(t){return t[0]}function $s(t){return t[1]}var Rs=function(t,e){var n=As(!0),r=null,i=ts,a=null;function o(o){var s,u,c,l=(o=Is(o)).length,d=!1;for(null==r&&(a=i(c=_s())),s=0;s<=l;++s)!(s<l&&n(u=o[s],s,o))===d&&((d=!d)?a.lineStart():a.lineEnd()),d&&a.point(+t(u,s,o),+e(u,s,o));if(c)return a=null,c+""||null}return t="function"==typeof t?t:void 0===t?Ms:As(t),e="function"==typeof e?e:void 0===e?$s:As(e),o.x=function(e){return arguments.length?(t="function"==typeof e?e:As(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:As(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:As(!!t),o):n},o.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),o):i},o.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),o):r},o},Bs=function(t,e,n){var r=null,i=As(!0),a=null,o=ts,s=null;function u(u){var c,l,d,f,h,p=(u=Is(u)).length,m=!1,g=new Array(p),b=new Array(p);for(null==a&&(s=o(h=_s())),c=0;c<=p;++c){if(!(c<p&&i(f=u[c],c,u))===m)if(m=!m)l=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=c-1;d>=l;--d)s.point(g[d],b[d]);s.lineEnd(),s.areaEnd()}m&&(g[c]=+t(f,c,u),b[c]=+e(f,c,u),s.point(r?+r(f,c,u):g[c],n?+n(f,c,u):b[c]))}if(h)return s=null,h+""||null}function c(){return Rs().defined(i).curve(o).context(a)}return t="function"==typeof t?t:void 0===t?Ms:As(+t),e="function"==typeof e?e:As(void 0===e?0:+e),n="function"==typeof n?n:void 0===n?$s:As(+n),u.x=function(e){return arguments.length?(t="function"==typeof e?e:As(+e),r=null,u):t},u.x0=function(e){return arguments.length?(t="function"==typeof e?e:As(+e),u):t},u.x1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:As(+t),u):r},u.y=function(t){return arguments.length?(e="function"==typeof t?t:As(+t),n=null,u):e},u.y0=function(t){return arguments.length?(e="function"==typeof t?t:As(+t),u):e},u.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:As(+t),u):n},u.lineX0=u.lineY0=function(){return c().x(t).y(e)},u.lineY1=function(){return c().x(t).y(n)},u.lineX1=function(){return c().x(r).y(e)},u.defined=function(t){return arguments.length?(i="function"==typeof t?t:As(!!t),u):i},u.curve=function(t){return arguments.length?(o=t,null!=a&&(s=o(a)),u):o},u.context=function(t){return arguments.length?(null==t?a=s=null:s=o(a=t),u):a},u},zs={draw:function(t,e){var n=Math.sqrt(e/Po);t.moveTo(n,0),t.arc(0,0,n,0,Wo)}},Ls=(Math.sqrt(1/3),Math.sin(Po/10)/Math.sin(7*Po/10)),Ps=(Math.sin(Wo/10),Math.cos(Wo/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(t,e){var n=null;function r(){var r;if(n||(n=r=_s()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return t="function"==typeof t?t:As(t||zs),e="function"==typeof e?e:As(void 0===e?64:+e),r.type=function(e){return arguments.length?(t="function"==typeof e?e:As(e),r):t},r.size=function(t){return arguments.length?(e="function"==typeof t?t:As(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r});function qs(t,e){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}const Ws=()=>"undefined"!=typeof Image?Image:null,Us=Object(Oi.a)(xr.a),Vs=Us.right,Gs=Us.left;Object(Oi.a)(_r).center;var Hs=Vs;function Xs(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Ks(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}const Ys=Symbol("implicit");function Js(){var t=new Map,e=[],n=[],r=Ys;function i(i){var a=i+"",o=t.get(a);if(!o){if(r!==Ys)return r;t.set(a,o=e.push(i))}return n[(o-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;for(const r of n){const n=r+"";t.has(n)||t.set(n,e.push(r))}return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Js(e,n).unknown(r)},Xs.apply(i,arguments),i}var Zs=n(456),Qs=n(75);function tu(t,e,n,r){var i,a=Object(Zs.c)(t,e,n);switch((r=Object(Qs.formatSpecifier)(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=Object(Qs.precisionPrefix)(a,o))||(r.precision=i),Object(Qs.formatPrefix)(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=Object(Qs.precisionRound)(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=Object(Qs.precisionFixed)(a))||(r.precision=i-2*("%"===r.type))}return Object(Qs.format)(r)}var eu=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function nu(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ru(){}var iu="\\s*([+-]?\\d+)\\s*",au="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ou="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",su=/^#([0-9a-f]{3,8})$/,uu=new RegExp("^rgb\\("+[iu,iu,iu]+"\\)$"),cu=new RegExp("^rgb\\("+[ou,ou,ou]+"\\)$"),lu=new RegExp("^rgba\\("+[iu,iu,iu,au]+"\\)$"),du=new RegExp("^rgba\\("+[ou,ou,ou,au]+"\\)$"),fu=new RegExp("^hsl\\("+[au,ou,ou]+"\\)$"),hu=new RegExp("^hsla\\("+[au,ou,ou,au]+"\\)$"),pu={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function mu(){return this.rgb().formatHex()}function gu(){return this.rgb().formatRgb()}function bu(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=su.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?yu(e):3===n?new ku(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?vu(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?vu(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=uu.exec(t))?new ku(e[1],e[2],e[3],1):(e=cu.exec(t))?new ku(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=lu.exec(t))?vu(e[1],e[2],e[3],e[4]):(e=du.exec(t))?vu(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=fu.exec(t))?Cu(e[1],e[2]/100,e[3]/100,1):(e=hu.exec(t))?Cu(e[1],e[2]/100,e[3]/100,e[4]):pu.hasOwnProperty(t)?yu(pu[t]):"transparent"===t?new ku(NaN,NaN,NaN,0):null}function yu(t){return new ku(t>>16&255,t>>8&255,255&t,1)}function vu(t,e,n,r){return r<=0&&(t=e=n=NaN),new ku(t,e,n,r)}function xu(t){return t instanceof ru||(t=bu(t)),t?new ku((t=t.rgb()).r,t.g,t.b,t.opacity):new ku}function wu(t,e,n,r){return 1===arguments.length?xu(t):new ku(t,e,n,null==r?1:r)}function ku(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Ou(){return"#"+Au(this.r)+Au(this.g)+Au(this.b)}function _u(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Au(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Cu(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ju(t,e,n,r)}function Eu(t){if(t instanceof ju)return new ju(t.h,t.s,t.l,t.opacity);if(t instanceof ru||(t=bu(t)),!t)return new ju;if(t instanceof ju)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new ju(o,s,u,t.opacity)}function Su(t,e,n,r){return 1===arguments.length?Eu(t):new ju(t,e,n,null==r?1:r)}function ju(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Nu(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Tu(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}eu(ru,bu,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:mu,formatHex:mu,formatHsl:function(){return Eu(this).formatHsl()},formatRgb:gu,toString:gu}),eu(ku,wu,nu(ru,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ku(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ku(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ou,formatHex:Ou,formatRgb:_u,toString:_u})),eu(ju,Su,nu(ru,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ju(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ju(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new ku(Nu(t>=240?t-240:t+120,i,r),Nu(t,i,r),Nu(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Fu=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return Tu((n-r/e)*e,o,i,a,s)}},Du=function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return Tu((n-r/e)*e,i,a,o,s)}},Iu=t=>()=>t;function Mu(t,e){return function(n){return t+n*e}}function $u(t,e){var n=e-t;return n?Mu(t,n>180||n<-180?n-360*Math.round(n/360):n):Iu(isNaN(t)?e:t)}function Ru(t){return 1==(t=+t)?Bu:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Iu(isNaN(e)?n:e)}}function Bu(t,e){var n=e-t;return n?Mu(t,n):Iu(isNaN(t)?e:t)}var zu=function t(e){var n=Ru(e);function r(t,e){var r=n((t=wu(t)).r,(e=wu(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=Bu(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function Lu(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=wu(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}var Pu=Lu(Fu),qu=Lu(Du),Wu=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}};function Uu(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}var Vu=function(t,e){return(Uu(e)?Wu:Gu)(t,e)};function Gu(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Qu(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}var Hu=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},Xu=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},Ku=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Qu(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},Yu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ju=new RegExp(Yu.source,"g");var Zu=function(t,e){var n,r,i,a=Yu.lastIndex=Ju.lastIndex=0,o=-1,s=[],u=[];for(t+="",e+="";(n=Yu.exec(t))&&(r=Ju.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:Xu(n,r)})),a=Ju.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})},Qu=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?Iu(e):("number"===r?Xu:"string"===r?(n=bu(e))?(e=n,zu):Zu:e instanceof bu?zu:e instanceof Date?Hu:Uu(e)?Wu:Array.isArray(e)?Gu:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Ku:Xu)(t,e)},tc=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}};function ec(t){return+t}var nc=[0,1];function rc(t){return t}function ic(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function ac(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=ic(i,r),a=n(o,a)):(r=ic(r,i),a=n(a,o)),function(t){return a(r(t))}}function oc(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=ic(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=Hs(t,e,1,r)-1;return a[n](i[n](e))}}function sc(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function uc(){var t,e,n,r,i,a,o=nc,s=nc,u=Qu,c=rc;function l(){var t,e,n,u=Math.min(o.length,s.length);return c!==rc&&(t=o[0],e=o[u-1],t>e&&(n=t,t=e,e=n),c=function(n){return Math.max(t,Math.min(e,n))}),r=u>2?oc:ac,i=a=null,d}function d(e){return isNaN(e=+e)?n:(i||(i=r(o.map(t),s,u)))(t(c(e)))}return d.invert=function(n){return c(e((a||(a=r(s,o.map(t),Xu)))(n)))},d.domain=function(t){return arguments.length?(o=Array.from(t,ec),l()):o.slice()},d.range=function(t){return arguments.length?(s=Array.from(t),l()):s.slice()},d.rangeRound=function(t){return s=Array.from(t),u=tc,l()},d.clamp=function(t){return arguments.length?(c=!!t||rc,l()):c!==rc},d.interpolate=function(t){return arguments.length?(u=t,l()):u},d.unknown=function(t){return arguments.length?(n=t,d):n},function(n,r){return t=n,e=r,l()}}function cc(){return uc()(rc,rc)}function lc(t){var e=t.domain;return t.ticks=function(t){var n=e();return Object(Zs.a)(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return tu(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,a=e(),o=0,s=a.length-1,u=a[o],c=a[s],l=10;for(c<u&&(i=u,u=c,c=i,i=o,o=s,s=i);l-- >0;){if((i=Object(Zs.b)(u,c,n))===r)return a[o]=u,a[s]=c,e(a);if(i>0)u=Math.floor(u/i)*i,c=Math.ceil(c/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,c=Math.floor(c*i)/i}r=i}return t},t}function dc(){var t=cc();return t.copy=function(){return sc(t,dc())},Xs.apply(t,arguments),lc(t)}function fc(t){var e;function n(t){return isNaN(t=+t)?e:t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=Array.from(e,ec),n):t.slice()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return fc(t).unknown(e)},t=arguments.length?Array.from(t,ec):[0,1],lc(n)}function hc(t,e){var n,r=0,i=(t=t.slice()).length-1,a=t[r],o=t[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),t[r]=e.floor(a),t[i]=e.ceil(o),t}function pc(t){return Math.log(t)}function mc(t){return Math.exp(t)}function gc(t){return-Math.log(-t)}function bc(t){return-Math.exp(-t)}function yc(t){return isFinite(t)?+("1e"+t):t<0?0:t}function vc(t){return function(e){return-t(-e)}}function xc(t){var e,n,r=t(pc,mc),i=r.domain,a=10;function o(){return e=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(a),n=function(t){return 10===t?yc:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(a),i()[0]<0?(e=vc(e),n=vc(n),t(gc,bc)):t(pc,mc),r}return r.base=function(t){return arguments.length?(a=+t,o()):a},r.domain=function(t){return arguments.length?(i(t),o()):i()},r.ticks=function(t){var r,o=i(),s=o[0],u=o[o.length-1];(r=u<s)&&(f=s,s=u,u=f);var c,l,d,f=e(s),h=e(u),p=null==t?10:+t,m=[];if(!(a%1)&&h-f<p){if(f=Math.floor(f),h=Math.ceil(h),s>0){for(;f<=h;++f)for(l=1,c=n(f);l<a;++l)if(!((d=c*l)<s)){if(d>u)break;m.push(d)}}else for(;f<=h;++f)for(l=a-1,c=n(f);l>=1;--l)if(!((d=c*l)<s)){if(d>u)break;m.push(d)}2*m.length<p&&(m=Object(Zs.a)(s,u,p))}else m=Object(Zs.a)(f,h,Math.min(h-f,p)).map(n);return r?m.reverse():m},r.tickFormat=function(t,i){if(null==i&&(i=10===a?".0e":","),"function"!=typeof i&&(i=Object(Qs.format)(i)),t===1/0)return i;null==t&&(t=10);var o=Math.max(1,a*t/r.ticks().length);return function(t){var r=t/n(Math.round(e(t)));return r*a<a-.5&&(r*=a),r<=o?i(t):""}},r.nice=function(){return i(hc(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},r}function wc(){var t=xc(uc()).domain([1,10]);return t.copy=function(){return sc(t,wc()).base(t.base())},Xs.apply(t,arguments),t}function kc(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Oc(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function _c(t){return t<0?-t*t:t*t}function Ac(t){var e=t(rc,rc),n=1;function r(){return 1===n?t(rc,rc):.5===n?t(Oc,_c):t(kc(n),kc(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,r()):n},lc(e)}function Cc(){var t=Ac(uc());return t.copy=function(){return sc(t,Cc()).exponent(t.exponent())},Xs.apply(t,arguments),t}function Ec(){return Cc.apply(null,arguments).exponent(.5)}function Sc(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function jc(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Nc(t){var e=1,n=t(Sc(e),jc(e));return n.constant=function(n){return arguments.length?t(Sc(e=+n),jc(e)):e},lc(n)}function Tc(){var t=Nc(uc());return t.copy=function(){return sc(t,Tc()).constant(t.constant())},Xs.apply(t,arguments)}var Fc=n(158),Dc=n(448),Ic=n(90),Mc=n(320),$c=n(449),Rc=n(450),Bc=n(451),zc=n(452),Lc=n(457);function Pc(t){return new Date(t)}function qc(t){return t instanceof Date?+t:+new Date(+t)}function Wc(t,e,n,r,i,a,o,s,u){var c=cc(),l=c.invert,d=c.domain,f=u(".%L"),h=u(":%S"),p=u("%I:%M"),m=u("%I %p"),g=u("%a %d"),b=u("%b %d"),y=u("%B"),v=u("%Y"),x=[[o,1,1e3],[o,5,5e3],[o,15,15e3],[o,30,3e4],[a,1,6e4],[a,5,3e5],[a,15,9e5],[a,30,18e5],[i,1,36e5],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,864e5],[r,2,1728e5],[n,1,6048e5],[e,1,2592e6],[e,3,7776e6],[t,1,31536e6]];function w(s){return(o(s)<s?f:a(s)<s?h:i(s)<s?p:r(s)<s?m:e(s)<s?n(s)<s?g:b:t(s)<s?y:v)(s)}function k(e,n,r){if(null==e&&(e=10),"number"==typeof e){var i,a=Math.abs(r-n)/e,o=Object(Oi.a)((function(t){return t[2]})).right(x,a);return o===x.length?(i=Object(Zs.c)(n/31536e6,r/31536e6,e),e=t):o?(i=(o=x[a/x[o-1][2]<x[o][2]/a?o-1:o])[1],e=o[0]):(i=Math.max(Object(Zs.c)(n,r,e),1),e=s),e.every(i)}return e}return c.invert=function(t){return new Date(l(t))},c.domain=function(t){return arguments.length?d(Array.from(t,qc)):d().map(Pc)},c.ticks=function(t){var e,n=d(),r=n[0],i=n[n.length-1],a=i<r;return a&&(e=r,r=i,i=e),e=(e=k(t,r,i))?e.range(r,i+1):[],a?e.reverse():e},c.tickFormat=function(t,e){return null==e?w:u(e)},c.nice=function(t){var e=d();return(t=k(t,e[0],e[e.length-1]))?d(hc(e,t)):c},c.copy=function(){return sc(c,Wc(t,e,n,r,i,a,o,s,u))},c}function Uc(){return Xs.apply(Wc(Fc.a,Dc.a,Ic.b,Mc.a,$c.a,Rc.a,Bc.a,zc.a,Lc.a).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}var Vc=n(159),Gc=n(453),Hc=n(91),Xc=n(321),Kc=n(454),Yc=n(455);function Jc(){return Xs.apply(Wc(Vc.a,Gc.a,Hc.b,Xc.a,Kc.a,Yc.a,Bc.a,zc.a,Lc.c).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Zc(){var t,e,n,r,i,a=0,o=1,s=rc,u=!1;function c(e){return isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,u?Math.max(0,Math.min(1,e)):e))}function l(t){return function(e){var n,r;return arguments.length?([n,r]=e,s=t(n,r),c):[s(0),s(1)]}}return c.domain=function(i){return arguments.length?([a,o]=i,t=r(a=+a),e=r(o=+o),n=t===e?0:1/(e-t),c):[a,o]},c.clamp=function(t){return arguments.length?(u=!!t,c):u},c.interpolator=function(t){return arguments.length?(s=t,c):s},c.range=l(Qu),c.rangeRound=l(tc),c.unknown=function(t){return arguments.length?(i=t,c):i},function(i){return r=i,t=i(a),e=i(o),n=t===e?0:1/(e-t),c}}function Qc(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function tl(){var t=lc(Zc()(rc));return t.copy=function(){return Qc(t,tl())},Ks.apply(t,arguments)}function el(){var t=xc(Zc()).domain([1,10]);return t.copy=function(){return Qc(t,el()).base(t.base())},Ks.apply(t,arguments)}function nl(){var t=Nc(Zc());return t.copy=function(){return Qc(t,nl()).constant(t.constant())},Ks.apply(t,arguments)}function rl(){var t=Ac(Zc());return t.copy=function(){return Qc(t,rl()).exponent(t.exponent())},Ks.apply(t,arguments)}function il(){return rl.apply(null,arguments).exponent(.5)}function al(t,e){void 0===e&&(e=t,t=Qu);for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}function ol(){var t,e,n,r,i,a,o,s=0,u=.5,c=1,l=1,d=rc,f=!1;function h(t){return isNaN(t=+t)?o:(t=.5+((t=+a(t))-e)*(l*t<l*e?r:i),d(f?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,r,i;return arguments.length?([n,r,i]=e,d=al(t,[n,r,i]),h):[d(0),d(.5),d(1)]}}return h.domain=function(o){return arguments.length?([s,u,c]=o,t=a(s=+s),e=a(u=+u),n=a(c=+c),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,h):[s,u,c]},h.clamp=function(t){return arguments.length?(f=!!t,h):f},h.interpolator=function(t){return arguments.length?(d=t,h):d},h.range=p(Qu),h.rangeRound=p(tc),h.unknown=function(t){return arguments.length?(o=t,h):o},function(o){return a=o,t=o(s),e=o(u),n=o(c),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,h}}function sl(){var t=lc(ol()(rc));return t.copy=function(){return Qc(t,sl())},Ks.apply(t,arguments)}function ul(){var t=xc(ol()).domain([.1,1,10]);return t.copy=function(){return Qc(t,ul()).base(t.base())},Ks.apply(t,arguments)}function cl(){var t=Nc(ol());return t.copy=function(){return Qc(t,cl()).constant(t.constant())},Ks.apply(t,arguments)}function ll(){var t=Ac(ol());return t.copy=function(){return Qc(t,ll()).exponent(t.exponent())},Ks.apply(t,arguments)}function dl(){return ll.apply(null,arguments).exponent(.5)}function fl(){var t,e=[],n=[],r=[];function i(){var t=0,i=Math.max(1,n.length);for(r=new Array(i-1);++t<i;)r[t-1]=Cr(e,t/i);return a}function a(e){return isNaN(e=+e)?t:n[Hs(r,e)]}return a.invertExtent=function(t){var i=n.indexOf(t);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(xr.a),i()},a.range=function(t){return arguments.length?(n=Array.from(t),i()):n.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return r.slice()},a.copy=function(){return fl().domain(e).range(n).unknown(t)},Xs.apply(a,arguments)}function hl(){var t,e=0,n=1,r=1,i=[.5],a=[0,1];function o(e){return e<=e?a[Hs(i,e,0,r)]:t}function s(){var t=-1;for(i=new Array(r);++t<r;)i[t]=((t+1)*n-(t-r)*e)/(r+1);return o}return o.domain=function(t){return arguments.length?([e,n]=t,e=+e,n=+n,s()):[e,n]},o.range=function(t){return arguments.length?(r=(a=Array.from(t)).length-1,s()):a.slice()},o.invertExtent=function(t){var o=a.indexOf(t);return o<0?[NaN,NaN]:o<1?[e,i[0]]:o>=r?[i[r-1],n]:[i[o-1],i[o]]},o.unknown=function(e){return arguments.length?(t=e,o):o},o.thresholds=function(){return i.slice()},o.copy=function(){return hl().domain([e,n]).range(a).unknown(t)},Xs.apply(lc(o),arguments)}function pl(){var t,e=[.5],n=[0,1],r=1;function i(i){return i<=i?n[Hs(e,i,0,r)]:t}return i.domain=function(t){return arguments.length?(e=Array.from(t),r=Math.min(e.length,n.length-1),i):e.slice()},i.range=function(t){return arguments.length?(n=Array.from(t),r=Math.min(e.length,n.length-1),i):n.slice()},i.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return pl().domain(e).range(n).unknown(t)},Xs.apply(i,arguments)}var ml,gl=function(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}},bl=function(t,e){var n=$u(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}},yl=180/Math.PI,vl={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},xl=function(t,e,n,r,i,a){var o,s,u;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*yl,skewX:Math.atan(u)*yl,scaleX:o,scaleY:s}};function wl(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],u=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var u=o.push("translate(",null,e,null,n);s.push({i:u-4,x:Xu(t,i)},{i:u-2,x:Xu(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,u),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Xu(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,u),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Xu(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,u),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:Xu(t,n)},{i:s-2,x:Xu(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,u),a=o=null,function(t){for(var e,n=-1,r=u.length;++n<r;)s[(e=u[n]).i]=e.x(t);return s.join("")}}}var kl=wl((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?vl:xl(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Ol=wl((function(t){return null==t?vl:(ml||(ml=document.createElementNS("http://www.w3.org/2000/svg","g")),ml.setAttribute("transform",t),(t=ml.transform.baseVal.consolidate())?(t=t.matrix,xl(t.a,t.b,t.c,t.d,t.e,t.f)):vl)}),", ",")",")");function _l(t){return((t=Math.exp(t))+1/t)/2}var Al=function t(e,n,r){function i(t,i){var a,o,s=t[0],u=t[1],c=t[2],l=i[0],d=i[1],f=i[2],h=l-s,p=d-u,m=h*h+p*p;if(m<1e-12)o=Math.log(f/c)/e,a=function(t){return[s+t*h,u+t*p,c*Math.exp(e*t*o)]};else{var g=Math.sqrt(m),b=(f*f-c*c+r*m)/(2*c*n*g),y=(f*f-c*c-r*m)/(2*f*n*g),v=Math.log(Math.sqrt(b*b+1)-b),x=Math.log(Math.sqrt(y*y+1)-y);o=(x-v)/e,a=function(t){var r,i=t*o,a=_l(v),l=c/(n*g)*(a*(r=e*i+v,((r=Math.exp(2*r))-1)/(r+1))-function(t){return((t=Math.exp(t))-1/t)/2}(v));return[s+l*h,u+l*p,c*a/_l(e*i+v)]}}return a.duration=1e3*o*e/Math.SQRT2,a}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function Cl(t){return function(e,n){var r=t((e=Su(e)).h,(n=Su(n)).h),i=Bu(e.s,n.s),a=Bu(e.l,n.l),o=Bu(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=a(t),e.opacity=o(t),e+""}}}var El=Cl($u),Sl=Cl(Bu);const jl=Math.PI/180,Nl=180/Math.PI;function Tl(t){if(t instanceof Dl)return new Dl(t.l,t.a,t.b,t.opacity);if(t instanceof Ll)return Pl(t);t instanceof ku||(t=xu(t));var e,n,r=Rl(t.r),i=Rl(t.g),a=Rl(t.b),o=Il((.2225045*r+.7168786*i+.0606169*a)/1);return r===i&&i===a?e=n=o:(e=Il((.4360747*r+.3850649*i+.1430804*a)/.96422),n=Il((.0139322*r+.0971045*i+.7141733*a)/.82521)),new Dl(116*o-16,500*(e-o),200*(o-n),t.opacity)}function Fl(t,e,n,r){return 1===arguments.length?Tl(t):new Dl(t,e,n,null==r?1:r)}function Dl(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Il(t){return t>6/29*(6/29)*(6/29)?Math.pow(t,1/3):t/(6/29*3*(6/29))+4/29}function Ml(t){return t>6/29?t*t*t:6/29*3*(6/29)*(t-4/29)}function $l(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Rl(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Bl(t){if(t instanceof Ll)return new Ll(t.h,t.c,t.l,t.opacity);if(t instanceof Dl||(t=Tl(t)),0===t.a&&0===t.b)return new Ll(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Nl;return new Ll(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function zl(t,e,n,r){return 1===arguments.length?Bl(t):new Ll(t,e,n,null==r?1:r)}function Ll(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Pl(t){if(isNaN(t.h))return new Dl(t.l,0,0,t.opacity);var e=t.h*jl;return new Dl(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function ql(t,e){var n=Bu((t=Fl(t)).l,(e=Fl(e)).l),r=Bu(t.a,e.a),i=Bu(t.b,e.b),a=Bu(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}}function Wl(t){return function(e,n){var r=t((e=zl(e)).h,(n=zl(n)).h),i=Bu(e.c,n.c),a=Bu(e.l,n.l),o=Bu(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=a(t),e.opacity=o(t),e+""}}}eu(Dl,Fl,nu(ru,{brighter:function(t){return new Dl(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Dl(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new ku($l(3.1338561*(e=.96422*Ml(e))-1.6168667*(t=1*Ml(t))-.4906146*(n=.82521*Ml(n))),$l(-.9787684*e+1.9161415*t+.033454*n),$l(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),eu(Ll,zl,nu(ru,{brighter:function(t){return new Ll(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Ll(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return Pl(this).rgb()}}));var Ul=Wl($u),Vl=Wl(Bu),Gl=-.29227,Hl=1.97294,Xl=-.90649*Hl,Kl=1.78277*Hl,Yl=-.6557636667999999;function Jl(t){if(t instanceof Ql)return new Ql(t.h,t.s,t.l,t.opacity);t instanceof ku||(t=xu(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(Yl*r+Xl*e-Kl*n)/(Yl+Xl-Kl),a=r-i,o=(Hl*(n-i)-Gl*a)/-.90649,s=Math.sqrt(o*o+a*a)/(Hl*i*(1-i)),u=s?Math.atan2(o,a)*Nl-120:NaN;return new Ql(u<0?u+360:u,s,i,t.opacity)}function Zl(t,e,n,r){return 1===arguments.length?Jl(t):new Ql(t,e,n,null==r?1:r)}function Ql(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function td(t){return function e(n){function r(e,r){var i=t((e=Zl(e)).h,(r=Zl(r)).h),a=Bu(e.s,r.s),o=Bu(e.l,r.l),s=Bu(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}eu(Ql,Zl,nu(ru,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ql(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ql(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*jl,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new ku(255*(e+n*(-.14861*r+1.78277*i)),255*(e+n*(Gl*r+-.90649*i)),255*(e+n*(Hl*r)),this.opacity)}}));var ed=td($u),nd=td(Bu),rd=function(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n};const id="log",ad="utc",od="continuous";function sd(){const t=Js().unknown(void 0),e=t.domain,n=t.range;let r,i,a=[0,1],o=!1,s=0,u=0,c=.5;function l(){const t=e().length,l=a[1]<a[0],d=a[1-l],f=function(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}(t,s,u);let h=a[l-0];r=(d-h)/(f||1),o&&(r=Math.floor(r)),h+=(d-h-r*(t-s))*c,i=r*(1-s),o&&(h=Math.round(h),i=Math.round(i));const p=ki(t).map(t=>h+r*t);return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},t.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(o=!!t,l()):o},t.padding=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),s=u,l()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},t.paddingOuter=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=a[1]<a[0],o=r?n().reverse():n(),s=o.length-1;let u,c,l,d=+t[0],f=+t[1];return d!=d||f!=f||(f<d&&(l=d,d=f,f=l),f<o[0]||d>a[1-r])?void 0:(u=Math.max(0,Vs(o,d)-1),c=d===f?u:Vs(o,f)-1,d-o[u]>i+1e-10&&++u,r&&(l=u,u=s-c,c=s-l),u>c?void 0:e().slice(u,c+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return sd().domain(e()).range(a).round(o).paddingInner(s).paddingOuter(u).align(c)},l()}var ud=Array.prototype.map;function cd(t){return ud.call(t,so)}const ld=Array.prototype.slice;const dd={};function fd(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,a,o,s=e[0],u=e[1],c=-1;for(u<s&&(i=s,s=u,u=i),a=0,o=n.length;a<o;++a)n[a]>=s&&n[a]<=u&&(c<0&&(c=a),r=a);if(!(c<0))return s=t.invertExtent(n[c]),u=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=t,n};return r.metadata=go(uo(n)),r}function hd(t,e,n){return arguments.length>1?(dd[t]=fd(t,e,n),this):pd(t)?dd[t]:void 0}function pd(t){return ho(dd,t)}function md(t,e){const n=dd[t];return n&&n.metadata[e]}function gd(t){return md(t,"discrete")}hd("identity",fc),hd("linear",dc,od),hd(id,wc,[od,id]),hd("pow",Cc,od),hd("sqrt",Ec,od),hd("symlog",Tc,od),hd("time",Uc,[od,"temporal"]),hd(ad,Jc,[od,"temporal"]),hd("sequential",tl,[od,"interpolating"]),hd("".concat("sequential","-").concat("linear"),tl,[od,"interpolating"]),hd("".concat("sequential","-").concat(id),el,[od,"interpolating",id]),hd("".concat("sequential","-").concat("pow"),rl,[od,"interpolating"]),hd("".concat("sequential","-").concat("sqrt"),il,[od,"interpolating"]),hd("".concat("sequential","-").concat("symlog"),nl,[od,"interpolating"]),hd("".concat("diverging","-").concat("linear"),sl,[od,"interpolating"]),hd("".concat("diverging","-").concat(id),ul,[od,"interpolating",id]),hd("".concat("diverging","-").concat("pow"),ll,[od,"interpolating"]),hd("".concat("diverging","-").concat("sqrt"),dl,[od,"interpolating"]),hd("".concat("diverging","-").concat("symlog"),cl,[od,"interpolating"]),hd("quantile",fl,["discretizing","quantile"]),hd("quantize",hl,"discretizing"),hd("threshold",pl,"discretizing"),hd("bin-ordinal",(function t(){let e=[],n=[];function r(t){return null==t||t!=t?void 0:n[(Hs(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=cd(t),r):e.slice()},r.range=function(t){return arguments.length?(n=ld.call(t),r):n.slice()},r.tickFormat=function(t,n){return tu(e[0],oo(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),["discrete","discretizing"]),hd("ordinal",Js,"discrete"),hd("band",sd,"discrete"),hd("point",(function(){return function t(e){const n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return t(n())},e}(sd().paddingInner(1))}),"discrete");function bd(t,e,n){return al(function(t,e){const n=o[function(t){return"interpolate"+t.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}(e||"rgb",n),t)}function yd(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function vd(t,e){for(const n in t)wd(n,e(t[n]))}const xd={};function wd(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(xd[t]=e,this):xd[t]}vd({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},yd),vd({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},t=>bd(yd(t)));const kd=t=>io(t)?t.map(t=>String(t)):String(t),Od=(t,e)=>t[1]-e[1],_d=(t,e)=>e[1]-t[1];function Ad(t,e){return t.bins?function(t,e,n){let r=t.range(),i=r[0],a=oo(r),o=Od;if(i>a&&(r=a,a=i,i=r,o=_d),i=Math.floor(i),a=Math.ceil(a),e=e.map(e=>[e,t(e)]).filter(t=>i<=t[1]&&t[1]<=a).sort(o).map(t=>t[0]),n>0&&e.length>1){const t=[e[0],oo(e)];for(;e.length>n&&e.length>=3;)e=e.filter((t,e)=>!(e%2));e.length<3&&(e=t)}return e}(t,t.bins):t.ticks?t.ticks(e):t.domain()}function Cd(t,e,n,r,i,a){const o=e.type;let s=kd;if("time"===o||"time"===i)s=t.timeFormat(r);else if(o===ad||i===ad)s=t.utcFormat(r);else if(md(o,id)){const i=t.formatFloat(r);if(a||e.bins)s=i;else{const t=Ed(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function Ed(t,e,n){const r=Ad(t,e),i=t.base(),a=Math.log(i),o=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/a));return e*i<i-.5&&(e*=i),e<=o};return n?r.filter(s):s}const Sd={quantile:"quantiles",quantize:"thresholds",threshold:"domain"},jd={quantile:"quantiles",quantize:"domain"};function Nd(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=oo(t),e}(t.bins):t.type===id?Ed(t,e,!0):Sd[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[Sd[t.type]]()):Ad(t,e)}function Td(t,e,n,r,i,a,o){const s=jd[e.type]&&"time"!==a&&a!==ad?function(t,e,n){const r=e[jd[e.type]](),i=r.length;let a,o=i>1?r[1]-r[0]:r[0];for(a=1;a<i;++a)o=Math.min(o,r[a]-r[a-1]);return t.formatSpan(0,o,30,n)}(t,e,i):Cd(t,e,n,i,a,o);return"symbol"===r&&(t=>Sd[t.type]||t.bins)(e)?Fd(s):"discrete"===r?Id(s):Md(s)}const Fd=t=>(e,n,r)=>{const i=Dd(r[n+1],Dd(r.max,1/0)),a=$d(e,t),o=$d(i,t);return a&&o?a+"  "+o:o?"< "+o:" "+a},Dd=(t,e)=>null!=t?t:e,Id=t=>(e,n)=>n?t(e):null,Md=t=>e=>t(e),$d=(t,e)=>Number.isFinite(t)?e(t):null;function Rd(t,e,n,r){const i=r||e.type;return mo(n)&&md(i,"temporal")&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||"time"!==i?n||i!==ad?Td(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function Bd(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=Rd(t,e,n.format,n.formatType);if(md(e.type,"discretizing")){const t=Nd(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if(gd(e.type)){const t=e.domain(),n=t.length,a=n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ");return"".concat(n," value").concat(1===n?"":"s",": ").concat(a)}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i(oo(t)))}}let zd=0;function Ld(t){return t&&t.gradient}function Pd(t,e,n){const r=t.gradient;let i=t.id,a="radial"===r?"p_":"";return i||(i=t.id="gradient_"+zd++,"radial"===r?(t.x1=qd(t.x1,.5),t.y1=qd(t.y1,.5),t.r1=qd(t.r1,0),t.x2=qd(t.x2,.5),t.y2=qd(t.y2,.5),t.r2=qd(t.r2,.5),a="p_"):(t.x1=qd(t.x1,0),t.y1=qd(t.y1,0),t.x2=qd(t.x2,1),t.y2=qd(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+a+i+")"}function qd(t,e){return null!=t?t:e}const Wd={basis:{curve:vo},"basis-closed":{curve:ko},"basis-open":{curve:_o},bundle:{curve:Co,tension:"beta",value:.85},cardinal:{curve:jo,tension:"tension",value:0},"cardinal-open":{curve:To,tension:"tension",value:0},"cardinal-closed":{curve:Do,tension:"tension",value:0},"catmull-rom":{curve:Xo,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Yo,tension:"alpha",value:.5},"catmull-rom-open":{curve:Zo,tension:"alpha",value:.5},linear:{curve:ts},"linear-closed":{curve:ns},monotone:{horizontal:ds,vertical:ls},natural:{curve:ps},step:{curve:gs},"step-after":{curve:ys},"step-before":{curve:bs}};function Ud(t,e,n){var r=ho(Wd,t)&&Wd[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const Vd={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Gd=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function Hd(t){const e=[];let n,r,i,a,o,s,u,c,l,d;const f=t.slice().replace(Gd[0],"###$1").split(Gd[1]).slice(1);for(u=0,l=f.length;u<l;++u){for(n=f[u],r=n.slice(1).trim().replace(Gd[2],"$1###$2").replace(Gd[3],"$1###$2").split(Gd[4]),o=n.charAt(0),i=[o],c=0,d=r.length;c<d;++c)(a=+r[c])===a&&i.push(a);if(s=Vd[o.toLowerCase()],i.length-1>s){const t=i.length;for(c=1,e.push([o].concat(i.slice(c,c+=s))),o="M"===o?"L":"m"===o?"l":o;c<t;c+=s)e.push([o].concat(i.slice(c,c+s)))}else e.push(i)}return e}const Xd=Math.PI/180,Kd=Math.PI/2,Yd=2*Math.PI,Jd=Math.sqrt(3)/2;var Zd={},Qd={},tf=[].join;function ef(t){const e=tf.call(t);if(Qd[e])return Qd[e];var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7];const l=c*o,d=-u*s,f=u*o,h=c*s,p=Math.cos(i),m=Math.sin(i),g=Math.cos(a),b=Math.sin(a),y=.5*(a-i),v=Math.sin(.5*y),x=8/3*v*v/Math.sin(y),w=n+p-x*m,k=r+m+x*p,O=n+g,_=r+b,A=O+x*b,C=_-x*g;return Qd[e]=[l*w+d*k,f*w+h*k,l*A+d*C,f*A+h*C,l*O+d*_,f*O+h*_]}const nf=["l",0,0,0,0,0,0,0];function rf(t,e,n){const r=nf[0]=t[0];if("a"===r||"A"===r)nf[1]=e*t[1],nf[2]=n*t[2],nf[3]=t[3],nf[4]=t[4],nf[5]=t[5],nf[6]=e*t[6],nf[7]=n*t[7];else if("h"===r||"H"===r)nf[1]=e*t[1];else if("v"===r||"V"===r)nf[1]=n*t[1];else for(var i=1,a=t.length;i<a;++i)nf[i]=(i%2==1?e:n)*t[i];return nf}function af(t,e,n,r,i,a){var o,s,u,c,l,d=null,f=0,h=0,p=0,m=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==a&&(a=i),t.beginPath&&t.beginPath();for(var g=0,b=e.length;g<b;++g){switch(o=e[g],1===i&&1===a||(o=rf(o,i,a)),o[0]){case"l":f+=o[1],h+=o[2],t.lineTo(f+n,h+r);break;case"L":f=o[1],h=o[2],t.lineTo(f+n,h+r);break;case"h":f+=o[1],t.lineTo(f+n,h+r);break;case"H":f=o[1],t.lineTo(f+n,h+r);break;case"v":h+=o[1],t.lineTo(f+n,h+r);break;case"V":h=o[1],t.lineTo(f+n,h+r);break;case"m":f+=o[1],h+=o[2],t.moveTo(f+n,h+r);break;case"M":f=o[1],h=o[2],t.moveTo(f+n,h+r);break;case"c":s=f+o[5],u=h+o[6],p=f+o[3],m=h+o[4],t.bezierCurveTo(f+o[1]+n,h+o[2]+r,p+n,m+r,s+n,u+r),f=s,h=u;break;case"C":f=o[5],h=o[6],p=o[3],m=o[4],t.bezierCurveTo(o[1]+n,o[2]+r,p+n,m+r,f+n,h+r);break;case"s":s=f+o[3],u=h+o[4],p=2*f-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,f+o[1]+n,h+o[2]+r,s+n,u+r),p=f+o[1],m=h+o[2],f=s,h=u;break;case"S":s=o[3],u=o[4],p=2*f-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,o[1]+n,o[2]+r,s+n,u+r),f=s,h=u,p=o[1],m=o[2];break;case"q":s=f+o[3],u=h+o[4],p=f+o[1],m=h+o[2],t.quadraticCurveTo(p+n,m+r,s+n,u+r),f=s,h=u;break;case"Q":s=o[3],u=o[4],t.quadraticCurveTo(o[1]+n,o[2]+r,s+n,u+r),f=s,h=u,p=o[1],m=o[2];break;case"t":s=f+o[1],u=h+o[2],null===d[0].match(/[QqTt]/)?(p=f,m=h):"t"===d[0]?(p=2*f-c,m=2*h-l):"q"===d[0]&&(p=2*f-p,m=2*h-m),c=p,l=m,t.quadraticCurveTo(p+n,m+r,s+n,u+r),h=u,p=(f=s)+o[1],m=h+o[2];break;case"T":s=o[1],u=o[2],p=2*f-p,m=2*h-m,t.quadraticCurveTo(p+n,m+r,s+n,u+r),f=s,h=u;break;case"a":of(t,f+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+f+n,o[7]+h+r]),f+=o[6],h+=o[7];break;case"A":of(t,f+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),f=o[6],h=o[7];break;case"z":case"Z":t.closePath()}d=o}}function of(t,e,n,r){const i=function(t,e,n,r,i,a,o,s,u){const c=tf.call(arguments);if(Zd[c])return Zd[c];const l=o*Xd,d=Math.sin(l),f=Math.cos(l),h=f*(s-t)*.5+d*(u-e)*.5,p=f*(u-e)*.5-d*(s-t)*.5;let m=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(m=Math.sqrt(m),n*=m,r*=m);const g=f/n,b=d/n,y=-d/r,v=f/r,x=g*s+b*u,w=y*s+v*u,k=g*t+b*e,O=y*t+v*e,_=(k-x)*(k-x)+(O-w)*(O-w);let A=1/_-.25;A<0&&(A=0);let C=Math.sqrt(A);a==i&&(C=-C);const E=.5*(x+k)-C*(O-w),S=.5*(w+O)+C*(k-x),j=Math.atan2(w-S,x-E),N=Math.atan2(O-S,k-E);let T=N-j;T<0&&1===a?T+=Yd:T>0&&0===a&&(T-=Yd);const F=Math.ceil(Math.abs(T/(Kd+.001))),D=[];for(let t=0;t<F;++t){const e=j+t*T/F,i=j+(t+1)*T/F;D[t]=[E,S,e,i,n,r,d,f]}return Zd[c]=D}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let e=0;e<i.length;++e){const n=ef(i[e]);t.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5])}}const sf=.5773502691896257,uf={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,Yd)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,a=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-a),t.lineTo(i,-a),t.lineTo(0,-n),t.lineTo(-i,-a),t.lineTo(-r,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=Jd*n,i=r-n*sf,a=n/4;t.moveTo(0,-r-i),t.lineTo(-a,r-i),t.lineTo(a,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=Jd*n,i=r-n*sf;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Jd*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Jd*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Jd*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Jd*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function cf(t){return ho(uf,t)?uf[t]:function(t){if(!ho(lf,t)){const e=Hd(t);lf[t]={draw:function(t,n){af(t,e,0,0,Math.sqrt(n)/2)}}}return lf[t]}(t)}var lf={};function df(t){return t.x}function ff(t){return t.y}function hf(t){return t.width}function pf(t){return t.height}function mf(t){return"function"==typeof t?t:()=>+t}function gf(t,e,n){return Math.max(e,Math.min(t,n))}function bf(t,e){return null!=t?t:e}const yf=t=>t.x||0,vf=t=>t.y||0,xf=t=>!(!1===t.defined),wf=Ds().startAngle(t=>t.startAngle||0).endAngle(t=>t.endAngle||0).padAngle(t=>t.padAngle||0).innerRadius(t=>t.innerRadius||0).outerRadius(t=>t.outerRadius||0).cornerRadius(t=>t.cornerRadius||0),kf=Bs().x(yf).y1(vf).y0(t=>(t.y||0)+(t.height||0)).defined(xf),Of=Bs().y(vf).x1(yf).x0(t=>(t.x||0)+(t.width||0)).defined(xf),_f=Rs().x(yf).y(vf).defined(xf),Af=function(){var t=df,e=ff,n=hf,r=pf,i=mf(0),a=i,o=i,s=i,u=null;function c(c,l,d){var f,h=null!=l?l:+t.call(this,c),p=null!=d?d:+e.call(this,c),m=+n.call(this,c),g=+r.call(this,c),b=Math.min(m,g)/2,y=gf(+i.call(this,c),0,b),v=gf(+a.call(this,c),0,b),x=gf(+o.call(this,c),0,b),w=gf(+s.call(this,c),0,b);if(u||(u=f=_s()),y<=0&&v<=0&&x<=0&&w<=0)u.rect(h,p,m,g);else{var k=h+m,O=p+g;u.moveTo(h+y,p),u.lineTo(k-v,p),u.bezierCurveTo(k-.448084975506*v,p,k,p+.448084975506*v,k,p+v),u.lineTo(k,O-w),u.bezierCurveTo(k,O-.448084975506*w,k-.448084975506*w,O,k-w,O),u.lineTo(h+x,O),u.bezierCurveTo(h+.448084975506*x,O,h,O-.448084975506*x,h,O-x),u.lineTo(h,p+y),u.bezierCurveTo(h,p+.448084975506*y,h+.448084975506*y,p,h+y,p),u.closePath()}if(f)return u=null,f+""||null}return c.x=function(e){return arguments.length?(t=mf(e),c):t},c.y=function(t){return arguments.length?(e=mf(t),c):e},c.width=function(t){return arguments.length?(n=mf(t),c):n},c.height=function(t){return arguments.length?(r=mf(t),c):r},c.cornerRadius=function(t,e,n,r){return arguments.length?(i=mf(t),a=null!=e?mf(e):i,s=null!=n?mf(n):i,o=null!=r?mf(r):a,c):i},c.context=function(t){return arguments.length?(u=null==t?null:t,c):u},c}().x(yf).y(vf).width(t=>t.width||0).height(t=>t.height||0).cornerRadius(t=>bf(t.cornerRadiusTopLeft,t.cornerRadius)||0,t=>bf(t.cornerRadiusTopRight,t.cornerRadius)||0,t=>bf(t.cornerRadiusBottomRight,t.cornerRadius)||0,t=>bf(t.cornerRadiusBottomLeft,t.cornerRadius)||0),Cf=Ps().type(t=>cf(t.shape||"circle")).size(t=>bf(t.size,64)),Ef=function(){var t,e,n,r,i,a,o,s,u=null;function c(t,e,n){const r=n/2;if(i){var c=o-e,l=t-a;if(c||l){var d=Math.sqrt(c*c+l*l),f=(c/=d)*s,h=(l/=d)*s,p=Math.atan2(l,c);u.moveTo(a-f,o-h),u.lineTo(t-c*r,e-l*r),u.arc(t,e,r,p-Math.PI,p),u.lineTo(a+f,o+h),u.arc(a,o,s,p,p+Math.PI)}else u.arc(t,e,r,0,Yd);u.closePath()}else i=1;a=t,o=e,s=r}function l(a){var o,s,l,d=a.length,f=!1;for(null==u&&(u=l=_s()),o=0;o<=d;++o)!(o<d&&r(s=a[o],o,a))===f&&(f=!f)&&(i=0),f&&c(+t(s,o,a),+e(s,o,a),+n(s,o,a));if(l)return u=null,l+""||null}return l.x=function(e){return arguments.length?(t=e,l):t},l.y=function(t){return arguments.length?(e=t,l):e},l.size=function(t){return arguments.length?(n=t,l):n},l.defined=function(t){return arguments.length?(r=t,l):r},l.context=function(t){return arguments.length?(u=null==t?null:t,l):u},l}().x(yf).y(vf).defined(xf).size(t=>t.size||1);function Sf(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function jf(t,e,n,r){return Af.context(t)(e,n,r)}var Nf=1;function Tf(t,e,n){var r=e.clip,i=t._defs,a=e.clip_id||(e.clip_id="clip"+Nf++),o=i.clipping[a]||(i.clipping[a]={id:a});return co(r)?o.path=r(null):Sf(n)?o.path=jf(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function Ff(t){this.clear(),t&&this.union(t)}function Df(t){this.mark=t,this.bounds=this.bounds||new Ff}function If(t){Df.call(this,t),this.items=this.items||[]}function Mf(t){this._pending=0,this._loader=t||Object(en.e)()}function $f(t){t._pending+=1}function Rf(t){t._pending-=1}function Bf(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}Ff.prototype={clone(){return new Ff(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(t),u=Math.sin(t),c=e-e*s+n*u,l=n-e*u-n*s;return[s*r-u*i+c,u*r+s*i+l,s*r-u*o+c,u*r+s*o+l,s*a-u*i+c,u*a+s*i+l,s*a-u*o+c,u*a+s*o+l]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},po(If,Df),Mf.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return $f(e),e._loader.sanitize(t,{context:"href"}).then(t=>(Rf(e),t)).catch(()=>(Rf(e),null))},loadImage(t){const e=this,n=Ws();return $f(e),e._loader.sanitize(t,{context:"image"}).then(t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,a=ho(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=a&&(i.crossOrigin=a),i.onload=()=>Rf(e),i.onerror=()=>Rf(e),i.src=r,i}).catch(t=>(Rf(e),{complete:!1,width:0,height:0,src:t&&t.url||""}))},ready(){const t=this;return new Promise(e=>{!function n(r){t.pending()?setTimeout(()=>{n(!0)},10):e(r)}(!1)})}};const zf=Yd-1e-8;let Lf,Pf,qf,Wf,Uf,Vf,Gf,Hf;const Xf=(t,e)=>Lf.add(t,e),Kf=(t,e)=>Xf(Pf=t,qf=e),Yf=t=>Xf(t,Lf.y1),Jf=t=>Xf(Lf.x1,t),Zf=(t,e)=>Uf*t+Gf*e,Qf=(t,e)=>Vf*t+Hf*e,th=(t,e)=>Xf(Zf(t,e),Qf(t,e)),eh=(t,e)=>Kf(Zf(t,e),Qf(t,e));function nh(t,e){return Lf=t,e?(Wf=e*Xd,Uf=Hf=Math.cos(Wf),Vf=Math.sin(Wf),Gf=-Vf):(Uf=Hf=1,Wf=Vf=Gf=0),rh}const rh={beginPath(){},closePath(){},moveTo:eh,lineTo:eh,rect(t,e,n,r){Wf?(th(t+n,e),th(t+n,e+r),th(t,e+r),eh(t,e)):(Xf(t+n,e+r),Kf(t,e))},quadraticCurveTo(t,e,n,r){const i=Zf(t,e),a=Qf(t,e),o=Zf(n,r),s=Qf(n,r);ih(Pf,i,o,Yf),ih(qf,a,s,Jf),Kf(o,s)},bezierCurveTo(t,e,n,r,i,a){const o=Zf(t,e),s=Qf(t,e),u=Zf(n,r),c=Qf(n,r),l=Zf(i,a),d=Qf(i,a);ah(Pf,o,u,l,Yf),ah(qf,s,c,d,Jf),Kf(l,d)},arc(t,e,n,r,i,a){if(r+=Wf,i+=Wf,Pf=n*Math.cos(i)+t,qf=n*Math.sin(i)+e,Math.abs(i-r)>zf)Xf(t-n,e-n),Xf(t+n,e+n);else{const o=r=>Xf(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,u;if(o(r),o(i),i!==r)if((r%=Yd)<0&&(r+=Yd),(i%=Yd)<0&&(i+=Yd),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=Yd,s=r-r%Kd,u=0;u<4&&s>i;++u,s-=Kd)o(s);else for(s=r-r%Kd+Kd,u=0;u<4&&s<i;++u,s+=Kd)o(s)}}};function ih(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function ah(t,e,n,r,i){const a=r-t+3*e-3*n,o=t+n-2*e,s=t-e;let u,c=0,l=0;Math.abs(a)>1e-14?(u=o*o+s*a,u>=0&&(u=Math.sqrt(u),c=(-o+u)/a,l=(-o-u)/a)):c=.5*s/o,0<c&&c<1&&i(oh(c,t,e,n,r)),0<l&&l<1&&i(oh(l,t,e,n,r))}function oh(t,e,n,r,i){const a=1-t,o=a*a,s=t*t;return o*a*e+3*o*t*n+3*a*s*r+s*t*i}var sh=(sh=qs(1,1))?sh.getContext("2d"):null;const uh=new Ff;function ch(t){return function(e,n){if(!sh)return!0;t(sh,e),uh.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=uh;for(let t=i;t<=o;++t)for(let e=r;e<=a;++e)if(sh.isPointInPath(e,t))return!0;return!1}}function lh(t,e){return e.contains(t.x||0,t.y||0)}function dh(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,a=t.height||0;return e.intersects(uh.set(n,r,n+i,r+a))}function fh(t,e,n,r,i){const{x1:a,y1:o,x2:s,y2:u}=t,c=r-e,l=i-n;let d,f,h,p,m=0,g=1;for(p=0;p<4;++p){if(0===p&&(d=-c,f=-(a-e)),1===p&&(d=c,f=s-e),2===p&&(d=-l,f=-(o-n)),3===p&&(d=l,f=u-n),Math.abs(d)<1e-10&&f<0)return!1;if(h=f/d,d<0){if(h>g)return!1;h>m&&(m=h)}else if(d>0){if(h<m)return!1;h<g&&(g=h)}}return!0}function hh(t,e){t.globalCompositeOperation=e.blend||"source-over"}function ph(t,e){return null==t?e:t}function mh(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function gh(t,e,n){return Ld(n)?function(t,e,n){const r=n.width(),i=n.height();let a;if("radial"===e.gradient)a=t.createRadialGradient(n.x1+ph(e.x1,.5)*r,n.y1+ph(e.y1,.5)*i,Math.max(r,i)*ph(e.r1,0),n.x1+ph(e.x2,.5)*r,n.y1+ph(e.y2,.5)*i,Math.max(r,i)*ph(e.r2,.5));else{const o=ph(e.x1,0),s=ph(e.y1,0),u=ph(e.x2,1),c=ph(e.y2,0);if(o!==u&&s!==c&&r!==i){const n=qs(Math.ceil(r),Math.ceil(i)),a=n.getContext("2d");return a.scale(r,i),a.fillStyle=mh(a.createLinearGradient(o,s,u,c),e.stops),a.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}a=t.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+u*r,n.y1+c*i)}return mh(a,e.stops)}(t,n,e.bounds):n}function bh(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=gh(t,e,e.fill),!0)}var yh=[];function vh(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&((n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=gh(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||yh),t.lineDashOffset=e.strokeDashOffset||0),!0))}function xh(t,e){return t.zindex-e.zindex||t.index-e.index}function wh(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,a=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&a.push(e);return t.zdirty=!1,t.zitems=a.sort(xh)}function kh(t,e){var n,r,i=t.items;if(!i||!i.length)return;const a=wh(t);if(a&&a.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=a}for(n=0,r=i.length;n<r;++n)e(i[n])}function Oh(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const a=wh(t);for(a&&a.length&&(i=a),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===a)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function _h(t){return function(e,n,r){kh(n,n=>{r&&!r.intersects(n.bounds)||Ah(t,e,n,n)})}}function Ah(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(hh(e,n),n.fill&&bh(e,n,i)&&e.fill(),n.stroke&&vh(e,n,i)&&e.stroke()))}function Ch(t){return t=t||ro,function(e,n,r,i,a,o){return r*=e.pixelRatio,i*=e.pixelRatio,Oh(n,n=>{const s=n.bounds;if((!s||s.contains(a,o))&&s)return t(e,n,r,i,a,o)?n:void 0})}}function Eh(t,e){return function(n,r,i,a){var o,s,u=Array.isArray(r)?r[0]:r,c=null==e?u.fill:e,l=u.stroke&&n.isPointInStroke;return l&&(o=u.strokeWidth,s=u.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(c&&n.isPointInPath(i,a)||l&&n.isPointInStroke(i,a))}}function Sh(t){return Ch(Eh(t))}function jh(t,e){return"translate("+t+","+e+")"}function Nh(t){return"rotate("+t+")"}function Th(t){return jh(t.x||0,t.y||0)}function Fh(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,a=n.angle||0;t.translate(r,i),a&&t.rotate(a*=Xd),t.beginPath(),e(t,n),a&&t.rotate(-a),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return jh(t.x||0,t.y||0)+(t.angle?" "+Nh(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(nh(t,n.angle),n),Bf(t,n).translate(n.x||0,n.y||0)},draw:_h(r),pick:Sh(r),isect:n||ch(r)}}var Dh=Fh("arc",(function(t,e){return wf.context(t)(e)}));function Ih(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=Eh(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(nh(t),r),Bf(t,r[0]))},draw:(a=r,function(t,e,n){!e.items.length||n&&!n.intersects(e.bounds)||Ah(a,t,e.items[0],e.items)}),pick:function(t,e,n,r,a,o){var s=e.items,u=e.bounds;return!s||!s.length||u&&!u.contains(a,o)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,s,n,r)?s[0]:null)},isect:lh,tip:n};var a}var Mh=Ih("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?Of:kf).curve(Ud(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],a="horizontal"===t[0].orient?"y":"x",o=t.length,s=1/0;--o>=0;)!1!==t[o].defined&&(r=Math.abs(t[o][a]-i))<s&&(s=r,n=t[o]);return n}));function $h(t,e){t.beginPath(),Sf(e)?jf(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function Rh(t){const e=ph(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function Bh(t,e){const n=Rh(e);t("d",jf(null,e,n,n))}function zh(t,e,n,r){const i=Rh(e);t.beginPath(),jf(t,e,(n||0)+i,(r||0)+i)}const Lh=Eh(zh),Ph=Eh(zh,!1),qh=Eh(zh,!0);var Wh={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",Th(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),Bf(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){kh(e,e=>{const r=e.x||0,i=e.y||0,a=e.strokeForeground,o=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&o&&(zh(t,e,r,i),hh(t,e),e.fill&&bh(t,e,o)&&t.fill(),e.stroke&&!a&&vh(t,e,o)&&t.stroke()),t.save(),t.translate(r,i),e.clip&&$h(t,e),n&&n.translate(-r,-i),kh(e,e=>{this.draw(t,e,n)}),n&&n.translate(r,i),t.restore(),a&&e.stroke&&o&&(zh(t,e,r,i),hh(t,e),vh(t,e,o)&&t.stroke())})},pick:function(t,e,n,r,i,a){if(e.bounds&&!e.bounds.contains(i,a)||!e.items)return null;const o=n*t.pixelRatio,s=r*t.pixelRatio;return Oh(e,u=>{let c,l,d;const f=u.bounds;if(f&&!f.contains(i,a))return;l=u.x||0,d=u.y||0;const h=l+(u.width||0),p=d+(u.height||0),m=u.clip;if(m&&(i<l||i>h||a<d||a>p))return;if(t.save(),t.translate(l,d),l=i-l,d=a-d,m&&Sf(u)&&!qh(t,u,o,s))return t.restore(),null;const g=u.strokeForeground,b=!1!==e.interactive;return b&&g&&u.stroke&&Ph(t,u,o,s)?(t.restore(),u):(c=Oh(u,t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,l,d)?this.pick(t,n,r,l,d):null),!c&&b&&(u.fill||!g&&u.stroke)&&Lh(t,u,o,s)&&(c=u),t.restore(),c||null)})},isect:dh,content:function(t,e,n){t("clip-path",e.clip?Tf(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),Bh(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?Bh(t,e):t("d","")}},Uh={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Vh(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(e=>{t.image=e,t.image.url=t.url})),n}function Gh(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function Hh(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function Xh(t,e){return"center"===t?e/2:"right"===t?e:0}function Kh(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var Yh={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=Vh(e,n),i=Gh(e,r),a=Hh(e,r),o=(e.x||0)-Xh(e.align,i),s=(e.y||0)-Kh(e.baseline,a);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",Uh["xmlns:xlink"],"xlink:href"),t("transform",jh(o,s)),t("width",i),t("height",a),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=Gh(e,n),i=Hh(e,n),a=(e.x||0)-Xh(e.align,r),o=(e.y||0)-Kh(e.baseline,i);return t.set(a,o,a+r,o+i)},draw:function(t,e,n){kh(e,e=>{if(n&&!n.intersects(e.bounds))return;const r=Vh(e,this);let i,a,o,s,u=Gh(e,r),c=Hh(e,r),l=(e.x||0)-Xh(e.align,u),d=(e.y||0)-Kh(e.baseline,c);!1!==e.aspect&&(a=r.width/r.height,o=e.width/e.height,a==a&&o==o&&a!==o&&(o<a?(s=u/a,d+=(c-s)/2,c=s):(s=c*a,l+=(u-s)/2,u=s))),(r.complete||r.toDataURL)&&(hh(t,e),t.globalAlpha=null!=(i=e.opacity)?i:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,l,d,u,c))})},pick:Ch(),isect:ro,get:Vh,xOffset:Xh,yOffset:Kh},Jh=Ih("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return _f.curve(Ud(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),a=t.length;--a>=0;)if(!1!==t[a].defined&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<i)return t[a];return null}));function Zh(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,a=e.scaleX||1,o=e.scaleY||1,s=(e.angle||0)*Xd,u=e.pathCache;u&&u.path===n||((e.pathCache=u=Hd(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),af(t,u,0,0,a,o),t.rotate(-s),t.translate(-r,-i)):af(t,u,r,i,a,o)}var Qh={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return jh(t.x||0,t.y||0)+(t.angle?" "+Nh(t.angle):"")+(t.scaleX||t.scaleY?" "+(e=t.scaleX||1,n=t.scaleY||1,"scale("+e+","+n+")"):"");var e,n}(e)),t("d",e.path)},bound:function(t,e){return Zh(nh(t,e.angle),e)?t.set(0,0,0,0):Bf(t,e,!0)},draw:_h(Zh),pick:Sh(Zh),isect:ch(Zh)};function tp(t,e){t.beginPath(),jf(t,e)}var ep={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",jf(null,e))},bound:function(t,e){var n,r;return Bf(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:_h(tp),pick:Sh(tp),isect:dh};function np(t,e,n){var r,i,a,o;return!(!e.stroke||!vh(t,e,n))&&(r=e.x||0,i=e.y||0,a=null!=e.x2?e.x2:r,o=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),!0)}var rp={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",Th(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return Bf(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){kh(e,e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&np(t,e,r)&&(hh(t,e),t.stroke())}})},pick:Ch((function(t,e,n,r){return!!t.isPointInStroke&&(np(t,e,1)&&t.isPointInStroke(n,r))})),isect:function(t,e){const n=t.x||0,r=t.y||0;return fh(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}},ip=Fh("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),ap=Fh("symbol",(function(t,e){return Cf.context(t)(e)}),lh);const op=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},a=(i,a)=>(++r>t&&(n=e,e={},r=1),e[i]=a);return i(),{clear:i,has:t=>ho(e,t)||ho(n,t),get:t=>ho(e,t)?e[t]:ho(n,t)?a(t,n[t]):void 0,set:(t,n)=>ho(e,t)?e[t]=n:a(t,n)}}();var sp={height:hp,measureWidth:dp,estimateWidth:cp,width:cp,canvas:up};function up(t){sp.width=t&&sh?dp:cp}function cp(t,e){return lp(bp(t,e),hp(t))}function lp(t,e){return~~(.8*t.length*e)}function dp(t,e){return hp(t)<=0||!(e=bp(t,e))?0:fp(e,vp(t))}function fp(t,e){const n="(".concat(e,") ").concat(t);let r=op.get(n);return void 0===r&&(sh.font=e,r=sh.measureText(t).width,op.set(n,r)),r}function hp(t){return null!=t.fontSize?+t.fontSize||0:11}function pp(t){return null!=t.lineHeight?t.lineHeight:hp(t)+2}function mp(t){return e=t.lineBreak&&t.text&&!io(t.text)?t.text.split(t.lineBreak):t.text,io(e)?e.length>1?e:e[0]:e;var e}function gp(t){const e=mp(t);return(io(e)?e.length-1:0)*pp(t)}function bp(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(sp.width===dp){const e=vp(t);return t=>fp(t,e)}{const e=hp(t);return t=>lp(t,e)}}(t);if(r(e)<n)return e;var i,a=t.ellipsis||"",o="rtl"===t.dir,s=0,u=e.length;if(n-=r(a),o){for(;s<u;)i=s+u>>>1,r(e.slice(i))>n?s=i+1:u=i;return a+e.slice(s)}for(;s<u;)i=1+(s+u>>>1),r(e.slice(0,i))<n?s=i:u=i-1;return e.slice(0,s)+a}(t,n):n}function yp(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function vp(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+hp(t)+"px "+yp(t,e)}function xp(t){var e=t.baseline,n=hp(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*pp(t):"line-bottom"===e?.29*n-.5*pp(t):0)}up(!0);const wp={left:"start",center:"middle",right:"end"},kp=new Ff;function Op(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-Kd,n+=i*Math.cos(e),r+=i*Math.sin(e)),kp.x1=n,kp.y1=r,kp}function _p(t,e,n){var r,i=sp.height(e),a=e.align,o=Op(e),s=o.x1,u=o.y1,c=e.dx||0,l=(e.dy||0)+xp(e)-Math.round(.8*i),d=mp(e);if(io(d)?(i+=pp(e)*(d.length-1),r=d.reduce((t,n)=>Math.max(t,sp.width(e,n)),0)):r=sp.width(e,d),"center"===a?c-=r/2:"right"===a&&(c-=r),t.set(c+=s,l+=u,c+r,l+i),e.angle&&!n)t.rotate(e.angle*Xd,s,u);else if(2===n)return t.rotatedPoints(e.angle*Xd,s,u);return t}var Ap={arc:Dh,area:Mh,group:Wh,image:Yh,line:Jh,path:Qh,rect:ep,rule:rp,shape:ip,symbol:ap,text:{type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+xp(e),a=Op(e),o=a.x1,s=a.y1,u=e.angle||0;t("text-anchor",wp[e.align]||"start"),u?(n=jh(o,s)+" "+Nh(u),(r||i)&&(n+=" "+jh(r,i))):n=jh(o+r,s+i),t("transform",n)},bound:_p,draw:function(t,e,n){kh(e,e=>{var r,i,a,o,s,u,c,l=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===l||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=vp(e),t.textAlign=e.align||"left",i=(r=Op(e)).x1,a=r.y1,e.angle&&(t.save(),t.translate(i,a),t.rotate(e.angle*Xd),i=a=0),i+=e.dx||0,a+=(e.dy||0)+xp(e),u=mp(e),hh(t,e),io(u))for(s=pp(e),o=0;o<u.length;++o)c=bp(e,u[o]),e.fill&&bh(t,e,l)&&t.fillText(c,i,a),e.stroke&&vh(t,e,l)&&t.strokeText(c,i,a),a+=s;else c=bp(e,u),e.fill&&bh(t,e,l)&&t.fillText(c,i,a),e.stroke&&vh(t,e,l)&&t.strokeText(c,i,a);e.angle&&t.restore()}})},pick:Ch((function(t,e,n,r,i,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=Op(e),s=o.x1,u=o.y1,c=_p(kp,e,1),l=-e.angle*Xd,d=Math.cos(l),f=Math.sin(l),h=d*i-f*a+(s-d*s+f*u),p=f*i+d*a+(u-f*s-d*u);return c.contains(h,p)})),isect:function(t,e){const n=_p(kp,t,2);return fh(e,n[0],n[1],n[2],n[3])||fh(e,n[0],n[1],n[4],n[5])||fh(e,n[4],n[5],n[6],n[7])||fh(e,n[2],n[3],n[6],n[7])}},trail:Ih("trail",(function(t,e){return Ef.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null}))};function Cp(t,e,n){return!t&&"undefined"!=typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function Ep(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function Sp(t,e,n,r){var i,a=t.childNodes[e];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(i=a||null,a=Cp(t.ownerDocument,n,r),t.insertBefore(a,i)),a}function jp(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function Np(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function Tp(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function Fp(t,e){this._active=null,this._handlers={},this._loader=t||Object(en.e)(),this._tooltip=e||Dp}function Dp(t,e,n,r){t.element().setAttribute("title",r||"")}function Ip(t){this._el=null,this._bgcolor=null,this._loader=new Mf(t)}Fp.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const t in e)n.push(...e[t]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then(e=>{const n=new MouseEvent(t.type,t),r=Cp(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)}).catch(()=>{})},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,a,o=t&&t.mark;if(o&&(i=Ap[o.marktype]).tip){for((a=Tp(e,n))[0]-=r[0],a[1]-=r[1];t=t.mark.group;)a[0]-=t.x||0,a[1]-=t.y||0;t=i.tip(o.items,a)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,u+=t.y||0;return{x:s,y:u,width:a,height:o,left:s,top:u,right:s+a,bottom:u+o}}},Ip.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t){const e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then(()=>e):Promise.resolve(e)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then(e=>{e&&t(),n._ready=null})}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const Mp="dragleave",$p="mousedown",Rp="mousemove",Bp="mouseout",zp="click",Lp=Rp,Pp=Bp,qp=zp;function Wp(t,e){Fp.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function Up(t,e){(t=>"touchstart"===t||"touchmove"===t||"touchend"===t?["touchstart","touchmove","touchend"]:[t])(e).forEach(e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e))}function Vp(t,e,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i||(i&&i.exit||this.fire(n,r),this._active=a,this.fire(e,r)),this.fire(t,r)}}function Gp(t){return function(e){this.fire(t,e),this._active=null}}po(Wp,Fp,{initialize(t,e,n){return this._canvas=t&&Ep(t,"canvas"),[zp,$p,Rp,Bp,Mp].forEach(t=>Up(this,t)),Fp.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup","dragenter",Mp,"dragover",$p,"mouseup",Rp,Bp,"mouseover",zp,"dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],DOMMouseScroll(t){this.fire("mousewheel",t)},mousemove:Vp(Rp,"mouseover",Bp),dragover:Vp("dragover","dragenter",Mp),mouseout:Gp(Bp),dragleave:Gp(Mp),mousedown(t){this._down=this._active,this.fire($p,t)},click(t){this._down===this._active&&(this.fire(zp,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",t,!0)},touchmove(t){this.fire("touchmove",t,!0)},touchend(t){this.fire("touchend",t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===qp&&r&&r.href?this.handleHref(e,r,r.href):t!==Lp&&t!==Pp||this.handleTooltip(e,r,t!==Pp),i)for(let t=0,n=i.length;t<n;++t)i[t].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(Up(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=Tp(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const a=this.context();return Ap[t.marktype].pick.call(this,a,t,e,n,r,i)}});var Hp="undefined"!=typeof window&&window.devicePixelRatio||1;function Xp(t){Ip.call(this,t),this._options={},this._redraw=!1,this._dirty=new Ff,this._tempb=new Ff}const Kp=Ip.prototype;function Yp(t,e){Fp.call(this,t,e);const n=this;n._hrefHandler=Jp(n,(t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)}),n._tooltipHandler=Jp(n,(t,e)=>{n.handleTooltip(t,e,t.type!==Pp)})}po(Xp,Ip,{initialize(t,e,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:qs(1,1,this._options.type),t&&this._canvas&&(jp(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),Kp.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(Kp.resize.call(this,t,e,n,r),this._canvas)!function(t,e,n,r,i,a){const o="undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),u=o?Hp:i;t.width=e*u,t.height=n*u;for(const t in a)s[t]=a[t];o&&1!==u&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||to("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty,o=(s=n,u=r,c=i,(new Ff).set(0,0,u,c).translate(-s[0],-s[1]));var s,u,c;e.save();const l=this._redraw||a.empty()?(this._redraw=!1,o.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,o.intersect(a),n);return this.clear(-n[0],-n[1],r,i),this.draw(e,t,l),e.restore(),a.clear(),this},draw(t,e,n){const r=Ap[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),co(n)?(t.beginPath(),n(t),t.clip()):$h(t,e.group)}(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,a=this.context();"pdf"===i.type||i.externalContext||a.clearRect(t,e,n,r),null!=this._bgcolor&&(a.fillStyle=this._bgcolor,a.fillRect(t,e,n,r))}});const Jp=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};po(Yp,Fp,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(qp,this._hrefHandler),r.removeEventListener(Lp,this._tooltipHandler),r.removeEventListener(Pp,this._tooltipHandler)),this._svg=r=t&&Ep(t,"svg"),r&&(r.addEventListener(qp,this._hrefHandler),r.addEventListener(Lp,this._tooltipHandler),r.addEventListener(Pp,this._tooltipHandler)),Fp.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:Jp(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const Zp=(t,e,n)=>({role:t,"aria-roledescription":e,"aria-label":n||void 0}),Qp=go(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),tm={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?am(t):null,i=t.context,a=i.scales[e.scale].value,o=i.dataflow.locale(),s=a.type;return"".concat("left"===n||"right"===n?"Y":"X","-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(gd(s)?"discrete":s," scale")+" with ".concat(Bd(o,a,t))}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?am(t):null,r="".concat(e.type||""," legend").trim(),i=e.scales,a=Object.keys(i),o=t.context,s=o.scales[i[a[0]]].value,u=o.dataflow.locale();return c=r,(c.length?c[0].toUpperCase()+c.slice(1):c)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(t){return(t=t.map(t=>t+("fill"===t||"stroke"===t?" color":""))).length<2?t[0]:t.slice(0,-1).join(", ")+" and "+oo(t)}(a))+" with ".concat(Bd(u,s,t));var c}},"title-text":{desc:"title",caption:t=>"Title text '".concat(im(t),"'")},"title-subtitle":{desc:"subtitle",caption:t=>"Subtitle text '".concat(im(t),"'")}},em={ariaRole:"role",ariaRoleDescription:"aria-roledescription",description:"aria-label"};function nm(t,e){const n=!1===e.aria;if(t("aria-hidden",n||void 0),n||null==e.description)for(const e in em)t(em[e],void 0);else{const n=e.mark.marktype;t("aria-label",e.description),t("role",e.ariaRole||("group"===n?"graphics-object":"graphics-symbol")),t("aria-roledescription",e.ariaRoleDescription||"".concat(n," mark"))}}function rm(t){return!1===t.aria?{"aria-hidden":!0}:Qp[t.role]?null:tm[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return Zp(e.role||"graphics-symbol",e.desc,n.description||r(n))}catch(t){return null}}(t,tm[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some(t=>null!=t.description&&!1!==t.aria);return Zp(n?"graphics-object":"graphics-symbol","".concat(e," mark container"),t.description)}(t)}function im(t){return uo(t.text).join(" ")}function am(t){try{return uo(oo(t.items).items[0].text).join(" ")}catch(t){return null}}const om=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function sm(){let t="",e="",n="";const r=[],i=()=>e=n="",a=(t,n)=>(null!=n&&(e+=" ".concat(t,'="').concat(om(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),o),o={open(s,...u){(a=>{e&&(t+="".concat(e,">").concat(n),i()),r.push(a)})(s),e="<"+s;for(const t of u)for(const e in t)a(e,t[e]);return o},close(){const a=r.pop();return t+=e?e+(n?">".concat(n,"</").concat(a,">"):"/>"):"</".concat(a,">"),i(),o},attr:a,text:t=>(n+=om(t),o),toString:()=>t};return o}const um=t=>function t(e,n){if(e.open(n.tagName),n.hasAttributes()){const t=n.attributes,r=t.length;for(let n=0;n<r;++n)e.attr(t[n].name,t[n].value)}if(n.hasChildNodes()){const r=n.childNodes,i=r.length;for(let n=0;n<i;n++){const i=r[n];3===i.nodeType?e.text(i.nodeValue):t(e,i)}}return e.close()}(sm(),t)+"";const cm={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},lm={fill:"none","stroke-miterlimit":10},dm=Uh.xmlns;function fm(t){Ip.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const hm=Ip.prototype;function pm(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function mm(t,e,n){let r,i,a;if("radial"===e.gradient){let r=Sp(t,n++,"pattern",dm);Om(r,{id:"p_"+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=Sp(r,0,"rect",dm),Om(r,{width:1,height:1,fill:"url(".concat(Am(),"#").concat(e.id,")")}),Om(t=Sp(t,n++,"radialGradient",dm),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else Om(t=Sp(t,n++,"linearGradient",dm),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)a=Sp(t,r,"stop",dm),a.setAttribute("offset",e.stops[r].offset),a.setAttribute("stop-color",e.stops[r].color);return jp(t,r),n}function gm(t,e,n){let r;return(t=Sp(t,n,"clipPath",dm)).setAttribute("id",e.id),e.path?(r=Sp(t,0,"path",dm),r.setAttribute("d",e.path)):(r=Sp(t,0,"rect",dm),Om(r,{x:0,y:0,width:e.width,height:e.height})),jp(t,1),n+1}function bm(t,e,n,r,i){let a,o=t._svg;if(!o&&(a=e.ownerDocument,o=Cp(a,r,dm),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===r))){const e=Cp(a,"path",dm);o.appendChild(e),e.__data__=t;const n=Cp(a,"g",dm);o.appendChild(n),n.__data__=t;const r=Cp(a,"path",dm);o.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(o.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o}po(fm,Ip,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=Sp(t,0,"svg",dm),Om(this._svg,Uh),this._svg.setAttribute("class","marks"),jp(t,1),this._root=Sp(this._svg,0,"g",dm),Om(this._root,lm),jp(this._svg,1)),this.background(this._bgcolor),hm.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),hm.background.apply(this,arguments)},resize(t,e,n,r){return hm.resize.call(this,t,e,n,r),this._svg&&(Om(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=Sp(t,0,"rect",dm),Om(n,{width:this._width,height:this._height,fill:e}));const r=um(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),jp(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,a,o,s,u;for(o=0,s=t.length;o<s;++o)n=t[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=Ap[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,pm(n,e),r.items.forEach(t=>{t.dirty=e})),r.zdirty||(n.exit?(a.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(a,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null):(n=a.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(a,n._svg,n):(this._dirtyAll=!1,pm(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;const r=this._svg,i=Ap[e.marktype],a=!1===e.interactive?"none":null,o="g"===i.tag;let s=null,u=0;const c=bm(e,t,n,"g",r);c.setAttribute("class",Np(e));const l=rm(e);for(const t in l)_m(c,t,l[t]);o||_m(c,"pointer-events",a),_m(c,"clip-path",e.clip?Tf(this,e,e.group):null);const d=t=>{const e=this.isDirty(t),n=bm(t,c,s,i.tag,r);e&&(this._update(i,n,t),o&&function(t,e,n){e=e.lastChild.previousSibling;let r,i=0;kh(n,n=>{r=t.mark(e,n,r),++i}),jp(e,1+i)}(this,n,t)),s=n,++u};return i.nested?e.items.length&&d(e.items[0]):kh(e,d),jp(c,u),c},_update(t,e,n){ym=e,vm=e.__values__,nm(wm,n),t.attr(wm,n,this);const r=xm[t.type];r&&r.call(this,t,e,n),ym&&this.style(ym,n)},style(t,e){if(null!=e)for(const n in cm){let r="font"===n?yp(e):e[n];if(r===vm[n])continue;const i=cm[n];null==r?t.removeAttribute(i):(Ld(r)&&(r=Pd(r,this._defs.gradient,Am())),t.setAttribute(i,r+"")),vm[n]=r}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=Sp(t,1,"defs",dm)),r=mm(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=Sp(t,1,"defs",dm)),r=gm(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):jp(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let ym=null,vm=null;const xm={group(t,e,n){const r=ym=e.childNodes[2];vm=r.__values__,t.foreground(wm,n,this),vm=e.__values__,ym=e.childNodes[1],t.content(wm,n,this);const i=ym=e.childNodes[0];t.background(wm,n,this);const a=!1===n.mark.interactive?"none":null;if(a!==vm.events&&(_m(r,"pointer-events",a),_m(i,"pointer-events",a),vm.events=a),n.strokeForeground&&n.stroke){const t=n.fill;_m(r,"display",null),this.style(i,n),_m(i,"stroke",null),t&&(n.fill=null),vm=r.__values__,this.style(r,n),t&&(n.fill=t),ym=null}else _m(r,"display","none")},image(t,e,n){!1===n.smooth?(km(e,"image-rendering","optimizeSpeed"),km(e,"image-rendering","pixelated")):km(e,"image-rendering",null)},text(t,e,n){const r=mp(n);let i,a,o,s;io(r)?(a=r.map(t=>bp(n,t)),i=a.join("\n"),i!==vm.text&&(jp(e,0),o=e.ownerDocument,s=pp(n),a.forEach((t,r)=>{const i=Cp(o,"tspan",dm);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),e.appendChild(i)}),vm.text=i)):(a=bp(n,r),a!==vm.text&&(e.textContent=a,vm.text=a)),_m(e,"font-family",yp(n)),_m(e,"font-size",hp(n)+"px"),_m(e,"font-style",n.fontStyle),_m(e,"font-variant",n.fontVariant),_m(e,"font-weight",n.fontWeight)}};function wm(t,e,n){e!==vm[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(ym,t,e,n):_m(ym,t,e),vm[t]=e)}function km(t,e,n){n!==vm[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),vm[e]=n)}function Om(t,e){for(const n in e)_m(t,n,e[n])}function _m(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function Am(){let t;return"undefined"==typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function Cm(t){Ip.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}po(Cm,Ip,{svg(){return this._text},_render(t){const e=sm();e.open("svg",lo({},Uh,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",lm,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=Ap[e.marktype],r=n.tag,i=[nm,n.attr];t.open("g",{class:Np(e),"clip-path":e.clip?Tf(this,e,e.group):null},rm(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const a=a=>{const o=this.href(a);if(o&&t.open("a",o),t.open(r,this.attr(e,a,i,"g"!==r?r:null)),"text"===r){const e=mp(a);if(io(e)){const n={x:0,dy:pp(a)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(bp(a,e[r])).close()}else t.text(bp(a,e))}else if("g"===r){const r=a.strokeForeground,i=a.fill,o=a.stroke;r&&o&&(a.stroke=null),t.open("path",this.attr(e,a,n.background,"bgrect")).close(),t.open("g",this.attr(e,a,n.content)),kh(a,e=>this.mark(t,e)),t.close(),r&&o?(i&&(a.fill=null),a.stroke=o,t.open("path",this.attr(e,a,n.foreground,"bgrect")).close(),i&&(a.fill=i)):t.open("path",this.attr(e,a,n.foreground,"bgfore")).close()}t.close(),o&&t.close()};return n.nested?e.items&&e.items.length&&a(e.items[0]):kh(e,a),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then(t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t})}return null},attr(t,e,n,r){const i={},a=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach(t=>t(a,e,this)):n(a,e,this),r&&function(t,e,n,r,i){if(null==e)return t;"bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(t.style="image-rendering: optimizeSpeed; image-rendering: pixelated;");"text"===r&&(t["font-family"]=yp(e),t["font-size"]=hp(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const n in cm){let r=e[n];const a=cm[n];("transparent"!==r||"fill"!==a&&"stroke"!==a)&&null!=r&&(Ld(r)&&(r=Pd(r,i.gradient,"")),t[a]=r)}}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:"p_"+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const Em={};Em.canvas=Em.png={renderer:Xp,headless:Xp,handler:Wp},Em.svg={renderer:fm,headless:Cm,handler:Yp},Em.none={};const Sm=new Ff;const jm="top",Nm="left",Tm="right",Fm="end",Dm="row";function Im(t){Pn.call(this,null,t)}function Mm(t,e,n){return e(t.bounds.clear(),t,n)}po(Im,Pn,{transform(t,e){const n=e.dataflow,r=t.mark,i=r.marktype,a=Ap[i],o=a.bound;let s,u=r.bounds;if(a.nested)r.items.length&&n.dirty(r.items[0]),u=Mm(r,o),r.items.forEach(t=>{t.bounds.clear().union(u)});else if("group"===i||t.modified())switch(e.visit(e.MOD,t=>n.dirty(t)),u.clear(),r.items.forEach(t=>u.union(Mm(t,o))),r.role){case"axis":case"legend":case"title":e.reflow()}else s=e.changed(e.REM),e.visit(e.ADD,t=>{u.union(Mm(t,o))}),e.visit(e.MOD,t=>{s=s||u.alignsWith(t.bounds),n.dirty(t),u.union(Mm(t,o))}),s&&(u.clear(),r.items.forEach(t=>u.union(t.bounds)));return function(t){const e=t.clip;if(co(e))e(nh(Sm.clear()));else{if(!e)return;Sm.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(Sm)}(r),e.modifies("bounds")}});function $m(t){Pn.call(this,0,t)}function Rm(t){Pn.call(this,null,t)}function Bm(t){Pn.call(this,null,t)}$m.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},po($m,Pn,{transform(t,e){const n=(i=e.dataflow)._signals[":vega_identifier:"]||(i._signals[":vega_identifier:"]=i.add(0)),r=t.as;var i;let a=n.value;return e.visit(e.ADD,t=>t[r]=t[r]||++a),n.set(this.value=a),e}}),po(Rm,Pn,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,function(t){const e=t.groups,n=t.parent;return e&&1===e.size?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);const r="group"===n.marktype?If:Df;return e.visit(e.ADD,t=>r.call(t,n)),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e}});const zm={parity:t=>t.filter((t,e)=>e%2?t.opacity=0:1),greedy:(t,e)=>{let n;return t.filter((t,r)=>r&&Lm(n.bounds,t.bounds,e)?t.opacity=0:(n=t,1))}},Lm=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),Pm=(t,e)=>{for(var n,r=1,i=t.length,a=t[0].bounds;r<i;a=n,++r)if(Lm(a,n=t[r].bounds,e))return!0},qm=t=>{const e=t.bounds;return e.width()>1&&e.height()>1},Wm=t=>(t.forEach(t=>t.opacity=1),t),Um=(t,e)=>t.reflow(e.modified()).modifies("opacity");function Vm(t){Pn.call(this,null,t)}po(Bm,Pn,{transform(t,e){const n=zm[t.method]||zm.parity,r=t.separation||0;let i,a,o=e.materialize(e.SOURCE).source;if(!o||!o.length)return;if(!t.method)return t.modified("method")&&(Wm(o),e=Um(e,t)),e;if(o=o.filter(qm),!o.length)return;if(t.sort&&(o=o.slice().sort(t.sort)),i=Wm(o),e=Um(e,t),i.length>=3&&Pm(i,r)){do{i=n(i,r)}while(i.length>=3&&Pm(i,r));i.length<3&&!oo(o).opacity&&(i.length>1&&(oo(i).opacity=0),oo(o).opacity=1)}var s,u,c,l,d;t.boundScale&&t.boundTolerance>=0&&(s=t.boundScale,u=t.boundOrient,c=+t.boundTolerance,l=s.range(),d=new Ff,u===jm||"bottom"===u?d.set(l[0],-1/0,l[1],1/0):d.set(-1/0,l[0],1/0,l[1]),d.expand(c||1),a=t=>d.encloses(t.bounds),o.forEach(t=>{a(t)||(t.opacity=0)}));const f=i[0].mark.bounds.clear();return o.forEach(t=>{t.opacity&&f.union(t.bounds)}),e}}),po(Vm,Pn,{transform(t,e){const n=e.dataflow;if(e.visit(e.ALL,t=>n.dirty(t)),e.fields&&e.fields.zindex){const t=e.source&&e.source[0];t&&(t.mark.zdirty=!0)}}});const Gm=new Ff;function Hm(t,e,n){return t[e]===n?0:(t[e]=n,1)}function Xm(t){var e=t.items[0].orient;return e===Nm||e===Tm}function Km(t,e,n,r){var i,a,o=e.items[0],s=o.datum,u=null!=o.translate?o.translate:.5,c=o.orient,l=function(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}(s),d=o.range,f=o.offset,h=o.position,p=o.minExtent,m=o.maxExtent,g=s.title&&o.items[l[2]].items[0],b=o.titlePadding,y=o.bounds,v=g&&gp(g),x=0,w=0;switch(Gm.clear().union(y),y.clear(),(i=l[0])>-1&&y.union(o.items[i].bounds),(i=l[1])>-1&&y.union(o.items[i].bounds),c){case jm:x=h||0,w=-f,a=Math.max(p,Math.min(m,-y.y1)),y.add(0,-a).add(d,0),g&&Ym(t,g,a,b,v,0,-1,y);break;case Nm:x=-f,w=h||0,a=Math.max(p,Math.min(m,-y.x1)),y.add(-a,0).add(0,d),g&&Ym(t,g,a,b,v,1,-1,y);break;case Tm:x=n+f,w=h||0,a=Math.max(p,Math.min(m,y.x2)),y.add(0,0).add(a,d),g&&Ym(t,g,a,b,v,1,1,y);break;case"bottom":x=h||0,w=r+f,a=Math.max(p,Math.min(m,y.y2)),y.add(0,0).add(d,a),g&&Ym(t,g,a,b,0,0,1,y);break;default:x=o.x,w=o.y}return Bf(y.translate(x,w),o),Hm(o,"x",x+u)|Hm(o,"y",w+u)&&(o.bounds=Gm,t.dirty(o),o.bounds=y,t.dirty(o)),o.mark.bounds.clear().union(y)}function Ym(t,e,n,r,i,a,o,s){const u=e.bounds;if(e.auto){const s=o*(n+i+r);let c=0,l=0;t.dirty(e),a?c=(e.x||0)-(e.x=s):l=(e.y||0)-(e.y=s),e.mark.bounds.clear().union(u.translate(-c,-l)),t.dirty(e)}s.union(u)}const Jm=(t,e)=>Math.floor(Math.min(t,e)),Zm=(t,e)=>Math.ceil(Math.max(t,e));function Qm(t){return(new Ff).set(0,0,t.width||0,t.height||0)}function tg(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function eg(t,e,n){const r=ao(t)?t[e]:t;return null!=r?r:void 0!==n?n:0}function ng(t){return t<0?Math.ceil(-t):0}function rg(t,e,n){var r,i,a,o,s,u,c,l,d,f,h,p=!n.nodirty,m="flush"===n.bounds?Qm:tg,g=Gm.set(0,0,0,0),b=eg(n.align,"column"),y=eg(n.align,Dm),v=eg(n.padding,"column"),x=eg(n.padding,Dm),w=n.columns||e.length,k=w<=0?1:Math.ceil(e.length/w),O=e.length,_=Array(O),A=Array(w),C=0,E=Array(O),S=Array(k),j=0,N=Array(O),T=Array(O),F=Array(O);for(i=0;i<w;++i)A[i]=0;for(i=0;i<k;++i)S[i]=0;for(i=0;i<O;++i)u=e[i],s=F[i]=m(u),u.x=u.x||0,N[i]=0,u.y=u.y||0,T[i]=0,a=i%w,o=~~(i/w),C=Math.max(C,c=Math.ceil(s.x2)),j=Math.max(j,l=Math.ceil(s.y2)),A[a]=Math.max(A[a],c),S[o]=Math.max(S[o],l),_[i]=v+ng(s.x1),E[i]=x+ng(s.y1),p&&t.dirty(e[i]);for(i=0;i<O;++i)i%w==0&&(_[i]=0),i<w&&(E[i]=0);if("each"===b)for(a=1;a<w;++a){for(h=0,i=a;i<O;i+=w)h<_[i]&&(h=_[i]);for(i=a;i<O;i+=w)_[i]=h+A[a-1]}else if("all"===b){for(h=0,i=0;i<O;++i)i%w&&h<_[i]&&(h=_[i]);for(i=0;i<O;++i)i%w&&(_[i]=h+C)}else for(b=!1,a=1;a<w;++a)for(i=a;i<O;i+=w)_[i]+=A[a-1];if("each"===y)for(o=1;o<k;++o){for(h=0,r=(i=o*w)+w;i<r;++i)h<E[i]&&(h=E[i]);for(i=o*w;i<r;++i)E[i]=h+S[o-1]}else if("all"===y){for(h=0,i=w;i<O;++i)h<E[i]&&(h=E[i]);for(i=w;i<O;++i)E[i]=h+j}else for(y=!1,o=1;o<k;++o)for(r=(i=o*w)+w;i<r;++i)E[i]+=S[o-1];for(d=0,i=0;i<O;++i)d=_[i]+(i%w?d:0),N[i]+=d-e[i].x;for(a=0;a<w;++a)for(f=0,i=a;i<O;i+=w)f+=E[i],T[i]+=f-e[i].y;if(b&&eg(n.center,"column")&&k>1)for(i=0;i<O;++i)(d=(s="all"===b?C:A[i%w])-F[i].x2-e[i].x-N[i])>0&&(N[i]+=d/2);if(y&&eg(n.center,Dm)&&1!==w)for(i=0;i<O;++i)(f=(s="all"===y?j:S[~~(i/w)])-F[i].y2-e[i].y-T[i])>0&&(T[i]+=f/2);for(i=0;i<O;++i)g.union(F[i].translate(N[i],T[i]));switch(d=eg(n.anchor,"x"),f=eg(n.anchor,"y"),eg(n.anchor,"column")){case Fm:d-=g.width();break;case"middle":d-=g.width()/2}switch(eg(n.anchor,Dm)){case Fm:f-=g.height();break;case"middle":f-=g.height()/2}for(d=Math.round(d),f=Math.round(f),g.clear(),i=0;i<O;++i)e[i].mark.bounds.clear();for(i=0;i<O;++i)(u=e[i]).x+=N[i]+=d,u.y+=T[i]+=f,g.union(u.mark.bounds.union(u.bounds.translate(N[i],T[i]))),p&&t.dirty(u);return g}function ig(t,e){return"x1"===e?t.x||0:"y1"===e?t.y||0:"x2"===e?(t.x||0)+(t.width||0):"y2"===e?(t.y||0)+(t.height||0):void 0}function ag(t,e){return t.bounds[e]}function og(t,e,n,r,i,a,o,s,u,c,l,d,f,h){var p,m,g,b,y,v,x,w,k,O=n.length,_=0,A=0;if(!O)return _;for(p=l;p<O;p+=d)n[p]&&(_=o(_,u(n[p],c)));if(!e.length)return _;for(e.length>i&&(t.warn("Grid headers exceed limit: "+i),e=e.slice(0,i)),_+=a,m=0,b=e.length;m<b;++m)t.dirty(e[m]),e[m].mark.bounds.clear();for(p=l,m=0,b=e.length;m<b;++m,p+=d){for(y=(v=e[m]).mark.bounds,g=p;g>=0&&null==(x=n[g]);g-=f);s?(w=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),k=_):(w=_,k=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),y.union(v.bounds.translate(w-(v.x||0),k-(v.y||0))),v.x=w,v.y=k,t.dirty(v),A=o(A,y[c])}return A}function sg(t,e,n,r,i,a){if(e){t.dirty(e);var o=n,s=n;r?o=Math.round(i.x1+a*i.width()):s=Math.round(i.y1+a*i.height()),e.bounds.translate(o-(e.x||0),s-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=o,e.y=s,t.dirty(e)}}function ug(t,e,n,r,i,a,o){const s=function(t,e){const n=t[e]||{};return(e,r)=>null!=n[e]?n[e]:null!=t[e]?t[e]:r}(n,e),u=function(t,e){let n=-1/0;return t.forEach(t=>{null!=t.offset&&(n=Math.max(n,t.offset))}),n>-1/0?n:e}(t,s("offset",0)),c=s("anchor","start"),l=c===Fm?1:"middle"===c?.5:0,d={align:"each",bounds:s("bounds","flush"),columns:"vertical"===s("direction")?1:t.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(e){case Nm:d.anchor={x:Math.floor(r.x1)-u,column:Fm,y:l*(o||r.height()+2*r.y1),row:c};break;case Tm:d.anchor={x:Math.ceil(r.x2)+u,y:l*(o||r.height()+2*r.y1),row:c};break;case jm:d.anchor={y:Math.floor(i.y1)-u,row:Fm,x:l*(a||i.width()+2*i.x1),column:c};break;case"bottom":d.anchor={y:Math.ceil(i.y2)+u,x:l*(a||i.width()+2*i.x1),column:c};break;case"top-left":d.anchor={x:u,y:u};break;case"top-right":d.anchor={x:a-u,y:u,column:Fm};break;case"bottom-left":d.anchor={x:u,y:o-u,row:Fm};break;case"bottom-right":d.anchor={x:a-u,y:o-u,column:Fm,row:Fm}}return d}function cg(t,e){var n,r,i=e.items[0],a=i.datum,o=i.orient,s=i.bounds,u=i.x,c=i.y;return i._bounds?i._bounds.clear().union(s):i._bounds=s.clone(),s.clear(),function(t,e,n){var r=e.padding,i=r-n.x,a=r-n.y;if(e.datum.title){var o=e.items[1].items[0],s=o.anchor,u=e.titlePadding||0,c=r-o.x,l=r-o.y;switch(o.orient){case Nm:i+=Math.ceil(o.bounds.width())+u;break;case Tm:case"bottom":break;default:a+=o.bounds.height()+u}switch((i||a)&&dg(t,n,i,a),o.orient){case Nm:l+=lg(e,n,o,s,1,1);break;case Tm:c+=lg(e,n,o,Fm,0,0)+u,l+=lg(e,n,o,s,1,1);break;case"bottom":c+=lg(e,n,o,s,0,0),l+=lg(e,n,o,Fm,-1,0,1)+u;break;default:c+=lg(e,n,o,s,0,0)}(c||l)&&dg(t,o,c,l),(c=Math.round(o.bounds.x1-r))<0&&(dg(t,n,-c,0),dg(t,o,-c,0))}else(i||a)&&dg(t,n,i,a)}(t,i,i.items[0].items[0]),s=function(t,e){return t.items.forEach(t=>e.union(t.bounds)),e.x1=t.padding,e.y1=t.padding,e}(i,s),n=2*i.padding,r=2*i.padding,s.empty()||(n=Math.ceil(s.width()+n),r=Math.ceil(s.height()+r)),"symbol"===a.type&&function(t){const e=t.reduce((t,e)=>(t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0),t),{});t.forEach(t=>{t.width=e[t.column],t.height=t.bounds.y2-t.y})}(i.items[0].items[0].items[0].items),"none"!==o&&(i.x=u=0,i.y=c=0),i.width=n,i.height=r,Bf(s.set(u,c,u+n,c+r),i),i.mark.bounds.clear().union(s),i}function lg(t,e,n,r,i,a,o){const s="symbol"!==t.datum.type,u=n.datum.vgrad,c=(!s||!a&&u||o?e:e.items[0]).bounds[i?"y2":"x2"]-t.padding,l=u&&a?c:0,d=u&&a?0:c,f=i<=0?0:gp(n);return Math.round("start"===r?l:r===Fm?d-f:.5*(c-f))}function dg(t,e,n,r){e.x+=n,e.y+=r,e.bounds.translate(n,r),e.mark.bounds.translate(n,r),t.dirty(e)}function fg(t){Pn.call(this,null,t)}function hg(t,e,n){return t.fields=e||[],t.fname=n,t}function pg(t){return 1===t.length?mg(t[0]):gg(t)}po(fg,Pn,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach(e=>{t.layout&&function(t,e,n){var r,i,a,o,s,u,c,l=function(t){var e,n,r=t.items,i=r.length,a=0;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;a<i;++a)if(n=(e=r[a]).items,"group"===e.marktype)switch(e.role){case"axis":case"legend":case"title":break;case"row-header":o.rowheaders.push(...n);break;case"row-footer":o.rowfooters.push(...n);break;case"column-header":o.colheaders.push(...n);break;case"column-footer":o.colfooters.push(...n);break;case"row-title":o.rowtitle=n[0];break;case"column-title":o.coltitle=n[0];break;default:o.marks.push(...n)}return o}(e),d=l.marks,f="flush"===n.bounds?ig:ag,h=n.offset,p=n.columns||d.length,m=p<=0?1:Math.ceil(d.length/p),g=m*p;const b=rg(t,d,n);b.empty()&&b.set(0,0,0,0),l.rowheaders&&(u=eg(n.headerBand,Dm,null),r=og(t,l.rowheaders,d,p,m,-eg(h,"rowHeader"),Jm,0,f,"x1",0,p,1,u)),l.colheaders&&(u=eg(n.headerBand,"column",null),i=og(t,l.colheaders,d,p,p,-eg(h,"columnHeader"),Jm,1,f,"y1",0,1,p,u)),l.rowfooters&&(u=eg(n.footerBand,Dm,null),a=og(t,l.rowfooters,d,p,m,eg(h,"rowFooter"),Zm,0,f,"x2",p-1,p,1,u)),l.colfooters&&(u=eg(n.footerBand,"column",null),o=og(t,l.colfooters,d,p,p,eg(h,"columnFooter"),Zm,1,f,"y2",g-p,1,p,u)),l.rowtitle&&(s=eg(n.titleAnchor,Dm),c=eg(h,"rowTitle"),c=s===Fm?a+c:r-c,u=eg(n.titleBand,Dm,.5),sg(t,l.rowtitle,c,0,b,u)),l.coltitle&&(s=eg(n.titleAnchor,"column"),c=eg(h,"columnTitle"),c=s===Fm?o+c:i-c,u=eg(n.titleBand,"column",.5),sg(t,l.coltitle,c,1,b,u))}(n,e,t.layout),function(t,e,n){var r,i,a,o,s,u=e.items,c=Math.max(0,e.width||0),l=Math.max(0,e.height||0),d=(new Ff).set(0,0,c,l),f=d.clone(),h=d.clone(),p=[];for(o=0,s=u.length;o<s;++o)switch((i=u[o]).role){case"axis":(Xm(i)?f:h).union(Km(t,i,c,l));break;case"title":r=i;break;case"legend":p.push(cg(t,i));break;case"frame":case"scope":case"row-header":case"row-footer":case"row-title":case"column-header":case"column-footer":case"column-title":f.union(i.bounds),h.union(i.bounds);break;default:d.union(i.bounds)}if(p.length){const e={};p.forEach(t=>{"none"!==(a=t.orient||Tm)&&(e[a]||(e[a]=[])).push(t)});for(const r in e){const i=e[r];rg(t,i,ug(i,r,n.legends,f,h,c,l))}p.forEach(e=>{const r=e.bounds;if(r.equals(e._bounds)||(e.bounds=e._bounds,t.dirty(e),e.bounds=r,t.dirty(e)),n.autosize&&"fit"===n.autosize.type)switch(e.orient){case Nm:case Tm:d.add(r.x1,0).add(r.x2,0);break;case jm:case"bottom":d.add(0,r.y1).add(0,r.y2)}else d.union(r)})}d.union(f).union(h),r&&d.union(function(t,e,n,r,i){var a,o=e.items[0],s=o.frame,u=o.orient,c=o.anchor,l=o.offset,d=o.padding,f=o.items[0].items[0],h=o.items[1]&&o.items[1].items[0],p=u===Nm||u===Tm?r:n,m=0,g=0,b=0,y=0,v=0;if("group"!==s?u===Nm?(m=i.y2,p=i.y1):u===Tm?(m=i.y1,p=i.y2):(m=i.x1,p=i.x2):u===Nm&&(m=r,p=0),a="start"===c?m:c===Fm?p:(m+p)/2,h&&h.text){switch(u){case jm:case"bottom":v=f.bounds.height()+d;break;case Nm:y=f.bounds.width()+d;break;case Tm:y=-f.bounds.width()-d}Gm.clear().union(h.bounds),Gm.translate(y-(h.x||0),v-(h.y||0)),Hm(h,"x",y)|Hm(h,"y",v)&&(t.dirty(h),h.bounds.clear().union(Gm),h.mark.bounds.clear().union(Gm),t.dirty(h)),Gm.clear().union(h.bounds)}else Gm.clear();switch(Gm.union(f.bounds),u){case jm:g=a,b=i.y1-Gm.height()-l;break;case Nm:g=i.x1-Gm.width()-l,b=a;break;case Tm:g=i.x2+Gm.width()+l,b=a;break;case"bottom":g=a,b=i.y2+l;break;default:g=o.x,b=o.y}return Hm(o,"x",g)|Hm(o,"y",b)&&(Gm.translate(g,b),t.dirty(o),o.bounds.clear().union(Gm),e.bounds.clear().union(Gm),t.dirty(o)),o.bounds}(t,r,c,l,d));e.clip&&d.set(0,0,e.width||0,e.height||0);!function(t,e,n,r){const i=r.autosize||{},a=i.type;if(t._autosize<1||!a)return;let o=t._width,s=t._height,u=Math.max(0,e.width||0),c=Math.max(0,Math.ceil(-n.x1)),l=Math.max(0,e.height||0),d=Math.max(0,Math.ceil(-n.y1));const f=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-l));if("padding"===i.contains){const e=t.padding();o-=e.left+e.right,s-=e.top+e.bottom}"none"===a?(c=0,d=0,u=o,l=s):"fit"===a?(u=Math.max(0,o-c-f),l=Math.max(0,s-d-h)):"fit-x"===a?(u=Math.max(0,o-c-f),s=l+d+h):"fit-y"===a?(o=u+c+f,l=Math.max(0,s-d-h)):"pad"===a&&(o=u+c+f,s=l+d+h);t._resizeView(o,s,u,l,[c,d],i.resize)}(t,e,d,n)}(n,e,t)}),(r=t.mark.group)&&"legend-entry"!==r.mark.role?e.reflow():e;var r}});const mg=t=>function(e){return e[t]},gg=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function bg(t){throw Error(t)}function yg(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||bg("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&bg("Access path missing closing bracket: "+t),o&&bg("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function vg(t,e,n){const r=yg(t);return t=1===r.length?r[0]:t,hg((n&&n.get||pg)(r),[t],e||t)}vg("id");const xg=hg(t=>t,[],"identity"),wg=(hg(()=>0,[],"zero"),hg(()=>1,[],"one")),kg=(hg(()=>!0,[],"true"),hg(()=>!1,[],"false"));var Og=Array.isArray;function _g(t){return t===Object(t)}function Ag(t){return t[t.length-1]}function Cg(t){return null==t||""===t?null:+t}const Eg=t=>e=>t*Math.exp(e),Sg=t=>e=>Math.log(t*e),jg=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),Ng=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,Tg=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function Fg(t,e,n,r,i){const a=r(t[0]),o=r(Ag(t)),s=null!=e?r(e):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function Dg(t,e,n,r){return Fg(t,e,n,Tg(r),Tg(1/r))}function Ig(t){return null!=t?Og(t)?t:[t]:[]}function Mg(t){return"function"==typeof t}function $g(t){return Mg(t)?t:()=>t}const Rg=Object.prototype.hasOwnProperty;function Bg(t,e){return Rg.call(t,e)}const zg={};function Lg(t){let e,n={};function r(t){return Bg(n,t)&&n[t]!==zg}const i={size:0,empty:0,object:n,has:r,get:t=>r(t)?n[t]:void 0,set(t,e){return r(t)||(++i.size,n[t]===zg&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=zg),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const a=n[i];a===zg||e&&e(a)||(t[i]=a,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach(e=>{i.set(e,t[e])}),i}function Pg(t,e,n){const r=t.prototype=Object.create(e.prototype);return r.constructor=t,function(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}(r,n)}function qg(t){return"number"==typeof t}function Wg(t){return"string"==typeof t}function Ug(t){return Og(t)?"["+t.map(Ug)+"]":_g(t)||Wg(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Vg(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function Gg(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}function Hg(){const t=Js().unknown(void 0),e=t.domain,n=t.range;let r,i,a=[0,1],o=!1,s=0,u=0,c=.5;function l(){const t=e().length,l=a[1]<a[0],d=a[1-l],f=Gg(t,s,u);let h=a[l-0];r=(d-h)/(f||1),o&&(r=Math.floor(r)),h+=(d-h-r*(t-s))*c,i=r*(1-s),o&&(h=Math.round(h),i=Math.round(i));const p=ki(t).map(t=>h+r*t);return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},t.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(o=!!t,l()):o},t.padding=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),s=u,l()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},t.paddingOuter=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=a[1]<a[0],o=r?n().reverse():n(),s=o.length-1;let u,c,l,d=+t[0],f=+t[1];return d!=d||f!=f||(f<d&&(l=d,d=f,f=l),f<o[0]||d>a[1-r])?void 0:(u=Math.max(0,Vs(o,d)-1),c=d===f?u:Vs(o,f)-1,d-o[u]>i+1e-10&&++u,r&&(l=u,u=s-c,c=s-l),u>c?void 0:e().slice(u,c+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return Hg().domain(e()).range(a).round(o).paddingInner(s).paddingOuter(u).align(c)},l()}var Xg=Array.prototype.map;function Kg(t){return Xg.call(t,Cg)}const Yg=Array.prototype.slice;const Jg={};function Zg(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,a,o,s=e[0],u=e[1],c=-1;for(u<s&&(i=s,s=u,u=i),a=0,o=n.length;a<o;++a)n[a]>=s&&n[a]<=u&&(c<0&&(c=a),r=a);if(!(c<0))return s=t.invertExtent(n[c]),u=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=t,n};return r.metadata=Vg(Ig(n)),r}function Qg(t,e,n){return arguments.length>1?(Jg[t]=Zg(t,e,n),this):tb(t)?Jg[t]:void 0}function tb(t){return Bg(Jg,t)}function eb(t,e){const n=Jg[t];return n&&n.metadata[e]}function nb(t){return eb(t,"continuous")}function rb(t){return eb(t,"log")}function ib(t){return eb(t,"interpolating")}Qg("identity",fc),Qg("linear",dc,"continuous"),Qg("log",wc,["continuous","log"]),Qg("pow",Cc,"continuous"),Qg("sqrt",Ec,"continuous"),Qg("symlog",Tc,"continuous"),Qg("time",Uc,["continuous","temporal"]),Qg("utc",Jc,["continuous","temporal"]),Qg("sequential",tl,["continuous","interpolating"]),Qg("".concat("sequential","-").concat("linear"),tl,["continuous","interpolating"]),Qg("".concat("sequential","-").concat("log"),el,["continuous","interpolating","log"]),Qg("".concat("sequential","-").concat("pow"),rl,["continuous","interpolating"]),Qg("".concat("sequential","-").concat("sqrt"),il,["continuous","interpolating"]),Qg("".concat("sequential","-").concat("symlog"),nl,["continuous","interpolating"]),Qg("".concat("diverging","-").concat("linear"),sl,["continuous","interpolating"]),Qg("".concat("diverging","-").concat("log"),ul,["continuous","interpolating","log"]),Qg("".concat("diverging","-").concat("pow"),ll,["continuous","interpolating"]),Qg("".concat("diverging","-").concat("sqrt"),dl,["continuous","interpolating"]),Qg("".concat("diverging","-").concat("symlog"),cl,["continuous","interpolating"]),Qg("quantile",fl,["discretizing","quantile"]),Qg("quantize",hl,"discretizing"),Qg("threshold",pl,"discretizing"),Qg("bin-ordinal",(function t(){let e=[],n=[];function r(t){return null==t||t!=t?void 0:n[(Hs(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=Kg(t),r):e.slice()},r.range=function(t){return arguments.length?(n=Yg.call(t),r):n.slice()},r.tickFormat=function(t,n){return tu(e[0],Ag(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),["discrete","discretizing"]),Qg("ordinal",Js,"discrete"),Qg("band",Hg,"discrete"),Qg("point",(function(){return function t(e){const n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return t(n())},e}(Hg().paddingInner(1))}),"discrete");const ab=["clamp","base","constant","exponent"];function ob(t,e,n){return al(sb(e||"rgb",n),t)}function sb(t,e){const n=o[function(t){return"interpolate"+t.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}function ub(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function cb(t,e){for(const n in t)db(n,e(t[n]))}const lb={};function db(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(lb[t]=e,this):lb[t]}cb({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},ub),cb({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},t=>ob(ub(t)));const fb=t=>Og(t)?t.map(t=>String(t)):String(t),hb=(t,e)=>t[1]-e[1],pb=(t,e)=>e[1]-t[1];function mb(t,e,n){let r;var i;return qg(e)&&(t.bins&&(e=Math.max(e,t.bins.length)),null!=n&&(e=Math.min(e,Math.floor(((i=t.domain())&&Ag(i)-i[0]||0)/n||1)))),_g(e)&&(r=e.step,e=e.interval),Wg(e)&&(e="time"===t.type?Object(_i.p)(e):"utc"==t.type?Object(_i.v)(e):bg("Only time and utc scales accept interval strings."),r&&(e=e.every(r))),e}function gb(t,e,n){let r=t.range(),i=r[0],a=Ag(r),o=hb;if(i>a&&(r=a,a=i,i=r,o=pb),i=Math.floor(i),a=Math.ceil(a),e=e.map(e=>[e,t(e)]).filter(t=>i<=t[1]&&t[1]<=a).sort(o).map(t=>t[0]),n>0&&e.length>1){const t=[e[0],Ag(e)];for(;e.length>n&&e.length>=3;)e=e.filter((t,e)=>!(e%2));e.length<3&&(e=t)}return e}function bb(t,e){return t.bins?gb(t,t.bins):t.ticks?t.ticks(e):t.domain()}function yb(t,e,n,r,i,a){const o=e.type;let s=fb;if("time"===o||"time"===i)s=t.timeFormat(r);else if("utc"===o||"utc"===i)s=t.utcFormat(r);else if(rb(o)){const i=t.formatFloat(r);if(a||e.bins)s=i;else{const t=vb(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function vb(t,e,n){const r=bb(t,e),i=t.base(),a=Math.log(i),o=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/a));return e*i<i-.5&&(e*=i),e<=o};return n?r.filter(s):s}const xb={quantile:"quantiles",quantize:"thresholds",threshold:"domain"},wb={quantile:"quantiles",quantize:"domain"};function kb(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=Ag(t),e}(t.bins):"log"===t.type?vb(t,e,!0):xb[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[xb[t.type]]()):bb(t,e)}function Ob(t,e,n,r,i,a,o){const s=wb[e.type]&&"time"!==a&&"utc"!==a?function(t,e,n){const r=e[wb[e.type]](),i=r.length;let a,o=i>1?r[1]-r[0]:r[0];for(a=1;a<i;++a)o=Math.min(o,r[a]-r[a-1]);return t.formatSpan(0,o,30,n)}(t,e,i):yb(t,e,n,i,a,o);return"symbol"===r&&(t=>xb[t.type]||t.bins)(e)?_b(s):"discrete"===r?Cb(s):Eb(s)}const _b=t=>(e,n,r)=>{const i=Ab(r[n+1],Ab(r.max,1/0)),a=Sb(e,t),o=Sb(i,t);return a&&o?a+"  "+o:o?"< "+o:" "+a},Ab=(t,e)=>null!=t?t:e,Cb=t=>(e,n)=>n?t(e):null,Eb=t=>e=>t(e),Sb=(t,e)=>Number.isFinite(t)?e(t):null;function jb(t,e){let n=0;if(void 0===e)for(let e of t)(e=+e)&&(n+=e);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function Nb(t){Pn.call(this,null,t)}function Tb(t){Pn.call(this,null,t)}function Fb(){return dn({})}function Db(t){Pn.call(this,null,t)}function Ib(t){Pn.call(this,[],t)}Pg(Nb,Pn,{transform(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=this.value,a=t.scale,o=mb(a,null==t.count?t.values?t.values.length:10:t.count,t.minstep),s=t.format||yb(n,a,o,t.formatSpecifier,t.formatType,!!t.values),u=t.values?gb(a,t.values,o):bb(a,o);return i&&(r.rem=i),i=u.map((t,e)=>dn({index:e/(u.length-1||1),value:t,label:s(t)})),t.extra&&i.length&&i.push(dn({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),Pg(Tb,Pn,{transform(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.item||Fb,a=t.key||cn,o=this.value;return Og(r.encode)&&(r.encode=null),o&&(t.modified("key")||e.modified(a))&&bg("DataJoin does not support modified key function or fields."),o||(e=e.addAll(),this.value=o=function(t){const e=Lg().test(t=>t.exit);return e.lookup=n=>e.get(t(n)),e}(a)),e.visit(e.ADD,t=>{const e=a(t);let n=o.get(e);n?n.exit?(o.empty--,r.add.push(n)):r.mod.push(n):(n=i(t),o.set(e,n),r.add.push(n)),n.datum=t,n.exit=!1}),e.visit(e.MOD,t=>{const e=a(t),n=o.get(e);n&&(n.datum=t,r.mod.push(n))}),e.visit(e.REM,t=>{const e=a(t),n=o.get(e);t!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++o.empty)}),e.changed(e.ADD_MOD)&&r.modifies("datum"),(e.clean()||t.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),r}}),Pg(Db,Pn,{transform(t,e){var n=e.fork(e.ADD_REM),r=t.mod||!1,i=t.encoders,a=e.encode;if(Og(a)){if(!n.changed()&&!a.every(t=>i[t]))return e.StopPropagation;a=a[0],n.encode=null}var o="enter"===a,s=i.update||kg,u=i.enter||kg,c=i.exit||kg,l=(a&&!o?i[a]:s)||kg;if(e.changed(e.ADD)&&(e.visit(e.ADD,e=>{u(e,t),s(e,t)}),n.modifies(u.output),n.modifies(s.output),l!==kg&&l!==s&&(e.visit(e.ADD,e=>{l(e,t)}),n.modifies(l.output))),e.changed(e.REM)&&c!==kg&&(e.visit(e.REM,e=>{c(e,t)}),n.modifies(c.output)),o||l!==kg){const i=e.MOD|(t.modified()?e.REFLOW:0);o?(e.visit(i,e=>{const i=u(e,t)||r;(l(e,t)||i)&&n.mod.push(e)}),n.mod.length&&n.modifies(u.output)):e.visit(i,e=>{(l(e,t)||r)&&n.mod.push(e)}),n.mod.length&&n.modifies(l.output)}return n.changed()?n:e.StopPropagation}}),Pg(Ib,Pn,{transform(t,e){if(null!=this.value&&!t.modified())return e.StopPropagation;var n,r,i,a,o,s=e.dataflow.locale(),u=e.fork(e.NO_SOURCE|e.NO_FIELDS),c=this.value,l=t.type||"symbol",d=t.scale,f=+t.limit,h=mb(d,null==t.count?5:t.count,t.minstep),p=!!t.values||"symbol"===l,m=t.format||Ob(s,d,h,l,t.formatSpecifier,t.formatType,p),g=t.values||kb(d,h);return c&&(u.rem=c),"symbol"===l?(f&&g.length>f?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),c=g.slice(0,f-1),o=!0):c=g,Mg(i=t.size)?(t.values||0!==d(c[0])||(c=c.slice(1)),a=c.reduce((e,n)=>Math.max(e,i(n,t)),0)):i=$g(a=i||8),c=c.map((e,n)=>dn({index:n,label:m(e,n,c),value:e,offset:a,size:i(e,t)})),o&&(o=g[c.length],c.push(dn({index:c.length,label:"".concat(g.length-c.length," entries"),value:o,offset:a,size:i(o,t)})))):"gradient"===l?(n=d.domain(),r=function(t,e,n){const r=n-e;let i,a,o;return r&&Number.isFinite(r)?(i=(a=t.type).indexOf("-"),a=i<0?a:a.slice(i+1),o=Qg(a)().domain([e,n]).range([0,1]),ab.forEach(e=>t[e]?o[e](t[e]()):0),o):$g(.5)}(d,n[0],Ag(n)),g.length<3&&!t.values&&n[0]!==Ag(n)&&(g=[n[0],Ag(n)]),c=g.map((t,e)=>dn({index:e,label:m(t,e,g),value:t,perc:r(t)}))):(i=g.length-1,r=function(t){const e=t.domain(),n=e.length-1;let r=+e[0],i=+Ag(e),a=i-r;if("threshold"===t.type){const t=n?a/n:.1;r-=t,i+=t,a=i-r}return t=>(t-r)/a}(d),c=g.map((t,e)=>dn({index:e,label:m(t,e,g),value:t,perc:e?r(t):0,perc2:e===i?1:r(g[e+1])}))),u.source=c,u.add=c,this.value=c,u}});const Mb=t=>t.source.x,$b=t=>t.source.y,Rb=t=>t.target.x,Bb=t=>t.target.y;function zb(t){Pn.call(this,{},t)}zb.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},Pg(zb,Pn,{transform(t,e){var n=t.sourceX||Mb,r=t.sourceY||$b,i=t.targetX||Rb,a=t.targetY||Bb,o=t.as||"path",s=t.orient||"vertical",u=t.shape||"line",c=Wb.get(u+"-"+s)||Wb.get(u);return c||bg("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,t=>{t[o]=c(n(t),r(t),i(t),a(t))}),e.reflow(t.modified()).modifies(o)}});const Lb=(t,e,n,r)=>"M"+t+","+e+"L"+n+","+r,Pb=(t,e,n,r)=>{var i=n-t,a=r-e,o=Math.sqrt(i*i+a*a)/2;return"M"+t+","+e+"A"+o+","+o+" "+180*Math.atan2(a,i)/Math.PI+" 0 1 "+n+","+r},qb=(t,e,n,r)=>{const i=n-t,a=r-e,o=.2*(i+a),s=.2*(a-i);return"M"+t+","+e+"C"+(t+o)+","+(e+s)+" "+(n+s)+","+(r-o)+" "+n+","+r},Wb=Lg({line:Lb,"line-radial":(t,e,n,r)=>Lb(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),arc:Pb,"arc-radial":(t,e,n,r)=>Pb(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),curve:qb,"curve-radial":(t,e,n,r)=>qb(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(t,e,n,r)=>"M"+t+","+e+"V"+r+"H"+n,"orthogonal-vertical":(t,e,n,r)=>"M"+t+","+e+"H"+n+"V"+r,"orthogonal-radial":(t,e,n,r)=>{const i=Math.cos(t),a=Math.sin(t),o=Math.cos(n),s=Math.sin(n);return"M"+e*i+","+e*a+"A"+e+","+e+" 0 0,"+((Math.abs(n-t)>Math.PI?n<=t:n>t)?1:0)+" "+e*o+","+e*s+"L"+r*o+","+r*s},"diagonal-horizontal":(t,e,n,r)=>{const i=(t+n)/2;return"M"+t+","+e+"C"+i+","+e+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(t,e,n,r)=>{const i=(e+r)/2;return"M"+t+","+e+"C"+t+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(t,e,n,r)=>{const i=Math.cos(t),a=Math.sin(t),o=Math.cos(n),s=Math.sin(n),u=(e+r)/2;return"M"+e*i+","+e*a+"C"+u*i+","+u*a+" "+u*o+","+u*s+" "+r*o+","+r*s}});function Ub(t){Pn.call(this,null,t)}Ub.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},Pg(Ub,Pn,{transform(t,e){var n,r,i,a=t.as||["startAngle","endAngle"],o=a[0],s=a[1],u=t.field||wg,c=t.startAngle||0,l=null!=t.endAngle?t.endAngle:2*Math.PI,d=e.source,f=d.map(u),h=f.length,p=c,m=(l-c)/jb(f),g=ki(h);for(t.sort&&g.sort((t,e)=>f[t]-f[e]),n=0;n<h;++n)i=f[g[n]],(r=d[g[n]])[o]=p,r[s]=p+=i*m;return this.value=f,e.reflow(t.modified()).modifies(a)}});function Vb(t){return nb(t)&&"sequential"!==t}const Gb=Vg(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function Hb(t){Pn.call(this,null,t),this.modified(!0)}function Xb(t,e,n){rb(t)&&(Math.abs(e.reduce((t,e)=>t+(e<0?-1:e>0?1:0),0))!==e.length&&n.warn("Log scale domain includes zero: "+Ug(e)));return e}function Kb(t,e,n){return Mg(t)&&(e||n)?function(t,e){const n=e[0],r=Ag(e)-n;return function(e){return t(n+e*r)}}(t,Yb(e||[0,1],n)):t}function Yb(t,e){return e?t.slice().reverse():t}function Jb(t){Pn.call(this,null,t)}Pg(Hb,Pn,{transform(t,e){var n=e.dataflow,r=this.value,i=function(t){var e,n=t.type,r="";if("sequential"===n)return"sequential-linear";(function(t){const e=t.type;return nb(e)&&"time"!==e&&"utc"!==e&&(t.scheme||t.range&&t.range.length&&t.range.every(Wg))})(t)&&(e=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(null!=t.domainMid):0,r=2===e?"sequential-":3===e?"diverging-":"");return(r+n||"linear").toLowerCase()}(t);for(i in r&&i===r.type||(this.value=r=Qg(i)()),t)if(!Gb[i]){if("padding"===i&&Vb(r.type))continue;Mg(r[i])?r[i](t[i]):n.warn("Unsupported scale property: "+i)}return function(t,e,n){var r=t.type,i=e.round||!1,a=e.range;if(null!=e.rangeStep)a=function(t,e,n){"band"!==t&&"point"!==t&&bg("Only band and point scales support rangeStep.");var r=(null!=e.paddingOuter?e.paddingOuter:e.padding)||0,i="point"===t?1:(null!=e.paddingInner?e.paddingInner:e.padding)||0;return[0,e.rangeStep*Gg(n,i,r)]}(r,e,n);else if(e.scheme&&(a=function(t,e,n){var r,i,a=e.schemeExtent;Og(e.scheme)?i=ob(e.scheme,e.interpolate,e.interpolateGamma):(r=e.scheme.toLowerCase(),(i=db(r))||bg("Unrecognized scheme name: ".concat(e.scheme)));return n="threshold"===t?n+1:"bin-ordinal"===t?n-1:"quantile"===t||"quantize"===t?+e.schemeCount||5:n,ib(t)?Kb(i,a,e.reverse):Mg(i)?function(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}(Kb(i,a),n):"ordinal"===t?i:i.slice(0,n)}(r,e,n),Mg(a))){if(t.interpolator)return t.interpolator(a);bg("Scale type ".concat(r," does not support interpolating color schemes."))}if(a&&ib(r))return t.interpolator(ob(Yb(a,e.reverse),e.interpolate,e.interpolateGamma));a&&e.interpolate&&t.interpolate?t.interpolate(sb(e.interpolate,e.interpolateGamma)):Mg(t.round)?t.round(i):Mg(t.rangeRound)&&t.interpolate(i?tc:Qu);a&&t.range(Yb(a,e.reverse))}(r,t,function(t,e,n){let r=e.bins;if(r&&!Og(r)){const e=t.domain(),n=e[0],i=Ag(e),a=r.step;let o=null==r.start?n:r.start,s=null==r.stop?i:r.stop;a||bg("Scale bins parameter missing step property."),o<n&&(o=a*Math.ceil(n/a)),s>i&&(s=a*Math.floor(i/a)),r=ki(o,s+a/2,a)}r?t.bins=r:t.bins&&delete t.bins;"bin-ordinal"===t.type&&(r?e.domain||e.domainRaw||(t.domain(r),n=r.length):t.bins=t.domain());return n}(r,t,function(t,e,n){const r=function(t,e,n){return e?(t.domain(Xb(t.type,e,n)),e.length):-1}(t,e.domainRaw,n);if(r>-1)return r;var i,a,o=e.domain,s=t.type,u=e.zero||void 0===e.zero&&function(t){const e=t.type;return!t.bins&&("linear"===e||"pow"===e||"sqrt"===e)}(t);if(!o)return 0;Vb(s)&&e.padding&&o[0]!==Ag(o)&&(o=function(t,e,n,r,i,a){var o=Math.abs(Ag(n)-n[0]),s=o/(o-2*r),u="log"===t?function(t,e,n){const r=Math.sign(t[0]);return Fg(t,e,n,Sg(r),Eg(r))}(e,null,s):"sqrt"===t?Dg(e,null,s,.5):"pow"===t?Dg(e,null,s,i||1):"symlog"===t?function(t,e,n,r){return Fg(t,e,n,jg(r),Ng(r))}(e,null,s,a||1):function(t,e,n){return Fg(t,e,n,Cg,xg)}(e,null,s);return(e=e.slice())[0]=u[0],e[e.length-1]=u[1],e}(s,o,e.range,e.padding,e.exponent,e.constant));if((u||null!=e.domainMin||null!=e.domainMax||null!=e.domainMid)&&(i=(o=o.slice()).length-1||1,u&&(o[0]>0&&(o[0]=0),o[i]<0&&(o[i]=0)),null!=e.domainMin&&(o[0]=e.domainMin),null!=e.domainMax&&(o[i]=e.domainMax),null!=e.domainMid)){const t=(a=e.domainMid)>o[i]?i+1:a<o[0]?0:i;t!==i&&n.warn("Scale domainMid exceeds domain min or max.",a),o.splice(t,0,a)}t.domain(Xb(s,o,n)),"ordinal"===s&&t.unknown(e.domainImplicit?Ys:void 0);e.nice&&t.nice&&t.nice(!0!==e.nice&&mb(t,e.nice)||null);return o.length}(r,t,n))),e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),Pg(Jb,Pn,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(mn(t.sort)),this.modified(n),e}});const Zb=["y0","y1"];function Qb(t){Pn.call(this,null,t)}function ty(t,e,n,r,i){for(var a,o=(e-t.sum)/2,s=t.length,u=0;u<s;++u)(a=t[u])[r]=o,a[i]=o+=Math.abs(n(a))}function ey(t,e,n,r,i){for(var a,o=1/t.sum,s=0,u=t.length,c=0,l=0;c<u;++c)(a=t[c])[r]=s,a[i]=s=o*(l+=Math.abs(n(a)))}function ny(t,e,n,r,i){for(var a,o,s=0,u=0,c=t.length,l=0;l<c;++l)(a=+n(o=t[l]))<0?(o[r]=u,o[i]=u+=a):(o[r]=s,o[i]=s+=a)}function ry(t,e,n){return t.fields=e||[],t.fname=n,t}function iy(t){return null==t?null:t.fname}function ay(t){return null==t?null:t.fields}function oy(t){return 1===t.length?sy(t[0]):uy(t)}Qb.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center","normalize"]},{name:"as",type:"string",array:!0,length:2,default:Zb}]},Pg(Qb,Pn,{transform(t,e){var n,r,i,a,o=t.as||Zb,s=o[0],u=o[1],c=mn(t.sort),l=t.field||wg,d="center"===t.offset?ty:"normalize"===t.offset?ey:ny;for(n=function(t,e,n,r){var i,a,o,s,u,c,l,d,f,h=[],p=t=>t(u);if(null==e)h.push(t.slice());else for(i={},a=0,o=t.length;a<o;++a)u=t[a],c=e.map(p),(l=i[c])||(i[c]=l=[],h.push(l)),l.push(u);for(c=0,f=0,s=h.length;c<s;++c){for(l=h[c],a=0,d=0,o=l.length;a<o;++a)d+=Math.abs(r(l[a]));l.sum=d,d>f&&(f=d),n&&l.sort(n)}return h.max=f,h}(e.source,t.groupby,c,l),r=0,i=n.length,a=n.max;r<i;++r)d(n[r],a,l,s,u);return e.reflow(t.modified()).modifies(o)}});const sy=t=>function(e){return e[t]},uy=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function cy(t){throw Error(t)}function ly(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||cy("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&cy("Access path missing closing bracket: "+t),o&&cy("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function dy(t,e,n){const r=ly(t);return t=1===r.length?r[0]:t,ry((n&&n.get||oy)(r),[t],e||t)}dy("id");const fy=ry(t=>t,[],"identity"),hy=ry(()=>0,[],"zero"),py=ry(()=>1,[],"one");ry(()=>!0,[],"true"),ry(()=>!1,[],"false");var my=Array.isArray;function gy(t){return null!=t?my(t)?t:[t]:[]}function by(t){return"function"==typeof t}function yy(t){return by(t)?t:()=>t}function vy(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}Object.prototype.hasOwnProperty;function xy(t,e,n){const r=t.prototype=Object.create(e.prototype);return r.constructor=t,vy(r,n)}function wy(t){return"number"==typeof t}var ky=t=>t;function Oy(t,e){t&&Ay.hasOwnProperty(t.type)&&Ay[t.type](t,e)}var _y={Feature:function(t,e){Oy(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)Oy(n[r].geometry,e)}},Ay={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){Cy(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Cy(n[r],e,0)},Polygon:function(t,e){Ey(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Ey(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)Oy(n[r],e)}};function Cy(t,e,n){var r,i=-1,a=t.length-n;for(e.lineStart();++i<a;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function Ey(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)Cy(t[n],e,1);e.polygonEnd()}var Sy=function(t,e){t&&_y.hasOwnProperty(t.type)?_y[t.type](t,e):Oy(t,e)};class jy{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],a=t+i,o=Math.abs(t)<Math.abs(i)?t-(a-i):i-(a-t);o&&(e[n++]=o),t=a}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,a=0;if(i>0){for(a=t[--i];i>0&&(e=a,n=t[--i],a=e+n,r=n-(a-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=a+n,n==e-a&&(a=e))}return a}}var Ny=Math.PI,Ty=Ny/2,Fy=Ny/4,Dy=2*Ny,Iy=180/Ny,My=Ny/180,$y=Math.abs,Ry=Math.atan,By=Math.atan2,zy=Math.cos,Ly=Math.ceil,Py=Math.exp,qy=(Math.floor,Math.hypot),Wy=Math.log,Uy=Math.pow,Vy=Math.sin,Gy=Math.sign||function(t){return t>0?1:t<0?-1:0},Hy=Math.sqrt,Xy=Math.tan;function Ky(t){return t>1?0:t<-1?Ny:Math.acos(t)}function Yy(t){return t>1?Ty:t<-1?-Ty:Math.asin(t)}function Jy(){}var Zy,Qy,tv,ev,nv=new jy,rv=new jy,iv={point:Jy,lineStart:Jy,lineEnd:Jy,polygonStart:function(){iv.lineStart=av,iv.lineEnd=uv},polygonEnd:function(){iv.lineStart=iv.lineEnd=iv.point=Jy,nv.add($y(rv)),rv=new jy},result:function(){var t=nv/2;return nv=new jy,t}};function av(){iv.point=ov}function ov(t,e){iv.point=sv,Zy=tv=t,Qy=ev=e}function sv(t,e){rv.add(ev*t-tv*e),tv=t,ev=e}function uv(){sv(Zy,Qy)}var cv=iv,lv=1/0,dv=lv,fv=-lv,hv=fv;var pv,mv,gv,bv,yv={point:function(t,e){t<lv&&(lv=t);t>fv&&(fv=t);e<dv&&(dv=e);e>hv&&(hv=e)},lineStart:Jy,lineEnd:Jy,polygonStart:Jy,polygonEnd:Jy,result:function(){var t=[[lv,dv],[fv,hv]];return fv=hv=-(dv=lv=1/0),t}},vv=0,xv=0,wv=0,kv=0,Ov=0,_v=0,Av=0,Cv=0,Ev=0,Sv={point:jv,lineStart:Nv,lineEnd:Dv,polygonStart:function(){Sv.lineStart=Iv,Sv.lineEnd=Mv},polygonEnd:function(){Sv.point=jv,Sv.lineStart=Nv,Sv.lineEnd=Dv},result:function(){var t=Ev?[Av/Ev,Cv/Ev]:_v?[kv/_v,Ov/_v]:wv?[vv/wv,xv/wv]:[NaN,NaN];return vv=xv=wv=kv=Ov=_v=Av=Cv=Ev=0,t}};function jv(t,e){vv+=t,xv+=e,++wv}function Nv(){Sv.point=Tv}function Tv(t,e){Sv.point=Fv,jv(gv=t,bv=e)}function Fv(t,e){var n=t-gv,r=e-bv,i=Hy(n*n+r*r);kv+=i*(gv+t)/2,Ov+=i*(bv+e)/2,_v+=i,jv(gv=t,bv=e)}function Dv(){Sv.point=jv}function Iv(){Sv.point=$v}function Mv(){Rv(pv,mv)}function $v(t,e){Sv.point=Rv,jv(pv=gv=t,mv=bv=e)}function Rv(t,e){var n=t-gv,r=e-bv,i=Hy(n*n+r*r);kv+=i*(gv+t)/2,Ov+=i*(bv+e)/2,_v+=i,Av+=(i=bv*t-gv*e)*(gv+t),Cv+=i*(bv+e),Ev+=3*i,jv(gv=t,bv=e)}var Bv=Sv;function zv(t){this._context=t}zv.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Dy)}},result:Jy};var Lv,Pv,qv,Wv,Uv,Vv=new jy,Gv={point:Jy,lineStart:function(){Gv.point=Hv},lineEnd:function(){Lv&&Xv(Pv,qv),Gv.point=Jy},polygonStart:function(){Lv=!0},polygonEnd:function(){Lv=null},result:function(){var t=+Vv;return Vv=new jy,t}};function Hv(t,e){Gv.point=Xv,Pv=Wv=t,qv=Uv=e}function Xv(t,e){Wv-=t,Uv-=e,Vv.add(Hy(Wv*Wv+Uv*Uv)),Wv=t,Uv=e}var Kv=Gv;function Yv(){this._string=[]}function Jv(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}Yv.prototype={_radius:4.5,_circle:Jv(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=Jv(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};var Zv=function(t,e){var n,r,i=4.5;function a(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),Sy(t,n(r))),r.result()}return a.area=function(t){return Sy(t,n(cv)),cv.result()},a.measure=function(t){return Sy(t,n(Kv)),Kv.result()},a.bounds=function(t){return Sy(t,n(yv)),yv.result()},a.centroid=function(t){return Sy(t,n(Bv)),Bv.result()},a.projection=function(e){return arguments.length?(n=null==e?(t=null,ky):(t=e).stream,a):t},a.context=function(t){return arguments.length?(r=null==t?(e=null,new Yv):new zv(e=t),"function"!=typeof i&&r.pointRadius(i),a):e},a.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),a):i},a.projection(t).context(e)},Qv=function(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:Jy,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},tx=function(t,e){return $y(t[0]-e[0])<1e-6&&$y(t[1]-e[1])<1e-6};function ex(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var nx=function(t,e,n,r,i){var a,o,s=[],u=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],o=t[e];if(tx(r,o)){if(!r[2]&&!o[2]){for(i.lineStart(),a=0;a<e;++a)i.point((r=t[a])[0],r[1]);return void i.lineEnd()}o[0]+=2e-6}s.push(n=new ex(r,t,null,!0)),u.push(n.o=new ex(r,null,n,!1)),s.push(n=new ex(o,t,null,!1)),u.push(n.o=new ex(o,null,n,!0))}})),s.length){for(u.sort(e),rx(s),rx(u),a=0,o=u.length;a<o;++a)u[a].e=n=!n;for(var c,l,d=s[0];;){for(var f=d,h=!0;f.v;)if((f=f.n)===d)return;c=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(h)for(a=0,o=c.length;a<o;++a)i.point((l=c[a])[0],l[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(h)for(c=f.p.z,a=c.length-1;a>=0;--a)i.point((l=c[a])[0],l[1]);else r(f.x,f.p.x,-1,i);f=f.p}c=(f=f.o).z,h=!h}while(!f.v);i.lineEnd()}}};function rx(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function ix(t){return[By(t[1],t[0]),Yy(t[2])]}function ax(t){var e=t[0],n=t[1],r=zy(n);return[r*zy(e),r*Vy(e),Vy(n)]}function ox(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function sx(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function ux(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function cx(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function lx(t){var e=Hy(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function dx(t){return $y(t[0])<=Ny?t[0]:Gy(t[0])*(($y(t[0])+Ny)%Dy-Ny)}function fx(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}var hx=function(t,e,n,r){return function(i){var a,o,s,u=e(i),c=Qv(),l=e(c),d=!1,f={point:h,lineStart:m,lineEnd:g,polygonStart:function(){f.point=b,f.lineStart=y,f.lineEnd=v,o=[],a=[]},polygonEnd:function(){f.point=h,f.lineStart=m,f.lineEnd=g,o=fx(o);var t=function(t,e){var n=dx(e),r=e[1],i=Vy(r),a=[Vy(n),-zy(n),0],o=0,s=0,u=new jy;1===i?r=Ty+1e-6:-1===i&&(r=-Ty-1e-6);for(var c=0,l=t.length;c<l;++c)if(f=(d=t[c]).length)for(var d,f,h=d[f-1],p=dx(h),m=h[1]/2+Fy,g=Vy(m),b=zy(m),y=0;y<f;++y,p=x,g=k,b=O,h=v){var v=d[y],x=dx(v),w=v[1]/2+Fy,k=Vy(w),O=zy(w),_=x-p,A=_>=0?1:-1,C=A*_,E=C>Ny,S=g*k;if(u.add(By(S*A*Vy(C),b*O+S*zy(C))),o+=E?_+A*Dy:_,E^p>=n^x>=n){var j=sx(ax(h),ax(v));lx(j);var N=sx(a,j);lx(N);var T=(E^_>=0?-1:1)*Yy(N[2]);(r>T||r===T&&(j[0]||j[1]))&&(s+=E^_>=0?1:-1)}}return(o<-1e-6||o<1e-6&&u<-1e-12)^1&s}(a,r);o.length?(d||(i.polygonStart(),d=!0),nx(o,mx,t,n,i)):t&&(d||(i.polygonStart(),d=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),d&&(i.polygonEnd(),d=!1),o=a=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(e,n){t(e,n)&&i.point(e,n)}function p(t,e){u.point(t,e)}function m(){f.point=p,u.lineStart()}function g(){f.point=h,u.lineEnd()}function b(t,e){s.push([t,e]),l.point(t,e)}function y(){l.lineStart(),s=[]}function v(){b(s[0][0],s[0][1]),l.lineEnd();var t,e,n,r,u=l.clean(),f=c.result(),h=f.length;if(s.pop(),a.push(s),s=null,h)if(1&u){if((e=(n=f[0]).length-1)>0){for(d||(i.polygonStart(),d=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else h>1&&2&u&&f.push(f.pop().concat(f.shift())),o.push(f.filter(px))}return f}};function px(t){return t.length>1}function mx(t,e){return((t=t.x)[0]<0?t[1]-Ty-1e-6:Ty-t[1])-((e=e.x)[0]<0?e[1]-Ty-1e-6:Ty-e[1])}var gx=hx((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,o){var s=a>0?Ny:-Ny,u=$y(a-n);$y(u-Ny)<1e-6?(t.point(n,r=(r+o)/2>0?Ty:-Ty),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(a,r),e=0):i!==s&&u>=Ny&&($y(n-i)<1e-6&&(n-=1e-6*i),$y(a-s)<1e-6&&(a-=1e-6*s),r=function(t,e,n,r){var i,a,o=Vy(t-n);return $y(o)>1e-6?Ry((Vy(e)*(a=zy(r))*Vy(n)-Vy(r)*(i=zy(e))*Vy(t))/(i*a*o)):(e+r)/2}(n,r,a,o),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=a,r=o),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*Ty,r.point(-Ny,i),r.point(0,i),r.point(Ny,i),r.point(Ny,0),r.point(Ny,-i),r.point(0,-i),r.point(-Ny,-i),r.point(-Ny,0),r.point(-Ny,i);else if($y(t[0]-e[0])>1e-6){var a=t[0]<e[0]?Ny:-Ny;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(e[0],e[1])}),[-Ny,-Ty]);var bx=function(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n};function yx(t,e){return[$y(t)>Ny?t+Math.round(-t/Dy)*Dy:t,e]}function vx(t,e,n){return(t%=Dy)?e||n?bx(wx(t),kx(e,n)):wx(t):e||n?kx(e,n):yx}function xx(t){return function(e,n){return[(e+=t)>Ny?e-Dy:e<-Ny?e+Dy:e,n]}}function wx(t){var e=xx(t);return e.invert=xx(-t),e}function kx(t,e){var n=zy(t),r=Vy(t),i=zy(e),a=Vy(e);function o(t,e){var o=zy(e),s=zy(t)*o,u=Vy(t)*o,c=Vy(e),l=c*n+s*r;return[By(u*i-l*a,s*n-c*r),Yy(l*i+u*a)]}return o.invert=function(t,e){var o=zy(e),s=zy(t)*o,u=Vy(t)*o,c=Vy(e),l=c*i-u*a;return[By(u*i+c*a,s*n+l*r),Yy(l*n-s*r)]},o}yx.invert=yx;function Ox(t,e,n,r,i,a){if(n){var o=zy(e),s=Vy(e),u=r*n;null==i?(i=e+r*Dy,a=e-u/2):(i=_x(o,i),a=_x(o,a),(r>0?i<a:i>a)&&(i+=r*Dy));for(var c,l=i;r>0?l>a:l<a;l-=u)c=ix([o,-s*zy(l),-s*Vy(l)]),t.point(c[0],c[1])}}function _x(t,e){(e=ax(e))[0]-=t,lx(e);var n=Ky(-e[1]);return((-e[2]<0?-n:n)+Dy-1e-6)%Dy}var Ax=function(t){var e=zy(t),n=6*My,r=e>0,i=$y(e)>1e-6;function a(t,n){return zy(t)*zy(n)>e}function o(t,n,r){var i=[1,0,0],a=sx(ax(t),ax(n)),o=ox(a,a),s=a[0],u=o-s*s;if(!u)return!r&&t;var c=e*o/u,l=-e*s/u,d=sx(i,a),f=cx(i,c);ux(f,cx(a,l));var h=d,p=ox(f,h),m=ox(h,h),g=p*p-m*(ox(f,f)-1);if(!(g<0)){var b=Hy(g),y=cx(h,(-p-b)/m);if(ux(y,f),y=ix(y),!r)return y;var v,x=t[0],w=n[0],k=t[1],O=n[1];w<x&&(v=x,x=w,w=v);var _=w-x,A=$y(_-Ny)<1e-6;if(!A&&O<k&&(v=k,k=O,O=v),A||_<1e-6?A?k+O>0^y[1]<($y(y[0]-x)<1e-6?k:O):k<=y[1]&&y[1]<=O:_>Ny^(x<=y[0]&&y[0]<=w)){var C=cx(h,(-p+b)/m);return ux(C,f),[y,ix(C)]}}}function s(e,n){var i=r?t:Ny-t,a=0;return e<-i?a|=1:e>i&&(a|=2),n<-i?a|=4:n>i&&(a|=8),a}return hx(a,(function(t){var e,n,u,c,l;return{lineStart:function(){c=u=!1,l=1},point:function(d,f){var h,p=[d,f],m=a(d,f),g=r?m?0:s(d,f):m?s(d+(d<0?Ny:-Ny),f):0;if(!e&&(c=u=m)&&t.lineStart(),m!==u&&(!(h=o(e,p))||tx(e,h)||tx(p,h))&&(p[2]=1),m!==u)l=0,m?(t.lineStart(),h=o(p,e),t.point(h[0],h[1])):(h=o(e,p),t.point(h[0],h[1],2),t.lineEnd()),e=h;else if(i&&e&&r^m){var b;g&n||!(b=o(p,e,!0))||(l=0,r?(t.lineStart(),t.point(b[0][0],b[0][1]),t.point(b[1][0],b[1][1]),t.lineEnd()):(t.point(b[1][0],b[1][1]),t.lineEnd(),t.lineStart(),t.point(b[0][0],b[0][1],3)))}!m||e&&tx(e,p)||t.point(p[0],p[1]),e=p,u=m,n=g},lineEnd:function(){u&&t.lineEnd(),e=null},clean:function(){return l|(c&&u)<<1}}}),(function(e,r,i,a){Ox(a,t,n,i,e,r)}),r?[0,-t]:[-Ny,t-Ny])};function Cx(t,e,n,r){function i(i,a){return t<=i&&i<=n&&e<=a&&a<=r}function a(i,a,s,c){var l=0,d=0;if(null==i||(l=o(i,s))!==(d=o(a,s))||u(i,a)<0^s>0)do{c.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+s+4)%4)!==d);else c.point(a[0],a[1])}function o(r,i){return $y(r[0]-t)<1e-6?i>0?0:3:$y(r[0]-n)<1e-6?i>0?2:1:$y(r[1]-e)<1e-6?i>0?1:0:i>0?3:2}function s(t,e){return u(t.x,e.x)}function u(t,e){var n=o(t,1),r=o(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var u,c,l,d,f,h,p,m,g,b,y,v=o,x=Qv(),w={point:k,lineStart:function(){w.point=O,c&&c.push(l=[]);b=!0,g=!1,p=m=NaN},lineEnd:function(){u&&(O(d,f),h&&g&&x.rejoin(),u.push(x.result()));w.point=k,g&&v.lineEnd()},polygonStart:function(){v=x,u=[],c=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=c.length;n<i;++n)for(var a,o,s=c[n],u=1,l=s.length,d=s[0],f=d[0],h=d[1];u<l;++u)a=f,o=h,d=s[u],f=d[0],h=d[1],o<=r?h>r&&(f-a)*(r-o)>(h-o)*(t-a)&&++e:h<=r&&(f-a)*(r-o)<(h-o)*(t-a)&&--e;return e}(),n=y&&e,i=(u=fx(u)).length;(n||i)&&(o.polygonStart(),n&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),i&&nx(u,s,e,a,o),o.polygonEnd());v=o,u=c=l=null}};function k(t,e){i(t,e)&&v.point(t,e)}function O(a,o){var s=i(a,o);if(c&&l.push([a,o]),b)d=a,f=o,h=s,b=!1,s&&(v.lineStart(),v.point(a,o));else if(s&&g)v.point(a,o);else{var u=[p=Math.max(-1e9,Math.min(1e9,p)),m=Math.max(-1e9,Math.min(1e9,m))],x=[a=Math.max(-1e9,Math.min(1e9,a)),o=Math.max(-1e9,Math.min(1e9,o))];!function(t,e,n,r,i,a){var o,s=t[0],u=t[1],c=0,l=1,d=e[0]-s,f=e[1]-u;if(o=n-s,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<l&&(l=o)}else if(d>0){if(o>l)return;o>c&&(c=o)}if(o=i-s,d||!(o<0)){if(o/=d,d<0){if(o>l)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<l&&(l=o)}if(o=r-u,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<l&&(l=o)}else if(f>0){if(o>l)return;o>c&&(c=o)}if(o=a-u,f||!(o<0)){if(o/=f,f<0){if(o>l)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<l&&(l=o)}return c>0&&(t[0]=s+c*d,t[1]=u+c*f),l<1&&(e[0]=s+l*d,e[1]=u+l*f),!0}}}}}(u,x,t,e,n,r)?s&&(v.lineStart(),v.point(a,o),y=!1):(g||(v.lineStart(),v.point(u[0],u[1])),v.point(x[0],x[1]),s||v.lineEnd(),y=!1)}p=a,m=o,g=s}return w}}function Ex(t){return function(e){var n=new Sx;for(var r in t)n[r]=t[r];return n.stream=e,n}}function Sx(){}function jx(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),Sy(n,t.stream(yv)),e(yv.result()),null!=r&&t.clipExtent(r),t}function Nx(t,e,n){return jx(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+e[0][0]+(r-a*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-a*(n[1][1]+n[0][1]))/2;t.scale(150*a).translate([o,s])}),n)}function Tx(t,e,n){return Nx(t,[[0,0],e],n)}function Fx(t,e,n){return jx(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];t.scale(150*i).translate([a,o])}),n)}function Dx(t,e,n){return jx(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([a,o])}),n)}Sx.prototype={constructor:Sx,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Ix=zy(30*My),Mx=function(t,e){return+e?function(t,e){function n(r,i,a,o,s,u,c,l,d,f,h,p,m,g){var b=c-r,y=l-i,v=b*b+y*y;if(v>4*e&&m--){var x=o+f,w=s+h,k=u+p,O=Hy(x*x+w*w+k*k),_=Yy(k/=O),A=$y($y(k)-1)<1e-6||$y(a-d)<1e-6?(a+d)/2:By(w,x),C=t(A,_),E=C[0],S=C[1],j=E-r,N=S-i,T=y*j-b*N;(T*T/v>e||$y((b*j+y*N)/v-.5)>.3||o*f+s*h+u*p<Ix)&&(n(r,i,a,o,s,u,E,S,A,x/=O,w/=O,k,m,g),g.point(E,S),n(E,S,A,x,w,k,c,l,d,f,h,p,m,g))}}return function(e){var r,i,a,o,s,u,c,l,d,f,h,p,m={point:g,lineStart:b,lineEnd:v,polygonStart:function(){e.polygonStart(),m.lineStart=x},polygonEnd:function(){e.polygonEnd(),m.lineStart=b}};function g(n,r){n=t(n,r),e.point(n[0],n[1])}function b(){l=NaN,m.point=y,e.lineStart()}function y(r,i){var a=ax([r,i]),o=t(r,i);n(l,d,c,f,h,p,l=o[0],d=o[1],c=r,f=a[0],h=a[1],p=a[2],16,e),e.point(l,d)}function v(){m.point=g,e.lineEnd()}function x(){b(),m.point=w,m.lineEnd=k}function w(t,e){y(r=t,e),i=l,a=d,o=f,s=h,u=p,m.point=y}function k(){n(l,d,c,f,h,p,i,a,r,o,s,u,16,e),m.lineEnd=v,v()}return m}}(t,e):function(t){return Ex({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)};var $x=Ex({point:function(t,e){this.stream.point(t*My,e*My)}});function Rx(t,e,n,r,i,a){if(!a)return function(t,e,n,r,i){function a(a,o){return[e+t*(a*=r),n-t*(o*=i)]}return a.invert=function(a,o){return[(a-e)/t*r,(n-o)/t*i]},a}(t,e,n,r,i);var o=zy(a),s=Vy(a),u=o*t,c=s*t,l=o/t,d=s/t,f=(s*n-o*e)/t,h=(s*e+o*n)/t;function p(t,a){return[u*(t*=r)-c*(a*=i)+e,n-c*t-u*a]}return p.invert=function(t,e){return[r*(l*t-d*e+f),i*(h-d*t-l*e)]},p}function Bx(t){return zx((function(){return t}))()}function zx(t){var e,n,r,i,a,o,s,u,c,l,d=150,f=480,h=250,p=0,m=0,g=0,b=0,y=0,v=0,x=1,w=1,k=null,O=gx,_=null,A=ky,C=.5;function E(t){return u(t[0]*My,t[1]*My)}function S(t){return(t=u.invert(t[0],t[1]))&&[t[0]*Iy,t[1]*Iy]}function j(){var t=Rx(d,0,0,x,w,v).apply(null,e(p,m)),r=Rx(d,f-t[0],h-t[1],x,w,v);return n=vx(g,b,y),s=bx(e,r),u=bx(n,s),o=Mx(s,C),N()}function N(){return c=l=null,E}return E.stream=function(t){return c&&l===t?c:c=$x(function(t){return Ex({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(O(o(A(l=t)))))},E.preclip=function(t){return arguments.length?(O=t,k=void 0,N()):O},E.postclip=function(t){return arguments.length?(A=t,_=r=i=a=null,N()):A},E.clipAngle=function(t){return arguments.length?(O=+t?Ax(k=t*My):(k=null,gx),N()):k*Iy},E.clipExtent=function(t){return arguments.length?(A=null==t?(_=r=i=a=null,ky):Cx(_=+t[0][0],r=+t[0][1],i=+t[1][0],a=+t[1][1]),N()):null==_?null:[[_,r],[i,a]]},E.scale=function(t){return arguments.length?(d=+t,j()):d},E.translate=function(t){return arguments.length?(f=+t[0],h=+t[1],j()):[f,h]},E.center=function(t){return arguments.length?(p=t[0]%360*My,m=t[1]%360*My,j()):[p*Iy,m*Iy]},E.rotate=function(t){return arguments.length?(g=t[0]%360*My,b=t[1]%360*My,y=t.length>2?t[2]%360*My:0,j()):[g*Iy,b*Iy,y*Iy]},E.angle=function(t){return arguments.length?(v=t%360*My,j()):v*Iy},E.reflectX=function(t){return arguments.length?(x=t?-1:1,j()):x<0},E.reflectY=function(t){return arguments.length?(w=t?-1:1,j()):w<0},E.precision=function(t){return arguments.length?(o=Mx(s,C=t*t),N()):Hy(C)},E.fitExtent=function(t,e){return Nx(E,t,e)},E.fitSize=function(t,e){return Tx(E,t,e)},E.fitWidth=function(t,e){return Fx(E,t,e)},E.fitHeight=function(t,e){return Dx(E,t,e)},function(){return e=t.apply(this,arguments),E.invert=e.invert&&S,j()}}function Lx(t){var e=0,n=Ny/3,r=zx(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*My,n=t[1]*My):[e*Iy,n*Iy]},i}function Px(t,e){var n=Vy(t),r=(n+Vy(e))/2;if($y(r)<1e-6)return function(t){var e=zy(t);function n(t,n){return[t*e,Vy(n)/e]}return n.invert=function(t,n){return[t/e,Yy(n*e)]},n}(t);var i=1+n*(2*r-n),a=Hy(i)/r;function o(t,e){var n=Hy(i-2*r*Vy(e))/r;return[n*Vy(t*=r),a-n*zy(t)]}return o.invert=function(t,e){var n=a-e,o=By(t,$y(n))*Gy(n);return n*r<0&&(o-=Ny*Gy(t)*Gy(n)),[o/r,Yy((i-(t*t+n*n)*r*r)/(2*r))]},o}var qx=function(){return Lx(Px).scale(155.424).center([0,33.6442])},Wx=function(){return qx().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};function Ux(t){return function(e,n){var r=zy(e),i=zy(n),a=t(r*i);return a===1/0?[2,0]:[a*i*Vy(e),a*Vy(n)]}}function Vx(t){return function(e,n){var r=Hy(e*e+n*n),i=t(r),a=Vy(i),o=zy(i);return[By(e*a,r*o),Yy(r&&n*a/r)]}}var Gx=Ux((function(t){return Hy(2/(1+t))}));Gx.invert=Vx((function(t){return 2*Yy(t/2)}));var Hx=Ux((function(t){return(t=Ky(t))&&t/Vy(t)}));Hx.invert=Vx((function(t){return t}));function Xx(t,e){return[t,Wy(Xy((Ty+e)/2))]}Xx.invert=function(t,e){return[t,2*Ry(Py(e))-Ty]};function Kx(t){var e,n,r,i=Bx(t),a=i.center,o=i.scale,s=i.translate,u=i.clipExtent,c=null;function l(){var a=Ny*o(),s=i(function(t){function e(e){return(e=t(e[0]*My,e[1]*My))[0]*=Iy,e[1]*=Iy,e}return t=vx(t[0]*My,t[1]*My,t.length>2?t[2]*My:0),e.invert=function(e){return(e=t.invert(e[0]*My,e[1]*My))[0]*=Iy,e[1]*=Iy,e},e}(i.rotate()).invert([0,0]));return u(null==c?[[s[0]-a,s[1]-a],[s[0]+a,s[1]+a]]:t===Xx?[[Math.max(s[0]-a,c),e],[Math.min(s[0]+a,n),r]]:[[c,Math.max(s[1]-a,e)],[n,Math.min(s[1]+a,r)]])}return i.scale=function(t){return arguments.length?(o(t),l()):o()},i.translate=function(t){return arguments.length?(s(t),l()):s()},i.center=function(t){return arguments.length?(a(t),l()):a()},i.clipExtent=function(t){return arguments.length?(null==t?c=e=n=r=null:(c=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),l()):null==c?null:[[c,e],[n,r]]},l()}function Yx(t){return Xy((Ty+t)/2)}function Jx(t,e){var n=zy(t),r=t===e?Vy(t):Wy(n/zy(e))/Wy(Yx(e)/Yx(t)),i=n*Uy(Yx(t),r)/r;if(!r)return Xx;function a(t,e){i>0?e<1e-6-Ty&&(e=1e-6-Ty):e>Ty-1e-6&&(e=Ty-1e-6);var n=i/Uy(Yx(e),r);return[n*Vy(r*t),i-n*zy(r*t)]}return a.invert=function(t,e){var n=i-e,a=Gy(r)*Hy(t*t+n*n),o=By(t,$y(n))*Gy(n);return n*r<0&&(o-=Ny*Gy(t)*Gy(n)),[o/r,2*Ry(Uy(i/a,1/r))-Ty]},a}function Zx(t,e){return[t,e]}Zx.invert=Zx;function Qx(t,e){var n=zy(t),r=t===e?Vy(t):(n-zy(e))/(e-t),i=n/r+t;if($y(r)<1e-6)return Zx;function a(t,e){var n=i-e,a=r*t;return[n*Vy(a),i-n*zy(a)]}return a.invert=function(t,e){var n=i-e,a=By(t,$y(n))*Gy(n);return n*r<0&&(a-=Ny*Gy(t)*Gy(n)),[a/r,i-Gy(r)*Hy(t*t+n*n)]},a}var tw=1.340264,ew=-.081106,nw=893e-6,rw=.003796,iw=Hy(3)/2;function aw(t,e){var n=Yy(iw*Vy(e)),r=n*n,i=r*r*r;return[t*zy(n)/(iw*(tw+3*ew*r+i*(7*nw+9*rw*r))),n*(tw+ew*r+i*(nw+rw*r))]}aw.invert=function(t,e){for(var n,r=e,i=r*r,a=i*i*i,o=0;o<12&&(a=(i=(r-=n=(r*(tw+ew*i+a*(nw+rw*i))-e)/(tw+3*ew*i+a*(7*nw+9*rw*i)))*r)*i*i,!($y(n)<1e-12));++o);return[iw*t*(tw+3*ew*i+a*(7*nw+9*rw*i))/zy(r),Yy(Vy(r)/iw)]};function ow(t,e){var n=zy(e),r=zy(t)*n;return[n*Vy(t)/r,Vy(e)/r]}ow.invert=Vx(Ry);function sw(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}sw.invert=function(t,e){var n,r=e,i=25;do{var a=r*r,o=a*a;r-=n=(r*(1.007226+a*(.015085+o*(.028874*a-.044475-.005916*o)))-e)/(1.007226+a*(.045255+o*(.259866*a-.311325-.005916*11*o)))}while($y(n)>1e-6&&--i>0);return[t/(.8707+(a=r*r)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),r]};function uw(t,e){return[zy(e)*Vy(t),Vy(e)]}uw.invert=Vx(Yy);function cw(t,e){var n=zy(e),r=1+zy(t)*n;return[n*Vy(t)/r,Vy(e)/r]}cw.invert=Vx((function(t){return 2*Ry(t)}));function lw(t,e){return[Wy(Xy((Ty+e)/2)),-t]}lw.invert=function(t,e){return[-e,2*Ry(Py(t))-Ty]};var dw=Math.abs,fw=(Math.atan,Math.atan2,Math.ceil,Math.cos),hw=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),pw=(Math.tan,Math.PI),mw=pw/2,gw=(Math.SQRT1_2,yw(2));yw(pw);function bw(t){return t>1?mw:t<-1?-mw:Math.asin(t)}function yw(t){return t>0?Math.sqrt(t):0}function vw(t,e){var n,r=t*hw(e),i=30;do{e-=n=(e+hw(e)-r)/(1+fw(e))}while(dw(n)>1e-6&&--i>0);return e/2}var xw=function(t,e,n){function r(r,i){return[t*r*fw(i=vw(n,i)),e*hw(i)]}return r.invert=function(r,i){return i=bw(i/e),[r/(t*fw(i)),bw((2*i+hw(2*i))/n)]},r}(gw/mw,gw,pw);const ww=Zv(),kw=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Ow(t,e){return function n(){const r=e();return r.type=t,r.path=Zv().projection(r),r.copy=r.copy||function(){const t=n();return kw.forEach(e=>{r[e]&&t[e](r[e]())}),t.path.pointRadius(r.path.pointRadius()),t},r}}function _w(t,e){if(!t||"string"!=typeof t)throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(Cw[t]=Ow(t,e),this):Cw[t]||null}function Aw(t){return t&&t.path||ww}const Cw={albers:Wx,albersusa:function(){var t,e,n,r,i,a,o=Wx(),s=qx().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=qx().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,e){a=[t,e]}};function l(t){var e=t[0],o=t[1];return a=null,n.point(e,o),a||(r.point(e,o),a)||(i.point(e,o),a)}function d(){return t=e=null,l}return l.invert=function(t){var e=o.scale(),n=o.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?u:o).invert(t)},l.stream=function(n){return t&&e===n?t:(r=[o.stream(e=n),s.stream(n),u.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},l.precision=function(t){return arguments.length?(o.precision(t),s.precision(t),u.precision(t),d()):o.precision()},l.scale=function(t){return arguments.length?(o.scale(t),s.scale(.35*t),u.scale(t),l.translate(o.translate())):o.scale()},l.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),a=+t[0],l=+t[1];return n=o.translate(t).clipExtent([[a-.455*e,l-.238*e],[a+.455*e,l+.238*e]]).stream(c),r=s.translate([a-.307*e,l+.201*e]).clipExtent([[a-.425*e+1e-6,l+.12*e+1e-6],[a-.214*e-1e-6,l+.234*e-1e-6]]).stream(c),i=u.translate([a-.205*e,l+.212*e]).clipExtent([[a-.214*e+1e-6,l+.166*e+1e-6],[a-.115*e-1e-6,l+.234*e-1e-6]]).stream(c),d()},l.fitExtent=function(t,e){return Nx(l,t,e)},l.fitSize=function(t,e){return Tx(l,t,e)},l.fitWidth=function(t,e){return Fx(l,t,e)},l.fitHeight=function(t,e){return Dx(l,t,e)},l.scale(1070)},azimuthalequalarea:function(){return Bx(Gx).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return Bx(Hx).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return Lx(Jx).scale(109.5).parallels([30,30])},conicequalarea:qx,conicequidistant:function(){return Lx(Qx).scale(131.154).center([0,13.9389])},equalEarth:function(){return Bx(aw).scale(177.158)},equirectangular:function(){return Bx(Zx).scale(152.63)},gnomonic:function(){return Bx(ow).scale(144.049).clipAngle(60)},identity:function(){var t,e,n,r,i,a,o,s=1,u=0,c=0,l=1,d=1,f=0,h=null,p=1,m=1,g=Ex({point:function(t,e){var n=v([t,e]);this.stream.point(n[0],n[1])}}),b=ky;function y(){return p=s*l,m=s*d,a=o=null,v}function v(n){var r=n[0]*p,i=n[1]*m;if(f){var a=i*t-r*e;r=r*t+i*e,i=a}return[r+u,i+c]}return v.invert=function(n){var r=n[0]-u,i=n[1]-c;if(f){var a=i*t+r*e;r=r*t-i*e,i=a}return[r/p,i/m]},v.stream=function(t){return a&&o===t?a:a=g(b(o=t))},v.postclip=function(t){return arguments.length?(b=t,h=n=r=i=null,y()):b},v.clipExtent=function(t){return arguments.length?(b=null==t?(h=n=r=i=null,ky):Cx(h=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),y()):null==h?null:[[h,n],[r,i]]},v.scale=function(t){return arguments.length?(s=+t,y()):s},v.translate=function(t){return arguments.length?(u=+t[0],c=+t[1],y()):[u,c]},v.angle=function(n){return arguments.length?(e=Vy(f=n%360*My),t=zy(f),y()):f*Iy},v.reflectX=function(t){return arguments.length?(l=t?-1:1,y()):l<0},v.reflectY=function(t){return arguments.length?(d=t?-1:1,y()):d<0},v.fitExtent=function(t,e){return Nx(v,t,e)},v.fitSize=function(t,e){return Tx(v,t,e)},v.fitWidth=function(t,e){return Fx(v,t,e)},v.fitHeight=function(t,e){return Dx(v,t,e)},v},mercator:function(){return Kx(Xx).scale(961/Dy)},mollweide:function(){return Bx(xw).scale(169.529)},naturalEarth1:function(){return Bx(sw).scale(175.295)},orthographic:function(){return Bx(uw).scale(249.5).clipAngle(90.000001)},stereographic:function(){return Bx(cw).scale(250).clipAngle(142)},transversemercator:function(){var t=Kx(lw),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}};for(const t in Cw)_w(t,Cw[t]);function Ew(t,e,n){var r=ki(t,e-1e-6,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function Sw(t,e,n){var r=ki(t,e-1e-6,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function jw(){var t,e,n,r,i,a,o,s,u,c,l,d,f=10,h=f,p=90,m=360,g=2.5;function b(){return{type:"MultiLineString",coordinates:y()}}function y(){return ki(Ly(r/p)*p,n,p).map(l).concat(ki(Ly(s/m)*m,o,m).map(d)).concat(ki(Ly(e/f)*f,t,f).filter((function(t){return $y(t%p)>1e-6})).map(u)).concat(ki(Ly(a/h)*h,i,h).filter((function(t){return $y(t%m)>1e-6})).map(c))}return b.lines=function(){return y().map((function(t){return{type:"LineString",coordinates:t}}))},b.outline=function(){return{type:"Polygon",coordinates:[l(r).concat(d(o).slice(1),l(n).reverse().slice(1),d(s).reverse().slice(1))]}},b.extent=function(t){return arguments.length?b.extentMajor(t).extentMinor(t):b.extentMinor()},b.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],s=+t[0][1],o=+t[1][1],r>n&&(t=r,r=n,n=t),s>o&&(t=s,s=o,o=t),b.precision(g)):[[r,s],[n,o]]},b.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],a=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),a>i&&(n=a,a=i,i=n),b.precision(g)):[[e,a],[t,i]]},b.step=function(t){return arguments.length?b.stepMajor(t).stepMinor(t):b.stepMinor()},b.stepMajor=function(t){return arguments.length?(p=+t[0],m=+t[1],b):[p,m]},b.stepMinor=function(t){return arguments.length?(f=+t[0],h=+t[1],b):[f,h]},b.precision=function(f){return arguments.length?(g=+f,u=Ew(a,i,90),c=Sw(e,t,g),l=Ew(s,o,90),d=Sw(r,n,g),b):g},b.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function Nw(){}const Tw=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Fw(){var t=1,e=1,n=o;function r(t,e){return e.map(e=>i(t,e))}function i(r,i){var o=[],s=[];return function(n,r,i){var o,s,u,c,l,d,f=new Array,h=new Array;o=s=-1,c=n[0]>=r,Tw[c<<1].forEach(p);for(;++o<t-1;)u=c,c=n[o+1]>=r,Tw[u|c<<1].forEach(p);Tw[c<<0].forEach(p);for(;++s<e-1;){for(o=-1,c=n[s*t+t]>=r,l=n[s*t]>=r,Tw[c<<1|l<<2].forEach(p);++o<t-1;)u=c,c=n[s*t+t+o+1]>=r,d=l,l=n[s*t+o+1]>=r,Tw[u|c<<1|l<<2|d<<3].forEach(p);Tw[c|l<<3].forEach(p)}o=-1,l=n[s*t]>=r,Tw[l<<2].forEach(p);for(;++o<t-1;)d=l,l=n[s*t+o+1]>=r,Tw[l<<2|d<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+o,t[0][1]+s],u=[t[1][0]+o,t[1][1]+s],c=a(r),l=a(u);(e=h[c])?(n=f[l])?(delete h[e.end],delete f[n.start],e===n?(e.ring.push(u),i(e.ring)):f[e.start]=h[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete h[e.end],e.ring.push(u),h[e.end=l]=e):(e=f[l])?(n=h[c])?(delete f[e.start],delete h[n.end],e===n?(e.ring.push(u),i(e.ring)):f[n.start]=h[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete f[e.start],e.ring.unshift(r),f[e.start=c]=e):f[c]=h[l]={start:c,end:l,ring:[r,u]}}Tw[l<<3].forEach(p)}(r,i,t=>{n(t,r,i),function(t){var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];for(;++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?o.push([t]):s.push(t)}),s.forEach(t=>{for(var e,n=0,r=o.length;n<r;++n)if(-1!==Dw((e=o[n])[0],t))return void e.push(t)}),{type:"MultiPolygon",value:i,coordinates:o}}function a(e){return 2*e[0]+e[1]*(t+1)*4}function o(n,r,i){n.forEach(n=>{var a,o=n[0],s=n[1],u=0|o,c=0|s,l=r[c*t+u];o>0&&o<t&&u===o&&(a=r[c*t+u-1],n[0]=o+(i-a)/(l-a)-.5),s>0&&s<e&&c===s&&(a=r[(c-1)*t+u],n[1]=s+(i-a)/(l-a)-.5)})}return r.contour=i,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.floor(n[0]),a=Math.floor(n[1]);return i>=0&&a>=0||cy("invalid size"),t=i,e=a,r},r.smooth=function(t){return arguments.length?(n=t?o:Nw,r):n===o},r}function Dw(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=Iw(t,e[r]))return n;return 0}function Iw(t,e){for(var n=e[0],r=e[1],i=-1,a=0,o=t.length,s=o-1;a<o;s=a++){var u=t[a],c=u[0],l=u[1],d=t[s],f=d[0],h=d[1];if(Mw(u,d,e))return 0;l>r!=h>r&&n<(f-c)*(r-l)/(h-l)+c&&(i=-i)}return i}function Mw(t,e,n){var r,i,a,o;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(i=t[r=+(t[0]===e[0])],a=n[r],o=e[r],i<=a&&a<=o||o<=a&&a<=i)}function $w(t,e,n){return function(r){var i=function(t,e){let n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!=r);r=t[++o]);for(i=a=r;o<n;++o)r=t[o],null!=r&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!=r);r=e(t[++o]));for(i=a=r;o<n;++o)r=e(t[o]),null!=r&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]}(r),a=n?Math.min(i[0],0):i[0],o=i[1],s=o-a,u=e?Object(Zs.c)(a,o,t):s/(t+1);return ki(a+u,o,u)}}function Rw(t){Pn.call(this,null,t)}function Bw(t,e,n,r,i){const a=t.x1||0,o=t.y1||0,s=e*n<0;function u(t){t.forEach(c)}function c(t){s&&t.reverse(),t.forEach(l)}function l(t){t[0]=(t[0]-a)*e+r,t[1]=(t[1]-o)*n+i}return function(t){return t.coordinates.forEach(u),t}}function zw(t,e,n){const r=t>=0?t:Tr(e,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function Lw(t){return by(t)?t:yy(+t)}function Pw(){var t=t=>t[0],e=t=>t[1],n=py,r=[-1,-1],i=960,a=500,o=2;function s(s,u){const c=zw(r[0],s,t)>>o,l=zw(r[1],s,e)>>o,d=c?c+2:0,f=l?l+2:0,h=2*d+(i>>o),p=2*f+(a>>o),m=new Float32Array(h*p),g=new Float32Array(h*p);let b=m;s.forEach(r=>{const i=d+(+t(r)>>o),a=f+(+e(r)>>o);i>=0&&i<h&&a>=0&&a<p&&(m[i+a*h]+=+n(r))}),c>0&&l>0?(qw(h,p,m,g,c),Ww(h,p,g,m,l),qw(h,p,m,g,c),Ww(h,p,g,m,l),qw(h,p,m,g,c),Ww(h,p,g,m,l)):c>0?(qw(h,p,m,g,c),qw(h,p,g,m,c),qw(h,p,m,g,c),b=g):l>0&&(Ww(h,p,m,g,l),Ww(h,p,g,m,l),Ww(h,p,m,g,l),b=g);const y=u?Math.pow(2,-2*o):1/jb(b);for(let t=0,e=h*p;t<e;++t)b[t]*=y;return{values:b,scale:1<<o,width:h,height:p,x1:d,y1:f,x2:d+(i>>o),y2:f+(a>>o)}}return s.x=function(e){return arguments.length?(t=Lw(e),s):t},s.y=function(t){return arguments.length?(e=Lw(t),s):e},s.weight=function(t){return arguments.length?(n=Lw(t),s):n},s.size=function(t){if(!arguments.length)return[i,a];var e=+t[0],n=+t[1];return e>=0&&n>=0||cy("invalid size"),i=e,a=n,s},s.cellSize=function(t){return arguments.length?((t=+t)>=1||cy("invalid cell size"),o=Math.floor(Math.log(t)/Math.LN2),s):1<<o},s.bandwidth=function(t){return arguments.length?(1===(t=gy(t)).length&&(t=[+t[0],+t[0]]),2!==t.length&&cy("invalid bandwidth"),r=t,s):r},s}function qw(t,e,n,r,i){const a=1+(i<<1);for(let o=0;o<e;++o)for(let e=0,s=0;e<t+i;++e)e<t&&(s+=n[e+o*t]),e>=i&&(e>=a&&(s-=n[e-a+o*t]),r[e-i+o*t]=s/Math.min(e+1,t-1+a-e,a))}function Ww(t,e,n,r,i){const a=1+(i<<1);for(let o=0;o<t;++o)for(let s=0,u=0;s<e+i;++s)s<e&&(u+=n[o+s*t]),s>=i&&(s>=a&&(u-=n[o+(s-a)*t]),r[o+(s-i)*t]=u/Math.min(s+1,e-1+a-s,a))}function Uw(t){Pn.call(this,null,t)}Rw.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},xy(Rw,Pn,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,i=t.field||fy,a=Fw().smooth(!1!==t.smooth),o=t.thresholds||function(t,e,n){const r=$w(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(t.map(t=>wr(e(t).values)))}(r,i,t),s=null===t.as?null:t.as||"contour",u=[];return r.forEach(e=>{const n=i(e),r=a.size([n.width,n.height])(n.values,my(o)?o:o(n.values));!function(t,e,n,r){let i=r.scale||e.scale,a=r.translate||e.translate;by(i)&&(i=i(n,r));by(a)&&(a=a(n,r));if((1===i||null==i)&&!a)return;const o=(wy(i)?i:i[0])||1,s=(wy(i)?i:i[1])||1,u=a&&a[0]||0,c=a&&a[1]||0;t.forEach(Bw(e,o,s,u,c))}(r,n,e,t),r.forEach(t=>{u.push(hn(e,dn(null!=s?{[s]:t}:t)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}}),Uw.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const Vw=["x","y","weight","size","cellSize","bandwidth"];function Gw(t,e){return Vw.forEach(n=>null!=e[n]?t[n](e[n]):0),t}function Hw(t){Pn.call(this,null,t)}xy(Uw,Pn,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=function(t,e){var n,r,i,a,o,s,u=[],c=t=>t(a);if(null==e)u.push(t);else for(n={},r=0,i=t.length;r<i;++r)a=t[r],o=e.map(c),(s=n[o])||(n[o]=s=[],s.dims=o,u.push(s)),s.push(a);return u}(e.materialize(e.SOURCE).source,t.groupby),a=(t.groupby||[]).map(iy),o=Gw(Pw(),t),s=t.as||"grid";return n=i.map(e=>dn(function(t,e){for(let n=0;n<a.length;++n)t[a[n]]=e[n];return t}({[s]:o(e,t.counts)},e.dims))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),Hw.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},xy(Hw,Pn,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),a=Fw().smooth(!1!==t.smooth),o=t.values,s=t.thresholds||$w(t.count||10,t.nice,!!o),u=t.size;return o||(o=e.materialize(e.SOURCE).source,r=Bw(n=Gw(Pw(),t)(o,!0),n.scale||1,n.scale||1,0,0),u=[n.width,n.height],o=n.values),s=my(s)?s:s(o),o=a.size(u)(o,s),r&&o.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(o||[]).map(dn),i}});function Xw(t){Pn.call(this,null,t)}function Kw(t){Pn.call(this,null,t)}function Yw(t){Pn.call(this,null,t)}function Jw(t){Pn.call(this,null,t)}function Zw(t){Pn.call(this,[],t),this.generator=jw()}function Qw(t){Pn.call(this,null,t)}function tk(t){if(!by(t))return!1;const e=function(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}(ay(t));return e.$x||e.$y||e.$value||e.$max}function ek(t){Pn.call(this,null,t),this.modified(!0)}function nk(t,e,n){by(t[e])&&t[e](n)}function rk(t,e,n){return t.fields=e||[],t.fname=n,t}function ik(t){return null==t?null:t.fields}function ak(t){return 1===t.length?ok(t[0]):sk(t)}Xw.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},xy(Xw,Pn,{transform(t,e){var n,r=this._features,i=this._points,a=t.fields,o=a&&a[0],s=a&&a[1],u=t.geojson||!a&&fy,c=e.ADD;n=t.modified()||e.changed(e.REM)||e.modified(ay(u))||o&&e.modified(ay(o))||s&&e.modified(ay(s)),this.value&&!n||(c=e.SOURCE,this._features=r=[],this._points=i=[]),u&&e.visit(c,t=>r.push(u(t))),o&&s&&(e.visit(c,t=>{var e=o(t),n=s(t);null!=e&&null!=n&&(e=+e)===e&&(n=+n)===n&&i.push([e,n])}),r=r.concat({type:"Feature",geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:"FeatureCollection",features:r}}}),Kw.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},xy(Kw,Pn,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.field||fy,a=t.as||"path",o=n.SOURCE;!r||t.modified()?(this.value=r=Aw(t.projection),n.materialize().reflow()):o=i===fy||e.modified(i.fields)?n.ADD_MOD:n.ADD;const s=function(t,e){const n=t.pointRadius();t.context(null),null!=e&&t.pointRadius(e);return n}(r,t.pointRadius);return n.visit(o,t=>t[a]=r(i(t))),r.pointRadius(s),n.modifies(a)}}),Yw.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},xy(Yw,Pn,{transform(t,e){var n,r=t.projection,i=t.fields[0],a=t.fields[1],o=t.as||["x","y"],s=o[0],u=o[1];function c(t){const e=r([i(t),a(t)]);e?(t[s]=e[0],t[u]=e[1]):(t[s]=void 0,t[u]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,c):(n=e.modified(i.fields)||e.modified(a.fields),e.visit(n?e.ADD_MOD:e.ADD,c)),e.modifies(o)}}),Jw.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},xy(Jw,Pn,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.as||"shape",a=n.ADD;return r&&!t.modified()||(this.value=r=function(t,e,n){const r=null==n?n=>t(e(n)):r=>{var i=t.pointRadius(),a=t.pointRadius(n)(e(r));return t.pointRadius(i),a};return r.context=e=>(t.context(e),r),r}(Aw(t.projection),t.field||dy("datum"),t.pointRadius),n.materialize().reflow(),a=n.SOURCE),n.visit(a,t=>t[i]=r),n.modifies(i)}}),Zw.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},xy(Zw,Pn,{transform(t,e){var n,r=this.value,i=this.generator;if(!r.length||t.modified())for(const e in t)by(i[e])&&i[e](t[e]);return n=i(),r.length?e.mod.push(pn(r[0],n)):e.add.push(dn(n)),r[0]=n,e}}),Qw.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},xy(Qw,Pn,{transform(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var n=e.materialize(e.SOURCE).source,r="shared"===t.resolve,i=t.field||fy,a=function(t,e){let n;by(t)?(n=n=>t(n,e),n.dep=tk(t)):t?n=yy(t):(n=t=>t.$value/t.$max||0,n.dep=!0);return n}(t.opacity,t),o=function(t,e){let n;by(t)?(n=n=>wu(t(n,e)),n.dep=tk(t)):n=yy(wu(t||"#888"));return n}(t.color,t),s=t.as||"image",u={$x:0,$y:0,$value:0,$max:r?wr(n.map(t=>wr(i(t).values))):0};return n.forEach(t=>{const e=i(t),n=vy({},t,u);r||(n.$max=wr(e.values||[])),t[s]=function(t,e,n,r){const i=t.width,a=t.height,o=t.x1||0,s=t.y1||0,u=t.x2||i,c=t.y2||a,l=t.values,d=l?t=>l[t]:hy,f=qs(u-o,c-s),h=f.getContext("2d"),p=h.getImageData(0,0,u-o,c-s),m=p.data;for(let t=s,a=0;t<c;++t){e.$y=t-s;for(let s=o,c=t*i;s<u;++s,a+=4){e.$x=s-o,e.$value=d(s+c);const t=n(e);m[a+0]=t.r,m[a+1]=t.g,m[a+2]=t.b,m[a+3]=~~(255*r(e))}}return h.putImageData(p,0,0),f}(e,n,o.dep?o:yy(o(n)),a.dep?a:yy(a(n)))}),e.reflow(!0).modifies(s)}}),xy(ek,Pn,{transform(t,e){let n=this.value;return!n||t.modified("type")?(this.value=n=function(t){const e=_w((t||"mercator").toLowerCase());e||cy("Unrecognized projection type: "+t);return e()}(t.type),kw.forEach(e=>{null!=t[e]&&nk(n,e,t[e])})):kw.forEach(e=>{t.modified(e)&&nk(n,e,t[e])}),null!=t.pointRadius&&n.path.pointRadius(t.pointRadius),t.fit&&function(t,e){const n=function(t){return 1===(t=gy(t)).length?t[0]:{type:"FeatureCollection",features:t.reduce((t,e)=>t.concat(function(t){return"FeatureCollection"===t.type?t.features:gy(t).filter(t=>null!=t).map(t=>"Feature"===t.type?t:{type:"Feature",geometry:t})}(e)),[])}}(e.fit);e.extent?t.fitExtent(e.extent,n):e.size&&t.fitSize(e.size,n)}(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});const ok=t=>function(e){return e[t]},sk=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function uk(t){throw Error(t)}function ck(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||uk("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&uk("Access path missing closing bracket: "+t),o&&uk("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function lk(t,e,n){const r=ck(t);return t=1===r.length?r[0]:t,rk((n&&n.get||ak)(r),[t],e||t)}lk("id"),rk(t=>t,[],"identity"),rk(()=>0,[],"zero"),rk(()=>1,[],"one"),rk(()=>!0,[],"true"),rk(()=>!1,[],"false");var dk=Array.isArray;function fk(t){return null!=t?dk(t)?t:[t]:[]}function hk(t){return"function"==typeof t}const pk=Object.prototype.hasOwnProperty;function mk(t,e){return pk.call(t,e)}function gk(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a,o,s,u,c,l,d,f,h=t._root,p={data:r},m=t._x0,g=t._y0,b=t._x1,y=t._y1;if(!h)return t._root=p,t;for(;h.length;)if((c=e>=(a=(m+b)/2))?m=a:b=a,(l=n>=(o=(g+y)/2))?g=o:y=o,i=h,!(h=h[d=l<<1|c]))return i[d]=p,t;if(s=+t._x.call(null,h.data),u=+t._y.call(null,h.data),e===s&&n===u)return p.next=h,i?i[d]=p:t._root=p,t;do{i=i?i[d]=new Array(4):t._root=new Array(4),(c=e>=(a=(m+b)/2))?m=a:b=a,(l=n>=(o=(g+y)/2))?g=o:y=o}while((d=l<<1|c)==(f=(u>=o)<<1|s>=a));return i[f]=h,i[d]=p,t}var bk=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i};function yk(t){return t[0]}function vk(t){return t[1]}function xk(t,e,n){var r=new wk(null==e?yk:e,null==n?vk:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function wk(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function kk(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Ok=xk.prototype=wk.prototype;Ok.copy=function(){var t,e,n=new wk(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=kk(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=kk(e));return n},Ok.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return gk(this.cover(e,n),e,n,t)},Ok.addAll=function(t){var e,n,r,i,a=t.length,o=new Array(a),s=new Array(a),u=1/0,c=1/0,l=-1/0,d=-1/0;for(n=0;n<a;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(o[n]=r,s[n]=i,r<u&&(u=r),r>l&&(l=r),i<c&&(c=i),i>d&&(d=i));if(u>l||c>d)return this;for(this.cover(u,c).cover(l,d),n=0;n<a;++n)gk(this,o[n],s[n],t[n]);return this},Ok.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var o,s,u=i-n||1,c=this._root;n>t||t>=i||r>e||e>=a;)switch(s=(e<r)<<1|t<n,(o=new Array(4))[s]=c,c=o,u*=2,s){case 0:i=n+u,a=r+u;break;case 1:n=i-u,a=r+u;break;case 2:i=n+u,r=a-u;break;case 3:n=i-u,r=a-u}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this},Ok.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Ok.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Ok.find=function(t,e,n){var r,i,a,o,s,u,c,l=this._x0,d=this._y0,f=this._x1,h=this._y1,p=[],m=this._root;for(m&&p.push(new bk(m,l,d,f,h)),null==n?n=1/0:(l=t-n,d=e-n,f=t+n,h=e+n,n*=n);u=p.pop();)if(!(!(m=u.node)||(i=u.x0)>f||(a=u.y0)>h||(o=u.x1)<l||(s=u.y1)<d))if(m.length){var g=(i+o)/2,b=(a+s)/2;p.push(new bk(m[3],g,b,o,s),new bk(m[2],i,b,g,s),new bk(m[1],g,a,o,b),new bk(m[0],i,a,g,b)),(c=(e>=b)<<1|t>=g)&&(u=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=u)}else{var y=t-+this._x.call(null,m.data),v=e-+this._y.call(null,m.data),x=y*y+v*v;if(x<n){var w=Math.sqrt(n=x);l=t-w,d=e-w,f=t+w,h=e+w,r=m.data}}return r},Ok.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,i,a,o,s,u,c,l,d,f,h=this._root,p=this._x0,m=this._y0,g=this._x1,b=this._y1;if(!h)return this;if(h.length)for(;;){if((c=a>=(s=(p+g)/2))?p=s:g=s,(l=o>=(u=(m+b)/2))?m=u:b=u,e=h,!(h=h[d=l<<1|c]))return this;if(!h.length)break;(e[d+1&3]||e[d+2&3]||e[d+3&3])&&(n=e,f=d)}for(;h.data!==t;)if(r=h,!(h=h.next))return this;return(i=h.next)&&delete h.next,r?(i?r.next=i:delete r.next,this):e?(i?e[d]=i:delete e[d],(h=e[0]||e[1]||e[2]||e[3])&&h===(e[3]||e[2]||e[1]||e[0])&&!h.length&&(n?n[f]=h:this._root=h),this):(this._root=i,this)},Ok.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Ok.root=function(){return this._root},Ok.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Ok.visit=function(t){var e,n,r,i,a,o,s=[],u=this._root;for(u&&s.push(new bk(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,r=e.x0,i=e.y0,a=e.x1,o=e.y1)&&u.length){var c=(r+a)/2,l=(i+o)/2;(n=u[3])&&s.push(new bk(n,c,l,a,o)),(n=u[2])&&s.push(new bk(n,r,l,c,o)),(n=u[1])&&s.push(new bk(n,c,i,a,l)),(n=u[0])&&s.push(new bk(n,r,i,c,l))}return this},Ok.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new bk(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var a,o=e.x0,s=e.y0,u=e.x1,c=e.y1,l=(o+u)/2,d=(s+c)/2;(a=i[0])&&n.push(new bk(a,o,s,l,d)),(a=i[1])&&n.push(new bk(a,l,s,u,d)),(a=i[2])&&n.push(new bk(a,o,d,l,c)),(a=i[3])&&n.push(new bk(a,l,d,u,c))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},Ok.x=function(t){return arguments.length?(this._x=t,this):this._x},Ok.y=function(t){return arguments.length?(this._y=t,this):this._y};var _k=function(t){return function(){return t}},Ak=function(t){return 1e-6*(t()-.5)};function Ck(t){return t.x+t.vx}function Ek(t){return t.y+t.vy}var Sk={value:()=>{}};function jk(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Nk(r)}function Nk(t){this._=t}function Tk(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Fk(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Dk(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Sk,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Nk.prototype=jk.prototype={constructor:Nk,on:function(t,e){var n,r=this._,i=Tk(t+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<o;)if(n=(t=i[a]).type)r[n]=Dk(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Dk(r[n],t.name,null);return this}for(;++a<o;)if((n=(t=i[a]).type)&&(n=Fk(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Nk(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};var Ik,Mk,$k=jk,Rk=0,Bk=0,zk=0,Lk=0,Pk=0,qk=0,Wk="object"==typeof performance&&performance.now?performance:Date,Uk="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Vk(){return Pk||(Uk(Gk),Pk=Wk.now()+qk)}function Gk(){Pk=0}function Hk(){this._call=this._time=this._next=null}function Xk(t,e,n){var r=new Hk;return r.restart(t,e,n),r}function Kk(){Pk=(Lk=Wk.now())+qk,Rk=Bk=0;try{!function(){Vk(),++Rk;for(var t,e=Ik;e;)(t=Pk-e._time)>=0&&e._call.call(null,t),e=e._next;--Rk}()}finally{Rk=0,function(){var t,e,n=Ik,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Ik=e);Mk=t,Jk(r)}(),Pk=0}}function Yk(){var t=Wk.now(),e=t-Lk;e>1e3&&(qk-=e,Lk=t)}function Jk(t){Rk||(Bk&&(Bk=clearTimeout(Bk)),t-Pk>24?(t<1/0&&(Bk=setTimeout(Kk,t-Wk.now()-qk)),zk&&(zk=clearInterval(zk))):(zk||(Lk=Wk.now(),zk=setInterval(Yk,1e3)),Rk=1,Uk(Kk)))}Hk.prototype=Xk.prototype={constructor:Hk,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Vk():+n)+(null==e?0:+e),this._next||Mk===this||(Mk?Mk._next=this:Ik=this,Mk=this),this._call=t,this._time=n,Jk()},stop:function(){this._call&&(this._call=null,this._time=1/0,Jk())}};function Zk(t){return t.x}function Qk(t){return t.y}var tO=Math.PI*(3-Math.sqrt(5));function eO(t){return t.index}function nO(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}const rO={center:function(t,e){var n,r=1;function i(){var i,a,o=n.length,s=0,u=0;for(i=0;i<o;++i)s+=(a=n[i]).x,u+=a.y;for(s=(s/o-t)*r,u=(u/o-e)*r,i=0;i<o;++i)(a=n[i]).x-=s,a.y-=u}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i},collide:function(t){var e,n,r,i=1,a=1;function o(){for(var t,o,u,c,l,d,f,h=e.length,p=0;p<a;++p)for(o=xk(e,Ck,Ek).visitAfter(s),t=0;t<h;++t)u=e[t],d=n[u.index],f=d*d,c=u.x+u.vx,l=u.y+u.vy,o.visit(m);function m(t,e,n,a,o){var s=t.data,h=t.r,p=d+h;if(!s)return e>c+p||a<c-p||n>l+p||o<l-p;if(s.index>u.index){var m=c-s.x-s.vx,g=l-s.y-s.vy,b=m*m+g*g;b<p*p&&(0===m&&(b+=(m=Ak(r))*m),0===g&&(b+=(g=Ak(r))*g),b=(p-(b=Math.sqrt(b)))/b*i,u.vx+=(m*=b)*(p=(h*=h)/(f+h)),u.vy+=(g*=b)*p,s.vx-=m*(p=1-p),s.vy-=g*p)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var r,i,a=e.length;for(n=new Array(a),r=0;r<a;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=_k(null==t?1:+t)),o.initialize=function(t,n){e=t,r=n,u()},o.iterations=function(t){return arguments.length?(a=+t,o):a},o.strength=function(t){return arguments.length?(i=+t,o):i},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:_k(+e),u(),o):t},o},nbody:function(){var t,e,n,r,i,a=_k(-30),o=1,s=1/0,u=.81;function c(n){var i,a=t.length,o=xk(t,Zk,Qk).visitAfter(d);for(r=n,i=0;i<a;++i)e=t[i],o.visit(f)}function l(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+a(n,e,t)}}function d(t){var e,n,r,a,o,s=0,u=0;if(t.length){for(r=a=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(s+=e.value,u+=n,r+=n*e.x,a+=n*e.y);t.x=r/u,t.y=a/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function f(t,a,c,l){if(!t.value)return!0;var d=t.x-e.x,f=t.y-e.y,h=l-a,p=d*d+f*f;if(h*h/u<p)return p<s&&(0===d&&(p+=(d=Ak(n))*d),0===f&&(p+=(f=Ak(n))*f),p<o&&(p=Math.sqrt(o*p)),e.vx+=d*t.value*r/p,e.vy+=f*t.value*r/p),!0;if(!(t.length||p>=s)){(t.data!==e||t.next)&&(0===d&&(p+=(d=Ak(n))*d),0===f&&(p+=(f=Ak(n))*f),p<o&&(p=Math.sqrt(o*p)));do{t.data!==e&&(h=i[t.data.index]*r/p,e.vx+=d*h,e.vy+=f*h)}while(t=t.next)}}return c.initialize=function(e,r){t=e,n=r,l()},c.strength=function(t){return arguments.length?(a="function"==typeof t?t:_k(+t),l(),c):a},c.distanceMin=function(t){return arguments.length?(o=t*t,c):Math.sqrt(o)},c.distanceMax=function(t){return arguments.length?(s=t*t,c):Math.sqrt(s)},c.theta=function(t){return arguments.length?(u=t*t,c):Math.sqrt(u)},c},link:function(t){var e,n,r,i,a,o,s=eO,u=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},c=_k(30),l=1;function d(r){for(var i=0,s=t.length;i<l;++i)for(var u,c,d,f,h,p,m,g=0;g<s;++g)c=(u=t[g]).source,f=(d=u.target).x+d.vx-c.x-c.vx||Ak(o),h=d.y+d.vy-c.y-c.vy||Ak(o),f*=p=((p=Math.sqrt(f*f+h*h))-n[g])/p*r*e[g],h*=p,d.vx-=f*(m=a[g]),d.vy-=h*m,c.vx+=f*(m=1-m),c.vy+=h*m}function f(){if(r){var o,u,c=r.length,l=t.length,d=new Map(r.map((t,e)=>[s(t,e,r),t]));for(o=0,i=new Array(c);o<l;++o)(u=t[o]).index=o,"object"!=typeof u.source&&(u.source=nO(d,u.source)),"object"!=typeof u.target&&(u.target=nO(d,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(o=0,a=new Array(l);o<l;++o)u=t[o],a[o]=i[u.source.index]/(i[u.source.index]+i[u.target.index]);e=new Array(l),h(),n=new Array(l),p()}}function h(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+u(t[n],n,t)}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+c(t[e],e,t)}return null==t&&(t=[]),d.initialize=function(t,e){r=t,o=e,f()},d.links=function(e){return arguments.length?(t=e,f(),d):t},d.id=function(t){return arguments.length?(s=t,d):s},d.iterations=function(t){return arguments.length?(l=+t,d):l},d.strength=function(t){return arguments.length?(u="function"==typeof t?t:_k(+t),h(),d):u},d.distance=function(t){return arguments.length?(c="function"==typeof t?t:_k(+t),p(),d):c},d},x:function(t){var e,n,r,i=_k(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vx+=(r[a]-i.x)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=_k(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:_k(+t),o(),a):i},a.x=function(e){return arguments.length?(t="function"==typeof e?e:_k(+e),o(),a):t},a},y:function(t){var e,n,r,i=_k(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vy+=(r[a]-i.y)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=_k(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:_k(+t),o(),a):i},a.y=function(e){return arguments.length?(t="function"==typeof e?e:_k(+e),o(),a):t},a}},iO=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],aO=["static","iterations"],oO=["x","y","vx","vy"];function sO(t){Pn.call(this,null,t)}function uO(t,e,n,r){var i,a,o,s,u=fk(e.forces);for(i=0,a=iO.length;i<a;++i)"forces"!==(o=iO[i])&&e.modified(o)&&t[o](e[o]);for(i=0,a=u.length;i<a;++i)s="forces"+i,(o=n||e.modified("forces",i)?lO(u[i]):r&&cO(u[i],r)?t.force(s):null)&&t.force(s,o);for(a=t.numForces||0;i<a;++i)t.force("forces"+i,null);return t.numForces=u.length,t}function cO(t,e){var n,r;for(n in t)if(hk(r=t[n])&&e.modified(ik(r)))return 1;return 0}function lO(t){var e,n;for(n in mk(rO,t.force)||uk("Unrecognized force: "+t.force),e=rO[t.force](),t)hk(e[n])&&dO(e[n],t[n],t);return e}function dO(t,e,n){t(hk(e)?t=>e(t,n):e)}function fO(t,e,n){return t.fields=e||[],t.fname=n,t}function hO(t){return 1===t.length?pO(t[0]):mO(t)}sO.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:oO}]},function(t,e,n){const r=t.prototype=Object.create(e.prototype);r.constructor=t,function(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n]}(r,n)}(sO,Pn,{transform(t,e){var n,r,i=this.value,a=e.changed(e.ADD_REM),o=t.modified(iO),s=t.iterations||300;if(i?(a&&(e.modifies("index"),i.nodes(e.source)),(o||e.changed(e.MOD))&&uO(i,t,0,e)):(this.value=i=function(t,e){const n=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=new Map,u=Xk(d),c=$k("tick","end"),l=function(){let t=1;return()=>(t=(1664525*t+1013904223)%4294967296)/4294967296}();function d(){f(),c.call("tick",e),n<r&&(u.stop(),c.call("end",e))}function f(r){var u,c,l=t.length;void 0===r&&(r=1);for(var d=0;d<r;++d)for(n+=(a-n)*i,s.forEach((function(t){t(n)})),u=0;u<l;++u)null==(c=t[u]).fx?c.x+=c.vx*=o:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=o:(c.y=c.fy,c.vy=0);return e}function h(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),a=n*tO;e.x=i*Math.cos(a),e.y=i*Math.sin(a)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,l),e}return null==t&&(t=[]),h(),e={tick:f,restart:function(){return u.restart(d),e},stop:function(){return u.stop(),e},nodes:function(n){return arguments.length?(t=n,h(),s.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(a=+t,e):a},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},randomSource:function(t){return arguments.length?(l=t,s.forEach(p),e):l},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,r){var i,a,o,s,u,c=0,l=t.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)(o=(i=e-(s=t[c]).x)*i+(a=n-s.y)*a)<r&&(u=s,r=o);return u},on:function(t,n){return arguments.length>1?(c.on(t,n),e):c.on(t)}}}(t),r=n.stop,i=n.restart;let a=!1;return n.stopped=()=>a,n.restart=()=>(a=!1,i()),n.stop=()=>(a=!0,r()),uO(n,e,!0).on("end",()=>a=!0)}(e.source,t),i.on("tick",(n=e.dataflow,r=this,()=>n.touch(r).run())),t.static||(a=!0,i.tick()),e.modifies("index")),o||a||t.modified(aO)||e.changed()&&t.restart)if(i.alpha(Math.max(i.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/s)),t.static)for(i.stop();--s>=0;)i.tick();else if(i.stopped()&&i.restart(),!a)return e.StopPropagation;return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let t,e=this._argops,s=0,u=e.length;s<u;++s)if(t=e[s],"forces"===t.name&&"link"===t.op._argval.force)for(var r,i=t.op._argops,a=0,o=i.length;a<o;++a)if("links"===i[a].name&&(r=i[a].op.source)){n.pulse(r,n.changeset().reflow());break}return e.reflow(t.modified()).modifies(oO)}});const pO=t=>function(e){return e[t]},mO=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function gO(t){throw Error(t)}function bO(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||gO("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&gO("Access path missing closing bracket: "+t),o&&gO("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function yO(t,e,n){const r=bO(t);return t=1===r.length?r[0]:t,fO((n&&n.get||hO)(r),[t],e||t)}yO("id"),fO(t=>t,[],"identity"),fO(()=>0,[],"zero");const vO=fO(()=>1,[],"one"),xO=fO(()=>!0,[],"true");fO(()=>!1,[],"false");var wO=Array.isArray;function kO(t){return null!=t?wO(t)?t:[t]:[]}const OO=Object.prototype.hasOwnProperty;function _O(t,e){return OO.call(t,e)}function AO(t,e,n){const r=t.prototype=Object.create(e.prototype);return r.constructor=t,function(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}(r,n)}function CO(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function EO(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=jO)):void 0===e&&(e=SO);for(var n,r,i,a,o,s=new FO(t),u=[s];n=u.pop();)if((i=e(n.data))&&(o=(i=Array.from(i)).length))for(n.children=i,a=o-1;a>=0;--a)u.push(r=i[a]=new FO(i[a])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(TO)}function SO(t){return t.children}function jO(t){return Array.isArray(t)?t[1]:null}function NO(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function TO(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function FO(t){this.data=t,this.depth=this.height=0,this.parent=null}FO.prototype=EO.prototype={constructor:FO,count:function(){return this.eachAfter(CO)},each:function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,i,a=this,o=[a],s=[],u=-1;a=o.pop();)if(s.push(a),n=a.children)for(r=0,i=n.length;r<i;++r)o.push(n[r]);for(;a=s.pop();)t.call(e,a,++u,this);return this},eachBefore:function(t,e){for(var n,r,i=this,a=[i],o=-1;i=a.pop();)if(t.call(e,i,++o,this),n=i.children)for(r=n.length-1;r>=0;--r)a.push(n[r]);return this},find:function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return EO(this).eachBefore(NO)},[Symbol.iterator]:function*(){var t,e,n,r,i=this,a=[i];do{for(t=a.reverse(),a=[];i=t.pop();)if(yield i,e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n])}while(a.length)}};var DO=function(t){for(var e,n,r=0,i=(t=function(t){for(var e,n,r=t.length;r;)n=Math.random()*r--|0,e=t[r],t[r]=t[n],t[n]=e;return t}(Array.from(t))).length,a=[];r<i;)e=t[r],n&&$O(n,e)?++r:(n=BO(a=IO(a,e)),r=0);return n};function IO(t,e){var n,r;if(RO(e,t))return[e];for(n=0;n<t.length;++n)if(MO(e,t[n])&&RO(zO(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(MO(zO(t[n],t[r]),e)&&MO(zO(t[n],e),t[r])&&MO(zO(t[r],e),t[n])&&RO(LO(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function MO(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function $O(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function RO(t,e){for(var n=0;n<e.length;++n)if(!$O(t,e[n]))return!1;return!0}function BO(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return zO(t[0],t[1]);case 3:return LO(t[0],t[1],t[2])}var e}function zO(t,e){var n=t.x,r=t.y,i=t.r,a=e.x,o=e.y,s=e.r,u=a-n,c=o-r,l=s-i,d=Math.sqrt(u*u+c*c);return{x:(n+a+u/d*l)/2,y:(r+o+c/d*l)/2,r:(d+i+s)/2}}function LO(t,e,n){var r=t.x,i=t.y,a=t.r,o=e.x,s=e.y,u=e.r,c=n.x,l=n.y,d=n.r,f=r-o,h=r-c,p=i-s,m=i-l,g=u-a,b=d-a,y=r*r+i*i-a*a,v=y-o*o-s*s+u*u,x=y-c*c-l*l+d*d,w=h*p-f*m,k=(p*x-m*v)/(2*w)-r,O=(m*g-p*b)/w,_=(h*v-f*x)/(2*w)-i,A=(f*b-h*g)/w,C=O*O+A*A-1,E=2*(a+k*O+_*A),S=k*k+_*_-a*a,j=-(C?(E+Math.sqrt(E*E-4*C*S))/(2*C):S/E);return{x:r+k+O*j,y:i+_+A*j,r:j}}function PO(t,e,n){var r,i,a,o,s=t.x-e.x,u=t.y-e.y,c=s*s+u*u;c?(i=e.r+n.r,i*=i,o=t.r+n.r,i>(o*=o)?(r=(c+o-i)/(2*c),a=Math.sqrt(Math.max(0,o/c-r*r)),n.x=t.x-r*s-a*u,n.y=t.y-r*u+a*s):(r=(c+i-o)/(2*c),a=Math.sqrt(Math.max(0,i/c-r*r)),n.x=e.x+r*s-a*u,n.y=e.y+r*u+a*s)):(n.x=e.x+n.r,n.y=e.y)}function qO(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function WO(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,a=(e.y*n.r+n.y*e.r)/r;return i*i+a*a}function UO(t){this._=t,this.next=null,this.previous=null}function VO(t){if(!(a=(e=t,t="object"==typeof e&&"length"in e?e:Array.from(e)).length))return 0;var e,n,r,i,a,o,s,u,c,l,d,f;if((n=t[0]).x=0,n.y=0,!(a>1))return n.r;if(r=t[1],n.x=-r.r,r.x=n.r,r.y=0,!(a>2))return n.r+r.r;PO(r,n,i=t[2]),n=new UO(n),r=new UO(r),i=new UO(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;t:for(u=3;u<a;++u){PO(n._,r._,i=t[u]),i=new UO(i),c=r.next,l=n.previous,d=r._.r,f=n._.r;do{if(d<=f){if(qO(c._,i._)){r=c,n.next=r,r.previous=n,--u;continue t}d+=c._.r,c=c.next}else{if(qO(l._,i._)){(n=l).next=r,r.previous=n,--u;continue t}f+=l._.r,l=l.previous}}while(c!==l.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,o=WO(n);(i=i.next)!==r;)(s=WO(i))<o&&(n=i,o=s);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=DO(n),u=0;u<a;++u)(n=t[u]).x-=i.x,n.y-=i.y;return i.r}function GO(t){return null==t?null:HO(t)}function HO(t){if("function"!=typeof t)throw new Error;return t}function XO(){return 0}var KO=function(t){return function(){return t}};function YO(t){return Math.sqrt(t.value)}function JO(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function ZO(t,e){return function(n){if(r=n.children){var r,i,a,o=r.length,s=t(n)*e||0;if(s)for(i=0;i<o;++i)r[i].r+=s;if(a=VO(r),s)for(i=0;i<o;++i)r[i].r-=s;n.r=a+s}}}function QO(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}var t_=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},e_=function(t,e,n,r,i){for(var a,o=t.children,s=-1,u=o.length,c=t.value&&(r-e)/t.value;++s<u;)(a=o[s]).y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*c},n_={depth:-1},r_={};function i_(t){return t.id}function a_(t){return t.parentId}var o_=function(){var t=i_,e=a_;function n(n){var r,i,a,o,s,u,c,l=Array.from(n),d=l.length,f=new Map;for(i=0;i<d;++i)r=l[i],s=l[i]=new FO(r),null!=(u=t(r,i,n))&&(u+="")&&(c=s.id=u,f.set(c,f.has(c)?r_:s)),null!=(u=e(r,i,n))&&(u+="")&&(s.parent=u);for(i=0;i<d;++i)if(u=(s=l[i]).parent){if(!(o=f.get(u)))throw new Error("missing: "+u);if(o===r_)throw new Error("ambiguous: "+u);o.children?o.children.push(s):o.children=[s],s.parent=o}else{if(a)throw new Error("multiple roots");a=s}if(!a)throw new Error("no root");if(a.parent=n_,a.eachBefore((function(t){t.depth=t.parent.depth+1,--d})).eachBefore(TO),a.parent=null,d>0)throw new Error("cycle");return a}return n.id=function(e){return arguments.length?(t=HO(e),n):t},n.parentId=function(t){return arguments.length?(e=HO(t),n):e},n};function s_(t,e){return t.parent===e.parent?1:2}function u_(t){var e=t.children;return e?e[0]:t.t}function c_(t){var e=t.children;return e?e[e.length-1]:t.t}function l_(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function d_(t,e,n){return t.a.parent===e.parent?t.a:n}function f_(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}f_.prototype=Object.create(FO.prototype);function h_(t,e){return t.parent===e.parent?1:2}function p_(t,e){return t+e.x}function m_(t,e){return Math.max(t,e.y)}var g_=function(t,e,n,r,i){for(var a,o=t.children,s=-1,u=o.length,c=t.value&&(i-n)/t.value;++s<u;)(a=o[s]).x0=e,a.x1=r,a.y0=n,a.y1=n+=a.value*c},b_=(1+Math.sqrt(5))/2;function y_(t,e,n,r,i,a){for(var o,s,u,c,l,d,f,h,p,m,g,b=[],y=e.children,v=0,x=0,w=y.length,k=e.value;v<w;){u=i-n,c=a-r;do{l=y[x++].value}while(!l&&x<w);for(d=f=l,g=l*l*(m=Math.max(c/u,u/c)/(k*t)),p=Math.max(f/g,g/d);x<w;++x){if(l+=s=y[x].value,s<d&&(d=s),s>f&&(f=s),g=l*l*m,(h=Math.max(f/g,g/d))>p){l-=s;break}p=h}b.push(o={value:l,dice:u<c,children:y.slice(v,x)}),o.dice?e_(o,n,r,i,k?r+=c*l/k:a):g_(o,n,r,k?n+=u*l/k:i,a),k-=l,v=x}return b}var v_=function t(e){function n(t,n,r,i,a){y_(e,t,n,r,i,a)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(b_),x_=function t(e){function n(t,n,r,i,a){if((o=t._squarify)&&o.ratio===e)for(var o,s,u,c,l,d=-1,f=o.length,h=t.value;++d<f;){for(u=(s=o[d]).children,c=s.value=0,l=u.length;c<l;++c)s.value+=u[c].value;s.dice?e_(s,n,r,i,h?r+=(a-r)*s.value/h:a):g_(s,n,r,h?n+=(i-n)*s.value/h:i,a),h-=s.value}else t._squarify=o=y_(e,t,n,r,i,a),o.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(b_);function w_(t,e,n){const r={};return t.each(t=>{const i=t.data;n(i)&&(r[e(i)]=t)}),t.lookup=r,t}function k_(t){Pn.call(this,null,t)}k_.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const O_=t=>t.values;function __(){const t=[],e={entries:e=>function e(n,r){if(++r>t.length)return n;const i=[];for(const t in n)i.push({key:t,values:e(n[t],r)});return i}(function e(n,r){if(r>=t.length)return n;const i=n.length,a=t[r++],o={},s={};let u,c,l,d=-1;for(;++d<i;)u=a(c=n[d])+"",(l=o[u])?l.push(c):o[u]=[c];for(u in o)s[u]=e(o[u],r);return s}(e,0),0),key:n=>(t.push(n),e)};return e}function A_(t){Pn.call(this,null,t)}AO(k_,Pn,{transform(t,e){e.source||gO("Nest transform requires an upstream data source.");var n=t.generate,r=t.modified(),i=e.clone(),a=this.value;return(!a||r||e.changed())&&(a&&a.each(t=>{t.children&&un(t.data)&&i.rem.push(t.data)}),this.value=a=EO({values:kO(t.keys).reduce((t,e)=>(t.key(e),t),__()).entries(i.source)},O_),n&&a.each(t=>{t.children&&(t=dn(t.data),i.add.push(t),i.source.push(t))}),w_(a,cn,cn)),i.source.root=a,i}});const C_=(t,e)=>t.parent===e.parent?1:2;AO(A_,Pn,{transform(t,e){e.source&&e.source.root||gO(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(t.method),r=this.fields,i=e.source.root,a=t.as||r;t.field?i.sum(t.field):i.count(),t.sort&&i.sort(mn(t.sort,t=>t.data)),function(t,e,n){for(let r,i=0,a=e.length;i<a;++i)r=e[i],r in n&&t[r](n[r])}(n,this.params,t),n.separation&&n.separation(!1!==t.separation?C_:vO);try{this.value=n(i)}catch(t){gO(t)}return i.each(t=>function(t,e,n){const r=t.data,i=e.length-1;for(let a=0;a<i;++a)r[n[a]]=t[e[a]];r[n[i]]=t.children?t.children.length:0}(t,r,a)),e.reflow(t.modified()).modifies(a).modifies("leaf")}});const E_=["x","y","r","depth","children"];function S_(t){A_.call(this,t)}S_.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:E_.length,default:E_}]},AO(S_,A_,{layout:function(){var t=null,e=1,n=1,r=XO;function i(i){return i.x=e/2,i.y=n/2,t?i.eachBefore(JO(t)).eachAfter(ZO(r,.5)).eachBefore(QO(1)):i.eachBefore(JO(YO)).eachAfter(ZO(XO,1)).eachAfter(ZO(r,i.r/Math.min(e,n))).eachBefore(QO(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=GO(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:KO(+t),i):r},i},params:["radius","size","padding"],fields:E_});const j_=["x0","y0","x1","y1","depth","children"];function N_(t){A_.call(this,t)}function T_(t){Pn.call(this,null,t)}N_.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:j_.length,default:j_}]},AO(N_,A_,{layout:function(){var t=1,e=1,n=0,r=!1;function i(i){var a=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/a,i.eachBefore(function(t,e){return function(r){r.children&&e_(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,a=r.y0,o=r.x1-n,s=r.y1-n;o<i&&(i=o=(i+o)/2),s<a&&(a=s=(a+s)/2),r.x0=i,r.y0=a,r.x1=o,r.y1=s}}(e,a)),r&&i.eachBefore(t_),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},params:["size","round","padding"],fields:j_}),T_.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},AO(T_,Pn,{transform(t,e){e.source||gO("Stratify transform requires an upstream data source.");let n=this.value;const r=t.modified(),i=e.fork(e.ALL).materialize(e.SOURCE),a=!n||r||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return i.source=i.source.slice(),a&&(n=i.source.length?w_(o_().id(t.key).parentId(t.parentKey)(i.source),t.key,xO):w_(o_()([{}]),t.key,t.key)),i.source.root=this.value=n,i}});const F_={tidy:function(){var t=s_,e=1,n=1,r=null;function i(i){var u=function(t){for(var e,n,r,i,a,o=new f_(t,0),s=[o];e=s.pop();)if(r=e._.children)for(e.children=new Array(a=r.length),i=a-1;i>=0;--i)s.push(n=e.children[i]=new f_(r[i],i)),n.parent=e;return(o.parent=new f_(null,0)).children=[o],o}(i);if(u.eachAfter(a),u.parent.m=-u.z,u.eachBefore(o),r)i.eachBefore(s);else{var c=i,l=i,d=i;i.eachBefore((function(t){t.x<c.x&&(c=t),t.x>l.x&&(l=t),t.depth>d.depth&&(d=t)}));var f=c===l?1:t(c,l)/2,h=f-c.x,p=e/(l.x+f+h),m=n/(d.depth||1);i.eachBefore((function(t){t.x=(t.x+h)*p,t.y=t.depth*m}))}return i}function a(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,a=i.length;--a>=0;)(e=i[a]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var a=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-a):e.z=a}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,a=e,o=e,s=n,u=a.parent.children[0],c=a.m,l=o.m,d=s.m,f=u.m;s=c_(s),a=u_(a),s&&a;)u=u_(u),(o=c_(o)).a=e,(i=s.z+d-a.z-c+t(s._,a._))>0&&(l_(d_(s,e,r),e,i),c+=i,l+=i),d+=s.m,c+=a.m,f+=u.m,l+=o.m;s&&!c_(o)&&(o.t=s,o.m+=d-l),a&&!u_(u)&&(u.t=a,u.m+=c-f,r=e)}return r}(e,i,e.parent.A||r[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},cluster:function(){var t=h_,e=1,n=1,r=!1;function i(i){var a,o=0;i.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(p_,0)/t.length}(n),e.y=function(t){return 1+t.reduce(m_,0)}(n)):(e.x=a?o+=t(e,a):0,e.y=0,a=e)}));var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),u=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),c=s.x-t(s,u)/2,l=u.x+t(u,s)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-c)/(l-c)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}},D_=["x","y","depth","children"];function I_(t){A_.call(this,t)}function M_(t){Pn.call(this,[],t)}I_.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:D_.length,default:D_}]},AO(I_,A_,{layout(t){const e=t||"tidy";if(_O(F_,e))return F_[e]();gO("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:D_}),M_.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},AO(M_,Pn,{transform(t,e){const n=this.value,r=e.source&&e.source.root,i=e.fork(e.NO_SOURCE),a={};return r||gO("TreeLinks transform requires a tree data source."),e.changed(e.ADD_REM)?(i.rem=n,e.visit(e.SOURCE,t=>a[cn(t)]=1),r.each(t=>{const e=t.data,n=t.parent&&t.parent.data;n&&a[cn(e)]&&a[cn(n)]&&i.add.push(dn({source:n,target:e}))}),this.value=i.add):e.changed(e.MOD)&&(e.visit(e.MOD,t=>a[cn(t)]=1),n.forEach(t=>{(a[cn(t.source)]||a[cn(t.target)])&&i.mod.push(t)})),i}});const $_={binary:function(t,e,n,r,i){var a,o,s=t.children,u=s.length,c=new Array(u+1);for(c[0]=o=a=0;a<u;++a)c[a+1]=o+=s[a].value;!function t(e,n,r,i,a,o,u){if(e>=n-1){var l=s[e];return l.x0=i,l.y0=a,l.x1=o,void(l.y1=u)}var d=c[e],f=r/2+d,h=e+1,p=n-1;for(;h<p;){var m=h+p>>>1;c[m]<f?h=m+1:p=m}f-c[h-1]<c[h]-f&&e+1<h&&--h;var g=c[h]-d,b=r-g;if(o-i>u-a){var y=r?(i*b+o*g)/r:o;t(e,h,g,i,a,y,u),t(h,n,b,y,a,o,u)}else{var v=r?(a*b+u*g)/r:u;t(e,h,g,i,a,o,v),t(h,n,b,i,v,o,u)}}(0,u,t.value,e,n,r,i)},dice:e_,slice:g_,slicedice:function(t,e,n,r,i){(1&t.depth?g_:e_)(t,e,n,r,i)},squarify:v_,resquarify:x_},R_=["x0","y0","x1","y1","depth","children"];function B_(t){A_.call(this,t)}function z_(t,e,n){return t.fields=e||[],t.fname=n,t}function L_(t){return null==t?null:t.fname}function P_(t){return 1===t.length?q_(t[0]):W_(t)}B_.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:R_.length,default:R_}]},AO(B_,A_,{layout(){const t=function(){var t=v_,e=!1,n=1,r=1,i=[0],a=XO,o=XO,s=XO,u=XO,c=XO;function l(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(d),i=[0],e&&t.eachBefore(t_),t}function d(e){var n=i[e.depth],r=e.x0+n,l=e.y0+n,d=e.x1-n,f=e.y1-n;d<r&&(r=d=(r+d)/2),f<l&&(l=f=(l+f)/2),e.x0=r,e.y0=l,e.x1=d,e.y1=f,e.children&&(n=i[e.depth+1]=a(e)/2,r+=c(e)-n,l+=o(e)-n,(d-=s(e)-n)<r&&(r=d=(r+d)/2),(f-=u(e)-n)<l&&(l=f=(l+f)/2),t(e,r,l,d,f))}return l.round=function(t){return arguments.length?(e=!!t,l):e},l.size=function(t){return arguments.length?(n=+t[0],r=+t[1],l):[n,r]},l.tile=function(e){return arguments.length?(t=HO(e),l):t},l.padding=function(t){return arguments.length?l.paddingInner(t).paddingOuter(t):l.paddingInner()},l.paddingInner=function(t){return arguments.length?(a="function"==typeof t?t:KO(+t),l):a},l.paddingOuter=function(t){return arguments.length?l.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):l.paddingTop()},l.paddingTop=function(t){return arguments.length?(o="function"==typeof t?t:KO(+t),l):o},l.paddingRight=function(t){return arguments.length?(s="function"==typeof t?t:KO(+t),l):s},l.paddingBottom=function(t){return arguments.length?(u="function"==typeof t?t:KO(+t),l):u},l.paddingLeft=function(t){return arguments.length?(c="function"==typeof t?t:KO(+t),l):c},l}();return t.ratio=e=>{const n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=e=>{_O($_,e)?t.tile($_[e]):gO("Unrecognized Treemap layout method: "+e)},t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:R_});const q_=t=>function(e){return e[t]},W_=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function U_(t){throw Error(t)}function V_(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||U_("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&U_("Access path missing closing bracket: "+t),o&&U_("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function G_(t,e,n){const r=V_(t);return t=1===r.length?r[0]:t,z_((n&&n.get||P_)(r),[t],e||t)}G_("id"),z_(t=>t,[],"identity"),z_(()=>0,[],"zero"),z_(()=>1,[],"one"),z_(()=>!0,[],"true"),z_(()=>!1,[],"false");Array.isArray;const H_=Object.prototype.hasOwnProperty;function X_(t,e){return H_.call(t,e)}function K_(t,e,n){const r=t.prototype=Object.create(e.prototype);return r.constructor=t,function(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}(r,n)}function Y_(t,e){var n,r,i,a,o,s,u=[],c=function(t){return t(a)};if(null==e)u.push(t);else for(n={},r=0,i=t.length;r<i;++r)a=t[r],(s=n[o=e.map(c)])||(n[o]=s=[],s.dims=o,u.push(s)),s.push(a);return u}function J_(t){Pn.call(this,null,t)}J_.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},K_(J_,Pn,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=Y_(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(L_),a=i.length,o=t.as||[L_(t.x),L_(t.y)],s=[];r.forEach(e=>{gi(e,t.x,t.y,t.bandwidth||.3).forEach(t=>{const n={};for(let t=0;t<a;++t)n[i[t]]=e.dims[t];n[o[0]]=t[0],n[o[1]]=t[1],s.push(dn(n))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});const Z_={linear:ci,log:li,exp:di,pow:fi,quad:hi,poly:pi};function Q_(t){Pn.call(this,null,t)}function tA(t,e,n){return t.fields=e||[],t.fname=n,t}function eA(t){return 1===t.length?nA(t[0]):rA(t)}Q_.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(Z_)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},K_(Q_,Pn,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=Y_(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(L_),a=t.method||"linear",o=t.order||3,s=((t,e)=>"poly"===t?e:"quad"===t?2:1)(a,o),u=t.as||[L_(t.x),L_(t.y)],c=Z_[a],l=[];let d=t.extent;X_(Z_,a)||U_("Invalid regression method: "+a),null!=d&&"log"===a&&d[0]<=0&&(e.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),r.forEach(n=>{if(n.length<=s)return void e.dataflow.warn("Skipping regression with more parameters than data points.");const r=c(n,t.x,t.y,o);if(t.params)return void l.push(dn({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const f=d||function(t,e){let n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!=r);r=t[++o]);for(i=a=r;o<n;++o)r=t[o],null!=r&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!=r);r=e(t[++o]));for(i=a=r;o<n;++o)r=e(t[o]),null!=r&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]}(n,t.x),h=t=>{const e={};for(let t=0;t<i.length;++t)e[i[t]]=n.dims[t];e[u[0]]=t[0],e[u[1]]=t[1],l.push(dn(e))};"linear"===a?f.forEach(t=>h([t,r.predict(t)])):xi(r.predict,f,25,200).forEach(h)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const nA=t=>function(e){return e[t]},rA=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function iA(t){throw Error(t)}function aA(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||iA("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&iA("Access path missing closing bracket: "+t),o&&iA("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function oA(t,e,n){const r=aA(t);return t=1===r.length?r[0]:t,tA((n&&n.get||eA)(r),[t],e||t)}oA("id"),tA(t=>t,[],"identity"),tA(()=>0,[],"zero"),tA(()=>1,[],"one"),tA(()=>!0,[],"true"),tA(()=>!1,[],"false");Array.isArray;Object.prototype.hasOwnProperty;const sA=Math.pow(2,-52),uA=new Uint32Array(512);class cA{static from(t,e=bA,n=yA){const r=t.length,i=new Float64Array(2*r);for(let a=0;a<r;a++){const r=t[a];i[2*a]=e(r),i[2*a+1]=n(r)}return new cA(i)}constructor(t){const e=t.length>>1;if(e>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:i}=this,a=t.length>>1;let o=1/0,s=1/0,u=-1/0,c=-1/0;for(let e=0;e<a;e++){const n=t[2*e],r=t[2*e+1];n<o&&(o=n),r<s&&(s=r),n>u&&(u=n),r>c&&(c=r),this._ids[e]=e}const l=(o+u)/2,d=(s+c)/2;let f,h,p,m=1/0;for(let e=0;e<a;e++){const n=lA(l,d,t[2*e],t[2*e+1]);n<m&&(f=e,m=n)}const g=t[2*f],b=t[2*f+1];m=1/0;for(let e=0;e<a;e++){if(e===f)continue;const n=lA(g,b,t[2*e],t[2*e+1]);n<m&&n>0&&(h=e,m=n)}let y=t[2*h],v=t[2*h+1],x=1/0;for(let e=0;e<a;e++){if(e===f||e===h)continue;const n=pA(g,b,y,v,t[2*e],t[2*e+1]);n<x&&(p=e,x=n)}let w=t[2*p],k=t[2*p+1];if(x===1/0){for(let e=0;e<a;e++)this._dists[e]=t[2*e]-t[0]||t[2*e+1]-t[1];mA(this._ids,this._dists,0,a-1);const e=new Uint32Array(a);let n=0;for(let t=0,r=-1/0;t<a;t++){const i=this._ids[t];this._dists[i]>r&&(e[n++]=i,r=this._dists[i])}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(fA(g,b,y,v,w,k)){const t=h,e=y,n=v;h=p,y=w,v=k,p=t,w=e,k=n}const O=function(t,e,n,r,i,a){const o=n-t,s=r-e,u=i-t,c=a-e,l=o*o+s*s,d=u*u+c*c,f=.5/(o*c-s*u);return{x:t+(c*l-s*d)*f,y:e+(o*d-u*l)*f}}(g,b,y,v,w,k);this._cx=O.x,this._cy=O.y;for(let e=0;e<a;e++)this._dists[e]=lA(t[2*e],t[2*e+1],O.x,O.y);mA(this._ids,this._dists,0,a-1),this._hullStart=f;let _=3;n[f]=e[p]=h,n[h]=e[f]=p,n[p]=e[h]=f,r[f]=0,r[h]=1,r[p]=2,i.fill(-1),i[this._hashKey(g,b)]=f,i[this._hashKey(y,v)]=h,i[this._hashKey(w,k)]=p,this.trianglesLen=0,this._addTriangle(f,h,p,-1,-1,-1);for(let a,o,s=0;s<this._ids.length;s++){const u=this._ids[s],c=t[2*u],l=t[2*u+1];if(s>0&&Math.abs(c-a)<=sA&&Math.abs(l-o)<=sA)continue;if(a=c,o=l,u===f||u===h||u===p)continue;let d=0;for(let t=0,e=this._hashKey(c,l);t<this._hashSize&&(d=i[(e+t)%this._hashSize],-1===d||d===n[d]);t++);d=e[d];let m,g=d;for(;m=n[g],!fA(c,l,t[2*g],t[2*g+1],t[2*m],t[2*m+1]);)if(g=m,g===d){g=-1;break}if(-1===g)continue;let b=this._addTriangle(g,u,n[g],-1,-1,r[g]);r[u]=this._legalize(b+2),r[g]=b,_++;let y=n[g];for(;m=n[y],fA(c,l,t[2*y],t[2*y+1],t[2*m],t[2*m+1]);)b=this._addTriangle(y,u,m,r[u],-1,r[y]),r[u]=this._legalize(b+2),n[y]=y,_--,y=m;if(g===d)for(;m=e[g],fA(c,l,t[2*m],t[2*m+1],t[2*g],t[2*g+1]);)b=this._addTriangle(m,u,g,-1,r[g],r[m]),this._legalize(b+2),r[m]=b,n[g]=g,_--,g=m;this._hullStart=e[u]=g,n[g]=e[y]=u,n[u]=y,i[this._hashKey(c,l)]=u,i[this._hashKey(t[2*g],t[2*g+1])]=g}this.hull=new Uint32Array(_);for(let t=0,e=this._hullStart;t<_;t++)this.hull[t]=e,e=n[e];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let i=0,a=0;for(;;){const o=n[t],s=t-t%3;if(a=s+(t+2)%3,-1===o){if(0===i)break;t=uA[--i];continue}const u=o-o%3,c=s+(t+1)%3,l=u+(o+2)%3,d=e[a],f=e[t],h=e[c],p=e[l];if(hA(r[2*d],r[2*d+1],r[2*f],r[2*f+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1])){e[t]=p,e[o]=d;const r=n[l];if(-1===r){let e=this._hullStart;do{if(this._hullTri[e]===l){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,r),this._link(o,n[a]),this._link(a,l);const s=u+(o+1)%3;i<uA.length&&(uA[i++]=s)}else{if(0===i)break;t=uA[--i]}}return a}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,i,a){const o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=e,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,i),this._link(o+2,a),this.trianglesLen+=3,o}}function lA(t,e,n,r){const i=t-n,a=e-r;return i*i+a*a}function dA(t,e,n,r,i,a){const o=(r-e)*(i-t),s=(n-t)*(a-e);return Math.abs(o-s)>=33306690738754716e-32*Math.abs(o+s)?o-s:0}function fA(t,e,n,r,i,a){return(dA(i,a,t,e,n,r)||dA(t,e,n,r,i,a)||dA(n,r,i,a,t,e))<0}function hA(t,e,n,r,i,a,o,s){const u=t-o,c=e-s,l=n-o,d=r-s,f=i-o,h=a-s,p=l*l+d*d,m=f*f+h*h;return u*(d*m-p*h)-c*(l*m-p*f)+(u*u+c*c)*(l*h-d*f)<0}function pA(t,e,n,r,i,a){const o=n-t,s=r-e,u=i-t,c=a-e,l=o*o+s*s,d=u*u+c*c,f=.5/(o*c-s*u),h=(c*l-s*d)*f,p=(o*d-u*l)*f;return h*h+p*p}function mA(t,e,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=t[i],a=e[r];let o=i-1;for(;o>=n&&e[t[o]]>a;)t[o+1]=t[o--];t[o+1]=r}else{let i=n+1,a=r;gA(t,n+r>>1,i),e[t[n]]>e[t[r]]&&gA(t,n,r),e[t[i]]>e[t[r]]&&gA(t,i,r),e[t[n]]>e[t[i]]&&gA(t,n,i);const o=t[i],s=e[o];for(;;){do{i++}while(e[t[i]]<s);do{a--}while(e[t[a]]>s);if(a<i)break;gA(t,i,a)}t[n+1]=t[a],t[a]=o,r-i+1>=a-n?(mA(t,e,i,r),mA(t,e,n,a-1)):(mA(t,e,n,a-1),mA(t,e,i,r))}}function gA(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function bA(t){return t[0]}function yA(t){return t[1]}class vA{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+=`L${this._x1=+t},${this._y1=+e}`}arc(t,e,n){const r=(t=+t)+(n=+n),i=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${i}`:(Math.abs(this._x1-r)>1e-6||Math.abs(this._y1-i)>1e-6)&&(this._+="L"+r+","+i),n&&(this._+=`A${n},${n},0,1,1,${t-n},${e}A${n},${n},0,1,1,${this._x1=r},${this._y1=i}`)}rect(t,e,n,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${+n}v${+r}h${-n}Z`}value(){return this._||null}}class xA{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class wA{constructor(t,[e,n,r,i]=[0,0,960,500]){if(!((r=+r)>=(e=+e)&&(i=+i)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=e,this.ymax=i,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:r}=this,i=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let e,r,a=0,o=0,s=n.length;a<s;a+=3,o+=2){const s=2*n[a],u=2*n[a+1],c=2*n[a+2],l=t[s],d=t[s+1],f=t[u],h=t[u+1],p=t[c],m=t[c+1],g=f-l,b=h-d,y=p-l,v=m-d,x=g*g+b*b,w=y*y+v*v,k=2*(g*v-b*y);if(k)if(Math.abs(k)<1e-8)e=(l+p)/2,r=(d+m)/2;else{const t=1/k;e=l+(v*x-b*w)*t,r=d+(g*w-y*x)*t}else e=(l+p)/2-1e8*v,r=(d+m)/2+1e8*y;i[o]=e,i[o+1]=r}let a,o,s,u=e[e.length-1],c=4*u,l=t[2*u],d=t[2*u+1];r.fill(0);for(let n=0;n<e.length;++n)u=e[n],a=c,o=l,s=d,c=4*u,l=t[2*u],d=t[2*u+1],r[a+2]=r[c]=s-d,r[a+3]=r[c+1]=l-o}render(t){const e=null==t?t=new vA:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:a,vectors:o}=this;if(i.length<=1)return null;for(let e=0,r=n.length;e<r;++e){const r=n[e];if(r<e)continue;const i=2*Math.floor(e/3),o=2*Math.floor(r/3),s=a[i],u=a[i+1],c=a[o],l=a[o+1];this._renderSegment(s,u,c,l,t)}let s,u=i[i.length-1];for(let e=0;e<i.length;++e){s=u,u=i[e];const n=2*Math.floor(r[u]/3),c=a[n],l=a[n+1],d=4*s,f=this._project(c,l,o[d+2],o[d+3]);f&&this._renderSegment(c,l,f[0],f[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new vA:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new vA:void 0,r=this._clip(t);if(null===r||!r.length)return;e.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let t=2;t<i;t+=2)r[t]===r[t-2]&&r[t+1]===r[t-1]||e.lineTo(r[t],r[t+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new xA;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,r,i){let a;const o=this._regioncode(t,e),s=this._regioncode(n,r);0===o&&0===s?(i.moveTo(t,e),i.lineTo(n,r)):(a=this._clipSegment(t,e,n,r,o,s))&&(i.moveTo(a[0],a[1]),i.lineTo(a[2],a[3]))}contains(t,e,n){return(e=+e)==e&&(n=+n)==n&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let r=0,i=e.length;r<i;r+=2)for(let a=0,o=t.length;a<o;a+=2)if(e[r]==t[a]&&e[r+1]==t[a+1]&&e[(r+2)%i]==t[(a+o-2)%o]&&e[(r+3)%i]==t[(a+o-1)%o]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,a=n[t];if(-1===a)return null;const o=[];let s=a;do{const n=Math.floor(s/3);if(o.push(e[2*n],e[2*n+1]),s=s%3==2?s-2:s+1,i[s]!==t)break;s=r[s]}while(s!==a&&-1!==s);return o}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,r=4*t;return n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e)}_clipFinite(t,e){const n=e.length;let r,i,a,o,s,u=null,c=e[n-2],l=e[n-1],d=this._regioncode(c,l);for(let f=0;f<n;f+=2)if(r=c,i=l,c=e[f],l=e[f+1],a=d,d=this._regioncode(c,l),0===a&&0===d)o=s,s=0,u?u.push(c,l):u=[c,l];else{let e,n,f,h,p;if(0===a){if(null===(e=this._clipSegment(r,i,c,l,a,d)))continue;[n,f,h,p]=e}else{if(null===(e=this._clipSegment(c,l,r,i,d,a)))continue;[h,p,n,f]=e,o=s,s=this._edgecode(n,f),o&&s&&this._edge(t,o,s,u,u.length),u?u.push(n,f):u=[n,f]}o=s,s=this._edgecode(h,p),o&&s&&this._edge(t,o,s,u,u.length),u?u.push(h,p):u=[h,p]}if(u)o=s,s=this._edgecode(u[0],u[1]),o&&s&&this._edge(t,o,s,u,u.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return u}_clipSegment(t,e,n,r,i,a){for(;;){if(0===i&&0===a)return[t,e,n,r];if(i&a)return null;let o,s,u=i||a;8&u?(o=t+(n-t)*(this.ymax-e)/(r-e),s=this.ymax):4&u?(o=t+(n-t)*(this.ymin-e)/(r-e),s=this.ymin):2&u?(s=e+(r-e)*(this.xmax-t)/(n-t),o=this.xmax):(s=e+(r-e)*(this.xmin-t)/(n-t),o=this.xmin),i?(t=o,e=s,i=this._regioncode(t,e)):(n=o,r=s,a=this._regioncode(n,r))}}_clipInfinite(t,e,n,r,i,a){let o,s=Array.from(e);if((o=this._project(s[0],s[1],n,r))&&s.unshift(o[0],o[1]),(o=this._project(s[s.length-2],s[s.length-1],i,a))&&s.push(o[0],o[1]),s=this._clipFinite(t,s))for(let e,n=0,r=s.length,i=this._edgecode(s[r-2],s[r-1]);n<r;n+=2)e=i,i=this._edgecode(s[n],s[n+1]),e&&i&&(n=this._edge(t,e,i,s,n),r=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,e,n,r,i){for(;e!==n;){let n,a;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,a=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,a=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,a=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,a=this.ymin}r[i]===n&&r[i+1]===a||!this.contains(t,n,a)||(r.splice(i,0,n,a),i+=2)}if(r.length>4)for(let t=0;t<r.length;t+=2){const e=(t+2)%r.length,n=(t+4)%r.length;(r[t]===r[e]&&r[e]===r[n]||r[t+1]===r[e+1]&&r[e+1]===r[n+1])&&(r.splice(e,2),t-=2)}return i}_project(t,e,n,r){let i,a,o,s=1/0;if(r<0){if(e<=this.ymin)return null;(i=(this.ymin-e)/r)<s&&(o=this.ymin,a=t+(s=i)*n)}else if(r>0){if(e>=this.ymax)return null;(i=(this.ymax-e)/r)<s&&(o=this.ymax,a=t+(s=i)*n)}if(n>0){if(t>=this.xmax)return null;(i=(this.xmax-t)/n)<s&&(a=this.xmax,o=e+(s=i)*r)}else if(n<0){if(t<=this.xmin)return null;(i=(this.xmin-t)/n)<s&&(a=this.xmin,o=e+(s=i)*r)}return[a,o]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}}const kA=2*Math.PI,OA=Math.pow;function _A(t){return t[0]}function AA(t){return t[1]}function CA(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class EA{static from(t,e=_A,n=AA,r){return new EA("length"in t?function(t,e,n,r){const i=t.length,a=new Float64Array(2*i);for(let o=0;o<i;++o){const i=t[o];a[2*o]=e.call(r,i,o,t),a[2*o+1]=n.call(r,i,o,t)}return a}(t,e,n,r):Float64Array.from(function*(t,e,n,r){let i=0;for(const a of t)yield e.call(r,a,i,t),yield n.call(r,a,i,t),++i}(t,e,n,r)))}constructor(t){this._delaunator=new cA(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:e,coords:n}=t;for(let t=0;t<e.length;t+=3){const r=2*e[t],i=2*e[t+1],a=2*e[t+2];if((n[a]-n[r])*(n[i+1]-n[r+1])-(n[i]-n[r])*(n[a+1]-n[r+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},(t,e)=>e).sort((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]);const t=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let t=0,n=e.length/2;t<n;++t){const n=CA(e[2*t],e[2*t+1],i);e[2*t]=n[0],e[2*t+1]=n[1]}this._delaunator=new cA(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let t=0,e=n.length;t<e;++t){const e=i[t%3==2?t-2:t+1];-1!==n[t]&&-1!==a[e]||(a[e]=t)}for(let t=0,e=r.length;t<e;++t)o[r[t]]=t;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],a[r[0]]=1,2===r.length&&(a[r[1]]=0))}voronoi(t){return new wA(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:r,halfedges:i,triangles:a,collinear:o}=this;if(o){const e=o.indexOf(t);return e>0&&(yield o[e-1]),void(e<o.length-1&&(yield o[e+1]))}const s=e[t];if(-1===s)return;let u=s,c=-1;do{if(yield c=a[u],u=u%3==2?u-2:u+1,a[u]!==t)return;if(u=i[u],-1===u){const e=n[(r[t]+1)%n.length];return void(e!==c&&(yield e))}}while(u!==s)}find(t,e,n=0){if((t=+t)!=t||(e=+e)!=e)return-1;const r=n;let i;for(;(i=this._step(n,t,e))>=0&&i!==n&&i!==r;)n=i;return i}_step(t,e,n){const{inedges:r,hull:i,_hullIndex:a,halfedges:o,triangles:s,points:u}=this;if(-1===r[t]||!u.length)return(t+1)%(u.length>>1);let c=t,l=OA(e-u[2*t],2)+OA(n-u[2*t+1],2);const d=r[t];let f=d;do{let r=s[f];const d=OA(e-u[2*r],2)+OA(n-u[2*r+1],2);if(d<l&&(l=d,c=r),f=f%3==2?f-2:f+1,s[f]!==t)break;if(f=o[f],-1===f){if(f=i[(a[t]+1)%i.length],f!==r&&OA(e-u[2*f],2)+OA(n-u[2*f+1],2)<l)return f;break}}while(f!==d);return c}render(t){const e=null==t?t=new vA:void 0,{points:n,halfedges:r,triangles:i}=this;for(let e=0,a=r.length;e<a;++e){const a=r[e];if(a<e)continue;const o=2*i[e],s=2*i[a];t.moveTo(n[o],n[o+1]),t.lineTo(n[s],n[s+1])}return this.renderHull(t),e&&e.value()}renderPoints(t,e=2){const n=null==t?t=new vA:void 0,{points:r}=this;for(let n=0,i=r.length;n<i;n+=2){const i=r[n],a=r[n+1];t.moveTo(i+e,a),t.arc(i,a,e,0,kA)}return n&&n.value()}renderHull(t){const e=null==t?t=new vA:void 0,{hull:n,points:r}=this,i=2*n[0],a=n.length;t.moveTo(r[i],r[i+1]);for(let e=1;e<a;++e){const i=2*n[e];t.lineTo(r[i],r[i+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new xA;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new vA:void 0,{points:r,triangles:i}=this,a=2*i[t*=3],o=2*i[t+1],s=2*i[t+2];return e.moveTo(r[a],r[a+1]),e.lineTo(r[o],r[o+1]),e.lineTo(r[s],r[s+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new xA;return this.renderTriangle(t,e),e.value()}}function SA(t){Pn.call(this,null,t)}SA.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const jA=[-1e5,-1e5,1e5,1e5];function NA(t){const e=t[0][0],n=t[0][1];let r=t.length-1;for(;t[r][0]===e&&t[r][1]===n;--r);return"M"+t.slice(0,r+1).join("L")+"Z"}function TA(t,e,n){return t.fields=e||[],t.fname=n,t}function FA(t){return 1===t.length?DA(t[0]):IA(t)}!function(t,e,n){const r=t.prototype=Object.create(e.prototype);r.constructor=t,function(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n]}(r,n)}(SA,Pn,{transform(t,e){const n=t.as||"path",r=e.source;if(!r||!r.length)return e;let i=t.size;i=i?[0,0,i[0],i[1]]:(i=t.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:jA;const a=this.value=EA.from(r,t.x,t.y).voronoi(i);for(let t=0,e=r.length;t<e;++t){const e=a.cellPolygon(t);r[t][n]=e?NA(e):null}return e.reflow(t.modified()).modifies(n)}});const DA=t=>function(e){return e[t]},IA=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function MA(t){throw Error(t)}function $A(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||MA("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&MA("Access path missing closing bracket: "+t),o&&MA("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function RA(t,e,n){const r=$A(t);return t=1===r.length?r[0]:t,TA((n&&n.get||FA)(r),[t],e||t)}RA("id"),TA(t=>t,[],"identity"),TA(()=>0,[],"zero"),TA(()=>1,[],"one"),TA(()=>!0,[],"true"),TA(()=>!1,[],"false");var BA=Array.isArray;function zA(t){return t[t.length-1]}function LA(t){return null==t||""===t?null:+t}function PA(t){return null!=t?BA(t)?t:[t]:[]}function qA(t){return"function"==typeof t}function WA(t){return qA(t)?t:()=>t}const UA=Object.prototype.hasOwnProperty;function VA(t,e){return UA.call(t,e)}function GA(){const t=Js().unknown(void 0),e=t.domain,n=t.range;let r,i,a=[0,1],o=!1,s=0,u=0,c=.5;function l(){const t=e().length,l=a[1]<a[0],d=a[1-l],f=function(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}(t,s,u);let h=a[l-0];r=(d-h)/(f||1),o&&(r=Math.floor(r)),h+=(d-h-r*(t-s))*c,i=r*(1-s),o&&(h=Math.round(h),i=Math.round(i));const p=ki(t).map(t=>h+r*t);return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},t.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(o=!!t,l()):o},t.padding=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),s=u,l()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},t.paddingOuter=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=a[1]<a[0],o=r?n().reverse():n(),s=o.length-1;let u,c,l,d=+t[0],f=+t[1];return d!=d||f!=f||(f<d&&(l=d,d=f,f=l),f<o[0]||d>a[1-r])?void 0:(u=Math.max(0,Vs(o,d)-1),c=d===f?u:Vs(o,f)-1,d-o[u]>i+1e-10&&++u,r&&(l=u,u=s-c,c=s-l),u>c?void 0:e().slice(u,c+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return GA().domain(e()).range(a).round(o).paddingInner(s).paddingOuter(u).align(c)},l()}var HA=Array.prototype.map;function XA(t){return HA.call(t,LA)}const KA=Array.prototype.slice;const YA={};function JA(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,a,o,s=e[0],u=e[1],c=-1;for(u<s&&(i=s,s=u,u=i),a=0,o=n.length;a<o;++a)n[a]>=s&&n[a]<=u&&(c<0&&(c=a),r=a);if(!(c<0))return s=t.invertExtent(n[c]),u=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=t,n};return r.metadata=function(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}(PA(n)),r}function ZA(t,e,n){return arguments.length>1?(YA[t]=JA(t,e,n),this):QA(t)?YA[t]:void 0}function QA(t){return VA(YA,t)}ZA("identity",fc),ZA("linear",dc,"continuous"),ZA("log",wc,["continuous","log"]),ZA("pow",Cc,"continuous"),ZA("sqrt",Ec,"continuous"),ZA("symlog",Tc,"continuous"),ZA("time",Uc,["continuous","temporal"]),ZA("utc",Jc,["continuous","temporal"]),ZA("sequential",tl,["continuous","interpolating"]),ZA("".concat("sequential","-").concat("linear"),tl,["continuous","interpolating"]),ZA("".concat("sequential","-").concat("log"),el,["continuous","interpolating","log"]),ZA("".concat("sequential","-").concat("pow"),rl,["continuous","interpolating"]),ZA("".concat("sequential","-").concat("sqrt"),il,["continuous","interpolating"]),ZA("".concat("sequential","-").concat("symlog"),nl,["continuous","interpolating"]),ZA("".concat("diverging","-").concat("linear"),sl,["continuous","interpolating"]),ZA("".concat("diverging","-").concat("log"),ul,["continuous","interpolating","log"]),ZA("".concat("diverging","-").concat("pow"),ll,["continuous","interpolating"]),ZA("".concat("diverging","-").concat("sqrt"),dl,["continuous","interpolating"]),ZA("".concat("diverging","-").concat("symlog"),cl,["continuous","interpolating"]),ZA("quantile",fl,["discretizing","quantile"]),ZA("quantize",hl,"discretizing"),ZA("threshold",pl,"discretizing"),ZA("bin-ordinal",(function t(){let e=[],n=[];function r(t){return null==t||t!=t?void 0:n[(Hs(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=XA(t),r):e.slice()},r.range=function(t){return arguments.length?(n=KA.call(t),r):n.slice()},r.tickFormat=function(t,n){return tu(e[0],zA(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),["discrete","discretizing"]),ZA("ordinal",Js,"discrete"),ZA("band",GA,"discrete"),ZA("point",(function(){return function t(e){const n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return t(n())},e}(GA().paddingInner(1))}),"discrete");function tC(t,e,n){return al(function(t,e){const n=o[function(t){return"interpolate"+t.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}(e||"rgb",n),t)}function eC(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function nC(t,e){for(const n in t)iC(n,e(t[n]))}const rC={};function iC(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(rC[t]=e,this):rC[t]}nC({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},eC),nC({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},t=>tC(eC(t)));var aC=Math.PI/180;function oC(){var t,e,n,r,i,a,o,s=[256,256],u=lC,c=[],l=Math.random,d={};function f(t,e,n){for(var r,i,a,o,c,d=e.x,f=e.y,h=Math.sqrt(s[0]*s[0]+s[1]*s[1]),p=u(s),m=l()<.5?1:-1,g=-m;(r=p(g+=m))&&(i=~~r[0],a=~~r[1],!(Math.min(Math.abs(i),Math.abs(a))>=h));)if(e.x=d+i,e.y=f+a,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>s[0]||e.y+e.y1>s[1]||n&&uC(e,t,s[0])||n&&(c=n,!((o=e).x+o.x1>c[0].x&&o.x+o.x0<c[1].x&&o.y+o.y1>c[0].y&&o.y+o.y0<c[1].y)))){for(var b,y=e.sprite,v=e.width>>5,x=s[0]>>5,w=e.x-(v<<4),k=127&w,O=32-k,_=e.y1-e.y0,A=(e.y+e.y0)*x+(w>>5),C=0;C<_;C++){b=0;for(var E=0;E<=v;E++)t[A+E]|=b<<O|(E<v?(b=y[C*v+E])>>>k:0);A+=x}return e.sprite=null,!0}return!1}return d.layout=function(){for(var u=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=2048/e,t.height=2048/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(qs()),d=function(t){var e=[],n=-1;for(;++n<t;)e[n]=0;return e}((s[0]>>5)*s[1]),h=null,p=c.length,m=-1,g=[],b=c.map(s=>({text:t(s),font:e(s),style:r(s),weight:i(s),rotate:a(s),size:~~(n(s)+1e-14),padding:o(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s})).sort((t,e)=>e.size-t.size);++m<p;){var y=b[m];y.x=s[0]*(l()+.5)>>1,y.y=s[1]*(l()+.5)>>1,sC(u,y,b,m),y.hasText&&f(d,y,h)&&(g.push(y),h?cC(h,y):h=[{x:y.x+y.x0,y:y.y+y.y0},{x:y.x+y.x1,y:y.y+y.y1}],y.x-=s[0]>>1,y.y-=s[1]>>1)}return g},d.words=function(t){return arguments.length?(c=t,d):c},d.size=function(t){return arguments.length?(s=[+t[0],+t[1]],d):s},d.font=function(t){return arguments.length?(e=dC(t),d):e},d.fontStyle=function(t){return arguments.length?(r=dC(t),d):r},d.fontWeight=function(t){return arguments.length?(i=dC(t),d):i},d.rotate=function(t){return arguments.length?(a=dC(t),d):a},d.text=function(e){return arguments.length?(t=dC(e),d):t},d.spiral=function(t){return arguments.length?(u=fC[t]||t,d):u},d.fontSize=function(t){return arguments.length?(n=dC(t),d):n},d.padding=function(t){return arguments.length?(o=dC(t),d):o},d.random=function(t){return arguments.length?(l=t,d):l},d}function sC(t,e,n,r){if(!e.sprite){var i=t.context,a=t.ratio;i.clearRect(0,0,2048/a,2048/a);var o,s,u,c,l,d=0,f=0,h=0,p=n.length;for(--r;++r<p;){if(e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/a)+"px "+e.font,o=i.measureText(e.text+"m").width*a,u=e.size<<1,e.rotate){var m=Math.sin(e.rotate*aC),g=Math.cos(e.rotate*aC),b=o*g,y=o*m,v=u*g,x=u*m;o=Math.max(Math.abs(b+x),Math.abs(b-x))+31>>5<<5,u=~~Math.max(Math.abs(y+v),Math.abs(y-v))}else o=o+31>>5<<5;if(u>h&&(h=u),d+o>=2048&&(d=0,f+=h,h=0),f+u>=2048)break;i.translate((d+(o>>1))/a,(f+(u>>1))/a),e.rotate&&i.rotate(e.rotate*aC),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=o,e.height=u,e.xoff=d,e.yoff=f,e.x1=o>>1,e.y1=u>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,d+=o}for(var w=i.getImageData(0,0,2048/a,2048/a).data,k=[];--r>=0;)if((e=n[r]).hasText){for(s=(o=e.width)>>5,u=e.y1-e.y0,c=0;c<u*s;c++)k[c]=0;if(null==(d=e.xoff))return;f=e.yoff;var O=0,_=-1;for(l=0;l<u;l++){for(c=0;c<o;c++){var A=s*l+(c>>5),C=w[2048*(f+l)+(d+c)<<2]?1<<31-c%32:0;k[A]|=C,O|=C}O?_=l:(e.y0++,u--,l--,f++)}e.y1=e.y0+_,e.sprite=k.slice(0,(e.y1-e.y0)*s)}}}function uC(t,e,n){n>>=5;for(var r,i=t.sprite,a=t.width>>5,o=t.x-(a<<4),s=127&o,u=32-s,c=t.y1-t.y0,l=(t.y+t.y0)*n+(o>>5),d=0;d<c;d++){r=0;for(var f=0;f<=a;f++)if((r<<u|(f<a?(r=i[d*a+f])>>>s:0))&e[l+f])return!0;l+=n}return!1}function cC(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function lC(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function dC(t){return"function"==typeof t?t:function(){return t}}var fC={archimedean:lC,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var i=t<0?-1:1;switch(Math.sqrt(1+4*i*t)-i&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}};const hC=["x","y","font","fontSize","fontStyle","fontWeight","angle"],pC=["text","font","rotate","fontSize","fontStyle","fontWeight"];function mC(t){Pn.call(this,oC(),t)}mC.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:hC}]},function(t,e,n){const r=t.prototype=Object.create(e.prototype);r.constructor=t,function(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n]}(r,n)}(mC,Pn,{transform(t,e){!t.size||t.size[0]&&t.size[1]||MA("Wordcloud size dimensions must be non-zero.");const n=t.modified();if(!(n||e.changed(e.ADD_REM)||pC.some((function(n){const r=t[n];return qA(r)&&e.modified(r.fields)}))))return;const r=e.materialize(e.SOURCE).source,i=this.value,a=t.as||hC;let o,s=t.fontSize||14;if(qA(s)?o=t.fontSizeRange:s=WA(s),o){const t=s,e=ZA("sqrt")().domain(function(t,e){let n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!=r);r=t[++o]);for(i=a=r;o<n;++o)r=t[o],null!=r&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!=r);r=e(t[++o]));for(i=a=r;o<n;++o)r=e(t[o]),null!=r&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]}(r,t)).range(o);s=n=>e(t(n))}r.forEach(t=>{t[a[0]]=NaN,t[a[1]]=NaN,t[a[3]]=0});const u=i.words(r).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(s).random(Dr).layout(),c=i.size(),l=c[0]>>1,d=c[1]>>1,f=u.length;for(let t,e,n=0;n<f;++n)t=u[n],e=t.datum,e[a[0]]=t.x+l,e[a[1]]=t.y+d,e[a[2]]=t.font,e[a[3]]=t.size,e[a[4]]=t.style,e[a[5]]=t.weight,e[a[6]]=t.rotate;return e.reflow(n).modifies(a)}});function gC(t,e,n){return t.fields=e||[],t.fname=n,t}function bC(t){return 1===t.length?yC(t[0]):vC(t)}const yC=t=>function(e){return e[t]},vC=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function xC(t){throw Error(t)}function wC(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||xC("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&xC("Access path missing closing bracket: "+t),o&&xC("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function kC(t,e,n){const r=wC(t);return t=1===r.length?r[0]:t,gC((n&&n.get||bC)(r),[t],e||t)}kC("id"),gC(t=>t,[],"identity"),gC(()=>0,[],"zero"),gC(()=>1,[],"one"),gC(()=>!0,[],"true"),gC(()=>!1,[],"false");Array.isArray;Object.prototype.hasOwnProperty;function OC(t,e,n){const r=t.prototype=Object.create(e.prototype);return r.constructor=t,function(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}(r,n)}const _C=t=>new Uint8Array(t),AC=t=>new Uint16Array(t),CC=t=>new Uint32Array(t);function EC(t,e,n){const r=(e<257?_C:e<65537?AC:CC)(t);return n&&r.set(n),r}function SC(t,e,n){const r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(t,e){const n=this.bisect(this.range,t.value),i=t.index,a=n[0],o=n[1],s=i.length;let u;for(u=0;u<a;++u)e[i[u]]|=r;for(u=o;u<s;++u)e[i[u]]|=r;return this}}}function jC(){let t=CC(0),e=[],n=0;return{insert:function(r,i,a){if(!i.length)return[];const o=n,s=i.length,u=CC(s);let c,l,d,f=Array(s);for(d=0;d<s;++d)f[d]=r(i[d]),u[d]=d;if(f=function(t,e){return t.sort.call(e,(e,n)=>{const r=t[e],i=t[n];return r<i?-1:r>i?1:0}),function(t,e){return Array.from(e,e=>t[e])}(t,e)}(f,u),o)c=e,l=t,e=Array(o+s),t=CC(o+s),function(t,e,n,r,i,a,o,s,u){let c,l=0,d=0;for(c=0;l<r&&d<o;++c)e[l]<i[d]?(s[c]=e[l],u[c]=n[l++]):(s[c]=i[d],u[c]=a[d++]+t);for(;l<r;++l,++c)s[c]=e[l],u[c]=n[l];for(;d<o;++d,++c)s[c]=i[d],u[c]=a[d]+t}(a,c,l,o,f,u,s,e,t);else{if(a>0)for(d=0;d<s;++d)u[d]+=a;e=f,t=u}return n=o+s,{index:u,value:f}},remove:function(r,i){const a=n;let o,s,u;for(s=0;!i[t[s]]&&s<a;++s);for(u=s;s<a;++s)i[o=t[s]]||(t[u]=o,e[u]=e[s],++u);n=a-r},bisect:function(t,r){let i;return r?i=r.length:(r=e,i=n),[Gs(r,t[0],0,i),Vs(r,t[1],0,i)]},reindex:function(e){for(let r=0,i=n;r<i;++r)t[r]=e[t[r]]},index:()=>t,size:()=>n}}function NC(t){Pn.call(this,function(){let t=8,e=[],n=CC(0),r=EC(0,t),i=EC(0,t);return{data:()=>e,seen:()=>{return t=n,r=e.length,n=t.length>=r?t:((i=i||new t.constructor(r)).set(t),i);var t,r,i},add(t){for(let n,r=0,i=e.length,a=t.length;r<a;++r)n=t[r],n._index=i++,e.push(n)},remove(t,n){const a=e.length,o=Array(a-t),s=e;let u,c,l;for(c=0;!n[c]&&c<a;++c)o[c]=e[c],s[c]=c;for(l=c;c<a;++c)u=e[c],n[c]?s[c]=-1:(s[c]=l,r[l]=r[c],i[l]=i[c],o[l]=u,u._index=l++),r[c]=0;return e=o,s},size:()=>e.length,curr:()=>r,prev:()=>i,reset:t=>i[t]=r[t],all:()=>t<257?255:t<65537?65535:4294967295,set(t,e){r[t]|=e},clear(t,e){r[t]&=~e},resize(e,n){(e>r.length||n>t)&&(t=Math.max(n,t),r=EC(e,t,r),i=EC(e,t))}}}(),t),this._indices=null,this._dims=null}function TC(t){Pn.call(this,null,t)}NC.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},OC(NC,Pn,{transform(t,e){return this._dims?t.modified("fields")||t.fields.some(t=>e.modified(t.fields))?this.reinit(t,e):this.eval(t,e):this.init(t,e)},init(t,e){const n=t.fields,r=t.query,i=this._indices={},a=this._dims=[],o=r.length;let s,u,c=0;for(;c<o;++c)s=n[c].fname,u=i[s]||(i[s]=jC()),a.push(SC(u,c,r[c]));return this.eval(t,e)},reinit(t,e){const n=e.materialize().fork(),r=t.fields,i=t.query,a=this._indices,o=this._dims,s=this.value,u=s.curr(),c=s.prev(),l=s.all(),d=n.rem=n.add,f=n.mod,h=i.length,p={};let m,g,b,y,v,x,w,k,O;if(c.set(u),e.rem.length&&(v=this.remove(t,e,n)),e.add.length&&s.add(e.add),e.mod.length)for(x={},y=e.mod,w=0,k=y.length;w<k;++w)x[y[w]._index]=1;for(w=0;w<h;++w)O=r[w],(!o[w]||t.modified("fields",w)||e.modified(O.fields))&&(b=O.fname,(m=p[b])||(a[b]=g=jC(),p[b]=m=g.insert(O,e.source,0)),o[w]=SC(g,w,i[w]).onAdd(m,u));for(w=0,k=s.data().length;w<k;++w)v[w]||(c[w]!==u[w]?d.push(w):x[w]&&u[w]!==l&&f.push(w));return s.mask=(1<<h)-1,n},eval(t,e){const n=e.materialize().fork(),r=this._dims.length;let i=0;return e.rem.length&&(this.remove(t,e,n),i|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(i|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),i|=(1<<r)-1),e.mod.length&&(this.modify(e,n),i|=(1<<r)-1),this.value.mask=i,n},insert(t,e,n){const r=e.add,i=this.value,a=this._dims,o=this._indices,s=t.fields,u={},c=n.add,l=i.size()+r.length,d=a.length;let f,h,p,m=i.size();i.resize(l,d),i.add(r);const g=i.curr(),b=i.prev(),y=i.all();for(f=0;f<d;++f)h=s[f].fname,p=u[h]||(u[h]=o[h].insert(s[f],r,m)),a[f].onAdd(p,g);for(;m<l;++m)b[m]=y,g[m]!==y&&c.push(m)},modify(t,e){const n=e.mod,r=this.value,i=r.curr(),a=r.all(),o=t.mod;let s,u,c;for(s=0,u=o.length;s<u;++s)c=o[s]._index,i[c]!==a&&n.push(c)},remove(t,e,n){const r=this._indices,i=this.value,a=i.curr(),o=i.prev(),s=i.all(),u={},c=n.rem,l=e.rem;let d,f,h,p;for(d=0,f=l.length;d<f;++d)h=l[d]._index,u[h]=1,o[h]=p=a[h],a[h]=s,p!==s&&c.push(h);for(h in r)r[h].remove(f,u);return this.reindex(e,f,u),u},reindex(t,e,n){const r=this._indices,i=this.value;t.runAfter(()=>{const t=i.remove(e,n);for(const e in r)r[e].reindex(t)})},update(t,e,n){const r=this._dims,i=t.query,a=e.stamp,o=r.length;let s,u,c=0;for(n.filters=0,u=0;u<o;++u)t.modified("query",u)&&(s=u,++c);if(1===c)c=r[s].one,this.incrementOne(r[s],i[s],n.add,n.rem);else for(u=0,c=0;u<o;++u)t.modified("query",u)&&(c|=r[u].one,this.incrementAll(r[u],i[u],a,n.add),n.rem=n.add);return c},incrementAll(t,e,n,r){const i=this.value,a=i.seen(),o=i.curr(),s=i.prev(),u=t.index(),c=t.bisect(t.range),l=t.bisect(e),d=l[0],f=l[1],h=c[0],p=c[1],m=t.one;let g,b,y;if(d<h)for(g=d,b=Math.min(h,f);g<b;++g)y=u[g],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=m;else if(d>h)for(g=h,b=Math.min(d,p);g<b;++g)y=u[g],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=m;if(f>p)for(g=Math.max(d,p),b=f;g<b;++g)y=u[g],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=m;else if(f<p)for(g=Math.max(h,f),b=p;g<b;++g)y=u[g],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=m;t.range=e.slice()},incrementOne(t,e,n,r){const i=this.value.curr(),a=t.index(),o=t.bisect(t.range),s=t.bisect(e),u=s[0],c=s[1],l=o[0],d=o[1],f=t.one;let h,p,m;if(u<l)for(h=u,p=Math.min(l,c);h<p;++h)m=a[h],i[m]^=f,n.push(m);else if(u>l)for(h=l,p=Math.min(u,d);h<p;++h)m=a[h],i[m]^=f,r.push(m);if(c>d)for(h=Math.max(u,d),p=c;h<p;++h)m=a[h],i[m]^=f,n.push(m);else if(c<d)for(h=Math.max(l,c),p=d;h<p;++h)m=a[h],i[m]^=f,r.push(m);t.range=e.slice()}}),TC.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},OC(TC,Pn,{transform(t,e){const n=~(t.ignore||0),r=t.filter,i=r.mask;if(0==(i&n))return e.StopPropagation;const a=e.fork(e.ALL),o=r.data(),s=r.curr(),u=r.prev(),c=t=>s[t]&n?null:o[t];return a.filter(a.MOD,c),i&i-1?(a.filter(a.ADD,t=>{const e=s[t]&n;return!e&&e^u[t]&n?o[t]:null}),a.filter(a.REM,t=>{const e=s[t]&n;return e&&!(e^e^u[t]&n)?o[t]:null})):(a.filter(a.ADD,c),a.filter(a.REM,t=>(s[t]&n)===i?o[t]:null)),a.filter(a.SOURCE,t=>c(t._index))}});var FC=n(287),DC=0;function IC(t){return t&&t.gradient}function MC(t,e,n){let r=t.id,i=t.gradient,a="radial"===i?"p_":"";return r||(r=t.id="gradient_"+DC++,"radial"===i?(t.x1=$C(t.x1,.5),t.y1=$C(t.y1,.5),t.r1=$C(t.r1,0),t.x2=$C(t.x2,.5),t.y2=$C(t.y2,.5),t.r2=$C(t.r2,.5),a="p_"):(t.x1=$C(t.x1,0),t.y1=$C(t.y1,0),t.x2=$C(t.x2,1),t.y2=$C(t.y2,0))),e[r]=t,"url("+(n||"")+"#"+a+r+")"}function $C(t,e){return null!=t?t:e}var RC=function(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}};function BC(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function zC(t){this._context=t}zC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:BC(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:BC(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var LC=function(){};function PC(t){this._context=t}PC.prototype={areaStart:LC,areaEnd:LC,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:BC(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function qC(t){this._context=t}qC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:BC(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function WC(t,e){this._basis=new zC(t),this._beta=e}WC.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],a=e[0],o=t[n]-i,s=e[n]-a,u=-1;++u<=n;)r=u/n,this._basis.point(this._beta*t[u]+(1-this._beta)*(i+r*o),this._beta*e[u]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var UC=function t(e){function n(t){return 1===e?new zC(t):new WC(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function VC(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function GC(t,e){this._context=t,this._k=(1-e)/6}GC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:VC(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:VC(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var HC=function t(e){function n(t){return new GC(t,e)}return n.tension=function(e){return t(+e)},n}(0);function XC(t,e){this._context=t,this._k=(1-e)/6}XC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:VC(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var KC=function t(e){function n(t){return new XC(t,e)}return n.tension=function(e){return t(+e)},n}(0);function YC(t,e){this._context=t,this._k=(1-e)/6}YC.prototype={areaStart:LC,areaEnd:LC,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:VC(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var JC=function t(e){function n(t){return new YC(t,e)}return n.tension=function(e){return t(+e)},n}(0),ZC=Math.abs,QC=Math.atan2,tE=Math.cos,eE=Math.max,nE=Math.min,rE=Math.sin,iE=Math.sqrt,aE=Math.PI,oE=aE/2,sE=2*aE;function uE(t){return t>1?0:t<-1?aE:Math.acos(t)}function cE(t){return t>=1?oE:t<=-1?-oE:Math.asin(t)}function lE(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>1e-12){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>1e-12){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*c+t._x1*t._l23_2a-e*t._l12_2a)/l,o=(o*c+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function dE(t,e){this._context=t,this._alpha=e}dE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:lE(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var fE=function t(e){function n(t){return e?new dE(t,e):new GC(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function hE(t,e){this._context=t,this._alpha=e}hE.prototype={areaStart:LC,areaEnd:LC,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:lE(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var pE=function t(e){function n(t){return e?new hE(t,e):new YC(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function mE(t,e){this._context=t,this._alpha=e}mE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:lE(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var gE=function t(e){function n(t){return e?new mE(t,e):new XC(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function bE(t){this._context=t}bE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var yE=function(t){return new bE(t)};function vE(t){this._context=t}vE.prototype={areaStart:LC,areaEnd:LC,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function xE(t){return t<0?-1:1}function wE(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(xE(a)+xE(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function kE(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function OE(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,s=(a-r)/3;t._context.bezierCurveTo(r+s,i+s*e,a-s,o-s*n,a,o)}function _E(t){this._context=t}function AE(t){this._context=new CE(t)}function CE(t){this._context=t}function EE(t){this._context=t}function SE(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}_E.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:OE(this,this._t0,kE(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,OE(this,kE(this,n=wE(this,t,e)),n);break;default:OE(this,this._t0,n=wE(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(AE.prototype=Object.create(_E.prototype)).point=function(t,e){_E.prototype.point.call(this,e,t)},CE.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},EE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=SE(t),i=SE(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function jE(t,e){this._context=t,this._t=e}jE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var NE={basis:{curve:function(t){return new zC(t)}},"basis-closed":{curve:function(t){return new PC(t)}},"basis-open":{curve:function(t){return new qC(t)}},bundle:{curve:UC,tension:"beta",value:.85},cardinal:{curve:HC,tension:"tension",value:0},"cardinal-open":{curve:KC,tension:"tension",value:0},"cardinal-closed":{curve:JC,tension:"tension",value:0},"catmull-rom":{curve:fE,tension:"alpha",value:.5},"catmull-rom-closed":{curve:pE,tension:"alpha",value:.5},"catmull-rom-open":{curve:gE,tension:"alpha",value:.5},linear:{curve:yE},"linear-closed":{curve:function(t){return new vE(t)}},monotone:{horizontal:function(t){return new AE(t)},vertical:function(t){return new _E(t)}},natural:{curve:function(t){return new EE(t)}},step:{curve:function(t){return new jE(t,.5)}},"step-after":{curve:function(t){return new jE(t,1)}},"step-before":{curve:function(t){return new jE(t,0)}}};function TE(t,e,n){var r=ce(NE,t)&&NE[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}var FE={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},DE=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/],IE=function(t){var e,n,r,i,a,o,s,u,c,l,d,f=[];for(u=0,l=(e=t.slice().replace(DE[0],"###$1").split(DE[1]).slice(1)).length;u<l;++u){for(r=(n=e[u]).slice(1).trim().replace(DE[2],"$1###$2").split(DE[3]),i=[o=n.charAt(0)],c=0,d=r.length;c<d;++c)(a=+r[c])===a&&i.push(a);if(s=FE[o.toLowerCase()],i.length-1>s)for(c=1,d=i.length;c<d;c+=s)f.push([o].concat(i.slice(c,c+s)));else f.push(i)}return f};const ME=Math.PI/180,$E=Math.PI/2,RE=2*Math.PI,BE=Math.sqrt(3)/2;var zE={},LE={},PE=[].join;function qE(t){var e=PE.call(t);if(LE[e])return LE[e];var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=c*o,d=-u*s,f=u*o,h=c*s,p=Math.cos(i),m=Math.sin(i),g=Math.cos(a),b=Math.sin(a),y=.5*(a-i),v=Math.sin(.5*y),x=8/3*v*v/Math.sin(y),w=n+p-x*m,k=r+m+x*p,O=n+g,_=r+b,A=O+x*b,C=_-x*g;return LE[e]=[l*w+d*k,f*w+h*k,l*A+d*C,f*A+h*C,l*O+d*_,f*O+h*_]}var WE=["l",0,0,0,0,0,0,0];function UE(t,e,n){var r=WE[0]=t[0];if("a"===r||"A"===r)WE[1]=e*t[1],WE[2]=n*t[2],WE[3]=t[3],WE[4]=t[4],WE[5]=t[5],WE[6]=e*t[6],WE[7]=n*t[7];else if("h"===r||"H"===r)WE[1]=e*t[1];else if("v"===r||"V"===r)WE[1]=n*t[1];else for(var i=1,a=t.length;i<a;++i)WE[i]=(i%2==1?e:n)*t[i];return WE}var VE=function(t,e,n,r,i,a){var o,s,u,c,l,d=null,f=0,h=0,p=0,m=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==a&&(a=i),t.beginPath&&t.beginPath();for(var g=0,b=e.length;g<b;++g){switch(o=e[g],1===i&&1===a||(o=UE(o,i,a)),o[0]){case"l":f+=o[1],h+=o[2],t.lineTo(f+n,h+r);break;case"L":f=o[1],h=o[2],t.lineTo(f+n,h+r);break;case"h":f+=o[1],t.lineTo(f+n,h+r);break;case"H":f=o[1],t.lineTo(f+n,h+r);break;case"v":h+=o[1],t.lineTo(f+n,h+r);break;case"V":h=o[1],t.lineTo(f+n,h+r);break;case"m":f+=o[1],h+=o[2],t.moveTo(f+n,h+r);break;case"M":f=o[1],h=o[2],t.moveTo(f+n,h+r);break;case"c":s=f+o[5],u=h+o[6],p=f+o[3],m=h+o[4],t.bezierCurveTo(f+o[1]+n,h+o[2]+r,p+n,m+r,s+n,u+r),f=s,h=u;break;case"C":f=o[5],h=o[6],p=o[3],m=o[4],t.bezierCurveTo(o[1]+n,o[2]+r,p+n,m+r,f+n,h+r);break;case"s":s=f+o[3],u=h+o[4],p=2*f-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,f+o[1]+n,h+o[2]+r,s+n,u+r),p=f+o[1],m=h+o[2],f=s,h=u;break;case"S":s=o[3],u=o[4],p=2*f-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,o[1]+n,o[2]+r,s+n,u+r),f=s,h=u,p=o[1],m=o[2];break;case"q":s=f+o[3],u=h+o[4],p=f+o[1],m=h+o[2],t.quadraticCurveTo(p+n,m+r,s+n,u+r),f=s,h=u;break;case"Q":s=o[3],u=o[4],t.quadraticCurveTo(o[1]+n,o[2]+r,s+n,u+r),f=s,h=u,p=o[1],m=o[2];break;case"t":s=f+o[1],u=h+o[2],null===d[0].match(/[QqTt]/)?(p=f,m=h):"t"===d[0]?(p=2*f-c,m=2*h-l):"q"===d[0]&&(p=2*f-p,m=2*h-m),c=p,l=m,t.quadraticCurveTo(p+n,m+r,s+n,u+r),h=u,p=(f=s)+o[1],m=h+o[2];break;case"T":s=o[1],u=o[2],p=2*f-p,m=2*h-m,t.quadraticCurveTo(p+n,m+r,s+n,u+r),f=s,h=u;break;case"a":GE(t,f+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+f+n,o[7]+h+r]),f+=o[6],h+=o[7];break;case"A":GE(t,f+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),f=o[6],h=o[7];break;case"z":case"Z":t.closePath()}d=o}};function GE(t,e,n,r){for(var i=function(t,e,n,r,i,a,o,s,u){var c=PE.call(arguments);if(zE[c])return zE[c];var l=o*ME,d=Math.sin(l),f=Math.cos(l),h=f*(s-t)*.5+d*(u-e)*.5,p=f*(u-e)*.5-d*(s-t)*.5,m=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(n*=m=Math.sqrt(m),r*=m);var g=f/n,b=d/n,y=-d/r,v=f/r,x=g*s+b*u,w=y*s+v*u,k=g*t+b*e,O=y*t+v*e,_=(k-x)*(k-x)+(O-w)*(O-w),A=1/_-.25;A<0&&(A=0);var C=Math.sqrt(A);a==i&&(C=-C);var E=.5*(x+k)-C*(O-w),S=.5*(w+O)+C*(k-x),j=Math.atan2(w-S,x-E),N=Math.atan2(O-S,k-E),T=N-j;T<0&&1===a?T+=RE:T>0&&0===a&&(T-=RE);for(var F=Math.ceil(Math.abs(T/($E+.001))),D=[],I=0;I<F;++I){var M=j+I*T/F,$=j+(I+1)*T/F;D[I]=[E,S,M,$,n,r,d,f]}return zE[c]=D}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n),a=0;a<i.length;++a){var o=qE(i[a]);t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var HE={circle:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,RE)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,a=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-a),t.lineTo(i,-a),t.lineTo(0,-n),t.lineTo(-i,-a),t.lineTo(-r,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=BE*n,i=r-.5773502691896257*n,a=n/4;t.moveTo(0,-r-i),t.lineTo(-a,r-i),t.lineTo(a,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=BE*n,i=r-.5773502691896257*n;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=BE*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=BE*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=BE*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=BE*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function XE(t){return ce(HE,t)?HE[t]:function(t){if(!ce(KE,t)){var e=IE(t);KE[t]={draw:function(t,n){VE(t,e,0,0,Math.sqrt(n)/2)}}}return KE[t]}(t)}var KE={};var YE=Math.PI,JE=2*YE,ZE=JE-1e-6;function QE(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function tS(){return new QE}QE.prototype=tS.prototype={constructor:QE,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-t,u=r-e,c=a-t,l=o-e,d=c*c+l*l;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(d>1e-6)if(Math.abs(l*s-u*c)>1e-6&&i){var f=n-a,h=r-o,p=s*s+u*u,m=f*f+h*h,g=Math.sqrt(p),b=Math.sqrt(d),y=i*Math.tan((YE-Math.acos((p+d-m)/(2*g*b)))/2),v=y/b,x=y/g;Math.abs(v-1)>1e-6&&(this._+="L"+(t+v*c)+","+(e+v*l)),this._+="A"+i+","+i+",0,0,"+ +(l*f>c*h)+","+(this._x1=t+x*s)+","+(this._y1=e+x*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,a){t=+t,e=+e,a=!!a;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),u=t+o,c=e+s,l=1^a,d=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+c:(Math.abs(this._x1-u)>1e-6||Math.abs(this._y1-c)>1e-6)&&(this._+="L"+u+","+c),n&&(d<0&&(d=d%JE+JE),d>ZE?this._+="A"+n+","+n+",0,1,"+l+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+l+","+(this._x1=u)+","+(this._y1=c):d>1e-6&&(this._+="A"+n+","+n+",0,"+ +(d>=YE)+","+l+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var eS=tS;function nS(t){return t.x}function rS(t){return t.y}function iS(t){return t.width}function aS(t){return t.height}function oS(t){return"function"==typeof t?t:()=>+t}function sS(t,e,n){return Math.max(e,Math.min(t,n))}var uS=function(){var t=nS,e=rS,n=iS,r=aS,i=oS(0),a=i,o=i,s=i,u=null;function c(c,l,d){var f,h=null!=l?l:+t.call(this,c),p=null!=d?d:+e.call(this,c),m=+n.call(this,c),g=+r.call(this,c),b=Math.min(m,g)/2,y=sS(+i.call(this,c),0,b),v=sS(+a.call(this,c),0,b),x=sS(+o.call(this,c),0,b),w=sS(+s.call(this,c),0,b);if(u||(u=f=eS()),y<=0&&v<=0&&x<=0&&w<=0)u.rect(h,p,m,g);else{var k=h+m,O=p+g;u.moveTo(h+y,p),u.lineTo(k-v,p),u.bezierCurveTo(k-.448084975506*v,p,k,p+.448084975506*v,k,p+v),u.lineTo(k,O-w),u.bezierCurveTo(k,O-.448084975506*w,k-.448084975506*w,O,k-w,O),u.lineTo(h+x,O),u.bezierCurveTo(h+.448084975506*x,O,h,O-.448084975506*x,h,O-x),u.lineTo(h,p+y),u.bezierCurveTo(h,p+.448084975506*y,h+.448084975506*y,p,h+y,p),u.closePath()}if(f)return u=null,f+""||null}return c.x=function(e){return arguments.length?(t=oS(e),c):t},c.y=function(t){return arguments.length?(e=oS(t),c):e},c.width=function(t){return arguments.length?(n=oS(t),c):n},c.height=function(t){return arguments.length?(r=oS(t),c):r},c.cornerRadius=function(t,e,n,r){return arguments.length?(i=oS(t),a=null!=e?oS(e):i,s=null!=n?oS(n):i,o=null!=r?oS(r):a,c):i},c.context=function(t){return arguments.length?(u=null==t?null:t,c):u},c},cS=function(){var t,e,n,r,i,a,o,s,u=null;function c(t,e,n){var r=n/2;if(i){var c=o-e,l=t-a;if(c||l){var d=Math.sqrt(c*c+l*l),f=(c/=d)*s,h=(l/=d)*s,p=Math.atan2(l,c);u.moveTo(a-f,o-h),u.lineTo(t-c*r,e-l*r),u.arc(t,e,r,p-Math.PI,p),u.lineTo(a+f,o+h),u.arc(a,o,s,p,p+Math.PI)}else u.arc(t,e,r,0,RE);u.closePath()}else i=1;a=t,o=e,s=r}function l(a){var o,s,l,d=a.length,f=!1;for(null==u&&(u=l=eS()),o=0;o<=d;++o)!(o<d&&r(s=a[o],o,a))===f&&(f=!f)&&(i=0),f&&c(+t(s,o,a),+e(s,o,a),+n(s,o,a));if(l)return u=null,l+""||null}return l.x=function(e){return arguments.length?(t=e,l):t},l.y=function(t){return arguments.length?(e=t,l):e},l.size=function(t){return arguments.length?(n=t,l):n},l.defined=function(t){return arguments.length?(r=t,l):r},l.context=function(t){return arguments.length?(u=null==t?null:t,l):u},l},lS=function(t){return function(){return t}};function dS(t){return t.innerRadius}function fS(t){return t.outerRadius}function hS(t){return t.startAngle}function pS(t){return t.endAngle}function mS(t){return t&&t.padAngle}function gS(t,e,n,r,i,a,o,s){var u=n-t,c=r-e,l=o-i,d=s-a,f=d*u-l*c;if(!(f*f<1e-12))return[t+(f=(l*(e-a)-d*(t-i))/f)*u,e+f*c]}function bS(t,e,n,r,i,a,o){var s=t-n,u=e-r,c=(o?a:-a)/iE(s*s+u*u),l=c*u,d=-c*s,f=t+l,h=e+d,p=n+l,m=r+d,g=(f+p)/2,b=(h+m)/2,y=p-f,v=m-h,x=y*y+v*v,w=i-a,k=f*m-p*h,O=(v<0?-1:1)*iE(eE(0,w*w*x-k*k)),_=(k*v-y*O)/x,A=(-k*y-v*O)/x,C=(k*v+y*O)/x,E=(-k*y+v*O)/x,S=_-g,j=A-b,N=C-g,T=E-b;return S*S+j*j>N*N+T*T&&(_=C,A=E),{cx:_,cy:A,x01:-l,y01:-d,x11:_*(i/w-1),y11:A*(i/w-1)}}function yS(t){return t[0]}function vS(t){return t[1]}var xS=function(){var t=yS,e=vS,n=lS(!0),r=null,i=yE,a=null;function o(o){var s,u,c,l=o.length,d=!1;for(null==r&&(a=i(c=eS())),s=0;s<=l;++s)!(s<l&&n(u=o[s],s,o))===d&&((d=!d)?a.lineStart():a.lineEnd()),d&&a.point(+t(u,s,o),+e(u,s,o));if(c)return a=null,c+""||null}return o.x=function(e){return arguments.length?(t="function"==typeof e?e:lS(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:lS(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:lS(!!t),o):n},o.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),o):i},o.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),o):r},o},wS=function(){var t=yS,e=null,n=lS(0),r=vS,i=lS(!0),a=null,o=yE,s=null;function u(u){var c,l,d,f,h,p=u.length,m=!1,g=new Array(p),b=new Array(p);for(null==a&&(s=o(h=eS())),c=0;c<=p;++c){if(!(c<p&&i(f=u[c],c,u))===m)if(m=!m)l=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=c-1;d>=l;--d)s.point(g[d],b[d]);s.lineEnd(),s.areaEnd()}m&&(g[c]=+t(f,c,u),b[c]=+n(f,c,u),s.point(e?+e(f,c,u):g[c],r?+r(f,c,u):b[c]))}if(h)return s=null,h+""||null}function c(){return xS().defined(i).curve(o).context(a)}return u.x=function(n){return arguments.length?(t="function"==typeof n?n:lS(+n),e=null,u):t},u.x0=function(e){return arguments.length?(t="function"==typeof e?e:lS(+e),u):t},u.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:lS(+t),u):e},u.y=function(t){return arguments.length?(n="function"==typeof t?t:lS(+t),r=null,u):n},u.y0=function(t){return arguments.length?(n="function"==typeof t?t:lS(+t),u):n},u.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:lS(+t),u):r},u.lineX0=u.lineY0=function(){return c().x(t).y(n)},u.lineY1=function(){return c().x(t).y(r)},u.lineX1=function(){return c().x(e).y(n)},u.defined=function(t){return arguments.length?(i="function"==typeof t?t:lS(!!t),u):i},u.curve=function(t){return arguments.length?(o=t,null!=a&&(s=o(a)),u):o},u.context=function(t){return arguments.length?(null==t?a=s=null:s=o(a=t),u):a},u},kS={draw:function(t,e){var n=Math.sqrt(e/aE);t.moveTo(n,0),t.arc(0,0,n,0,sE)}},OS=(Math.sqrt(1/3),Math.sin(aE/10)/Math.sin(7*aE/10));Math.sin(sE/10),Math.cos(sE/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12);function _S(t,e){return null!=t?t:e}const AS=t=>t.x||0,CS=t=>t.y||0,ES=t=>!(!1===t.defined),SS=function(){var t=dS,e=fS,n=lS(0),r=null,i=hS,a=pS,o=mS,s=null;function u(){var u,c,l=+t.apply(this,arguments),d=+e.apply(this,arguments),f=i.apply(this,arguments)-oE,h=a.apply(this,arguments)-oE,p=ZC(h-f),m=h>f;if(s||(s=u=eS()),d<l&&(c=d,d=l,l=c),d>1e-12)if(p>sE-1e-12)s.moveTo(d*tE(f),d*rE(f)),s.arc(0,0,d,f,h,!m),l>1e-12&&(s.moveTo(l*tE(h),l*rE(h)),s.arc(0,0,l,h,f,m));else{var g,b,y=f,v=h,x=f,w=h,k=p,O=p,_=o.apply(this,arguments)/2,A=_>1e-12&&(r?+r.apply(this,arguments):iE(l*l+d*d)),C=nE(ZC(d-l)/2,+n.apply(this,arguments)),E=C,S=C;if(A>1e-12){var j=cE(A/l*rE(_)),N=cE(A/d*rE(_));(k-=2*j)>1e-12?(x+=j*=m?1:-1,w-=j):(k=0,x=w=(f+h)/2),(O-=2*N)>1e-12?(y+=N*=m?1:-1,v-=N):(O=0,y=v=(f+h)/2)}var T=d*tE(y),F=d*rE(y),D=l*tE(w),I=l*rE(w);if(C>1e-12){var M,$=d*tE(v),R=d*rE(v),B=l*tE(x),z=l*rE(x);if(p<aE&&(M=gS(T,F,B,z,$,R,D,I))){var L=T-M[0],P=F-M[1],q=$-M[0],W=R-M[1],U=1/rE(uE((L*q+P*W)/(iE(L*L+P*P)*iE(q*q+W*W)))/2),V=iE(M[0]*M[0]+M[1]*M[1]);E=nE(C,(l-V)/(U-1)),S=nE(C,(d-V)/(U+1))}}O>1e-12?S>1e-12?(g=bS(B,z,T,F,d,S,m),b=bS($,R,D,I,d,S,m),s.moveTo(g.cx+g.x01,g.cy+g.y01),S<C?s.arc(g.cx,g.cy,S,QC(g.y01,g.x01),QC(b.y01,b.x01),!m):(s.arc(g.cx,g.cy,S,QC(g.y01,g.x01),QC(g.y11,g.x11),!m),s.arc(0,0,d,QC(g.cy+g.y11,g.cx+g.x11),QC(b.cy+b.y11,b.cx+b.x11),!m),s.arc(b.cx,b.cy,S,QC(b.y11,b.x11),QC(b.y01,b.x01),!m))):(s.moveTo(T,F),s.arc(0,0,d,y,v,!m)):s.moveTo(T,F),l>1e-12&&k>1e-12?E>1e-12?(g=bS(D,I,$,R,l,-E,m),b=bS(T,F,B,z,l,-E,m),s.lineTo(g.cx+g.x01,g.cy+g.y01),E<C?s.arc(g.cx,g.cy,E,QC(g.y01,g.x01),QC(b.y01,b.x01),!m):(s.arc(g.cx,g.cy,E,QC(g.y01,g.x01),QC(g.y11,g.x11),!m),s.arc(0,0,l,QC(g.cy+g.y11,g.cx+g.x11),QC(b.cy+b.y11,b.cx+b.x11),m),s.arc(b.cx,b.cy,E,QC(b.y11,b.x11),QC(b.y01,b.x01),!m))):s.arc(0,0,l,w,x,m):s.lineTo(D,I)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-aE/2;return[tE(r)*n,rE(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:lS(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:lS(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:lS(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:lS(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:lS(+t),u):i},u.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:lS(+t),u):a},u.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:lS(+t),u):o},u.context=function(t){return arguments.length?(s=null==t?null:t,u):s},u}().startAngle(t=>t.startAngle||0).endAngle(t=>t.endAngle||0).padAngle(t=>t.padAngle||0).innerRadius(t=>t.innerRadius||0).outerRadius(t=>t.outerRadius||0).cornerRadius(t=>t.cornerRadius||0),jS=wS().x(AS).y1(CS).y0(t=>(t.y||0)+(t.height||0)).defined(ES),NS=wS().y(CS).x1(AS).x0(t=>(t.x||0)+(t.width||0)).defined(ES),TS=xS().x(AS).y(CS).defined(ES),FS=uS().x(AS).y(CS).width(t=>t.width||0).height(t=>t.height||0).cornerRadius(t=>_S(t.cornerRadiusTopLeft,t.cornerRadius)||0,t=>_S(t.cornerRadiusTopRight,t.cornerRadius)||0,t=>_S(t.cornerRadiusBottomRight,t.cornerRadius)||0,t=>_S(t.cornerRadiusBottomLeft,t.cornerRadius)||0),DS=function(){var t=lS(kS),e=lS(64),n=null;function r(){var r;if(n||(n=r=eS()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return r.type=function(e){return arguments.length?(t="function"==typeof e?e:lS(e),r):t},r.size=function(t){return arguments.length?(e="function"==typeof t?t:lS(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r}().type(t=>XE(t.shape||"circle")).size(t=>_S(t.size,64)),IS=cS().x(AS).y(CS).defined(ES).size(t=>t.size||1);function MS(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function $S(t,e,n,r){return FS.context(t)(e,n,r)}var RS=1;function BS(){RS=1}var zS=function(t,e,n){var r=e.clip,i=t._defs,a=e.clip_id||(e.clip_id="clip"+RS++),o=i.clipping[a]||(i.clipping[a]={id:a});return Jt(r)?o.path=r(null):MS(n)?o.path=$S(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"};function LS(t){this.clear(),t&&this.union(t)}var PS=LS.prototype;function qS(t){this.mark=t,this.bounds=this.bounds||new LS}function WS(t){qS.call(this,t),this.items=this.items||[]}function US(t){this._pending=0,this._loader=t||Object(en.e)()}PS.clone=function(){return new LS(this)},PS.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},PS.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},PS.equals=function(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},PS.set=function(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},PS.add=function(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},PS.expand=function(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},PS.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},PS.scale=function(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},PS.translate=function(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},PS.rotate=function(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},PS.rotatedPoints=function(t,e,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(t),u=Math.sin(t),c=e-e*s+n*u,l=n-e*u-n*s;return[s*r-u*i+c,u*r+s*i+l,s*r-u*o+c,u*r+s*o+l,s*a-u*i+c,u*a+s*i+l,s*a-u*o+c,u*a+s*o+l]},PS.union=function(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},PS.intersect=function(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},PS.encloses=function(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},PS.alignsWith=function(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},PS.intersects=function(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},PS.contains=function(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},PS.width=function(){return this.x2-this.x1},PS.height=function(){return this.y2-this.y1},he(WS,qS);var VS=US.prototype;function GS(t){t._pending+=1}function HS(t){t._pending-=1}VS.pending=function(){return this._pending},VS.sanitizeURL=function(t){var e=this;return GS(e),e._loader.sanitize(t,{context:"href"}).then((function(t){return HS(e),t})).catch((function(){return HS(e),null}))},VS.loadImage=function(t){const e=this,n=Ws();return GS(e),e._loader.sanitize(t,{context:"image"}).then((function(t){const r=t.href;if(!r||!n)throw{url:r};const i=new n,a=ce(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=a&&(i.crossOrigin=a),i.onload=()=>HS(e),i.onerror=()=>HS(e),i.src=r,i})).catch((function(t){return HS(e),{complete:!1,width:0,height:0,src:t&&t.url||""}}))},VS.ready=function(){var t=this;return new Promise((function(e){!function n(r){t.pending()?setTimeout((function(){n(!0)}),10):e(r)}(!1)}))};var XS=function(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t};var KS,YS,JS,ZS=RE-1e-8;function QS(t){return KS=t,QS}function tj(){}function ej(t,e){KS.add(t,e)}function nj(t,e){ej(YS=t,JS=e)}function rj(t){ej(t,KS.y1)}function ij(t){ej(KS.x1,t)}function aj(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function oj(t,e,n,r,i){const a=r-t+3*e-3*n,o=t+n-2*e,s=t-e;let u,c=0,l=0;Math.abs(a)>1e-14?(u=o*o+s*a,u>=0&&(u=Math.sqrt(u),c=(-o+u)/a,l=(-o-u)/a)):c=.5*s/o,0<c&&c<1&&i(sj(c,t,e,n,r)),0<l&&l<1&&i(sj(l,t,e,n,r))}function sj(t,e,n,r,i){const a=1-t,o=a*a,s=t*t;return o*a*e+3*o*t*n+3*a*s*r+s*t*i}QS.beginPath=tj,QS.closePath=tj,QS.moveTo=nj,QS.lineTo=nj,QS.rect=function(t,e,n,r){ej(t+n,e+r),nj(t,e)},QS.quadraticCurveTo=function(t,e,n,r){aj(YS,t,n,rj),aj(JS,e,r,ij),nj(n,r)},QS.bezierCurveTo=function(t,e,n,r,i,a){oj(YS,t,n,i,rj),oj(JS,e,r,a,ij),nj(i,a)},QS.arc=function(t,e,n,r,i,a){if(YS=n*Math.cos(i)+t,JS=n*Math.sin(i)+e,Math.abs(i-r)>ZS)ej(t-n,e-n),ej(t+n,e+n);else{const o=r=>ej(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,u;if(o(r),o(i),i!==r)if((r%=RE)<0&&(r+=RE),(i%=RE)<0&&(i+=RE),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=RE,s=r-r%$E,u=0;u<4&&s>i;++u,s-=$E)o(s);else for(s=r-r%$E+$E,u=0;u<4&&s<i;++u,s+=$E)o(s)}};var uj=(uj=qs(1,1))?uj.getContext("2d"):null;const cj=new LS;function lj(t){return function(e,n){if(!uj)return!0;t(uj,e),cj.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=cj;for(let t=i;t<=o;++t)for(let e=r;e<=a;++e)if(uj.isPointInPath(e,t))return!0;return!1}}function dj(t,e){return e.contains(t.x||0,t.y||0)}function fj(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,a=t.height||0;return e.intersects(cj.set(n,r,n+i,r+a))}function hj(t,e){const n=t.x||0,r=t.y||0;return pj(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}function pj(t,e,n,r,i){const{x1:a,y1:o,x2:s,y2:u}=t,c=r-e,l=i-n;let d,f,h,p,m=0,g=1;for(p=0;p<4;++p){if(0===p&&(d=-c,f=-(a-e)),1===p&&(d=c,f=s-e),2===p&&(d=-l,f=-(o-n)),3===p&&(d=l,f=u-n),Math.abs(d)<1e-10&&f<0)return!1;if(h=f/d,d<0){if(h>g)return!1;h>m&&(m=h)}else if(d>0){if(h<m)return!1;h<g&&(g=h)}}return!0}var mj=function(t,e){t.globalCompositeOperation=e.blend||"source-over"},gj=function(t,e){return null==t?e:t};function bj(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}var yj=function(t,e,n){return IC(n)?function(t,e,n){const r=n.width(),i=n.height();let a;if("radial"===e.gradient)a=t.createRadialGradient(n.x1+gj(e.x1,.5)*r,n.y1+gj(e.y1,.5)*i,Math.max(r,i)*gj(e.r1,0),n.x1+gj(e.x2,.5)*r,n.y1+gj(e.y2,.5)*i,Math.max(r,i)*gj(e.r2,.5));else{const o=gj(e.x1,0),s=gj(e.y1,0),u=gj(e.x2,1),c=gj(e.y2,0);if(o!==u&&s!==c&&r!==i){const n=qs(Math.ceil(r),Math.ceil(i)),a=n.getContext("2d");return a.scale(r,i),a.fillStyle=bj(a.createLinearGradient(o,s,u,c),e.stops),a.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}a=t.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+u*r,n.y1+c*i)}return bj(a,e.stops)}(t,n,e.bounds):n},vj=function(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=yj(t,e,e.fill),!0)},xj=[],wj=function(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&((n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=yj(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||xj),t.lineDashOffset=e.strokeDashOffset||0),!0))};function kj(t,e){return t.zindex-e.zindex||t.index-e.index}function Oj(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,a=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&a.push(e);return t.zdirty=!1,t.zitems=a.sort(kj)}function _j(t,e){var n,r,i=t.items;if(i&&i.length){var a=Oj(t);if(a&&a.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=a}for(n=0,r=i.length;n<r;++n)e(i[n])}}function Aj(t,e){var n,r,i=t.items;if(!i||!i.length)return null;var a=Oj(t);for(a&&a.length&&(i=a),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===a)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function Cj(t){return function(e,n,r){_j(n,(function(n){r&&!r.intersects(n.bounds)||Ej(t,e,n,n)}))}}function Ej(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(mj(e,n),n.fill&&vj(e,n,i)&&e.fill(),n.stroke&&wj(e,n,i)&&e.stroke()))}function Sj(t){return t=t||mt,function(e,n,r,i,a,o){return r*=e.pixelRatio,i*=e.pixelRatio,Aj(n,(function(n){var s=n.bounds;if((!s||s.contains(a,o))&&s)return t(e,n,r,i,a,o)?n:void 0}))}}function jj(t,e){return function(n,r,i,a){var o,s,u=Array.isArray(r)?r[0]:r,c=null==e?u.fill:e,l=u.stroke&&n.isPointInStroke;return l&&(o=u.strokeWidth,s=u.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(c&&n.isPointInPath(i,a)||l&&n.isPointInStroke(i,a))}}function Nj(t){return Sj(jj(t))}function Tj(t,e){return"translate("+t+","+e+")"}function Fj(t){return"rotate("+t+")"}function Dj(t){return Tj(t.x||0,t.y||0)}function Ij(t){return Tj(t.x||0,t.y||0)+(t.angle?" "+Fj(t.angle):"")+(t.scaleX||t.scaleY?" "+(e=t.scaleX||1,n=t.scaleY||1,"scale("+e+","+n+")"):"");var e,n}var Mj=function(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,a=n.angle||0;t.translate(r,i),a&&t.rotate(a*=ME),t.beginPath(),e(t,n),a&&t.rotate(-a),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",Ij(n)),t("d",e(null,n))},bound:function(t,n){var r=n.x||0,i=n.y||0;return e(QS(t),n),XS(t,n).translate(r,i),n.angle&&t.rotate(n.angle*ME,r,i),t},draw:Cj(r),pick:Nj(r),isect:n||lj(r)}},$j=Mj("arc",(function(t,e){return SS.context(t)(e)}));var Rj=function(t,e,n){function r(t,n){t.beginPath(),e(t,n)}var i,a=jj(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(QS(t),r),XS(t,r[0]))},draw:(i=r,function(t,e,n){!e.items.length||n&&!n.intersects(e.bounds)||Ej(i,t,e.items[0],e.items)}),pick:function(t,e,n,r,i,o){var s=e.items,u=e.bounds;return!s||!s.length||u&&!u.contains(i,o)?null:(n*=t.pixelRatio,r*=t.pixelRatio,a(t,s,n,r)?s[0]:null)},isect:dj,tip:n}},Bj=Rj("area",(function(t,e){var n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?NS:jS).curve(TE(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],a="horizontal"===t[0].orient?"y":"x",o=t.length,s=1/0;--o>=0;)!1!==t[o].defined&&(r=Math.abs(t[o][a]-i))<s&&(s=r,n=t[o]);return n}));function zj(t,e){t.beginPath(),MS(e)?$S(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function Lj(t){const e=gj(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function Pj(t,e){const n=Lj(e);t("d",$S(null,e,n,n))}function qj(t,e,n,r){const i=Lj(e);t.beginPath(),$S(t,e,(n||0)+i,(r||0)+i)}const Wj=jj(qj),Uj=jj(qj,!1);var Vj={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",Dj(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),XS(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){_j(e,e=>{const r=e.x||0,i=e.y||0,a=e.strokeForeground,o=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&o&&(qj(t,e,r,i),mj(t,e),e.fill&&vj(t,e,o)&&t.fill(),e.stroke&&!a&&wj(t,e,o)&&t.stroke()),t.save(),t.translate(r,i),e.clip&&zj(t,e),n&&n.translate(-r,-i),_j(e,e=>{this.draw(t,e,n)}),n&&n.translate(r,i),t.restore(),a&&e.stroke&&o&&(qj(t,e,r,i),mj(t,e),wj(t,e,o)&&t.stroke())})},pick:function(t,e,n,r,i,a){if(e.bounds&&!e.bounds.contains(i,a)||!e.items)return null;const o=n*t.pixelRatio,s=r*t.pixelRatio;return Aj(e,u=>{let c,l,d,f,h,p,m,g,b;if(g=u.bounds,(!g||g.contains(i,a))&&(f=u.x||0,h=u.y||0,p=f+(u.width||0),m=h+(u.height||0),b=u.clip,!b||!(i<f||i>p||a<h||a>m)))return t.save(),t.translate(f,h),f=i-f,h=a-h,b&&MS(u)&&!Wj(t,u,o,s)?(t.restore(),null):(l=u.strokeForeground,d=!1!==e.interactive,d&&l&&u.stroke&&Uj(t,u,o,s)?(t.restore(),u):(c=Aj(u,t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,f,h)?this.pick(t,n,r,f,h):null),!c&&d&&(u.fill||!l&&u.stroke)&&Wj(t,u,o,s)&&(c=u),t.restore(),c||null))})},isect:fj,content:function(t,e,n){t("clip-path",e.clip?zS(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),Pj(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?Pj(t,e):t("d","")}},Gj={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"};function Hj(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(e=>{t.image=e,t.image.url=t.url})),n}function Xj(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function Kj(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function Yj(t,e){return"center"===t?e/2:"right"===t?e:0}function Jj(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var Zj={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=Hj(e,n),i=Xj(e,r),a=Kj(e,r),o=(e.x||0)-Yj(e.align,i),s=(e.y||0)-Jj(e.baseline,a);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",Gj["xmlns:xlink"],"xlink:href"),t("transform",Tj(o,s)),t("width",i),t("height",a),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=Xj(e,n),i=Kj(e,n),a=(e.x||0)-Yj(e.align,r),o=(e.y||0)-Jj(e.baseline,i);return t.set(a,o,a+r,o+i)},draw:function(t,e,n){_j(e,e=>{if(n&&!n.intersects(e.bounds))return;let r,i,a,o,s=Hj(e,this),u=Xj(e,s),c=Kj(e,s),l=(e.x||0)-Yj(e.align,u),d=(e.y||0)-Jj(e.baseline,c);!1!==e.aspect&&(i=s.width/s.height,a=e.width/e.height,i==i&&a==a&&i!==a&&(a<i?(o=u/i,d+=(c-o)/2,c=o):(o=c*i,l+=(u-o)/2,u=o))),(s.complete||s.toDataURL)&&(mj(t,e),t.globalAlpha=null!=(r=e.opacity)?r:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(s,l,d,u,c))})},pick:Sj(),isect:mt,get:Hj,xOffset:Yj,yOffset:Jj},Qj=Rj("line",(function(t,e){var n=e[0],r=n.interpolate||"linear";return TS.curve(TE(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),a=t.length;--a>=0;)if(!1!==t[a].defined&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<i)return t[a];return null}));function tN(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,a=e.scaleX||1,o=e.scaleY||1,s=(e.angle||0)*ME,u=e.pathCache;u&&u.path===n||((e.pathCache=u=IE(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),VE(t,u,0,0,a,o),t.rotate(-s),t.translate(-r,-i)):VE(t,u,r,i,a,o)}var eN={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",Ij(e)),t("d",e.path)},bound:function(t,e){return tN(QS(t),e)?t.set(0,0,0,0):XS(t,e,!0),e.angle&&t.rotate(e.angle*ME,e.x||0,e.y||0),t},draw:Cj(tN),pick:Nj(tN),isect:lj(tN)};function nN(t,e){t.beginPath(),$S(t,e)}var rN={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",$S(null,e))},bound:function(t,e){var n,r;return XS(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:Cj(nN),pick:Nj(nN),isect:fj};function iN(t,e,n){var r,i,a,o;return!(!e.stroke||!wj(t,e,n))&&(r=e.x||0,i=e.y||0,a=null!=e.x2?e.x2:r,o=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),!0)}var aN={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",Dj(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return XS(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){_j(e,(function(e){if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&iN(t,e,r)&&(mj(t,e),t.stroke())}}))},pick:Sj((function(t,e,n,r){return!!t.isPointInStroke&&(iN(t,e,1)&&t.isPointInStroke(n,r))})),isect:hj},oN=Mj("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),sN=Mj("symbol",(function(t,e){return DS.context(t)(e)}),dj);const uN=ke();var cN={height:mN,measureWidth:hN,estimateWidth:dN,width:dN,canvas:lN};function lN(t){cN.width=t&&uj?hN:dN}function dN(t,e){return fN(vN(t,e),mN(t))}function fN(t,e){return~~(.8*t.length*e)}function hN(t,e){return mN(t)<=0||!(e=vN(t,e))?0:pN(e,wN(t))}function pN(t,e){const n=`(${e}) ${t}`;let r=uN.get(n);return void 0===r&&(uj.font=e,r=uj.measureText(t).width,uN.set(n,r)),r}function mN(t){return null!=t.fontSize?+t.fontSize||0:11}function gN(t){return null!=t.lineHeight?t.lineHeight:mN(t)+2}function bN(t){return e=t.lineBreak&&t.text&&!_t(t.text)?t.text.split(t.lineBreak):t.text,_t(e)?e.length>1?e:e[0]:e;var e}function yN(t){const e=bN(t);return(_t(e)?e.length-1:0)*gN(t)}function vN(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(cN.width===hN){const e=wN(t);return t=>pN(t,e)}{const e=mN(t);return t=>fN(t,e)}}(t);if(r(e)<n)return e;var i,a=t.ellipsis||"",o="rtl"===t.dir,s=0,u=e.length;if(n-=r(a),o){for(;s<u;)i=s+u>>>1,r(e.slice(i))>n?s=i+1:u=i;return a+e.slice(s)}for(;s<u;)i=1+(s+u>>>1),r(e.slice(0,i))<n?s=i:u=i-1;return e.slice(0,s)+a}(t,n):n}function xN(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function wN(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+mN(t)+"px "+xN(t,e)}function kN(t){var e=t.baseline,n=mN(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*gN(t):"line-bottom"===e?.29*n-.5*gN(t):0)}lN(!0);var ON={left:"start",center:"middle",right:"end"},_N=new LS;function AN(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-$E,n+=i*Math.cos(e),r+=i*Math.sin(e)),_N.x1=n,_N.y1=r,_N}function CN(t,e,n){var r,i=cN.height(e),a=e.align,o=AN(e),s=o.x1,u=o.y1,c=e.dx||0,l=(e.dy||0)+kN(e)-Math.round(.8*i),d=bN(e);if(_t(d)?(i+=gN(e)*(d.length-1),r=d.reduce((t,n)=>Math.max(t,cN.width(e,n)),0)):r=cN.width(e,d),"center"===a?c-=r/2:"right"===a&&(c-=r),t.set(c+=s,l+=u,c+r,l+i),e.angle&&!n)t.rotate(e.angle*ME,s,u);else if(2===n)return t.rotatedPoints(e.angle*ME,s,u);return t}var EN={arc:$j,area:Bj,group:Vj,image:Zj,line:Qj,path:eN,rect:rN,rule:aN,shape:oN,symbol:sN,text:{type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+kN(e),a=AN(e),o=a.x1,s=a.y1,u=e.angle||0;t("text-anchor",ON[e.align]||"start"),u?(n=Tj(o,s)+" "+Fj(u),(r||i)&&(n+=" "+Tj(r,i))):n=Tj(o+r,s+i),t("transform",n)},bound:CN,draw:function(t,e,n){_j(e,(function(e){var r,i,a,o,s,u,c,l=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===l||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=wN(e),t.textAlign=e.align||"left",i=(r=AN(e)).x1,a=r.y1,e.angle&&(t.save(),t.translate(i,a),t.rotate(e.angle*ME),i=a=0),i+=e.dx||0,a+=(e.dy||0)+kN(e),u=bN(e),mj(t,e),_t(u))for(s=gN(e),o=0;o<u.length;++o)c=vN(e,u[o]),e.fill&&vj(t,e,l)&&t.fillText(c,i,a),e.stroke&&wj(t,e,l)&&t.strokeText(c,i,a),a+=s;else c=vN(e,u),e.fill&&vj(t,e,l)&&t.fillText(c,i,a),e.stroke&&wj(t,e,l)&&t.strokeText(c,i,a);e.angle&&t.restore()}}))},pick:Sj((function(t,e,n,r,i,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=AN(e),s=o.x1,u=o.y1,c=CN(_N,e,1),l=-e.angle*ME,d=Math.cos(l),f=Math.sin(l),h=d*i-f*a+(s-d*s+f*u),p=f*i+d*a+(u-f*s-d*u);return c.contains(h,p)})),isect:function(t,e){var n=CN(_N,t,2);return pj(e,n[0],n[1],n[2],n[3])||pj(e,n[0],n[1],n[4],n[5])||pj(e,n[4],n[5],n[6],n[7])||pj(e,n[2],n[3],n[6],n[7])}},trail:Rj("trail",(function(t,e){return IS.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null}))},SN=function(t,e,n){var r=EN[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new LS),t,n)},jN={mark:null},NN=function(t,e,n){var r,i,a,o,s=EN[t.marktype],u=s.bound,c=t.items,l=c&&c.length;if(s.nested)return l?a=c[0]:(jN.mark=t,a=jN),o=SN(a,u,n),e=e&&e.union(o)||o;if(e=e||t.bounds&&t.bounds.clear()||new LS,l)for(r=0,i=c.length;r<i;++r)e.union(SN(c[r],u,n));return t.bounds=e},TN=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function FN(t,e){return JSON.stringify(t,TN,e)}function DN(t){return function t(e){var n,r,i,a=e.marktype,o=e.items;if(o)for(r=0,i=o.length;r<i;++r)n=a?"mark":"group",o[r][n]=e,o[r].zindex&&(o[r][n].zdirty=!0),"group"===(a||n)&&t(o[r]);a&&NN(e);return e}("string"==typeof t?JSON.parse(t):t)}function IN(t){arguments.length?this.root=DN(t):(this.root=$N({marktype:"group",name:"root",role:"frame"}),this.root.items=[new WS(this.root)])}var MN=IN.prototype;function $N(t,e){const n={bounds:new LS,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function RN(t,e,n){return!t&&"undefined"!=typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function BN(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function zN(t,e,n,r){var i,a=t.childNodes[e];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(i=a||null,a=RN(t.ownerDocument,n,r),t.insertBefore(a,i)),a}function LN(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function PN(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}MN.toJSON=function(t){return FN(this.root,t||0)},MN.mark=function(t,e,n){var r=$N(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r};var qN=function(t,e){var n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]};function WN(t,e){this._active=null,this._handlers={},this._loader=t||Object(en.e)(),this._tooltip=e||UN}function UN(t,e,n,r){t.element().setAttribute("title",r||"")}const VN=WN.prototype;function GN(t){this._el=null,this._bgcolor=null,this._loader=new US(t)}VN.initialize=function(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},VN.element=function(){return this._el},VN.canvas=function(){return this._el&&this._el.firstChild},VN.origin=function(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},VN.scene=function(t){return arguments.length?(this._scene=t,this):this._scene},VN.on=function(){},VN.off=function(){},VN._handlerIndex=function(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},VN.handlers=function(t){const e=this._handlers,n=[];if(t)n.push.apply(n,e[this.eventName(t)]);else for(const t in e)n.push.apply(n,e[t]);return n},VN.eventName=function(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},VN.handleHref=function(t,e,n){this._loader.sanitize(n,{context:"href"}).then(e=>{const n=new MouseEvent(t.type,t),r=RN(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)}).catch((function(){}))},VN.handleTooltip=function(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,a,o=t&&t.mark;if(o&&(i=EN[o.marktype]).tip){for((a=qN(e,n))[0]-=r[0],a[1]-=r[1];t=t.mark.group;)a[0]-=t.x||0,a[1]-=t.y||0;t=i.tip(o.items,a)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},VN.getItemBoundingClientRect=function(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,u+=t.y||0;return{x:s,y:u,width:a,height:o,left:s,top:u,right:s+a,bottom:u+o}};var HN=GN.prototype;HN.initialize=function(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},HN.element=function(){return this._el},HN.canvas=function(){return this._el&&this._el.firstChild},HN.background=function(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},HN.resize=function(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},HN.dirty=function(){},HN.render=function(t){var e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},HN._render=function(){},HN.renderAsync=function(t){var e=this.render(t);return this._ready?this._ready.then((function(){return e})):Promise.resolve(e)},HN._load=function(t,e){var n=this,r=n._loader[t](e);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then((function(t){t&&i(),n._ready=null}))}return r},HN.sanitizeURL=function(t){return this._load("sanitizeURL",t)},HN.loadImage=function(t){return this._load("loadImage",t)};const XN="dragleave",KN="mousedown",YN="mousemove",JN="mouseout",ZN="click",QN=["keydown","keypress","keyup","dragenter",XN,"dragover",KN,"mouseup",YN,JN,"mouseover",ZN,"dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],tT=YN,eT=JN,nT=ZN;function rT(t,e){WN.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}const iT=he(rT,WN);iT.initialize=function(t,e,n){return this._canvas=t&&BN(t,"canvas"),[ZN,KN,YN,JN,XN].forEach(t=>aT(this,t)),WN.prototype.initialize.call(this,t,e,n)};function aT(t,e){(t=>"touchstart"===t||"touchmove"===t||"touchend"===t?["touchstart","touchmove","touchend"]:[t])(e).forEach(e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e))}function oT(t,e,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i||(i&&i.exit||this.fire(n,r),this._active=a,this.fire(e,r)),this.fire(t,r)}}function sT(t){return function(e){this.fire(t,e),this._active=null}}iT.canvas=function(){return this._canvas},iT.context=function(){return this._canvas.getContext("2d")},iT.events=QN,iT.DOMMouseScroll=function(t){this.fire("mousewheel",t)},iT.mousemove=oT(YN,"mouseover",JN),iT.dragover=oT("dragover","dragenter",XN),iT.mouseout=sT(JN),iT.dragleave=sT(XN),iT.mousedown=function(t){this._down=this._active,this.fire(KN,t)},iT.click=function(t){this._down===this._active&&(this.fire(ZN,t),this._down=null)},iT.touchstart=function(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",t,!0)},iT.touchmove=function(t){this.fire("touchmove",t,!0)},iT.touchend=function(t){this.fire("touchend",t,!0),this._touch=null},iT.fire=function(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===nT&&r&&r.href?this.handleHref(e,r,r.href):t!==tT&&t!==eT||this.handleTooltip(e,r,t!==eT),i)for(let t=0,n=i.length;t<n;++t)i[t].handler.call(this._obj,e,r)},iT.on=function(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(aT(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},iT.off=function(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},iT.pickEvent=function(t){const e=qN(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},iT.pick=function(t,e,n,r,i){const a=this.context();return EN[t.marktype].pick.call(this,a,t,e,n,r,i)};var uT="undefined"!=typeof window&&window.devicePixelRatio||1;function cT(t){GN.call(this,t),this._options={},this._redraw=!1,this._dirty=new LS,this._tempb=new LS}const lT=he(cT,GN),dT=GN.prototype;lT.initialize=function(t,e,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:qs(1,1,this._options.type),t&&this._canvas&&(LN(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),dT.initialize.call(this,t,e,n,r,i)},lT.resize=function(t,e,n,r){if(dT.resize.call(this,t,e,n,r),this._canvas)!function(t,e,n,r,i,a){const o="undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),u=o?uT:i;t.width=e*u,t.height=n*u;for(const t in a)s[t]=a[t];o&&1!==u&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||st("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},lT.canvas=function(){return this._canvas},lT.context=function(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},lT.dirty=function(t){let e=this._tempb.clear().union(t.bounds),n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)};function fT(t,e){WN.call(this,t,e);const n=this;n._hrefHandler=pT(n,(t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)}),n._tooltipHandler=pT(n,(t,e)=>{n.handleTooltip(t,e,t.type!==eT)})}lT._render=function(t){const e=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty,o=(s=n,u=r,c=i,(new LS).set(0,0,u,c).translate(-s[0],-s[1]));var s,u,c;e.save();const l=this._redraw||a.empty()?(this._redraw=!1,o.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,o.intersect(a),n);return this.clear(-n[0],-n[1],r,i),this.draw(e,t,l),e.restore(),a.clear(),this},lT.draw=function(t,e,n){const r=EN[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),Jt(n)?(t.beginPath(),n(t),t.clip()):zj(t,e.group)}(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},lT.clear=function(t,e,n,r){const i=this._options,a=this.context();"pdf"===i.type||i.externalContext||a.clearRect(t,e,n,r),null!=this._bgcolor&&(a.fillStyle=this._bgcolor,a.fillRect(t,e,n,r))};const hT=he(fT,WN);hT.initialize=function(t,e,n){let r=this._svg;return r&&(r.removeEventListener(nT,this._hrefHandler),r.removeEventListener(tT,this._tooltipHandler),r.removeEventListener(eT,this._tooltipHandler)),this._svg=r=t&&BN(t,"svg"),r&&(r.addEventListener(nT,this._hrefHandler),r.addEventListener(tT,this._tooltipHandler),r.addEventListener(eT,this._tooltipHandler)),WN.prototype.initialize.call(this,t,e,n)},hT.canvas=function(){return this._svg};const pT=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};hT.on=function(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:pT(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},hT.off=function(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this};function mT(t,e,n){return t.fields=e||[],t.fname=n,t}function gT(t){return 1===t.length?bT(t[0]):yT(t)}const bT=t=>function(e){return e[t]},yT=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function vT(t){throw Error(t)}function xT(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||vT("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&vT("Access path missing closing bracket: "+t),o&&vT("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function wT(t,e,n){const r=xT(t);return t=1===r.length?r[0]:t,mT((n&&n.get||gT)(r),[t],e||t)}wT("id"),mT(t=>t,[],"identity"),mT(()=>0,[],"zero"),mT(()=>1,[],"one"),mT(()=>!0,[],"true"),mT(()=>!1,[],"false");var kT=Array.isArray;function OT(t){return t[t.length-1]}function _T(t){return null==t||""===t?null:+t}function AT(t){return null!=t?kT(t)?t:[t]:[]}const CT=Object.prototype.hasOwnProperty;function ET(t,e){return CT.call(t,e)}function ST(t){return"string"==typeof t}function jT(){let t,e,n=Js().unknown(void 0),r=n.domain,i=n.range,a=[0,1],o=!1,s=0,u=0,c=.5;function l(){let n=r().length,l=a[1]<a[0],d=a[l-0],f=a[1-l],h=function(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}(n,s,u);t=(f-d)/(h||1),o&&(t=Math.floor(t)),d+=(f-d-t*(n-s))*c,e=t*(1-s),o&&(d=Math.round(d),e=Math.round(e));const p=ki(n).map((function(e){return d+t*e}));return i(l?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),l()):r()},n.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},n.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(o=!!t,l()):o},n.padding=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),s=u,l()):s},n.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},n.paddingOuter=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},n.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},n.invertRange=function(t){if(null==t[0]||null==t[1])return;let n,o,s,u=+t[0],c=+t[1],l=a[1]<a[0],d=l?i().reverse():i(),f=d.length-1;return u!=u||c!=c||(c<u&&(s=u,u=c,c=s),c<d[0]||u>a[1-l])?void 0:(n=Math.max(0,Vs(d,u)-1),o=u===c?n:Vs(d,c)-1,u-d[n]>e+1e-10&&++n,l&&(s=n,n=f-o,o=f-s),n>o?void 0:r().slice(n,o+1))},n.invert=function(t){const e=n.invertRange([t,t]);return e?e[0]:e},n.copy=function(){return jT().domain(r()).range(a).round(o).paddingInner(s).paddingOuter(u).align(c)},l()}var NT=Array.prototype.map;function TT(t){return NT.call(t,_T)}const FT=Array.prototype.slice;const DT={};function IT(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){let n,r,i,a,o=t.range(),s=e[0],u=e[1],c=-1;for(u<s&&(r=s,s=u,u=r),i=0,a=o.length;i<a;++i)o[i]>=s&&o[i]<=u&&(c<0&&(c=i),n=i);if(!(c<0))return s=t.invertExtent(o[c]),u=t.invertExtent(o[n]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=t,n};return r.metadata=function(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}(AT(n)),r}function MT(t,e,n){return arguments.length>1?(DT[t]=IT(t,e,n),this):$T(t)?DT[t]:void 0}function $T(t){return ET(DT,t)}function RT(t,e){const n=DT[t];return n&&n.metadata[e]}function BT(t){return RT(t,"discrete")}function zT(t,e){for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}MT("identity",fc),MT("linear",dc,"continuous"),MT("log",wc,["continuous","log"]),MT("pow",Cc,"continuous"),MT("sqrt",Ec,"continuous"),MT("symlog",Tc,"continuous"),MT("time",Uc,["continuous","temporal"]),MT("utc",Jc,["continuous","temporal"]),MT("sequential",tl,["continuous","interpolating"]),MT("sequential-linear",tl,["continuous","interpolating"]),MT("sequential-log",el,["continuous","interpolating","log"]),MT("sequential-pow",rl,["continuous","interpolating"]),MT("sequential-sqrt",il,["continuous","interpolating"]),MT("sequential-symlog",nl,["continuous","interpolating"]),MT("diverging-linear",sl,["continuous","interpolating"]),MT("diverging-log",ul,["continuous","interpolating","log"]),MT("diverging-pow",ll,["continuous","interpolating"]),MT("diverging-sqrt",dl,["continuous","interpolating"]),MT("diverging-symlog",cl,["continuous","interpolating"]),MT("quantile",fl,["discretizing","quantile"]),MT("quantize",hl,"discretizing"),MT("threshold",pl,"discretizing"),MT("bin-ordinal",(function t(){let e=[],n=[];function r(t){return null==t||t!=t?void 0:n[(Hs(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=TT(t),r):e.slice()},r.range=function(t){return arguments.length?(n=FT.call(t),r):n.slice()},r.tickFormat=function(t,n){return tu(e[0],OT(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),["discrete","discretizing"]),MT("ordinal",Js,"discrete"),MT("band",jT,"discrete"),MT("point",(function(){return function t(e){const n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return t(n())},e}(jT().paddingInner(1))}),"discrete");var LT=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function PT(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function qT(){}var WT="\\s*([+-]?\\d+)\\s*",UT="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",VT="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",GT=/^#([0-9a-f]{3,8})$/,HT=new RegExp("^rgb\\("+[WT,WT,WT]+"\\)$"),XT=new RegExp("^rgb\\("+[VT,VT,VT]+"\\)$"),KT=new RegExp("^rgba\\("+[WT,WT,WT,UT]+"\\)$"),YT=new RegExp("^rgba\\("+[VT,VT,VT,UT]+"\\)$"),JT=new RegExp("^hsl\\("+[UT,VT,VT]+"\\)$"),ZT=new RegExp("^hsla\\("+[UT,VT,VT,UT]+"\\)$"),QT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tF(){return this.rgb().formatHex()}function eF(){return this.rgb().formatRgb()}function nF(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=GT.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?rF(e):3===n?new sF(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?iF(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?iF(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=HT.exec(t))?new sF(e[1],e[2],e[3],1):(e=XT.exec(t))?new sF(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=KT.exec(t))?iF(e[1],e[2],e[3],e[4]):(e=YT.exec(t))?iF(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=JT.exec(t))?dF(e[1],e[2]/100,e[3]/100,1):(e=ZT.exec(t))?dF(e[1],e[2]/100,e[3]/100,e[4]):QT.hasOwnProperty(t)?rF(QT[t]):"transparent"===t?new sF(NaN,NaN,NaN,0):null}function rF(t){return new sF(t>>16&255,t>>8&255,255&t,1)}function iF(t,e,n,r){return r<=0&&(t=e=n=NaN),new sF(t,e,n,r)}function aF(t){return t instanceof qT||(t=nF(t)),t?new sF((t=t.rgb()).r,t.g,t.b,t.opacity):new sF}function oF(t,e,n,r){return 1===arguments.length?aF(t):new sF(t,e,n,null==r?1:r)}function sF(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function uF(){return"#"+lF(this.r)+lF(this.g)+lF(this.b)}function cF(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function lF(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function dF(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new pF(t,e,n,r)}function fF(t){if(t instanceof pF)return new pF(t.h,t.s,t.l,t.opacity);if(t instanceof qT||(t=nF(t)),!t)return new pF;if(t instanceof pF)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new pF(o,s,u,t.opacity)}function hF(t,e,n,r){return 1===arguments.length?fF(t):new pF(t,e,n,null==r?1:r)}function pF(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function mF(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function gF(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}LT(qT,nF,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:tF,formatHex:tF,formatHsl:function(){return fF(this).formatHsl()},formatRgb:eF,toString:eF}),LT(sF,oF,PT(qT,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new sF(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new sF(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:uF,formatHex:uF,formatRgb:cF,toString:cF})),LT(pF,hF,PT(qT,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new pF(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new pF(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new sF(mF(t>=240?t-240:t+120,i,r),mF(t,i,r),mF(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var bF=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return gF((n-r/e)*e,o,i,a,s)}},yF=function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return gF((n-r/e)*e,i,a,o,s)}},vF=function(t){return function(){return t}};function xF(t,e){return function(n){return t+n*e}}function wF(t,e){var n=e-t;return n?xF(t,n>180||n<-180?n-360*Math.round(n/360):n):vF(isNaN(t)?e:t)}function kF(t){return 1==(t=+t)?OF:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):vF(isNaN(e)?n:e)}}function OF(t,e){var n=e-t;return n?xF(t,n):vF(isNaN(t)?e:t)}var _F=function t(e){var n=kF(e);function r(t,e){var r=n((t=oF(t)).r,(e=oF(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=OF(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function AF(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=oF(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}var CF=AF(bF),EF=AF(yF),SF=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}};function jF(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}var NF=function(t,e){return(jF(e)?SF:TF)(t,e)};function TF(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=qF(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}var FF=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},DF=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},IF=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=qF(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},MF=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$F=new RegExp(MF.source,"g");var RF,BF,zF,LF,PF=function(t,e){var n,r,i,a=MF.lastIndex=$F.lastIndex=0,o=-1,s=[],u=[];for(t+="",e+="";(n=MF.exec(t))&&(r=$F.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:DF(n,r)})),a=$F.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})},qF=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?vF(e):("number"===r?DF:"string"===r?(n=nF(e))?(e=n,_F):PF:e instanceof nF?_F:e instanceof Date?FF:jF(e)?SF:Array.isArray(e)?TF:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?IF:DF)(t,e)},WF=function(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}},UF=function(t,e){var n=wF(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}},VF=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}},GF=180/Math.PI,HF={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},XF=function(t,e,n,r,i,a){var o,s,u;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*GF,skewX:Math.atan(u)*GF,scaleX:o,scaleY:s}};function KF(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],u=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var u=o.push("translate(",null,e,null,n);s.push({i:u-4,x:DF(t,i)},{i:u-2,x:DF(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,u),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:DF(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,u),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:DF(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,u),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:DF(t,n)},{i:s-2,x:DF(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,u),a=o=null,function(t){for(var e,n=-1,r=u.length;++n<r;)s[(e=u[n]).i]=e.x(t);return s.join("")}}}var YF=KF((function(t){return"none"===t?HF:(RF||(RF=document.createElement("DIV"),BF=document.documentElement,zF=document.defaultView),RF.style.transform=t,t=zF.getComputedStyle(BF.appendChild(RF),null).getPropertyValue("transform"),BF.removeChild(RF),t=t.slice(7,-1).split(","),XF(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),JF=KF((function(t){return null==t?HF:(LF||(LF=document.createElementNS("http://www.w3.org/2000/svg","g")),LF.setAttribute("transform",t),(t=LF.transform.baseVal.consolidate())?(t=t.matrix,XF(t.a,t.b,t.c,t.d,t.e,t.f)):HF)}),", ",")",")"),ZF=Math.SQRT2;function QF(t){return((t=Math.exp(t))+1/t)/2}var tD=function(t,e){var n,r,i=t[0],a=t[1],o=t[2],s=e[0],u=e[1],c=e[2],l=s-i,d=u-a,f=l*l+d*d;if(f<1e-12)r=Math.log(c/o)/ZF,n=function(t){return[i+t*l,a+t*d,o*Math.exp(ZF*t*r)]};else{var h=Math.sqrt(f),p=(c*c-o*o+4*f)/(2*o*2*h),m=(c*c-o*o-4*f)/(2*c*2*h),g=Math.log(Math.sqrt(p*p+1)-p),b=Math.log(Math.sqrt(m*m+1)-m);r=(b-g)/ZF,n=function(t){var e,n=t*r,s=QF(g),u=o/(2*h)*(s*(e=ZF*n+g,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[i+u*l,a+u*d,o*s/QF(ZF*n+g)]}}return n.duration=1e3*r,n};function eD(t){return function(e,n){var r=t((e=hF(e)).h,(n=hF(n)).h),i=OF(e.s,n.s),a=OF(e.l,n.l),o=OF(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=a(t),e.opacity=o(t),e+""}}}var nD=eD(wF),rD=eD(OF),iD=Math.PI/180,aD=180/Math.PI;function oD(t){if(t instanceof uD)return new uD(t.l,t.a,t.b,t.opacity);if(t instanceof mD)return gD(t);t instanceof sF||(t=aF(t));var e,n,r=fD(t.r),i=fD(t.g),a=fD(t.b),o=cD((.2225045*r+.7168786*i+.0606169*a)/1);return r===i&&i===a?e=n=o:(e=cD((.4360747*r+.3850649*i+.1430804*a)/.96422),n=cD((.0139322*r+.0971045*i+.7141733*a)/.82521)),new uD(116*o-16,500*(e-o),200*(o-n),t.opacity)}function sD(t,e,n,r){return 1===arguments.length?oD(t):new uD(t,e,n,null==r?1:r)}function uD(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function cD(t){return t>6/29*(6/29)*(6/29)?Math.pow(t,1/3):t/(6/29*3*(6/29))+4/29}function lD(t){return t>6/29?t*t*t:6/29*3*(6/29)*(t-4/29)}function dD(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function fD(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function hD(t){if(t instanceof mD)return new mD(t.h,t.c,t.l,t.opacity);if(t instanceof uD||(t=oD(t)),0===t.a&&0===t.b)return new mD(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*aD;return new mD(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function pD(t,e,n,r){return 1===arguments.length?hD(t):new mD(t,e,n,null==r?1:r)}function mD(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function gD(t){if(isNaN(t.h))return new uD(t.l,0,0,t.opacity);var e=t.h*iD;return new uD(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function bD(t,e){var n=OF((t=sD(t)).l,(e=sD(e)).l),r=OF(t.a,e.a),i=OF(t.b,e.b),a=OF(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}}function yD(t){return function(e,n){var r=t((e=pD(e)).h,(n=pD(n)).h),i=OF(e.c,n.c),a=OF(e.l,n.l),o=OF(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=a(t),e.opacity=o(t),e+""}}}LT(uD,sD,PT(qT,{brighter:function(t){return new uD(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new uD(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new sF(dD(3.1338561*(e=.96422*lD(e))-1.6168667*(t=1*lD(t))-.4906146*(n=.82521*lD(n))),dD(-.9787684*e+1.9161415*t+.033454*n),dD(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),LT(mD,pD,PT(qT,{brighter:function(t){return new mD(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new mD(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return gD(this).rgb()}}));var vD=yD(wF),xD=yD(OF);function wD(t){if(t instanceof OD)return new OD(t.h,t.s,t.l,t.opacity);t instanceof sF||(t=aF(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(-.6557636667999999*r+-1.7884503806*e-3.5172982438*n)/-5.9615122912,a=r-i,o=(1.97294*(n-i)- -.29227*a)/-.90649,s=Math.sqrt(o*o+a*a)/(1.97294*i*(1-i)),u=s?Math.atan2(o,a)*aD-120:NaN;return new OD(u<0?u+360:u,s,i,t.opacity)}function kD(t,e,n,r){return 1===arguments.length?wD(t):new OD(t,e,n,null==r?1:r)}function OD(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function _D(t){return function e(n){function r(e,r){var i=t((e=kD(e)).h,(r=kD(r)).h),a=OF(e.s,r.s),o=OF(e.l,r.l),s=OF(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}LT(OD,kD,PT(qT,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new OD(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new OD(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*iD,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new sF(255*(e+n*(-.14861*r+1.78277*i)),255*(e+n*(-.29227*r+-.90649*i)),255*(e+n*(1.97294*r)),this.opacity)}}));var AD=_D(wF),CD=_D(OF),ED=function(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n};function SD(t,e){const n=e[0],r=OT(e)-n;return function(e){return t(n+e*r)}}function jD(t,e,n){return zT(TD(e||"rgb",n),t)}function ND(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}function TD(t,e){const n=g[function(t){return"interpolate"+t.toLowerCase().split("-").map((function(t){return t[0].toUpperCase()+t.slice(1)})).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}function FD(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function DD(t,e){for(const n in t)MD(n,e(t[n]))}const ID={};function MD(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(ID[t]=e,this):ID[t]}DD({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},FD),DD({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},t=>jD(FD(t)));const $D=t=>kT(t)?t.map(t=>String(t)):String(t),RD=(t,e)=>t[1]-e[1],BD=(t,e)=>e[1]-t[1];function zD(t,e){return t.bins?function(t,e,n){let r=t.range(),i=r[0],a=OT(r),o=RD;if(i>a&&(r=a,a=i,i=r,o=BD),i=Math.floor(i),a=Math.ceil(a),e=e.map(e=>[e,t(e)]).filter(t=>i<=t[1]&&t[1]<=a).sort(o).map(t=>t[0]),n>0&&e.length>1){const t=[e[0],OT(e)];for(;e.length>n&&e.length>=3;)e=e.filter((t,e)=>!(e%2));e.length<3&&(e=t)}return e}(t,t.bins):t.ticks?t.ticks(e):t.domain()}function LD(t,e,n,r,i,a){const o=e.type;let s=$D;if("time"===o||"time"===i)s=t.timeFormat(r);else if("utc"===o||"utc"===i)s=t.utcFormat(r);else if(RT(o,"log")){const i=t.formatFloat(r);if(a||e.bins)s=i;else{const t=PD(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function PD(t,e,n){const r=zD(t,e),i=t.base(),a=Math.log(i),o=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/a));return e*i<i-.5&&(e*=i),e<=o};return n?r.filter(s):s}const qD={quantile:"quantiles",quantize:"thresholds",threshold:"domain"},WD={quantile:"quantiles",quantize:"domain"};function UD(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=OT(t),e}(t.bins):"log"===t.type?PD(t,e,!0):qD[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[qD[t.type]]()):zD(t,e)}function VD(t,e,n,r,i,a,o){const s=WD[e.type]&&"time"!==a&&"utc"!==a?function(t,e,n){let r,i=e[WD[e.type]](),a=i.length,o=a>1?i[1]-i[0]:i[0];for(r=1;r<a;++r)o=Math.min(o,i[r]-i[r-1]);return t.formatSpan(0,o,30,n)}(t,e,i):LD(t,e,n,i,a,o);return"symbol"===r&&(t=>qD[t.type]||t.bins)(e)?GD(s):"discrete"===r?XD(s):KD(s)}const GD=t=>(e,n,r)=>{const i=HD(r[n+1],HD(r.max,1/0)),a=YD(e,t),o=YD(i,t);return a&&o?a+"  "+o:o?"< "+o:" "+a},HD=(t,e)=>null!=t?t:e,XD=t=>(e,n)=>n?t(e):null,KD=t=>e=>t(e),YD=(t,e)=>Number.isFinite(t)?e(t):null;function JD(t,e,n,r){const i=r||e.type;return ST(n)&&RT(i,"temporal")&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||"time"!==i?n||"utc"!==i?VD(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function ZD(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=JD(t,e,n.format,n.formatType);if(RT(e.type,"discretizing")){const t=UD(e).slice(1).map(i),n=t.length;return`${n} boundar${1===n?"y":"ies"}: ${t.join(", ")}`}if(BT(e.type)){const t=e.domain(),n=t.length;return`${n} value${1===n?"":"s"}: ${n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ")}`}{const t=e.domain();return`values from ${i(t[0])} to ${i(OT(t))}`}}const QD=(t,e,n)=>({role:t,"aria-roledescription":e,"aria-label":n||void 0}),tI=Fe(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),eI={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?oI(t):null,i=t.context,a=i.scales[e.scale].value,o=i.dataflow.locale(),s=a.type;return("left"===n||"right"===n?"Y":"X")+"-axis"+(r?` titled '${r}'`:"")+` for a ${BT(s)?"discrete":s} scale with `+ZD(o,a,t)}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?oI(t):null,r=((e.type||"")+" legend").trim(),i=e.scales,a=Object.keys(i),o=t.context,s=o.scales[i[a[0]]].value,u=o.dataflow.locale();return c=r,(c.length?c[0].toUpperCase()+c.slice(1):c)+(n?` titled '${n}'`:"")+" for "+function(t){return(t=t.map(t=>t+("fill"===t||"stroke"===t?" color":""))).length<2?t[0]:t.slice(0,-1).join(", ")+" and "+Nt(t)}(a)+" with "+ZD(u,s,t);var c}},"title-text":{desc:"title",caption:t=>`Title text '${aI(t)}'`},"title-subtitle":{desc:"subtitle",caption:t=>`Subtitle text '${aI(t)}'`}},nI={ariaRole:"role",ariaRoleDescription:"aria-roledescription",description:"aria-label"};function rI(t,e){const n=!1===e.aria;if(t("aria-hidden",n||void 0),n||null==e.description)for(const e in nI)t(nI[e],void 0);else{const n=e.mark.marktype;t("aria-label",e.description),t("role",e.ariaRole||("group"===n?"graphics-object":"graphics-symbol")),t("aria-roledescription",e.ariaRoleDescription||n+" mark")}}function iI(t){return!1===t.aria?{"aria-hidden":!0}:tI[t.role]?null:eI[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return QD(e.role||"graphics-symbol",e.desc,n.description||r(n))}catch(t){return null}}(t,eI[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some(t=>null!=t.description&&!1!==t.aria);return QD(n?"graphics-object":"graphics-symbol",e+" mark container",t.description)}(t)}function aI(t){return Kt(t.text).join(" ")}function oI(t){try{return Kt(Nt(t.items).items[0].text).join(" ")}catch(t){return null}}const sI=t=>(t+"").replace(/&/g,"&amp;").replace(/"/g,"&quot;");function uI(t,e,n){var r,i,a="<"+t;if(e)for(r in e)null!=(i=e[r])&&(a+=" "+r+'="'+sI(i)+'"');return n&&(a+=" "+n),a+">"}function cI(t){return"</"+t+">"}const lI={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},dI={fill:"none","stroke-miterlimit":10},fI=Gj.xmlns;function hI(t){GN.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var pI=he(hI,GN),mI=GN.prototype;function gI(t,e,n){var r,i,a;if("radial"===e.gradient){var o=zN(t,n++,"pattern",fI);o.setAttribute("id","p_"+e.id),o.setAttribute("viewBox","0,0,1,1"),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("preserveAspectRatio","xMidYMid slice"),(o=zN(o,0,"rect",fI)).setAttribute("width","1"),o.setAttribute("height","1"),o.setAttribute("fill","url("+CI()+"#"+e.id+")"),(t=zN(t,n++,"radialGradient",fI)).setAttribute("id",e.id),t.setAttribute("fx",e.x1),t.setAttribute("fy",e.y1),t.setAttribute("fr",e.r1),t.setAttribute("cx",e.x2),t.setAttribute("cy",e.y2),t.setAttribute("r",e.r2)}else(t=zN(t,n++,"linearGradient",fI)).setAttribute("id",e.id),t.setAttribute("x1",e.x1),t.setAttribute("x2",e.x2),t.setAttribute("y1",e.y1),t.setAttribute("y2",e.y2);for(r=0,i=e.stops.length;r<i;++r)(a=zN(t,r,"stop",fI)).setAttribute("offset",e.stops[r].offset),a.setAttribute("stop-color",e.stops[r].color);return LN(t,r),n}function bI(t,e,n){var r;return(t=zN(t,n,"clipPath",fI)).setAttribute("id",e.id),e.path?(r=zN(t,0,"path",fI)).setAttribute("d",e.path):((r=zN(t,0,"rect",fI)).setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("width",e.width),r.setAttribute("height",e.height)),LN(t,1),n+1}function yI(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function vI(t,e,n,r,i){let a,o=t._svg;if(!o&&(a=e.ownerDocument,o=RN(a,r,fI),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===r))){const e=RN(a,"path",fI);o.appendChild(e),e.__data__=t;const n=RN(a,"g",fI);o.appendChild(n),n.__data__=t;const r=RN(a,"path",fI);o.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(o.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o}pI.initialize=function(t,e,n,r){if(this._defs={gradient:{},clipping:{}},t){this._svg=zN(t,0,"svg",fI),this._svg.setAttribute("class","marks"),LN(t,1),this._root=zN(this._svg,0,"g",fI);for(const t in dI)this._root.setAttribute(t,dI[t]);LN(this._svg,1)}return this.background(this._bgcolor),mI.initialize.call(this,t,e,n,r)},pI.background=function(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),mI.background.apply(this,arguments)},pI.resize=function(t,e,n,r){return mI.resize.call(this,t,e,n,r),this._svg&&(this._svg.setAttribute("width",this._width*this._scale),this._svg.setAttribute("height",this._height*this._scale),this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height),this._root.setAttribute("transform","translate("+this._origin+")")),this._dirty=[],this},pI.canvas=function(){return this._svg},pI.svg=function(){if(!this._svg)return null;var t={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var e in Gj)t[e]=Gj[e];var n=this._bgcolor?uI("rect",{width:this._width,height:this._height,fill:this._bgcolor})+cI("rect"):"";return uI("svg",t)+(this._defs.el?this._defs.el.outerHTML:"")+n+this._root.outerHTML+cI("svg")},pI._render=function(t){return this._dirtyCheck()&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,t),LN(this._root,1)),this.updateDefs(),this._dirty=[],++this._dirtyID,this},pI.updateDefs=function(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=zN(t,0,"defs",fI)),r=gI(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=zN(t,0,"defs",fI)),r=bI(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):LN(n,r))},pI._resetDefs=function(){var t=this._defs;t.gradient={},t.clipping={}},pI.dirty=function(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},pI.isDirty=function(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},pI._dirtyCheck=function(){this._dirtyAll=!0;var t=this._dirty;if(!t.length||!this._dirtyID)return!0;var e,n,r,i,a,o,s,u=++this._dirtyID;for(a=0,o=t.length;a<o;++a)(n=(e=t[a]).mark).marktype!==r&&(r=n.marktype,i=EN[r]),n.zdirty&&n.dirty!==u&&(this._dirtyAll=!1,yI(e,u),n.items.forEach((function(t){t.dirty=u}))),n.zdirty||(e.exit?(i.nested&&n.items.length?(s=n.items[0])._svg&&this._update(i,s._svg,s):e._svg&&(s=e._svg.parentNode)&&s.removeChild(e._svg),e._svg=null):(e=i.nested?n.items[0]:e)._update!==u&&(e._svg&&e._svg.ownerSVGElement?this._update(i,e._svg,e):(this._dirtyAll=!1,yI(e,u)),e._update=u));return!this._dirtyAll},pI.draw=function(t,e,n){if(!this.isDirty(e))return e._svg;var r,i=this._svg,a=EN[e.marktype],o=!1===e.interactive?"none":null,s="g"===a.tag,u=null,c=0;(r=vI(e,t,n,"g",i)).setAttribute("class",PN(e));const l=iI(e);for(const t in l)AI(r,t,l[t]);s||AI(r,"pointer-events",o),AI(r,"clip-path",e.clip?zS(this,e,e.group):null);const d=t=>{const e=this.isDirty(t),n=vI(t,r,u,a.tag,i);e&&(this._update(a,n,t),s&&function(t,e,n){e=e.lastChild.previousSibling;let r,i=0;_j(n,n=>{r=t.draw(e,n,r),++i}),LN(e,1+i)}(this,n,t)),u=n,++c};return a.nested?e.items.length&&d(e.items[0]):_j(e,d),LN(r,c),r};var xI=null,wI=null,kI={group:function(t,e,n){const r=xI=e.childNodes[2];wI=r.__values__,t.foreground(_I,n,this),wI=e.__values__,xI=e.childNodes[1],t.content(_I,n,this);const i=xI=e.childNodes[0];t.background(_I,n,this);const a=!1===n.mark.interactive?"none":null;if(a!==wI.events&&(AI(r,"pointer-events",a),AI(i,"pointer-events",a),wI.events=a),n.strokeForeground&&n.stroke){const t=n.fill;AI(r,"display",null),this.style(i,n),AI(i,"stroke",null),t&&(n.fill=null),wI=r.__values__,this.style(r,n),t&&(n.fill=t),xI=null}else AI(r,"display","none")},image:function(t,e,n){!1===n.smooth?(OI(e,"image-rendering","optimizeSpeed"),OI(e,"image-rendering","pixelated")):OI(e,"image-rendering",null)},text:function(t,e,n){let r,i,a,o,s=bN(n);_t(s)?(i=s.map(t=>vN(n,t)),r=i.join("\n"),r!==wI.text&&(LN(e,0),a=e.ownerDocument,o=gN(n),i.forEach((t,r)=>{const i=RN(a,"tspan",fI);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",o)),e.appendChild(i)}),wI.text=r)):(i=vN(n,s),i!==wI.text&&(e.textContent=i,wI.text=i)),AI(e,"font-family",xN(n)),AI(e,"font-size",mN(n)+"px"),AI(e,"font-style",n.fontStyle),AI(e,"font-variant",n.fontVariant),AI(e,"font-weight",n.fontWeight)}};function OI(t,e,n){n!==wI[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),wI[e]=n)}function _I(t,e,n){e!==wI[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(xI,t,e,n):AI(xI,t,e),wI[t]=e)}function AI(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function CI(){let t;return"undefined"==typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function EI(t){GN.call(this,t),this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""},this._defs={gradient:{},clipping:{}}}pI._update=function(t,e,n){xI=e,wI=e.__values__,rI(_I,n),t.attr(_I,n,this);const r=kI[t.type];r&&r.call(this,t,e,n),xI&&this.style(xI,n)},pI.style=function(t,e){if(null!=e)for(const n in lI){let r="font"===n?xN(e):e[n];if(r===wI[n])continue;const i=lI[n];null==r?t.removeAttribute(i):(IC(r)&&(r=MC(r,this._defs.gradient,CI())),t.setAttribute(i,r+"")),wI[n]=r}};var SI=he(EI,GN),jI=GN.prototype;function NI(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}SI.resize=function(t,e,n,r){jI.resize.call(this,t,e,n,r);var i=this._origin,a=this._text,o={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var s in Gj)o[s]=Gj[s];a.head=uI("svg",o);var u=this._bgcolor;return"transparent"!==u&&"none"!==u||(u=null),a.bg=u?uI("rect",{width:this._width,height:this._height,fill:u})+cI("rect"):"",a.root=uI("g",ae({},dI,{transform:"translate("+i+")"})),a.foot=cI("g")+cI("svg"),this},SI.background=function(){var t=jI.background.apply(this,arguments);return arguments.length&&this._text.head&&this.resize(this._width,this._height,this._origin,this._scale),t},SI.svg=function(){var t=this._text;return t.head+t.defs+t.bg+t.root+t.body+t.foot},SI._render=function(t){return this._text.body=this.mark(t),this._text.defs=this.buildDefs(),this},SI.buildDefs=function(){let t,e="";for(const n in this._defs.gradient){const r=this._defs.gradient[n],i=r.stops;"radial"===r.gradient?(e+=uI(t="pattern",{id:"p_"+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e+=uI("rect",{width:"1",height:"1",fill:"url(#"+n+")"})+cI("rect"),e+=cI(t),e+=uI(t="radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):e+=uI(t="linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let t=0;t<i.length;++t)e+=uI("stop",{offset:i[t].offset,"stop-color":i[t].color})+cI("stop");e+=cI(t)}for(const t in this._defs.clipping){const n=this._defs.clipping[t];e+=uI("clipPath",{id:t}),n.path?e+=uI("path",{d:n.path})+cI("path"):e+=uI("rect",{x:0,y:0,width:n.width,height:n.height})+cI("rect"),e+=cI("clipPath")}return e?uI("defs")+e+cI("defs"):""},SI.attr=function(t,e,n,r){const i={},a=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach(t=>t(a,e,this)):n(a,e,this),r&&function(t,e,n,r,i){if(null==e)return t;"bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(t.style="image-rendering: optimizeSpeed; image-rendering: pixelated;");"text"===r&&(t["font-family"]=xN(e),t["font-size"]=mN(e)+"px",e.fontStyle&&(t["font-style"]=e.fontStyle),e.fontVariant&&(t["font-variant"]=e.fontVariant),e.fontWeight&&(t["font-weight"]=e.fontWeight));for(const n in lI){let r=e[n];const a=lI[n];("transparent"!==r||"fill"!==a&&"stroke"!==a)&&null!=r&&(IC(r)&&(r=MC(r,i.gradient,"")),t[a]=r)}}(i,e,t,r,this._defs),i},SI.href=function(t){var e,n=this,r=t.href;if(r){if(e=n._hrefs&&n._hrefs[r])return e;n.sanitizeURL(r).then(t=>{t["xlink:href"]=t.href,t.href=null,(n._hrefs||(n._hrefs={}))[r]=t})}return null},SI.mark=function(t){const e=EN[t.marktype],n=e.tag,r=[rI,e.attr];let i="";i+=uI("g",ae({class:PN(t),"clip-path":t.clip?zS(this,t,t.group):null},iI(t),{"pointer-events":"g"!==n&&!1===t.interactive?"none":null}));const a=a=>{const o=this.href(a);if(o&&(i+=uI("a",o)),i+=uI(n,this.attr(t,a,r,"g"!==n?n:null)),"text"===n){const t=bN(a);if(_t(t)){const e={x:0,dy:gN(a)};for(let n=0;n<t.length;++n)i+=uI("tspan",n?e:null)+NI(vN(a,t[n]))+cI("tspan")}else i+=NI(vN(a,t))}else if("g"===n){const n=a.strokeForeground,r=a.fill,o=a.stroke;n&&o&&(a.stroke=null),i+=uI("path",this.attr(t,a,e.background,"bgrect"))+cI("path"),i+=uI("g",this.attr(t,a,e.content))+this.markGroup(a)+cI("g"),n&&o?(r&&(a.fill=null),a.stroke=o,i+=uI("path",this.attr(t,a,e.foreground,"bgrect"))+cI("path"),r&&(a.fill=r)):i+=uI("path",this.attr(t,a,e.foreground,"bgfore"))+cI("path")}i+=cI(n),o&&(i+=cI("a"))};return e.nested?t.items&&t.items.length&&a(t.items[0]):_j(t,a),i+cI("g")},SI.markGroup=function(t){let e="";return _j(t,t=>{e+=this.mark(t)}),e};var TI={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},FI={};function DI(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(FI[t]=e,this):FI[t]}function II(t,e,n){const r=[],i=(new LS).union(e),a=t.marktype;return a?MI(t,i,n,r):"group"===a?$I(t,i,n,r):st("Intersect scene must be mark node or group item.")}function MI(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,a=t.marktype,o=i.length;let s=0;if("group"===a)for(;s<o;++s)$I(i[s],e,n,r);else for(const t=EN[a].isect;s<o;++s){let n=i[s];RI(n,e,t)&&r.push(n)}}return r}function $I(t,e,n,r){n&&n(t.mark)&&RI(t,e,EN.group.isect)&&r.push(t);const i=t.items,a=i&&i.length;if(a){const o=t.x||0,s=t.y||0;e.translate(-o,-s);for(let t=0;t<a;++t)MI(i[t],e,n,r);e.translate(o,s)}return r}function RI(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}FI.canvas=FI.png={renderer:cT,headless:cT,handler:rT},FI.svg={renderer:hI,headless:EI,handler:fT},FI.none={};var BI=new LS,zI=function(t){var e=t.clip;if(Jt(e))e(QS(BI.clear()));else{if(!e)return;BI.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(BI)};function LI(t,e,n){return t===e||("path"===n?PI(t,e):t instanceof Date&&e instanceof Date?+t==+e:be(t)&&be(e)?Math.abs(t-e)<=1e-9:t&&e&&(At(t)||At(e))?null!=t&&null!=e&&function(t,e){var n,r,i=Object.keys(t),a=Object.keys(e);if(i.length!==a.length)return!1;for(i.sort(),a.sort(),r=i.length-1;r>=0;r--)if(i[r]!=a[r])return!1;for(r=i.length-1;r>=0;r--)if(n=i[r],!LI(t[n],e[n],n))return!1;return typeof t==typeof e}(t,e):t==e)}function PI(t,e){return LI(IE(t),IE(e))}function qI(){BS(),DC=0}function WI(t,e){t&&(null==e?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}function UI(t,e,n){return t.fields=e||[],t.fname=n,t}function VI(t){return 1===t.length?GI(t[0]):HI(t)}const GI=t=>function(e){return e[t]},HI=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function XI(t){throw Error(t)}function KI(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||XI("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&XI("Access path missing closing bracket: "+t),o&&XI("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function YI(t,e,n){const r=KI(t);return t=1===r.length?r[0]:t,UI((n&&n.get||VI)(r),[t],e||t)}YI("id"),UI(t=>t,[],"identity"),UI(()=>0,[],"zero"),UI(()=>1,[],"one");const JI=UI(()=>!0,[],"true");UI(()=>!1,[],"false");var ZI=Array.isArray;function QI(t){return t===Object(t)}function tM(t){return t[t.length-1]}function eM(t){return null==t||""===t?null:+t}function nM(t){return null!=t?ZI(t)?t:[t]:[]}function rM(t){return"function"==typeof t}function iM(t){return rM(t)?t:()=>t}function aM(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const oM=Object.prototype.hasOwnProperty;function sM(t,e){return oM.call(t,e)}function uM(t,e,n){const r=t.prototype=Object.create(e.prototype);return r.constructor=t,aM(r,n)}function cM(t){return"[object Date]"===Object.prototype.toString.call(t)}function lM(t){return"string"==typeof t}function dM(t){return ZI(t)?"["+t.map(dM)+"]":QI(t)||lM(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function fM(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function hM(t,e){const n=t.globalCursor()?"undefined"!=typeof document&&document.body:t.container();if(n)return null==e?n.style.removeProperty("cursor"):n.style.cursor=e}function pM(t,e){var n=t._runtime.data;return sM(n,e)||XI("Unrecognized data set: "+e),n[e]}function mM(t,e){gn(e)||XI("Second argument to changes must be a changeset.");var n=pM(this,t);return n.modified=!0,this.pulse(n.input,e)}function gM(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function bM(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function yM(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}function vM(){const t=Js().unknown(void 0),e=t.domain,n=t.range;let r,i,a=[0,1],o=!1,s=0,u=0,c=.5;function l(){const t=e().length,l=a[1]<a[0],d=a[1-l],f=function(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}(t,s,u);let h=a[l-0];r=(d-h)/(f||1),o&&(r=Math.floor(r)),h+=(d-h-r*(t-s))*c,i=r*(1-s),o&&(h=Math.round(h),i=Math.round(i));const p=ki(t).map(t=>h+r*t);return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},t.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(o=!!t,l()):o},t.padding=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),s=u,l()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},t.paddingOuter=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=a[1]<a[0],o=r?n().reverse():n(),s=o.length-1;let u,c,l,d=+t[0],f=+t[1];return d!=d||f!=f||(f<d&&(l=d,d=f,f=l),f<o[0]||d>a[1-r])?void 0:(u=Math.max(0,Vs(o,d)-1),c=d===f?u:Vs(o,f)-1,d-o[u]>i+1e-10&&++u,r&&(l=u,u=s-c,c=s-l),u>c?void 0:e().slice(u,c+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return vM().domain(e()).range(a).round(o).paddingInner(s).paddingOuter(u).align(c)},l()}var xM=Array.prototype.map;function wM(t){return xM.call(t,eM)}const kM=Array.prototype.slice;const OM={};function _M(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,a,o,s=e[0],u=e[1],c=-1;for(u<s&&(i=s,s=u,u=i),a=0,o=n.length;a<o;++a)n[a]>=s&&n[a]<=u&&(c<0&&(c=a),r=a);if(!(c<0))return s=t.invertExtent(n[c]),u=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=t,n};return r.metadata=fM(nM(n)),r}function AM(t,e,n){return arguments.length>1?(OM[t]=_M(t,e,n),this):CM(t)?OM[t]:void 0}function CM(t){return sM(OM,t)}function EM(t,e){const n=OM[t];return n&&n.metadata[e]}function SM(t){return EM(t,"discrete")}AM("identity",fc),AM("linear",dc,"continuous"),AM("log",wc,["continuous","log"]),AM("pow",Cc,"continuous"),AM("sqrt",Ec,"continuous"),AM("symlog",Tc,"continuous"),AM("time",Uc,["continuous","temporal"]),AM("utc",Jc,["continuous","temporal"]),AM("sequential",tl,["continuous","interpolating"]),AM("".concat("sequential","-").concat("linear"),tl,["continuous","interpolating"]),AM("".concat("sequential","-").concat("log"),el,["continuous","interpolating","log"]),AM("".concat("sequential","-").concat("pow"),rl,["continuous","interpolating"]),AM("".concat("sequential","-").concat("sqrt"),il,["continuous","interpolating"]),AM("".concat("sequential","-").concat("symlog"),nl,["continuous","interpolating"]),AM("".concat("diverging","-").concat("linear"),sl,["continuous","interpolating"]),AM("".concat("diverging","-").concat("log"),ul,["continuous","interpolating","log"]),AM("".concat("diverging","-").concat("pow"),ll,["continuous","interpolating"]),AM("".concat("diverging","-").concat("sqrt"),dl,["continuous","interpolating"]),AM("".concat("diverging","-").concat("symlog"),cl,["continuous","interpolating"]),AM("quantile",fl,["discretizing","quantile"]),AM("quantize",hl,"discretizing"),AM("threshold",pl,"discretizing"),AM("bin-ordinal",(function t(){let e=[],n=[];function r(t){return null==t||t!=t?void 0:n[(Hs(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=wM(t),r):e.slice()},r.range=function(t){return arguments.length?(n=kM.call(t),r):n.slice()},r.tickFormat=function(t,n){return tu(e[0],tM(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),["discrete","discretizing"]),AM("ordinal",Js,"discrete"),AM("band",vM,"discrete"),AM("point",(function(){return function t(e){const n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return t(n())},e}(vM().paddingInner(1))}),"discrete");function jM(t,e,n){return al(function(t,e){const n=o[function(t){return"interpolate"+t.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}(e||"rgb",n),t)}function NM(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function TM(t,e){for(const n in t)DM(n,e(t[n]))}const FM={};function DM(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(FM[t]=e,this):FM[t]}TM({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},NM),TM({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},t=>jM(NM(t)));const IM=t=>ZI(t)?t.map(t=>String(t)):String(t),MM=(t,e)=>t[1]-e[1],$M=(t,e)=>e[1]-t[1];function RM(t,e){return t.bins?function(t,e,n){let r=t.range(),i=r[0],a=tM(r),o=MM;if(i>a&&(r=a,a=i,i=r,o=$M),i=Math.floor(i),a=Math.ceil(a),e=e.map(e=>[e,t(e)]).filter(t=>i<=t[1]&&t[1]<=a).sort(o).map(t=>t[0]),n>0&&e.length>1){const t=[e[0],tM(e)];for(;e.length>n&&e.length>=3;)e=e.filter((t,e)=>!(e%2));e.length<3&&(e=t)}return e}(t,t.bins):t.ticks?t.ticks(e):t.domain()}function BM(t,e,n,r,i,a){const o=e.type;let s=IM;if("time"===o||"time"===i)s=t.timeFormat(r);else if("utc"===o||"utc"===i)s=t.utcFormat(r);else if(EM(o,"log")){const i=t.formatFloat(r);if(a||e.bins)s=i;else{const t=zM(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function zM(t,e,n){const r=RM(t,e),i=t.base(),a=Math.log(i),o=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/a));return e*i<i-.5&&(e*=i),e<=o};return n?r.filter(s):s}const LM={quantile:"quantiles",quantize:"thresholds",threshold:"domain"},PM={quantile:"quantiles",quantize:"domain"};function qM(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=tM(t),e}(t.bins):"log"===t.type?zM(t,e,!0):LM[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[LM[t.type]]()):RM(t,e)}function WM(t,e,n,r,i,a,o){const s=PM[e.type]&&"time"!==a&&"utc"!==a?function(t,e,n){const r=e[PM[e.type]](),i=r.length;let a,o=i>1?r[1]-r[0]:r[0];for(a=1;a<i;++a)o=Math.min(o,r[a]-r[a-1]);return t.formatSpan(0,o,30,n)}(t,e,i):BM(t,e,n,i,a,o);return"symbol"===r&&(t=>LM[t.type]||t.bins)(e)?UM(s):"discrete"===r?GM(s):HM(s)}const UM=t=>(e,n,r)=>{const i=VM(r[n+1],VM(r.max,1/0)),a=XM(e,t),o=XM(i,t);return a&&o?a+"  "+o:o?"< "+o:" "+a},VM=(t,e)=>null!=t?t:e,GM=t=>(e,n)=>n?t(e):null,HM=t=>e=>t(e),XM=(t,e)=>Number.isFinite(t)?e(t):null;function KM(t,e,n,r){const i=r||e.type;return lM(n)&&EM(i,"temporal")&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||"time"!==i?n||"utc"!==i?WM(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function YM(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=KM(t,e,n.format,n.formatType);if(EM(e.type,"discretizing")){const t=qM(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if(SM(e.type)){const t=e.domain(),n=t.length,a=n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ");return"".concat(n," value").concat(1===n?"":"s",": ").concat(a)}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i(tM(t)))}}let JM=0;function ZM(t){return t&&t.gradient}function QM(t,e,n){const r=t.gradient;let i=t.id,a="radial"===r?"p_":"";return i||(i=t.id="gradient_"+JM++,"radial"===r?(t.x1=t$(t.x1,.5),t.y1=t$(t.y1,.5),t.r1=t$(t.r1,0),t.x2=t$(t.x2,.5),t.y2=t$(t.y2,.5),t.r2=t$(t.r2,.5),a="p_"):(t.x1=t$(t.x1,0),t.y1=t$(t.y1,0),t.x2=t$(t.x2,1),t.y2=t$(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+a+i+")"}function t$(t,e){return null!=t?t:e}const e$={basis:{curve:vo},"basis-closed":{curve:ko},"basis-open":{curve:_o},bundle:{curve:Co,tension:"beta",value:.85},cardinal:{curve:jo,tension:"tension",value:0},"cardinal-open":{curve:To,tension:"tension",value:0},"cardinal-closed":{curve:Do,tension:"tension",value:0},"catmull-rom":{curve:Xo,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Yo,tension:"alpha",value:.5},"catmull-rom-open":{curve:Zo,tension:"alpha",value:.5},linear:{curve:ts},"linear-closed":{curve:ns},monotone:{horizontal:ds,vertical:ls},natural:{curve:ps},step:{curve:gs},"step-after":{curve:ys},"step-before":{curve:bs}};function n$(t,e,n){var r=sM(e$,t)&&e$[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const r$={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},i$=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function a$(t){const e=[];let n,r,i,a,o,s,u,c,l,d;const f=t.slice().replace(i$[0],"###$1").split(i$[1]).slice(1);for(u=0,l=f.length;u<l;++u){for(n=f[u],r=n.slice(1).trim().replace(i$[2],"$1###$2").replace(i$[3],"$1###$2").split(i$[4]),o=n.charAt(0),i=[o],c=0,d=r.length;c<d;++c)(a=+r[c])===a&&i.push(a);if(s=r$[o.toLowerCase()],i.length-1>s){const t=i.length;for(c=1,e.push([o].concat(i.slice(c,c+=s))),o="M"===o?"L":"m"===o?"l":o;c<t;c+=s)e.push([o].concat(i.slice(c,c+s)))}else e.push(i)}return e}const o$=Math.PI/180,s$=Math.PI/2,u$=2*Math.PI,c$=Math.sqrt(3)/2;var l$={},d$={},f$=[].join;function h$(t){const e=f$.call(t);if(d$[e])return d$[e];var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7];const l=c*o,d=-u*s,f=u*o,h=c*s,p=Math.cos(i),m=Math.sin(i),g=Math.cos(a),b=Math.sin(a),y=.5*(a-i),v=Math.sin(.5*y),x=8/3*v*v/Math.sin(y),w=n+p-x*m,k=r+m+x*p,O=n+g,_=r+b,A=O+x*b,C=_-x*g;return d$[e]=[l*w+d*k,f*w+h*k,l*A+d*C,f*A+h*C,l*O+d*_,f*O+h*_]}const p$=["l",0,0,0,0,0,0,0];function m$(t,e,n){const r=p$[0]=t[0];if("a"===r||"A"===r)p$[1]=e*t[1],p$[2]=n*t[2],p$[3]=t[3],p$[4]=t[4],p$[5]=t[5],p$[6]=e*t[6],p$[7]=n*t[7];else if("h"===r||"H"===r)p$[1]=e*t[1];else if("v"===r||"V"===r)p$[1]=n*t[1];else for(var i=1,a=t.length;i<a;++i)p$[i]=(i%2==1?e:n)*t[i];return p$}function g$(t,e,n,r,i,a){var o,s,u,c,l,d=null,f=0,h=0,p=0,m=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==a&&(a=i),t.beginPath&&t.beginPath();for(var g=0,b=e.length;g<b;++g){switch(o=e[g],1===i&&1===a||(o=m$(o,i,a)),o[0]){case"l":f+=o[1],h+=o[2],t.lineTo(f+n,h+r);break;case"L":f=o[1],h=o[2],t.lineTo(f+n,h+r);break;case"h":f+=o[1],t.lineTo(f+n,h+r);break;case"H":f=o[1],t.lineTo(f+n,h+r);break;case"v":h+=o[1],t.lineTo(f+n,h+r);break;case"V":h=o[1],t.lineTo(f+n,h+r);break;case"m":f+=o[1],h+=o[2],t.moveTo(f+n,h+r);break;case"M":f=o[1],h=o[2],t.moveTo(f+n,h+r);break;case"c":s=f+o[5],u=h+o[6],p=f+o[3],m=h+o[4],t.bezierCurveTo(f+o[1]+n,h+o[2]+r,p+n,m+r,s+n,u+r),f=s,h=u;break;case"C":f=o[5],h=o[6],p=o[3],m=o[4],t.bezierCurveTo(o[1]+n,o[2]+r,p+n,m+r,f+n,h+r);break;case"s":s=f+o[3],u=h+o[4],p=2*f-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,f+o[1]+n,h+o[2]+r,s+n,u+r),p=f+o[1],m=h+o[2],f=s,h=u;break;case"S":s=o[3],u=o[4],p=2*f-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,o[1]+n,o[2]+r,s+n,u+r),f=s,h=u,p=o[1],m=o[2];break;case"q":s=f+o[3],u=h+o[4],p=f+o[1],m=h+o[2],t.quadraticCurveTo(p+n,m+r,s+n,u+r),f=s,h=u;break;case"Q":s=o[3],u=o[4],t.quadraticCurveTo(o[1]+n,o[2]+r,s+n,u+r),f=s,h=u,p=o[1],m=o[2];break;case"t":s=f+o[1],u=h+o[2],null===d[0].match(/[QqTt]/)?(p=f,m=h):"t"===d[0]?(p=2*f-c,m=2*h-l):"q"===d[0]&&(p=2*f-p,m=2*h-m),c=p,l=m,t.quadraticCurveTo(p+n,m+r,s+n,u+r),h=u,p=(f=s)+o[1],m=h+o[2];break;case"T":s=o[1],u=o[2],p=2*f-p,m=2*h-m,t.quadraticCurveTo(p+n,m+r,s+n,u+r),f=s,h=u;break;case"a":b$(t,f+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+f+n,o[7]+h+r]),f+=o[6],h+=o[7];break;case"A":b$(t,f+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),f=o[6],h=o[7];break;case"z":case"Z":t.closePath()}d=o}}function b$(t,e,n,r){const i=function(t,e,n,r,i,a,o,s,u){const c=f$.call(arguments);if(l$[c])return l$[c];const l=o*o$,d=Math.sin(l),f=Math.cos(l),h=f*(s-t)*.5+d*(u-e)*.5,p=f*(u-e)*.5-d*(s-t)*.5;let m=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(m=Math.sqrt(m),n*=m,r*=m);const g=f/n,b=d/n,y=-d/r,v=f/r,x=g*s+b*u,w=y*s+v*u,k=g*t+b*e,O=y*t+v*e,_=(k-x)*(k-x)+(O-w)*(O-w);let A=1/_-.25;A<0&&(A=0);let C=Math.sqrt(A);a==i&&(C=-C);const E=.5*(x+k)-C*(O-w),S=.5*(w+O)+C*(k-x),j=Math.atan2(w-S,x-E),N=Math.atan2(O-S,k-E);let T=N-j;T<0&&1===a?T+=u$:T>0&&0===a&&(T-=u$);const F=Math.ceil(Math.abs(T/(s$+.001))),D=[];for(let t=0;t<F;++t){const e=j+t*T/F,i=j+(t+1)*T/F;D[t]=[E,S,e,i,n,r,d,f]}return l$[c]=D}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let e=0;e<i.length;++e){const n=h$(i[e]);t.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5])}}const y$={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,u$)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,a=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-a),t.lineTo(i,-a),t.lineTo(0,-n),t.lineTo(-i,-a),t.lineTo(-r,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=c$*n,i=r-.5773502691896257*n,a=n/4;t.moveTo(0,-r-i),t.lineTo(-a,r-i),t.lineTo(a,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=c$*n,i=r-.5773502691896257*n;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=c$*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=c$*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=c$*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=c$*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function v$(t){return sM(y$,t)?y$[t]:function(t){if(!sM(x$,t)){const e=a$(t);x$[t]={draw:function(t,n){g$(t,e,0,0,Math.sqrt(n)/2)}}}return x$[t]}(t)}var x$={};function w$(t){return t.x}function k$(t){return t.y}function O$(t){return t.width}function _$(t){return t.height}function A$(t){return"function"==typeof t?t:()=>+t}function C$(t,e,n){return Math.max(e,Math.min(t,n))}function E$(t,e){return null!=t?t:e}const S$=t=>t.x||0,j$=t=>t.y||0,N$=t=>!(!1===t.defined),T$=Ds().startAngle(t=>t.startAngle||0).endAngle(t=>t.endAngle||0).padAngle(t=>t.padAngle||0).innerRadius(t=>t.innerRadius||0).outerRadius(t=>t.outerRadius||0).cornerRadius(t=>t.cornerRadius||0),F$=Bs().x(S$).y1(j$).y0(t=>(t.y||0)+(t.height||0)).defined(N$),D$=Bs().y(j$).x1(S$).x0(t=>(t.x||0)+(t.width||0)).defined(N$),I$=Rs().x(S$).y(j$).defined(N$),M$=function(){var t=w$,e=k$,n=O$,r=_$,i=A$(0),a=i,o=i,s=i,u=null;function c(c,l,d){var f,h=null!=l?l:+t.call(this,c),p=null!=d?d:+e.call(this,c),m=+n.call(this,c),g=+r.call(this,c),b=Math.min(m,g)/2,y=C$(+i.call(this,c),0,b),v=C$(+a.call(this,c),0,b),x=C$(+o.call(this,c),0,b),w=C$(+s.call(this,c),0,b);if(u||(u=f=_s()),y<=0&&v<=0&&x<=0&&w<=0)u.rect(h,p,m,g);else{var k=h+m,O=p+g;u.moveTo(h+y,p),u.lineTo(k-v,p),u.bezierCurveTo(k-.448084975506*v,p,k,p+.448084975506*v,k,p+v),u.lineTo(k,O-w),u.bezierCurveTo(k,O-.448084975506*w,k-.448084975506*w,O,k-w,O),u.lineTo(h+x,O),u.bezierCurveTo(h+.448084975506*x,O,h,O-.448084975506*x,h,O-x),u.lineTo(h,p+y),u.bezierCurveTo(h,p+.448084975506*y,h+.448084975506*y,p,h+y,p),u.closePath()}if(f)return u=null,f+""||null}return c.x=function(e){return arguments.length?(t=A$(e),c):t},c.y=function(t){return arguments.length?(e=A$(t),c):e},c.width=function(t){return arguments.length?(n=A$(t),c):n},c.height=function(t){return arguments.length?(r=A$(t),c):r},c.cornerRadius=function(t,e,n,r){return arguments.length?(i=A$(t),a=null!=e?A$(e):i,s=null!=n?A$(n):i,o=null!=r?A$(r):a,c):i},c.context=function(t){return arguments.length?(u=null==t?null:t,c):u},c}().x(S$).y(j$).width(t=>t.width||0).height(t=>t.height||0).cornerRadius(t=>E$(t.cornerRadiusTopLeft,t.cornerRadius)||0,t=>E$(t.cornerRadiusTopRight,t.cornerRadius)||0,t=>E$(t.cornerRadiusBottomRight,t.cornerRadius)||0,t=>E$(t.cornerRadiusBottomLeft,t.cornerRadius)||0),$$=Ps().type(t=>v$(t.shape||"circle")).size(t=>E$(t.size,64)),R$=function(){var t,e,n,r,i,a,o,s,u=null;function c(t,e,n){const r=n/2;if(i){var c=o-e,l=t-a;if(c||l){var d=Math.sqrt(c*c+l*l),f=(c/=d)*s,h=(l/=d)*s,p=Math.atan2(l,c);u.moveTo(a-f,o-h),u.lineTo(t-c*r,e-l*r),u.arc(t,e,r,p-Math.PI,p),u.lineTo(a+f,o+h),u.arc(a,o,s,p,p+Math.PI)}else u.arc(t,e,r,0,u$);u.closePath()}else i=1;a=t,o=e,s=r}function l(a){var o,s,l,d=a.length,f=!1;for(null==u&&(u=l=_s()),o=0;o<=d;++o)!(o<d&&r(s=a[o],o,a))===f&&(f=!f)&&(i=0),f&&c(+t(s,o,a),+e(s,o,a),+n(s,o,a));if(l)return u=null,l+""||null}return l.x=function(e){return arguments.length?(t=e,l):t},l.y=function(t){return arguments.length?(e=t,l):e},l.size=function(t){return arguments.length?(n=t,l):n},l.defined=function(t){return arguments.length?(r=t,l):r},l.context=function(t){return arguments.length?(u=null==t?null:t,l):u},l}().x(S$).y(j$).defined(N$).size(t=>t.size||1);function B$(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function z$(t,e,n,r){return M$.context(t)(e,n,r)}var L$=1;function P$(t,e,n){var r=e.clip,i=t._defs,a=e.clip_id||(e.clip_id="clip"+L$++),o=i.clipping[a]||(i.clipping[a]={id:a});return rM(r)?o.path=r(null):B$(n)?o.path=z$(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function q$(t){this.clear(),t&&this.union(t)}function W$(t){this.mark=t,this.bounds=this.bounds||new q$}function U$(t){W$.call(this,t),this.items=this.items||[]}function V$(t){this._pending=0,this._loader=t||Object(en.e)()}function G$(t){t._pending+=1}function H$(t){t._pending-=1}function X$(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}q$.prototype={clone(){return new q$(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(t),u=Math.sin(t),c=e-e*s+n*u,l=n-e*u-n*s;return[s*r-u*i+c,u*r+s*i+l,s*r-u*o+c,u*r+s*o+l,s*a-u*i+c,u*a+s*i+l,s*a-u*o+c,u*a+s*o+l]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},uM(U$,W$),V$.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return G$(e),e._loader.sanitize(t,{context:"href"}).then(t=>(H$(e),t)).catch(()=>(H$(e),null))},loadImage(t){const e=this,n=Ws();return G$(e),e._loader.sanitize(t,{context:"image"}).then(t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,a=sM(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=a&&(i.crossOrigin=a),i.onload=()=>H$(e),i.onerror=()=>H$(e),i.src=r,i}).catch(t=>(H$(e),{complete:!1,width:0,height:0,src:t&&t.url||""}))},ready(){const t=this;return new Promise(e=>{!function n(r){t.pending()?setTimeout(()=>{n(!0)},10):e(r)}(!1)})}};const K$=u$-1e-8;let Y$,J$,Z$,Q$,tR,eR,nR,rR;const iR=(t,e)=>Y$.add(t,e),aR=(t,e)=>iR(J$=t,Z$=e),oR=t=>iR(t,Y$.y1),sR=t=>iR(Y$.x1,t),uR=(t,e)=>tR*t+nR*e,cR=(t,e)=>eR*t+rR*e,lR=(t,e)=>iR(uR(t,e),cR(t,e)),dR=(t,e)=>aR(uR(t,e),cR(t,e));function fR(t,e){return Y$=t,e?(Q$=e*o$,tR=rR=Math.cos(Q$),eR=Math.sin(Q$),nR=-eR):(tR=rR=1,Q$=eR=nR=0),hR}const hR={beginPath(){},closePath(){},moveTo:dR,lineTo:dR,rect(t,e,n,r){Q$?(lR(t+n,e),lR(t+n,e+r),lR(t,e+r),dR(t,e)):(iR(t+n,e+r),aR(t,e))},quadraticCurveTo(t,e,n,r){const i=uR(t,e),a=cR(t,e),o=uR(n,r),s=cR(n,r);pR(J$,i,o,oR),pR(Z$,a,s,sR),aR(o,s)},bezierCurveTo(t,e,n,r,i,a){const o=uR(t,e),s=cR(t,e),u=uR(n,r),c=cR(n,r),l=uR(i,a),d=cR(i,a);mR(J$,o,u,l,oR),mR(Z$,s,c,d,sR),aR(l,d)},arc(t,e,n,r,i,a){if(r+=Q$,i+=Q$,J$=n*Math.cos(i)+t,Z$=n*Math.sin(i)+e,Math.abs(i-r)>K$)iR(t-n,e-n),iR(t+n,e+n);else{const o=r=>iR(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,u;if(o(r),o(i),i!==r)if((r%=u$)<0&&(r+=u$),(i%=u$)<0&&(i+=u$),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=u$,s=r-r%s$,u=0;u<4&&s>i;++u,s-=s$)o(s);else for(s=r-r%s$+s$,u=0;u<4&&s<i;++u,s+=s$)o(s)}}};function pR(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function mR(t,e,n,r,i){const a=r-t+3*e-3*n,o=t+n-2*e,s=t-e;let u,c=0,l=0;Math.abs(a)>1e-14?(u=o*o+s*a,u>=0&&(u=Math.sqrt(u),c=(-o+u)/a,l=(-o-u)/a)):c=.5*s/o,0<c&&c<1&&i(gR(c,t,e,n,r)),0<l&&l<1&&i(gR(l,t,e,n,r))}function gR(t,e,n,r,i){const a=1-t,o=a*a,s=t*t;return o*a*e+3*o*t*n+3*a*s*r+s*t*i}var bR=(bR=qs(1,1))?bR.getContext("2d"):null;const yR=new q$;function vR(t){return function(e,n){if(!bR)return!0;t(bR,e),yR.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=yR;for(let t=i;t<=o;++t)for(let e=r;e<=a;++e)if(bR.isPointInPath(e,t))return!0;return!1}}function xR(t,e){return e.contains(t.x||0,t.y||0)}function wR(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,a=t.height||0;return e.intersects(yR.set(n,r,n+i,r+a))}function kR(t,e,n,r,i){const{x1:a,y1:o,x2:s,y2:u}=t,c=r-e,l=i-n;let d,f,h,p,m=0,g=1;for(p=0;p<4;++p){if(0===p&&(d=-c,f=-(a-e)),1===p&&(d=c,f=s-e),2===p&&(d=-l,f=-(o-n)),3===p&&(d=l,f=u-n),Math.abs(d)<1e-10&&f<0)return!1;if(h=f/d,d<0){if(h>g)return!1;h>m&&(m=h)}else if(d>0){if(h<m)return!1;h<g&&(g=h)}}return!0}function OR(t,e){t.globalCompositeOperation=e.blend||"source-over"}function _R(t,e){return null==t?e:t}function AR(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function CR(t,e,n){return ZM(n)?function(t,e,n){const r=n.width(),i=n.height();let a;if("radial"===e.gradient)a=t.createRadialGradient(n.x1+_R(e.x1,.5)*r,n.y1+_R(e.y1,.5)*i,Math.max(r,i)*_R(e.r1,0),n.x1+_R(e.x2,.5)*r,n.y1+_R(e.y2,.5)*i,Math.max(r,i)*_R(e.r2,.5));else{const o=_R(e.x1,0),s=_R(e.y1,0),u=_R(e.x2,1),c=_R(e.y2,0);if(o!==u&&s!==c&&r!==i){const n=qs(Math.ceil(r),Math.ceil(i)),a=n.getContext("2d");return a.scale(r,i),a.fillStyle=AR(a.createLinearGradient(o,s,u,c),e.stops),a.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}a=t.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+u*r,n.y1+c*i)}return AR(a,e.stops)}(t,n,e.bounds):n}function ER(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=CR(t,e,e.fill),!0)}var SR=[];function jR(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&((n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=CR(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||SR),t.lineDashOffset=e.strokeDashOffset||0),!0))}function NR(t,e){return t.zindex-e.zindex||t.index-e.index}function TR(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,a=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&a.push(e);return t.zdirty=!1,t.zitems=a.sort(NR)}function FR(t,e){var n,r,i=t.items;if(!i||!i.length)return;const a=TR(t);if(a&&a.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=a}for(n=0,r=i.length;n<r;++n)e(i[n])}function DR(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const a=TR(t);for(a&&a.length&&(i=a),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===a)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function IR(t){return function(e,n,r){FR(n,n=>{r&&!r.intersects(n.bounds)||MR(t,e,n,n)})}}function MR(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(OR(e,n),n.fill&&ER(e,n,i)&&e.fill(),n.stroke&&jR(e,n,i)&&e.stroke()))}function $R(t){return t=t||JI,function(e,n,r,i,a,o){return r*=e.pixelRatio,i*=e.pixelRatio,DR(n,n=>{const s=n.bounds;if((!s||s.contains(a,o))&&s)return t(e,n,r,i,a,o)?n:void 0})}}function RR(t,e){return function(n,r,i,a){var o,s,u=Array.isArray(r)?r[0]:r,c=null==e?u.fill:e,l=u.stroke&&n.isPointInStroke;return l&&(o=u.strokeWidth,s=u.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(c&&n.isPointInPath(i,a)||l&&n.isPointInStroke(i,a))}}function BR(t){return $R(RR(t))}function zR(t,e){return"translate("+t+","+e+")"}function LR(t){return"rotate("+t+")"}function PR(t){return zR(t.x||0,t.y||0)}function qR(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,a=n.angle||0;t.translate(r,i),a&&t.rotate(a*=o$),t.beginPath(),e(t,n),a&&t.rotate(-a),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return zR(t.x||0,t.y||0)+(t.angle?" "+LR(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(fR(t,n.angle),n),X$(t,n).translate(n.x||0,n.y||0)},draw:IR(r),pick:BR(r),isect:n||vR(r)}}var WR=qR("arc",(function(t,e){return T$.context(t)(e)}));function UR(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=RR(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(fR(t),r),X$(t,r[0]))},draw:(a=r,function(t,e,n){!e.items.length||n&&!n.intersects(e.bounds)||MR(a,t,e.items[0],e.items)}),pick:function(t,e,n,r,a,o){var s=e.items,u=e.bounds;return!s||!s.length||u&&!u.contains(a,o)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,s,n,r)?s[0]:null)},isect:xR,tip:n};var a}var VR=UR("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?D$:F$).curve(n$(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],a="horizontal"===t[0].orient?"y":"x",o=t.length,s=1/0;--o>=0;)!1!==t[o].defined&&(r=Math.abs(t[o][a]-i))<s&&(s=r,n=t[o]);return n}));function GR(t,e){t.beginPath(),B$(e)?z$(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function HR(t){const e=_R(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function XR(t,e){const n=HR(e);t("d",z$(null,e,n,n))}function KR(t,e,n,r){const i=HR(e);t.beginPath(),z$(t,e,(n||0)+i,(r||0)+i)}const YR=RR(KR),JR=RR(KR,!1),ZR=RR(KR,!0);var QR={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",PR(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),X$(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){FR(e,e=>{const r=e.x||0,i=e.y||0,a=e.strokeForeground,o=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&o&&(KR(t,e,r,i),OR(t,e),e.fill&&ER(t,e,o)&&t.fill(),e.stroke&&!a&&jR(t,e,o)&&t.stroke()),t.save(),t.translate(r,i),e.clip&&GR(t,e),n&&n.translate(-r,-i),FR(e,e=>{this.draw(t,e,n)}),n&&n.translate(r,i),t.restore(),a&&e.stroke&&o&&(KR(t,e,r,i),OR(t,e),jR(t,e,o)&&t.stroke())})},pick:function(t,e,n,r,i,a){if(e.bounds&&!e.bounds.contains(i,a)||!e.items)return null;const o=n*t.pixelRatio,s=r*t.pixelRatio;return DR(e,u=>{let c,l,d;const f=u.bounds;if(f&&!f.contains(i,a))return;l=u.x||0,d=u.y||0;const h=l+(u.width||0),p=d+(u.height||0),m=u.clip;if(m&&(i<l||i>h||a<d||a>p))return;if(t.save(),t.translate(l,d),l=i-l,d=a-d,m&&B$(u)&&!ZR(t,u,o,s))return t.restore(),null;const g=u.strokeForeground,b=!1!==e.interactive;return b&&g&&u.stroke&&JR(t,u,o,s)?(t.restore(),u):(c=DR(u,t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,l,d)?this.pick(t,n,r,l,d):null),!c&&b&&(u.fill||!g&&u.stroke)&&YR(t,u,o,s)&&(c=u),t.restore(),c||null)})},isect:wR,content:function(t,e,n){t("clip-path",e.clip?P$(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),XR(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?XR(t,e):t("d","")}},tB={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function eB(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(e=>{t.image=e,t.image.url=t.url})),n}function nB(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function rB(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function iB(t,e){return"center"===t?e/2:"right"===t?e:0}function aB(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var oB={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=eB(e,n),i=nB(e,r),a=rB(e,r),o=(e.x||0)-iB(e.align,i),s=(e.y||0)-aB(e.baseline,a);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",tB["xmlns:xlink"],"xlink:href"),t("transform",zR(o,s)),t("width",i),t("height",a),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=nB(e,n),i=rB(e,n),a=(e.x||0)-iB(e.align,r),o=(e.y||0)-aB(e.baseline,i);return t.set(a,o,a+r,o+i)},draw:function(t,e,n){FR(e,e=>{if(n&&!n.intersects(e.bounds))return;const r=eB(e,this);let i,a,o,s,u=nB(e,r),c=rB(e,r),l=(e.x||0)-iB(e.align,u),d=(e.y||0)-aB(e.baseline,c);!1!==e.aspect&&(a=r.width/r.height,o=e.width/e.height,a==a&&o==o&&a!==o&&(o<a?(s=u/a,d+=(c-s)/2,c=s):(s=c*a,l+=(u-s)/2,u=s))),(r.complete||r.toDataURL)&&(OR(t,e),t.globalAlpha=null!=(i=e.opacity)?i:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,l,d,u,c))})},pick:$R(),isect:JI,get:eB,xOffset:iB,yOffset:aB},sB=UR("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return I$.curve(n$(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),a=t.length;--a>=0;)if(!1!==t[a].defined&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<i)return t[a];return null}));function uB(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,a=e.scaleX||1,o=e.scaleY||1,s=(e.angle||0)*o$,u=e.pathCache;u&&u.path===n||((e.pathCache=u=a$(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),g$(t,u,0,0,a,o),t.rotate(-s),t.translate(-r,-i)):g$(t,u,r,i,a,o)}var cB={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return zR(t.x||0,t.y||0)+(t.angle?" "+LR(t.angle):"")+(t.scaleX||t.scaleY?" "+(e=t.scaleX||1,n=t.scaleY||1,"scale("+e+","+n+")"):"");var e,n}(e)),t("d",e.path)},bound:function(t,e){return uB(fR(t,e.angle),e)?t.set(0,0,0,0):X$(t,e,!0)},draw:IR(uB),pick:BR(uB),isect:vR(uB)};function lB(t,e){t.beginPath(),z$(t,e)}var dB={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",z$(null,e))},bound:function(t,e){var n,r;return X$(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:IR(lB),pick:BR(lB),isect:wR};function fB(t,e,n){var r,i,a,o;return!(!e.stroke||!jR(t,e,n))&&(r=e.x||0,i=e.y||0,a=null!=e.x2?e.x2:r,o=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),!0)}var hB={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",PR(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return X$(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){FR(e,e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&fB(t,e,r)&&(OR(t,e),t.stroke())}})},pick:$R((function(t,e,n,r){return!!t.isPointInStroke&&(fB(t,e,1)&&t.isPointInStroke(n,r))})),isect:function(t,e){const n=t.x||0,r=t.y||0;return kR(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}},pB=qR("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),mB=qR("symbol",(function(t,e){return $$.context(t)(e)}),xR);const gB=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},a=(i,a)=>(++r>t&&(n=e,e={},r=1),e[i]=a);return i(),{clear:i,has:t=>sM(e,t)||sM(n,t),get:t=>sM(e,t)?e[t]:sM(n,t)?a(t,n[t]):void 0,set:(t,n)=>sM(e,t)?e[t]=n:a(t,n)}}();var bB={height:OB,measureWidth:wB,estimateWidth:vB,width:vB,canvas:yB};function yB(t){bB.width=t&&bR?wB:vB}function vB(t,e){return xB(CB(t,e),OB(t))}function xB(t,e){return~~(.8*t.length*e)}function wB(t,e){return OB(t)<=0||!(e=CB(t,e))?0:kB(e,SB(t))}function kB(t,e){const n="(".concat(e,") ").concat(t);let r=gB.get(n);return void 0===r&&(bR.font=e,r=bR.measureText(t).width,gB.set(n,r)),r}function OB(t){return null!=t.fontSize?+t.fontSize||0:11}function _B(t){return null!=t.lineHeight?t.lineHeight:OB(t)+2}function AB(t){return e=t.lineBreak&&t.text&&!ZI(t.text)?t.text.split(t.lineBreak):t.text,ZI(e)?e.length>1?e:e[0]:e;var e}function CB(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(bB.width===wB){const e=SB(t);return t=>kB(t,e)}{const e=OB(t);return t=>xB(t,e)}}(t);if(r(e)<n)return e;var i,a=t.ellipsis||"",o="rtl"===t.dir,s=0,u=e.length;if(n-=r(a),o){for(;s<u;)i=s+u>>>1,r(e.slice(i))>n?s=i+1:u=i;return a+e.slice(s)}for(;s<u;)i=1+(s+u>>>1),r(e.slice(0,i))<n?s=i:u=i-1;return e.slice(0,s)+a}(t,n):n}function EB(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function SB(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+OB(t)+"px "+EB(t,e)}function jB(t){var e=t.baseline,n=OB(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*_B(t):"line-bottom"===e?.29*n-.5*_B(t):0)}yB(!0);const NB={left:"start",center:"middle",right:"end"},TB=new q$;function FB(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-s$,n+=i*Math.cos(e),r+=i*Math.sin(e)),TB.x1=n,TB.y1=r,TB}function DB(t,e,n){var r,i=bB.height(e),a=e.align,o=FB(e),s=o.x1,u=o.y1,c=e.dx||0,l=(e.dy||0)+jB(e)-Math.round(.8*i),d=AB(e);if(ZI(d)?(i+=_B(e)*(d.length-1),r=d.reduce((t,n)=>Math.max(t,bB.width(e,n)),0)):r=bB.width(e,d),"center"===a?c-=r/2:"right"===a&&(c-=r),t.set(c+=s,l+=u,c+r,l+i),e.angle&&!n)t.rotate(e.angle*o$,s,u);else if(2===n)return t.rotatedPoints(e.angle*o$,s,u);return t}var IB={arc:WR,area:VR,group:QR,image:oB,line:sB,path:cB,rect:dB,rule:hB,shape:pB,symbol:mB,text:{type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+jB(e),a=FB(e),o=a.x1,s=a.y1,u=e.angle||0;t("text-anchor",NB[e.align]||"start"),u?(n=zR(o,s)+" "+LR(u),(r||i)&&(n+=" "+zR(r,i))):n=zR(o+r,s+i),t("transform",n)},bound:DB,draw:function(t,e,n){FR(e,e=>{var r,i,a,o,s,u,c,l=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===l||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=SB(e),t.textAlign=e.align||"left",i=(r=FB(e)).x1,a=r.y1,e.angle&&(t.save(),t.translate(i,a),t.rotate(e.angle*o$),i=a=0),i+=e.dx||0,a+=(e.dy||0)+jB(e),u=AB(e),OR(t,e),ZI(u))for(s=_B(e),o=0;o<u.length;++o)c=CB(e,u[o]),e.fill&&ER(t,e,l)&&t.fillText(c,i,a),e.stroke&&jR(t,e,l)&&t.strokeText(c,i,a),a+=s;else c=CB(e,u),e.fill&&ER(t,e,l)&&t.fillText(c,i,a),e.stroke&&jR(t,e,l)&&t.strokeText(c,i,a);e.angle&&t.restore()}})},pick:$R((function(t,e,n,r,i,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=FB(e),s=o.x1,u=o.y1,c=DB(TB,e,1),l=-e.angle*o$,d=Math.cos(l),f=Math.sin(l),h=d*i-f*a+(s-d*s+f*u),p=f*i+d*a+(u-f*s-d*u);return c.contains(h,p)})),isect:function(t,e){const n=DB(TB,t,2);return kR(e,n[0],n[1],n[2],n[3])||kR(e,n[0],n[1],n[4],n[5])||kR(e,n[4],n[5],n[6],n[7])||kR(e,n[2],n[3],n[6],n[7])}},trail:UR("trail",(function(t,e){return R$.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null}))};function MB(t,e,n){var r=IB[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new q$),t,n)}var $B={mark:null};const RB=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function BB(t){return function t(e){var n,r,i,a=e.marktype,o=e.items;if(o)for(r=0,i=o.length;r<i;++r)n=a?"mark":"group",o[r][n]=e,o[r].zindex&&(o[r][n].zdirty=!0),"group"===(a||n)&&t(o[r]);a&&function(t,e,n){var r,i,a,o,s=IB[t.marktype],u=s.bound,c=t.items,l=c&&c.length;if(s.nested)return l?a=c[0]:($B.mark=t,a=$B),o=MB(a,u,n),e=e&&e.union(o)||o;if(e=e||t.bounds&&t.bounds.clear()||new q$,l)for(r=0,i=c.length;r<i;++r)e.union(MB(c[r],u,n));t.bounds=e}(e);return e}("string"==typeof t?JSON.parse(t):t)}function zB(t){arguments.length?this.root=BB(t):(this.root=LB({marktype:"group",name:"root",role:"frame"}),this.root.items=[new U$(this.root)])}function LB(t,e){const n={bounds:new q$,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function PB(t,e,n){return!t&&"undefined"!=typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function qB(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function WB(t,e,n,r){var i,a=t.childNodes[e];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(i=a||null,a=PB(t.ownerDocument,n,r),t.insertBefore(a,i)),a}function UB(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function VB(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function GB(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function HB(t,e){this._active=null,this._handlers={},this._loader=t||Object(en.e)(),this._tooltip=e||XB}function XB(t,e,n,r){t.element().setAttribute("title",r||"")}function KB(t){this._el=null,this._bgcolor=null,this._loader=new V$(t)}zB.prototype={toJSON(t){return function(t,e){return JSON.stringify(t,RB,e)}(this.root,t||0)},mark(t,e,n){const r=LB(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},HB.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const t in e)n.push(...e[t]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then(e=>{const n=new MouseEvent(t.type,t),r=PB(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)}).catch(()=>{})},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,a,o=t&&t.mark;if(o&&(i=IB[o.marktype]).tip){for((a=GB(e,n))[0]-=r[0],a[1]-=r[1];t=t.mark.group;)a[0]-=t.x||0,a[1]-=t.y||0;t=i.tip(o.items,a)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,u+=t.y||0;return{x:s,y:u,width:a,height:o,left:s,top:u,right:s+a,bottom:u+o}}},KB.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t){const e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then(()=>e):Promise.resolve(e)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then(e=>{e&&t(),n._ready=null})}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const YB="dragleave",JB="mousedown",ZB="mousemove",QB="mouseout",tz="click",ez=ZB,nz=QB,rz=tz;function iz(t,e){HB.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function az(t,e){(t=>"touchstart"===t||"touchmove"===t||"touchend"===t?["touchstart","touchmove","touchend"]:[t])(e).forEach(e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e))}function oz(t,e,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i||(i&&i.exit||this.fire(n,r),this._active=a,this.fire(e,r)),this.fire(t,r)}}function sz(t){return function(e){this.fire(t,e),this._active=null}}uM(iz,HB,{initialize(t,e,n){return this._canvas=t&&qB(t,"canvas"),[tz,JB,ZB,QB,YB].forEach(t=>az(this,t)),HB.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup","dragenter",YB,"dragover",JB,"mouseup",ZB,QB,"mouseover",tz,"dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],DOMMouseScroll(t){this.fire("mousewheel",t)},mousemove:oz(ZB,"mouseover",QB),dragover:oz("dragover","dragenter",YB),mouseout:sz(QB),dragleave:sz(YB),mousedown(t){this._down=this._active,this.fire(JB,t)},click(t){this._down===this._active&&(this.fire(tz,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",t,!0)},touchmove(t){this.fire("touchmove",t,!0)},touchend(t){this.fire("touchend",t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===rz&&r&&r.href?this.handleHref(e,r,r.href):t!==ez&&t!==nz||this.handleTooltip(e,r,t!==nz),i)for(let t=0,n=i.length;t<n;++t)i[t].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(az(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=GB(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const a=this.context();return IB[t.marktype].pick.call(this,a,t,e,n,r,i)}});var uz="undefined"!=typeof window&&window.devicePixelRatio||1;function cz(t){KB.call(this,t),this._options={},this._redraw=!1,this._dirty=new q$,this._tempb=new q$}const lz=KB.prototype;function dz(t,e){HB.call(this,t,e);const n=this;n._hrefHandler=fz(n,(t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)}),n._tooltipHandler=fz(n,(t,e)=>{n.handleTooltip(t,e,t.type!==nz)})}uM(cz,KB,{initialize(t,e,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:qs(1,1,this._options.type),t&&this._canvas&&(UB(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),lz.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(lz.resize.call(this,t,e,n,r),this._canvas)!function(t,e,n,r,i,a){const o="undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),u=o?uz:i;t.width=e*u,t.height=n*u;for(const t in a)s[t]=a[t];o&&1!==u&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||XI("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty,o=(s=n,u=r,c=i,(new q$).set(0,0,u,c).translate(-s[0],-s[1]));var s,u,c;e.save();const l=this._redraw||a.empty()?(this._redraw=!1,o.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,o.intersect(a),n);return this.clear(-n[0],-n[1],r,i),this.draw(e,t,l),e.restore(),a.clear(),this},draw(t,e,n){const r=IB[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),rM(n)?(t.beginPath(),n(t),t.clip()):GR(t,e.group)}(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,a=this.context();"pdf"===i.type||i.externalContext||a.clearRect(t,e,n,r),null!=this._bgcolor&&(a.fillStyle=this._bgcolor,a.fillRect(t,e,n,r))}});const fz=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};uM(dz,HB,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(rz,this._hrefHandler),r.removeEventListener(ez,this._tooltipHandler),r.removeEventListener(nz,this._tooltipHandler)),this._svg=r=t&&qB(t,"svg"),r&&(r.addEventListener(rz,this._hrefHandler),r.addEventListener(ez,this._tooltipHandler),r.addEventListener(nz,this._tooltipHandler)),HB.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:fz(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const hz=(t,e,n)=>({role:t,"aria-roledescription":e,"aria-label":n||void 0}),pz=fM(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),mz={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?xz(t):null,i=t.context,a=i.scales[e.scale].value,o=i.dataflow.locale(),s=a.type;return"".concat("left"===n||"right"===n?"Y":"X","-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(SM(s)?"discrete":s," scale")+" with ".concat(YM(o,a,t))}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?xz(t):null,r="".concat(e.type||""," legend").trim(),i=e.scales,a=Object.keys(i),o=t.context,s=o.scales[i[a[0]]].value,u=o.dataflow.locale();return c=r,(c.length?c[0].toUpperCase()+c.slice(1):c)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(t){return(t=t.map(t=>t+("fill"===t||"stroke"===t?" color":""))).length<2?t[0]:t.slice(0,-1).join(", ")+" and "+tM(t)}(a))+" with ".concat(YM(u,s,t));var c}},"title-text":{desc:"title",caption:t=>"Title text '".concat(vz(t),"'")},"title-subtitle":{desc:"subtitle",caption:t=>"Subtitle text '".concat(vz(t),"'")}},gz={ariaRole:"role",ariaRoleDescription:"aria-roledescription",description:"aria-label"};function bz(t,e){const n=!1===e.aria;if(t("aria-hidden",n||void 0),n||null==e.description)for(const e in gz)t(gz[e],void 0);else{const n=e.mark.marktype;t("aria-label",e.description),t("role",e.ariaRole||("group"===n?"graphics-object":"graphics-symbol")),t("aria-roledescription",e.ariaRoleDescription||"".concat(n," mark"))}}function yz(t){return!1===t.aria?{"aria-hidden":!0}:pz[t.role]?null:mz[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return hz(e.role||"graphics-symbol",e.desc,n.description||r(n))}catch(t){return null}}(t,mz[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some(t=>null!=t.description&&!1!==t.aria);return hz(n?"graphics-object":"graphics-symbol","".concat(e," mark container"),t.description)}(t)}function vz(t){return nM(t.text).join(" ")}function xz(t){try{return nM(tM(t.items).items[0].text).join(" ")}catch(t){return null}}const wz=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function kz(){let t="",e="",n="";const r=[],i=()=>e=n="",a=(t,n)=>(null!=n&&(e+=" ".concat(t,'="').concat(wz(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),o),o={open(s,...u){(a=>{e&&(t+="".concat(e,">").concat(n),i()),r.push(a)})(s),e="<"+s;for(const t of u)for(const e in t)a(e,t[e]);return o},close(){const a=r.pop();return t+=e?e+(n?">".concat(n,"</").concat(a,">"):"/>"):"</".concat(a,">"),i(),o},attr:a,text:t=>(n+=wz(t),o),toString:()=>t};return o}const Oz=t=>function t(e,n){if(e.open(n.tagName),n.hasAttributes()){const t=n.attributes,r=t.length;for(let n=0;n<r;++n)e.attr(t[n].name,t[n].value)}if(n.hasChildNodes()){const r=n.childNodes,i=r.length;for(let n=0;n<i;n++){const i=r[n];3===i.nodeType?e.text(i.nodeValue):t(e,i)}}return e.close()}(kz(),t)+"";const _z={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},Az={fill:"none","stroke-miterlimit":10},Cz=tB.xmlns;function Ez(t){KB.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const Sz=KB.prototype;function jz(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function Nz(t,e,n){let r,i,a;if("radial"===e.gradient){let r=WB(t,n++,"pattern",Cz);Bz(r,{id:"p_"+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=WB(r,0,"rect",Cz),Bz(r,{width:1,height:1,fill:"url(".concat(Lz(),"#").concat(e.id,")")}),Bz(t=WB(t,n++,"radialGradient",Cz),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else Bz(t=WB(t,n++,"linearGradient",Cz),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)a=WB(t,r,"stop",Cz),a.setAttribute("offset",e.stops[r].offset),a.setAttribute("stop-color",e.stops[r].color);return UB(t,r),n}function Tz(t,e,n){let r;return(t=WB(t,n,"clipPath",Cz)).setAttribute("id",e.id),e.path?(r=WB(t,0,"path",Cz),r.setAttribute("d",e.path)):(r=WB(t,0,"rect",Cz),Bz(r,{x:0,y:0,width:e.width,height:e.height})),UB(t,1),n+1}function Fz(t,e,n,r,i){let a,o=t._svg;if(!o&&(a=e.ownerDocument,o=PB(a,r,Cz),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===r))){const e=PB(a,"path",Cz);o.appendChild(e),e.__data__=t;const n=PB(a,"g",Cz);o.appendChild(n),n.__data__=t;const r=PB(a,"path",Cz);o.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(o.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o}uM(Ez,KB,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=WB(t,0,"svg",Cz),Bz(this._svg,tB),this._svg.setAttribute("class","marks"),UB(t,1),this._root=WB(this._svg,0,"g",Cz),Bz(this._root,Az),UB(this._svg,1)),this.background(this._bgcolor),Sz.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),Sz.background.apply(this,arguments)},resize(t,e,n,r){return Sz.resize.call(this,t,e,n,r),this._svg&&(Bz(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=WB(t,0,"rect",Cz),Bz(n,{width:this._width,height:this._height,fill:e}));const r=Oz(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),UB(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,a,o,s,u;for(o=0,s=t.length;o<s;++o)n=t[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=IB[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,jz(n,e),r.items.forEach(t=>{t.dirty=e})),r.zdirty||(n.exit?(a.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(a,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null):(n=a.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(a,n._svg,n):(this._dirtyAll=!1,jz(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;const r=this._svg,i=IB[e.marktype],a=!1===e.interactive?"none":null,o="g"===i.tag;let s=null,u=0;const c=Fz(e,t,n,"g",r);c.setAttribute("class",VB(e));const l=yz(e);for(const t in l)zz(c,t,l[t]);o||zz(c,"pointer-events",a),zz(c,"clip-path",e.clip?P$(this,e,e.group):null);const d=t=>{const e=this.isDirty(t),n=Fz(t,c,s,i.tag,r);e&&(this._update(i,n,t),o&&function(t,e,n){e=e.lastChild.previousSibling;let r,i=0;FR(n,n=>{r=t.mark(e,n,r),++i}),UB(e,1+i)}(this,n,t)),s=n,++u};return i.nested?e.items.length&&d(e.items[0]):FR(e,d),UB(c,u),c},_update(t,e,n){Dz=e,Iz=e.__values__,bz($z,n),t.attr($z,n,this);const r=Mz[t.type];r&&r.call(this,t,e,n),Dz&&this.style(Dz,n)},style(t,e){if(null!=e)for(const n in _z){let r="font"===n?EB(e):e[n];if(r===Iz[n])continue;const i=_z[n];null==r?t.removeAttribute(i):(ZM(r)&&(r=QM(r,this._defs.gradient,Lz())),t.setAttribute(i,r+"")),Iz[n]=r}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=WB(t,1,"defs",Cz)),r=Nz(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=WB(t,1,"defs",Cz)),r=Tz(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):UB(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let Dz=null,Iz=null;const Mz={group(t,e,n){const r=Dz=e.childNodes[2];Iz=r.__values__,t.foreground($z,n,this),Iz=e.__values__,Dz=e.childNodes[1],t.content($z,n,this);const i=Dz=e.childNodes[0];t.background($z,n,this);const a=!1===n.mark.interactive?"none":null;if(a!==Iz.events&&(zz(r,"pointer-events",a),zz(i,"pointer-events",a),Iz.events=a),n.strokeForeground&&n.stroke){const t=n.fill;zz(r,"display",null),this.style(i,n),zz(i,"stroke",null),t&&(n.fill=null),Iz=r.__values__,this.style(r,n),t&&(n.fill=t),Dz=null}else zz(r,"display","none")},image(t,e,n){!1===n.smooth?(Rz(e,"image-rendering","optimizeSpeed"),Rz(e,"image-rendering","pixelated")):Rz(e,"image-rendering",null)},text(t,e,n){const r=AB(n);let i,a,o,s;ZI(r)?(a=r.map(t=>CB(n,t)),i=a.join("\n"),i!==Iz.text&&(UB(e,0),o=e.ownerDocument,s=_B(n),a.forEach((t,r)=>{const i=PB(o,"tspan",Cz);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),e.appendChild(i)}),Iz.text=i)):(a=CB(n,r),a!==Iz.text&&(e.textContent=a,Iz.text=a)),zz(e,"font-family",EB(n)),zz(e,"font-size",OB(n)+"px"),zz(e,"font-style",n.fontStyle),zz(e,"font-variant",n.fontVariant),zz(e,"font-weight",n.fontWeight)}};function $z(t,e,n){e!==Iz[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(Dz,t,e,n):zz(Dz,t,e),Iz[t]=e)}function Rz(t,e,n){n!==Iz[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),Iz[e]=n)}function Bz(t,e){for(const n in e)zz(t,n,e[n])}function zz(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function Lz(){let t;return"undefined"==typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function Pz(t){KB.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}uM(Pz,KB,{svg(){return this._text},_render(t){const e=kz();e.open("svg",aM({},tB,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",Az,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=IB[e.marktype],r=n.tag,i=[bz,n.attr];t.open("g",{class:VB(e),"clip-path":e.clip?P$(this,e,e.group):null},yz(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const a=a=>{const o=this.href(a);if(o&&t.open("a",o),t.open(r,this.attr(e,a,i,"g"!==r?r:null)),"text"===r){const e=AB(a);if(ZI(e)){const n={x:0,dy:_B(a)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(CB(a,e[r])).close()}else t.text(CB(a,e))}else if("g"===r){const r=a.strokeForeground,i=a.fill,o=a.stroke;r&&o&&(a.stroke=null),t.open("path",this.attr(e,a,n.background,"bgrect")).close(),t.open("g",this.attr(e,a,n.content)),FR(a,e=>this.mark(t,e)),t.close(),r&&o?(i&&(a.fill=null),a.stroke=o,t.open("path",this.attr(e,a,n.foreground,"bgrect")).close(),i&&(a.fill=i)):t.open("path",this.attr(e,a,n.foreground,"bgfore")).close()}t.close(),o&&t.close()};return n.nested?e.items&&e.items.length&&a(e.items[0]):FR(e,a),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then(t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t})}return null},attr(t,e,n,r){const i={},a=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach(t=>t(a,e,this)):n(a,e,this),r&&function(t,e,n,r,i){if(null==e)return t;"bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(t.style="image-rendering: optimizeSpeed; image-rendering: pixelated;");"text"===r&&(t["font-family"]=EB(e),t["font-size"]=OB(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const n in _z){let r=e[n];const a=_z[n];("transparent"!==r||"fill"!==a&&"stroke"!==a)&&null!=r&&(ZM(r)&&(r=QM(r,i.gradient,"")),t[a]=r)}}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:"p_"+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const qz="canvas",Wz="png",Uz="svg",Vz={};function Gz(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(Vz[t]=e,this):Vz[t]}Vz.canvas=Vz.png={renderer:cz,headless:cz,handler:iz},Vz.svg={renderer:Ez,headless:Pz,handler:dz},Vz.none={};new q$;var Hz=function(t,e,n){var r,i,a=t._renderer,o=a&&a.canvas();return o&&(i=yM(t),(r=GB(e.changedTouches?e.changedTouches[0]:e,o))[0]-=i[0],r[1]-=i[1]),e.dataflow=t,e.item=n,e.vega=function(t,e,n){var r=e?"group"===e.mark.marktype?e:e.mark.group:null;function i(t){var n,i=r;if(t)for(n=e;n;n=n.mark.group)if(n.mark.name===t){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function a(t){if(!t)return n;lM(t)&&(t=i(t));for(var e=n.slice();t;)e[0]-=t.x||0,e[1]-=t.y||0,t=t.mark&&t.mark.group;return e}return{view:iM(t),item:iM(e||{}),group:i,xy:a,x:function(t){return a(t)[0]},y:function(t){return a(t)[1]}}}(t,n,r),e};const Xz={trap:!1};function Kz(t,e,n){const r=t._eventConfig&&t._eventConfig[e];return!(!1===r||QI(r)&&!r[n])||(t.warn(`Blocked ${e} ${n} event listener.`),!1)}function Yz(t){return t.item}function Jz(t){return t.item.mark.source}function Zz(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}var Qz=function(t,e,n){var r=document.createElement(t);for(var i in e)r.setAttribute(i,e[i]);return null!=n&&(r.textContent=n),r};var tL=function(t,e,n){if(!e)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:e=>{e!==t.signal(r.signal)&&t.runAsync(null,()=>{i.source=!0,t.signal(r.signal,e)})}},r.debounce&&(i.update=function(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(e(r),n=null),t)}}(r.debounce,i.update))),function(t,e,n,r){const i=Qz("div",{class:"vega-bind"}),a="radio"===n.input?i:i.appendChild(Qz("label"));a.appendChild(Qz("span",{class:"vega-bind-name"},n.name||n.signal)),e.appendChild(i);let o=eL;switch(n.input){case"checkbox":o=nL;break;case"select":o=rL;break;case"radio":o=iL;break;case"range":o=aL}o(t,a,n,r)}(i,e,r,t.signal(r.signal)),i.active||(t.on(t._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(t.signal(r.signal))}),i.active=!0),i};function eL(t,e,n,r){const i=Qz("input");for(const t in n)"signal"!==t&&"element"!==t&&i.setAttribute("input"===t?"type":t,n[t]);i.setAttribute("name",n.signal),i.value=r,e.appendChild(i),i.addEventListener("input",()=>t.update(i.value)),t.elements=[i],t.set=t=>i.value=t}function nL(t,e,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const a=Qz("input",i);e.appendChild(a),a.addEventListener("change",()=>t.update(a.checked)),t.elements=[a],t.set=t=>a.checked=!!t||null}function rL(t,e,n,r){const i=Qz("select",{name:n.signal}),a=n.labels||[];n.options.forEach((t,e)=>{const n={value:t};oL(t,r)&&(n.selected=!0),i.appendChild(Qz("option",n,(a[e]||t)+""))}),e.appendChild(i),i.addEventListener("change",()=>{t.update(n.options[i.selectedIndex])}),t.elements=[i],t.set=t=>{for(let e=0,r=n.options.length;e<r;++e)if(oL(n.options[e],t))return void(i.selectedIndex=e)}}function iL(t,e,n,r){const i=Qz("span",{class:"vega-bind-radio"}),a=n.labels||[];e.appendChild(i),t.elements=n.options.map((e,o)=>{const s={type:"radio",name:n.signal,value:e};oL(e,r)&&(s.checked=!0);const u=Qz("input",s);u.addEventListener("change",()=>t.update(e));const c=Qz("label",{},(a[o]||e)+"");return c.prepend(u),i.appendChild(c),u}),t.set=e=>{const n=t.elements,r=n.length;for(let t=0;t<r;++t)oL(n[t].value,e)&&(n[t].checked=!0)}}function aL(t,e,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,a=n.min||Math.min(0,i,+r)||0,o=n.step||Object(Zs.c)(a,i,100),s=Qz("input",{type:"range",name:n.signal,min:a,max:i,step:o});s.value=r;const u=Qz("span",{},+r);e.appendChild(s),e.appendChild(u);const c=()=>{u.textContent=s.value,t.update(+s.value)};s.addEventListener("input",c),s.addEventListener("change",c),t.elements=[s],t.set=t=>{s.value=t,u.textContent=t}}function oL(t,e){return t===e||t+""==e+""}var sL=function(t,e,n,r,i,a){return(e=e||new r(t.loader())).initialize(n,gM(t),bM(t),yM(t),i,a).background(t.background())},uL=function(t,e){return e?function(){try{e.apply(this,arguments)}catch(e){t.error(e)}}:null};function cL(t,e){if("string"==typeof e){if("undefined"==typeof document)return t.error("DOM document instance not found."),null;if(!(e=document.querySelector(e)))return t.error("Signal bind element not found: "+e),null}if(e)try{e.innerHTML=""}catch(n){e=null,t.error(n)}return e}const lL=t=>+t||0;var dL=function(t){return QI(t)?{top:lL(t.top),bottom:lL(t.bottom),left:lL(t.left),right:lL(t.right)}:(t=>({top:t,bottom:t,left:t,right:t}))(lL(t))},fL=async function(t,e,n,r){const i=Gz(e),a=i&&i.headless;return a||XI("Unrecognized renderer type: "+e),await t.runAsync(),sL(t,null,null,a,n,r).renderAsync(t._scenegraph.root)};function hL(t,e,n){return t.fields=e||[],t.fname=n,t}function pL(t){return 1===t.length?mL(t[0]):gL(t)}const mL=t=>function(e){return e[t]},gL=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function bL(t){throw Error(t)}function yL(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||bL("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&bL("Access path missing closing bracket: "+t),o&&bL("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function vL(t,e,n){const r=yL(t);return t=1===r.length?r[0]:t,hL((n&&n.get||pL)(r),[t],e||t)}vL("id");const xL=hL(t=>t,[],"identity"),wL=(hL(()=>0,[],"zero"),hL(()=>1,[],"one"),hL(()=>!0,[],"true"));hL(()=>!1,[],"false");var kL=Array.isArray;function OL(t){return t===Object(t)}function _L(t){return t[t.length-1]}function AL(t){return null==t||""===t?null:+t}const CL=t=>e=>t*Math.exp(e),EL=t=>e=>Math.log(t*e),SL=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),jL=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,NL=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function TL(t,e,n,r){const i=n(t[0]),a=n(_L(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function FL(t,e,n,r,i){const a=r(t[0]),o=r(_L(t)),s=null!=e?r(e):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function DL(t){return null!=t?kL(t)?t:[t]:[]}function IL(t){return"function"==typeof t}function ML(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const $L=Object.prototype.hasOwnProperty;function RL(t,e){return $L.call(t,e)}function BL(t,e,n){const r=t.prototype=Object.create(e.prototype);return r.constructor=t,ML(r,n)}function zL(t){return"[object Date]"===Object.prototype.toString.call(t)}function LL(t){return"number"==typeof t}function PL(t){return"string"==typeof t}function qL(t,e){let n="";for(;--e>=0;)n+=t;return n}function WL(t){return t&&_L(t)-t[0]||0}function UL(t){return kL(t)?"["+t.map(UL)+"]":OL(t)||PL(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}const VL=t=>LL(t)||zL(t)?t:Date.parse(t);function GL(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function HL(t){const e=this.context.data[t];return e?e.values.value:[]}const XL=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},KL=XL("format"),YL=XL("timeFormat"),JL=XL("utcFormat"),ZL=XL("timeParse"),QL=XL("utcParse"),tP=new Date(2e3,0,1);function eP(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(tP.setYear(2e3),tP.setMonth(t),tP.setDate(e),YL.call(this,tP,n)):""}function nP(t){this.type=t}var rP,iP,aP,oP,sP;nP.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case"ArrayExpression":return t.elements;case"BinaryExpression":case"LogicalExpression":return[t.left,t.right];case"CallExpression":return[t.callee].concat(t.arguments);case"ConditionalExpression":return[t.test,t.consequent,t.alternate];case"MemberExpression":return[t.object,t.property];case"ObjectExpression":return t.properties;case"Property":return[t.key,t.value];case"UnaryExpression":return[t.argument];case"Identifier":case"Literal":case"RawCode":default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};(rP={})[1]="Boolean",rP[2]="<end>",rP[3]="Identifier",rP[4]="Keyword",rP[5]="Null",rP[6]="Numeric",rP[7]="Punctuator",rP[8]="String",rP[9]="RegularExpression";var uP="ILLEGAL",cP=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),lP=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function dP(t,e){if(!t)throw new Error("ASSERT: "+e)}function fP(t){return t>=48&&t<=57}function hP(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function pP(t){return"01234567".indexOf(t)>=0}function mP(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function gP(t){return 10===t||13===t||8232===t||8233===t}function bP(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&cP.test(String.fromCharCode(t))}function yP(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&lP.test(String.fromCharCode(t))}var vP={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function xP(){for(var t;aP<oP&&(mP(t=iP.charCodeAt(aP))||gP(t));)++aP}function wP(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)aP<oP&&hP(iP[aP])?(r=iP[aP++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):RP({},"Unexpected token %0",uP);return String.fromCharCode(i)}function kP(){var t,e,n,r;for(e=0,"}"===(t=iP[aP])&&RP({},"Unexpected token %0",uP);aP<oP&&hP(t=iP[aP++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&RP({},"Unexpected token %0",uP),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function OP(){var t,e;for(t=iP.charCodeAt(aP++),e=String.fromCharCode(t),92===t&&(117!==iP.charCodeAt(aP)&&RP({},"Unexpected token %0",uP),++aP,(t=wP("u"))&&"\\"!==t&&bP(t.charCodeAt(0))||RP({},"Unexpected token %0",uP),e=t);aP<oP&&yP(t=iP.charCodeAt(aP));)++aP,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==iP.charCodeAt(aP)&&RP({},"Unexpected token %0",uP),++aP,(t=wP("u"))&&"\\"!==t&&yP(t.charCodeAt(0))||RP({},"Unexpected token %0",uP),e+=t);return e}function _P(){var t,e;return t=aP,{type:1===(e=92===iP.charCodeAt(aP)?OP():function(){var t,e;for(t=aP++;aP<oP;){if(92===(e=iP.charCodeAt(aP)))return aP=t,OP();if(!yP(e))break;++aP}return iP.slice(t,aP)}()).length?3:vP.hasOwnProperty(e)?4:"null"===e?5:"true"===e||"false"===e?1:3,value:e,start:t,end:aP}}function AP(){var t,e,n,r,i=aP,a=iP.charCodeAt(aP),o=iP[aP];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++aP,{type:7,value:String.fromCharCode(a),start:i,end:aP};default:if(61===(t=iP.charCodeAt(aP+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return aP+=2,{type:7,value:String.fromCharCode(a)+String.fromCharCode(t),start:i,end:aP};case 33:case 61:return aP+=2,61===iP.charCodeAt(aP)&&++aP,{type:7,value:iP.slice(i,aP),start:i,end:aP}}}return">>>="===(r=iP.substr(aP,4))?{type:7,value:r,start:i,end:aP+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:i,end:aP+=3}:o===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===e?{type:7,value:e,start:i,end:aP+=2}:"<>=!+-*%&|^/".indexOf(o)>=0?{type:7,value:o,start:i,end:++aP}:void RP({},"Unexpected token %0",uP)}function CP(){var t,e,n;if(dP(fP((n=iP[aP]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=aP,t="","."!==n){if(t=iP[aP++],n=iP[aP],"0"===t){if("x"===n||"X"===n)return++aP,function(t){for(var e="";aP<oP&&hP(iP[aP]);)e+=iP[aP++];return 0===e.length&&RP({},"Unexpected token %0",uP),bP(iP.charCodeAt(aP))&&RP({},"Unexpected token %0",uP),{type:6,value:parseInt("0x"+e,16),start:t,end:aP}}(e);if(pP(n))return function(t){for(var e="0"+iP[aP++];aP<oP&&pP(iP[aP]);)e+=iP[aP++];return(bP(iP.charCodeAt(aP))||fP(iP.charCodeAt(aP)))&&RP({},"Unexpected token %0",uP),{type:6,value:parseInt(e,8),octal:!0,start:t,end:aP}}(e);n&&fP(n.charCodeAt(0))&&RP({},"Unexpected token %0",uP)}for(;fP(iP.charCodeAt(aP));)t+=iP[aP++];n=iP[aP]}if("."===n){for(t+=iP[aP++];fP(iP.charCodeAt(aP));)t+=iP[aP++];n=iP[aP]}if("e"===n||"E"===n)if(t+=iP[aP++],"+"!==(n=iP[aP])&&"-"!==n||(t+=iP[aP++]),fP(iP.charCodeAt(aP)))for(;fP(iP.charCodeAt(aP));)t+=iP[aP++];else RP({},"Unexpected token %0",uP);return bP(iP.charCodeAt(aP))&&RP({},"Unexpected token %0",uP),{type:6,value:parseFloat(t),start:e,end:aP}}function EP(){var t,e,n,r;return sP=null,xP(),t=aP,e=function(){var t,e,n,r;for(dP("/"===(t=iP[aP]),"Regular expression literal must start with a slash"),e=iP[aP++],n=!1,r=!1;aP<oP;)if(e+=t=iP[aP++],"\\"===t)gP((t=iP[aP++]).charCodeAt(0))&&RP({},"Invalid regular expression: missing /"),e+=t;else if(gP(t.charCodeAt(0)))RP({},"Invalid regular expression: missing /");else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||RP({},"Invalid regular expression: missing /"),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";aP<oP&&yP((t=iP[aP]).charCodeAt(0));)++aP,"\\"===t&&aP<oP?RP({},"Unexpected token %0",uP):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&RP({},"Invalid regular expression",n),{value:n,literal:e}}(),r=function(t,e){var n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(t,e)=>{if(parseInt(e,16)<=1114111)return"x";RP({},"Invalid regular expression")}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(t){RP({},"Invalid regular expression")}try{return new RegExp(t,e)}catch(t){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:aP}}function SP(){var t;return xP(),aP>=oP?{type:2,start:aP,end:aP}:bP(t=iP.charCodeAt(aP))?_P():40===t||41===t||59===t?AP():39===t||34===t?function(){var t,e,n,r,i="",a=!1;for(dP("'"===(t=iP[aP])||'"'===t,"String literal must starts with a quote"),e=aP,++aP;aP<oP;){if((n=iP[aP++])===t){t="";break}if("\\"===n)if((n=iP[aP++])&&gP(n.charCodeAt(0)))"\r"===n&&"\n"===iP[aP]&&++aP;else switch(n){case"u":case"x":"{"===iP[aP]?(++aP,i+=kP()):i+=wP(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:pP(n)?(0!==(r="01234567".indexOf(n))&&(a=!0),aP<oP&&pP(iP[aP])&&(a=!0,r=8*r+"01234567".indexOf(iP[aP++]),"0123".indexOf(n)>=0&&aP<oP&&pP(iP[aP])&&(r=8*r+"01234567".indexOf(iP[aP++]))),i+=String.fromCharCode(r)):i+=n}else{if(gP(n.charCodeAt(0)))break;i+=n}}return""!==t&&RP({},"Unexpected token %0",uP),{type:8,value:i,octal:a,start:e,end:aP}}():46===t?fP(iP.charCodeAt(aP+1))?CP():AP():fP(t)?CP():AP()}function jP(){var t;return aP=(t=sP).end,sP=SP(),aP=t.end,t}function NP(){var t;t=aP,sP=SP(),aP=t}function TP(t,e,n){var r=new nP("||"===t||"&&"===t?"LogicalExpression":"BinaryExpression");return r.operator=t,r.left=e,r.right=n,r}function FP(t,e){var n=new nP("CallExpression");return n.callee=t,n.arguments=e,n}function DP(t){var e=new nP("Identifier");return e.name=t,e}function IP(t){var e=new nP("Literal");return e.value=t.value,e.raw=iP.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function MP(t,e,n){var r=new nP("MemberExpression");return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function $P(t,e,n){var r=new nP("Property");return r.key=e,r.value=n,r.kind=t,r}function RP(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,(t,e)=>(dP(e<r.length,"Message reference must be in range"),r[e]));throw(n=new Error(i)).index=aP,n.description=i,n}function BP(t){2===t.type&&RP(t,"Unexpected end of input"),6===t.type&&RP(t,"Unexpected number"),8===t.type&&RP(t,"Unexpected string"),3===t.type&&RP(t,"Unexpected identifier"),4===t.type&&RP(t,"Unexpected reserved word"),RP(t,"Unexpected token %0",t.value)}function zP(t){var e=jP();7===e.type&&e.value===t||BP(e)}function LP(t){return 7===sP.type&&sP.value===t}function PP(t){return 4===sP.type&&sP.value===t}function qP(){var t=[];for(aP=sP.start,zP("[");!LP("]");)LP(",")?(jP(),t.push(null)):(t.push(tq()),LP("]")||zP(","));return jP(),function(t){var e=new nP("ArrayExpression");return e.elements=t,e}(t)}function WP(){var t;return aP=sP.start,8===(t=jP()).type||6===t.type?(t.octal&&RP(t,"Octal literals are not allowed in strict mode."),IP(t)):DP(t.value)}function UP(){var t,e,n;return aP=sP.start,3===(t=sP).type?(n=WP(),zP(":"),$P("init",n,tq())):2!==t.type&&7!==t.type?(e=WP(),zP(":"),$P("init",e,tq())):void BP(t)}function VP(){var t,e,n=[],r={},i=String;for(aP=sP.start,zP("{");!LP("}");)e="$"+("Identifier"===(t=UP()).key.type?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?RP({},"Duplicate data property in object literal not allowed in strict mode"):r[e]=!0,n.push(t),LP("}")||zP(",");return zP("}"),function(t){var e=new nP("ObjectExpression");return e.properties=t,e}(n)}var GP={if:1};function HP(){var t,e,n;if(LP("("))return function(){var t;return zP("("),t=eq(),zP(")"),t}();if(LP("["))return qP();if(LP("{"))return VP();if(t=sP.type,aP=sP.start,3===t||GP[sP.value])n=DP(jP().value);else if(8===t||6===t)sP.octal&&RP(sP,"Octal literals are not allowed in strict mode."),n=IP(jP());else{if(4===t)throw new Error("Disabled.");1===t?((e=jP()).value="true"===e.value,n=IP(e)):5===t?((e=jP()).value=null,n=IP(e)):LP("/")||LP("/=")?(n=IP(EP()),NP()):BP(jP())}return n}function XP(){var t=[];if(zP("("),!LP(")"))for(;aP<oP&&(t.push(tq()),!LP(")"));)zP(",");return zP(")"),t}function KP(){return zP("."),aP=sP.start,function(t){return 3===t.type||4===t.type||1===t.type||5===t.type}(t=jP())||BP(t),DP(t.value);var t}function YP(){var t;return zP("["),t=eq(),zP("]"),t}function JP(){var t=function(){var t;for(t=HP();;)if(LP("."))t=MP(".",t,KP());else if(LP("("))t=FP(t,XP());else{if(!LP("["))break;t=MP("[",t,YP())}return t}();if(7===sP.type&&(LP("++")||LP("--")))throw new Error("Disabled.");return t}function ZP(){var t,e,n,r,i;if(7!==sP.type&&4!==sP.type)e=JP();else{if(LP("++")||LP("--"))throw new Error("Disabled.");if(LP("+")||LP("-")||LP("~")||LP("!"))t=jP(),e=ZP(),n=t.value,r=e,(i=new nP("UnaryExpression")).operator=n,i.argument=r,i.prefix=!0,e=i;else{if(PP("delete")||PP("void")||PP("typeof"))throw new Error("Disabled.");e=JP()}}return e}function QP(t){var e=0;if(7!==t.type&&4!==t.type)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function tq(){var t,e;return t=function(){var t,e,n,r,i,a,o,s,u,c;if(t=sP,u=ZP(),0===(i=QP(r=sP)))return u;for(r.prec=i,jP(),e=[t,sP],a=[u,r,o=ZP()];(i=QP(sP))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,u=a.pop(),e.pop(),n=TP(s,u,o),a.push(n);(r=jP()).prec=i,a.push(r),e.push(sP),n=ZP(),a.push(n)}for(n=a[c=a.length-1],e.pop();c>1;)e.pop(),n=TP(a[c-1].value,a[c-2],n),c-=2;return n}(),LP("?")&&(jP(),e=tq(),zP(":"),t=function(t,e,n){var r=new nP("ConditionalExpression");return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,tq())),t}function eq(){var t=tq();if(LP(","))throw new Error("Disabled.");return t}var nq={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"},rq=function(t){function e(e,n,r){return i=>function(e,n,r,i){let a=t(n[0]);return r&&(a=r+"("+a+")",0===r.lastIndexOf("new ",0)&&(a="("+a+")")),a+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}const n="new Date";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&bL("Missing arguments to clamp function."),e.length>3&&bL("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),join:e("join",null),indexof:e("indexOf",null),lastindexof:e("lastIndexOf",null),slice:e("slice",null),reverse:function(e){return"("+t(e[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase","String",0),lower:e("toLowerCase","String",0),substring:e("substring","String"),split:e("split","String"),replace:e("replace","String"),trim:e("trim","String",0),regexp:"RegExp",test:e("test","RegExp"),if:function(e){e.length<3&&bL("Missing arguments to if function."),e.length>3&&bL("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}};function iq(t,e,n,r){"Literal"!==e[0].type&&bL("First argument to data functions must be a string literal.");const i=e[0].value,a=":"+i;if(!RL(a,r))try{r[a]=n.getData(i).tuplesRef()}catch(t){}}function aq(t,e,n,r){if("Literal"===e[0].type)oq(n,r,e[0].value);else for(t in n.scales)oq(n,r,t)}function oq(t,e,n){const r="%"+n;if(!RL(e,r))try{e[r]=t.scaleRef(n)}catch(t){}}function sq(t,e){let n;return IL(t)?t:PL(t)?(n=e.scales[t])&&n.value:void 0}function uq(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,n._bandwidth=aq,n._range=aq,n._scale=aq;const r=e=>"_["+("Literal"===e.type?UL("%"+e.value):UL("%")+"+"+t(e))+"]";return{_bandwidth:t=>`this.__bandwidth(${r(t[0])})`,_range:t=>r(t[0])+".range()",_scale:e=>`${r(e[0])}(${t(e[1])})`}}var cq,lq,dq,fq,hq,pq=new jy,mq=new jy,gq={point:Jy,lineStart:Jy,lineEnd:Jy,polygonStart:function(){pq=new jy,gq.lineStart=bq,gq.lineEnd=yq},polygonEnd:function(){var t=+pq;mq.add(t<0?Dy+t:t),this.lineStart=this.lineEnd=this.point=Jy},sphere:function(){mq.add(Dy)}};function bq(){gq.point=vq}function yq(){xq(cq,lq)}function vq(t,e){gq.point=xq,cq=t,lq=e,dq=t*=My,fq=zy(e=(e*=My)/2+Fy),hq=Vy(e)}function xq(t,e){var n=(t*=My)-dq,r=n>=0?1:-1,i=r*n,a=zy(e=(e*=My)/2+Fy),o=Vy(e),s=hq*o,u=fq*a+s*zy(i),c=s*r*Vy(i);pq.add(By(c,u)),dq=t,fq=a,hq=o}var wq,kq,Oq,_q,Aq,Cq,Eq,Sq,jq,Nq,Tq,Fq={point:Dq,lineStart:Mq,lineEnd:$q,polygonStart:function(){Fq.point=Rq,Fq.lineStart=Bq,Fq.lineEnd=zq,jq=new jy,gq.polygonStart()},polygonEnd:function(){gq.polygonEnd(),Fq.point=Dq,Fq.lineStart=Mq,Fq.lineEnd=$q,pq<0?(wq=-(Oq=180),kq=-(_q=90)):jq>1e-6?_q=90:jq<-1e-6&&(kq=-90),Tq[0]=wq,Tq[1]=Oq},sphere:function(){wq=-(Oq=180),kq=-(_q=90)}};function Dq(t,e){Nq.push(Tq=[wq=t,Oq=t]),e<kq&&(kq=e),e>_q&&(_q=e)}function Iq(t,e){var n=ax([t*My,e*My]);if(Sq){var r=sx(Sq,n),i=sx([r[1],-r[0],0],r);lx(i),i=ix(i);var a,o=t-Aq,s=o>0?1:-1,u=i[0]*Iy*s,c=$y(o)>180;c^(s*Aq<u&&u<s*t)?(a=i[1]*Iy)>_q&&(_q=a):c^(s*Aq<(u=(u+360)%360-180)&&u<s*t)?(a=-i[1]*Iy)<kq&&(kq=a):(e<kq&&(kq=e),e>_q&&(_q=e)),c?t<Aq?Lq(wq,t)>Lq(wq,Oq)&&(Oq=t):Lq(t,Oq)>Lq(wq,Oq)&&(wq=t):Oq>=wq?(t<wq&&(wq=t),t>Oq&&(Oq=t)):t>Aq?Lq(wq,t)>Lq(wq,Oq)&&(Oq=t):Lq(t,Oq)>Lq(wq,Oq)&&(wq=t)}else Nq.push(Tq=[wq=t,Oq=t]);e<kq&&(kq=e),e>_q&&(_q=e),Sq=n,Aq=t}function Mq(){Fq.point=Iq}function $q(){Tq[0]=wq,Tq[1]=Oq,Fq.point=Dq,Sq=null}function Rq(t,e){if(Sq){var n=t-Aq;jq.add($y(n)>180?n+(n>0?360:-360):n)}else Cq=t,Eq=e;gq.point(t,e),Iq(t,e)}function Bq(){gq.lineStart()}function zq(){Rq(Cq,Eq),gq.lineEnd(),$y(jq)>1e-6&&(wq=-(Oq=180)),Tq[0]=wq,Tq[1]=Oq,Sq=null}function Lq(t,e){return(e-=t)<0?e+360:e}function Pq(t,e){return t[0]-e[0]}function qq(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var Wq,Uq,Vq,Gq,Hq,Xq,Kq,Yq,Jq,Zq,Qq,tW,eW,nW,rW,iW,aW={sphere:Jy,point:oW,lineStart:uW,lineEnd:dW,polygonStart:function(){aW.lineStart=fW,aW.lineEnd=hW},polygonEnd:function(){aW.lineStart=uW,aW.lineEnd=dW}};function oW(t,e){t*=My;var n=zy(e*=My);sW(n*zy(t),n*Vy(t),Vy(e))}function sW(t,e,n){++Wq,Vq+=(t-Vq)/Wq,Gq+=(e-Gq)/Wq,Hq+=(n-Hq)/Wq}function uW(){aW.point=cW}function cW(t,e){t*=My;var n=zy(e*=My);nW=n*zy(t),rW=n*Vy(t),iW=Vy(e),aW.point=lW,sW(nW,rW,iW)}function lW(t,e){t*=My;var n=zy(e*=My),r=n*zy(t),i=n*Vy(t),a=Vy(e),o=By(Hy((o=rW*a-iW*i)*o+(o=iW*r-nW*a)*o+(o=nW*i-rW*r)*o),nW*r+rW*i+iW*a);Uq+=o,Xq+=o*(nW+(nW=r)),Kq+=o*(rW+(rW=i)),Yq+=o*(iW+(iW=a)),sW(nW,rW,iW)}function dW(){aW.point=oW}function fW(){aW.point=pW}function hW(){mW(tW,eW),aW.point=oW}function pW(t,e){tW=t,eW=e,t*=My,e*=My,aW.point=mW;var n=zy(e);nW=n*zy(t),rW=n*Vy(t),iW=Vy(e),sW(nW,rW,iW)}function mW(t,e){t*=My;var n=zy(e*=My),r=n*zy(t),i=n*Vy(t),a=Vy(e),o=rW*a-iW*i,s=iW*r-nW*a,u=nW*i-rW*r,c=qy(o,s,u),l=Yy(c),d=c&&-l/c;Jq.add(d*o),Zq.add(d*s),Qq.add(d*u),Uq+=l,Xq+=l*(nW+(nW=r)),Kq+=l*(rW+(rW=i)),Yq+=l*(iW+(iW=a)),sW(nW,rW,iW)}function gW(t,e){return function(n,r,i){if(n){const e=sq(n,(i||this).context);return e&&e.path[t](r)}return e(r)}}const bW=gW("area",(function(t){return mq=new jy,Sy(t,gq),2*mq})),yW=gW("bounds",(function(t){var e,n,r,i,a,o,s;if(_q=Oq=-(wq=kq=1/0),Nq=[],Sy(t,Fq),n=Nq.length){for(Nq.sort(Pq),e=1,a=[r=Nq[0]];e<n;++e)qq(r,(i=Nq[e])[0])||qq(r,i[1])?(Lq(r[0],i[1])>Lq(r[0],r[1])&&(r[1]=i[1]),Lq(i[0],r[1])>Lq(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,e=0,r=a[n=a.length-1];e<=n;r=i,++e)i=a[e],(s=Lq(r[1],i[0]))>o&&(o=s,wq=i[0],Oq=r[1])}return Nq=Tq=null,wq===1/0||kq===1/0?[[NaN,NaN],[NaN,NaN]]:[[wq,kq],[Oq,_q]]})),vW=gW("centroid",(function(t){Wq=Uq=Vq=Gq=Hq=Xq=Kq=Yq=0,Jq=new jy,Zq=new jy,Qq=new jy,Sy(t,aW);var e=+Jq,n=+Zq,r=+Qq,i=qy(e,n,r);return i<1e-12&&(e=Xq,n=Kq,r=Yq,Uq<1e-6&&(e=Vq,n=Gq,r=Hq),(i=qy(e,n,r))<1e-12)?[NaN,NaN]:[By(n,e)*Iy,Yy(r/i)*Iy]}));function xW(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(e){t.warn(e)}return n[n.length-1]}function wW(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function kW(t){const e=wu(t);return.2126*wW(e.r)+.7152*wW(e.g)+.0722*wW(e.b)}function OW(t,e){return t===e||t!=t&&e!=e||(kL(t)?!(!kL(e)||t.length!==e.length)&&function(t,e){for(let n=0,r=t.length;n<r;++n)if(!OW(t[n],e[n]))return!1;return!0}(t,e):!(!OL(t)||!OL(e))&&_W(t,e))}function _W(t,e){for(const n in t)if(!OW(t[n],e[n]))return!1;return!0}function AW(t){return e=>_W(t,e)}function CW(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}function EW(){const t=Js().unknown(void 0),e=t.domain,n=t.range;let r,i,a=[0,1],o=!1,s=0,u=0,c=.5;function l(){const t=e().length,l=a[1]<a[0],d=a[1-l],f=CW(t,s,u);let h=a[l-0];r=(d-h)/(f||1),o&&(r=Math.floor(r)),h+=(d-h-r*(t-s))*c,i=r*(1-s),o&&(h=Math.round(h),i=Math.round(i));const p=ki(t).map(t=>h+r*t);return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},t.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(o=!!t,l()):o},t.padding=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),s=u,l()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},t.paddingOuter=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=a[1]<a[0],o=r?n().reverse():n(),s=o.length-1;let u,c,l,d=+t[0],f=+t[1];return d!=d||f!=f||(f<d&&(l=d,d=f,f=l),f<o[0]||d>a[1-r])?void 0:(u=Math.max(0,Vs(o,d)-1),c=d===f?u:Vs(o,f)-1,d-o[u]>i+1e-10&&++u,r&&(l=u,u=s-c,c=s-l),u>c?void 0:e().slice(u,c+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return EW().domain(e()).range(a).round(o).paddingInner(s).paddingOuter(u).align(c)},l()}var SW=Array.prototype.map;function jW(t){return SW.call(t,AL)}const NW=Array.prototype.slice;const TW={};function FW(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,a,o,s=e[0],u=e[1],c=-1;for(u<s&&(i=s,s=u,u=i),a=0,o=n.length;a<o;++a)n[a]>=s&&n[a]<=u&&(c<0&&(c=a),r=a);if(!(c<0))return s=t.invertExtent(n[c]),u=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=t,n};return r.metadata=GL(DL(n)),r}function DW(t,e,n){return arguments.length>1?(TW[t]=FW(t,e,n),this):IW(t)?TW[t]:void 0}function IW(t){return RL(TW,t)}function MW(t,e){const n=TW[t];return n&&n.metadata[e]}function $W(t){return MW(t,"discrete")}DW("identity",fc),DW("linear",dc,"continuous"),DW("log",wc,["continuous","log"]),DW("pow",Cc,"continuous"),DW("sqrt",Ec,"continuous"),DW("symlog",Tc,"continuous"),DW("time",Uc,["continuous","temporal"]),DW("utc",Jc,["continuous","temporal"]),DW("sequential",tl,["continuous","interpolating"]),DW("".concat("sequential","-").concat("linear"),tl,["continuous","interpolating"]),DW("".concat("sequential","-").concat("log"),el,["continuous","interpolating","log"]),DW("".concat("sequential","-").concat("pow"),rl,["continuous","interpolating"]),DW("".concat("sequential","-").concat("sqrt"),il,["continuous","interpolating"]),DW("".concat("sequential","-").concat("symlog"),nl,["continuous","interpolating"]),DW("".concat("diverging","-").concat("linear"),sl,["continuous","interpolating"]),DW("".concat("diverging","-").concat("log"),ul,["continuous","interpolating","log"]),DW("".concat("diverging","-").concat("pow"),ll,["continuous","interpolating"]),DW("".concat("diverging","-").concat("sqrt"),dl,["continuous","interpolating"]),DW("".concat("diverging","-").concat("symlog"),cl,["continuous","interpolating"]),DW("quantile",fl,["discretizing","quantile"]),DW("quantize",hl,"discretizing"),DW("threshold",pl,"discretizing"),DW("bin-ordinal",(function t(){let e=[],n=[];function r(t){return null==t||t!=t?void 0:n[(Hs(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=jW(t),r):e.slice()},r.range=function(t){return arguments.length?(n=NW.call(t),r):n.slice()},r.tickFormat=function(t,n){return tu(e[0],_L(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),["discrete","discretizing"]),DW("ordinal",Js,"discrete"),DW("band",EW,"discrete"),DW("point",(function(){return function t(e){const n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return t(n())},e}(EW().paddingInner(1))}),"discrete");const RW=["clamp","base","constant","exponent"];function BW(t,e,n){return al(function(t,e){const n=o[function(t){return"interpolate"+t.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}(e||"rgb",n),t)}function zW(t,e,n){const r=n-e;let i,a,o;return r&&Number.isFinite(r)?(i=(a=t.type).indexOf("-"),a=i<0?a:a.slice(i+1),o=DW(a)().domain([e,n]).range([0,1]),RW.forEach(e=>t[e]?o[e](t[e]()):0),o):IL(s=.5)?s:()=>s;var s}function LW(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function PW(t,e){for(const n in t)WW(n,e(t[n]))}const qW={};function WW(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(qW[t]=e,this):qW[t]}PW({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},LW),PW({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},t=>BW(LW(t)));const UW=t=>kL(t)?t.map(t=>String(t)):String(t),VW=(t,e)=>t[1]-e[1],GW=(t,e)=>e[1]-t[1];function HW(t,e){return t.bins?function(t,e,n){let r=t.range(),i=r[0],a=_L(r),o=VW;if(i>a&&(r=a,a=i,i=r,o=GW),i=Math.floor(i),a=Math.ceil(a),e=e.map(e=>[e,t(e)]).filter(t=>i<=t[1]&&t[1]<=a).sort(o).map(t=>t[0]),n>0&&e.length>1){const t=[e[0],_L(e)];for(;e.length>n&&e.length>=3;)e=e.filter((t,e)=>!(e%2));e.length<3&&(e=t)}return e}(t,t.bins):t.ticks?t.ticks(e):t.domain()}function XW(t,e,n,r,i,a){const o=e.type;let s=UW;if("time"===o||"time"===i)s=t.timeFormat(r);else if("utc"===o||"utc"===i)s=t.utcFormat(r);else if(MW(o,"log")){const i=t.formatFloat(r);if(a||e.bins)s=i;else{const t=KW(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function KW(t,e,n){const r=HW(t,e),i=t.base(),a=Math.log(i),o=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/a));return e*i<i-.5&&(e*=i),e<=o};return n?r.filter(s):s}const YW={quantile:"quantiles",quantize:"thresholds",threshold:"domain"},JW={quantile:"quantiles",quantize:"domain"};function ZW(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=_L(t),e}(t.bins):"log"===t.type?KW(t,e,!0):YW[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[YW[t.type]]()):HW(t,e)}function QW(t,e,n,r,i,a,o){const s=JW[e.type]&&"time"!==a&&"utc"!==a?function(t,e,n){const r=e[JW[e.type]](),i=r.length;let a,o=i>1?r[1]-r[0]:r[0];for(a=1;a<i;++a)o=Math.min(o,r[a]-r[a-1]);return t.formatSpan(0,o,30,n)}(t,e,i):XW(t,e,n,i,a,o);return"symbol"===r&&(t=>YW[t.type]||t.bins)(e)?tU(s):"discrete"===r?nU(s):rU(s)}const tU=t=>(e,n,r)=>{const i=eU(r[n+1],eU(r.max,1/0)),a=iU(e,t),o=iU(i,t);return a&&o?a+"  "+o:o?"< "+o:" "+a},eU=(t,e)=>null!=t?t:e,nU=t=>(e,n)=>n?t(e):null,rU=t=>e=>t(e),iU=(t,e)=>Number.isFinite(t)?e(t):null;function aU(t,e,n,r){const i=r||e.type;return PL(n)&&MW(i,"temporal")&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||"time"!==i?n||"utc"!==i?QW(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function oU(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=aU(t,e,n.format,n.formatType);if(MW(e.type,"discretizing")){const t=ZW(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if($W(e.type)){const t=e.domain(),n=t.length,a=n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ");return"".concat(n," value").concat(1===n?"":"s",": ").concat(a)}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i(_L(t)))}}let sU=0;function uU(t){return t&&t.gradient}function cU(t,e,n){const r=t.gradient;let i=t.id,a="radial"===r?"p_":"";return i||(i=t.id="gradient_"+sU++,"radial"===r?(t.x1=lU(t.x1,.5),t.y1=lU(t.y1,.5),t.r1=lU(t.r1,0),t.x2=lU(t.x2,.5),t.y2=lU(t.y2,.5),t.r2=lU(t.r2,.5),a="p_"):(t.x1=lU(t.x1,0),t.y1=lU(t.y1,0),t.x2=lU(t.x2,1),t.y2=lU(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+a+i+")"}function lU(t,e){return null!=t?t:e}const dU={basis:{curve:vo},"basis-closed":{curve:ko},"basis-open":{curve:_o},bundle:{curve:Co,tension:"beta",value:.85},cardinal:{curve:jo,tension:"tension",value:0},"cardinal-open":{curve:To,tension:"tension",value:0},"cardinal-closed":{curve:Do,tension:"tension",value:0},"catmull-rom":{curve:Xo,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Yo,tension:"alpha",value:.5},"catmull-rom-open":{curve:Zo,tension:"alpha",value:.5},linear:{curve:ts},"linear-closed":{curve:ns},monotone:{horizontal:ds,vertical:ls},natural:{curve:ps},step:{curve:gs},"step-after":{curve:ys},"step-before":{curve:bs}};function fU(t,e,n){var r=RL(dU,t)&&dU[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const hU={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},pU=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function mU(t){const e=[];let n,r,i,a,o,s,u,c,l,d;const f=t.slice().replace(pU[0],"###$1").split(pU[1]).slice(1);for(u=0,l=f.length;u<l;++u){for(n=f[u],r=n.slice(1).trim().replace(pU[2],"$1###$2").replace(pU[3],"$1###$2").split(pU[4]),o=n.charAt(0),i=[o],c=0,d=r.length;c<d;++c)(a=+r[c])===a&&i.push(a);if(s=hU[o.toLowerCase()],i.length-1>s){const t=i.length;for(c=1,e.push([o].concat(i.slice(c,c+=s))),o="M"===o?"L":"m"===o?"l":o;c<t;c+=s)e.push([o].concat(i.slice(c,c+s)))}else e.push(i)}return e}const gU=Math.PI/180,bU=Math.PI/2,yU=2*Math.PI,vU=Math.sqrt(3)/2;var xU={},wU={},kU=[].join;function OU(t){const e=kU.call(t);if(wU[e])return wU[e];var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7];const l=c*o,d=-u*s,f=u*o,h=c*s,p=Math.cos(i),m=Math.sin(i),g=Math.cos(a),b=Math.sin(a),y=.5*(a-i),v=Math.sin(.5*y),x=8/3*v*v/Math.sin(y),w=n+p-x*m,k=r+m+x*p,O=n+g,_=r+b,A=O+x*b,C=_-x*g;return wU[e]=[l*w+d*k,f*w+h*k,l*A+d*C,f*A+h*C,l*O+d*_,f*O+h*_]}const _U=["l",0,0,0,0,0,0,0];function AU(t,e,n){const r=_U[0]=t[0];if("a"===r||"A"===r)_U[1]=e*t[1],_U[2]=n*t[2],_U[3]=t[3],_U[4]=t[4],_U[5]=t[5],_U[6]=e*t[6],_U[7]=n*t[7];else if("h"===r||"H"===r)_U[1]=e*t[1];else if("v"===r||"V"===r)_U[1]=n*t[1];else for(var i=1,a=t.length;i<a;++i)_U[i]=(i%2==1?e:n)*t[i];return _U}function CU(t,e,n,r,i,a){var o,s,u,c,l,d=null,f=0,h=0,p=0,m=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==a&&(a=i),t.beginPath&&t.beginPath();for(var g=0,b=e.length;g<b;++g){switch(o=e[g],1===i&&1===a||(o=AU(o,i,a)),o[0]){case"l":f+=o[1],h+=o[2],t.lineTo(f+n,h+r);break;case"L":f=o[1],h=o[2],t.lineTo(f+n,h+r);break;case"h":f+=o[1],t.lineTo(f+n,h+r);break;case"H":f=o[1],t.lineTo(f+n,h+r);break;case"v":h+=o[1],t.lineTo(f+n,h+r);break;case"V":h=o[1],t.lineTo(f+n,h+r);break;case"m":f+=o[1],h+=o[2],t.moveTo(f+n,h+r);break;case"M":f=o[1],h=o[2],t.moveTo(f+n,h+r);break;case"c":s=f+o[5],u=h+o[6],p=f+o[3],m=h+o[4],t.bezierCurveTo(f+o[1]+n,h+o[2]+r,p+n,m+r,s+n,u+r),f=s,h=u;break;case"C":f=o[5],h=o[6],p=o[3],m=o[4],t.bezierCurveTo(o[1]+n,o[2]+r,p+n,m+r,f+n,h+r);break;case"s":s=f+o[3],u=h+o[4],p=2*f-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,f+o[1]+n,h+o[2]+r,s+n,u+r),p=f+o[1],m=h+o[2],f=s,h=u;break;case"S":s=o[3],u=o[4],p=2*f-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,o[1]+n,o[2]+r,s+n,u+r),f=s,h=u,p=o[1],m=o[2];break;case"q":s=f+o[3],u=h+o[4],p=f+o[1],m=h+o[2],t.quadraticCurveTo(p+n,m+r,s+n,u+r),f=s,h=u;break;case"Q":s=o[3],u=o[4],t.quadraticCurveTo(o[1]+n,o[2]+r,s+n,u+r),f=s,h=u,p=o[1],m=o[2];break;case"t":s=f+o[1],u=h+o[2],null===d[0].match(/[QqTt]/)?(p=f,m=h):"t"===d[0]?(p=2*f-c,m=2*h-l):"q"===d[0]&&(p=2*f-p,m=2*h-m),c=p,l=m,t.quadraticCurveTo(p+n,m+r,s+n,u+r),h=u,p=(f=s)+o[1],m=h+o[2];break;case"T":s=o[1],u=o[2],p=2*f-p,m=2*h-m,t.quadraticCurveTo(p+n,m+r,s+n,u+r),f=s,h=u;break;case"a":EU(t,f+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+f+n,o[7]+h+r]),f+=o[6],h+=o[7];break;case"A":EU(t,f+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),f=o[6],h=o[7];break;case"z":case"Z":t.closePath()}d=o}}function EU(t,e,n,r){const i=function(t,e,n,r,i,a,o,s,u){const c=kU.call(arguments);if(xU[c])return xU[c];const l=o*gU,d=Math.sin(l),f=Math.cos(l),h=f*(s-t)*.5+d*(u-e)*.5,p=f*(u-e)*.5-d*(s-t)*.5;let m=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(m=Math.sqrt(m),n*=m,r*=m);const g=f/n,b=d/n,y=-d/r,v=f/r,x=g*s+b*u,w=y*s+v*u,k=g*t+b*e,O=y*t+v*e,_=(k-x)*(k-x)+(O-w)*(O-w);let A=1/_-.25;A<0&&(A=0);let C=Math.sqrt(A);a==i&&(C=-C);const E=.5*(x+k)-C*(O-w),S=.5*(w+O)+C*(k-x),j=Math.atan2(w-S,x-E),N=Math.atan2(O-S,k-E);let T=N-j;T<0&&1===a?T+=yU:T>0&&0===a&&(T-=yU);const F=Math.ceil(Math.abs(T/(bU+.001))),D=[];for(let t=0;t<F;++t){const e=j+t*T/F,i=j+(t+1)*T/F;D[t]=[E,S,e,i,n,r,d,f]}return xU[c]=D}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let e=0;e<i.length;++e){const n=OU(i[e]);t.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5])}}const SU={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,yU)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,a=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-a),t.lineTo(i,-a),t.lineTo(0,-n),t.lineTo(-i,-a),t.lineTo(-r,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=vU*n,i=r-.5773502691896257*n,a=n/4;t.moveTo(0,-r-i),t.lineTo(-a,r-i),t.lineTo(a,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=vU*n,i=r-.5773502691896257*n;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=vU*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=vU*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=vU*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=vU*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function jU(t){return RL(SU,t)?SU[t]:function(t){if(!RL(NU,t)){const e=mU(t);NU[t]={draw:function(t,n){CU(t,e,0,0,Math.sqrt(n)/2)}}}return NU[t]}(t)}var NU={};function TU(t){return t.x}function FU(t){return t.y}function DU(t){return t.width}function IU(t){return t.height}function MU(t){return"function"==typeof t?t:()=>+t}function $U(t,e,n){return Math.max(e,Math.min(t,n))}function RU(t,e){return null!=t?t:e}const BU=t=>t.x||0,zU=t=>t.y||0,LU=t=>!(!1===t.defined),PU=Ds().startAngle(t=>t.startAngle||0).endAngle(t=>t.endAngle||0).padAngle(t=>t.padAngle||0).innerRadius(t=>t.innerRadius||0).outerRadius(t=>t.outerRadius||0).cornerRadius(t=>t.cornerRadius||0),qU=Bs().x(BU).y1(zU).y0(t=>(t.y||0)+(t.height||0)).defined(LU),WU=Bs().y(zU).x1(BU).x0(t=>(t.x||0)+(t.width||0)).defined(LU),UU=Rs().x(BU).y(zU).defined(LU),VU=function(){var t=TU,e=FU,n=DU,r=IU,i=MU(0),a=i,o=i,s=i,u=null;function c(c,l,d){var f,h=null!=l?l:+t.call(this,c),p=null!=d?d:+e.call(this,c),m=+n.call(this,c),g=+r.call(this,c),b=Math.min(m,g)/2,y=$U(+i.call(this,c),0,b),v=$U(+a.call(this,c),0,b),x=$U(+o.call(this,c),0,b),w=$U(+s.call(this,c),0,b);if(u||(u=f=_s()),y<=0&&v<=0&&x<=0&&w<=0)u.rect(h,p,m,g);else{var k=h+m,O=p+g;u.moveTo(h+y,p),u.lineTo(k-v,p),u.bezierCurveTo(k-.448084975506*v,p,k,p+.448084975506*v,k,p+v),u.lineTo(k,O-w),u.bezierCurveTo(k,O-.448084975506*w,k-.448084975506*w,O,k-w,O),u.lineTo(h+x,O),u.bezierCurveTo(h+.448084975506*x,O,h,O-.448084975506*x,h,O-x),u.lineTo(h,p+y),u.bezierCurveTo(h,p+.448084975506*y,h+.448084975506*y,p,h+y,p),u.closePath()}if(f)return u=null,f+""||null}return c.x=function(e){return arguments.length?(t=MU(e),c):t},c.y=function(t){return arguments.length?(e=MU(t),c):e},c.width=function(t){return arguments.length?(n=MU(t),c):n},c.height=function(t){return arguments.length?(r=MU(t),c):r},c.cornerRadius=function(t,e,n,r){return arguments.length?(i=MU(t),a=null!=e?MU(e):i,s=null!=n?MU(n):i,o=null!=r?MU(r):a,c):i},c.context=function(t){return arguments.length?(u=null==t?null:t,c):u},c}().x(BU).y(zU).width(t=>t.width||0).height(t=>t.height||0).cornerRadius(t=>RU(t.cornerRadiusTopLeft,t.cornerRadius)||0,t=>RU(t.cornerRadiusTopRight,t.cornerRadius)||0,t=>RU(t.cornerRadiusBottomRight,t.cornerRadius)||0,t=>RU(t.cornerRadiusBottomLeft,t.cornerRadius)||0),GU=Ps().type(t=>jU(t.shape||"circle")).size(t=>RU(t.size,64)),HU=function(){var t,e,n,r,i,a,o,s,u=null;function c(t,e,n){const r=n/2;if(i){var c=o-e,l=t-a;if(c||l){var d=Math.sqrt(c*c+l*l),f=(c/=d)*s,h=(l/=d)*s,p=Math.atan2(l,c);u.moveTo(a-f,o-h),u.lineTo(t-c*r,e-l*r),u.arc(t,e,r,p-Math.PI,p),u.lineTo(a+f,o+h),u.arc(a,o,s,p,p+Math.PI)}else u.arc(t,e,r,0,yU);u.closePath()}else i=1;a=t,o=e,s=r}function l(a){var o,s,l,d=a.length,f=!1;for(null==u&&(u=l=_s()),o=0;o<=d;++o)!(o<d&&r(s=a[o],o,a))===f&&(f=!f)&&(i=0),f&&c(+t(s,o,a),+e(s,o,a),+n(s,o,a));if(l)return u=null,l+""||null}return l.x=function(e){return arguments.length?(t=e,l):t},l.y=function(t){return arguments.length?(e=t,l):e},l.size=function(t){return arguments.length?(n=t,l):n},l.defined=function(t){return arguments.length?(r=t,l):r},l.context=function(t){return arguments.length?(u=null==t?null:t,l):u},l}().x(BU).y(zU).defined(LU).size(t=>t.size||1);function XU(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function KU(t,e,n,r){return VU.context(t)(e,n,r)}var YU=1;function JU(t,e,n){var r=e.clip,i=t._defs,a=e.clip_id||(e.clip_id="clip"+YU++),o=i.clipping[a]||(i.clipping[a]={id:a});return IL(r)?o.path=r(null):XU(n)?o.path=KU(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function ZU(t){this.clear(),t&&this.union(t)}function QU(t){this.mark=t,this.bounds=this.bounds||new ZU}function tV(t){QU.call(this,t),this.items=this.items||[]}function eV(t){this._pending=0,this._loader=t||Object(en.e)()}function nV(t){t._pending+=1}function rV(t){t._pending-=1}function iV(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}ZU.prototype={clone(){return new ZU(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(t),u=Math.sin(t),c=e-e*s+n*u,l=n-e*u-n*s;return[s*r-u*i+c,u*r+s*i+l,s*r-u*o+c,u*r+s*o+l,s*a-u*i+c,u*a+s*i+l,s*a-u*o+c,u*a+s*o+l]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},BL(tV,QU),eV.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return nV(e),e._loader.sanitize(t,{context:"href"}).then(t=>(rV(e),t)).catch(()=>(rV(e),null))},loadImage(t){const e=this,n=Ws();return nV(e),e._loader.sanitize(t,{context:"image"}).then(t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,a=RL(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=a&&(i.crossOrigin=a),i.onload=()=>rV(e),i.onerror=()=>rV(e),i.src=r,i}).catch(t=>(rV(e),{complete:!1,width:0,height:0,src:t&&t.url||""}))},ready(){const t=this;return new Promise(e=>{!function n(r){t.pending()?setTimeout(()=>{n(!0)},10):e(r)}(!1)})}};const aV=yU-1e-8;let oV,sV,uV,cV,lV,dV,fV,hV;const pV=(t,e)=>oV.add(t,e),mV=(t,e)=>pV(sV=t,uV=e),gV=t=>pV(t,oV.y1),bV=t=>pV(oV.x1,t),yV=(t,e)=>lV*t+fV*e,vV=(t,e)=>dV*t+hV*e,xV=(t,e)=>pV(yV(t,e),vV(t,e)),wV=(t,e)=>mV(yV(t,e),vV(t,e));function kV(t,e){return oV=t,e?(cV=e*gU,lV=hV=Math.cos(cV),dV=Math.sin(cV),fV=-dV):(lV=hV=1,cV=dV=fV=0),OV}const OV={beginPath(){},closePath(){},moveTo:wV,lineTo:wV,rect(t,e,n,r){cV?(xV(t+n,e),xV(t+n,e+r),xV(t,e+r),wV(t,e)):(pV(t+n,e+r),mV(t,e))},quadraticCurveTo(t,e,n,r){const i=yV(t,e),a=vV(t,e),o=yV(n,r),s=vV(n,r);_V(sV,i,o,gV),_V(uV,a,s,bV),mV(o,s)},bezierCurveTo(t,e,n,r,i,a){const o=yV(t,e),s=vV(t,e),u=yV(n,r),c=vV(n,r),l=yV(i,a),d=vV(i,a);AV(sV,o,u,l,gV),AV(uV,s,c,d,bV),mV(l,d)},arc(t,e,n,r,i,a){if(r+=cV,i+=cV,sV=n*Math.cos(i)+t,uV=n*Math.sin(i)+e,Math.abs(i-r)>aV)pV(t-n,e-n),pV(t+n,e+n);else{const o=r=>pV(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,u;if(o(r),o(i),i!==r)if((r%=yU)<0&&(r+=yU),(i%=yU)<0&&(i+=yU),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=yU,s=r-r%bU,u=0;u<4&&s>i;++u,s-=bU)o(s);else for(s=r-r%bU+bU,u=0;u<4&&s<i;++u,s+=bU)o(s)}}};function _V(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function AV(t,e,n,r,i){const a=r-t+3*e-3*n,o=t+n-2*e,s=t-e;let u,c=0,l=0;Math.abs(a)>1e-14?(u=o*o+s*a,u>=0&&(u=Math.sqrt(u),c=(-o+u)/a,l=(-o-u)/a)):c=.5*s/o,0<c&&c<1&&i(CV(c,t,e,n,r)),0<l&&l<1&&i(CV(l,t,e,n,r))}function CV(t,e,n,r,i){const a=1-t,o=a*a,s=t*t;return o*a*e+3*o*t*n+3*a*s*r+s*t*i}var EV=(EV=qs(1,1))?EV.getContext("2d"):null;const SV=new ZU;function jV(t){return function(e,n){if(!EV)return!0;t(EV,e),SV.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=SV;for(let t=i;t<=o;++t)for(let e=r;e<=a;++e)if(EV.isPointInPath(e,t))return!0;return!1}}function NV(t,e){return e.contains(t.x||0,t.y||0)}function TV(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,a=t.height||0;return e.intersects(SV.set(n,r,n+i,r+a))}function FV(t,e,n,r,i){const{x1:a,y1:o,x2:s,y2:u}=t,c=r-e,l=i-n;let d,f,h,p,m=0,g=1;for(p=0;p<4;++p){if(0===p&&(d=-c,f=-(a-e)),1===p&&(d=c,f=s-e),2===p&&(d=-l,f=-(o-n)),3===p&&(d=l,f=u-n),Math.abs(d)<1e-10&&f<0)return!1;if(h=f/d,d<0){if(h>g)return!1;h>m&&(m=h)}else if(d>0){if(h<m)return!1;h<g&&(g=h)}}return!0}function DV(t,e){t.globalCompositeOperation=e.blend||"source-over"}function IV(t,e){return null==t?e:t}function MV(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function $V(t,e,n){return uU(n)?function(t,e,n){const r=n.width(),i=n.height();let a;if("radial"===e.gradient)a=t.createRadialGradient(n.x1+IV(e.x1,.5)*r,n.y1+IV(e.y1,.5)*i,Math.max(r,i)*IV(e.r1,0),n.x1+IV(e.x2,.5)*r,n.y1+IV(e.y2,.5)*i,Math.max(r,i)*IV(e.r2,.5));else{const o=IV(e.x1,0),s=IV(e.y1,0),u=IV(e.x2,1),c=IV(e.y2,0);if(o!==u&&s!==c&&r!==i){const n=qs(Math.ceil(r),Math.ceil(i)),a=n.getContext("2d");return a.scale(r,i),a.fillStyle=MV(a.createLinearGradient(o,s,u,c),e.stops),a.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}a=t.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+u*r,n.y1+c*i)}return MV(a,e.stops)}(t,n,e.bounds):n}function RV(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=$V(t,e,e.fill),!0)}var BV=[];function zV(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&((n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=$V(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||BV),t.lineDashOffset=e.strokeDashOffset||0),!0))}function LV(t,e){return t.zindex-e.zindex||t.index-e.index}function PV(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,a=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&a.push(e);return t.zdirty=!1,t.zitems=a.sort(LV)}function qV(t,e){var n,r,i=t.items;if(!i||!i.length)return;const a=PV(t);if(a&&a.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=a}for(n=0,r=i.length;n<r;++n)e(i[n])}function WV(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const a=PV(t);for(a&&a.length&&(i=a),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===a)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function UV(t){return function(e,n,r){qV(n,n=>{r&&!r.intersects(n.bounds)||VV(t,e,n,n)})}}function VV(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(DV(e,n),n.fill&&RV(e,n,i)&&e.fill(),n.stroke&&zV(e,n,i)&&e.stroke()))}function GV(t){return t=t||wL,function(e,n,r,i,a,o){return r*=e.pixelRatio,i*=e.pixelRatio,WV(n,n=>{const s=n.bounds;if((!s||s.contains(a,o))&&s)return t(e,n,r,i,a,o)?n:void 0})}}function HV(t,e){return function(n,r,i,a){var o,s,u=Array.isArray(r)?r[0]:r,c=null==e?u.fill:e,l=u.stroke&&n.isPointInStroke;return l&&(o=u.strokeWidth,s=u.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(c&&n.isPointInPath(i,a)||l&&n.isPointInStroke(i,a))}}function XV(t){return GV(HV(t))}function KV(t,e){return"translate("+t+","+e+")"}function YV(t){return"rotate("+t+")"}function JV(t){return KV(t.x||0,t.y||0)}function ZV(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,a=n.angle||0;t.translate(r,i),a&&t.rotate(a*=gU),t.beginPath(),e(t,n),a&&t.rotate(-a),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return KV(t.x||0,t.y||0)+(t.angle?" "+YV(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(kV(t,n.angle),n),iV(t,n).translate(n.x||0,n.y||0)},draw:UV(r),pick:XV(r),isect:n||jV(r)}}var QV=ZV("arc",(function(t,e){return PU.context(t)(e)}));function tG(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=HV(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(kV(t),r),iV(t,r[0]))},draw:(a=r,function(t,e,n){!e.items.length||n&&!n.intersects(e.bounds)||VV(a,t,e.items[0],e.items)}),pick:function(t,e,n,r,a,o){var s=e.items,u=e.bounds;return!s||!s.length||u&&!u.contains(a,o)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,s,n,r)?s[0]:null)},isect:NV,tip:n};var a}var eG=tG("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?WU:qU).curve(fU(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],a="horizontal"===t[0].orient?"y":"x",o=t.length,s=1/0;--o>=0;)!1!==t[o].defined&&(r=Math.abs(t[o][a]-i))<s&&(s=r,n=t[o]);return n}));function nG(t,e){t.beginPath(),XU(e)?KU(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function rG(t){const e=IV(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function iG(t,e){const n=rG(e);t("d",KU(null,e,n,n))}function aG(t,e,n,r){const i=rG(e);t.beginPath(),KU(t,e,(n||0)+i,(r||0)+i)}const oG=HV(aG),sG=HV(aG,!1),uG=HV(aG,!0);var cG={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",JV(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),iV(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){qV(e,e=>{const r=e.x||0,i=e.y||0,a=e.strokeForeground,o=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&o&&(aG(t,e,r,i),DV(t,e),e.fill&&RV(t,e,o)&&t.fill(),e.stroke&&!a&&zV(t,e,o)&&t.stroke()),t.save(),t.translate(r,i),e.clip&&nG(t,e),n&&n.translate(-r,-i),qV(e,e=>{this.draw(t,e,n)}),n&&n.translate(r,i),t.restore(),a&&e.stroke&&o&&(aG(t,e,r,i),DV(t,e),zV(t,e,o)&&t.stroke())})},pick:function(t,e,n,r,i,a){if(e.bounds&&!e.bounds.contains(i,a)||!e.items)return null;const o=n*t.pixelRatio,s=r*t.pixelRatio;return WV(e,u=>{let c,l,d;const f=u.bounds;if(f&&!f.contains(i,a))return;l=u.x||0,d=u.y||0;const h=l+(u.width||0),p=d+(u.height||0),m=u.clip;if(m&&(i<l||i>h||a<d||a>p))return;if(t.save(),t.translate(l,d),l=i-l,d=a-d,m&&XU(u)&&!uG(t,u,o,s))return t.restore(),null;const g=u.strokeForeground,b=!1!==e.interactive;return b&&g&&u.stroke&&sG(t,u,o,s)?(t.restore(),u):(c=WV(u,t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,l,d)?this.pick(t,n,r,l,d):null),!c&&b&&(u.fill||!g&&u.stroke)&&oG(t,u,o,s)&&(c=u),t.restore(),c||null)})},isect:TV,content:function(t,e,n){t("clip-path",e.clip?JU(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),iG(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?iG(t,e):t("d","")}},lG={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function dG(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(e=>{t.image=e,t.image.url=t.url})),n}function fG(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function hG(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function pG(t,e){return"center"===t?e/2:"right"===t?e:0}function mG(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var gG={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=dG(e,n),i=fG(e,r),a=hG(e,r),o=(e.x||0)-pG(e.align,i),s=(e.y||0)-mG(e.baseline,a);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",lG["xmlns:xlink"],"xlink:href"),t("transform",KV(o,s)),t("width",i),t("height",a),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=fG(e,n),i=hG(e,n),a=(e.x||0)-pG(e.align,r),o=(e.y||0)-mG(e.baseline,i);return t.set(a,o,a+r,o+i)},draw:function(t,e,n){qV(e,e=>{if(n&&!n.intersects(e.bounds))return;const r=dG(e,this);let i,a,o,s,u=fG(e,r),c=hG(e,r),l=(e.x||0)-pG(e.align,u),d=(e.y||0)-mG(e.baseline,c);!1!==e.aspect&&(a=r.width/r.height,o=e.width/e.height,a==a&&o==o&&a!==o&&(o<a?(s=u/a,d+=(c-s)/2,c=s):(s=c*a,l+=(u-s)/2,u=s))),(r.complete||r.toDataURL)&&(DV(t,e),t.globalAlpha=null!=(i=e.opacity)?i:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,l,d,u,c))})},pick:GV(),isect:wL,get:dG,xOffset:pG,yOffset:mG},bG=tG("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return UU.curve(fU(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),a=t.length;--a>=0;)if(!1!==t[a].defined&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<i)return t[a];return null}));function yG(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,a=e.scaleX||1,o=e.scaleY||1,s=(e.angle||0)*gU,u=e.pathCache;u&&u.path===n||((e.pathCache=u=mU(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),CU(t,u,0,0,a,o),t.rotate(-s),t.translate(-r,-i)):CU(t,u,r,i,a,o)}var vG={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return KV(t.x||0,t.y||0)+(t.angle?" "+YV(t.angle):"")+(t.scaleX||t.scaleY?" "+(e=t.scaleX||1,n=t.scaleY||1,"scale("+e+","+n+")"):"");var e,n}(e)),t("d",e.path)},bound:function(t,e){return yG(kV(t,e.angle),e)?t.set(0,0,0,0):iV(t,e,!0)},draw:UV(yG),pick:XV(yG),isect:jV(yG)};function xG(t,e){t.beginPath(),KU(t,e)}var wG={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",KU(null,e))},bound:function(t,e){var n,r;return iV(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:UV(xG),pick:XV(xG),isect:TV};function kG(t,e,n){var r,i,a,o;return!(!e.stroke||!zV(t,e,n))&&(r=e.x||0,i=e.y||0,a=null!=e.x2?e.x2:r,o=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),!0)}var OG={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",JV(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return iV(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){qV(e,e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&kG(t,e,r)&&(DV(t,e),t.stroke())}})},pick:GV((function(t,e,n,r){return!!t.isPointInStroke&&(kG(t,e,1)&&t.isPointInStroke(n,r))})),isect:function(t,e){const n=t.x||0,r=t.y||0;return FV(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}},_G=ZV("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),AG=ZV("symbol",(function(t,e){return GU.context(t)(e)}),NV);const CG=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},a=(i,a)=>(++r>t&&(n=e,e={},r=1),e[i]=a);return i(),{clear:i,has:t=>RL(e,t)||RL(n,t),get:t=>RL(e,t)?e[t]:RL(n,t)?a(t,n[t]):void 0,set:(t,n)=>RL(e,t)?e[t]=n:a(t,n)}}();var EG={height:DG,measureWidth:TG,estimateWidth:jG,width:jG,canvas:SG};function SG(t){EG.width=t&&EV?TG:jG}function jG(t,e){return NG($G(t,e),DG(t))}function NG(t,e){return~~(.8*t.length*e)}function TG(t,e){return DG(t)<=0||!(e=$G(t,e))?0:FG(e,BG(t))}function FG(t,e){const n="(".concat(e,") ").concat(t);let r=CG.get(n);return void 0===r&&(EV.font=e,r=EV.measureText(t).width,CG.set(n,r)),r}function DG(t){return null!=t.fontSize?+t.fontSize||0:11}function IG(t){return null!=t.lineHeight?t.lineHeight:DG(t)+2}function MG(t){return e=t.lineBreak&&t.text&&!kL(t.text)?t.text.split(t.lineBreak):t.text,kL(e)?e.length>1?e:e[0]:e;var e}function $G(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(EG.width===TG){const e=BG(t);return t=>FG(t,e)}{const e=DG(t);return t=>NG(t,e)}}(t);if(r(e)<n)return e;var i,a=t.ellipsis||"",o="rtl"===t.dir,s=0,u=e.length;if(n-=r(a),o){for(;s<u;)i=s+u>>>1,r(e.slice(i))>n?s=i+1:u=i;return a+e.slice(s)}for(;s<u;)i=1+(s+u>>>1),r(e.slice(0,i))<n?s=i:u=i-1;return e.slice(0,s)+a}(t,n):n}function RG(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function BG(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+DG(t)+"px "+RG(t,e)}function zG(t){var e=t.baseline,n=DG(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*IG(t):"line-bottom"===e?.29*n-.5*IG(t):0)}SG(!0);const LG={left:"start",center:"middle",right:"end"},PG=new ZU;function qG(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-bU,n+=i*Math.cos(e),r+=i*Math.sin(e)),PG.x1=n,PG.y1=r,PG}function WG(t,e,n){var r,i=EG.height(e),a=e.align,o=qG(e),s=o.x1,u=o.y1,c=e.dx||0,l=(e.dy||0)+zG(e)-Math.round(.8*i),d=MG(e);if(kL(d)?(i+=IG(e)*(d.length-1),r=d.reduce((t,n)=>Math.max(t,EG.width(e,n)),0)):r=EG.width(e,d),"center"===a?c-=r/2:"right"===a&&(c-=r),t.set(c+=s,l+=u,c+r,l+i),e.angle&&!n)t.rotate(e.angle*gU,s,u);else if(2===n)return t.rotatedPoints(e.angle*gU,s,u);return t}var UG={arc:QV,area:eG,group:cG,image:gG,line:bG,path:vG,rect:wG,rule:OG,shape:_G,symbol:AG,text:{type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+zG(e),a=qG(e),o=a.x1,s=a.y1,u=e.angle||0;t("text-anchor",LG[e.align]||"start"),u?(n=KV(o,s)+" "+YV(u),(r||i)&&(n+=" "+KV(r,i))):n=KV(o+r,s+i),t("transform",n)},bound:WG,draw:function(t,e,n){qV(e,e=>{var r,i,a,o,s,u,c,l=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===l||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=BG(e),t.textAlign=e.align||"left",i=(r=qG(e)).x1,a=r.y1,e.angle&&(t.save(),t.translate(i,a),t.rotate(e.angle*gU),i=a=0),i+=e.dx||0,a+=(e.dy||0)+zG(e),u=MG(e),DV(t,e),kL(u))for(s=IG(e),o=0;o<u.length;++o)c=$G(e,u[o]),e.fill&&RV(t,e,l)&&t.fillText(c,i,a),e.stroke&&zV(t,e,l)&&t.strokeText(c,i,a),a+=s;else c=$G(e,u),e.fill&&RV(t,e,l)&&t.fillText(c,i,a),e.stroke&&zV(t,e,l)&&t.strokeText(c,i,a);e.angle&&t.restore()}})},pick:GV((function(t,e,n,r,i,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=qG(e),s=o.x1,u=o.y1,c=WG(PG,e,1),l=-e.angle*gU,d=Math.cos(l),f=Math.sin(l),h=d*i-f*a+(s-d*s+f*u),p=f*i+d*a+(u-f*s-d*u);return c.contains(h,p)})),isect:function(t,e){const n=WG(PG,t,2);return FV(e,n[0],n[1],n[2],n[3])||FV(e,n[0],n[1],n[4],n[5])||FV(e,n[4],n[5],n[6],n[7])||FV(e,n[2],n[3],n[6],n[7])}},trail:tG("trail",(function(t,e){return HU.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null}))};function VG(t,e,n){return!t&&"undefined"!=typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function GG(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function HG(t,e,n,r){var i,a=t.childNodes[e];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(i=a||null,a=VG(t.ownerDocument,n,r),t.insertBefore(a,i)),a}function XG(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function KG(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function YG(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function JG(t,e){this._active=null,this._handlers={},this._loader=t||Object(en.e)(),this._tooltip=e||ZG}function ZG(t,e,n,r){t.element().setAttribute("title",r||"")}function QG(t){this._el=null,this._bgcolor=null,this._loader=new eV(t)}JG.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const t in e)n.push(...e[t]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then(e=>{const n=new MouseEvent(t.type,t),r=VG(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)}).catch(()=>{})},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,a,o=t&&t.mark;if(o&&(i=UG[o.marktype]).tip){for((a=YG(e,n))[0]-=r[0],a[1]-=r[1];t=t.mark.group;)a[0]-=t.x||0,a[1]-=t.y||0;t=i.tip(o.items,a)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,u+=t.y||0;return{x:s,y:u,width:a,height:o,left:s,top:u,right:s+a,bottom:u+o}}},QG.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t){const e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then(()=>e):Promise.resolve(e)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then(e=>{e&&t(),n._ready=null})}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const tH="dragleave",eH="mousedown",nH="mousemove",rH="mouseout",iH="click",aH=nH,oH=rH,sH=iH;function uH(t,e){JG.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function cH(t,e){(t=>"touchstart"===t||"touchmove"===t||"touchend"===t?["touchstart","touchmove","touchend"]:[t])(e).forEach(e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e))}function lH(t,e,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i||(i&&i.exit||this.fire(n,r),this._active=a,this.fire(e,r)),this.fire(t,r)}}function dH(t){return function(e){this.fire(t,e),this._active=null}}BL(uH,JG,{initialize(t,e,n){return this._canvas=t&&GG(t,"canvas"),[iH,eH,nH,rH,tH].forEach(t=>cH(this,t)),JG.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup","dragenter",tH,"dragover",eH,"mouseup",nH,rH,"mouseover",iH,"dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],DOMMouseScroll(t){this.fire("mousewheel",t)},mousemove:lH(nH,"mouseover",rH),dragover:lH("dragover","dragenter",tH),mouseout:dH(rH),dragleave:dH(tH),mousedown(t){this._down=this._active,this.fire(eH,t)},click(t){this._down===this._active&&(this.fire(iH,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",t,!0)},touchmove(t){this.fire("touchmove",t,!0)},touchend(t){this.fire("touchend",t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===sH&&r&&r.href?this.handleHref(e,r,r.href):t!==aH&&t!==oH||this.handleTooltip(e,r,t!==oH),i)for(let t=0,n=i.length;t<n;++t)i[t].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(cH(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=YG(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const a=this.context();return UG[t.marktype].pick.call(this,a,t,e,n,r,i)}});var fH="undefined"!=typeof window&&window.devicePixelRatio||1;function hH(t){QG.call(this,t),this._options={},this._redraw=!1,this._dirty=new ZU,this._tempb=new ZU}const pH=QG.prototype;function mH(t,e){JG.call(this,t,e);const n=this;n._hrefHandler=gH(n,(t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)}),n._tooltipHandler=gH(n,(t,e)=>{n.handleTooltip(t,e,t.type!==oH)})}BL(hH,QG,{initialize(t,e,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:qs(1,1,this._options.type),t&&this._canvas&&(XG(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),pH.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(pH.resize.call(this,t,e,n,r),this._canvas)!function(t,e,n,r,i,a){const o="undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),u=o?fH:i;t.width=e*u,t.height=n*u;for(const t in a)s[t]=a[t];o&&1!==u&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||bL("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty,o=(s=n,u=r,c=i,(new ZU).set(0,0,u,c).translate(-s[0],-s[1]));var s,u,c;e.save();const l=this._redraw||a.empty()?(this._redraw=!1,o.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,o.intersect(a),n);return this.clear(-n[0],-n[1],r,i),this.draw(e,t,l),e.restore(),a.clear(),this},draw(t,e,n){const r=UG[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),IL(n)?(t.beginPath(),n(t),t.clip()):nG(t,e.group)}(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,a=this.context();"pdf"===i.type||i.externalContext||a.clearRect(t,e,n,r),null!=this._bgcolor&&(a.fillStyle=this._bgcolor,a.fillRect(t,e,n,r))}});const gH=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};BL(mH,JG,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(sH,this._hrefHandler),r.removeEventListener(aH,this._tooltipHandler),r.removeEventListener(oH,this._tooltipHandler)),this._svg=r=t&&GG(t,"svg"),r&&(r.addEventListener(sH,this._hrefHandler),r.addEventListener(aH,this._tooltipHandler),r.addEventListener(oH,this._tooltipHandler)),JG.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:gH(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const bH=(t,e,n)=>({role:t,"aria-roledescription":e,"aria-label":n||void 0}),yH=GL(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),vH={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?_H(t):null,i=t.context,a=i.scales[e.scale].value,o=i.dataflow.locale(),s=a.type;return"".concat("left"===n||"right"===n?"Y":"X","-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat($W(s)?"discrete":s," scale")+" with ".concat(oU(o,a,t))}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?_H(t):null,r="".concat(e.type||""," legend").trim(),i=e.scales,a=Object.keys(i),o=t.context,s=o.scales[i[a[0]]].value,u=o.dataflow.locale();return c=r,(c.length?c[0].toUpperCase()+c.slice(1):c)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(t){return(t=t.map(t=>t+("fill"===t||"stroke"===t?" color":""))).length<2?t[0]:t.slice(0,-1).join(", ")+" and "+_L(t)}(a))+" with ".concat(oU(u,s,t));var c}},"title-text":{desc:"title",caption:t=>"Title text '".concat(OH(t),"'")},"title-subtitle":{desc:"subtitle",caption:t=>"Subtitle text '".concat(OH(t),"'")}},xH={ariaRole:"role",ariaRoleDescription:"aria-roledescription",description:"aria-label"};function wH(t,e){const n=!1===e.aria;if(t("aria-hidden",n||void 0),n||null==e.description)for(const e in xH)t(xH[e],void 0);else{const n=e.mark.marktype;t("aria-label",e.description),t("role",e.ariaRole||("group"===n?"graphics-object":"graphics-symbol")),t("aria-roledescription",e.ariaRoleDescription||"".concat(n," mark"))}}function kH(t){return!1===t.aria?{"aria-hidden":!0}:yH[t.role]?null:vH[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return bH(e.role||"graphics-symbol",e.desc,n.description||r(n))}catch(t){return null}}(t,vH[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some(t=>null!=t.description&&!1!==t.aria);return bH(n?"graphics-object":"graphics-symbol","".concat(e," mark container"),t.description)}(t)}function OH(t){return DL(t.text).join(" ")}function _H(t){try{return DL(_L(t.items).items[0].text).join(" ")}catch(t){return null}}const AH=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function CH(){let t="",e="",n="";const r=[],i=()=>e=n="",a=(t,n)=>(null!=n&&(e+=" ".concat(t,'="').concat(AH(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),o),o={open(s,...u){(a=>{e&&(t+="".concat(e,">").concat(n),i()),r.push(a)})(s),e="<"+s;for(const t of u)for(const e in t)a(e,t[e]);return o},close(){const a=r.pop();return t+=e?e+(n?">".concat(n,"</").concat(a,">"):"/>"):"</".concat(a,">"),i(),o},attr:a,text:t=>(n+=AH(t),o),toString:()=>t};return o}const EH=t=>function t(e,n){if(e.open(n.tagName),n.hasAttributes()){const t=n.attributes,r=t.length;for(let n=0;n<r;++n)e.attr(t[n].name,t[n].value)}if(n.hasChildNodes()){const r=n.childNodes,i=r.length;for(let n=0;n<i;n++){const i=r[n];3===i.nodeType?e.text(i.nodeValue):t(e,i)}}return e.close()}(CH(),t)+"";const SH={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},jH={fill:"none","stroke-miterlimit":10},NH=lG.xmlns;function TH(t){QG.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const FH=QG.prototype;function DH(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function IH(t,e,n){let r,i,a;if("radial"===e.gradient){let r=HG(t,n++,"pattern",NH);qH(r,{id:"p_"+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=HG(r,0,"rect",NH),qH(r,{width:1,height:1,fill:"url(".concat(UH(),"#").concat(e.id,")")}),qH(t=HG(t,n++,"radialGradient",NH),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else qH(t=HG(t,n++,"linearGradient",NH),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)a=HG(t,r,"stop",NH),a.setAttribute("offset",e.stops[r].offset),a.setAttribute("stop-color",e.stops[r].color);return XG(t,r),n}function MH(t,e,n){let r;return(t=HG(t,n,"clipPath",NH)).setAttribute("id",e.id),e.path?(r=HG(t,0,"path",NH),r.setAttribute("d",e.path)):(r=HG(t,0,"rect",NH),qH(r,{x:0,y:0,width:e.width,height:e.height})),XG(t,1),n+1}function $H(t,e,n,r,i){let a,o=t._svg;if(!o&&(a=e.ownerDocument,o=VG(a,r,NH),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===r))){const e=VG(a,"path",NH);o.appendChild(e),e.__data__=t;const n=VG(a,"g",NH);o.appendChild(n),n.__data__=t;const r=VG(a,"path",NH);o.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(o.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o}BL(TH,QG,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=HG(t,0,"svg",NH),qH(this._svg,lG),this._svg.setAttribute("class","marks"),XG(t,1),this._root=HG(this._svg,0,"g",NH),qH(this._root,jH),XG(this._svg,1)),this.background(this._bgcolor),FH.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),FH.background.apply(this,arguments)},resize(t,e,n,r){return FH.resize.call(this,t,e,n,r),this._svg&&(qH(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=HG(t,0,"rect",NH),qH(n,{width:this._width,height:this._height,fill:e}));const r=EH(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),XG(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,a,o,s,u;for(o=0,s=t.length;o<s;++o)n=t[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=UG[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,DH(n,e),r.items.forEach(t=>{t.dirty=e})),r.zdirty||(n.exit?(a.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(a,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null):(n=a.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(a,n._svg,n):(this._dirtyAll=!1,DH(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;const r=this._svg,i=UG[e.marktype],a=!1===e.interactive?"none":null,o="g"===i.tag;let s=null,u=0;const c=$H(e,t,n,"g",r);c.setAttribute("class",KG(e));const l=kH(e);for(const t in l)WH(c,t,l[t]);o||WH(c,"pointer-events",a),WH(c,"clip-path",e.clip?JU(this,e,e.group):null);const d=t=>{const e=this.isDirty(t),n=$H(t,c,s,i.tag,r);e&&(this._update(i,n,t),o&&function(t,e,n){e=e.lastChild.previousSibling;let r,i=0;qV(n,n=>{r=t.mark(e,n,r),++i}),XG(e,1+i)}(this,n,t)),s=n,++u};return i.nested?e.items.length&&d(e.items[0]):qV(e,d),XG(c,u),c},_update(t,e,n){RH=e,BH=e.__values__,wH(LH,n),t.attr(LH,n,this);const r=zH[t.type];r&&r.call(this,t,e,n),RH&&this.style(RH,n)},style(t,e){if(null!=e)for(const n in SH){let r="font"===n?RG(e):e[n];if(r===BH[n])continue;const i=SH[n];null==r?t.removeAttribute(i):(uU(r)&&(r=cU(r,this._defs.gradient,UH())),t.setAttribute(i,r+"")),BH[n]=r}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=HG(t,1,"defs",NH)),r=IH(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=HG(t,1,"defs",NH)),r=MH(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):XG(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let RH=null,BH=null;const zH={group(t,e,n){const r=RH=e.childNodes[2];BH=r.__values__,t.foreground(LH,n,this),BH=e.__values__,RH=e.childNodes[1],t.content(LH,n,this);const i=RH=e.childNodes[0];t.background(LH,n,this);const a=!1===n.mark.interactive?"none":null;if(a!==BH.events&&(WH(r,"pointer-events",a),WH(i,"pointer-events",a),BH.events=a),n.strokeForeground&&n.stroke){const t=n.fill;WH(r,"display",null),this.style(i,n),WH(i,"stroke",null),t&&(n.fill=null),BH=r.__values__,this.style(r,n),t&&(n.fill=t),RH=null}else WH(r,"display","none")},image(t,e,n){!1===n.smooth?(PH(e,"image-rendering","optimizeSpeed"),PH(e,"image-rendering","pixelated")):PH(e,"image-rendering",null)},text(t,e,n){const r=MG(n);let i,a,o,s;kL(r)?(a=r.map(t=>$G(n,t)),i=a.join("\n"),i!==BH.text&&(XG(e,0),o=e.ownerDocument,s=IG(n),a.forEach((t,r)=>{const i=VG(o,"tspan",NH);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),e.appendChild(i)}),BH.text=i)):(a=$G(n,r),a!==BH.text&&(e.textContent=a,BH.text=a)),WH(e,"font-family",RG(n)),WH(e,"font-size",DG(n)+"px"),WH(e,"font-style",n.fontStyle),WH(e,"font-variant",n.fontVariant),WH(e,"font-weight",n.fontWeight)}};function LH(t,e,n){e!==BH[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(RH,t,e,n):WH(RH,t,e),BH[t]=e)}function PH(t,e,n){n!==BH[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),BH[e]=n)}function qH(t,e){for(const n in e)WH(t,n,e[n])}function WH(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function UH(){let t;return"undefined"==typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function VH(t){QG.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}BL(VH,QG,{svg(){return this._text},_render(t){const e=CH();e.open("svg",ML({},lG,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",jH,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=UG[e.marktype],r=n.tag,i=[wH,n.attr];t.open("g",{class:KG(e),"clip-path":e.clip?JU(this,e,e.group):null},kH(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const a=a=>{const o=this.href(a);if(o&&t.open("a",o),t.open(r,this.attr(e,a,i,"g"!==r?r:null)),"text"===r){const e=MG(a);if(kL(e)){const n={x:0,dy:IG(a)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text($G(a,e[r])).close()}else t.text($G(a,e))}else if("g"===r){const r=a.strokeForeground,i=a.fill,o=a.stroke;r&&o&&(a.stroke=null),t.open("path",this.attr(e,a,n.background,"bgrect")).close(),t.open("g",this.attr(e,a,n.content)),qV(a,e=>this.mark(t,e)),t.close(),r&&o?(i&&(a.fill=null),a.stroke=o,t.open("path",this.attr(e,a,n.foreground,"bgrect")).close(),i&&(a.fill=i)):t.open("path",this.attr(e,a,n.foreground,"bgfore")).close()}t.close(),o&&t.close()};return n.nested?e.items&&e.items.length&&a(e.items[0]):qV(e,a),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then(t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t})}return null},attr(t,e,n,r){const i={},a=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach(t=>t(a,e,this)):n(a,e,this),r&&function(t,e,n,r,i){if(null==e)return t;"bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(t.style="image-rendering: optimizeSpeed; image-rendering: pixelated;");"text"===r&&(t["font-family"]=RG(e),t["font-size"]=DG(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const n in SH){let r=e[n];const a=SH[n];("transparent"!==r||"fill"!==a&&"stroke"!==a)&&null!=r&&(uU(r)&&(r=cU(r,i.gradient,"")),t[a]=r)}}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:"p_"+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const GH={};function HH(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,a=t.marktype,o=i.length;let s=0;if("group"===a)for(;s<o;++s)XH(i[s],e,n,r);else for(const t=UG[a].isect;s<o;++s){const n=i[s];KH(n,e,t)&&r.push(n)}}return r}function XH(t,e,n,r){n&&n(t.mark)&&KH(t,e,UG.group.isect)&&r.push(t);const i=t.items,a=i&&i.length;if(a){const o=t.x||0,s=t.y||0;e.translate(-o,-s);for(let t=0;t<a;++t)HH(i[t],e,n,r);e.translate(o,s)}return r}function KH(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}GH.canvas=GH.png={renderer:hH,headless:hH,handler:uH},GH.svg={renderer:TH,headless:VH,handler:mH},GH.none={};new ZU;const YH=t=>t.data;function JH(t,e){const n=HL.call(e,t);return n.root&&n.root.lookup||{}}const ZH=()=>"undefined"!=typeof window&&window||null;function QH(t,e,n){return t.fields=e||[],t.fname=n,t}function tX(t){return 1===t.length?eX(t[0]):nX(t)}const eX=t=>function(e){return e[t]},nX=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function rX(t){throw Error(t)}function iX(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||rX("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&rX("Access path missing closing bracket: "+t),o&&rX("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function aX(t,e,n){const r=iX(t);return t=1===r.length?r[0]:t,QH((n&&n.get||tX)(r),[t],e||t)}aX("id"),QH(t=>t,[],"identity"),QH(()=>0,[],"zero"),QH(()=>1,[],"one"),QH(()=>!0,[],"true"),QH(()=>!1,[],"false");var oX=Array.isArray;function sX(t){return t[t.length-1]}function uX(t){return null==t||""===t?null:+t}function cX(t){return null!=t?oX(t)?t:[t]:[]}const lX=Object.prototype.hasOwnProperty;function dX(t,e){return lX.call(t,e)}function fX(t,e,n,r){let i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)}function hX(t){return"[object Date]"===Object.prototype.toString.call(t)}function pX(t){this.type=t}var mX;pX.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case"ArrayExpression":return t.elements;case"BinaryExpression":case"LogicalExpression":return[t.left,t.right];case"CallExpression":return[t.callee].concat(t.arguments);case"ConditionalExpression":return[t.test,t.consequent,t.alternate];case"MemberExpression":return[t.object,t.property];case"ObjectExpression":return t.properties;case"Property":return[t.key,t.value];case"UnaryExpression":return[t.argument];case"Identifier":case"Literal":case"RawCode":default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};(mX={})[1]="Boolean",mX[2]="<end>",mX[3]="Identifier",mX[4]="Keyword",mX[5]="Null",mX[6]="Numeric",mX[7]="Punctuator",mX[8]="String",mX[9]="RegularExpression";new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function gX(t,e){for(var n,r,i=e.fields,a=e.values,o=i.length,s=0;s<o;++s)if((r=i[s]).getter=aX.getter||aX(r.field),hX(n=r.getter(t))&&(n=uX(n)),hX(a[s])&&(a[s]=uX(a[s])),hX(a[s][0])&&(a[s]=a[s].map(uX)),"E"===r.type){if(oX(a[s])?a[s].indexOf(n)<0:n!==a[s])return!1}else if("R"===r.type){if(!fX(n,a[s]))return!1}else if("R-RE"===r.type){if(!fX(n,a[s],!0,!1))return!1}else if("R-E"===r.type){if(!fX(n,a[s],!1,!1))return!1}else if("R-LE"===r.type&&!fX(n,a[s],!1,!0))return!1;return!0}var bX={E_union:function(t,e){if(!t.length)return e;for(var n=0,r=e.length;n<r;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter(t=>e.indexOf(t)>=0):e},R_union:function(t,e){var n=uX(e[0]),r=uX(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?(t[0]>n&&(t[0]=n),t[1]<r&&(t[1]=r),t):[n,r]},R_intersect:function(t,e){var n=uX(e[0]),r=uX(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?r<t[0]||t[1]<n?[]:(t[0]<n&&(t[0]=n),t[1]>r&&(t[1]=r),t):[n,r]}};function yX(t,e,n,r){"Literal"!==e[0].type&&rX("First argument to selection functions must be a string literal.");const i=e[0].value,a=":"+i;"intersect"!==(e.length>=2&&sX(e).value)||dX(r,"@unit")||(r["@unit"]=n.getData(i).indataRef(n,"unit")),dX(r,a)||(r[a]=n.getData(i).tuplesRef())}const vX={random:()=>Dr(),cumulativeNormal:Ur,cumulativeLogNormal:Yr,cumulativeUniform:ni,densityNormal:Wr,densityLogNormal:Kr,densityUniform:ei,quantileNormal:Vr,quantileLogNormal:Jr,quantileUniform:ri,sampleNormal:qr,sampleLogNormal:Xr,sampleUniform:ti,isArray:kL,isBoolean:function(t){return"boolean"==typeof t},isDate:zL,isDefined:t=>void 0!==t,isNumber:LL,isObject:OL,isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},isString:PL,isTuple:un,isValid:t=>null!=t&&t==t,toBoolean:function(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t},toDate:function(t,e){return e=e||VL,null==t||""===t?null:e(t)},toNumber:AL,toString:function(t){return null==t||""===t?null:t+""},flush:function(t,e,n,r,i,a){if(!n&&0!==n)return a;const o=+n;let s,u=t[0],c=_L(t);c<u&&(s=u,u=c,c=s),s=Math.abs(e-u);const l=Math.abs(c-e);return s<l&&s<=o?r:l<=o?i:a},lerp:function(t,e){const n=t[0],r=_L(t),i=+e;return i?1===i?r:n+i*(r-n):n},merge:function(){const t=[].slice.call(arguments);return t.unshift({}),ML.apply(null,t)},pad:function(t,e,n,r){const i=n||" ",a=t+"",o=e-a.length;return o<=0?a:"left"===r?qL(i,o)+a:"center"===r?qL(i,~~(o/2))+a+qL(i,Math.ceil(o/2)):a+qL(i,o)},peek:_L,span:WL,inrange:function(t,e,n,r){let i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)},truncate:function(t,e,n,r){const i=null!=r?r:"",a=t+"",o=a.length,s=Math.max(0,e-i.length);return o<=e?a:"left"===n?i+a.slice(o-s):"center"===n?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i},rgb:wu,lab:Fl,hcl:zl,hsl:Su,luminance:kW,contrast:function(t,e){const n=kW(t),r=kW(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:ki,format:KL,utcFormat:JL,utcParse:QL,utcOffset:_i.w,utcSequence:_i.x,timeFormat:YL,timeParse:ZL,timeOffset:_i.q,timeSequence:_i.r,timeUnitSpecifier:_i.s,monthFormat:function(t){return eP.call(this,t,1,"%B")},monthAbbrevFormat:function(t){return eP.call(this,t,1,"%b")},dayFormat:function(t){return eP.call(this,0,2+t,"%A")},dayAbbrevFormat:function(t){return eP.call(this,0,2+t,"%a")},quarter:function(t){return 1+~~(new Date(t).getMonth()/3)},utcquarter:function(t){return 1+~~(new Date(t).getUTCMonth()/3)},week:_i.A,utcweek:_i.z,dayofyear:_i.m,utcdayofyear:_i.y,warn:function(){return xW(this.context.dataflow,"warn",arguments)},info:function(){return xW(this.context.dataflow,"info",arguments)},debug:function(){return xW(this.context.dataflow,"debug",arguments)},extent:function(t,e){let n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!=r);r=t[++o]);for(i=a=r;o<n;++o)r=t[o],null!=r&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!=r);r=e(t[++o]));for(i=a=r;o<n;++o)r=e(t[o]),null!=r&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]},inScope:function(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},intersect:function(t,e,n){if(!t)return[];const[r,i]=t,a=(new ZU).set(r[0],r[1],i[0],i[1]);return function(t,e,n){const r=[],i=(new ZU).union(e),a=t.marktype;return a?HH(t,i,n,r):"group"===a?XH(t,i,n,r):bL("Intersect scene must be mark node or group item.")}(n||this.context.dataflow.scenegraph().root,a,function(t){let e=null;if(t){const n=DL(t.marktype),r=DL(t.markname);e=t=>(!n.length||n.some(e=>t.marktype===e))&&(!r.length||r.some(e=>t.name===e))}return e}(e))},clampRange:function(t,e,n){let r,i=t[0],a=t[1];return a<i&&(r=a,a=i,i=r),r=a-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},pinchDistance:function(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){const t=ZH();return t?t.screen:{}},containerSize:function(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){const t=ZH();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]},bandspace:function(t,e,n){return CW(t||0,e||0,n||0)},setdata:function(t,e){const n=this.context.dataflow,r=this.context.data[t].input;return n.pulse(r,n.changeset().remove(wL).insert(e)),1},pathShape:function(t){let e=null;return function(n){return n?CU(n,e=e||mU(t)):t}},panLinear:function(t,e){return TL(t,e,AL,xL)},panLog:function(t,e){var n=Math.sign(t[0]);return TL(t,e,EL(n),CL(n))},panPow:function(t,e,n){return TL(t,e,NL(n),NL(1/n))},panSymlog:function(t,e,n){return TL(t,e,SL(n),jL(n))},zoomLinear:function(t,e,n){return FL(t,e,n,AL,xL)},zoomLog:function(t,e,n){const r=Math.sign(t[0]);return FL(t,e,n,EL(r),CL(r))},zoomPow:function(t,e,n,r){return FL(t,e,n,NL(r),NL(1/r))},zoomSymlog:function(t,e,n,r){return FL(t,e,n,SL(r),jL(r))},encode:function(t,e,n){if(t){const n=this.context.dataflow,r=t.mark.source;n.pulse(r,n.changeset().encode(t,e))}return void 0!==n?n:t},modify:function(t,e,n,r,i,a){const o=this.context.dataflow,s=this.context.data[t],u=s.input,c=o.stamp();let l,d,f=s.changes;if(!1===o._trigger||!(u.value.length||e||r))return 0;if((!f||f.stamp<c)&&(s.changes=f=o.changeset(),f.stamp=c,o.runAfter(()=>{s.modified=!0,o.pulse(u,f).run()},!0,1)),n&&(l=!0===n?wL:kL(n)||un(n)?n:AW(n),f.remove(l)),e&&f.insert(e),r&&(l=AW(r),u.value.some(l)?f.remove(l):f.insert(r)),i)for(d in a)f.modify(i,d,a[d]);return 1}},xX=["view","item","group","xy","x","y"],wX={},kX={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:t=>`_[${UL("$"+t)}]`,functions:function(t){const e=rq(t);xX.forEach(t=>e[t]="event.vega."+t);for(const t in vX)e[t]="this."+t;return ML(e,uq(t,vX,wX)),e},constants:nq,visitors:wX},OX=function(t){const e=(t=t||{}).whitelist?GL(t.whitelist):{},n=t.blacklist?GL(t.blacklist):{},r=t.constants||nq,i=(t.functions||rq)(d),a=t.globalvar,o=t.fieldvar,s=IL(a)?a:t=>`${a}["${t}"]`;let u={},c={},l=0;function d(t){if(PL(t))return t;const e=f[t.type];return null==e&&bL("Unsupported type: "+t.type),e(t)}const f={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return l>0?i:RL(n,i)?bL("Illegal identifier: "+i):RL(r,i)?r[i]:RL(e,i)?i:(u[i]=1,s(i))},MemberExpression:t=>{const e=!t.computed,n=d(t.object);e&&(l+=1);const r=d(t.property);return n===o&&(c[function(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(l-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&bL("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=RL(i,e)&&i[e];return r||bL("Unrecognized function: "+e),IL(r)?r(n):r+"("+n.map(d).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(d).join(",")+"]",BinaryExpression:t=>"("+d(t.left)+t.operator+d(t.right)+")",UnaryExpression:t=>"("+t.operator+d(t.argument)+")",ConditionalExpression:t=>"("+d(t.test)+"?"+d(t.consequent)+":"+d(t.alternate)+")",LogicalExpression:t=>"("+d(t.left)+t.operator+d(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(d).join(",")+"}",Property:t=>{l+=1;const e=d(t.key);return l-=1,e+":"+d(t.value)}};function h(t){const e={code:d(t),globals:Object.keys(u),fields:Object.keys(c)};return u={},c={},e}return h.functions=i,h.constants=r,h}(kX);function _X(t,e,n){return 1===arguments.length?vX[t]:(vX[t]=e,n&&(wX[t]=n),OX&&(OX.functions[t]="this."+t),this)}_X("bandwidth",(function(t,e){const n=sq(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}),aq),_X("copy",(function(t,e){const n=sq(t,(e||this).context);return n?n.copy():void 0}),aq),_X("domain",(function(t,e){const n=sq(t,(e||this).context);return n?n.domain():[]}),aq),_X("range",(function(t,e){const n=sq(t,(e||this).context);return n&&n.range?n.range():[]}),aq),_X("invert",(function(t,e,n){const r=sq(t,(n||this).context);return r?kL(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}),aq),_X("scale",(function(t,e,n){const r=sq(t,(n||this).context);return r?r(e):void 0}),aq),_X("gradient",(function(t,e,n,r,i){t=sq(t,(i||this).context);const a=function(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}(e,n);let o=t.domain(),s=o[0],u=_L(o),c=xL;return u-s?c=zW(t,s,u):t=(t.interpolator?DW("sequential")().interpolator(t.interpolator()):DW("linear")().interpolate(t.interpolate()).range(t.range())).domain([s=0,u=1]),t.ticks&&(o=t.ticks(+r||15),s!==o[0]&&o.unshift(s),u!==_L(o)&&o.push(u)),o.forEach(e=>a.stop(c(e),t(e))),a}),aq),_X("geoArea",bW,aq),_X("geoBounds",yW,aq),_X("geoCentroid",vW,aq),_X("geoShape",(function(t,e,n){const r=sq(t,(n||this).context);return function(t){return r?r.path.context(t)(e):""}}),aq),_X("indata",(function(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(t,e,n,r){"Literal"!==e[0].type&&bL("First argument to indata must be a string literal."),"Literal"!==e[1].type&&bL("Second argument to indata must be a string literal.");const i=e[0].value,a=e[1].value,o="@"+a;RL(o,r)||(r[o]=n.getData(i).indataRef(n,a))})),_X("data",HL,iq),_X("treePath",(function(t,e,n){const r=JH(t,this),i=r[e],a=r[n];return i&&a?i.path(a).map(YH):void 0}),iq),_X("treeAncestors",(function(t,e){const n=JH(t,this)[e];return n?n.ancestors().map(YH):void 0}),iq),_X("vlSelectionTest",(function(t,e,n){for(var r,i,a,o,s,u=this.context.data[t],c=u?u.values.value:[],l=u?u["index:unit"]&&u["index:unit"].value:void 0,d="intersect"===n,f=c.length,h=0;h<f;++h)if(r=c[h],l&&d){if(-1===(a=(i=i||{})[o=r.unit]||0))continue;if(s=gX(e,r),i[o]=s?-1:++a,s&&1===l.size)return!0;if(!s&&a===l.get(o).count)return!1}else if(d^(s=gX(e,r)))return s;return f&&d}),yX),_X("vlSelectionResolve",(function(t,e,n){for(var r,i,a,o,s,u,c,l,d,f,h,p=this.context.data[t],m=p?p.values.value:[],g={},b={},y={},v=m.length,x=0;x<v;++x){for(o=(r=m[x]).unit,i=r.fields,a=r.values,f=0,h=i.length;f<h;++f)s=i[f],c=(u=g[s.field]||(g[s.field]={}))[o]||(u[o]=[]),y[s.field]=l=s.type.charAt(0),d=bX[l+"_union"],u[o]=d(c,cX(a[f]));n&&(c=b[o]||(b[o]=[])).push(cX(a).reduce((t,e,n)=>(t[i[n].field]=e,t),{}))}return e=e||"union",Object.keys(g).forEach(t=>{g[t]=Object.keys(g[t]).map(e=>g[t][e]).reduce((n,r)=>void 0===n?r:bX[y[t]+"_"+e](n,r))}),m=Object.keys(b),n&&m.length&&(g.vlMulti="union"===e?{or:m.reduce((t,e)=>(t.push(...b[e]),t),[])}:{and:m.map(t=>({or:b[t]}))}),g}),yX);var AX=function(t,e){const n={};let r;try{r=function(t){aP=0,oP=(iP=t).length,sP=null,NP();var e=eq();if(2!==sP.type)throw new Error("Unexpect token after expression.");return e}(t=PL(t)?t:UL(t)+"")}catch(e){bL("Expression parse error: "+t)}r.visit(t=>{if("CallExpression"!==t.type)return;const r=t.callee.name,i=kX.visitors[r];i&&i(r,t.arguments,e,n)});const i=OX(r);return i.globals.forEach(t=>{const r="$"+t;!RL(n,r)&&e.getSignal(t)&&(n[r]=e.signalRef(t))}),{$expr:ML({code:i.code},e.options.ast?{ast:r}:null),$fields:i.fields,$params:n}};function CX(t,e,n){return t.fields=e||[],t.fname=n,t}function EX(t){return 1===t.length?SX(t[0]):jX(t)}const SX=t=>function(e){return e[t]},jX=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function NX(t){throw Error(t)}function TX(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||NX("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&NX("Access path missing closing bracket: "+t),o&&NX("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function FX(t,e,n){const r=TX(t);return t=1===r.length?r[0]:t,CX((n&&n.get||EX)(r),[t],e||t)}FX("id"),CX(t=>t,[],"identity"),CX(()=>0,[],"zero"),CX(()=>1,[],"one");const DX=CX(()=>!0,[],"true");CX(()=>!1,[],"false");var IX=Array.isArray;function MX(t){return t===Object(t)}function $X(t){return null!=t?IX(t)?t:[t]:[]}function RX(t){return"function"==typeof t}const BX=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e==e?-1:e!=e&&t==t?1:0),zX=(t,e)=>1===t.length?LX(t[0],e[0]):PX(t,e,t.length),LX=(t,e)=>function(n,r){return BX(t(n),t(r))*e},PX=(t,e,n)=>(e.push(0),function(r,i){let a,o=0,s=-1;for(;0===o&&++s<n;)a=t[s],o=BX(a(r),a(i));return o*e[s]});const qX=Object.prototype.hasOwnProperty;function WX(t,e){return qX.call(t,e)}function UX(t){return IX(t)?"["+t.map(UX)+"]":MX(t)||"string"==typeof t?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function VX(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}const GX=VX(["rule"]),HX=VX(["group","image","rect"]);function XX(t){return(t+"").toLowerCase()}function KX(t,e,n){";"!==n[n.length-1]&&(n="return("+n+");");const r=Function(...e.concat(n));return t&&t.functions?r.bind(t.functions):r}var YX={operator:(t,e)=>KX(t,["_"],e.code),parameter:(t,e)=>KX(t,["datum","_"],e.code),event:(t,e)=>KX(t,["event"],e.code),handler:(t,e)=>KX(t,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(e.code,";")),encode:(t,e)=>{const{marktype:n,channels:r}=e;let i="var o=item,datum=o.datum,m=0,$;";for(const t in r){const e="o["+UX(t)+"]";i+="$=".concat(r[t].code,";if(").concat(e,"!==$)").concat(e,"=$,m=1;")}return i+=function(t,e){let n="";return GX[e]||(t.x2&&(t.x?(HX[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(HX[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",KX(t,["item","_"],i)},codegen:{get(t){const e="[".concat(t.map(UX).join("]["),"]"),n=Function("_","return _".concat(e,";"));return n.path=e,n},comparator(t,e){let n;const r=Function("a","b","var u, v; return "+t.map((t,r)=>{const i=e[r];let a,o;return t.path?(a="a".concat(t.path),o="b".concat(t.path)):((n=n||{})["f"+r]=t,a="this.f".concat(r,"(a)"),o="this.f".concat(r,"(b)")),function(t,e,n,r){return"((u = ".concat(t,") < (v = ").concat(e,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}(a,o,-i,i)}).join("")+"0;");return n?r.bind(n):r}}};function JX(t,e,n){if(!t||!MX(t))return t;for(let r,i=0,a=ZX.length;i<a;++i)if(r=ZX[i],WX(t,r.key))return r.parse(t,e,n);return t}var ZX=[{key:"$ref",parse:function(t,e){return e.get(t.$ref)||NX("Operator not defined: "+t.$ref)}},{key:"$key",parse:function(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=function(t,e,n){t&&(t=e?$X(t).map(t=>t.replace(/\\(.)/g,"$1")):$X(t));const r=t&&t.length,i=n&&n.get||EX,a=t=>i(e?[t]:TX(t));let o;if(r)if(1===r){const e=a(t[0]);o=function(t){return""+e(t)}}else{const e=t.map(a);o=function(t){let n=""+e[0](t),i=0;for(;++i<r;)n+="|"+e[i](t);return n}}else o=function(){return""};return CX(o,t,"key")}(t.$key,t.$flat,e.expr.codegen))}},{key:"$expr",parse:function(t,e,n){t.$params&&e.parseParameters(t.$params,n);const r="e:"+t.$expr.code+"_"+t.$name;return e.fn[r]||(e.fn[r]=CX(e.parameterExpression(t.$expr),t.$fields,t.$name))}},{key:"$field",parse:function(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=FX(t.$field,t.$name,e.expr.codegen))}},{key:"$encode",parse:function(t,e){const n=t.$encode,r={};for(const t in n){const i=n[t];r[t]=CX(e.encodeExpression(i.$expr),i.$fields),r[t].output=i.$output}return r}},{key:"$compare",parse:function(t,e){const n="c:"+t.$compare+"_"+t.$order,r=$X(t.$compare).map(t=>t&&t.$tupleid?cn:t);return e.fn[n]||(e.fn[n]=function(t,e,n){n=n||{},e=$X(e)||[];const r=[],i=[],a={},o=n.comparator||zX;return $X(t).forEach((t,o)=>{var s;null!=t&&(r.push("descending"===e[o]?-1:1),i.push(t=RX(t)?t:FX(t,null,n)),(s=t,(null==s?null:s.fields)||[]).forEach(t=>a[t]=1))}),0===i.length?null:CX(o(i,r),Object.keys(a))}(r,t.$order,e.expr.codegen))}},{key:"$context",parse:function(t,e){return e}},{key:"$subflow",parse:function(t,e){const n=t.$subflow;return function(t,r,i){const a=e.fork().parse(n),o=a.get(n.operators[0].id),s=a.signals.parent;return s&&s.set(i),o.detachSubflow=()=>e.detach(a),o}}},{key:"$tupleid",parse:function(){return cn}}];const QX={skip:!0};function tK(t,e,n,r){return new eK(t,e,n,r)}function eK(t,e,n,r){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=r||YX,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function nK(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}eK.prototype=nK.prototype={fork(){const t=new nK(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter(e=>e!==t);const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,r=n.dataflow,i=t.value;if(n.set(t.id,e),"collect"===XX(t.type)&&i&&(i.$ingest?r.ingest(e,i.$ingest,i.$format):i.$request?r.preload(e,i.$request,i.$format):r.pulse(e,r.changeset().insert(i))),t.root&&(n.root=e),t.parent){let i=n.get(t.parent.$ref);i?(r.connect(i,[e]),e.targets().add(i)):(n.unresolved=n.unresolved||[]).push(()=>{i=n.get(t.parent.$ref),r.connect(i,[e]),e.targets().add(i)})}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(const r in t.data){const i=n.data[r]||(n.data[r]={});t.data[r].forEach(t=>i[t]=e)}},resolve(){return(this.unresolved||[]).forEach(t=>t()),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[XX(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,r,i){this.dataflow.on(e,n,r,i,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:function(t){const e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach(t=>e.parseOperator(t)),n.forEach(t=>e.parseOperatorParameters(t)),(t.streams||[]).forEach(t=>e.parseStream(t)),(t.updates||[]).forEach(t=>e.parseUpdate(t)),e.resolve()},parseOperator:function(t){const e=this;"operator"!==XX(t.type)&&t.type?e.transform(t,t.type):e.operator(t,t.update?e.operatorExpression(t.update):null)},parseOperatorParameters:function(t){const e=this;if(t.params){const n=e.get(t.id);n||NX("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}},parseParameters:function(t,e){e=e||{};const n=this;for(const r in t){const i=t[r];e[r]=IX(i)?i.map(t=>JX(t,n,e)):JX(i,n,e)}return e},parseStream:function(t){var e,n=this,r=null!=t.filter?n.eventExpression(t.filter):void 0,i=null!=t.stream?n.get(t.stream):void 0;t.source?i=n.events(t.source,t.type,r):t.merge&&(i=(e=t.merge.map(t=>n.get(t)))[0].merge.apply(e[0],e.slice(1))),t.between&&(e=t.between.map(t=>n.get(t)),i=i.between(e[0],e[1])),t.filter&&(i=i.filter(r)),null!=t.throttle&&(i=i.throttle(+t.throttle)),null!=t.debounce&&(i=i.debounce(+t.debounce)),null==i&&NX("Invalid stream definition: "+JSON.stringify(t)),t.consume&&i.consume(!0),n.stream(t,i)},parseUpdate:function(t){var e,n=MX(n=t.source)?n.$ref:n,r=this.get(n),i=t.update,a=void 0;r||NX("Source not defined: "+t.source),e=t.target&&t.target.$expr?this.eventExpression(t.target.$expr):this.get(t.target),i&&i.$expr&&(i.$params&&(a=this.parseParameters(i.$params)),i=this.handlerExpression(i.$expr)),this.update(t,r,e,i,a)},getState:function(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach(n=>{const i=e.signals[n];t.signals(n,i)&&(r[n]=i.value)})}if(t.data){var i=n.data={};Object.keys(e.data).forEach(n=>{const r=e.data[n];t.data(n,r)&&(i[n]=r.input.value)})}return e.subcontext&&!1!==t.recurse&&(n.subcontext=e.subcontext.map(e=>e.getState(t))),n},setState:function(t){var e=this,n=e.dataflow,r=t.data,i=t.signals;Object.keys(i||{}).forEach(t=>{n.update(e.signals[t],i[t],QX)}),Object.keys(r||{}).forEach(t=>{n.pulse(e.data[t].input,n.changeset().remove(DX).insert(r[t]))}),(t.subcontext||[]).forEach((t,n)=>{const r=e.subcontext[n];r&&r.setState(t)})}};var rK={skip:!0};function iK(t,e){var n=t.autosize(),r=t.padding();return e-(n&&"padding"===n.contains?r.left+r.right:0)}function aK(t,e){var n=t.autosize(),r=t.padding();return e-(n&&"padding"===n.contains?r.top+r.bottom:0)}function oK(t,e){return e.modified&&ZI(e.input.value)&&t.indexOf("_:vega:_")}function sK(t,e){return!("parent"===t||e instanceof qn.proxy)}var uK=function(t,e,n,r){var i=t.element();i&&i.setAttribute("title",function(t){return null==t?"":ZI(t)?cK(t):QI(t)&&!cM(t)?(e=t,Object.keys(e).map(t=>{var n=e[t];return t+": "+(ZI(n)?cK(n):lK(n))}).join("\n")):t+"";var e}(r))};function cK(t){return"["+t.map(lK).join(", ")+"]"}function lK(t){return ZI(t)?"[]":QI(t)&&!cM(t)?"{}":t}function dK(t,e){const n=this;if(e=e||{},zn.call(n),e.loader&&n.loader(e.loader),e.logger&&n.logger(e.logger),null!=e.logLevel&&n.logLevel(e.logLevel),e.locale||t.locale){const r=aM({},t.locale,e.locale);n.locale(Object(nn.b)(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=e.renderer||qz,n._scenegraph=new zB;const r=n._scenegraph.root;n._renderer=null,n._tooltip=e.tooltip||uK,n._redraw=!0,n._handler=(new iz).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(t){const e=aM({defaults:{}},t),n=(t,e)=>{e.forEach(e=>{ZI(t[e])&&(t[e]=fM(t[e]))})};return n(e.defaults,["prevent","allow"]),n(e,["view","window","selector"]),e}(t.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(t,e,n){return tK(t,qn,vX,n).parse(e)}(n,t,e.expr);n._runtime=i,n._signals=i.signals,n._bind=(t.bindings||[]).map(t=>({state:null,param:aM({},t)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=iK(n,n._width),n._viewHeight=aK(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(t){var e=t._signals,n=e.width,r=e.height,i=e.padding;function a(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,e=>{t._width=e.size,t._viewWidth=iK(t,e.size),a()},{size:n}),t._resizeHeight=t.add(null,e=>{t._height=e.size,t._viewHeight=aK(t,e.size),a()},{size:r});var o=t.add(null,a,{pad:i});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=r.rank+1,o.rank=i.rank+1}(n),function(t){t.add(null,e=>(t._background=e.bg,t._resize=1,e.bg),{bg:t._signals.background})}(n),function(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:"default",item:null}));t.on(t.events("view","mousemove"),e,(t,n)=>{const r=e.value,i=r?lM(r)?r:r.user:"default",a=n.item&&n.item.cursor||null;return r&&i===r.user&&a==r.item?r:{user:i,item:a}}),t.add(null,(function(e){let n=e.cursor,r=this.value;return lM(n)||(r=n.item,n=n.user),hM(t,n&&"default"!==n?n:r||n),r}),{cursor:e})}(n),n.description(t.description),e.hover&&n.hover(),e.container&&n.initialize(e.container,e.bind)}function fK(t,e){return sM(t._signals,e)?t._signals[e]:XI("Unrecognized signal name: "+dM(e))}function hK(t,e){const n=(t._targets||[]).filter(t=>t._update&&t._update.handler===e);return n.length?n[0]:null}function pK(t,e,n,r){var i=hK(n,r);return i||((i=uL(t,()=>r(e,n.value))).handler=r,t.on(n,null,i)),t}function mK(t,e,n){var r=hK(e,n);return r&&e._targets.remove(r),t}function gK(t,e,n){return t.fields=e||[],t.fname=n,t}function bK(t){return 1===t.length?yK(t[0]):vK(t)}uM(dK,zn,{async evaluate(t,e,n){if(await zn.prototype.evaluate.call(this,t,e),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,i=yM(r=this),a=gM(r),o=bM(r),r._renderer.background(r.background()),r._renderer.resize(a,o,i),r._handler.origin(i),r._resizeListeners.forEach(t=>{try{t(a,o)}catch(t){r.error(t)}})),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(t){this.error(t)}var r,i,a,o;return n&&an(this,n),this},dirty(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=null!=t?t+"":null;return e!==this._desc&&WI(this._el,this._desc=e),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){var r=fK(this,t);return 1===arguments.length?r.value:this.update(r,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",dL(t)):dL(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){return arguments.length?(Gz(t)||XI("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},tooltip(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},loader(t){return arguments.length?(t!==this._loader&&(zn.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(fK(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(t,e,n,r,i,a){this.runAfter(o=>{var s=0;o._autosize=0,o.width()!==n&&(s=1,o.signal("width",n,rK),o._resizeWidth.skip(!0)),o.height()!==r&&(s=1,o.signal("height",r,rK),o._resizeHeight.skip(!0)),o._viewWidth!==t&&(o._resize=1,o._viewWidth=t),o._viewHeight!==e&&(o._resize=1,o._viewHeight=e),o._origin[0]===i[0]&&o._origin[1]===i[1]||(o._resize=1,o._origin=i),s&&o.run("enter"),a&&o.runAfter(t=>t.resize())},!1,1)},addEventListener(t,e,n){var r=e;return n&&!1===n.trap||((r=uL(this,e)).raw=e),this._handler.on(t,r),this},removeEventListener(t,e){for(var n,r,i=this._handler.handlers(t),a=i.length;--a>=0;)if(r=i[a].type,n=i[a].handler,t===r&&(e===n||e===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(t){var e=this._resizeListeners;return e.indexOf(t)<0&&e.push(t),this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},addSignalListener(t,e){return pK(this,t,fK(this,t),e)},removeSignalListener(t,e){return mK(this,fK(this,t),e)},addDataListener(t,e){return pK(this,t,pM(this,t).values,e)},removeDataListener(t,e){return mK(this,pM(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=hM(this,null);this._globalCursor=!!t,e&&hM(this,e)}return this}return this._globalCursor},preventDefault(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},timer:function(t,e){this._timers.push(function(t,e,n){var r=new Hk,i=e;return null==e?(r.restart(t,e,n),r):(r._restart=r.restart,r.restart=function(t,e,n){e=+e,n=null==n?Vk():+n,r._restart((function a(o){o+=i,r._restart(a,i+=e,n),t(o)}),e,n)},r.restart(t,e,n),r)}((function(e){t({timestamp:Date.now(),elapsed:e})}),e))},events:function(t,e,n){var r,i=this,a=new _n(n),o=function(n,r){i.runAsync(null,()=>{"view"===t&&function(t,e){var n=t._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[e]:i?!i[e]:t.preventDefault()))}(i,e)&&n.preventDefault(),a.receive(Hz(i,n,r))})};if("timer"===t)Kz(i,"timer",e)&&i.timer(o,e);else if("view"===t)Kz(i,"view",e)&&i.addEventListener(e,o,Xz);else if("window"===t?Kz(i,"window",e)&&"undefined"!=typeof window&&(r=[window]):"undefined"!=typeof document&&Kz(i,"selector",e)&&(r=document.querySelectorAll(t)),r){for(var s=0,u=r.length;s<u;++s)r[s].addEventListener(e,o);i._eventListeners.push({type:e,sources:r,handler:o})}else i.warn("Can not resolve event source: "+t);return a},finalize:function(){var t,e,n,r=this._tooltip,i=this._timers,a=this._eventListeners;for(t=i.length;--t>=0;)i[t].stop();for(t=a.length;--t>=0;)for(e=(n=a[t]).sources.length;--e>=0;)n.sources[e].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(t,e){return e=[e||"update",(t=[t||"hover"])[0]],this.on(this.events("view","mouseover",Yz),Jz,Zz(t)),this.on(this.events("view","mouseout",Yz),Jz,Zz(e)),this},data:function(t,e){return arguments.length<2?pM(this,t).values.value:mM.call(this,t,bn().remove(JI).insert(e))},change:mM,insert:function(t,e){return mM.call(this,t,bn().insert(e))},remove:function(t,e){return mM.call(this,t,bn().remove(e))},scale:function(t){var e=this._runtime.scales;return sM(e,t)||XI("Unrecognized scale or projection: "+t),e[t].value},initialize:function(t,e){const n=this,r=n._renderType,i=n._eventConfig.bind,a=Gz(r);t=n._el=t?cL(n,t):null,function(t){const e=t.container();e&&(e.setAttribute("role","graphics-document"),e.setAttribute("aria-roleDescription","visualization"),WI(e,t.description()))}(n),a||n.error("Unrecognized renderer type: "+r);const o=a.handler||iz,s=t?a.renderer:a.headless;return n._renderer=s?sL(n,n._renderer,t,s):null,n._handler=function(t,e,n,r){var i=new r(t.loader(),uL(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,yM(t),t);return e&&e.handlers().forEach(t=>{i.on(t.type,t.handler)}),i}(n,n._handler,t,o),n._redraw=!0,t&&"none"!==i&&(e=e?n._elBind=cL(n,e):t.appendChild(Qz("form",{class:"vega-bindings"})),n._bind.forEach(t=>{t.param.element&&"container"!==i&&(t.element=cL(n,t.param.element))}),n._bind.forEach(t=>{tL(n,t.element||e,t)})),n},toImageURL:async function(t,e){t!==qz&&t!==Uz&&t!==Wz&&XI("Unrecognized image type: "+t);const n=await fL(this,t,e);return t===Uz?(r=n.svg(),i=new Blob([r],{type:"image/svg+xml"}),window.URL.createObjectURL(i)):n.canvas().toDataURL("image/png");var r,i},toCanvas:async function(t,e){return(await fL(this,qz,t,e)).canvas()},toSVG:async function(t){return(await fL(this,Uz,t)).svg()},getState:function(t){return this._runtime.getState(t||{data:oK,signals:sK,recurse:!0})},setState:function(t){return this.runAsync(null,e=>{e._trigger=!1,e._runtime.setState(t)},t=>{t._trigger=!0}),this}});const yK=t=>function(e){return e[t]},vK=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function xK(t){throw Error(t)}function wK(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||xK("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&xK("Access path missing closing bracket: "+t),o&&xK("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function kK(t,e,n){const r=wK(t);return t=1===r.length?r[0]:t,gK((n&&n.get||bK)(r),[t],e||t)}kK("id"),gK(t=>t,[],"identity"),gK(()=>0,[],"zero"),gK(()=>1,[],"one"),gK(()=>!0,[],"true"),gK(()=>!1,[],"false");var OK=Array.isArray;function _K(t){return t===Object(t)}const AK=t=>"__proto__"!==t;function CK(t,e,n,r){if(!AK(e))return;let i,a;if(_K(n)&&!OK(n))for(i in a=_K(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?CK(a,i,n[i]):AK(i)&&(a[i]=n[i]);else t[e]=n}function EK(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function SK(t){return t[t.length-1]}function jK(t){return null==t||""===t?null:+t}function NK(t){return null!=t?OK(t)?t:[t]:[]}function TK(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const FK=Object.prototype.hasOwnProperty;function DK(t,e){return FK.call(t,e)}function IK(t){return"string"==typeof t}function MK(t){return OK(t)?"["+t.map(MK)+"]":_K(t)||IK(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}var $K=function(t){return _K(t)?t:{type:t||"pad"}};const RK=t=>+t||0;var BK=function(t){return _K(t)?t.signal?t:{top:RK(t.top),bottom:RK(t.bottom),left:RK(t.left),right:RK(t.right)}:{top:e=RK(t),bottom:e,left:e,right:e};var e};const zK=t=>_K(t)&&!OK(t)?TK({},t):{value:t};function LK(t,e,n,r){if(null!=n){return _K(n)&&!OK(n)||OK(n)&&n.length&&_K(n[0])?t.update[e]=n:t[r||"enter"][e]={value:n},1}return 0}function PK(t,e,n){for(const n in e)LK(t,n,e[n]);for(const e in n)LK(t,e,n[e],"update")}function qK(t,e,n){for(const r in e)n&&DK(n,r)||(t[r]=TK(t[r]||{},e[r]));return t}function WK(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}function UK(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const VK=t=>IK(t)?MK(t):t.signal?`(${t.signal})`:KK(t);function GK(t){if(null!=t.gradient)return function(t){const e=[t.start,t.stop,t.count].map(t=>null==t?null:MK(t));for(;e.length&&null==SK(e);)e.pop();return e.unshift(VK(t.gradient)),`gradient(${e.join(",")})`}(t);let e=t.signal?`(${t.signal})`:t.color?function(t){return t.c?HK("hcl",t.h,t.c,t.l):t.h||t.s?HK("hsl",t.h,t.s,t.l):t.l||t.a?HK("lab",t.l,t.a,t.b):t.r||t.g||t.b?HK("rgb",t.r,t.g,t.b):null}(t.color):null!=t.field?KK(t.field):void 0!==t.value?MK(t.value):void 0;return null!=t.scale&&(e=function(t,e){const n=VK(t.scale);null!=t.range?e=`lerp(_range(${n}), ${+t.range})`:(void 0!==e&&(e=`_scale(${n}, ${e})`),t.band&&(e=(e?e+"+":"")+`_bandwidth(${n})`+(1==+t.band?"":"*"+XK(t.band)),t.extra&&(e=`(datum.extra ? _scale(${n}, datum.extra.value) : ${e})`)),null==e&&(e="0"));return e}(t,e)),void 0===e&&(e=null),null!=t.exponent&&(e=`pow(${e},${XK(t.exponent)})`),null!=t.mult&&(e+="*"+XK(t.mult)),null!=t.offset&&(e+="+"+XK(t.offset)),t.round&&(e=`round(${e})`),e}const HK=(t,e,n,r)=>`(${t}(${[e,n,r].map(GK).join(",")})+'')`;function XK(t){return _K(t)?"("+GK(t)+")":t}function KK(t){return function t(e){let n,r,i;if(e.signal)n="datum",i=e.signal;else if(e.group||e.parent){for(r=Math.max(1,e.level||1),n="item";r-- >0;)n+=".mark.group";e.parent?(i=e.parent,n+=".datum"):i=e.group}else e.datum?(n="datum",i=e.datum):xK("Invalid field reference: "+MK(e));e.signal||(i=IK(i)?wK(i).map(MK).join("]["):t(i));return n+"["+i+"]"}(_K(t)?t:{datum:t})}var YK=function(t,e,n,r,i,a){const o={};(a=a||{}).encoders={$encode:o},t=function(t,e,n,r,i){const a={},o={};let s,u,c,l;for(u in u="lineBreak","text"!==e||null==i[u]||WK(u,t)||UK(a,u,i[u]),("legend"==n||String(n).startsWith("axis"))&&(n=null),l="frame"===n?i.group:"mark"===n?TK({},i.mark,i[e]):null,l)c=WK(u,t)||("fill"===u||"stroke"===u)&&(WK("fill",t)||WK("stroke",t)),c||UK(a,u,l[u]);for(u in NK(r).forEach(e=>{const n=i.style&&i.style[e];for(const e in n)WK(e,t)||UK(a,e,n[e])}),t=TK({},t),a)l=a[u],l.signal?(s=s||{})[u]=l:o[u]=l;return t.enter=TK(o,t.enter),s&&(t.update=TK(s,t.update)),t}(t,e,n,r,i.config);for(const n in t)o[n]=JK(t[n],e,a,i);return a};function JK(t,e,n,r){const i={},a={};for(const e in t)null!=t[e]&&(i[e]=ZK((o=t[e],OK(o)?function(t){let e="";return t.forEach(t=>{const n=GK(t);e+=t.test?`(${t.test})?${n}:`:n}),":"===SK(e)&&(e+="null"),e}(o):GK(o)),r,n,a));var o;return{$expr:{marktype:e,channels:i},$fields:Object.keys(a),$output:Object.keys(t)}}function ZK(t,e,n,r){const i=AX(t,e);return i.$fields.forEach(t=>r[t]=1),TK(n,i.$params),i.$expr}const QK=["value","update","init","react","bind"];function tY(t,e){xK(t+' for "outer" push: '+MK(e))}var eY=function(t,e){const n=t.name;if("outer"===t.push)e.signals[n]||tY("No prior signal definition",n),QK.forEach(e=>{void 0!==t[e]&&tY("Invalid property ",e)});else{const r=e.addSignal(n,t.value);!1===t.react&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}};function nY(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function rY(t,e,n,r){return new nY(t,e,n,r)}function iY(t,e){return rY("operator",t,e)}function aY(t){const e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function oY(t,e){return e?{$field:t,$name:e}:{$field:t}}const sY=oY("key");function uY(t,e){return{$compare:t,$order:e}}function cY(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}function lY(t){return t&&t.signal}function dY(t){if(lY(t))return!0;if(_K(t))for(const e in t)if(dY(t[e]))return!0;return!1}function fY(t,e){return null!=t?t:e}function hY(t){return t&&t.signal||t}function pY(t,e){return(t.merge?mY:t.stream?gY:t.type?bY:xK("Invalid stream specification: "+MK(t)))(t,e)}function mY(t,e){const n=yY({merge:t.merge.map(t=>pY(t,e))},t,e);return e.addStream(n).id}function gY(t,e){const n=yY({stream:pY(t.stream,e)},t,e);return e.addStream(n).id}function bY(t,e){let n;var r;"timer"===t.type?(n=e.event("timer",t.throttle),t={between:t.between,filter:t.filter}):n=e.event("scope"===(r=t.source)?"view":r||"view",t.type);const i=yY({stream:n},t,e);return 1===Object.keys(i).length?n:e.addStream(i).id}function yY(t,e,n){let r=e.between;return r&&(2!==r.length&&xK('Stream "between" parameter must have 2 entries: '+MK(e)),t.between=[pY(r[0],n),pY(r[1],n)]),r=e.filter?[].concat(e.filter):[],(e.marktype||e.markname||e.markrole)&&r.push(function(t,e,n){const r="event.item";return r+(t&&"*"!==t?"&&"+r+".mark.marktype==='"+t+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(e?"&&"+r+".mark.name==='"+e+"'":"")}(e.marktype,e.markname,e.markrole)),"scope"===e.source&&r.push("inScope(event.item)"),r.length&&(t.filter=AX("("+r.join(")&&(")+")",n).$expr),null!=(r=e.throttle)&&(t.throttle=+r),null!=(r=e.debounce)&&(t.debounce=+r),e.consume&&(t.consume=!0),t}const vY=/[[\]{}]/,xY={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let wY,kY;function OY(t,e,n){return wY=e||"view",kY=n||xY,AY(t.trim()).map(CY)}function _Y(t,e,n,r,i){const a=t.length;let o,s=0;for(;e<a;++e){if(o=t[e],!s&&o===n)return e;i&&i.indexOf(o)>=0?--s:r&&r.indexOf(o)>=0&&++s}return e}function AY(t){const e=[],n=t.length;let r=0,i=0;for(;i<n;)i=_Y(t,i,",","[{","]}"),e.push(t.substring(r,i).trim()),r=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function CY(t){return"["===t[0]?function(t){const e=t.length;let n,r=1;if(r=_Y(t,r,"]","[","]"),r===e)throw"Empty between selector: "+t;if(n=AY(t.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+t;if(">"!==(t=t.slice(r+1).trim())[0])throw"Expected '>' after between selector: "+t;n=n.map(CY);const i=CY(t.slice(1).trim());if(i.between)return{between:n,stream:i};i.between=n;return i}(t):function(t){const e={source:wY},n=[];let r,i,a=[0,0],o=0,s=0,u=t.length,c=0;if("}"===t[u-1]){if(c=t.lastIndexOf("{"),!(c>=0))throw"Unmatched right brace: "+t;try{a=function(t){const e=t.split(",");if(!t.length||e.length>2)throw t;return e.map(e=>{const n=+e;if(n!=n)throw t;return n})}(t.substring(c+1,u-1))}catch(e){throw"Invalid throttle specification: "+t}t=t.slice(0,c).trim(),u=t.length,c=0}if(!u)throw t;"@"===t[0]&&(o=++c);r=_Y(t,c,":"),r<u&&(n.push(t.substring(s,r).trim()),s=c=++r);if(c=_Y(t,c,"["),c===u)n.push(t.substring(s,u).trim());else if(n.push(t.substring(s,c).trim()),i=[],s=++c,s===u)throw"Unmatched left bracket: "+t;for(;c<u;){if(c=_Y(t,c,"]"),c===u)throw"Unmatched left bracket: "+t;if(i.push(t.substring(s,c).trim()),c<u-1&&"["!==t[++c])throw"Expected left bracket: "+t;s=++c}if(!(u=n.length)||vY.test(n[u-1]))throw"Invalid event selector: "+t;u>1?(e.type=n[1],o?e.markname=n[0].slice(1):(l=n[0],kY[l]?e.marktype=n[0]:e.source=n[0])):e.type=n[0];var l;"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1));null!=i&&(e.filter=i);a[0]&&(e.throttle=a[0]);a[1]&&(e.debounce=a[1]);return e}(t)}const EY={code:"_.$value",ast:{type:"Identifier",value:"value"}};var SY=function(t,e,n){const r=t.encode,i={target:n};let a=t.events,o=t.update,s=[];a||xK("Signal update missing events specification."),IK(a)&&(a=OY(a,e.isSubscope()?"scope":"view")),a=NK(a).filter(t=>t.signal||t.scale?(s.push(t),0):1),s.length>1&&(s=[jY(s)]),a.length&&s.push(a.length>1?{merge:a}:a[0]),null!=r&&(o&&xK("Signal encode and update are mutually exclusive."),o="encode(item(),"+MK(r)+")"),i.update=IK(o)?AX(o,e):null!=o.expr?AX(o.expr,e):null!=o.value?o.value:null!=o.signal?{$expr:EY,$params:{$value:e.signalRef(o.signal)}}:xK("Invalid signal update specification."),t.force&&(i.options={force:!0}),s.forEach(t=>e.addUpdate(TK(function(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):pY(t,e)}}(t,e),i)))};function jY(t){return{signal:"["+t.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}const NY=t=>(e,n,r)=>rY(t,n,e||void 0,r),TY=NY("aggregate"),FY=NY("axisticks"),DY=NY("bound"),IY=NY("collect"),MY=NY("compare"),$Y=NY("datajoin"),RY=NY("encode"),BY=NY("expression"),zY=(NY("extent"),NY("facet")),LY=NY("field"),PY=NY("key"),qY=NY("legendentries"),WY=NY("load"),UY=NY("mark"),VY=NY("multiextent"),GY=NY("multivalues"),HY=NY("overlap"),XY=NY("params"),KY=NY("prefacet"),YY=NY("projection"),JY=NY("proxy"),ZY=NY("relay"),QY=NY("render"),tJ=NY("scale"),eJ=NY("sieve"),nJ=NY("sortitems"),rJ=NY("viewlayout"),iJ=NY("values");function aJ(){const t=Js().unknown(void 0),e=t.domain,n=t.range;let r,i,a=[0,1],o=!1,s=0,u=0,c=.5;function l(){const t=e().length,l=a[1]<a[0],d=a[1-l],f=function(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}(t,s,u);let h=a[l-0];r=(d-h)/(f||1),o&&(r=Math.floor(r)),h+=(d-h-r*(t-s))*c,i=r*(1-s),o&&(h=Math.round(h),i=Math.round(i));const p=ki(t).map(t=>h+r*t);return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},t.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(o=!!t,l()):o},t.padding=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),s=u,l()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},t.paddingOuter=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=a[1]<a[0],o=r?n().reverse():n(),s=o.length-1;let u,c,l,d=+t[0],f=+t[1];return d!=d||f!=f||(f<d&&(l=d,d=f,f=l),f<o[0]||d>a[1-r])?void 0:(u=Math.max(0,Vs(o,d)-1),c=d===f?u:Vs(o,f)-1,d-o[u]>i+1e-10&&++u,r&&(l=u,u=s-c,c=s-l),u>c?void 0:e().slice(u,c+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return aJ().domain(e()).range(a).round(o).paddingInner(s).paddingOuter(u).align(c)},l()}var oJ=Array.prototype.map;function sJ(t){return oJ.call(t,jK)}const uJ=Array.prototype.slice;const cJ={};function lJ(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,a,o,s=e[0],u=e[1],c=-1;for(u<s&&(i=s,s=u,u=i),a=0,o=n.length;a<o;++a)n[a]>=s&&n[a]<=u&&(c<0&&(c=a),r=a);if(!(c<0))return s=t.invertExtent(n[c]),u=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=t,n};return r.metadata=function(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}(NK(n)),r}function dJ(t,e,n){return arguments.length>1?(cJ[t]=lJ(t,e,n),this):fJ(t)?cJ[t]:void 0}function fJ(t){return DK(cJ,t)}function hJ(t,e){const n=cJ[t];return n&&n.metadata[e]}function pJ(t){return hJ(t,"discrete")}function mJ(t){return hJ(t,"discretizing")}function gJ(t){return hJ(t,"quantile")}dJ("identity",fc),dJ("linear",dc,"continuous"),dJ("log",wc,["continuous","log"]),dJ("pow",Cc,"continuous"),dJ("sqrt",Ec,"continuous"),dJ("symlog",Tc,"continuous"),dJ("time",Uc,["continuous","temporal"]),dJ("utc",Jc,["continuous","temporal"]),dJ("sequential",tl,["continuous","interpolating"]),dJ("".concat("sequential","-").concat("linear"),tl,["continuous","interpolating"]),dJ("".concat("sequential","-").concat("log"),el,["continuous","interpolating","log"]),dJ("".concat("sequential","-").concat("pow"),rl,["continuous","interpolating"]),dJ("".concat("sequential","-").concat("sqrt"),il,["continuous","interpolating"]),dJ("".concat("sequential","-").concat("symlog"),nl,["continuous","interpolating"]),dJ("".concat("diverging","-").concat("linear"),sl,["continuous","interpolating"]),dJ("".concat("diverging","-").concat("log"),ul,["continuous","interpolating","log"]),dJ("".concat("diverging","-").concat("pow"),ll,["continuous","interpolating"]),dJ("".concat("diverging","-").concat("sqrt"),dl,["continuous","interpolating"]),dJ("".concat("diverging","-").concat("symlog"),cl,["continuous","interpolating"]),dJ("quantile",fl,["discretizing","quantile"]),dJ("quantize",hl,"discretizing"),dJ("threshold",pl,"discretizing"),dJ("bin-ordinal",(function t(){let e=[],n=[];function r(t){return null==t||t!=t?void 0:n[(Hs(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=sJ(t),r):e.slice()},r.range=function(t){return arguments.length?(n=uJ.call(t),r):n.slice()},r.tickFormat=function(t,n){return tu(e[0],SK(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),["discrete","discretizing"]),dJ("ordinal",Js,"discrete"),dJ("band",aJ,"discrete"),dJ("point",(function(){return function t(e){const n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return t(n())},e}(aJ().paddingInner(1))}),"discrete");function bJ(t,e,n){return al(function(t,e){const n=o[function(t){return"interpolate"+t.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}(e||"rgb",n),t)}function yJ(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function vJ(t,e){for(const n in t)wJ(n,e(t[n]))}const xJ={};function wJ(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(xJ[t]=e,this):xJ[t]}vJ({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},yJ),vJ({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},t=>bJ(yJ(t)));let kJ=0;const OJ={min:"min",max:"max",count:"sum"};function _J(t,e){const n=e.getScale(t.name).params;let r;var i;for(r in n.domain=SJ(t.domain,t,e),null!=t.range&&(n.range=function t(e,n,r){const i=n.config.range;let a=e.range;if(a.signal)return n.signalRef(a.signal);if(IK(a)){if(i&&DK(i,a))return e=TK({},e,{range:i[a]}),t(e,n,r);"width"===a?a=[0,{signal:"width"}]:"height"===a?a=pJ(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:xK("Unrecognized scale range value: "+MK(a))}else{if(a.scheme)return r.scheme=OK(a.scheme)?CJ(a.scheme,n):AJ(a.scheme,n),a.extent&&(r.schemeExtent=CJ(a.extent,n)),void(a.count&&(r.schemeCount=AJ(a.count,n)));if(a.step)return void(r.rangeStep=AJ(a.step,n));if(pJ(e.type)&&!OK(a))return SJ(a,e,n);OK(a)||xK("Unsupported range type: "+MK(a))}return a.map(t=>(OK(t)?CJ:AJ)(t,n))}(t,e,n)),null!=t.interpolate&&function(t,e){e.interpolate=AJ(t.type||t),null!=t.gamma&&(e.interpolateGamma=AJ(t.gamma))}(t.interpolate,n),null!=t.nice&&(n.nice=_K(i=t.nice)?{interval:AJ(i.interval),step:AJ(i.step)}:AJ(i)),null!=t.bins&&(n.bins=function(t,e){return t.signal||OK(t)?CJ(t,e):e.objectProperty(t)}(t.bins,e)),t)DK(n,r)||"name"===r||(n[r]=AJ(t[r],e))}function AJ(t,e){return _K(t)?t.signal?e.signalRef(t.signal):xK("Unsupported object: "+MK(t)):t}function CJ(t,e){return t.signal?e.signalRef(t.signal):t.map(t=>AJ(t,e))}function EJ(t){xK("Can not find data set: "+MK(t))}function SJ(t,e,n){if(t)return t.signal?n.signalRef(t.signal):(OK(t)?jJ:t.fields?TJ:NJ)(t,e,n);null==e.domainMin&&null==e.domainMax||xK("No scale domain defined for domainMin/domainMax to override.")}function jJ(t,e,n){return t.map(t=>AJ(t,n))}function NJ(t,e,n){const r=n.getData(t.data);return r||EJ(t.data),pJ(e.type)?r.valuesRef(n,t.field,DJ(t.sort,!1)):gJ(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)}function TJ(t,e,n){const r=t.data,i=t.fields.reduce((t,e)=>(e=IK(e)?{data:r,field:e}:OK(e)||e.signal?function(t,e){const n="_:vega:_"+kJ++,r=IY({});if(OK(t))r.value={$ingest:t};else if(t.signal){const i="setdata("+MK(n)+","+t.signal+")";r.params.input=e.signalRef(i)}return e.addDataPipeline(n,[r,eJ({})]),{data:n,field:"data"}}(e,n):e,t.push(e),t),[]);return(pJ(e.type)?FJ:gJ(e.type)?IJ:MJ)(t,n,i)}function FJ(t,e,n){const r=DJ(t.sort,!0);let i,a;const o=n.map(t=>{const n=e.getData(t.data);return n||EJ(t.data),n.countsRef(e,t.field,r)}),s={groupby:sY,pulse:o};r&&(i=r.op||"count",a=r.field?cY(i,r.field):"count",s.ops=[OJ[i]],s.fields=[e.fieldRef(a)],s.as=[a]),i=e.add(TY(s));const u=e.add(IY({pulse:aY(i)}));return a=e.add(iJ({field:sY,sort:e.sortRef(r),pulse:aY(u)})),aY(a)}function DJ(t,e){return t&&(t.field||t.op?t.field||"count"===t.op?e&&t.field&&t.op&&!OJ[t.op]&&xK("Multiple domain scales can not be sorted using "+t.op):xK("No field provided for sort aggregate op: "+t.op):_K(t)?t.field="key":t={field:"key"}),t}function IJ(t,e,n){const r=n.map(t=>{const n=e.getData(t.data);return n||EJ(t.data),n.domainRef(e,t.field)});return aY(e.add(GY({values:r})))}function MJ(t,e,n){const r=n.map(t=>{const n=e.getData(t.data);return n||EJ(t.data),n.extentRef(e,t.field)});return aY(e.add(VY({extents:r})))}function $J(t,e,n){return OK(t)?t.map(t=>$J(t,e,n)):_K(t)?t.signal?n.signalRef(t.signal):"fit"===e?t:xK("Unsupported parameter object: "+MK(t)):t}const RJ="value",BJ=["size","shape","fill","stroke","strokeWidth","strokeDash","opacity"],zJ={name:1,style:1,interactive:1},LJ={value:0},PJ={value:1};var qJ=function(t){return t.type="group",t.interactive=t.interactive||!1,t};function WJ(t,e){const n=(n,r)=>fY(t[n],fY(e[n],r));return n.isVertical=n=>"vertical"===fY(t.direction,e.direction||(n?e.symbolDirection:e.gradientDirection)),n.gradientLength=()=>fY(t.gradientLength,e.gradientLength||e.gradientWidth),n.gradientThickness=()=>fY(t.gradientThickness,e.gradientThickness||e.gradientHeight),n.entryColumns=()=>fY(t.columns,fY(e.columns,+n.isVertical(!0))),n}function UJ(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function VJ(t,e,n){return`item.anchor === 'start' ? ${t} : item.anchor === 'end' ? ${e} : ${n}`}const GJ=VJ(MK("left"),MK("right"),MK("center"));function HJ(t,e){return e?t?_K(t)?Object.assign({},t,{offset:HJ(t.offset,e)}):{value:t,offset:e}:e:t}var XJ=function(t,e){return e?(t.name=e.name,t.style=e.style||t.style,t.interactive=!!e.interactive,t.encode=qK(t.encode,e,zJ)):t.interactive=!1,t},KJ=function(t,e,n,r){const i=WJ(t,n),a=i.isVertical(),o=i.gradientThickness(),s=i.gradientLength();let u,c,l,d,f;a?(c=[0,1],l=[0,0],d=o,f=s):(c=[0,0],l=[1,0],d=s,f=o);const h={enter:u={opacity:LJ,x:LJ,y:LJ,width:zK(d),height:zK(f)},update:TK({},u,{opacity:PJ,fill:{gradient:e,start:c,stop:l}}),exit:{opacity:LJ}};return PK(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),XJ({type:"rect",role:"legend-gradient",encode:h},r)},YJ=function(t,e,n,r,i){const a=WJ(t,n),o=a.isVertical(),s=a.gradientThickness(),u=a.gradientLength();let c,l,d,f,h="";o?(c="y",d="y2",l="x",f="width",h="1-"):(c="x",d="x2",l="y",f="height");const p={opacity:LJ,fill:{scale:e,field:RJ}};p[c]={signal:h+"datum.perc",mult:u},p[l]=LJ,p[d]={signal:h+"datum.perc2",mult:u},p[f]=zK(s);const m={enter:p,update:TK({},p,{opacity:PJ}),exit:{opacity:LJ}};return PK(m,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")}),XJ({type:"rect",role:"legend-band",key:RJ,from:i,encode:m},r)};var JJ=function(t,e,n,r){const i=WJ(t,e),a=i.isVertical(),o=zK(i.gradientThickness()),s=i.gradientLength();let u,c,l,d,f=i("labelOverlap"),h="";const p={enter:u={opacity:LJ},update:c={opacity:PJ,text:{field:"label"}},exit:{opacity:LJ}};return PK(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:fY(t.labelLimit,e.gradientLabelLimit)}),a?(u.align={value:"left"},u.baseline=c.baseline={signal:'datum.perc<=0?"bottom":datum.perc>=1?"top":"middle"'},l="y",d="x",h="1-"):(u.align=c.align={signal:'datum.perc<=0?"left":datum.perc>=1?"right":"center"'},u.baseline={value:"top"},l="x",d="y"),u[l]=c[l]={signal:h+"datum.perc",mult:s},u[d]=c[d]=o,o.offset=fY(t.labelOffset,e.gradientLabelOffset)||0,f=f?{separation:i("labelSeparation"),method:f,order:"datum.index"}:void 0,XJ({type:"text",role:"legend-label",style:"guide-label",key:RJ,from:r,encode:p,overlap:f},n)},ZJ=function(t,e,n,r,i){const a=WJ(t,e),o=n.entries,s=!(!o||!o.interactive),u=o?o.name:void 0,c=a("clipHeight"),l=a("symbolOffset"),d={data:"value"},f=`(${i}) ? datum.offset : datum.size`,h=c?zK(c):{field:"size"},p="datum.index",m=`max(1, ${i})`;let g,b,y,v,x;h.mult=.5,g={enter:b={opacity:LJ,x:{signal:f,mult:.5,offset:l},y:h},update:y={opacity:PJ,x:b.x,y:b.y},exit:{opacity:LJ}};let w=null,k=null;t.fill||(w=e.symbolBaseFillColor,k=e.symbolBaseStrokeColor),PK(g,{fill:a("symbolFillColor",w),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",k),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")}),BJ.forEach(e=>{t[e]&&(y[e]=b[e]={scale:t[e],field:RJ})});const O=XJ({type:"symbol",role:"legend-symbol",key:RJ,from:d,clip:!!c||void 0,encode:g},n.symbols),_=zK(l);_.offset=a("labelOffset"),g={enter:b={opacity:LJ,x:{signal:f,offset:_},y:h},update:y={opacity:PJ,text:{field:"label"},x:b.x,y:b.y},exit:{opacity:LJ}},PK(g,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});const A=XJ({type:"text",role:"legend-label",style:"guide-label",key:RJ,from:d,encode:g},n.labels);return g={enter:{noBound:{value:!c},width:LJ,height:c?zK(c):LJ,opacity:LJ},exit:{opacity:LJ},update:y={opacity:PJ,row:{signal:null},column:{signal:null}}},a.isVertical(!0)?(v=`ceil(item.mark.items.length / ${m})`,y.row.signal=`${p}%${v}`,y.column.signal=`floor(${p} / ${v})`,x={field:["row",p]}):(y.row.signal=`floor(${p} / ${m})`,y.column.signal=`${p} % ${m}`,x={field:p}),y.column.signal=`(${i})?${y.column.signal}:${p}`,qJ({role:"scope",from:r={facet:{data:r,name:"value",groupby:"index"}},encode:qK(g,o,zJ),marks:[O,A],name:u,interactive:s,sort:x})};const QJ='item.orient === "left"',tZ='item.orient === "right"',eZ=`(${QJ} || ${tZ})`,nZ="datum.vgrad && "+eZ,rZ=VJ('"top"','"bottom"','"middle"'),iZ=`datum.vgrad && ${tZ} ? (${VJ('"right"','"left"','"center"')}) : (${eZ} && !(datum.vgrad && ${QJ})) ? "left" : ${GJ}`,aZ=`item._anchor || (${eZ} ? "middle" : "start")`,oZ=`${nZ} ? (${QJ} ? -90 : 90) : 0`,sZ=`${eZ} ? (datum.vgrad ? (${tZ} ? "bottom" : "top") : ${rZ}) : "top"`;var uZ=function(t,e){let n;return _K(t)&&(t.signal?n=t.signal:t.path?n="pathShape("+cZ(t.path)+")":t.sphere&&(n="geoShape("+cZ(t.sphere)+', {type: "Sphere"})')),n?e.signalRef(n):!!t};function cZ(t){return _K(t)&&t.signal?t.signal:MK(t)}var lZ=function(t){const e=t.role||"";return e.indexOf("axis")&&e.indexOf("legend")&&e.indexOf("title")?"group"===t.type?"scope":e||"mark":e},dZ=function(t){return{marktype:t.type,name:t.name||void 0,role:t.role||lZ(t),zindex:+t.zindex||void 0,aria:t.aria,description:t.description}},fZ=function(t,e){return t&&t.signal?e.signalRef(t.signal):!1!==t},hZ=function(t,e){const n=Wn(t.type);n||xK("Unrecognized transform type: "+MK(t.type));const r=rY(n.type.toLowerCase(),null,pZ(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(r)),r.metadata=n.metadata||{},r};function pZ(t,e,n){const r={},i=t.params.length;for(let a=0;a<i;++a){const i=t.params[a];r[i.name]=mZ(i,e,n)}return r}function mZ(t,e,n){const r=t.type,i=e[t.name];return"index"===r?function(t,e,n){IK(e.from)||xK('Lookup "from" parameter must be a string literal.');return n.getData(e.from).lookupRef(n,e.key)}(0,e,n):void 0!==i?"param"===r?function(t,e,n){const r=e[t.name];return t.array?(OK(r)||xK("Expected an array of sub-parameters. Instead: "+MK(r)),r.map(e=>bZ(t,e,n))):bZ(t,r,n)}(t,e,n):"projection"===r?n.projectionRef(e[t.name]):t.array&&!lY(i)?i.map(e=>gZ(t,e,n)):gZ(t,i,n):void(t.required&&xK("Missing required "+MK(e.type)+" parameter: "+MK(t.name)))}function gZ(t,e,n){const r=t.type;if(lY(e))return wZ(r)?xK("Expression references can not be signals."):kZ(r)?n.fieldRef(e):OZ(r)?n.compareRef(e):n.signalRef(e.signal);{const i=t.expr||kZ(r);return i&&yZ(e)?n.exprRef(e.expr,e.as):i&&vZ(e)?oY(e.field,e.as):wZ(r)?AX(e,n):xZ(r)?aY(n.getData(e).values):kZ(r)?oY(e):OZ(r)?n.compareRef(e):e}}function bZ(t,e,n){const r=t.params.length;let i;for(let n=0;n<r;++n){i=t.params[n];for(const t in i.key)if(i.key[t]!==e[t]){i=null;break}if(i)break}i||xK("Unsupported parameter: "+MK(e));const a=TK(pZ(i,e,n),i.key);return aY(n.add(XY(a)))}const yZ=t=>t&&t.expr,vZ=t=>t&&t.field,xZ=t=>"data"===t,wZ=t=>"expr"===t,kZ=t=>"field"===t,OZ=t=>"compare"===t;function _Z(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:aY(e.getData(t.data).output)}function AZ(t,e,n,r,i){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=i,this.index={}}function CZ(t){return IK(t)?t:null}function EZ(t,e,n){const r=cY(n.op,n.field);let i;if(e.ops){for(let t=0,n=e.as.length;t<n;++t)if(e.as[t]===r)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((i=n.op.signal)?t.signalRef(i):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(r))}function SZ(t,e,n,r,i,a,o){const s=e[n]||(e[n]={}),u=function(t){return _K(t)?("descending"===t.order?"-":"+")+cY(t.op,t.field):""}(a);let c,l,d=CZ(i);if(null!=d&&(t=e.scope,d+=u?"|"+u:"",c=s[d]),!c){const n=a?{field:sY,pulse:e.countsRef(t,i,a)}:{field:t.fieldRef(i),pulse:aY(e.output)};u&&(n.sort=t.sortRef(a)),l=t.add(rY(r,void 0,n)),o&&(e.index[i]=l),c=aY(l),null!=d&&(s[d]=c)}return c}AZ.fromEntries=function(t,e){const n=e.length,r=e[n-1],i=e[n-2];let a=e[0],o=null,s=1;for(a&&"load"===a.type&&(a=e[1]),t.add(e[0]);s<n;++s)e[s].params.pulse=aY(e[s-1]),t.add(e[s]),"aggregate"===e[s].type&&(o=e[s]);return new AZ(t,a,i,r,o)},AZ.prototype={countsRef(t,e,n){const r=this,i=r.counts||(r.counts={}),a=CZ(e);let o,s,u;return null!=a&&(t=r.scope,o=i[a]),o?n&&n.field&&EZ(t,o.agg.params,n):(u={groupby:t.fieldRef(e,"key"),pulse:aY(r.output)},n&&n.field&&EZ(t,u,n),s=t.add(TY(u)),o=t.add(IY({pulse:aY(s)})),o={agg:s,ref:aY(o)},null!=a&&(i[a]=o)),o.ref},tuplesRef(){return aY(this.values)},extentRef(t,e){return SZ(t,this,"extent","extent",e,!1)},domainRef(t,e){return SZ(t,this,"domain","values",e,!1)},valuesRef(t,e,n){return SZ(t,this,"vals","values",e,n||!0)},lookupRef(t,e){return SZ(t,this,"lookup","tupleindex",e,!1)},indataRef(t,e){return SZ(t,this,"indata","tupleindex",e,!0,!0)}};var jZ=function(t,e,n){const r=t.remove,i=t.insert,a=t.toggle,o=t.modify,s=t.values,u=e.add(iY()),c="if("+t.trigger+',modify("'+n+'",'+[i,r,a,o,s].map(t=>null==t?"null":t).join(",")+"),0)",l=AX(c,e);u.update=l.$expr,u.params=l.$params},NZ=function(t,e){const n=lZ(t),r="group"===t.type,i=t.from&&t.from.facet,a=t.overlap;let o,s,u,c,l,d,f,h=t.layout||"scope"===n||"frame"===n;const p="mark"===n||h||i,m=function(t,e,n){let r,i,a,o,s;return t?(r=t.facet)&&(e||xK("Only group marks can be faceted."),null!=r.field?o=s=_Z(r,n):(t.data?s=aY(n.getData(t.data).aggregate):(a=hZ(TK({type:"aggregate",groupby:NK(r.groupby)},r.aggregate),n),a.params.key=n.keyRef(r.groupby),a.params.pulse=_Z(r,n),o=s=aY(n.add(a))),i=n.keyRef(r.groupby,!0))):o=aY(n.add(IY(null,[{}]))),o||(o=_Z(t,n)),{key:i,pulse:o,parent:s}}(t.from,r,e);s=e.add($Y({key:m.key||(t.key?oY(t.key):void 0),pulse:m.pulse,clean:!r}));const g=aY(s);s=u=e.add(IY({pulse:g})),s=e.add(UY({markdef:dZ(t),interactive:fZ(t.interactive,e),clip:uZ(t.clip,e),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:aY(s)}));const b=aY(s);s=c=e.add(RY(YK(t.encode,t.type,n,t.style,e,{mod:!1,pulse:b}))),s.params.parent=e.encode(),t.transform&&t.transform.forEach(t=>{const n=hZ(t,e),r=n.metadata;(r.generates||r.changes)&&xK("Mark transforms should not generate new data."),r.nomod||(c.params.mod=!0),n.params.pulse=aY(s),e.add(s=n)}),t.sort&&(s=e.add(nJ({sort:e.compareRef(t.sort),pulse:aY(s)})));const y=aY(s);(i||h)&&(h=e.add(rJ({layout:e.objectProperty(t.layout),legends:e.legends,mark:b,pulse:y})),d=aY(h));const v=e.add(DY({mark:b,pulse:d||y}));f=aY(v),r&&(p&&(o=e.operators,o.pop(),h&&o.pop()),e.pushState(y,d||f,g),i?function(t,e,n){const r=t.from.facet,i=r.name,a=_Z(r,e);let o;r.name||xK("Facet must have a name: "+MK(r)),r.data||xK("Facet must reference a data set: "+MK(r)),r.field?o=e.add(KY({field:e.fieldRef(r.field),pulse:a})):r.groupby?o=e.add(zY({key:e.keyRef(r.groupby),group:aY(e.proxy(n.parent)),pulse:a})):xK("Facet must specify groupby or field: "+MK(r));const s=e.fork(),u=s.add(IY()),c=s.add(eJ({pulse:aY(u)}));s.addData(i,new AZ(s,u,u,c)),s.addSignal("parent",null),o.params.subflow={$subflow:s.parse(t).toRuntime()}}(t,e,m):p?function(t,e,n){const r=e.add(KY({pulse:n.pulse})),i=e.fork();i.add(eJ()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(t).toRuntime()}}(t,e,m):e.parse(t),e.popState(),p&&(h&&o.push(h),o.push(v))),a&&(f=function(t,e,n){const r=t.method,i=t.bound,a=t.separation,o={separation:lY(a)?n.signalRef(a.signal):a,method:lY(r)?n.signalRef(r.signal):r,pulse:e};t.order&&(o.sort=n.compareRef({field:t.order}));if(i){const t=i.tolerance;o.boundTolerance=lY(t)?n.signalRef(t.signal):+t,o.boundScale=n.scaleRef(i.scale),o.boundOrient=i.orient}return aY(n.add(HY(o)))}(a,f,e));const x=e.add(QY({pulse:f})),w=e.add(eJ({pulse:aY(x)},void 0,e.parent()));null!=t.name&&(l=t.name,e.addData(l,new AZ(e,u,x,w)),t.on&&t.on.forEach(t=>{(t.insert||t.remove||t.toggle)&&xK("Marks only support modify triggers."),jZ(t,e,l)}))};var TZ=function(t,e){const n=e.config.legend,r=t.encode||{},i=WJ(t,n),a=r.legend||{},o=a.name||void 0,s=a.interactive,u=a.style,c={};let l,d,f,h=0;BJ.forEach(e=>t[e]?(c[e]=t[e],h=h||t[e]):0),h||xK("Missing valid scale for legend.");const p=function(t,e){let n=t.type||"symbol";t.type||1!==function(t){return BJ.reduce((e,n)=>e+(t[n]?1:0),0)}(t)||!t.fill&&!t.stroke||(n=hJ(e,"continuous")?"gradient":mJ(e)?"discrete":"symbol");return"gradient"!==n?n:mJ(e)?"discrete":"gradient"}(t,e.scaleType(h)),m={title:null!=t.title,scales:c,type:p,vgrad:"symbol"!==p&&i.isVertical()},g=aY(e.add(IY(null,[m]))),b=aY(e.add(qY(d={type:p,scale:e.scaleRef(h),count:e.objectProperty(i("tickCount")),limit:e.property(i("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return"gradient"===p?(f=[KJ(t,h,n,r.gradient),JJ(t,n,r.labels,b)],d.count=d.count||e.signalRef(`max(2,2*floor((${hY(i.gradientLength())})/100))`)):"discrete"===p?f=[YJ(t,h,n,r.gradient,b),JJ(t,n,r.labels,b)]:(l=function(t,e){const n=WJ(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(t,n),f=[ZJ(t,n,r,b,hY(l.columns))],d.size=function(t,e,n){const r=hY(DZ("size",t,n)),i=hY(DZ("strokeWidth",t,n)),a=hY(function(t,e,n){return UJ("fontSize",t)||function(t,e,n){const r=e.config.style[n];return r&&r[t]}("fontSize",e,n)}(n[1].encode,e,"guide-label"));return AX(`max(ceil(sqrt(${r})+${i}),${a})`,e)}(t,e,f[0].marks)),f=[qJ({role:"legend-entry",from:g,encode:{enter:{x:{value:0},y:{value:0}}},marks:f,layout:l,interactive:s})],m.title&&f.push(function(t,e,n,r){const i=WJ(t,e),a={enter:{opacity:LJ},update:{opacity:PJ,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:LJ}};return PK(a,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:aZ},angle:{signal:oZ},align:{signal:iZ},baseline:{signal:sZ},text:t.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),XJ({type:"text",role:"legend-title",style:"guide-title",from:r,encode:a},n)}(t,n,r.title,g)),NZ(qJ({role:"legend",from:g,encode:qK(FZ(i,t,n),a,zJ),marks:f,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:o,interactive:s,style:u}),e)};function FZ(t,e,n){const r={enter:{},update:{}};return PK(r,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType}),r}function DZ(t,e,n){return e[t]?`scale("${e[t]}",datum)`:UJ(t,n[0].encode)}var IZ=function(t,e){const n=WJ(t=IK(t)?{text:t}:t,e.config.title),r=t.encode||{},i=r.group||{},a=i.name||void 0,o=i.interactive,s=i.style,u=[],c=aY(e.add(IY(null,[{}])));return u.push(function(t,e,n,r){const i={value:0},a=t.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return PK(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),XJ({type:"text",role:"title-text",style:"group-title",from:r,encode:o},n)}(t,n,function(t){const e=t.encode;return e&&e.title||TK({name:t.name,interactive:t.interactive,style:t.style},e)}(t),c)),t.subtitle&&u.push(function(t,e,n,r){const i={value:0},a=t.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return PK(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),XJ({type:"text",role:"title-subtitle",style:"group-subtitle",from:r,encode:o},n)}(t,n,r.subtitle,c)),NZ(qJ({role:"title",from:c,encode:MZ(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:a,interactive:o,style:s}),e)};function MZ(t,e){const n={enter:{},update:{}};return PK(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:GJ},angle:{signal:'item.orient==="left"?-90:item.orient==="right"?90:0'},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),qK(n,e,zJ)}function $Z(t,e){const n=[];t.transform&&t.transform.forEach(t=>{n.push(hZ(t,e))}),t.on&&t.on.forEach(n=>{jZ(n,e,t.name)}),e.addDataPipeline(t.name,function(t,e,n){const r=[];let i,a,o,s,u,c=null,l=!1,d=!1;t.values?dY(t.values)||dY(t.format)?(r.push(BZ(e,t)),r.push(c=RZ())):r.push(c=RZ({$ingest:t.values,$format:t.format})):t.url?dY(t.url)||dY(t.format)?(r.push(BZ(e,t)),r.push(c=RZ())):r.push(c=RZ({$request:t.url,$format:t.format})):t.source&&(c=i=NK(t.source).map(t=>aY(e.getData(t).output)),r.push(null));for(a=0,o=n.length;a<o;++a)s=n[a],u=s.metadata,c||u.source||r.push(c=RZ()),r.push(s),u.generates&&(d=!0),u.modifies&&!d&&(l=!0),u.source?c=s:u.changes&&(c=null);i&&(o=i.length-1,r[0]=ZY({derive:l,pulse:o?i:i[0]}),(l||o)&&r.splice(1,0,RZ()));c||r.push(RZ());return r.push(eJ({})),r}(t,e,n))}function RZ(t){const e=IY({},t);return e.metadata={source:!0},e}function BZ(t,e){return WY({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}const zZ=t=>"bottom"===t||"top"===t,LZ=(t,e,n)=>lY(t)?GZ(t.signal,e,n):"left"===t||"top"===t?e:n,PZ=(t,e,n)=>lY(t)?UZ(t.signal,e,n):zZ(t)?e:n,qZ=(t,e,n)=>lY(t)?VZ(t.signal,e,n):zZ(t)?n:e,WZ=(t,e,n)=>lY(t)?HZ(t.signal,e,n):"top"===t?{value:e}:{value:n},UZ=(t,e,n)=>KZ(`${t} === 'top' || ${t} === 'bottom'`,e,n),VZ=(t,e,n)=>KZ(`${t} !== 'top' && ${t} !== 'bottom'`,e,n),GZ=(t,e,n)=>JZ(`${t} === 'left' || ${t} === 'top'`,e,n),HZ=(t,e,n)=>JZ(t+" === 'top'",e,n),XZ=(t,e,n)=>JZ(t+" === 'right'",e,n),KZ=(t,e,n)=>(e=null!=e?zK(e):e,n=null!=n?zK(n):n,YZ(e)&&YZ(n)?{signal:`${t} ? (${e=e?e.signal||MK(e.value):null}) : (${n=n?n.signal||MK(n.value):null})`}:[TK({test:t},e)].concat(n||[])),YZ=t=>null==t||1===Object.keys(t).length,JZ=(t,e,n)=>({signal:`${t} ? (${ZZ(e)}) : (${ZZ(n)})`}),ZZ=t=>lY(t)?t.signal:null==t?null:MK(t),QZ=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function tQ(t,e,n,r){let i;if(e&&DK(e,t))return e[t];if(DK(n,t))return n[t];if(t.startsWith("title")){switch(t){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=t[5].toLowerCase()+t.slice(6)}return r["guide-title"][i]}if(t.startsWith("label")){switch(t){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=t[5].toLowerCase()+t.slice(6)}return r["guide-label"][i]}return null}function eQ(t){const e={};for(const n of t)if(n)for(const t in n)e[t]=1;return Object.keys(e)}function nQ(t,e){return{scale:t.scale,range:e}}var rQ=function(t,e,n,r,i){const a=WJ(t,e),o=t.orient,s=t.gridScale,u=LZ(o,1,-1),c=function(t,e){if(1===e);else if(_K(t)){let n=t=TK({},t);for(;null!=n.mult;){if(!_K(n.mult))return n.mult=lY(e)?{signal:`(${n.mult}) * (${e.signal})`}:n.mult*e,t;n=n.mult=TK({},n.mult)}n.mult=e}else t=lY(e)?{signal:`(${e.signal}) * (${t||0})`}:e*(t||0);return t}(t.offset,u);let l,d,f;const h={enter:l={opacity:LJ},update:f={opacity:PJ},exit:d={opacity:LJ}};PK(h,{stroke:a("gridColor"),strokeCap:a("gridCap"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});const p={scale:t.scale,field:RJ,band:i.band,extra:i.extra,offset:i.offset,round:a("tickRound")},m=PZ(o,{signal:"height"},{signal:"width"}),g=s?{scale:s,range:0,mult:u,offset:c}:{value:0,offset:c},b=s?{scale:s,range:1,mult:u,offset:c}:TK(m,{mult:u,offset:c});return l.x=f.x=PZ(o,p,g),l.y=f.y=qZ(o,p,g),l.x2=f.x2=qZ(o,b),l.y2=f.y2=PZ(o,b),d.x=PZ(o,p),d.y=qZ(o,p),XJ({type:"rule",role:"axis-grid",key:RJ,from:r,encode:h},n)};function iQ(t,e,n,r,i){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+i+")"}}var aQ=function(t,e,n,r,i,a){const o=WJ(t,e),s=t.orient,u=t.scale,c=LZ(s,-1,1),l=hY(o("labelFlush")),d=hY(o("labelFlushOffset")),f=o("labelAlign"),h=o("labelBaseline");let p,m=0===l||!!l;const g=zK(i);g.mult=c,g.offset=zK(o("labelPadding")||0),g.offset.mult=c;const b={scale:u,field:RJ,band:.5,offset:HJ(a.offset,o("labelOffset"))},y=PZ(s,m?iQ(u,l,'"left"','"right"','"center"'):{value:"center"},((t,e,n)=>lY(t)?XZ(t.signal,e,n):"right"===t?{value:e}:{value:n})(s,"left","right")),v=PZ(s,WZ(s,"bottom","top"),m?iQ(u,l,'"top"','"bottom"','"middle"'):{value:"middle"}),x=iQ(u,l,`-(${d})`,d,0);m=m&&d;const w={opacity:LJ,x:PZ(s,b,g),y:qZ(s,b,g)},k={enter:w,update:p={opacity:PJ,text:{field:"label"},x:w.x,y:w.y,align:y,baseline:v},exit:{opacity:LJ,x:w.x,y:w.y}};PK(k,{dx:!f&&m?PZ(s,x):null,dy:!h&&m?qZ(s,x):null}),PK(k,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:f,baseline:h});const O=o("labelBound");let _=o("labelOverlap");return _=_||O?{separation:o("labelSeparation"),method:_,order:"datum.index",bound:O?{scale:u,orient:s,tolerance:O}:null}:void 0,p.align!==y&&(p.align=QZ(p.align,y)),p.baseline!==v&&(p.baseline=QZ(p.baseline,v)),XJ({type:"text",role:"axis-label",style:"guide-label",key:RJ,from:r,encode:k,overlap:_},n)},oQ=function(t,e,n,r){const i=WJ(t,e),a=t.orient,o=LZ(a,-1,1);let s,u;const c={enter:s={opacity:LJ,anchor:zK(i("titleAnchor",null)),align:{signal:GJ}},update:u=TK({},s,{opacity:PJ,text:zK(t.title)}),exit:{opacity:LJ}},l={signal:`lerp(range("${t.scale}"), ${VJ(0,1,.5)})`};return u.x=PZ(a,l),u.y=qZ(a,l),s.angle=PZ(a,LJ,((t,e)=>0===e?0:lY(t)?{signal:`(${t.signal}) * ${e}`}:{value:t*e})(o,90)),s.baseline=PZ(a,WZ(a,"bottom","top"),{value:"bottom"}),u.angle=s.angle,u.baseline=s.baseline,PK(c,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(t,e,n,r){const i=(t,e)=>null!=t?(n.update[e]=QZ(zK(t),n.update[e]),!1):!WK(e,r),a=i(t("titleX"),"x"),o=i(t("titleY"),"y");n.enter.auto=o===a?zK(o):PZ(e,zK(o),zK(a))}(i,a,c,n),c.update.align=QZ(c.update.align,s.align),c.update.angle=QZ(c.update.angle,s.angle),c.update.baseline=QZ(c.update.baseline,s.baseline),XJ({type:"text",role:"axis-title",style:"guide-title",from:r,encode:c},n)};var sQ=function(t,e){const n=function(t,e){var n,r,i,a,o,s,u,c,l=e.config,d=l.style,f=l.axis,h="band"===e.scaleType(t.scale)&&l.axisBand,p=t.orient;if(lY(p)){const t=eQ([l.axisX,l.axisY]),e=eQ([l.axisTop,l.axisBottom,l.axisLeft,l.axisRight]);for(i of(n={},t))n[i]=PZ(p,tQ(i,l.axisX,f,d),tQ(i,l.axisY,f,d));for(i of(r={},e))r[i]=(a=p.signal,o=tQ(i,l.axisTop,f,d),s=tQ(i,l.axisBottom,f,d),u=tQ(i,l.axisLeft,f,d),c=tQ(i,l.axisRight,f,d),{signal:(null!=u?`${a} === 'left' ? (${ZZ(u)}) : `:"")+(null!=s?`${a} === 'bottom' ? (${ZZ(s)}) : `:"")+(null!=c?`${a} === 'right' ? (${ZZ(c)}) : `:"")+(null!=o?`${a} === 'top' ? (${ZZ(o)}) : `:"")+"(null)"})}else n="top"===p||"bottom"===p?l.axisX:l.axisY,r=l["axis"+p[0].toUpperCase()+p.slice(1)];return n||r||h?TK({},f,n,r,h):f}(t,e),r=t.encode||{},i=r.axis||{},a=i.name||void 0,o=i.interactive,s=i.style,u=WJ(t,n),c=function(t){const e=t("tickBand");let n,r,i=t("tickOffset");return e?e.signal?(n={signal:`(${e.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${e.signal}) === 'extent'`},_K(i)||(i={signal:`(${e.signal}) === 'extent' ? 0 : ${i}`})):"extent"===e?(n=1,r=!0,i=0):(n=.5,r=!1):(n=t("bandPosition"),r=t("tickExtra")),{extra:r,band:n,offset:i}}(u),l={scale:t.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:null!=t.title},d=aY(e.add(IY({},[l]))),f=aY(e.add(FY({scale:e.scaleRef(t.scale),extra:e.property(c.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),h=[];let p;return l.grid&&h.push(rQ(t,n,r.grid,f,c)),l.ticks&&(p=u("tickSize"),h.push(function(t,e,n,r,i,a){const o=WJ(t,e),s=t.orient,u=LZ(s,-1,1);let c,l,d;const f={enter:c={opacity:LJ},update:d={opacity:PJ},exit:l={opacity:LJ}};PK(f,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const h=zK(i);h.mult=u;const p={scale:t.scale,field:RJ,band:a.band,extra:a.extra,offset:a.offset,round:o("tickRound")};return d.y=c.y=PZ(s,LJ,p),d.y2=c.y2=PZ(s,h),l.x=PZ(s,p),d.x=c.x=qZ(s,LJ,p),d.x2=c.x2=qZ(s,h),l.y=qZ(s,p),XJ({type:"rule",role:"axis-tick",key:RJ,from:r,encode:f},n)}(t,n,r.ticks,f,p,c))),l.labels&&(p=l.ticks?p:0,h.push(aQ(t,n,r.labels,f,p,c))),l.domain&&h.push(function(t,e,n,r){const i=WJ(t,e),a=t.orient;let o,s;const u={enter:o={opacity:LJ},update:s={opacity:PJ},exit:{opacity:LJ}};PK(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const c=nQ(t,0),l=nQ(t,1);return o.x=s.x=PZ(a,c,LJ),o.x2=s.x2=PZ(a,l),o.y=s.y=qZ(a,c,LJ),o.y2=s.y2=qZ(a,l),XJ({type:"rule",role:"axis-domain",from:r,encode:u},n)}(t,n,r.domain,d)),l.title&&h.push(oQ(t,n,r.title,d)),NZ(qJ({role:"axis",from:d,encode:qK(uQ(u,t),i,zJ),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:a,interactive:o,style:s}),e)};function uQ(t,e){const n={enter:{},update:{}};return PK(n,{orient:t("orient"),offset:t("offset")||0,position:fY(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:`abs(span(range("${e.scale}")))`},translate:t("translate"),format:e.format,formatType:e.formatType}),n}var cQ=function(t,e,n){const r=NK(t.signals),i=NK(t.scales);return n||r.forEach(t=>eY(t,e)),NK(t.projections).forEach(t=>function(t,e){const n=e.config.projection||{},r={};for(const n in t)"name"!==n&&(r[n]=$J(t[n],n,e));for(const t in n)null==r[t]&&(r[t]=$J(n[t],t,e));e.addProjection(t.name,r)}(t,e)),i.forEach(t=>function(t,e){const n=t.type||"linear";fJ(n)||xK("Unrecognized scale type: "+MK(n)),e.addScale(t.name,{type:n,domain:void 0})}(t,e)),NK(t.data).forEach(t=>$Z(t,e)),i.forEach(t=>_J(t,e)),(n||r).forEach(t=>function(t,e){const n=e.getSignal(t.name);let r=t.update;t.init&&(r?xK("Signals can not include both init and update expressions."):(r=t.init,n.initonly=!0)),r&&(r=AX(r,e),n.update=r.$expr,n.params=r.$params),t.on&&t.on.forEach(t=>SY(t,e,n.id))}(t,e)),NK(t.axes).forEach(t=>sQ(t,e)),NK(t.marks).forEach(t=>NZ(t,e)),NK(t.legends).forEach(t=>TZ(t,e)),t.title&&IZ(t.title,e),e.parseLambdas(),e};function lQ(t,e){const n=e.config,r=aY(e.root=e.add(iY())),i=function(t,e){const n=n=>fY(t[n],e[n]),r=[dQ("background",n("background")),dQ("autosize",$K(n("autosize"))),dQ("padding",BK(n("padding"))),dQ("width",n("width")||0),dQ("height",n("height")||0)],i=r.reduce((t,e)=>(t[e.name]=e,t),{}),a={};return NK(t.signals).forEach(t=>{DK(i,t.name)?t=TK(i[t.name],t):r.push(t),a[t.name]=t}),NK(e.signals).forEach(t=>{DK(a,t.name)||DK(i,t.name)||r.push(t)}),r}(t,n);i.forEach(t=>eY(t,e)),e.description=t.description||n.description,e.eventConfig=n.events,e.legends=e.objectProperty(n.legend&&n.legend.layout),e.locale=n.locale;const a=e.add(IY()),o=e.add(RY(YK((t=>qK({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t))(t.encode),"group","frame",t.style,e,{pulse:aY(a)}))),s=e.add(rJ({layout:e.objectProperty(t.layout),legends:e.legends,autosize:e.signalRef("autosize"),mark:r,pulse:aY(o)}));e.operators.pop(),e.pushState(aY(o),aY(s),null),cQ(t,e,i),e.operators.push(s);let u=e.add(DY({mark:r,pulse:aY(s)}));return u=e.add(QY({pulse:aY(u)})),u=e.add(eJ({pulse:aY(u)})),e.addData("root",new AZ(e,a,a,u)),e}function dQ(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function fQ(t,e){this.config=t||{},this.options=e||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function hQ(t){this.config=t.config,this.options=t.options,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}function pQ(t){return(OK(t)?mQ:gQ)(t)}function mQ(t){const e=t.length;let n="[";for(let r=0;r<e;++r){const e=t[r];n+=(r>0?",":"")+(_K(e)?e.signal||pQ(e):MK(e))}return n+"]"}function gQ(t){let e,n,r="{",i=0;for(e in t)n=t[e],r+=(++i>1?",":"")+MK(e)+":"+(_K(n)?n.signal||pQ(n):MK(n));return r+"}"}fQ.prototype=hQ.prototype={parse(t){return cQ(t,this)},fork(){return new hQ(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach(e=>{e.$ref=t.id}),t.refs=null),t},proxy(t){const e=t instanceof nY?aY(t):t;return this.add(JY({value:e}))},addStream(t){return this.streams.push(t),t.id=this.id(),t},addUpdate(t){return this.updates.push(t),t},finish(){let t,e;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(t,e,n){let r,i;t&&(r=t.data||(t.data={}),i=r[e]||(r[e]=[]),i.push(n))}for(t in this.data){e=this.data[t],n(e.input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values");for(const r in e.index)n(e.index[r],t,"index:"+r)}return this},pushState(t,e,n){this._encode.push(aY(this.add(eJ({pulse:t})))),this._parent.push(e),this._lookup.push(n?aY(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return SK(this._parent)},encode(){return SK(this._encode)},lookup(){return SK(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if(IK(t))return oY(t,e);t.signal||xK("Unsupported field reference: "+MK(t));const n=t.signal;let r=this.field[n];if(!r){const t={name:this.signalRef(n)};e&&(t.as=e),this.field[n]=r=aY(this.add(LY(t)))}return r},compareRef(t){let e=!1;const n=t=>lY(t)?(e=!0,this.signalRef(t.signal)):function(t){return t&&t.expr}(t)?(e=!0,this.exprRef(t.expr)):t,r=NK(t.field).map(n),i=NK(t.order).map(n);return e?aY(this.add(MY({fields:r,orders:i}))):uY(r,i)},keyRef(t,e){let n=!1;const r=this.signals;return t=NK(t).map(t=>lY(t)?(n=!0,aY(r[t.signal])):t),n?aY(this.add(PY({fields:t,flat:e}))):function(t,e){const n={$key:t};return e&&(n.$flat=!0),n}(t,e)},sortRef(t){if(!t)return t;const e=cY(t.op,t.field),n=t.order||"ascending";return n.signal?aY(this.add(MY({fields:e,orders:this.signalRef(n.signal)}))):uY(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},hasOwnSignal(t){return DK(this.signals,t)},addSignal(t,e){this.hasOwnSignal(t)&&xK("Duplicate signal name: "+MK(t));const n=e instanceof nY?e:this.add(iY(e));return this.signals[t]=n},getSignal(t){return this.signals[t]||xK("Unrecognized signal name: "+MK(t)),this.signals[t]},signalRef(t){return this.signals[t]?aY(this.signals[t]):(DK(this.lambdas,t)||(this.lambdas[t]=this.add(iY(null))),aY(this.lambdas[t]))},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const n=t[e],r=AX(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return t&&_K(t)?this.signalRef(t.signal||pQ(t)):t},exprRef(t,e){const n={expr:AX(t,this)};return e&&(n.expr.$name=e),aY(this.add(BY(n)))},addBinding(t,e){this.bindings||xK("Nested signals do not support binding: "+MK(t)),this.bindings.push(TK({signal:t},e))},addScaleProj(t,e){DK(this.scales,t)&&xK("Duplicate scale or projection name: "+MK(t)),this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,tJ(e))},addProjection(t,e){this.addScaleProj(t,YY(e))},getScale(t){return this.scales[t]||xK("Unrecognized scale name: "+MK(t)),this.scales[t]},scaleRef(t){return aY(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){return DK(this.data,t)&&xK("Duplicate data set name: "+MK(t)),this.data[t]=e},getData(t){return this.data[t]||xK("Undefined data set name: "+MK(t)),this.data[t]},addDataPipeline(t,e){return DK(this.data,t)&&xK("Duplicate data set name: "+MK(t)),this.addData(t,AZ.fromEntries(this,e))}};var bQ=function(t,e,n){return _K(t)||xK("Input Vega specification must be an object."),lQ(t,new fQ(e=function(...t){return t.reduce((t,e)=>{for(const n in e)if("signals"===n)t.signals=EK(t.signals,e.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;CK(t,n,e[n],r)}return t},{})}({description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:"#4c78a8"},area:{fill:"#4c78a8"},image:null,line:{stroke:"#4c78a8",strokeWidth:2},path:{stroke:"#4c78a8"},rect:{fill:"#4c78a8"},rule:{stroke:"#000"},shape:{stroke:"#4c78a8"},symbol:{fill:"#4c78a8",size:64},text:{fill:"#000",font:"sans-serif",fontSize:11},trail:{fill:"#4c78a8",size:2},style:{"guide-label":{fill:"#000",font:"sans-serif",fontSize:10},"guide-title":{fill:"#000",font:"sans-serif",fontSize:11,fontWeight:"bold"},"group-title":{fill:"#000",font:"sans-serif",fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:"#000",font:"sans-serif",fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:"#ddd"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:"#888",grid:!1,gridWidth:1,gridColor:"#ddd",labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:"#888",tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:"#ddd",gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:"#888",titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}},e,t.config),n)).toRuntime()};ae(qn,a,s,u,c,l,d,f,h,p,m);var yQ=n(316);Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function t(){var e=isNaN(arguments[0])?1:Number(arguments[0]);return e?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,t.call(r,e-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(t){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var vQ=n(317),xQ=n.n(vQ),wQ=n(318),kQ=n.n(wQ),OQ=n(114),_Q=n.n(OQ);function AQ(t){return!!t.or}function CQ(t){return!!t.and}function EQ(t){return!!t.not}function SQ(t,e){return EQ(t)?{not:SQ(t.not,e)}:CQ(t)?{and:t.and.map(t=>SQ(t,e))}:AQ(t)?{or:t.or.map(t=>SQ(t,e))}:e(t)}const jQ=kQ.a,NQ=xQ.a;function TQ(t,e){const n={};for(const r of e)ce(t,r)&&(n[r]=t[r]);return n}function FQ(t,e){const n=Object.assign({},t);for(const t of e)delete n[t];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(t=>_Q()(t)).join(",")})`};const DQ=_Q.a;function IQ(t){if(be(t))return t;const e=ve(t)?t:_Q()(t);if(e.length<250)return e;let n=0;for(let t=0;t<e.length;t++){n=(n<<5)-n+e.charCodeAt(t),n&=n}return n}function MQ(t){return!1===t||null===t}function $Q(t,e){return t.indexOf(e)>-1}function RQ(t,e){let n=0;for(const[r,i]of t.entries())if(e(i,r,n++))return!0;return!1}function BQ(t,e){let n=0;for(const[r,i]of t.entries())if(!e(i,r,n++))return!1;return!0}function zQ(t,e){for(const n of VQ(e))St(t,n,e[n],!0)}function LQ(t,e){const n=[],r={};let i;for(const a of t)i=e(a),i in r||(r[i]=1,n.push(a));return n}function PQ(t,e){for(const n of t)if(e.has(n))return!0;return!1}function qQ(t){const e=new Set;for(const n of t){const t=ut(n).map((t,e)=>0===e?t:`[${t}]`),r=t.map((e,n)=>t.slice(0,n+1).join(""));for(const t of r)e.add(t)}return e}function WQ(t,e){return void 0===t||void 0===e||PQ(qQ(t),qQ(e))}function UQ(t){return 0===VQ(t).length}const VQ=Object.keys,GQ=Object.values;function HQ(t){const e=[];for(const n in t)ce(t,n)&&e.push({key:n,value:t[n]});return e}function XQ(t){return!0===t||!1===t}function KQ(t){const e=t.replace(/\W/g,"_");return(t.match(/^\d+/)?"_":"")+e}function YQ(t,e){return EQ(t)?"!("+YQ(t.not,e)+")":CQ(t)?"("+t.and.map(t=>YQ(t,e)).join(") && (")+")":AQ(t)?"("+t.or.map(t=>YQ(t,e)).join(") || (")+")":e(t)}function JQ(t,e){if(0===e.length)return!0;const n=e.shift();return n in t&&JQ(t[n],e)&&delete t[n],UQ(t)}function ZQ(t){return t.charAt(0).toUpperCase()+t.substr(1)}function QQ(t,e="datum"){const n=ut(t),r=[];for(let t=1;t<=n.length;t++){const i=`[${n.slice(0,t).map(Ee).join("][")}]`;r.push(`${e}${i}`)}return r.join(" && ")}function t0(t){return t.replace(/(\[|\]|\.|'|")/g,"\\$1")}function e0(t){return""+ut(t).map(t0).join("\\.")}function n0(t,e,n){return t.replace(new RegExp(e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function r0(t){return""+ut(t).join(".")}function i0(t){return t?ut(t).length:0}function a0(...t){for(const e of t)if(void 0!==e)return e}let o0=42;function s0(t){const e=++o0;return t?String(t)+e:e}function u0(t){if(void 0!==t)return(t%360+360)%360}function c0(t){return!!be(t)||!isNaN(t)&&!isNaN(parseFloat(t))}const l0={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function d0(t){return t&&t.condition}const f0=["domain","grid","labels","ticks","title"],h0={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},p0={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},m0=Object.assign(Object.assign({},p0),{style:1,labelExpr:1,encoding:1});function g0(t){return!!m0[t]}VQ(m0);const b0={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},y0=b0.arc,v0=b0.area,x0=b0.bar,w0=b0.image,k0=b0.line,O0=b0.point,_0=b0.rect,A0=b0.rule,C0=b0.text,E0=b0.tick,S0=b0.trail,j0=b0.circle,N0=b0.square,T0=b0.geoshape;function F0(t){return $Q(["line","area","trail"],t)}function D0(t){return $Q(["rect","bar","image","arc"],t)}const I0=VQ(b0);function M0(t){return t.type}Fe(I0);const $0=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],R0=VQ({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1}),B0={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},z0={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},L0={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5};function P0(t){return"mark"in t}class q0{constructor(t,e){this.name=t,this.run=e}hasMatchingType(t){return!!P0(t)&&(M0(e=t.mark)?e.type:e)===this.name;var e}}const W0={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},U0={count:1,min:1,max:1};function V0(t){return!!t&&!!t.argmin}function G0(t){return!!t&&!!t.argmax}VQ(W0);function H0(t){return ve(t)&&!!W0[t]}const X0=["count","valid","missing","distinct"];function K0(t){return ve(t)&&$Q(X0,t)}const Y0=["count","sum","distinct","valid","missing"],J0=Fe(["mean","average","median","q1","q3","min","max"]),Z0="row",Q0="column",t1="radius",e1="theta",n1="theta2",r1="color",i1="fill",a1="stroke",o1="shape",s1="size",u1={theta:1,theta2:1,radius:1,radius2:1};function c1(t){return t in u1}const l1={longitude:1,longitude2:1,latitude:1,latitude2:1};const d1=VQ(l1),f1=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),u1),l1),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function h1(t){return t===r1||t===i1||t===a1}const p1={row:1,column:1,facet:1},m1=VQ(p1),g1=Object.assign(Object.assign({},f1),p1),b1=VQ(g1),{order:y1,detail:v1,tooltip:x1}=g1,w1=w(g1,["order","detail","tooltip"]),{row:k1,column:O1,facet:_1}=w1,A1=w(w1,["row","column","facet"]);VQ(w1),VQ(A1);function C1(t){return!!g1[t]}const E1=["x2","y2","latitude2","longitude2",n1,"radius2"];function S1(t){return j1(t)!==t}function j1(t){switch(t){case"x2":return"x";case"y2":return"y";case"latitude2":return"latitude";case"longitude2":return"longitude";case n1:return e1;case"radius2":return t1}return t}function N1(t){if(c1(t))switch(t){case e1:return"startAngle";case n1:return"endAngle";case t1:return"outerRadius";case"radius2":return"innerRadius"}return t}function T1(t){switch(t){case"x":return"x2";case"y":return"y2";case"latitude":return"latitude2";case"longitude":return"longitude2";case e1:return n1;case t1:return"radius2"}}function F1(t){switch(t){case"x":case"x2":return"width";case"y":case"y2":return"height"}}VQ(f1);const{x:D1,y:I1,x2:M1,y2:$1,latitude:R1,longitude:B1,latitude2:z1,longitude2:L1,theta:P1,theta2:q1,radius:W1,radius2:U1}=f1,V1=w(f1,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),G1=VQ(V1),H1={x:1,y:1},X1=VQ(H1);function K1(t){return t in H1}const Y1={theta:1,radius:1},J1=VQ(Y1);function Z1(t){return"width"===t?"x":"y"}const{text:Q1,tooltip:t2,href:e2,url:n2,description:r2,detail:i2,key:a2,order:o2}=V1,s2=w(V1,["text","tooltip","href","url","description","detail","key","order"]),u2=VQ(s2);const c2=Object.assign(Object.assign(Object.assign({},H1),Y1),s2),l2=VQ(c2);function d2(t){return!!c2[t]}function f2(t,e){return function(t){switch(t){case r1:case i1:case a1:case"description":case"detail":case"key":case"tooltip":case"href":case"order":case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":case"facet":case Z0:case Q0:return h2;case"x":case"y":case"latitude":case"longitude":return m2;case"x2":case"y2":case"latitude2":case"longitude2":return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case s1:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case"strokeDash":return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case o1:return{point:"always",geoshape:"always"};case"text":return{text:"always"};case"angle":return{point:"always",square:"always",text:"always"};case"url":return{image:"always"};case e1:case t1:return{text:"always",arc:"always"};case n1:case"radius2":return{arc:"always"}}}(t)[e]}const h2={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:p2}=h2,m2=w(h2,["geoshape"]);function g2(t){switch(t){case"x":case"y":case e1:case t1:case s1:case"angle":case"strokeWidth":case"opacity":case"fillOpacity":case"strokeOpacity":case"x2":case"y2":case n1:case"radius2":return;case"facet":case Z0:case Q0:case o1:case"strokeDash":case"text":case"tooltip":case"href":case"url":case"description":return"discrete";case r1:case i1:case a1:return"flexible";case"latitude":case"longitude":case"latitude2":case"longitude2":case"detail":case"key":case"order":return}}function b2(t){return me(t)&&(t=S5(t,void 0)),"bin"+VQ(t).map(e=>w2(t[e])?KQ(`_${e}_${Object.entries(t[e])}`):KQ(`_${e}_${t[e]}`)).join("")}function y2(t){return!0===t||x2(t)&&!t.binned}function v2(t){return"binned"===t||x2(t)&&!0===t.binned}function x2(t){return At(t)}function w2(t){return null==t?void 0:t.selection}function k2(t){switch(t){case Z0:case Q0:case s1:case r1:case i1:case a1:case"strokeWidth":case"opacity":case"fillOpacity":case"strokeOpacity":case o1:return 6;case"strokeDash":return 4;default:return 10}}function O2(t){return`Invalid specification ${JSON.stringify(t)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const _2='Autosize "fit" only works for single views and layered views.';function A2(t){return("width"==t?"Width":"Height")+' "container" only works for single views and layered views.'}function C2(t){return`${"width"==t?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==t?"x":"y"}".`}function E2(t){return t?`Dropping "fit-${t}" because spec has discrete ${F1(t)}.`:'Dropping "fit" because spec has discrete size.'}function S2(t){return`Cannot project a selection on encoding channel "${t}", which has no field.`}function j2(t,e){return`Cannot project a selection on encoding channel "${t}" as it uses an aggregate function ("${e}").`}function N2(t){return`The "nearest" transform is not supported for ${t} marks.`}function T2(t){return`Selection not supported for ${t} yet.`}function F2(t){return`Cannot find a selection named "${t}".`}const D2="Scale bindings are currently only supported for scales with unbinned, continuous domains.",I2="Legend bindings are only supported for selections over an individual field or encoding channel.";function M2(t){return`Cannot define and lookup the "${t}" selection in the same view. Try moving the lookup into a second, layered view?`}function $2(t){return`Unknown repeated value "${t}".`}function R2(t){return`The "columns" property cannot be used when "${t}" has nested row/column.`}const B2="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function z2(t){return`Unrecognized parse "${t}".`}function L2(t,e,n){return`An ancestor parsed field "${t}" as ${n} but a child wants to parse the field as ${e}.`}function P2(t){return`Ignoring an invalid transform: ${DQ(t)}.`}const q2='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function W2(t){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${t} are dropped.`}function U2(t){return`Layer's shared ${t.join(",")} channel ${1===t.length?"is":"are"} overriden.`}function V2(t){const{parentProjection:e,projection:n}=t;return`Layer's shared projection ${DQ(e)} is overridden by a child projection ${DQ(n)}.`}const G2="Arc marks uses theta channel rather than angle, replacing angle with theta.";function H2(t,e,n){return`Channel ${t} is a ${e}. Converted to {value: ${DQ(n)}}.`}function X2(t){return`Invalid field type "${t}".`}function K2(t,e){return`Invalid field type "${t}" for aggregate: "${e}", using "quantitative" instead.`}function Y2(t){return`Invalid aggregation operator "${t}".`}function J2(t,e){return`Missing type for channel "${t}", using "${e}" instead.`}function Z2(t,e){const{fill:n,stroke:r}=e;return`Dropping color ${t} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function Q2(t,e){return`Dropping ${DQ(t)} from channel "${e}" since it does not contain any data field, datum, value, or signal.`}function t3(t,e,n){return`${t}-encoding with type ${e} is deprecated. Replacing with ${n}-encoding.`}const e3="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function n3(t,e,n){return`${t} dropped as it is incompatible with "${e}"${n?" when "+n:""}.`}function r3(t){return`${t}-encoding is dropped as ${t} is not a valid encoding channel.`}function i3(t){return t+" encoding should be discrete (ordinal / nominal / binned)."}function a3(t){return`Facet encoding dropped as ${t.join(" and ")} ${t.length>1?"are":"is"} also specified.`}function o3(t,e){return`Using discrete channel "${t}" to encode "${e}" field can be misleading as it does not encode ${"ordinal"===e?"order":"magnitude"}.`}function s3(t,e){return`Line mark is for continuous lines and thus cannot be used with ${t&&e?"x2 and y2":t?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function u3(t,e){return`Specified orient "${t}" overridden with "${e}".`}const c3="Custom domain scale cannot be unioned with default field-based domain.",l3='Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.';function d3(t){return`Cannot use the scale property "${t}" with non-color channel.`}function f3(t){return`Using unaggregated domain with raw field has no effect (${DQ(t)}).`}function h3(t){return`Unaggregated domain not applicable for "${t}" since it produces values outside the origin domain of the source data.`}function p3(t){return`Unaggregated domain is currently unsupported for log scale (${DQ(t)}).`}function m3(t){return`Cannot apply size to non-oriented mark "${t}".`}function g3(t,e,n){return`Channel "${t}" does not work with "${e}" scale. We are using "${n}" scale instead.`}function b3(t,e){return`FieldDef does not work with "${t}" scale. We are using "${e}" scale instead.`}function y3(t,e,n){return`${n}-scale's "${e}" is dropped as it does not work with ${t} scale.`}function v3(t,e){return`Scale type "${e}" does not work with mark "${t}".`}function x3(t){return`The step for "${t}" is dropped because the ${"width"===t?"x":"y"} is continuous.`}function w3(t,e,n,r){return`Conflicting ${e.toString()} property "${t.toString()}" (${DQ(n)} and ${DQ(r)}). Using ${DQ(n)}.`}function k3(t,e,n,r){return`Conflicting ${e.toString()} property "${t.toString()}" (${DQ(n)} and ${DQ(r)}). Using the union of the two domains.`}function O3(t){return`Setting the scale to be independent for "${t}" means we also have to set the guide (axis or legend) to be independent.`}function _3(t){return`Dropping sort property ${DQ(t)} as unioned domains only support boolean or op "count", "min", and "max".`}const A3="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",C3="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",E3="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",S3="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.",j3="Invalid channel for axis.";function N3(t){return`Cannot stack "${t}" if there is already "${t}2".`}function T3(t){return`Cannot stack non-linear scale (${t}).`}function F3(t){return`Stacking is applied even though the aggregate function is non-summative ("${t}").`}function D3(t,e){return`Invalid ${t}: ${DQ(e)}.`}function I3(t){return`Dropping day from datetime ${DQ(t)} as day cannot be combined with other units.`}function M3(t,e){return`${e?"extent ":""}${e&&t?"and ":""}${t?"center ":""}${e&&t?"are ":"is "}not needed when data are aggregated.`}function $3(t,e,n){return`${t} is not usually used with ${e} for ${n}.`}function R3(t,e){return`Continuous axis should not have customized aggregation function ${t}; ${e} already agregates the axis.`}function B3(t,e){return`Center is not needed to be specified in ${e} when extent is ${t}.`}function z3(t){return`1D error band does not support ${t}.`}function L3(t){return`Channel ${t} is required for "binned" bin.`}function P3(t){return`Domain for ${t} is required for threshold scale.`}const q3=Ot(xt);let W3=q3;function U3(){return W3=q3,W3}function V3(...t){W3.warn(...t)}function G3(t){if(t&&At(t))for(const e of t4)if(e in t)return!0;return!1}const H3=["january","february","march","april","may","june","july","august","september","october","november","december"],X3=H3.map(t=>t.substr(0,3)),K3=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Y3=K3.map(t=>t.substr(0,3));function J3(t,e){const n=[];if(e&&void 0!==t.day&&VQ(t).length>1&&(V3(y.droppedDay(t)),delete(t=NQ(t)).day),void 0!==t.year?n.push(t.year):n.push(2012),void 0!==t.month){const r=e?function(t){if(c0(t)&&(t=+t),be(t))return t-1;{const e=t.toLowerCase(),n=H3.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=X3.indexOf(r);if(-1!==i)return i;throw new Error(y.invalidTimeUnit("month",t))}}(t.month):t.month;n.push(r)}else if(void 0!==t.quarter){const r=e?function(t){if(c0(t)&&(t=+t),be(t))return t>4&&V3(y.invalidTimeUnit("quarter",t)),t-1;throw new Error(y.invalidTimeUnit("quarter",t))}(t.quarter):t.quarter;n.push(be(r)?3*r:r+"*3")}else n.push(0);if(void 0!==t.date)n.push(t.date);else if(void 0!==t.day){const r=e?function(t){if(c0(t)&&(t=+t),be(t))return t%7;{const e=t.toLowerCase(),n=K3.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=Y3.indexOf(r);if(-1!==i)return i;throw new Error(y.invalidTimeUnit("day",t))}}(t.day):t.day;n.push(be(r)?r+1:r+"+1")}else n.push(1);for(const e of["hours","minutes","seconds","milliseconds"]){const r=t[e];n.push(void 0===r?0:r)}return n}function Z3(t){const e=J3(t,!0).join(", ");return t.utc?`utc(${e})`:`datetime(${e})`}const Q3={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},t4=VQ(Q3);function e4(t){return t.startsWith("utc")}const n4={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function r4(t){const e=[];for(const n of t4)i4(t,n)&&e.push(n);return e}function i4(t,e){const n=t.indexOf(e);return!(n<0)&&(!(n>0&&"seconds"===e&&"i"===t.charAt(n-1))&&(!(t.length>n+3&&"day"===e&&"o"===t.charAt(n+3))&&!(n>0&&"year"===e&&"f"===t.charAt(n-1))))}function a4(t,e,{end:n}={end:!1}){const r=QQ(e),i=e4(t)?"utc":"";let a;const o={};for(const e of t4)i4(t,e)&&(o[e]="quarter"===(s=e)?`(${i}quarter(${r})-1)`:`${i}${s}(${r})`,a=e);var s;return n&&(o[a]+="+1"),function(t){const e=J3(t,!1).join(", ");return t.utc?`utc(${e})`:`datetime(${e})`}(o)}function o4(t){if(!t)return;const e=r4(t);return`timeUnitSpecifier(${_Q()(e)}, ${_Q()(n4)})`}function s4(t){if(!t)return;let e;return ve(t)?e={unit:t}:At(t)&&(e=Object.assign(Object.assign({},t),t.unit?{unit:t.unit}:{})),e4(e.unit)&&(e.utc=!0,e.unit=e.unit.substr(3)),e}function u4(t){return t&&!!t.signal}function c4(t){return!!t.step}function l4(t){return!_t(t)&&("field"in t&&"data"in t)}const d4=VQ({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1}),f4={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},h4=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function p4(t){return t&&!!t.field&&void 0!==t.equal}function m4(t){return t&&!!t.field&&void 0!==t.lt}function g4(t){return t&&!!t.field&&void 0!==t.lte}function b4(t){return t&&!!t.field&&void 0!==t.gt}function y4(t){return t&&!!t.field&&void 0!==t.gte}function v4(t){if(t&&t.field){if(_t(t.range)&&2===t.range.length)return!0;if(u4(t.range))return!0}return!1}function x4(t){return t&&!!t.field&&(_t(t.oneOf)||_t(t.in))}function w4(t){return x4(t)||p4(t)||v4(t)||m4(t)||b4(t)||g4(t)||y4(t)}function k4(t,e){return T5(t,{timeUnit:e,wrapTime:!0})}function O4(t,e=!0){var n;const{field:r}=t,i=null===(n=s4(t.timeUnit))||void 0===n?void 0:n.unit,a=i?"time("+a4(i,r)+")":h5(t,{expr:"datum"});if(p4(t))return a+"==="+k4(t.equal,i);if(m4(t)){return`${a}<${k4(t.lt,i)}`}if(b4(t)){return`${a}>${k4(t.gt,i)}`}if(g4(t)){return`${a}<=${k4(t.lte,i)}`}if(y4(t)){return`${a}>=${k4(t.gte,i)}`}if(x4(t))return`indexof([${function(t,e){return t.map(t=>k4(t,e))}(t.oneOf,i).join(",")}], ${a}) !== -1`;if(function(t){return t&&!!t.field&&void 0!==t.valid}(t))return _4(a,t.valid);if(v4(t)){const{range:n}=t,r=u4(n)?{signal:n.signal+"[0]"}:n[0],o=u4(n)?{signal:n.signal+"[1]"}:n[1];if(null!==r&&null!==o&&e)return"inrange("+a+", ["+k4(r,i)+", "+k4(o,i)+"])";const s=[];return null!==r&&s.push(`${a} >= ${k4(r,i)}`),null!==o&&s.push(`${a} <= ${k4(o,i)}`),s.length>0?s.join(" && "):"true"}throw new Error("Invalid field predicate: "+JSON.stringify(t))}function _4(t,e=!0){return e?`isValid(${t}) && isFinite(+${t})`:`!isValid(${t}) || !isFinite(+${t})`}function A4(t){var e;return w4(t)&&t.timeUnit?Object.assign(Object.assign({},t),{timeUnit:null===(e=s4(t.timeUnit))||void 0===e?void 0:e.unit}):t}const C4={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};const E4=C4.quantitative,S4=C4.ordinal,j4=C4.temporal,N4=C4.nominal,T4=C4.geojson,F4=VQ(C4);const D4="linear",I4="log",M4="pow",$4="sqrt",R4="symlog",B4="time",z4="utc",L4="quantile",P4="quantize",q4="threshold",W4="point",U4="band",V4={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},G4=VQ(V4);function H4(t,e){const n=V4[t],r=V4[e];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}const X4={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function K4(t){return X4[t]}const Y4=["linear","log","pow","sqrt","symlog","time","utc"],J4=Fe(Y4),Z4=Fe(["linear","log","pow","sqrt","symlog"]);const Q4=Fe(["quantile","quantize","threshold"]),t6=Y4.concat(["quantile","quantize","threshold","sequential","identity"]),e6=Fe(t6),n6=Fe(["ordinal","bin-ordinal","point","band"]);function r6(t){return t in n6}function i6(t){return t in e6}function a6(t){return t in J4}function o6(t){return t in Q4}function s6(t){return null==t?void 0:t.selection}const u6={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:c6,domain:l6,range:d6,scheme:f6}=(VQ(u6),u6),h6=w(u6,["type","domain","range","scheme"]),p6=VQ(h6);!function(){var t;const e={};for(const n of b1)for(const r of F4)for(const i of G4){const a=v6(n,r);y6(n,i)&&b6(i,r)&&(e[a]=null!==(t=e[a])&&void 0!==t?t:[],e[a].push(i))}}();function m6(t,e){switch(e){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!$Q(["point","band","identity"],t);case"bins":return!$Q(["point","band","identity","ordinal"],t);case"round":return a6(t)||"band"===t||"point"===t;case"padding":return a6(t)||$Q(["point","band"],t);case"paddingOuter":case"align":return $Q(["point","band"],t);case"paddingInner":return"band"===t;case"domainMid":case"clamp":return a6(t);case"nice":return a6(t)||"quantize"===t||"threshold"===t;case"exponent":return"pow"===t;case"base":return"log"===t;case"constant":return"symlog"===t;case"zero":return i6(t)&&!$Q(["log","time","utc","threshold","quantile"],t)}}function g6(t,e){switch(e){case"interpolate":case"scheme":case"domainMid":return h1(t)?void 0:y.cannotUseScalePropertyWithNonColor(t);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function b6(t,e){return $Q([S4,N4],e)?void 0===t||r6(t):e===j4?$Q([B4,z4,void 0],t):e!==E4||$Q([I4,M4,$4,R4,L4,P4,q4,D4,void 0],t)}function y6(t,e){if(!d2(t))return!1;switch(t){case"x":case"y":case e1:case t1:return a6(e)||$Q(["band","point"],e);case s1:case"strokeWidth":case"opacity":case"fillOpacity":case"strokeOpacity":case"angle":return a6(e)||o6(e)||$Q(["band","point","ordinal"],e);case r1:case i1:case a1:return"band"!==e;case"strokeDash":return"ordinal"===e||o6(e);case o1:return"ordinal"===e}}function v6(t,e){return t+"_"+e}function x6(t){const{channel:e,channelDef:n,markDef:r,scale:i,config:a}=t,o=C6(t);return e5(n)&&!K0(n.aggregate)&&i&&a6(i.get("type"))&&!1===i.get("zero")?w6({fieldDef:n,channel:e,markDef:r,ref:o,config:a}):o}function w6({fieldDef:t,channel:e,markDef:n,ref:r,config:i}){if(F0(n.type))return r;return null===L5("invalid",n,i)?r:[k6(t,e),r]}function k6(t,e){const n=O6(t,!0),r="y"===j1(e)?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function O6(t,e=!0){return _4(ve(t)?t:h5(t,{expr:"datum"}),!e)}function _6(t,e,n,r){const i={};if(e&&(i.scale=e),r5(t)){const{datum:e}=t;G3(e)?i.signal=Z3(e):u4(e)?i.signal=e.signal:i.value=e}else i.field=h5(t,n);if(r){const{offset:t,band:e}=r;t&&(i.offset=t),e&&(i.band=e)}return i}function A6({scaleName:t,fieldOrDatumDef:e,fieldOrDatumDef2:n,offset:r,startSuffix:i,band:a=.5}){const o=0<a&&a<1?"datum":void 0,s=h5(e,{expr:o,suffix:i}),u=void 0!==n?h5(n,{expr:o}):h5(e,{suffix:"end",expr:o}),c={};if(0===a||1===a){c.scale=t;const e=0===a?s:u;c.field=e}else{const e=`${a} * ${s} + ${1-a} * ${u}`;c.signal=`scale("${t}", ${e})`}return r&&(c.offset=r),c}function C6({channel:t,channelDef:e,channel2Def:n,markDef:r,config:i,scaleName:a,scale:o,stack:s,offset:u,defaultRef:c,band:l}){var d;if(e){if(o5(e)){if(s5(e)){l=null!=l?l:Y6({channel:t,fieldDef:e,fieldDef2:n,markDef:r,stack:s,config:i,isMidPoint:!0});const{bin:o,timeUnit:c,type:d}=e;if(y2(o)||l&&c&&d===j4)return s&&s.impute?_6(e,a,{binSuffix:"mid"},{offset:u}):l?A6({scaleName:a,fieldOrDatumDef:e,band:l,offset:u}):_6(e,a,D5(e,t)?{binSuffix:"range"}:{},{offset:u});if(v2(o)){if(e5(n))return A6({scaleName:a,fieldOrDatumDef:e,fieldOrDatumDef2:n,band:l,offset:u});{const e="x"===t?"x2":"y2";V3(y.channelRequiredForBinned(e))}}}const c=null==o?void 0:o.get("type");return _6(e,a,r6(c)?{binSuffix:"range"}:{},{offset:u,band:"band"===c?null!==(d=null!=l?l:e.band)&&void 0!==d?d:.5:void 0})}if(u5(e)){const n=e.value,r=u?{offset:u}:{};return Object.assign(Object.assign({},E6(t,n)),r)}}return Jt(c)&&(c=c()),c?Object.assign(Object.assign({},c),u?{offset:u}:{}):c}function E6(t,e){return $Q(["x","x2"],t)&&"width"===e?{field:{group:"width"}}:$Q(["y","y2"],t)&&"height"===e?{field:{group:"height"}}:$5(e)}function S6(t){return t&&"number"!==t&&"time"!==t}function j6(t,e,n){return`${t}(${e}${n?", "+JSON.stringify(n):""})`}function N6({fieldOrDatumDef:t,format:e,formatType:n,expr:r,normalizeStack:i,config:a}){var o,s;if(S6(n))return F6({fieldOrDatumDef:t,format:e,formatType:n,expr:r,config:a});const u=T6(t,r,i);if(N5(t)){const n=function(t,e,n,r,i){return!e||n?(n=ve(n)?n:r,`${i?"utc":"time"}Format(${t}, '${n}')`):function(t,e,n){if(!t)return;const r=o4(t);return`${n||e4(t)?"utc":"time"}Format(${e}, ${r})`}(e,t,i)}(u,e5(t)?null===(o=s4(t.timeUnit))||void 0===o?void 0:o.unit:void 0,e,a.timeFormat,c5(t)&&(null===(s=t.scale)||void 0===s?void 0:s.type)===z4);return n?{signal:n}:void 0}if(e=M6(n5(t),e,a),e5(t)&&y2(t.bin)){return{signal:B6(u,h5(t,{expr:r,binSuffix:"end"}),e,n,a)}}return e||"quantitative"===n5(t)?{signal:""+$6(u,e)}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function T6(t,e,n){return e5(t)?n?`${h5(t,{expr:e,suffix:"end"})}-${h5(t,{expr:e,suffix:"start"})}`:h5(t,{expr:e}):function(t){const{datum:e}=t;return G3(e)?Z3(e):""+JSON.stringify(e)}(t)}function F6({fieldOrDatumDef:t,format:e,formatType:n,expr:r,normalizeStack:i,config:a,field:o}){if(o=null!=o?o:T6(t,r,i),e5(t)&&y2(t.bin)){return{signal:B6(o,h5(t,{expr:r,binSuffix:"end"}),e,n,a)}}return{signal:j6(n,o,e)}}function D6(t,e,n,r,i,a){var o;if(!S6(r)){if(N5(t)){return function(t,e,n,r){if(t)return t;if(e)return{signal:o4(e)};return r?void 0:n.timeFormat}(n,e5(t)?null===(o=s4(t.timeUnit))||void 0===o?void 0:o.unit:void 0,i,a)}return M6(e,n,i)}}function I6(t,e,n){return t&&(u4(t)||"number"===t||"time"===t)?t:N5(e)&&"time"!==n&&"utc"!==n?"time":void 0}function M6(t,e,n){return ve(e)?e:t===E4?n.numberFormat:void 0}function $6(t,e){return`format(${t}, "${e||""}")`}function R6(t,e,n,r){var i;return S6(n)?j6(n,t,e):$6(t,null!==(i=ve(e)?e:void 0)&&void 0!==i?i:r.numberFormat)}function B6(t,e,n,r,i){const a=R6(t,n,r,i),o=R6(e,n,r,i);return`${_4(t,!1)} ? "null" : ${a} + "  " + ${o}`}const z6="min",L6={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function P6(t){return t in L6}function q6(t){return!!t&&!!t.encoding}function W6(t){return!(!t||"count"!==t.op&&!t.field)}function U6(t){return!!t&&_t(t)}function V6(t){return"row"in t||"column"in t}function G6(t){return!!t&&"header"in t}function H6(t){return"facet"in t}function X6(t){const{field:e,timeUnit:n,bin:r,aggregate:i}=t;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:e})}function K6(t){return s5(t)&&"sort"in t}function Y6({channel:t,fieldDef:e,fieldDef2:n,markDef:r,stack:i,config:a,isMidPoint:o}){if(o5(e)&&void 0!==e.band)return e.band;if(e5(e)){const{timeUnit:t,bin:i}=e;if(t&&!n)return o?P5("timeUnitBandPosition",r,a):D0(r.type)?P5("timeUnitBand",r,a):0;if(y2(i))return D0(r.type)&&!o?1:.5}return(null==i?void 0:i.fieldChannel)===t&&o?.5:void 0}function J6(t,e,n,r,i,a){return!!(y2(e.bin)||e.timeUnit&&s5(e)&&"temporal"===e.type)&&!!Y6({channel:t,fieldDef:e,fieldDef2:n,stack:r,markDef:i,config:a})}function Z6(t){return!!t&&"condition"in t}function Q6(t){const e=t&&t.condition;return!!e&&!_t(e)&&e5(e)}function t5(t){const e=t&&t.condition;return!!e&&!_t(e)&&o5(e)}function e5(t){return!(!t||!t.field&&"count"!==t.aggregate)}function n5(t){return t&&t.type}function r5(t){return!!t&&"datum"in t}function i5(t){return s5(t)&&m5(t)||a5(t)}function a5(t){return r5(t)&&be(t.datum)}function o5(t){return e5(t)||r5(t)}function s5(t){return!!t&&("field"in t&&"type"in t||"count"===t.aggregate)}function u5(t){return t&&"value"in t&&"value"in t}function c5(t){return!!t&&("scale"in t||"sort"in t)}function l5(t){return t&&("axis"in t||"stack"in t||"impute"in t)}function d5(t){return!!t&&"legend"in t}function f5(t){return!!t&&("format"in t||"formatType"in t)}function h5(t,e={}){var n,r,i;let a=t.field;const o=e.prefix;let s=e.suffix,u="";if(function(t){return"count"===t.aggregate}(t))a=function(t){return 0===t.indexOf("__")}(c="count")?c:"__"+c;else{let o;if(!e.nofn)if(function(t){return"op"in t}(t))o=t.op;else{const{bin:c,aggregate:l,timeUnit:d}=t;y2(c)?(o=b2(c),s=(null!==(n=e.binSuffix)&&void 0!==n?n:"")+(null!==(r=e.suffix)&&void 0!==r?r:"")):l?G0(l)?(u=`["${a}"]`,a="argmax_"+l.argmax):V0(l)?(u=`["${a}"]`,a="argmin_"+l.argmin):o=String(l):d&&(o=function(t){const e=s4(t),{utc:n}=e,r=w(e,["utc"]);return r.unit?(n?"utc":"")+VQ(r).map(t=>KQ(`${"unit"===t?"":`_${t}_`}${r[t]}`)).join(""):(n?"utc":"")+"timeunit"+VQ(r).map(t=>KQ(`_${t}_${r[t]}`)).join("")}(d),s=(!$Q(["range","mid"],e.binSuffix)&&e.binSuffix||"")+(null!==(i=e.suffix)&&void 0!==i?i:""))}o&&(a=a?`${o}_${a}`:o)}var c;return s&&(a=`${a}_${s}`),o&&(a=`${o}_${a}`),e.forAs?r0(a):e.expr?function(t,e="datum"){return`${e}[${Ee(ut(t).join("."))}]`}(a,e.expr)+u:e0(a)+u}function p5(t){switch(t.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return e5(t)&&!!t.bin;case"temporal":return!1}throw new Error(y.invalidFieldType(t.type))}function m5(t){return!p5(t)}const g5=(t,e)=>{switch(e.fieldTitle){case"plain":return t.field;case"functional":return function(t){const{aggregate:e,bin:n,timeUnit:r,field:i}=t;if(G0(e))return`${i} for argmax(${e.argmax})`;if(V0(e))return`${i} for argmin(${e.argmin})`;const a=s4(r),o=e||(null==a?void 0:a.unit)||(null==a?void 0:a.maxbins)&&"timeunit"||y2(n)&&"bin";return o?o.toUpperCase()+"("+i+")":i}(t);default:return function(t,e){var n;const{field:r,bin:i,timeUnit:a,aggregate:o}=t;if("count"===o)return e.countTitle;if(y2(i))return r+" (binned)";if(a){const t=null===(n=s4(a))||void 0===n?void 0:n.unit;if(t)return`${r} (${r4(t).join("-")})`}else if(o)return G0(o)?`${r} for max ${o.argmax}`:V0(o)?`${r} for min ${o.argmin}`:`${ZQ(o)} of ${r}`;return r}(t,e)}};let b5=g5;function y5(t){b5=t}function v5(t,e,{allowDisabling:n,includeDefault:r=!0}){var i,a;const o=(null!==(i=x5(t))&&void 0!==i?i:{}).title;if(!e5(t))return o;const s=t,u=r?w5(s,e):void 0;return n?a0(o,s.title,u):null!==(a=null!=o?o:s.title)&&void 0!==a?a:u}function x5(t){return l5(t)&&t.axis?t.axis:d5(t)&&t.legend?t.legend:G6(t)&&t.header?t.header:void 0}function w5(t,e){return b5(t,e)}function k5(t){var e;if(f5(t)){const{format:e,formatType:n}=t;return{format:e,formatType:n}}{const n=null!==(e=x5(t))&&void 0!==e?e:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function O5(t){return e5(t)?t:Q6(t)?t.condition:void 0}function _5(t){return o5(t)?t:t5(t)?t.condition:void 0}function A5(t,e,n){if(ve(t)||be(t)||me(t)){const n=ve(t)?"string":be(t)?"number":"boolean";return V3(y.primitiveChannelDef(e,n,t)),{value:t}}return o5(t)?C5(t,e,n):t5(t)?Object.assign(Object.assign({},t),{condition:C5(t.condition,e,n)}):t}function C5(t,e,n){if(f5(t)){const{format:r,formatType:i}=t,a=w(t,["format","formatType"]);if(S6(i)&&!n.customFormatTypes)return V3(y.customFormatTypeNotAllowed(e)),C5(a,e,n)}else{const r=l5(t)?"axis":d5(t)?"legend":G6(t)?"header":null;if(r&&t[r]){const i=t[r],{format:a,formatType:o}=i,s=w(i,["format","formatType"]);if(S6(o)&&!n.customFormatTypes)return V3(y.customFormatTypeNotAllowed(e)),C5(Object.assign(Object.assign({},t),{[r]:s}),e,n)}}return e5(t)?E5(t,e):function(t){let e=t.type;if(e)return t;const{datum:n}=t;return e=be(n)?"quantitative":ve(n)?"nominal":G3(n)?"temporal":void 0,Object.assign(Object.assign({},t),{type:e})}(t)}function E5(t,e){const{aggregate:n,timeUnit:r,bin:i,field:a}=t,o=Object.assign({},t);if(!n||H0(n)||G0(n)||V0(n)||(V3(y.invalidAggregate(n)),delete o.aggregate),r&&(o.timeUnit=s4(r)),a&&(o.field=""+a),y2(i)&&(o.bin=S5(i,e)),v2(i)&&!K1(e)&&V3(`Channel ${e} should not be used with "binned" bin.`),s5(o)){const{type:t}=o,e=function(t){if(t)switch(t=t.toLowerCase()){case"q":case E4:return"quantitative";case"t":case j4:return"temporal";case"o":case S4:return"ordinal";case"n":case N4:return"nominal";case T4:return"geojson"}}(t);t!==e&&(o.type=e),"quantitative"!==t&&K0(n)&&(V3(y.invalidFieldTypeForCountAggregate(t,n)),o.type="quantitative")}else if(!S1(e)){const t=function(t,e){if(t.timeUnit)return"temporal";if(y2(t.bin))return"quantitative";switch(g2(e)){case"continuous":return"quantitative";case"discrete":case"flexible":return"nominal";default:return"quantitative"}}(o,e);V3(y.missingFieldType(e,t)),o.type=t}if(s5(o)){const{compatible:t,warning:n}=function(t,e){const n=t.type;if("geojson"===n&&"shape"!==e)return{compatible:!1,warning:`Channel ${e} should not be used with a geojson data.`};switch(e){case Z0:case Q0:case"facet":return m5(t)?{compatible:!1,warning:y.facetChannelShouldBeDiscrete(e)}:j5;case"x":case"y":case r1:case i1:case a1:case"text":case"detail":case"key":case"tooltip":case"href":case"url":case"angle":case e1:case t1:case"description":return j5;case"longitude":case"longitude2":case"latitude":case"latitude2":return n!==E4?{compatible:!1,warning:`Channel ${e} should be used with a quantitative field only, not ${t.type} field.`}:j5;case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":case s1:case n1:case"radius2":case"x2":case"y2":return"nominal"!==n||t.sort?j5:{compatible:!1,warning:`Channel ${e} should not be used with an unsorted discrete field.`};case"strokeDash":return $Q(["ordinal","nominal"],t.type)?j5:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case o1:return $Q(["ordinal","nominal","geojson"],t.type)?j5:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case"order":return"nominal"!==t.type||"sort"in t?j5:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(o,e);t||V3(n)}if(K6(o)&&ve(o.sort)){const{sort:t}=o;if(P6(t))return Object.assign(Object.assign({},o),{sort:{encoding:t}});const e=t.substr(1);if("-"===t.charAt(0)&&P6(e))return Object.assign(Object.assign({},o),{sort:{encoding:e,order:"descending"}})}if(G6(o)){const{header:t}=o,{orient:e}=t,n=w(t,["orient"]);if(e)return Object.assign(Object.assign({},o),{header:Object.assign(Object.assign({},n),{labelOrient:t.labelOrient||e,titleOrient:t.titleOrient||e})})}return o}function S5(t,e){return me(t)?{maxbins:k2(e)}:"binned"===t?{binned:!0}:t.maxbins||t.step?t:Object.assign(Object.assign({},t),{maxbins:k2(e)})}const j5={compatible:!0};function N5(t){const{formatType:e}=k5(t);return"time"===e||!e&&((n=t)&&("temporal"===n.type||e5(n)&&!!n.timeUnit));var n}function T5(t,{timeUnit:e,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var a;const o=e&&(null===(a=s4(e))||void 0===a?void 0:a.unit);let s,u=o||"temporal"===n;return u4(t)?s=t.signal:G3(t)?(u=!0,s=Z3(t)):(ve(t)||be(t))&&u&&(s=`datetime(${JSON.stringify(t)})`,function(t){return!!Q3[t]}(o)&&(be(t)&&t<1e4||ve(t)&&isNaN(Date.parse(t)))&&(s=Z3({[o]:t}))),s?r&&u?`time(${s})`:s:i?void 0:JSON.stringify(t)}function F5(t,e){const{type:n}=t;return e.map(e=>{const r=T5(e,{timeUnit:e5(t)?t.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:e})}function D5(t,e){return y2(t.bin)?d2(e)&&$Q(["ordinal","nominal"],t.type):(console.warn("Only call this method for binned field defs."),!1)}function I5(t){const{anchor:e,frame:n,offset:r,orient:i,color:a,subtitleColor:o,subtitleFont:s,subtitleFontSize:u,subtitleFontStyle:c,subtitleFontWeight:l,subtitleLineHeight:d,subtitlePadding:f}=t,h=w(t,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},h),a?{fill:a}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign({},e?{anchor:e}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),s?{subtitleFont:s}:{}),u?{subtitleFontSize:u}:{}),c?{subtitleFontStyle:c}:{}),l?{subtitleFontWeight:l}:{}),d?{subtitleLineHeight:d}:{}),f?{subtitlePadding:f}:{});return{titleMarkConfig:p,subtitleMarkConfig:TQ(p,["align","baseline","dx","dy","limit"]),nonMark:m,subtitle:g}}function M5(t){return ve(t)||_t(t)&&ve(t[0])}function $5(t){return u4(t)?t:void 0!==t?{value:t}:void 0}function R5(t){return u4(t)?t.signal:Ee(t.value)}function B5(t){return u4(t)?t.signal:null==t?null:Ee(t)}function z5(t){var e;return[].concat(t.type,null!==(e=t.style)&&void 0!==e?e:[])}function L5(t,e,n,r={}){const{vgChannel:i,ignoreVgConfig:a}=r;return i&&void 0!==e[i]?e[i]:void 0!==e[t]?e[t]:!a||i&&i!==t?P5(t,e,n,r):void 0}function P5(t,e,n,{vgChannel:r}={}){return a0(r?q5(t,e,n.style):void 0,q5(t,e,n.style),r?n[e.type][r]:void 0,n[e.type][t],r?n.mark[r]:n.mark[t])}function q5(t,e,n){return W5(t,z5(e),n)}function W5(t,e,n){let r;e=Kt(e);for(const i of e){const e=n[i];e&&void 0!==e[t]&&(r=e[t])}return r}function U5(t,e){return Kt(t).reduce((t,n)=>{var r;return t.field.push(h5(n,e)),t.order.push(null!==(r=n.sort)&&void 0!==r?r:"ascending"),t},{field:[],order:[]})}function V5(t,e){const n=[...t];return e.forEach(t=>{for(const e of n)if(jQ(e,t))return;n.push(t)}),n}function G5(t,e){return jQ(t,e)||!e?t:t?[...Kt(t),...Kt(e)].join(", "):e}function H5(t,e){const n=t.value,r=e.value;if(null==n||null===r)return{explicit:t.explicit,value:null};if((M5(n)||u4(n))&&(M5(r)||u4(r)))return{explicit:t.explicit,value:G5(n,r)};if(M5(n)||u4(n))return{explicit:t.explicit,value:n};if(M5(r)||u4(r))return{explicit:t.explicit,value:r};if(!(M5(n)||u4(n)||M5(r)||u4(r)))return{explicit:t.explicit,value:V5(n,r)};throw new Error("It should never reach here")}function X5(t,e){const n=t&&t[e];return!!n&&(_t(n)?RQ(n,t=>!!t.field):e5(n)||Q6(n))}function K5(t){return RQ(b1,e=>{if(X5(t,e)){const n=t[e];if(_t(n))return RQ(n,t=>!!t.aggregate);{const t=O5(n);return t&&!!t.aggregate}}return!1})}function Y5(t,e){const n=[],r=[],i=[],a=[],o={};return Q5(t,(s,u)=>{if(e5(s)){const{field:c,aggregate:l,bin:d,timeUnit:f}=s,h=w(s,["field","aggregate","bin","timeUnit"]);if(l||f||d){const t=x5(s),p=t&&t.title;let m=h5(s,{forAs:!0});const g=Object.assign(Object.assign(Object.assign({},p?[]:{title:v5(s,e,{allowDisabling:!0})}),h),{field:m});if(l){let t;if(G0(l)?(t="argmax",m=h5({op:"argmax",field:l.argmax},{forAs:!0}),g.field=`${m}.${c}`):V0(l)?(t="argmin",m=h5({op:"argmin",field:l.argmin},{forAs:!0}),g.field=`${m}.${c}`):"boxplot"!==l&&"errorbar"!==l&&"errorband"!==l&&(t=l),t){const e={op:t,as:m};c&&(e.field=c),a.push(e)}}else if(n.push(m),s5(s)&&y2(d)){if(r.push({bin:d,field:c,as:m}),n.push(h5(s,{binSuffix:"end"})),D5(s,u)&&n.push(h5(s,{binSuffix:"range"})),K1(u)){const t={field:m+"_end"};o[u+"2"]=t}g.bin="binned",S1(u)||(g.type=E4)}else if(f){i.push({timeUnit:f,field:c,as:m});const t=s5(s)&&s.type!==j4&&"time";t&&("text"===u||"tooltip"===u?g.formatType=t:!function(t){return!!V1[t]}(u)?K1(u)&&(g.axis=Object.assign({formatType:t},g.axis)):g.legend=Object.assign({formatType:t},g.legend))}o[u]=g}else n.push(c),o[u]=t[u]}else o[u]=t[u]}),{bins:r,timeUnits:i,aggregate:a,groupby:n,encoding:o}}function J5(t,e,n){const r=e.type;return VQ(t).reduce((i,a)=>{if(!C1(a))return V3(y.invalidEncodingChannel(a)),i;const o=t[a];if("angle"!==a||"arc"!==r||t.theta||(V3(y.REPLACE_ANGLE_WITH_THETA),a=e1),!function(t,e,n){const r=f2(e,n);if(!r)return!1;if("binned"===r){const n=t["x2"===e?"x":"y"];return!!(e5(n)&&e5(t[e])&&v2(n.bin))}return!0}(t,a,r))return V3(y.incompatibleChannel(a,r)),i;if(a===s1&&"line"===r){const e=O5(t[a]);if(null==e?void 0:e.aggregate)return V3(y.LINE_WITH_VARYING_SIZE),i}if(a===r1&&(e.filled?"fill"in t:"stroke"in t))return V3(y.droppingColor("encoding",{fill:"fill"in t,stroke:"stroke"in t})),i;if("detail"===a||"order"===a&&!_t(o)&&!u5(o)||"tooltip"===a&&_t(o))o&&(i[a]=Kt(o).reduce((t,e)=>(e5(e)?t.push(E5(e,a)):V3(y.emptyFieldDef(e,a)),t),[]));else{if("tooltip"===a&&null===o)i[a]=null;else if(!(e5(o)||r5(o)||u5(o)||Z6(o)||u4(o)))return V3(y.emptyFieldDef(o,a)),i;i[a]=A5(o,a,n)}return i},{})}function Z5(t){const e=[];for(const n of VQ(t))if(X5(t,n)){const r=t[n],i=Kt(r);for(const t of i)e5(t)?e.push(t):Q6(t)&&e.push(t.condition)}return e}function Q5(t,e,n){if(t)for(const r of VQ(t)){const i=t[r];if(_t(i))for(const t of i)e.call(n,t,r);else e.call(n,i,r)}}function t8(t,e,n,r){return t?VQ(t).reduce((n,i)=>{const a=t[i];return _t(a)?a.reduce((t,n)=>e.call(r,t,n,i),n):e.call(r,n,a,i)},n):n}function e8(t,e){return VQ(e).reduce((n,r)=>{switch(r){case"x":case"y":case"href":case"description":case"url":case"x2":case"y2":case e1:case n1:case t1:case"radius2":case"latitude":case"longitude":case"latitude2":case"longitude2":case"text":case o1:case"angle":case"tooltip":return n;case"order":if("line"===t||"trail"===t)return n;case"detail":case"key":{const t=e[r];if(_t(t)||e5(t))for(const e of Kt(t))e.aggregate||n.push(h5(e,{}));return n}case s1:if("trail"===t)return n;case r1:case i1:case a1:case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeDash":case"strokeWidth":{const t=O5(e[r]);return t&&!t.aggregate&&n.push(h5(t,{})),n}}},[])}function n8(t,e,n,r=!0){if("tooltip"in n)return{tooltip:n.tooltip};return{tooltip:[...t.map(({fieldPrefix:t,titlePrefix:n})=>{const i=r?" of "+e.field:"";return{field:t+e.field,type:e.type,title:u4(n)?{signal:n+`"${escape(i)}"`}:n+i}}),...Z5(n)]}}function r8(t){const{axis:e,title:n,field:r}=t;return e&&void 0!==e.title?void 0:a0(n,r)}function i8(t,e,n,r,i){const{scale:a,axis:o}=n;return({partName:s,mark:u,positionPrefix:c,endPositionPrefix:l,aria:d,extraEncoding:f={}})=>{const h=r8(n);return a8(t,s,i,d,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[e]:Object.assign(Object.assign(Object.assign({field:c+"_"+n.field,type:n.type},void 0!==h?{title:h}:{}),void 0!==a?{scale:a}:{}),void 0!==o?{axis:o}:{})},ve(l)?{[e+"2"]:{field:l+"_"+n.field}}:{}),r),f)})}}function a8(t,e,n,r,i){const{clip:a,color:o,opacity:s}=t,u=t.type;return t[e]||void 0===t[e]&&n[e]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[e]),a?{clip:a}:{}),o?{color:o}:{}),s?{opacity:s}:{}),M0(i.mark)?i.mark:{type:i.mark}),{style:`${u}-${e}`}),me(t[e])?{}:t[e]),!1===r?{aria:r}:{})})]:[]}function o8(t,e,n){const{encoding:r}=t,i="vertical"===e?"y":"x",a=r[i],o=r[i+"2"],s=r[i+"Error"],u=r[i+"Error2"];return{continuousAxisChannelDef:s8(a,n),continuousAxisChannelDef2:s8(o,n),continuousAxisChannelDefError:s8(s,n),continuousAxisChannelDefError2:s8(u,n),continuousAxis:i}}function s8(t,e){if(t&&t.aggregate){const{aggregate:n}=t,r=w(t,["aggregate"]);return n!==e&&V3(y.errorBarContinuousAxisHasCustomizedAggregate(n,e)),r}return t}function u8(t,e){const{mark:n,encoding:r}=t,{x:i,y:a}=r;if(i5(i)){if(i5(a)){const t=e5(i)&&i.aggregate,r=e5(a)&&a.aggregate;if(t||r!==e){if(r||t!==e){if(t===e&&r===e)throw new Error("Both x and y cannot have aggregate");return M0(n)&&n.orient?n.orient:"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(i5(a))return"vertical";throw new Error("Need a valid continuous axis for "+e+"s")}const c8=new q0("boxplot",d8);function l8(t){return be(t)?"tukey":t}function d8(t,{config:e}){var n,r;const{mark:i,encoding:a,selection:o,projection:s}=t,u=w(t,["mark","encoding","selection","projection"]),c=M0(i)?i:{type:i};o&&V3(y.selectionNotSupported("boxplot"));const l=null!==(n=c.extent)&&void 0!==n?n:e.boxplot.extent,d=L5("size",c,e),f=l8(l),{transform:h,continuousAxisChannelDef:p,continuousAxis:m,groupby:g,aggregate:b,encodingWithoutContinuousAxis:v,ticksOrient:x,boxOrient:k,customTooltipWithoutAggregatedField:O}=function(t,e,n){const r=u8(t,"boxplot"),{continuousAxisChannelDef:i,continuousAxis:a}=o8(t,r,"boxplot"),o=i.field,s=l8(e),u=[...f8(o),{op:"median",field:o,as:"mid_box_"+o},{op:"min",field:o,as:("min-max"===s?"lower_whisker_":"min_")+o},{op:"max",field:o,as:("min-max"===s?"upper_whisker_":"max_")+o}],c="min-max"===s||"tukey"===s?[]:[{calculate:`datum["upper_box_${o}"] - datum["lower_box_${o}"]`,as:"iqr_"+o},{calculate:`min(datum["upper_box_${o}"] + datum["iqr_${o}"] * ${e}, datum["max_${o}"])`,as:"upper_whisker_"+o},{calculate:`max(datum["lower_box_${o}"] - datum["iqr_${o}"] * ${e}, datum["min_${o}"])`,as:"lower_whisker_"+o}],l=t.encoding,d=a,f=(l[d],w(l,["symbol"==typeof d?d:d+""])),{customTooltipWithoutAggregatedField:h,filteredEncoding:p}=function(t){const{tooltip:e}=t,n=w(t,["tooltip"]);if(!e)return{filteredEncoding:t};let r,i;if(_t(e)){for(const t of e)t.aggregate?(r||(r=[]),r.push(t)):(i||(i=[]),i.push(t));r&&(n.tooltip=r)}else e.aggregate?n.tooltip=e:i=e;return _t(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(f),{bins:m,timeUnits:g,aggregate:b,groupby:y,encoding:v}=Y5(p,n),x="vertical"===r?"horizontal":"vertical",k=r;return{transform:[...m,...g,{aggregate:[...b,...u],groupby:y},...c],groupby:y,aggregate:b,continuousAxisChannelDef:i,continuousAxis:a,encodingWithoutContinuousAxis:v,ticksOrient:x,boxOrient:k,customTooltipWithoutAggregatedField:h}}(t,l,e),{color:_,size:A}=v,C=w(v,["color","size"]),E=t=>i8(c,m,p,t,e.boxplot),S=E(C),j=E(v),N=E(Object.assign(Object.assign({},C),A?{size:A}:{})),T=n8([{fieldPrefix:"min-max"===f?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===f?"lower_whisker_":"min_",titlePrefix:"Min"}],p,v),F={type:"tick",color:"black",opacity:1,orient:x,invalid:null},D="min-max"===f?T:n8([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],p,v),I=[...S({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:D}),...S({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:D}),...S({partName:"ticks",mark:F,positionPrefix:"lower_whisker",aria:!1,extraEncoding:D}),...S({partName:"ticks",mark:F,positionPrefix:"upper_whisker",aria:!1,extraEncoding:D})],M=[..."tukey"!==f?I:[],...j({partName:"box",mark:Object.assign(Object.assign({type:"bar"},d?{size:d}:{}),{orient:k,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:T}),...N({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},At(e.boxplot.median)&&e.boxplot.median.color?{color:e.boxplot.median.color}:{}),d?{size:d}:{}),{orient:x,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:T})];let $;if("min-max"!==f){const t=`datum["lower_box_${p.field}"]`,n=`datum["upper_box_${p.field}"]`,r=`(${n} - ${t})`,i=`${t} - ${l} * ${r}`,a=`${n} + ${l} * ${r}`,o=`datum["${p.field}"]`,s={joinaggregate:f8(p.field),groupby:g};let u=void 0;"tukey"===f&&(u={transform:[{filter:`(${i} <= ${o}) && (${o} <= ${a})`},{aggregate:[{op:"min",field:p.field,as:"lower_whisker_"+p.field},{op:"max",field:p.field,as:"upper_whisker_"+p.field},{op:"min",field:"lower_box_"+p.field,as:"lower_box_"+p.field},{op:"max",field:"upper_box_"+p.field,as:"upper_box_"+p.field},...b],groupby:g}],layer:I});const{tooltip:d}=C,h=w(C,["tooltip"]),{scale:y,axis:v}=p,x=r8(p),k=a8(c,"outliers",e.boxplot,!0,{transform:[{filter:`(${o} < ${i}) || (${o} > ${a})`}],mark:"point",encoding:Object.assign(Object.assign({[m]:Object.assign(Object.assign(Object.assign({field:p.field,type:p.type},void 0!==x?{title:x}:{}),void 0!==y?{scale:y}:{}),void 0!==v?{axis:v}:{})},h),O?{tooltip:O}:{})})[0];k&&u?$={transform:[s],layer:[k,u]}:k?($=k,$.transform.unshift(s)):u&&($=u,$.transform.unshift(s))}return $?Object.assign(Object.assign({},u),{layer:[$,{transform:h,layer:M}]}):Object.assign(Object.assign({},u),{transform:(null!==(r=u.transform)&&void 0!==r?r:[]).concat(h),layer:M})}function f8(t){return[{op:"q1",field:t,as:"lower_box_"+t},{op:"q3",field:t,as:"upper_box_"+t}]}const h8=new q0("errorbar",p8);function p8(t,{config:e}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:a,ticksOrient:o,markDef:s,outerSpec:u,tooltipEncoding:c}=g8(t,"errorbar",e),l=i8(s,i,r,a,e.errorbar),d={type:"tick",orient:o},f=[...l({partName:"ticks",mark:d,positionPrefix:"lower",aria:!1,extraEncoding:c}),...l({partName:"ticks",mark:d,positionPrefix:"upper",aria:!1,extraEncoding:c}),...l({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),f.length>1?{layer:f}:Object.assign({},f[0]))}function m8(t,e){const{encoding:n}=t;if(function(t){return(o5(t.x)||o5(t.y))&&!o5(t.x2)&&!o5(t.y2)&&!o5(t.xError)&&!o5(t.xError2)&&!o5(t.yError)&&!o5(t.yError2)}(n))return{orient:u8(t,e),inputType:"raw"};const r=function(t){return o5(t.x2)||o5(t.y2)}(n),i=function(t){return o5(t.xError)||o5(t.xError2)||o5(t.yError)||o5(t.yError2)}(n),a=n.x,o=n.y;if(r){if(i)throw new Error(e+" cannot be both type aggregated-upper-lower and aggregated-error");const t=n.x2,r=n.y2;if(o5(t)&&o5(r))throw new Error(e+" cannot have both x2 and y2");if(o5(t)){if(i5(a))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in "+e)}if(o5(r)){if(i5(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in "+e)}throw new Error("No ranged axis")}{const t=n.xError,r=n.xError2,i=n.yError,s=n.yError2;if(o5(r)&&!o5(t))throw new Error(e+" cannot have xError2 without xError");if(o5(s)&&!o5(i))throw new Error(e+" cannot have yError2 without yError");if(o5(t)&&o5(i))throw new Error(e+" cannot have both xError and yError with both are quantiative");if(o5(t)){if(i5(a))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(o5(i)){if(i5(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function g8(t,e,n){var r;const{mark:i,encoding:a,selection:o,projection:s}=t,u=w(t,["mark","encoding","selection","projection"]),c=M0(i)?i:{type:i};o&&V3(y.selectionNotSupported(e));const{orient:l,inputType:d}=m8(t,e),{continuousAxisChannelDef:f,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:m,continuousAxis:g}=o8(t,l,e),{errorBarSpecificAggregate:b,postAggregateCalculates:v,tooltipSummary:x,tooltipTitleWithFieldName:k}=function(t,e,n,r,i,a,o,s){let u=[],c=[];const l=e.field;let d,f=!1;if("raw"===a){const e=t.center?t.center:t.extent?"iqr"===t.extent?"median":"mean":s.errorbar.center,n=t.extent?t.extent:"mean"===e?"stderr":"iqr";if("median"===e!=("iqr"===n)&&V3(y.errorBarCenterIsUsedWithWrongExtent(e,n,o)),"stderr"===n||"stdev"===n)u=[{op:n,field:l,as:"extent_"+l},{op:e,field:l,as:"center_"+l}],c=[{calculate:`datum["center_${l}"] + datum["extent_${l}"]`,as:"upper_"+l},{calculate:`datum["center_${l}"] - datum["extent_${l}"]`,as:"lower_"+l}],d=[{fieldPrefix:"center_",titlePrefix:ZQ(e)},{fieldPrefix:"upper_",titlePrefix:b8(e,n,"+")},{fieldPrefix:"lower_",titlePrefix:b8(e,n,"-")}],f=!0;else{let e,r,i;t.center&&t.extent&&V3(y.errorBarCenterIsNotNeeded(t.extent,o)),"ci"===n?(e="mean",r="ci0",i="ci1"):(e="median",r="q1",i="q3"),u=[{op:r,field:l,as:"lower_"+l},{op:i,field:l,as:"upper_"+l},{op:e,field:l,as:"center_"+l}],d=[{fieldPrefix:"upper_",titlePrefix:v5({field:l,aggregate:i,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:v5({field:l,aggregate:r,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:v5({field:l,aggregate:e,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(t.center||t.extent)&&V3(y.errorBarCenterAndExtentAreNotNeeded(t.center,t.extent)),"aggregated-upper-lower"===a?(d=[],c=[{calculate:`datum["${n.field}"]`,as:"upper_"+l},{calculate:`datum["${l}"]`,as:"lower_"+l}]):"aggregated-error"===a&&(d=[{fieldPrefix:"",titlePrefix:l}],c=[{calculate:`datum["${l}"] + datum["${r.field}"]`,as:"upper_"+l}],i?c.push({calculate:`datum["${l}"] + datum["${i.field}"]`,as:"lower_"+l}):c.push({calculate:`datum["${l}"] - datum["${r.field}"]`,as:"lower_"+l}));for(const t of c)d.push({fieldPrefix:t.as.substring(0,6),titlePrefix:n0(n0(t.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:c,errorBarSpecificAggregate:u,tooltipSummary:d,tooltipTitleWithFieldName:f}}(c,f,h,p,m,d,e,n),O=a,_=g,A=(O[_],"x"===g?"x2":"y2"),C=(O[A],"x"===g?"xError":"yError"),E=(O[C],"x"===g?"xError2":"yError2"),S=(O[E],w(O,["symbol"==typeof _?_:_+"","symbol"==typeof A?A:A+"","symbol"==typeof C?C:C+"","symbol"==typeof E?E:E+""])),{bins:j,timeUnits:N,aggregate:T,groupby:F,encoding:D}=Y5(S,n),I=[...T,...b],M="raw"!==d?[]:F,$=n8(x,f,D,k);return{transform:[...null!==(r=u.transform)&&void 0!==r?r:[],...j,...N,...0===I.length?[]:[{aggregate:I,groupby:M}],...v],groupby:M,continuousAxisChannelDef:f,continuousAxis:g,encodingWithoutContinuousAxis:D,ticksOrient:"vertical"===l?"horizontal":"vertical",markDef:c,outerSpec:u,tooltipEncoding:$}}function b8(t,e,n){return ZQ(t)+" "+n+" "+e}const y8=new q0("errorband",v8);function v8(t,{config:e}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:a,markDef:o,outerSpec:s,tooltipEncoding:u}=g8(t,"errorband",e),c=o,l=i8(c,i,r,a,e.errorband),d=void 0!==t.encoding.x&&void 0!==t.encoding.y;let f={type:d?"area":"rect"},h={type:d?"line":"rule"};const p=Object.assign(Object.assign({},c.interpolate?{interpolate:c.interpolate}:{}),c.tension&&c.interpolate?{tension:c.tension}:{});return d?(f=Object.assign(Object.assign(Object.assign({},f),p),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign({},h),p)):c.interpolate?V3(y.errorBand1DNotSupport("interpolate")):c.tension&&V3(y.errorBand1DNotSupport("tension")),Object.assign(Object.assign({},s),{transform:n,layer:[...l({partName:"band",mark:f,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...l({partName:"borders",mark:h,positionPrefix:"lower",aria:!1,extraEncoding:u}),...l({partName:"borders",mark:h,positionPrefix:"upper",aria:!1,extraEncoding:u})]})}const x8={};function w8(t,e,n){const r=new q0(t,e);x8[t]={normalizer:r,parts:n}}w8("boxplot",d8,["box","median","outliers","rule","ticks"]),w8("errorbar",p8,["ticks","rule"]),w8("errorband",v8,["band","borders"]);const k8=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],O8=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],_8={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},A8={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},C8=(VQ(A8),{single:{on:"click",fields:["_vgsid_"],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:["_vgsid_"],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}});function E8(t){return!(!t||"legend"!==t&&!t.legend)}function S8(t){return E8(t)&&At(t)}function j8(t){return"concat"in t}function N8(t){return"vconcat"in t}function T8(t){return"hconcat"in t}function F8(t){return At(t)&&void 0!==t.step}function D8(t){return t.view||t.width||t.height}const I8=VQ({align:1,bounds:1,center:1,columns:1,spacing:1});function M8(t,e){var n;return null!==(n=t[e])&&void 0!==n?n:t["width"===e?"continuousWidth":"continuousHeight"]}function $8(t,e){const n=R8(t,e);return F8(n)?n.step:B8}function R8(t,e){var n;return a0(null!==(n=t[e])&&void 0!==n?n:t["width"===e?"discreteWidth":"discreteHeight"],{step:t.step})}const B8=20;const z8={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:B8},mark:{color:"#4c78a8",invalid:"filter",timeUnitBand:1},arc:{},area:{},bar:z0,circle:{},geoshape:{},image:{},line:{},point:{},rect:L0,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:C8,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},L8=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],P8={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},q8={blue:L8[0],orange:L8[1],red:L8[2],teal:L8[3],green:L8[4],yellow:L8[5],purple:L8[6],pink:L8[7],brown:L8[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function W8(t={}){const{color:e,font:n,fontSize:r}=t,i=w(t,["color","font","fontSize"]);return Et({},z8,n?function(t){return{text:{font:t},style:{"guide-label":{font:t},"guide-title":{font:t},"group-title":{font:t},"group-subtitle":{font:t}}}}(n):{},e?function(t={}){return{signals:[{name:"color",value:At(t)?Object.assign(Object.assign({},q8),t):q8}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(e):{},r?function(t){return{signals:[{name:"fontSize",value:At(t)?Object.assign(Object.assign({},P8),t):P8}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},i||{})}const U8=["view",...I0],V8=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],G8=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function H8(t){t=NQ(t);for(const e of V8)delete t[e];if(t.axis)for(const e in t.axis)d0(t.axis[e])&&delete t.axis[e];if(t.legend)for(const e of k8)delete t.legend[e];if(t.mark){for(const e of R0)delete t.mark[e];t.mark.tooltip&&At(t.mark.tooltip)&&delete t.mark.tooltip}for(const e of U8){for(const n of R0)delete t[e][n];const n=G8[e];if(n)for(const r of n)delete t[e][r];X8(t,e)}for(const e of VQ(x8))delete t[e];!function(t){const{titleMarkConfig:e,subtitleMarkConfig:n,subtitle:r}=I5(t.title);UQ(e)||(t.style["group-title"]=Object.assign(Object.assign({},t.style["group-title"]),e));UQ(n)||(t.style["group-subtitle"]=Object.assign(Object.assign({},t.style["group-subtitle"]),n));UQ(r)?delete t.title:t.title=r}(t);for(const e in t)At(t[e])&&UQ(t[e])&&delete t[e];return UQ(t)?void 0:t}function X8(t,e,n,r){const i=r?t[e][r]:t[e];"view"===e&&(n="cell");const a=Object.assign(Object.assign({},i),t.style[null!=n?n:e]);UQ(a)||(t.style[null!=n?n:e]=a),r||delete t[e]}function K8(t){return"layer"in t}class Y8{map(t,e){return H6(t)?this.mapFacet(t,e):function(t){return"repeat"in t}(t)?this.mapRepeat(t,e):T8(t)?this.mapHConcat(t,e):N8(t)?this.mapVConcat(t,e):j8(t)?this.mapConcat(t,e):this.mapLayerOrUnit(t,e)}mapLayerOrUnit(t,e){if(K8(t))return this.mapLayer(t,e);if(P0(t))return this.mapUnit(t,e);throw new Error(y.invalidSpec(t))}mapLayer(t,e){return Object.assign(Object.assign({},t),{layer:t.layer.map(t=>this.mapLayerOrUnit(t,e))})}mapHConcat(t,e){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(t=>this.map(t,e))})}mapVConcat(t,e){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(t=>this.map(t,e))})}mapConcat(t,e){const{concat:n}=t,r=w(t,["concat"]);return Object.assign(Object.assign({},r),{concat:n.map(t=>this.map(t,e))})}mapFacet(t,e){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,e)})}mapRepeat(t,e){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,e)})}}const J8={zero:1,center:1,normalize:1};const Z8=new Set([y0,x0,v0,A0,O0,j0,N0,k0,C0,E0]),Q8=new Set([x0,v0,y0]);function t7(t,e){var n,r;const i="x"===e?"y":"radius",a=t[e],o=t[i];if(e5(a)&&e5(o))if("quantitative"===n5(a)&&"quantitative"===n5(o)){if(a.stack)return e;if(o.stack)return i;const t=e5(a)&&!!a.aggregate;if(t!==(e5(o)&&!!o.aggregate))return t?e:i;{const t=null===(n=a.scale)||void 0===n?void 0:n.type,s=null===(r=o.scale)||void 0===r?void 0:r.type;if(t&&"linear"!==t)return i;if(s&&"linear"!==s)return e}}else{if("quantitative"===n5(a))return e;if("quantitative"===n5(o))return i}else{if("quantitative"===n5(a))return e;if("quantitative"===n5(o))return i}}function e7(t,e,n={}){const r=M0(t)?t.type:t;if(!Z8.has(r))return null;const i=t7(e,"x")||t7(e,"theta");if(!i)return null;const a=e[i],o=e5(a)?h5(a,{}):void 0;let s=function(t){switch(t){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(i),u=e[s],c=e5(u)?h5(u,{}):void 0;c===o&&(c=void 0,u=void 0,s=void 0);const l=G1.reduce((t,n)=>{if("tooltip"!==n&&X5(e,n)){const r=e[n];for(const e of Kt(r)){const r=O5(e);if(r.aggregate)continue;const i=h5(r,{});i&&i===c||t.push({channel:n,fieldDef:r})}}return t},[]);let d;if(void 0!==a.stack?d=me(a.stack)?a.stack?"zero":null:a.stack:l.length>0&&Q8.has(r)&&(d="zero"),!d||!(d in J8))return null;if(K5(e)&&0===l.length)return null;if(a.scale&&a.scale.type&&a.scale.type!==D4){if(n.disallowNonLinearStack)return null;V3(y.cannotStackNonLinearScale(a.scale.type))}return o5(e[T1(i)])?(void 0!==a.stack&&V3(y.cannotStackRangedMark(i)),null):(e5(a)&&a.aggregate&&!$Q(Y0,a.aggregate)&&V3(y.stackNonSummativeAggregate(a.aggregate)),{groupbyChannel:u?s:void 0,groupbyField:c,fieldChannel:i,impute:null!==a.impute&&F0(r),stackBy:l,offset:d})}function n7(t){const{point:e,line:n}=t,r=w(t,["point","line"]);return VQ(r).length>1?r:r.type}function r7(t){for(const e of["line","area","rule","trail"])t[e]&&(t=Object.assign(Object.assign({},t),{[e]:FQ(t[e],["point","line"])}));return t}function i7(t,e={},n){return"transparent"===t.point?{opacity:0}:t.point?At(t.point)?t.point:{}:void 0!==t.point?null:e.point||n.shape?At(e.point)?e.point:{}:void 0}function a7(t,e={}){return t.line?!0===t.line?{}:t.line:void 0!==t.line?null:e.line?!0===e.line?{}:e.line:void 0}class o7{constructor(){this.name="path-overlay"}hasMatchingType(t,e){if(P0(t)){const{mark:n,encoding:r}=t,i=M0(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!i7(i,e[i.type],r);case"area":return!!i7(i,e[i.type],r)||!!a7(i,e[i.type])}}return!1}run(t,e,n){const{config:r}=e,{selection:i,projection:a,encoding:o,mark:s}=t,u=w(t,["selection","projection","encoding","mark"]),c=M0(s)?s:{type:s},l=i7(c,r[c.type],o),d="area"===c.type&&a7(c,r[c.type]),f=[Object.assign(Object.assign({},i?{selection:i}:{}),{mark:n7(Object.assign(Object.assign({},"area"===c.type&&void 0===c.opacity&&void 0===c.fillOpacity?{opacity:.7}:{}),c)),encoding:FQ(o,["shape"])})],h=e7(c,o);let p=o;if(h){const{fieldChannel:t,offset:e}=h;p=Object.assign(Object.assign({},o),{[t]:Object.assign(Object.assign({},o[t]),e?{stack:e}:{})})}return d&&f.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"line"},TQ(c,["clip","interpolate","tension","tooltip"])),d),encoding:p})),l&&f.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},TQ(c,["clip","tooltip"])),l),encoding:p})),n(Object.assign(Object.assign({},u),{layer:f}),Object.assign(Object.assign({},e),{config:r7(r)}))}}class s7{constructor(){this.name="RangeStep"}hasMatchingType(t){var e;if(P0(t)&&t.encoding)for(const n of X1){const r=t.encoding[n];if(r&&o5(r)&&(null===(e=null==r?void 0:r.scale)||void 0===e?void 0:e.rangeStep))return!0}return!1}run(t){var e;const n={};let r=Object.assign({},t.encoding);for(const t of X1){const i=F1(t),a=r[t];if(a&&o5(a)&&(null===(e=null==a?void 0:a.scale)||void 0===e?void 0:e.rangeStep)){const{scale:e}=a,o=w(a,["scale"]),s=e,{rangeStep:u}=s,c=w(s,["rangeStep"]);n[i]={step:e.rangeStep},V3(y.RANGE_STEP_DEPRECATED),r=Object.assign(Object.assign({},r),{[t]:Object.assign(Object.assign({},o),UQ(c)?{}:{scale:c})})}}return Object.assign(Object.assign(Object.assign({},n),t),{encoding:r})}}function u7(t,e){return e?V6(t)?p7(t,e):d7(t,e):t}function c7(t,e){return e?p7(t,e):t}function l7(t,e,n){const r=e[t];return(i=r)&&!ve(i)&&"repeat"in i?r.repeat in n?Object.assign(Object.assign({},e),{[t]:n[r.repeat]}):void V3(y.noSuchRepeatedValue(r.repeat)):e;var i}function d7(t,e){if(void 0!==(t=l7("field",t,e))){if(null===t)return null;if(K6(t)&&W6(t.sort)){const n=l7("field",t.sort,e);t=Object.assign(Object.assign({},t),n?{sort:n}:{})}return t}}function f7(t,e){if(e5(t))return d7(t,e);{const n=l7("datum",t,e);return n===t||n.type||(n.type="nominal"),n}}function h7(t,e){if(!o5(t)){if(t5(t)){const n=f7(t.condition,e);if(n)return Object.assign(Object.assign({},t),{condition:n});{const{condition:e}=t;return w(t,["condition"])}}return t}{const n=f7(t,e);if(n)return n;if(Z6(t))return{condition:t.condition}}}function p7(t,e){const n={};for(const r in t)if(ce(t,r)){const i=t[r];if(_t(i))n[r]=i.map(t=>h7(t,e)).filter(t=>t);else{const t=h7(i,e);void 0!==t&&(n[r]=t)}}return n}class m7{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(P0(t)){const{encoding:e,mark:n}=t;if("line"===n)for(const t of E1){const n=e[j1(t)];if(e[t]&&(e5(n)&&!v2(n.bin)||r5(n)))return!0}}return!1}run(t,e,n){const{encoding:r}=t;return V3(y.lineWithRange(!!r.x2,!!r.y2)),n(Object.assign(Object.assign({},t),{mark:"rule"}),e)}}function g7(t){const{parentEncoding:e,encoding:n}=t;if(e&&n){const t=VQ(e).reduce((t,e)=>(n[e]&&t.push(e),t),[]);t.length>0&&V3(y.encodingOverridden(t))}const r=Object.assign(Object.assign({},null!=e?e:{}),null!=n?n:{});return UQ(r)?void 0:r}function b7(t){const{parentProjection:e,projection:n}=t;return e&&n&&V3(y.projectionOverridden({parentProjection:e,projection:n})),null!=n?n:e}function y7(t,e){void 0===e&&(e=W8(t.config));const n=function(t,e={}){return v7.map(t,{config:e})}(t,e),{width:r,height:i}=t,a=function(t,e,n){let{width:r,height:i}=e;const a=P0(t)||K8(t),o={};a?"container"==r&&"container"==i?(o.type="fit",o.contains="padding"):"container"==r?(o.type="fit-x",o.contains="padding"):"container"==i&&(o.type="fit-y",o.contains="padding"):("container"==r&&(V3(y.containerSizeNonSingle("width")),r=void 0),"container"==i&&(V3(y.containerSizeNonSingle("height")),i=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?x7(n.autosize):{}),x7(t.autosize));"fit"!==s.type||a||(V3(y.FIT_NON_SINGLE),s.type="pad");"container"==r&&"fit"!=s.type&&"fit-x"!=s.type&&V3(y.containerSizeNotCompatibleWithAutosize("width"));"container"==i&&"fit"!=s.type&&"fit-y"!=s.type&&V3(y.containerSizeNotCompatibleWithAutosize("height"));if(jQ(s,{type:"pad"}))return;return s}(n,{width:r,height:i,autosize:t.autosize},e);return Object.assign(Object.assign({},n),a?{autosize:a}:{})}const v7=new class extends Y8{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[c8,h8,y8,new o7,new m7,new s7]}map(t,e){if(P0(t)){const n=X5(t.encoding,Z0),r=X5(t.encoding,Q0),i=X5(t.encoding,"facet");if(n||r||i)return this.mapFacetedUnit(t,e)}return super.map(t,e)}mapUnit(t,e){const{parentEncoding:n,parentProjection:r}=e,i=Object.assign(Object.assign({},t),{encoding:c7(t.encoding,e.repeater)});if(n||r)return this.mapUnitWithParentEncodingOrProjection(i,e);const a=this.mapLayerOrUnit.bind(this);for(const t of this.nonFacetUnitNormalizers)if(t.hasMatchingType(i,e.config))return t.run(i,e,a);return i}mapRepeat(t,e){return function(t){return!_t(t.repeat)&&t.repeat.layer}(t)?this.mapLayerRepeat(t,e):this.mapNonLayerRepeat(t,e)}mapLayerRepeat(t,e){const{repeat:n,spec:r}=t,i=w(t,["repeat","spec"]),{row:a,column:o,layer:s}=n,{repeater:u={},repeaterPrefix:c=""}=e;return a||o?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},a?{row:a}:{}),o?{column:o}:{}),spec:{repeat:{layer:s},spec:r}}),e):Object.assign(Object.assign({},i),{layer:s.map(t=>{const n=Object.assign(Object.assign({},u),{layer:t}),i=(r.name||"")+c+"child__layer_"+KQ(t),a=this.mapLayerOrUnit(r,Object.assign(Object.assign({},e),{repeater:n,repeaterPrefix:i}));return a.name=i,a})})}mapNonLayerRepeat(t,e){var n;const{repeat:r,spec:i,data:a}=t,o=w(t,["repeat","spec","data"]);!_t(r)&&t.columns&&(t=FQ(t,["columns"]),V3(y.columnsNotSupportByRowCol("repeat")));const s=[],{repeater:u={},repeaterPrefix:c=""}=e,l=!_t(r)&&r.row||[u?u.row:null],d=!_t(r)&&r.column||[u?u.column:null],f=_t(r)&&r||[u?u.repeat:null];for(const t of f)for(const n of l)for(const a of d){const o={repeat:t,row:n,column:a,layer:u.layer},l=(i.name||"")+c+"child__"+(_t(r)?""+KQ(t):(r.row?"row_"+KQ(n):"")+(r.column?"column_"+KQ(a):"")),d=this.map(i,Object.assign(Object.assign({},e),{repeater:o,repeaterPrefix:l}));d.name=l,s.push(FQ(d,["data"]))}const h=_t(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:null!==(n=i.data)&&void 0!==n?n:a,align:"all"},o),{columns:h,concat:s})}mapFacet(t,e){const{facet:n}=t;return V6(n)&&t.columns&&(t=FQ(t,["columns"]),V3(y.columnsNotSupportByRowCol("facet"))),super.mapFacet(t,e)}mapUnitWithParentEncodingOrProjection(t,e){const{encoding:n,projection:r}=t,{parentEncoding:i,parentProjection:a,config:o}=e,s=b7({parentProjection:a,projection:r}),u=g7({parentEncoding:i,encoding:c7(n,e.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),s?{projection:s}:{}),u?{encoding:u}:{}),{config:o})}mapFacetedUnit(t,e){const n=t.encoding,{row:r,column:i,facet:a}=n,o=w(n,["row","column","facet"]),{mark:s,width:u,projection:c,height:l,view:d,selection:f,encoding:h}=t,p=w(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:m,layout:g}=this.getFacetMappingAndLayout({row:r,column:i,facet:a},e),b=c7(o,e.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),g),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{width:u}:{}),l?{height:l}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:s,encoding:b}),f?{selection:f}:{})}),e)}getFacetMappingAndLayout(t,e){var n;const{row:r,column:i,facet:a}=t;if(r||i){a&&V3(y.facetChannelDropped([...r?[Z0]:[],...i?[Q0]:[]]));const e={},o={};for(const r of[Z0,Q0]){const i=t[r];if(i){const{align:t,center:a,spacing:s,columns:u}=i,c=w(i,["align","center","spacing","columns"]);e[r]=c;for(const t of["align","center","spacing"])void 0!==i[t]&&(o[t]=null!==(n=o[t])&&void 0!==n?n:{},o[t][r]=i[t])}}return{facetMapping:e,layout:o}}{const{align:t,center:n,spacing:r,columns:i}=a;return{facetMapping:u7(w(a,["align","center","spacing","columns"]),e.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},t?{align:t}:{}),n?{center:n}:{}),r?{spacing:r}:{}),i?{columns:i}:{})}}}mapLayer(t,e){var{parentEncoding:n,parentProjection:r}=e,i=w(e,["parentEncoding","parentProjection"]);const{encoding:a,projection:o}=t,s=w(t,["encoding","projection"]),u=Object.assign(Object.assign({},i),{parentEncoding:g7({parentEncoding:n,encoding:a}),parentProjection:b7({parentProjection:r,projection:o})});return super.mapLayer(s,u)}};function x7(t){return ve(t)?{type:t}:null!=t?t:{}}const w7=["background","padding"];function k7(t){return w7.reduce((e,n)=>(t&&void 0!==t[n]&&(e[n]=t[n]),e),{})}class O7{constructor(t={},e={}){this.explicit=t,this.implicit=e}clone(){return new O7(NQ(this.explicit),NQ(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return a0(this.explicit[t],this.implicit[t])}getWithExplicit(t){return void 0!==this.explicit[t]?{explicit:!0,value:this.explicit[t]}:void 0!==this.implicit[t]?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,e){void 0!==e.value&&this.set(t,e.value,e.explicit)}set(t,e,n){return delete this[n?"implicit":"explicit"][t],this[n?"explicit":"implicit"][t]=e,this}copyKeyFromSplit(t,e){void 0!==e.explicit[t]?this.set(t,e.explicit[t],!0):void 0!==e.implicit[t]&&this.set(t,e.implicit[t],!1)}copyKeyFromObject(t,e){void 0!==e[t]&&this.set(t,e[t],!0)}copyAll(t){for(const e of VQ(t.combine())){const n=t.getWithExplicit(e);this.setWithExplicit(e,n)}}}function _7(t){return{explicit:!0,value:t}}function A7(t){return{explicit:!1,value:t}}function C7(t){return(e,n,r,i)=>{const a=t(e.value,n.value);return a>0?e:a<0?n:E7(e,n,r,i)}}function E7(t,e,n,r){return t.explicit&&e.explicit&&V3(y.mergeConflictingProperty(n,r,t.value,e.value)),t}function S7(t,e,n,r,i=E7){return void 0===t||void 0===t.value?e:t.explicit&&!e.explicit?t:e.explicit&&!t.explicit?e:jQ(t.value,e.value)?t:i(t,e,n,r)}class j7 extends O7{constructor(t={},e={},n=!1){super(t,e),this.explicit=t,this.implicit=e,this.parseNothing=n}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function N7(t){return"url"in t}function T7(t){return"values"in t}function F7(t){return"name"in t&&!N7(t)&&!T7(t)&&!D7(t)}function D7(t){return t&&(I7(t)||M7(t)||$7(t))}function I7(t){return"sequence"in t}function M7(t){return"sphere"in t}function $7(t){return"graticule"in t}const R7="main";function B7(t){return"filter"in t}function z7(t){return"lookup"in t}function L7(t){return"pivot"in t}function P7(t){return"density"in t}function q7(t){return"quantile"in t}function W7(t){return"regression"in t}function U7(t){return"loess"in t}function V7(t){return"sample"in t}function G7(t){return"window"in t}function H7(t){return"joinaggregate"in t}function X7(t){return"flatten"in t}function K7(t){return"calculate"in t}function Y7(t){return"bin"in t}function J7(t){return"impute"in t}function Z7(t){return"timeUnit"in t}function Q7(t){return"aggregate"in t}function t9(t){return"stack"in t}function e9(t){return"fold"in t}function n9(t,e,n,r){const i=Z6(e)&&e.condition,a=r(e);if(i){return{[n]:[...Kt(i).map(e=>{const n=r(e),i=function(t){return t.selection}(e)?xet(t,e.selection):ket(t,e.test);return Object.assign({test:i},n)}),...void 0!==a?[a]:[]]}}return void 0!==a?{[n]:a}:{}}function r9(t,e="text"){const n=t.encoding[e];return n9(t,n,e,e=>i9(e,t.config))}function i9(t,e,n="datum"){if(t){if(u5(t))return $5(t.value);if(o5(t)){const{format:r,formatType:i}=k5(t);return N6({fieldOrDatumDef:t,format:r,formatType:i,expr:n,config:e})}}}function a9(t,e={}){const{encoding:n,markDef:r,config:i,stack:a}=t,o=n.tooltip;if(_t(o))return{tooltip:s9({tooltip:o},a,i,e)};{const s=e.reactiveGeom?"datum.datum":"datum";return n9(t,o,"tooltip",t=>{const o=i9(t,i,s);if(o)return o;if(null===t)return;let u=L5("tooltip",r,i);return!0===u&&(u={content:"encoding"}),ve(u)?{value:u}:At(u)?"encoding"===u.content?s9(n,a,i,e):{signal:s}:void 0})}}function o9(t,e,n,{reactiveGeom:r}={}){const i={},a=r?"datum.datum":"datum",o=[];function s(r,s){const u=j1(s),c=s5(r)?r:Object.assign(Object.assign({},r),{type:t[u].type}),l=Kt(v5(c,n,{allowDisabling:!1})).join(", ");let d;if(K1(s)){const r="x"===s?"x2":"y2",o=O5(t[r]);if(v2(c.bin)&&o){const t=h5(c,{expr:a}),e=h5(o,{expr:a}),{format:s,formatType:u}=k5(c);d=B6(t,e,s,u,n),i[r]=!0}else if(e&&e.fieldChannel===s&&"normalize"===e.offset){const{format:t,formatType:e}=k5(c);d=N6({fieldOrDatumDef:c,format:t,formatType:e,expr:a,config:n,normalizeStack:!0}).signal}}d=null!=d?d:i9(c,n,a).signal,o.push({channel:s,key:l,value:d})}Q5(t,(t,e)=>{e5(t)?s(t,e):Q6(t)&&s(t.condition,e)});const u={};for(const{channel:t,key:e,value:n}of o)i[t]||u[e]||(u[Ee(e)]=n);return u}function s9(t,e,n,{reactiveGeom:r}={}){const i=HQ(o9(t,e,n,{reactiveGeom:r})).map(({key:t,value:e})=>`${t}: ${e}`);return i.length>0?{signal:`{${i.join(", ")}}`}:void 0}function u9(t){const{markDef:e,config:n}=t,r=L5("aria",e,n);return!1===r?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),function(t){const{mark:e,markDef:n,config:r}=t;if(!1===r.aria)return{};const i=L5("ariaRoleDescription",n,r);if(null!=i)return{ariaRoleDescription:{value:i}};return e in f4?{}:{ariaRoleDescription:{value:e}}}(t)),function(t){const{encoding:e,markDef:n,config:r,stack:i}=t,a=e.description;if(a)return n9(t,a,"description",e=>i9(e,t.config));const o=L5("description",n,r);if(null!=o)return{description:$5(o)};if(!1===r.aria)return{};const s=o9(e,i,r);if(UQ(s))return;return{description:{signal:HQ(s).map(({key:t,value:e})=>`${t} + ": " + (${e})`).join(' + "; " + ')}}}(t))}function c9(t,e,n={}){const{markDef:r,encoding:i,config:a}=e,{vgChannel:o}=n;let{defaultRef:s,defaultValue:u}=n;void 0===s&&(u=null!=u?u:L5(t,r,a,{vgChannel:o,ignoreVgConfig:!0}),void 0!==u&&(s=$5(u)));const c=i[t];return n9(e,c,null!=o?o:t,n=>C6({channel:t,channelDef:n,markDef:r,config:a,scaleName:e.scaleName(t),scale:e.getScaleComponent(t),stack:null,defaultRef:s}))}function l9(t,e={filled:void 0}){var n,r,i,a;const{markDef:o,encoding:s,config:u}=t,{type:c}=o,l=null!==(n=e.filled)&&void 0!==n?n:L5("filled",o,u),d=$Q(["bar","point","circle","square","geoshape"],c)?"transparent":void 0,f=null!==(i=null!==(r=L5(!0===l?"color":void 0,o,u,{vgChannel:"fill"}))&&void 0!==r?r:u.mark[!0===l&&"color"])&&void 0!==i?i:d,h=null!==(a=L5(!1===l?"color":void 0,o,u,{vgChannel:"stroke"}))&&void 0!==a?a:u.mark[!1===l&&"color"],p=l?"fill":"stroke",m=Object.assign(Object.assign({},f?{fill:$5(f)}:{}),h?{stroke:$5(h)}:{});return o.color&&(l?o.fill:o.stroke)&&V3(y.droppingColor("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},m),c9("color",t,{vgChannel:p,defaultValue:l?f:h})),c9("fill",t,{defaultValue:s.fill?f:void 0})),c9("stroke",t,{defaultValue:s.stroke?h:void 0}))}function d9(t,e){const n=e[function(t){switch(t){case"x":return"xOffset";case"y":return"yOffset";case"x2":return"x2Offset";case"y2":return"y2Offset";case e1:return"thetaOffset";case t1:return"radiusOffset";case n1:return"theta2Offset";case"radius2":return"radius2Offset"}}(t)];if(n)return n}function f9(t,e,{defaultPos:n,vgChannel:r,isMidPoint:i}){const{encoding:a,markDef:o,config:s,stack:u}=e,c=a[t],l=a[T1(t)],d=e.scaleName(t),f=e.getScaleComponent(t),h=d9(t,o),p=h9({model:e,defaultPos:n,channel:t,scaleName:d,scale:f}),m=!c&&K1(t)&&(a.latitude||a.longitude)?{field:e.getName(t)}:function(t){const{channel:e,channelDef:n,isMidPoint:r,scaleName:i,stack:a,offset:o,markDef:s,config:u}=t;if(o5(n)&&a&&e===a.fieldChannel){if(e5(n)){const t=Y6({channel:e,fieldDef:n,isMidPoint:r,markDef:s,stack:a,config:u});if(void 0!==t)return A6({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:t,offset:o})}return _6(n,i,{suffix:"end"},{offset:o})}return x6(t)}({channel:t,channelDef:c,channel2Def:l,markDef:o,config:s,isMidPoint:i,scaleName:d,scale:f,stack:u,offset:h,defaultRef:p});return m?{[r||t]:m}:void 0}function h9({model:t,defaultPos:e,channel:n,scaleName:r,scale:i}){const{markDef:a,config:o}=t;return()=>{const s=j1(n),u=N1(n),c=L5(n,a,o,{vgChannel:u});if(void 0!==c)return E6(n,c);switch(e){case"zeroOrMin":case"zeroOrMax":if(r){const t=i.get("type");if($Q([I4,B4,z4],t));else if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}if("zeroOrMin"===e)return"y"===s?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${t.width.signal},${t.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const e=t[F1(n)];return Object.assign(Object.assign({},e),{mult:.5})}}}}const p9={left:"x",center:"xc",right:"x2"},m9={top:"y",middle:"yc",bottom:"y2"};function g9(t,e,n,r="middle"){if("radius"===t||"theta"===t)return N1(t);const i=L5("x"===t?"align":"baseline",e,n);return"x"===t?p9[i||("top"===r?"left":"center")]:m9[i||r]}function b9(t,e,{defaultPos:n,defaultPos2:r,range:i}){return i?y9(t,e,{defaultPos:n,defaultPos2:r}):f9(t,e,{defaultPos:n})}function y9(t,e,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:a}=e,o=T1(t),s=F1(t),u=function(t,e,n){const{encoding:r,mark:i,markDef:a,stack:o,config:s}=t,u=j1(n),c=F1(n),l=N1(n),d=r[u],f=t.scaleName(u),h=t.getScaleComponent(u),p=d9(n in r||n in a?n:u,t.markDef);if(!d&&("x2"===n||"y2"===n)&&(r.latitude||r.longitude))return{[l]:{field:t.getName(n)}};const m=function({channel:t,channelDef:e,channel2Def:n,markDef:r,config:i,scaleName:a,scale:o,stack:s,offset:u,defaultRef:c}){if(o5(e)&&s&&t.charAt(0)===s.fieldChannel.charAt(0))return _6(e,a,{suffix:"start"},{offset:u});return x6({channel:t,channelDef:n,scaleName:a,scale:o,stack:s,markDef:r,config:i,offset:u,defaultRef:c})}({channel:n,channelDef:d,channel2Def:r[n],markDef:a,config:s,scaleName:f,scale:h,stack:o,offset:p,defaultRef:void 0});if(void 0!==m)return{[l]:m};return v9(n,a)||v9(n,{[n]:q5(n,a,s.style),[c]:q5(c,a,s.style)})||v9(n,s[i])||v9(n,s.mark)||{[l]:h9({model:t,defaultPos:e,channel:n,scaleName:f,scale:h})()}}(e,r,o),c=u[s]?g9(t,i,a):N1(t);return Object.assign(Object.assign({},f9(t,e,{defaultPos:n,vgChannel:c})),u)}function v9(t,e){const n=F1(t),r=N1(t);return void 0!==e[r]?{[r]:E6(t,e[r])}:void 0!==e[t]?{[r]:E6(t,e[t])}:e[n]?{[n]:E6(t,e[n])}:void 0}function x9(t,e,n){var r,i,a,o;const{config:s,encoding:u,markDef:c,stack:l}=t,d=T1(e),f=F1(e),h=u[e],p=u[d],m=t.getScaleComponent(e),g=m?m.get("type"):void 0,b=t.scaleName(e),v=c.orient,x=null!==(i=null!==(r=u[f])&&void 0!==r?r:u.size)&&void 0!==i?i:L5("size",c,s,{vgChannel:f}),w="bar"===n&&("x"===e?"vertical"===v:"horizontal"===v);if(e5(h)&&(y2(h.bin)||v2(h.bin)||h.timeUnit&&!p)&&!x&&!r6(g)){const n=Y6({channel:e,fieldDef:h,stack:l,markDef:c,config:s}),r=null===(a=t.component.axes[e])||void 0===a?void 0:a[0];return function({fieldDef:t,fieldDef2:e,channel:n,band:r,scaleName:i,markDef:a,spacing:o=0,axisTranslate:s,reverse:u,config:c}){const l=T1(n),d=N1(n),f=N1(l),h=d9(n,a);if(y2(t.bin)||t.timeUnit)return{[f]:O9({channel:n,fieldDef:t,scaleName:i,markDef:a,band:(1-r)/2,offset:k9(l,o,u,s,h),config:c}),[d]:O9({channel:n,fieldDef:t,scaleName:i,markDef:a,band:1-(1-r)/2,offset:k9(n,o,u,s,h),config:c})};if(v2(t.bin)){const r=_6(t,i,{},{offset:k9(l,o,u,s,h)});if(e5(e))return{[f]:r,[d]:_6(e,i,{},{offset:k9(n,o,u,s,h)})};if(x2(t.bin)&&t.bin.step)return{[f]:r,[d]:{signal:`scale("${i}", ${h5(t,{expr:"datum"})} + ${t.bin.step})`,offset:k9(n,o,u,s,h)}}}return void V3(y.channelRequiredForBinned(l))}({fieldDef:h,fieldDef2:p,channel:e,markDef:c,scaleName:b,band:n,axisTranslate:null!==(o=null==r?void 0:r.get("translate"))&&void 0!==o?o:.5,spacing:K1(e)?L5("binSpacing",c,s):void 0,reverse:m.get("reverse"),config:s})}return(o5(h)&&r6(g)||w)&&!p?function(t,e,n,r){var i;const{markDef:a,encoding:o,config:s,stack:u}=r,c=a.orient,l=r.scaleName(n),d=r.getScaleComponent(n),f=F1(n),h=T1(n),p="horizontal"===c&&"y"===n||"vertical"===c&&"x"===n,m=L5(p?"size":f,a,s,{vgChannel:f});let g;(o.size||void 0!==m)&&(p?g=c9("size",r,{vgChannel:f,defaultValue:m}):V3(y.cannotApplySizeToNonOrientedMark(a.type)));const b=null!==(i=o5(e)?Y6({channel:n,fieldDef:e,markDef:a,stack:u,config:s}):void 0)&&void 0!==i?i:1;g=g||{[f]:w9(t,f,l,d,s,b)};const v="band"!==(null==d?void 0:d.get("type"))||!("band"in g[f]),x=g9(n,a,s,v?"middle":"top"),w=d9(n,a),k=x6({channel:n,channelDef:e,markDef:a,config:s,scaleName:l,scale:d,stack:u,offset:w,defaultRef:h9({model:r,defaultPos:"mid",channel:n,scaleName:l,scale:d}),band:v?.5:(1-b)/2});if(f)return Object.assign({[x]:k},g);{const t=N1(h),e=g[f],n=w?Object.assign(Object.assign({},e),{offset:w}):e;return{[x]:k,[t]:_t(k)?[k[0],Object.assign(Object.assign({},k[1]),{offset:n})]:Object.assign(Object.assign({},k),{offset:n})}}}(n,h,e,t):y9(e,t,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function w9(t,e,n,r,i,a){if(r){const e=r.get("type");if("point"===e||"band"===e){if(void 0!==i[t].discreteBandSize)return{value:i[t].discreteBandSize};if(e===W4){const t=r.get("range");return c4(t)&&be(t.step)?{value:t.step-2}:{value:B8-2}}return{scale:n,band:a}}return{value:i[t].continuousBandSize}}const o=$8(i.view,e),s=a0(i[t].discreteBandSize,o-2);return void 0!==s?{value:s}:void 0}function k9(t,e,n,r,i){if(c1(t))return 0;const a="x"===t||"y2"===t?-e/2:e/2;if(u4(n)){const t=B5(i);return{signal:`${n.signal} ? ${r-a}${t?"-"+t:""} : ${r+a}${t?"+"+t:""}`}}if(u4(i)){const t=r+(n?-a:a);return{signal:`${t||""}${n?" - ":t?" + ":""}${i.signal}`}}return i=i||0,r+(n?-i-a:+i+a)}function O9({channel:t,fieldDef:e,scaleName:n,markDef:r,band:i,offset:a,config:o}){return w6({fieldDef:e,channel:t,markDef:r,ref:A6({scaleName:n,fieldOrDatumDef:e,band:i,offset:a}),config:o})}const _9=new Set(["aria"]);function A9(t,e){const{fill:n,stroke:r}="include"===e.color?l9(t):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(t,e){return d4.reduce((n,r)=>(_9.has(r)||void 0===t[r]||"ignore"===e[r]||(n[r]=$5(t[r])),n),{})}(t.markDef,e)),C9(t,"fill",n)),C9(t,"stroke",r)),c9("opacity",t)),c9("fillOpacity",t)),c9("strokeOpacity",t)),c9("strokeWidth",t)),c9("strokeDash",t)),a9(t)),r9(t,"href")),u9(t))}function C9(t,e,n){const{config:r,mark:i,markDef:a}=t;if("hide"===L5("invalid",a,r)&&n&&!F0(i)){const r=function(t,{invalid:e=!1,channels:n}){const r=n.reduce((e,n)=>{const r=t.getScaleComponent(n);if(r){const i=r.get("type"),a=t.vgField(n,{expr:"datum"});a&&i6(i)&&(e[a]=!0)}return e},{}),i=VQ(r);if(i.length>0){const t=e?"||":"&&";return i.map(t=>O6(t,e)).join(` ${t} `)}return}(t,{invalid:!0,channels:l2});if(r)return{[e]:[{test:r,value:null},...Kt(n)]}}return n?{[e]:n}:{}}function E9(t){const{config:e,markDef:n}=t;if(L5("invalid",n,e)){const e=function(t,{invalid:e=!1,channels:n}){const r=n.reduce((e,n)=>{const r=t.getScaleComponent(n);if(r){const i=r.get("type"),a=t.vgField(n,{expr:"datum"});a&&i6(i)&&(e[a]=!0)}return e},{}),i=VQ(r);if(i.length>0){const t=e?"||":"&&";return i.map(t=>O6(t,e)).join(` ${t} `)}return}(t,{channels:X1});if(e)return{defined:{signal:e}}}return{}}function S9(t,e){if(void 0!==e)return{[t]:$5(e)}}var j9={has:t=>"interval"!==t.type&&t.nearest,parse:(t,e)=>{if(e.events)for(const n of e.events)n.markname=t.getName("voronoi")},marks:(t,e,n)=>{const{x:r,y:i}=e.project.hasChannel,a=t.mark;if(F0(a))return V3(y.nearestNotSupportForContinuous(a)),n;const o={name:t.getName("voronoi"),type:"path",interactive:!0,from:{data:t.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},a9(t,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]}]};let s=0,u=!1;return n.forEach((e,n)=>{var r;const i=null!==(r=e.name)&&void 0!==r?r:"";i===t.component.mark[0].name?s=n:i.indexOf("voronoi")>=0&&(u=!0)}),u||n.splice(s+1,0,o),n}};class N9{constructor(t,e){this.debugName=e,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,e){this._children.indexOf(t)>-1?console.warn("Attempt to add the same child twice."):void 0!==e?this._children.splice(e,0,t):this._children.push(t)}removeChild(t){const e=this._children.indexOf(t);return this._children.splice(e,1),e}remove(){let t=this._parent.removeChild(this);for(const e of this._children)e._parent=this._parent,this._parent.addChild(e,t++)}insertAsParentOf(t){const e=t.parent;e.removeChild(this),this.parent=e,t.parent=this}swapWithParent(){const t=this._parent,e=t.parent;for(const e of this._children)e.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=e,t.parent=this}}class T9 extends N9{constructor(t,e,n,r){super(t,e),this.type=n,this.refCounts=r,this._source=this._name=e,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash="Output "+s0()),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class F9 extends N9{constructor(t,e){super(t),this.formula=e}clone(){return new F9(null,NQ(this.formula))}static makeFromEncoding(t,e){const n=e.reduceFieldDef((t,n,r)=>{const{field:i,timeUnit:a}=n,o=Xrt(e)?e.encoding[T1(r)]:void 0,s=Xrt(e)&&J6(r,n,o,e.stack,e.markDef,e.config);if(a){const e=h5(n,{forAs:!0});t[IQ({as:e,field:i,timeUnit:a})]=Object.assign({as:e,field:i,timeUnit:a},s?{band:!0}:{})}return t},{});return UQ(n)?null:new F9(t,n)}static makeFromTransform(t,e){const n=Object.assign({},e),{timeUnit:r}=n,i=w(n,["timeUnit"]),a=s4(r),o=Object.assign(Object.assign({},i),{timeUnit:a});return new F9(t,{[IQ(o)]:o})}merge(t){this.formula=Object.assign({},this.formula);for(const e in t.formula)this.formula[e]&&!t.formula[e].band||(this.formula[e]=t.formula[e]);for(const e of t.children)t.removeChild(e),e.parent=this;t.remove()}producedFields(){return new Set(GQ(this.formula).map(t=>t.as))}dependentFields(){return new Set(GQ(this.formula).map(t=>t.field))}hash(){return"TimeUnit "+IQ(this.formula)}assemble(){const t=[];for(const e of GQ(this.formula)){const{field:n,as:r,timeUnit:i}=e,a=s4(i),{unit:o,utc:s}=a,u=w(a,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:e0(n),type:"timeunit"},o?{units:r4(o)}:{}),s?{timezone:"utc"}:{}),u),{as:[r,r+"_end"]}))}return t}}class D9{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}var I9={has:t=>"single"===t.type&&"global"===t.resolve&&t.bind&&"scales"!==t.bind&&!E8(t.bind),parse:(t,e,n,r)=>{r.on||delete e.events,r.clear||delete e.clear},topLevelSignals:(t,e,n)=>{const r=e.name,i=e.project,a=e.bind,o=e.init&&e.init[0],s=j9.has(e)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((t,i)=>{var u,c;const l=KQ(`${r}_${t.field}`);n.filter(t=>t.name===l).length||n.unshift(Object.assign(Object.assign({name:l},o?{init:X9(o[i])}:{value:null}),{on:e.events?[{events:e.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${Ee(t.field)}] : null`}]:[],bind:null!==(c=null!==(u=a[t.field])&&void 0!==u?u:a[t.channel])&&void 0!==c?c:a}))}),n},signals:(t,e,n)=>{const r=e.name,i=e.project,a=n.filter(t=>t.name===r+itt)[0],o=r+"_tuple_fields",s=i.items.map(t=>KQ(`${r}_${t.field}`)),u=s.map(t=>t+" !== null").join(" && ");return s.length&&(a.update=`${u} ? {fields: ${o}, values: [${s.join(", ")}]} : null`),delete a.value,delete a.on,n}};var M9={has:t=>"multi"===t.type&&!!t.toggle,signals:(t,e,n)=>n.concat({name:e.name+"_toggle",value:!1,on:[{events:e.events,update:e.toggle}]}),modifyExpr:(t,e)=>{const n=e.name+itt,r=e.name+"_toggle";return`${r} ? null : ${n}, `+("global"===e.resolve?r+" ? null : true, ":`${r} ? null : {unit: ${ctt(t)}}, `)+`${r} ? ${n} : null`}};const $9={has:t=>void 0!==t.clear&&!1!==t.clear,parse:(t,e,n)=>{n.clear&&(e.clear=ve(n.clear)?OY(n.clear,"scope"):n.clear)},topLevelSignals:(t,e,n)=>{if(I9.has(e))for(const t of e.project.items){const r=n.findIndex(n=>n.name===KQ(`${e.name}_${t.field}`));-1!==r&&n[r].on.push({events:e.clear,update:"null"})}return n},signals:(t,e,n)=>{function r(t,r){-1!==t&&n[t].on&&n[t].on.push({events:e.clear,update:r})}if("interval"===e.type)for(const t of e.project.items){const e=n.findIndex(e=>e.name===t.signals.visual);if(r(e,"[0, 0]"),-1===e){r(n.findIndex(e=>e.name===t.signals.data),"null")}}else{let t=n.findIndex(t=>t.name===e.name+itt);r(t,"null"),M9.has(e)&&(t=n.findIndex(t=>t.name===e.name+"_toggle"),r(t,"false"))}return n}};var R9={has:t=>"interval"===t.type&&"global"===t.resolve&&t.bind&&"scales"===t.bind,parse:(t,e)=>{const n=e.scales=[];for(const r of e.project.items){const i=r.channel;if(!d2(i))continue;const a=t.getScaleComponent(i),o=a?a.get("type"):void 0;if(!a||!i6(o)){V3(y.SCALE_BINDINGS_CONTINUOUS);continue}const s={selection:e.name,field:r.field};a.set("selectionExtent",s,!0),n.push(r)}},topLevelSignals:(t,e,n)=>{const r=e.scales.filter(t=>0===n.filter(e=>e.name===t.signals.data).length);if(!t.parent||z9(t)||0===r.length)return n;const i=n.filter(t=>t.name===e.name)[0];let a=i.update;if(a.indexOf(ott)>=0)i.update=`{${r.map(t=>`${Ee(t.field)}: ${t.signals.data}`).join(", ")}}`;else{for(const t of r){const e=`${Ee(t.field)}: ${t.signals.data}`;a.indexOf(e)<0&&(a=`${a.substring(0,a.length-1)}, ${e}}`)}i.update=a}return n.concat(r.map(t=>({name:t.signals.data})))},signals:(t,e,n)=>{if(t.parent&&!z9(t))for(const t of e.scales){const e=n.filter(e=>e.name===t.signals.data)[0];e.push="outer",delete e.value,delete e.update}return n}};function B9(t,e){return`domain(${Ee(t.scaleName(e))})`}function z9(t){var e;return t.parent&&Jrt(t.parent)&&(null!==(e=!t.parent.parent)&&void 0!==e?e:z9(t.parent.parent))}const L9={has:t=>{const e="global"===t.resolve&&t.bind&&E8(t.bind),n=1===t.project.items.length&&"_vgsid_"!==t.project.items[0].field;return e&&!n&&V3(y.LEGEND_BINDINGS_PROJECT_LENGTH),e&&n},parse:(t,e,n,r)=>{var i;if(r.on||delete e.events,r.clear||delete e.clear,r.on||r.clear){const t='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of e.events)n.filter=Kt(null!==(i=n.filter)&&void 0!==i?i:[]),n.filter.indexOf(t)<0&&n.filter.push(t)}const a=S8(e.bind)?e.bind.legend:"click",o=ve(a)?OY(a,"view"):Kt(a);e.bind={legend:{merge:o}}},topLevelSignals:(t,e,n)=>{const r=e.name,i=S8(e.bind)&&e.bind.legend,a=t=>e=>{const n=NQ(e);return n.markname=t,n};for(const t of e.project.items){if(!t.hasLegend)continue;const o=KQ(t.field)+"_legend",s=`${r}_${o}`;if(0===n.filter(t=>t.name===s).length){const t=i.merge.map(a(o+"_symbols")).concat(i.merge.map(a(o+"_labels"))).concat(i.merge.map(a(o+"_entries")));n.unshift(Object.assign(Object.assign({name:s},e.init?{}:{value:null}),{on:[{events:t,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:"!event.item || !datum ? null : "+s,force:!0}]}))}}return n},signals:(t,e,n)=>{const r=e.name,i=e.project,a=n.find(t=>t.name===r+itt),o=r+"_tuple_fields",s=i.items.filter(t=>t.hasLegend).map(t=>KQ(`${r}_${KQ(t.field)}_legend`)),u=`${s.map(t=>t+" !== null").join(" && ")} ? {fields: ${o}, values: [${s.join(", ")}]} : null`;e.events&&s.length>0?a.on.push({events:s.map(t=>({signal:t})),update:u}):s.length>0&&(a.update=u,delete a.value,delete a.on);const c=n.find(t=>t.name===r+"_toggle"),l=S8(e.bind)&&e.bind.legend;return c&&(e.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:l})):c.on[0].events=l),n}};const P9="_translate_delta",q9={has:t=>"interval"===t.type&&t.translate,signals:(t,e,n)=>{const r=e.name,i=R9.has(e),a=r+"_translate_anchor",{x:o,y:s}=e.project.hasChannel;let u=OY(e.translate,"scope");return i||(u=u.map(t=>(t.between[0].markname=r+J9,t))),n.push({name:a,value:{},on:[{events:u.map(t=>t.between[0]),update:"{x: x(unit), y: y(unit)"+(void 0!==o?", extent_x: "+(i?B9(t,"x"):`slice(${o.signals.visual})`):"")+(void 0!==s?", extent_y: "+(i?B9(t,"y"):`slice(${s.signals.visual})`):"")+"}"}]},{name:r+P9,value:{},on:[{events:u,update:`{x: ${a}.x - x(unit), y: ${a}.y - y(unit)}`}]}),void 0!==o&&W9(t,e,o,"width",n),void 0!==s&&W9(t,e,s,"height",n),n}};function W9(t,e,n,r,i){var a;const o=e.name,s=o+"_translate_anchor",u=o+P9,c=n.channel,l=R9.has(e),d=i.filter(t=>t.name===n.signals[l?"data":"visual"])[0],f=t.getSizeSignalRef(r).signal,h=t.getScaleComponent(c),p=h.get("type"),m=`${s}.extent_${c}`,g=`${l?"log"===p?"panLog":"pow"===p?"panPow":"panLinear":"panLinear"}(${m}, ${`${l&&"x"===c?"-":""}${u}.${c} / `+(l?""+f:`span(${m})`)}`+(l&&"pow"===p?", "+(null!==(a=h.get("exponent"))&&void 0!==a?a:1):"")+")";d.on.push({events:{signal:u},update:l?g:`clampRange(${g}, 0, ${f})`})}const U9={has:t=>"interval"===t.type&&t.zoom,signals:(t,e,n)=>{const r=e.name,i=R9.has(e),a=r+"_zoom_delta",{x:o,y:s}=e.project.hasChannel,u=Ee(t.scaleName("x")),c=Ee(t.scaleName("y"));let l=OY(e.zoom,"scope");return i||(l=l.map(t=>(t.markname=r+J9,t))),n.push({name:r+"_zoom_anchor",on:[{events:l,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",c?`y: invert(${c}, y(unit))`:""].filter(t=>!!t).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:l,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==o&&V9(t,e,o,"width",n),void 0!==s&&V9(t,e,s,"height",n),n}};function V9(t,e,n,r,i){var a;const o=e.name,s=n.channel,u=R9.has(e),c=i.filter(t=>t.name===n.signals[u?"data":"visual"])[0],l=t.getSizeSignalRef(r).signal,d=t.getScaleComponent(s),f=d.get("type"),h=u?B9(t,s):c.name,p=o+"_zoom_delta",m=`${u?"log"===f?"zoomLog":"pow"===f?"zoomPow":"zoomLinear":"zoomLinear"}(${h}, ${`${o}_zoom_anchor.${s}`}, ${p}`+(u&&"pow"===f?", "+(null!==(a=d.get("exponent"))&&void 0!==a?a:1):"")+")";c.on.push({events:{signal:p},update:u?m:`clampRange(${m}, 0, ${l})`})}const G9=[{has:()=>!0,parse:(t,e,n)=>{var r,i,a;const o=e.name,s=null!==(r=e.project)&&void 0!==r?r:e.project=new D9,u={},c={},l=new Set,d=(t,e)=>{const n="visual"===e?t.channel:t.field;let r=KQ(`${o}_${n}`);for(let t=1;l.has(r);t++)r=KQ(`${o}_${n}_${t}`);return l.add(r),{[e]:r}};if(!n.fields&&!n.encodings){const e=t.config.selection[n.type];if(n.init)for(const t of Kt(n.init))for(const r of VQ(t))A1[r]?(n.encodings||(n.encodings=[])).push(r):"interval"===n.type?(V3('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=e.encodings):(n.fields||(n.fields=[])).push(r);else n.encodings=e.encodings,n.fields=e.fields}for(const t of null!==(i=n.fields)&&void 0!==i?i:[]){const e={type:"E",field:t};e.signals=Object.assign({},d(e,"data")),s.items.push(e),s.hasField[t]=e}for(const r of null!==(a=n.encodings)&&void 0!==a?a:[]){const n=t.fieldDef(r);if(n){let i=n.field;if(n.aggregate){V3(y.cannotProjectAggregate(r,n.aggregate));continue}if(!i){V3(y.cannotProjectOnChannelWithoutField(r));continue}if(n.timeUnit){i=t.vgField(r);const e={timeUnit:n.timeUnit,as:i,field:n.field};c[IQ(e)]=e}if(!u[i]){let a="E";if("interval"===e.type){i6(t.getScaleComponent(r).get("type"))&&(a="R")}else n.bin&&(a="R-RE");const o={field:i,channel:r,type:a};o.signals=Object.assign(Object.assign({},d(o,"data")),d(o,"visual")),s.items.push(u[i]=o),s.hasField[i]=s.hasChannel[r]=u[i]}}else V3(y.cannotProjectOnChannelWithoutField(r))}if(n.init){const t=t=>s.items.map(e=>void 0!==t[e.channel]?t[e.channel]:t[e.field]);if("interval"===n.type)e.init=t(n.init);else{const r=Kt(n.init);e.init=r.map(t)}}UQ(c)||(s.timeUnit=new F9(null,c))},signals:(t,e,n)=>{const r=e.name+"_tuple_fields";return n.filter(t=>t.name===r).length>0?n:n.concat({name:r,value:e.project.items.map(t=>{const{signals:e,hasLegend:n}=t,r=w(t,["signals","hasLegend"]);return r.field=e0(r.field),r})})}},M9,R9,L9,q9,U9,I9,j9,$9];function H9(t,e){for(const n of G9)n.has(t)&&e(n)}function X9(t,e=!0,n=ft){if(_t(t)){const r=t.map(t=>X9(t,e,n));return e?`[${r.join(", ")}]`:r}return G3(t)?n(e?Z3(t):function(t){const e=J3(t,!0);return t.utc?+new Date(Date.UTC(...e)):+new Date(...e)}(t)):e?n(JSON.stringify(t)):t}function K9(t,e){return utt(t,(n,r)=>{e=r.marks?r.marks(t,n,e):e,H9(n,r=>{r.marks&&(e=r.marks(t,n,e))})}),e}function Y9(t){return t.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const J9="_brush",Z9={signals:(t,e)=>{const n=e.name,r=n+"_tuple_fields",i=R9.has(e),a=[],o=[],s=[];if(e.translate&&!i){const t="!event.item || event.item.mark.name !== "+Ee(n+J9);Q9(e,(e,n)=>{var r;const i=Kt(null!==(r=n.between[0].filter)&&void 0!==r?r:n.between[0].filter=[]);return i.indexOf(t)<0&&i.push(t),e})}e.project.items.forEach((n,r)=>{const i=n.channel;if("x"!==i&&"y"!==i)return void V3("Interval selections only support x and y encoding channels.");const u=e.init?e.init[r]:null,c=function(t,e,n,r){const i=n.channel,a=n.signals.visual,o=n.signals.data,s=R9.has(e),u=Ee(t.scaleName(i)),c=t.getScaleComponent(i),l=c?c.get("type"):void 0,d=t=>`scale(${u}, ${t})`,f=t.getSizeSignalRef("x"===i?"width":"height").signal,h=i+"(unit)",p=Q9(e,(t,e)=>[...t,{events:e.between[0],update:`[${h}, ${h}]`},{events:e,update:`[${a}[0], clamp(${h}, 0, ${f})]`}]);return p.push({events:{signal:e.name+"_scale_trigger"},update:i6(l)?`[${d(o+"[0]")}, ${d(o+"[1]")}]`:"[0, 0]"}),s?[{name:o,on:[]}]:[Object.assign(Object.assign({name:a},r?{init:X9(r,!0,d)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},r?{init:X9(r)}:{}),{on:[{events:{signal:a},update:`${a}[0] === ${a}[1] ? null : invert(${u}, ${a})`}]})]}(t,e,n,u),l=n.signals.data,d=n.signals.visual,f=Ee(t.scaleName(i)),h=i6(t.getScaleComponent(i).get("type"))?"+":"";a.push(...c),o.push(l),s.push({scaleName:t.scaleName(i),expr:`(!isArray(${l}) || (${h}invert(${f}, ${d})[0] === ${h}${l}[0] && ${h}invert(${f}, ${d})[1] === ${h}${l}[1]))`})}),i||a.push({name:n+"_scale_trigger",value:{},on:[{events:s.map(t=>({scale:t.scaleName})),update:s.map(t=>t.expr).join(" && ")+` ? ${n+"_scale_trigger"} : {}`}]});const u=e.init,c=`unit: ${ctt(t)}, fields: ${r}, values`;return a.concat(Object.assign(Object.assign({name:n+itt},u?{init:`{${c}: ${X9(u)}}`}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+` ? {${c}: [${o}]} : null`}]}))},modifyExpr:(t,e)=>e.name+itt+", "+("global"===e.resolve?"true":`{unit: ${ctt(t)}}`),marks:(t,e,n)=>{const r=e.name,{x:i,y:a}=e.project.hasChannel,o=i&&i.signals.visual,s=a&&a.signals.visual,u=`data(${Ee(e.name+rtt)})`;if(R9.has(e))return n;const c={x:void 0!==i?{signal:o+"[0]"}:{value:0},y:void 0!==a?{signal:s+"[0]"}:{value:0},x2:void 0!==i?{signal:o+"[1]"}:{field:{group:"width"}},y2:void 0!==a?{signal:s+"[1]"}:{field:{group:"height"}}};if("global"===e.resolve)for(const e of VQ(c))c[e]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${ctt(t)}`},c[e]),{value:0}];const l=e.mark,{fill:d,fillOpacity:f,cursor:h}=l,p=w(l,["fill","fillOpacity","cursor"]),m=VQ(p).reduce((t,e)=>(t[e]=[{test:[void 0!==i&&`${o}[0] !== ${o}[1]`,void 0!==a&&`${s}[0] !== ${s}[1]`].filter(t=>t).join(" && "),value:p[e]},{value:null}],t),{});return[{name:r+J9+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:d},fillOpacity:{value:f}},update:c}},...n,{name:r+J9,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},c),m)}}]}};function Q9(t,e){return t.events.reduce((t,n)=>n.between?e(t,n):(V3(n+" is not an ordered event stream for interval selections."),t),[])}function ttt(t,e){const n=e.name,r=n+"_tuple_fields",i=e.project,a="(item().isVoronoi ? datum.datum : datum)",o=i.items.map(e=>{const n=t.fieldDef(e.channel);return n&&n.bin?`[${a}[${Ee(t.vgField(e.channel,{}))}], ${a}[${Ee(t.vgField(e.channel,{binSuffix:"end"}))}]]`:`${a}[${Ee(e.field)}]`}).join(", "),s=`unit: ${ctt(t)}, fields: ${r}, values`,u=e.events;return[{name:n+itt,on:u?[{events:u,update:`datum && item().mark.marktype !== 'group' ? {${s}: [${o}]} : null`,force:!0}]:[]}]}const ett={signals:ttt,modifyExpr:(t,e)=>e.name+itt+", "+("global"===e.resolve?"null":`{unit: ${ctt(t)}}`)};const ntt={signals:ttt,modifyExpr:(t,e)=>e.name+itt+", "+("global"===e.resolve?"true":`{unit: ${ctt(t)}}`)};const rtt="_store",itt="_tuple",att="_modify",ott="vlSelectionResolve",stt={single:ntt,multi:ett,interval:Z9};function utt(t,e){const n=t.component.selection;if(n)for(const t of GQ(n)){if(!0===e(t,stt[t.type]))break}}function ctt(t,{escape:e}={escape:!0}){let n=e?Ee(t.name):t.name;const r=function(t){let e=t.parent;for(;e&&!Krt(e);)e=e.parent;return e}(t);if(r){const{facet:t}=r;for(const e of m1)t[e]&&(n+=` + '__facet_${e}_' + (facet[${Ee(r.vgField(e))}])`)}return n}function ltt(t){let e=!1;return utt(t,t=>{e=e||t.project.items.some(t=>"_vgsid_"===t.field)}),e}function dtt(t){this.type=t}var ftt,htt,ptt,mtt,gtt;dtt.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case"ArrayExpression":return t.elements;case"BinaryExpression":case"LogicalExpression":return[t.left,t.right];case"CallExpression":return[t.callee].concat(t.arguments);case"ConditionalExpression":return[t.test,t.consequent,t.alternate];case"MemberExpression":return[t.object,t.property];case"ObjectExpression":return t.properties;case"Property":return[t.key,t.value];case"UnaryExpression":return[t.argument];case"Identifier":case"Literal":case"RawCode":default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};(ftt={})[1]="Boolean",ftt[2]="<end>",ftt[3]="Identifier",ftt[4]="Keyword",ftt[5]="Null",ftt[6]="Numeric",ftt[7]="Punctuator",ftt[8]="String",ftt[9]="RegularExpression";var btt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),ytt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function vtt(t,e){if(!t)throw new Error("ASSERT: "+e)}function xtt(t){return t>=48&&t<=57}function wtt(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function ktt(t){return"01234567".indexOf(t)>=0}function Ott(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function _tt(t){return 10===t||13===t||8232===t||8233===t}function Att(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&btt.test(String.fromCharCode(t))}function Ctt(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&ytt.test(String.fromCharCode(t))}var Ett={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Stt(){for(var t;ptt<mtt&&(Ott(t=htt.charCodeAt(ptt))||_tt(t));)++ptt}function jtt(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)ptt<mtt&&wtt(htt[ptt])?(r=htt[ptt++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):Vtt({},"Unexpected token %0","ILLEGAL");return String.fromCharCode(i)}function Ntt(){var t,e,n,r;for(e=0,"}"===(t=htt[ptt])&&Vtt({},"Unexpected token %0","ILLEGAL");ptt<mtt&&wtt(t=htt[ptt++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&Vtt({},"Unexpected token %0","ILLEGAL"),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function Ttt(){var t,e;for(t=htt.charCodeAt(ptt++),e=String.fromCharCode(t),92===t&&(117!==htt.charCodeAt(ptt)&&Vtt({},"Unexpected token %0","ILLEGAL"),++ptt,(t=jtt("u"))&&"\\"!==t&&Att(t.charCodeAt(0))||Vtt({},"Unexpected token %0","ILLEGAL"),e=t);ptt<mtt&&Ctt(t=htt.charCodeAt(ptt));)++ptt,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==htt.charCodeAt(ptt)&&Vtt({},"Unexpected token %0","ILLEGAL"),++ptt,(t=jtt("u"))&&"\\"!==t&&Ctt(t.charCodeAt(0))||Vtt({},"Unexpected token %0","ILLEGAL"),e+=t);return e}function Ftt(){var t,e;return t=ptt,{type:1===(e=92===htt.charCodeAt(ptt)?Ttt():function(){var t,e;for(t=ptt++;ptt<mtt;){if(92===(e=htt.charCodeAt(ptt)))return ptt=t,Ttt();if(!Ctt(e))break;++ptt}return htt.slice(t,ptt)}()).length?3:Ett.hasOwnProperty(e)?4:"null"===e?5:"true"===e||"false"===e?1:3,value:e,start:t,end:ptt}}function Dtt(){var t,e,n,r,i=ptt,a=htt.charCodeAt(ptt),o=htt[ptt];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++ptt,{type:7,value:String.fromCharCode(a),start:i,end:ptt};default:if(61===(t=htt.charCodeAt(ptt+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return ptt+=2,{type:7,value:String.fromCharCode(a)+String.fromCharCode(t),start:i,end:ptt};case 33:case 61:return ptt+=2,61===htt.charCodeAt(ptt)&&++ptt,{type:7,value:htt.slice(i,ptt),start:i,end:ptt}}}return">>>="===(r=htt.substr(ptt,4))?{type:7,value:r,start:i,end:ptt+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:i,end:ptt+=3}:o===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===e?{type:7,value:e,start:i,end:ptt+=2}:"<>=!+-*%&|^/".indexOf(o)>=0?{type:7,value:o,start:i,end:++ptt}:void Vtt({},"Unexpected token %0","ILLEGAL")}function Itt(){var t,e,n;if(vtt(xtt((n=htt[ptt]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=ptt,t="","."!==n){if(t=htt[ptt++],n=htt[ptt],"0"===t){if("x"===n||"X"===n)return++ptt,function(t){for(var e="";ptt<mtt&&wtt(htt[ptt]);)e+=htt[ptt++];return 0===e.length&&Vtt({},"Unexpected token %0","ILLEGAL"),Att(htt.charCodeAt(ptt))&&Vtt({},"Unexpected token %0","ILLEGAL"),{type:6,value:parseInt("0x"+e,16),start:t,end:ptt}}(e);if(ktt(n))return function(t){for(var e="0"+htt[ptt++];ptt<mtt&&ktt(htt[ptt]);)e+=htt[ptt++];return(Att(htt.charCodeAt(ptt))||xtt(htt.charCodeAt(ptt)))&&Vtt({},"Unexpected token %0","ILLEGAL"),{type:6,value:parseInt(e,8),octal:!0,start:t,end:ptt}}(e);n&&xtt(n.charCodeAt(0))&&Vtt({},"Unexpected token %0","ILLEGAL")}for(;xtt(htt.charCodeAt(ptt));)t+=htt[ptt++];n=htt[ptt]}if("."===n){for(t+=htt[ptt++];xtt(htt.charCodeAt(ptt));)t+=htt[ptt++];n=htt[ptt]}if("e"===n||"E"===n)if(t+=htt[ptt++],"+"!==(n=htt[ptt])&&"-"!==n||(t+=htt[ptt++]),xtt(htt.charCodeAt(ptt)))for(;xtt(htt.charCodeAt(ptt));)t+=htt[ptt++];else Vtt({},"Unexpected token %0","ILLEGAL");return Att(htt.charCodeAt(ptt))&&Vtt({},"Unexpected token %0","ILLEGAL"),{type:6,value:parseFloat(t),start:e,end:ptt}}function Mtt(){var t,e,n,r;return gtt=null,Stt(),t=ptt,e=function(){var t,e,n,r;for(vtt("/"===(t=htt[ptt]),"Regular expression literal must start with a slash"),e=htt[ptt++],n=!1,r=!1;ptt<mtt;)if(e+=t=htt[ptt++],"\\"===t)_tt((t=htt[ptt++]).charCodeAt(0))&&Vtt({},"Invalid regular expression: missing /"),e+=t;else if(_tt(t.charCodeAt(0)))Vtt({},"Invalid regular expression: missing /");else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||Vtt({},"Invalid regular expression: missing /"),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";ptt<mtt&&Ctt((t=htt[ptt]).charCodeAt(0));)++ptt,"\\"===t&&ptt<mtt?Vtt({},"Unexpected token %0","ILLEGAL"):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&Vtt({},"Invalid regular expression",n),{value:n,literal:e}}(),r=function(t,e){var n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(t,e){if(parseInt(e,16)<=1114111)return"x";Vtt({},"Invalid regular expression")})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(t){Vtt({},"Invalid regular expression")}try{return new RegExp(t,e)}catch(t){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:ptt}}function $tt(){var t;return Stt(),ptt>=mtt?{type:2,start:ptt,end:ptt}:Att(t=htt.charCodeAt(ptt))?Ftt():40===t||41===t||59===t?Dtt():39===t||34===t?function(){var t,e,n,r,i="",a=!1;for(vtt("'"===(t=htt[ptt])||'"'===t,"String literal must starts with a quote"),e=ptt,++ptt;ptt<mtt;){if((n=htt[ptt++])===t){t="";break}if("\\"===n)if((n=htt[ptt++])&&_tt(n.charCodeAt(0)))"\r"===n&&"\n"===htt[ptt]&&++ptt;else switch(n){case"u":case"x":"{"===htt[ptt]?(++ptt,i+=Ntt()):i+=jtt(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:ktt(n)?(0!==(r="01234567".indexOf(n))&&(a=!0),ptt<mtt&&ktt(htt[ptt])&&(a=!0,r=8*r+"01234567".indexOf(htt[ptt++]),"0123".indexOf(n)>=0&&ptt<mtt&&ktt(htt[ptt])&&(r=8*r+"01234567".indexOf(htt[ptt++]))),i+=String.fromCharCode(r)):i+=n}else{if(_tt(n.charCodeAt(0)))break;i+=n}}return""!==t&&Vtt({},"Unexpected token %0","ILLEGAL"),{type:8,value:i,octal:a,start:e,end:ptt}}():46===t?xtt(htt.charCodeAt(ptt+1))?Itt():Dtt():xtt(t)?Itt():Dtt()}function Rtt(){var t;return ptt=(t=gtt).end,gtt=$tt(),ptt=t.end,t}function Btt(){var t;t=ptt,gtt=$tt(),ptt=t}function ztt(t,e,n){var r=new dtt("||"===t||"&&"===t?"LogicalExpression":"BinaryExpression");return r.operator=t,r.left=e,r.right=n,r}function Ltt(t,e){var n=new dtt("CallExpression");return n.callee=t,n.arguments=e,n}function Ptt(t){var e=new dtt("Identifier");return e.name=t,e}function qtt(t){var e=new dtt("Literal");return e.value=t.value,e.raw=htt.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function Wtt(t,e,n){var r=new dtt("MemberExpression");return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function Utt(t,e,n){var r=new dtt("Property");return r.key=e,r.value=n,r.kind=t,r}function Vtt(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,(function(t,e){return vtt(e<r.length,"Message reference must be in range"),r[e]}));throw(n=new Error(i)).index=ptt,n.description=i,n}function Gtt(t){2===t.type&&Vtt(t,"Unexpected end of input"),6===t.type&&Vtt(t,"Unexpected number"),8===t.type&&Vtt(t,"Unexpected string"),3===t.type&&Vtt(t,"Unexpected identifier"),4===t.type&&Vtt(t,"Unexpected reserved word"),Vtt(t,"Unexpected token %0",t.value)}function Htt(t){var e=Rtt();7===e.type&&e.value===t||Gtt(e)}function Xtt(t){return 7===gtt.type&&gtt.value===t}function Ktt(t){return 4===gtt.type&&gtt.value===t}function Ytt(){var t=[];for(ptt=gtt.start,Htt("[");!Xtt("]");)Xtt(",")?(Rtt(),t.push(null)):(t.push(uet()),Xtt("]")||Htt(","));return Rtt(),function(t){var e=new dtt("ArrayExpression");return e.elements=t,e}(t)}function Jtt(){var t;return ptt=gtt.start,8===(t=Rtt()).type||6===t.type?(t.octal&&Vtt(t,"Octal literals are not allowed in strict mode."),qtt(t)):Ptt(t.value)}function Ztt(){var t,e,n;return ptt=gtt.start,3===(t=gtt).type?(n=Jtt(),Htt(":"),Utt("init",n,uet())):2!==t.type&&7!==t.type?(e=Jtt(),Htt(":"),Utt("init",e,uet())):void Gtt(t)}function Qtt(){var t,e,n=[],r={},i=String;for(ptt=gtt.start,Htt("{");!Xtt("}");)e="$"+("Identifier"===(t=Ztt()).key.type?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?Vtt({},"Duplicate data property in object literal not allowed in strict mode"):r[e]=!0,n.push(t),Xtt("}")||Htt(",");return Htt("}"),function(t){var e=new dtt("ObjectExpression");return e.properties=t,e}(n)}var tet={if:1};function eet(){var t,e,n;if(Xtt("("))return function(){var t;return Htt("("),t=cet(),Htt(")"),t}();if(Xtt("["))return Ytt();if(Xtt("{"))return Qtt();if(t=gtt.type,ptt=gtt.start,3===t||tet[gtt.value])n=Ptt(Rtt().value);else if(8===t||6===t)gtt.octal&&Vtt(gtt,"Octal literals are not allowed in strict mode."),n=qtt(Rtt());else{if(4===t)throw new Error("Disabled.");1===t?((e=Rtt()).value="true"===e.value,n=qtt(e)):5===t?((e=Rtt()).value=null,n=qtt(e)):Xtt("/")||Xtt("/=")?(n=qtt(Mtt()),Btt()):Gtt(Rtt())}return n}function net(){var t=[];if(Htt("("),!Xtt(")"))for(;ptt<mtt&&(t.push(uet()),!Xtt(")"));)Htt(",");return Htt(")"),t}function ret(){return Htt("."),ptt=gtt.start,function(t){return 3===t.type||4===t.type||1===t.type||5===t.type}(t=Rtt())||Gtt(t),Ptt(t.value);var t}function iet(){var t;return Htt("["),t=cet(),Htt("]"),t}function aet(){var t=function(){var t;for(t=eet();;)if(Xtt("."))t=Wtt(".",t,ret());else if(Xtt("("))t=Ltt(t,net());else{if(!Xtt("["))break;t=Wtt("[",t,iet())}return t}();if(7===gtt.type&&(Xtt("++")||Xtt("--")))throw new Error("Disabled.");return t}function oet(){var t,e,n,r,i;if(7!==gtt.type&&4!==gtt.type)e=aet();else{if(Xtt("++")||Xtt("--"))throw new Error("Disabled.");if(Xtt("+")||Xtt("-")||Xtt("~")||Xtt("!"))t=Rtt(),e=oet(),n=t.value,r=e,(i=new dtt("UnaryExpression")).operator=n,i.argument=r,i.prefix=!0,e=i;else{if(Ktt("delete")||Ktt("void")||Ktt("typeof"))throw new Error("Disabled.");e=aet()}}return e}function set(t){var e=0;if(7!==t.type&&4!==t.type)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function uet(){var t,e;return t=function(){var t,e,n,r,i,a,o,s,u,c;if(t=gtt,u=oet(),0===(i=set(r=gtt)))return u;for(r.prec=i,Rtt(),e=[t,gtt],a=[u,r,o=oet()];(i=set(gtt))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,u=a.pop(),e.pop(),n=ztt(s,u,o),a.push(n);(r=Rtt()).prec=i,a.push(r),e.push(gtt),n=oet(),a.push(n)}for(n=a[c=a.length-1],e.pop();c>1;)e.pop(),n=ztt(a[c-1].value,a[c-2],n),c-=2;return n}(),Xtt("?")&&(Rtt(),e=uet(),Htt(":"),t=function(t,e,n){var r=new dtt("ConditionalExpression");return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,uet())),t}function cet(){var t=uet();if(Xtt(","))throw new Error("Disabled.");return t}function det(t,e,n){return t.fields=e||[],t.fname=n,t}function fet(t){return 1===t.length?het(t[0]):pet(t)}const het=t=>function(e){return e[t]},pet=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function met(t){throw Error(t)}function get(t){const e=[],n=t.length;let r,i,a,o=null,s=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(a===o)c(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&c(),s=r=i+1):"]"===a&&(s||met("Access path missing open bracket: "+t),s>0&&c(),s=0,r=i+1):i>r?c():r=i+1}return s&&met("Access path missing closing bracket: "+t),o&&met("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function bet(t,e,n){const r=get(t);return t=1===r.length?r[0]:t,det((n&&n.get||fet)(r),[t],e||t)}bet("id"),det(t=>t,[],"identity"),det(()=>0,[],"zero"),det(()=>1,[],"one"),det(()=>!0,[],"true"),det(()=>!1,[],"false");Array.isArray;Object.prototype.hasOwnProperty;function yet(t){const e=function(t){ptt=0,mtt=(htt=t).length,gtt=null,Btt();var e=cet();if(2!==gtt.type)throw new Error("Unexpect token after expression.");return e}(t),n=new Set;return e.visit(t=>{"MemberExpression"===t.type&&function t(e){return"MemberExpression"===e.object.type?t(e.object):"datum"===e.object.name}(t)&&n.add(function t(e){const n=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(n.push(...t(e.object)),n.push(...t(e.property))),n)}(t).slice(1).join("."))}),n}class vet extends N9{constructor(t,e,n){super(t),this.model=e,this.filter=n,this.expr=ket(this.model,this.filter,this),this._dependentFields=yet(this.expr)}clone(){return new vet(null,this.model,NQ(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return"Filter "+this.expr}}function xet(t,e,n,r="datum"){const i=[];const a=YQ(e,(function(e){const a=KQ(e),o=t.getSelectionComponent(a,e),s=Ee(a+rtt);if(o.project.timeUnit){const e=null!=n?n:t.component.data.raw,r=o.project.timeUnit.clone();e.parent?r.insertAsParentOf(e):e.parent=r}return"none"!==o.empty&&i.push(s),`vlSelectionTest(${s}, ${r}`+("global"===o.resolve?")":`, ${Ee(o.resolve)})`)}));return(i.length?"!("+i.map(t=>`length(data(${t}))`).join(" || ")+") || ":"")+`(${a})`}function wet(t,e){const n=e.encoding;let r=e.field;if(n||r){if(n&&!r){const i=t.project.items.filter(t=>t.channel===n);!i.length||i.length>1?(r=t.project.items[0].field,V3((i.length?"Multiple ":"No ")+`matching ${Ee(n)} encoding found for selection ${Ee(e.selection)}. `+`Using "field": ${Ee(r)}.`)):r=i[0].field}}else r=t.project.items[0].field,t.project.items.length>1&&V3(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${Ee(r)}.`);return`${t.name}[${Ee(r)}]`}function ket(t,e,n){return YQ(e,e=>ve(e)?e:function(t){return null==t?void 0:t.selection}(e)?xet(t,e.selection,n):O4(e))}function Oet(t,e,n,r){var i,a,o;t.encode=null!==(i=t.encode)&&void 0!==i?i:{},t.encode[e]=null!==(a=t.encode[e])&&void 0!==a?a:{},t.encode[e].update=null!==(o=t.encode[e].update)&&void 0!==o?o:{},t.encode[e].update[n]=r}function _et(t,e,n,r={header:!1}){var i,a;const o=t.combine(),{disable:s,orient:u,scale:c,labelExpr:l,title:d,zindex:f}=o,h=w(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const t in h){const n=h0[t],r=h[t];if(n&&n!==e&&"both"!==n)delete h[t];else if(d0(r)){const{condition:e}=r,n=w(r,["condition"]),i=Kt(e),a=l0[t];if(a){const{vgProp:e,part:r}=a;Oet(h,r,e,[...i.map(t=>{const{test:e}=t,n=w(t,["test"]);return Object.assign({test:ket(null,e)},n)}),n]),delete h[t]}else if(null===a){const e={signal:i.map(t=>{const{test:e}=t,n=w(t,["test"]);return`${ket(null,e)} ? ${R5(n)} : `}).join("")+R5(n)};h[t]=e}}else if(u4(r)){const e=l0[t];if(e){const{vgProp:n,part:i}=e;Oet(h,i,n,r),delete h[t]}}}if("grid"===e){if(!h.grid)return;if(h.encode){const{grid:t}=h.encode;h.encode=Object.assign({},t?{grid:t}:{}),UQ(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:c,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:a0(f,0)})}{if(!r.header&&t.mainExtracted)return;if(void 0!==l){let t=l;(null===(a=null===(i=h.encode)||void 0===i?void 0:i.labels)||void 0===a?void 0:a.update)&&u4(h.encode.labels.update.text)&&(t=n0(l,"datum.label",h.encode.labels.update.text.signal)),Oet(h,"labels","text",{signal:t})}if(null===h.labelAlign&&delete h.labelAlign,h.encode){for(const e of f0)t.hasAxisPart(e)||delete h.encode[e];UQ(h.encode)&&delete h.encode}const e=function(t,e){if(t)return _t(t)&&!M5(t)?t.map(t=>w5(t,e)).join(", "):t}(d,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:c,orient:u,grid:!1},e?{title:e}:{}),h),!1===n.aria?{aria:!1}:{}),{zindex:a0(f,0)})}}}function Aet(t){const{axes:e}=t.component,n=[];for(const r of X1)if(e[r])for(const i of e[r])if(!i.get("disable")&&!i.get("gridScale")){const e="x"===r?"height":"width",i=t.getSizeSignalRef(e).signal;e!==i&&n.push({name:e,update:i})}return n}const Cet={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},Eet={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},jet=VQ(Cet),Net=VQ(Eet);function Tet(t,e,n,r){return Object.assign.apply(null,[{},...t.map(t=>{if("axisOrient"===t){const t="x"===n?"bottom":"left",i=e["x"===n?"axisBottom":"axisLeft"]||{},a=e["x"===n?"axisTop":"axisRight"]||{},o=new Set([...VQ(i),...VQ(a)]),s={};for(const e of o.values())s[e]={signal:`${r.signal} === "${t}" ? ${B5(i[e])} : ${B5(a[e])}`};return s}return e[t]})])}function Fet(t,e,n,r){const i="band"===e?["axisDiscrete","axisBand"]:"point"===e?["axisDiscrete","axisPoint"]:e in Z4?["axisQuantitative"]:"time"===e||"utc"===e?["axisTemporal"]:[];const a="x"===t?"axisX":"axisY",o=u4(n)?"axisOrient":"axis"+ZQ(n),s=[...i,...i.map(t=>a+t.substr(4))],u=["axis",o,a];return{vlOnlyAxisConfig:Tet(s,r,t,n),vgAxisConfig:Tet(u,r,t,n),axisConfigStyle:Det([...u,...s],r)}}function Det(t,e){var n;const r=[{}];for(const i of t){let t=null===(n=e[i])||void 0===n?void 0:n.style;if(t){t=Kt(t);for(const n of t)r.push(e.style[n])}}return Object.assign.apply(null,r)}function Iet(t,e,n,r={}){var i;const a=W5(t,n,e.style);if(void 0!==a)return{configFrom:"style",configValue:a};for(const e of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==(null===(i=r[e])||void 0===i?void 0:i[t]))return{configFrom:e,configValue:r[e][t]};return{}}const Met={scale:({model:t,channel:e})=>t.scaleName(e),format:({fieldOrDatumDef:t,config:e,axis:n})=>{const{format:r,formatType:i}=n;return D6(t,t.type,r,i,e,!0)},formatType:({axis:t,fieldOrDatumDef:e,scaleType:n})=>{const{formatType:r}=t;return I6(r,e,n)},grid:({fieldOrDatumDef:t,axis:e,scaleType:n})=>{var r;return(!e5(t)||!v2(t.bin))&&(null!==(r=e.grid)&&void 0!==r?r:function(t,e){return!r6(t)&&e5(e)&&!y2(null==e?void 0:e.bin)}(n,t))},gridScale:({model:t,channel:e})=>function(t,e){const n="x"===e?"y":"x";if(t.getScaleComponent(n))return t.scaleName(n);return}(t,e),labelAlign:({axis:t,labelAngle:e,orient:n,channel:r})=>t.labelAlign||Bet(e,n,r),labelAngle:({labelAngle:t})=>t,labelBaseline:({axis:t,labelAngle:e,orient:n,channel:r})=>t.labelBaseline||Ret(e,n,r),labelFlush:({axis:t,fieldOrDatumDef:e,channel:n})=>{var r;return null!==(r=t.labelFlush)&&void 0!==r?r:function(t,e){if("x"===e&&$Q(["quantitative","temporal"],t))return!0;return}(e.type,n)},labelOverlap:({axis:t,fieldOrDatumDef:e,scaleType:n})=>{var r;return null!==(r=t.labelOverlap)&&void 0!==r?r:function(t,e){if("nominal"!==t)return"log"!==e||"greedy";return}(e.type,n)},orient:({orient:t})=>t,tickCount:({channel:t,model:e,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var a;const o="x"===t?"width":"y"===t?"height":void 0,s=o?e.getSizeSignalRef(o):void 0;return null!==(a=n.tickCount)&&void 0!==a?a:function({fieldOrDatumDef:t,scaleType:e,size:n,values:r}){var i;if(!r&&!r6(e)&&"log"!==e){if(e5(t)){if(y2(t.bin))return{signal:`ceil(${n.signal}/10)`};if(t.timeUnit&&$Q(["month","hours","day","quarter"],null===(i=s4(t.timeUnit))||void 0===i?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}return}({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},title:({axis:t,model:e,channel:n})=>{if(void 0!==t.title)return t.title;const r=zet(e,n);if(void 0!==r)return r;const i=e.typedFieldDef(n),a="x"===n?"x2":"y2",o=e.fieldDef(a);return V5(i?[X6(i)]:[],e5(o)?[X6(o)]:[])},values:({axis:t,fieldOrDatumDef:e})=>function(t,e){const n=t.values;if(_t(n))return F5(e,n);if(u4(n))return n;return}(t,e),zindex:({axis:t,fieldOrDatumDef:e,mark:n})=>{var r;return null!==(r=t.zindex)&&void 0!==r?r:function(t,e){if("rect"===t&&p5(e))return 1;return 0}(n,e)}};function $et(t){return`(((${t.signal} % 360) + 360) % 360)`}function Ret(t,e,n,r){if(void 0!==t){if("x"===n){if(u4(t)){const n=$et(t);return{signal:`(45 < ${n} && ${n} < 135) || (225 < ${n} && ${n} < 315) ? "middle" :(${n} <= 45 || 315 <= ${n}) === ${u4(e)?`(${e.signal} === "top")`:"top"===e} ? "bottom" : "top"`}}if(45<t&&t<135||225<t&&t<315)return"middle";if(u4(e)){const n=t<=45||315<=t?"===":"!==";return{signal:`${e.signal} ${n} "top" ? "bottom" : "top"`}}return(t<=45||315<=t)==("top"===e)?"bottom":"top"}if(u4(t)){const n=$et(t);return{signal:`${n} <= 45 || 315 <= ${n} || (135 <= ${n} && ${n} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${n} && ${n} <= 135) === ${u4(e)?`(${e.signal} === "left")`:"left"===e} ? "top" : "bottom"`}}if(t<=45||315<=t||135<=t&&t<=225)return r?"middle":null;if(u4(e)){const n=45<=t&&t<=135?"===":"!==";return{signal:`${e.signal} ${n} "left" ? "top" : "bottom"`}}return(45<=t&&t<=135)==("left"===e)?"top":"bottom"}}function Bet(t,e,n){if(void 0===t)return;const r="x"===n,i=r?0:90,a=r?"bottom":"left";if(u4(t)){const n=$et(t);return{signal:`(${i?"("+n+" + 90)":n} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${n} && ${n} < ${180+i}) === ${u4(e)?`(${e.signal} === "${a}")`:e===a} ? "left" : "right"`}}if((t+i)%180==0)return r?null:"center";if(u4(e)){const n=i<t&&t<180+i?"===":"!==";return{signal:`${e.signal} ${n} "${a}"`+' ? "left" : "right"'}}return(i<t&&t<180+i)==(e===a)?"left":"right"}function zet(t,e){const n="x"===e?"x2":"y2",r=t.fieldDef(e),i=t.fieldDef(n),a=r?r.title:void 0,o=i?i.title:void 0;return a&&o?G5(a,o):a||(o||(void 0!==a?a:void 0!==o?o:void 0))}class Let extends N9{constructor(t,e){super(t),this.transform=e,this._dependentFields=yet(this.transform.calculate)}clone(){return new Let(null,NQ(this.transform))}static parseAllForSortIndex(t,e){return e.forEachFieldDef((e,n)=>{if(c5(e)&&U6(e.sort)){const{field:r,timeUnit:i}=e,a=e.sort,o=a.map((t,e)=>`${O4({field:r,timeUnit:i,equal:t})} ? ${e} : `).join("")+a.length;t=new Let(t,{calculate:o,as:Pet(e,n,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return"Calculate "+IQ(this.transform)}}function Pet(t,e,n){return h5(t,Object.assign({prefix:e,suffix:"sort_index"},null!=n?n:{}))}function qet(t,e){return $Q(["top","bottom"],e)?"column":$Q(["left","right"],e)||"row"===t?"row":"column"}function Wet(t,e,n,r){const i="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return a0(((null==e?void 0:e.header)||{})[t],i[t],n.header[t])}function Uet(t,e,n,r){const i={};for(const a of t){const t=Wet(a,e,n,r);void 0!==t&&(i[a]=t)}return i}const Vet=["row","column"],Get=["header","footer"];function Het(t,e){const n=t.component.layoutHeaders[e].title,r=t.config?t.config:void 0,i=t.component.layoutHeaders[e].facetFieldDef?t.component.layoutHeaders[e].facetFieldDef:void 0,{titleAnchor:a,titleAngle:o,titleOrient:s}=Uet(["titleAnchor","titleAngle","titleOrient"],i,r,e),u=qet(e,s),c=u0(o);return{name:e+"-title",type:"group",role:u+"-title",title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===e?{orient:"left"}:{}),{style:"guide-title"}),Ket(c,u)),Xet(u,c,a)),nnt(r,i,e,jet,Cet))}}function Xet(t,e,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=Bet(e,"row"===t?"left":"top","row"===t?"y":"x");return r?{align:r}:{}}function Ket(t,e){const n=Ret(t,"row"===e?"left":"top","row"===e?"y":"x",!0);return n?{baseline:n}:{}}function Yet(t,e){const n=t.component.layoutHeaders[e],r=[];for(const i of Get)if(n[i])for(const a of n[i]){const o=Qet(t,e,i,n,a);null!=o&&r.push(o)}return r}function Jet(t,e){var n;const{sort:r}=t;return W6(r)?{field:h5(r,{expr:"datum"}),order:null!==(n=r.order)&&void 0!==n?n:"ascending"}:_t(r)?{field:Pet(t,e,{expr:"datum"}),order:"ascending"}:{field:h5(t,{expr:"datum"}),order:null!=r?r:"ascending"}}function Zet(t,e,n){const{format:r,formatType:i,labelAngle:a,labelAnchor:o,labelOrient:s,labelExpr:u}=Uet(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],t,n,e),c=N6({fieldOrDatumDef:t,format:r,formatType:i,expr:"parent",config:n}).signal,l=qet(e,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?n0(n0(u,"datum.label",c),"datum.value",h5(t,{expr:"parent"})):c}},"row"===e?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),Ket(a,l)),Xet(l,a,o)),nnt(n,t,e,Net,Eet))}function Qet(t,e,n,r,i){if(i){let a=null;const{facetFieldDef:o}=r,s=t.config?t.config:void 0;if(o&&i.labels){const{labelOrient:t}=Uet(["labelOrient"],o,s,e);("row"===e&&!$Q(["top","bottom"],t)||"column"===e&&!$Q(["left","right"],t))&&(a=Zet(o,e,s))}const u=Krt(t)&&!V6(t.facet),c=i.axes,l=(null==c?void 0:c.length)>0;if(a||l){const s="row"===e?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:t.getName(`${e}_${n}`),type:"group",role:`${e}-${n}`},r.facetFieldDef?{from:{data:t.getName(e+"_domain")},sort:Jet(o,e)}:{}),l&&u?{from:{data:t.getName("facet_domain_"+e)}}:{}),a?{title:a}:{}),i.sizeSignal?{encode:{update:{[s]:i.sizeSignal}}}:{}),l?{axes:c}:{})}}return null}const tnt={column:{start:0,end:1},row:{start:1,end:0}};function ent(t,e){return tnt[e][t]}function nnt(t,e,n,r,i){const a={};for(const o of r){if(!i[o])continue;const r=Wet(o,e,t,n);void 0!==r&&(a[i[o]]=r)}return a}function rnt(t){return[...int(t,"width"),...int(t,"height"),...int(t,"childWidth"),...int(t,"childHeight")]}function int(t,e){const n="width"===e?"x":"y",r=t.component.layoutSize.get(e);if(!r||"merged"===r)return[];const i=t.getSizeSignalRef(e).signal;if("step"===r){const e=t.getScaleComponent(n);if(e){const r=e.get("type"),a=e.get("range");if(r6(r)&&c4(a)){const r=t.scaleName(n);if(Krt(t.parent)){if("independent"===t.parent.component.resolve.scale[n])return[ant(r,a)]}return[ant(r,a),{name:i,update:ont(r,e,`domain('${r}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){const e=i.endsWith("width"),n=e?"containerSize()[0]":"containerSize()[1]",r=`isFinite(${n}) ? ${n} : ${M8(t.config.view,e?"width":"height")}`;return[{name:i,init:r,on:[{update:r,events:"window:resize"}]}]}return[{name:i,value:r}]}function ant(t,e){return{name:t+"_step",value:e.step}}function ont(t,e,n){const r=e.get("type"),i=e.get("padding"),a=a0(e.get("paddingOuter"),i);let o=e.get("paddingInner");return o="band"===r?void 0!==o?o:i:1,`bandspace(${n}, ${o}, ${a}) * ${t}_step`}function snt(t){return"childWidth"===t?"width":"childHeight"===t?"height":t}function unt(t,e){return VQ(t).reduce((n,r)=>{const i=t[r];return Object.assign(Object.assign({},n),n9(e,i,r,t=>u4(t)?t:{value:t.value}))},{})}function cnt(t,e){if(Jrt(e)||Krt(e))return"shared";if(Yrt(e))return K1(t)?"independent":"shared";throw new Error("invalid model type for resolve")}function lnt(t,e){const n=t.scale[e],r=K1(e)?"axis":"legend";return"independent"===n?("shared"===t[r][e]&&V3(y.independentScaleMeansIndependentGuide(e)),"independent"):t[r][e]||"shared"}const dnt=Object.assign(Object.assign({},A8),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),fnt=VQ(dnt);class hnt extends O7{}const pnt={symbols:function(t,{fieldOrDatumDef:e,model:n,channel:r,legendCmpt:i,legendType:a}){var o,s,u,c,l;if("symbol"!==a)return;const{markDef:d,encoding:f,config:h,mark:p}=n,m=d.filled&&"trail"!==p;let g=Object.assign(Object.assign({},function(t,e,n){for(const r of n){const n=P5(r,e.markDef,e.config);void 0!==n&&(t[r]=$5(n))}return t}({},n,$0)),l9(n,{filled:m}));const b=null!==(o=mnt(f.opacity))&&void 0!==o?o:d.opacity;if(g.fill)if("fill"===r||m&&r===r1)delete g.fill;else if(g.fill.field)i.get("symbolFillColor")?delete g.fill:(g.fill=$5(null!==(s=h.legend.symbolBaseFillColor)&&void 0!==s?s:"black"),g.fillOpacity=$5(null!=b?b:1));else if(_t(g.fill)){const t=null!==(l=null!==(c=gnt(null!==(u=f.fill)&&void 0!==u?u:f.color))&&void 0!==c?c:d.fill)&&void 0!==l?l:m&&d.color;t&&(g.fill=$5(t))}if(g.stroke)if("stroke"===r||!m&&r===r1)delete g.stroke;else if(g.stroke.field)delete g.stroke;else if(_t(g.stroke)){const t=a0(gnt(f.stroke||f.color),d.stroke,m?d.color:void 0);t&&(g.stroke={value:t})}if("opacity"!==r){const t=e5(e)&&ynt(n,i,e);t?g.opacity=[Object.assign({test:t},$5(null!=b?b:1)),$5(h.legend.unselectedOpacity)]:b&&(g.opacity=$5(b))}return g=Object.assign(Object.assign({},g),t),UQ(g)?void 0:g},gradient:function(t,{model:e,legendType:n}){if("gradient"!==n)return;let r={};const i=mnt(e.encoding.opacity)||e.markDef.opacity;i&&(r.opacity=$5(i));return r=Object.assign(Object.assign({},r),t),UQ(r)?void 0:r},labels:function(t,{fieldOrDatumDef:e,model:n,channel:r,legendCmpt:i}){const a=n.legend(r)||{},o=n.config,s=e5(e)?ynt(n,i,e):void 0,u=s?[{test:s,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:c,formatType:l}=a,d=S6(l)?F6({fieldOrDatumDef:e,field:"datum.value",format:c,formatType:l,config:o}):void 0,f=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),d?{text:d}:{}),t);return UQ(f)?void 0:f},entries:function(t,{legendCmpt:e}){const n=e.get("selections");return(null==n?void 0:n.length)?Object.assign(Object.assign({},t),{fill:{value:"transparent"}}):t}};function mnt(t){return bnt(t,(t,e)=>Math.max(t,e.value))}function gnt(t){return bnt(t,(t,e)=>a0(t,e.value))}function bnt(t,e){return function(t){const e=t&&t.condition;return!!e&&(_t(e)||u5(e))}(t)?Kt(t.condition).reduce(e,t.value):u5(t)?t.value:void 0}function ynt(t,e,n){const r=e.get("selections");if(!(null==r?void 0:r.length))return;const i=Ee(n.field);return r.map(t=>`(!length(data(${Ee(KQ(t)+rtt)})) || (${t}[${i}] && indexof(${t}[${i}], datum.value) >= 0))`).join(" || ")}const vnt={direction:({direction:t})=>t,format:({fieldOrDatumDef:t,legend:e,config:n})=>{const{format:r,formatType:i}=e;return D6(t,t.type,r,i,n,!1)},formatType:({legend:t,fieldOrDatumDef:e,scaleType:n})=>{const{formatType:r}=t;return I6(r,e,n)},gradientLength:t=>{var e,n;const{legend:r,legendConfig:i}=t;return null!==(n=null!==(e=r.gradientLength)&&void 0!==e?e:i.gradientLength)&&void 0!==n?n:function({legendConfig:t,model:e,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:a,gradientHorizontalMinLength:o,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=t;if(a6(i))return"horizontal"===n?"top"===r||"bottom"===r?knt(e,"width",o,a):o:knt(e,"height",u,s);return}(t)},labelOverlap:({legend:t,legendConfig:e,scaleType:n})=>{var r,i;return null!==(i=null!==(r=t.labelOverlap)&&void 0!==r?r:e.labelOverlap)&&void 0!==i?i:function(t){if($Q(["quantile","threshold","log"],t))return"greedy";return}(n)},symbolType:({legend:t,markDef:e,channel:n,encoding:r})=>{var i;return null!==(i=t.symbolType)&&void 0!==i?i:function(t,e,n,r){var i;if("shape"!==e){const t=null!==(i=gnt(n))&&void 0!==i?i:r;if(t)return t}switch(t){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(e.type,n,r.shape,e.shape)},title:({fieldOrDatumDef:t,config:e})=>v5(t,e,{allowDisabling:!0}),type:({legendType:t,scaleType:e,channel:n})=>{if(h1(n)&&a6(e)){if("gradient"===t)return}else if("symbol"===t)return;return t},values:({fieldOrDatumDef:t,legend:e})=>function(t,e){const n=t.values;if(_t(n))return F5(e,n);if(u4(n))return n;return}(e,t)};function xnt(t){const{legend:e}=t;return a0(e.type,function({channel:t,timeUnit:e,scaleType:n}){if(h1(t)){if($Q(["quarter","month","day"],e))return"symbol";if(a6(n))return"gradient"}return"symbol"}(t))}function wnt({legendConfig:t,legendType:e,orient:n,legend:r}){var i,a;return null!==(a=null!==(i=r.direction)&&void 0!==i?i:t[e?"gradientDirection":"symbolDirection"])&&void 0!==a?a:function(t,e){switch(t){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===e?"horizontal":void 0}}(n,e)}function knt(t,e,n,r){return{signal:`clamp(${t.getSizeSignalRef(e).signal}, ${n}, ${r})`}}function Ont(t){const e=Xrt(t)?function(t){const{encoding:e}=t,n={};for(const r of[r1,...O8]){const i=_5(e[r]);i&&t.getScaleComponent(r)&&(r===o1&&e5(i)&&i.type===T4||(n[r]=Ant(t,r)))}return n}(t):function(t){const{legends:e,resolve:n}=t.component;for(const r of t.children){Ont(r);for(const i of VQ(r.component.legends))n.legend[i]=lnt(t.component.resolve,i),"shared"===n.legend[i]&&(e[i]=Cnt(e[i],r.component.legends[i]),e[i]||(n.legend[i]="independent",delete e[i]))}for(const r of VQ(e))for(const e of t.children)e.component.legends[r]&&"shared"===n.legend[r]&&delete e.component.legends[r];return e}(t);return t.component.legends=e,e}function _nt(t,e,n,r){switch(e){case"disable":return void 0!==n;case"values":return!!(null==n?void 0:n.values);case"title":if("title"===e&&t===(null==r?void 0:r.title))return!0}return t===(n||{})[e]}function Ant(t,e){var n,r,i;let a=t.legend(e);const{markDef:o,encoding:s,config:u}=t,c=u.legend,l=new hnt({},function(t,e){const n=t.scaleName(e);if("trail"===t.mark){if("color"===e)return{stroke:n};if("size"===e)return{strokeWidth:n}}return"color"===e?t.markDef.filled?{fill:n}:{stroke:n}:{[e]:n}}(t,e));!function(t,e,n){var r;const i=null===(r=t.fieldDef(e))||void 0===r?void 0:r.field;utt(t,t=>{var r,a;const o=null!==(r=t.project.hasField[i])&&void 0!==r?r:t.project.hasChannel[e];if(o&&L9.has(t)){const e=null!==(a=n.get("selections"))&&void 0!==a?a:[];e.push(t.name),n.set("selections",e,!1),o.hasLegend=!0}})}(t,e,l);const d=void 0!==a?!a:c.disable;if(l.set("disable",d,void 0!==a),d)return l;a=a||{};const f=t.getScaleComponent(e).get("type"),h=_5(s[e]),p=e5(h)?null===(n=s4(h.timeUnit))||void 0===n?void 0:n.unit:void 0,m=a.orient||u.legend.orient||"right",g=xnt({legend:a,channel:e,timeUnit:p,scaleType:f}),b={legend:a,channel:e,model:t,markDef:o,encoding:s,fieldOrDatumDef:h,legendConfig:c,config:u,scaleType:f,orient:m,legendType:g,direction:wnt({legend:a,legendType:g,orient:m,legendConfig:c})};for(const n of fnt){const r=n in vnt?vnt[n](b):a[n];if(void 0!==r){const i=_nt(r,n,a,t.fieldDef(e));(i||void 0===u.legend[n])&&l.set(n,r,i)}}const y=null!==(r=null==a?void 0:a.encoding)&&void 0!==r?r:{},v=l.get("selections"),x={},w={fieldOrDatumDef:h,model:t,channel:e,legendCmpt:l,legendType:g};for(const e of["labels","legend","title","symbols","gradient","entries"]){const n=unt(null!==(i=y[e])&&void 0!==i?i:{},t),r=e in pnt?pnt[e](n,w):n;void 0===r||UQ(r)||(x[e]=Object.assign(Object.assign(Object.assign({},(null==v?void 0:v.length)&&e5(h)?{name:`${KQ(h.field)}_legend_${e}`}:{}),(null==v?void 0:v.length)?{interactive:!!v}:{}),{update:r}))}return UQ(x)||l.set("encode",x,!!(null==a?void 0:a.encoding)),l}function Cnt(t,e){var n,r,i,a;if(!t)return e.clone();const o=t.getWithExplicit("orient"),s=e.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return;let u=!1;for(const n of fnt){const r=S7(t.getWithExplicit(n),e.getWithExplicit(n),n,"legend",(t,e)=>{switch(n){case"symbolType":return Ent(t,e);case"title":return H5(t,e);case"type":return u=!0,A7("symbol")}return E7(t,e,n,"legend")});t.setWithExplicit(n,r)}return u&&((null===(r=null===(n=t.implicit)||void 0===n?void 0:n.encode)||void 0===r?void 0:r.gradient)&&JQ(t.implicit,["encode","gradient"]),(null===(a=null===(i=t.explicit)||void 0===i?void 0:i.encode)||void 0===a?void 0:a.gradient)&&JQ(t.explicit,["encode","gradient"])),t}function Ent(t,e){return"circle"===e.value?e:t}function Snt(t,e,n,r){var i,a,o;t.encode=null!==(i=t.encode)&&void 0!==i?i:{},t.encode[e]=null!==(a=t.encode[e])&&void 0!==a?a:{},t.encode[e].update=null!==(o=t.encode[e].update)&&void 0!==o?o:{},t.encode[e].update[n]=r}function jnt(t){const e=t.component.legends,n={};for(const r of VQ(e)){const i=t.getScaleComponent(r),a=DQ(i.get("domains"));if(n[a])for(const t of n[a]){Cnt(t,e[r])||n[a].push(e[r])}else n[a]=[e[r].clone()]}return GQ(n).flat().map(e=>function(t,e){var n,r,i;const a=t.combine(),{disable:o,labelExpr:s,selections:u}=a,c=w(a,["disable","labelExpr","selections"]);if(o)return;!1===e.aria&&null==c.aria&&(c.aria=!1);if(null===(n=c.encode)||void 0===n?void 0:n.symbols){const t=c.encode.symbols.update;!t.fill||"transparent"===t.fill.value||t.stroke||c.stroke||(t.stroke={value:"transparent"});for(const e of O8)c[e]&&delete t[e]}c.title||delete c.title;if(void 0!==s){let t=s;(null===(i=null===(r=c.encode)||void 0===r?void 0:r.labels)||void 0===i?void 0:i.update)&&u4(c.encode.labels.update.text)&&(t=n0(s,"datum.label",c.encode.labels.update.text.signal)),Snt(c,"labels","text",{signal:t})}for(const t in c){const e=c[t];if(u4(e)){const n=_8[t];if(n){const{vgProp:r,part:i}=n;Snt(c,i,r,e),delete c[t]}}}return c}(e,t.config)).filter(t=>void 0!==t)}function Nnt(t){return Jrt(t)||Yrt(t)?function(t){return t.children.reduce((t,e)=>t.concat(e.assembleProjections()),Tnt(t))}(t):Tnt(t)}function Tnt(t){const e=t.component.projection;if(!e||e.merged)return[];const n=e.combine(),{name:r}=n;if(e.data){const i={signal:`[${e.size.map(t=>t.signal).join(", ")}]`},a=e.data.reduce((e,n)=>{const r=u4(n)?n.signal:`data('${t.lookupDataSource(n)}')`;return $Q(e,r)||e.push(r),e},[]);if(a.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:a.length>1?`[${a.join(", ")}]`:a[0]}},n)]}return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const Fnt=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class Dnt extends O7{constructor(t,e,n,r){super(Object.assign({},e),{name:t}),this.specifiedProjection=e,this.size=n,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function Int(t){t.component.projection=Xrt(t)?function(t){var e;if(t.hasProjection){const n=t.specifiedProjection,r=!(n&&(null!=n.scale||null!=n.translate)),i=r?[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]:void 0,a=r?function(t){const e=[],{encoding:n}=t;for(const r of[["longitude","latitude"],["longitude2","latitude2"]])(_5(n[r[0]])||_5(n[r[1]]))&&e.push({signal:t.getName("geojson_"+e.length)});t.channelHasField(o1)&&t.typedFieldDef(o1).type===T4&&e.push({signal:t.getName("geojson_"+e.length)});0===e.length&&e.push(t.requestDataName(R7));return e}(t):void 0;return new Dnt(t.projectionName(!0),Object.assign(Object.assign({},null!==(e=t.config.projection)&&void 0!==e?e:{}),null!=n?n:{}),i,a)}return}(t):function(t){if(0===t.children.length)return;let e;for(const e of t.children)Int(e);const n=BQ(t.children,t=>{const n=t.component.projection;if(n){if(e){const t=function(t,e){const n=BQ(Fnt,n=>!ce(t.explicit,n)&&!ce(e.explicit,n)||!(!ce(t.explicit,n)||!ce(e.explicit,n)||DQ(t.get(n))!==DQ(e.get(n))));if(DQ(t.size)===DQ(e.size)){if(n)return t;if(DQ(t.explicit)===DQ({}))return e;if(DQ(e.explicit)===DQ({}))return t}return null}(e,n);return t&&(e=t),!!t}return e=n,!0}return!0});if(e&&n){const n=t.projectionName(!0),r=new Dnt(n,e.specifiedProjection,e.size,NQ(e.data));for(const e of t.children){const t=e.component.projection;t&&(t.isFit&&r.data.push(...e.component.projection.data),e.renameProjection(t.get("name"),n),t.merged=!0)}return r}return}(t)}function Mnt(t,e){return`${b2(t)}_${e}`}function $nt(t,e,n){var r;const i=Mnt(null!==(r=S5(n,void 0))&&void 0!==r?r:{},e);return t.getName(i+"_bins")}function Rnt(t,e,n){let r,i;r=function(t){return"as"in t}(t)?ve(t.as)?[t.as,t.as+"_end"]:[t.as[0],t.as[1]]:[h5(t,{forAs:!0}),h5(t,{binSuffix:"end",forAs:!0})];const a=Object.assign({},S5(e,void 0)),o=Mnt(a,t.field),{signal:s,extentSignal:u}=function(t,e){return{signal:t.getName(e+"_bins"),extentSignal:t.getName(e+"_extent")}}(n,o);if(w2(a.extent)){const t=a.extent,e=t.selection;i=wet(n.getSelectionComponent(KQ(e),e),t),delete a.extent}return{key:o,binComponent:Object.assign(Object.assign(Object.assign({bin:a,field:t.field,as:[r]},s?{signal:s}:{}),u?{extentSignal:u}:{}),i?{span:i}:{})}}class Bnt extends N9{constructor(t,e){super(t),this.bins=e}clone(){return new Bnt(null,NQ(this.bins))}static makeFromEncoding(t,e){const n=e.reduceFieldDef((t,n,r)=>{if(s5(n)&&y2(n.bin)){const{key:i,binComponent:a}=Rnt(n,n.bin,e);t[i]=Object.assign(Object.assign(Object.assign({},a),t[i]),function(t,e,n,r){var i,a;if(D5(e,n)){const o=Xrt(t)&&null!==(a=null!==(i=t.axis(n))&&void 0!==i?i:t.legend(n))&&void 0!==a?a:{},s=h5(e,{expr:"datum"}),u=h5(e,{expr:"datum",binSuffix:"end"});return{formulaAs:h5(e,{binSuffix:"range",forAs:!0}),formula:B6(s,u,o.format,o.formatType,r)}}return{}}(e,n,r,e.config))}return t},{});return UQ(n)?null:new Bnt(t,n)}static makeFromTransform(t,e,n){const{key:r,binComponent:i}=Rnt(e,e.bin,n);return new Bnt(t,{[r]:i})}merge(t,e){for(const n of VQ(t.bins))n in this.bins?(e(t.bins[n].signal,this.bins[n].signal),this.bins[n].as=LQ([...this.bins[n].as,...t.bins[n].as],IQ)):this.bins[n]=t.bins[n];for(const e of t.children)t.removeChild(e),e.parent=this;t.remove()}producedFields(){return new Set(GQ(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(GQ(this.bins).map(t=>t.field))}hash(){return"Bin "+IQ(this.bins)}assemble(){return GQ(this.bins).flatMap(t=>{const e=[],[n,...r]=t.as,i=t.bin,{extent:a}=i,o=w(i,["extent"]),s=Object.assign(Object.assign(Object.assign({type:"bin",field:e0(t.field),as:n,signal:t.signal},w2(a)?{extent:null}:{extent:a}),t.span?{span:{signal:`span(${t.span})`}}:{}),o);!a&&t.extentSignal&&(e.push({type:"extent",field:e0(t.field),signal:t.extentSignal}),s.extent={signal:t.extentSignal}),e.push(s);for(const t of r)for(let r=0;r<2;r++)e.push({type:"formula",expr:h5({field:n[r]},{expr:"datum"}),as:t[r]});return t.formula&&e.push({type:"formula",expr:t.formula,as:t.formulaAs}),e})}}class znt extends N9{constructor(t){let e;if(super(null),D7(t=null!=t?t:{name:"source"})||(e=t.format?Object.assign({},FQ(t.format,["parse"])):{}),T7(t))this._data={values:t.values};else if(N7(t)){if(this._data={url:t.url},!e.type){let n=/(?:\.([^.]+))?$/.exec(t.url)[1];$Q(["json","csv","tsv","dsv","topojson"],n)||(n="json"),e.type=n}}else M7(t)?this._data={values:[{type:"Sphere"}]}:(F7(t)||D7(t))&&(this._data={});this._generator=D7(t),t.name&&(this._name=t.name),e&&!UQ(e)&&(this._data.format=e)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function Lnt(t){for(const e of t){for(const t of e.children)if(t.parent!==e)return console.error("Dataflow graph is inconsistent.",e,t),!1;if(!Lnt(e.children))return!1}return!0}class Pnt extends N9{constructor(t,e){super(t),this.params=e}clone(){return new Pnt(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return"Graticule "+IQ(this.params)}assemble(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}class qnt extends N9{constructor(t,e){super(t),this.params=e}clone(){return new qnt(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([null!==(t=this.params.as)&&void 0!==t?t:"data"])}hash(){return"Hash "+IQ(this.params)}assemble(){return Object.assign({type:"sequence"},this.params)}}function Wnt(t){return t instanceof znt||t instanceof Pnt||t instanceof qnt}class Unt{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class Vnt extends Unt{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:t,mutatedFlag:e}){t&&this.setContinue(),e&&this.setMutated()}reset(){}optimizeNextFromLeaves(t){if(Wnt(t))return!1;const e=t.parent,{continueFlag:n}=this.run(t);return n&&this.optimizeNextFromLeaves(e),this.mutatedFlag}}class Gnt extends Unt{}function Hnt(t,e,n,r){const i=Xrt(r)?r.encoding[T1(e)]:void 0;if(s5(n)&&Xrt(r)&&J6(e,n,i,r.stack,r.markDef,r.config))t.add(h5(n,{})),t.add(h5(n,{suffix:"end"})),n.bin&&D5(n,e)&&t.add(h5(n,{binSuffix:"range"}));else if(e in l1){const n=function(t){switch(t){case"latitude":return"y";case"latitude2":return"y2";case"longitude":return"x";case"longitude2":return"x2"}}(e);t.add(r.getName(n))}else t.add(h5(n));return t}class Xnt extends N9{constructor(t,e,n){super(t),this.dimensions=e,this.measures=n}clone(){return new Xnt(null,new Set(this.dimensions),NQ(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,e){let n=!1;e.forEachFieldDef(t=>{t.aggregate&&(n=!0)});const r={},i=new Set;return n?(e.forEachFieldDef((t,n)=>{var a,o,s,u;const{aggregate:c,field:l}=t;if(c)if("count"===c)r["*"]=null!==(a=r["*"])&&void 0!==a?a:{},r["*"].count=new Set([h5(t,{forAs:!0})]);else{if(V0(c)||G0(c)){const t=V0(c)?"argmin":"argmax",e=c[t];r[e]=null!==(o=r[e])&&void 0!==o?o:{},r[e][t]=new Set([h5({op:t,field:e},{forAs:!0})])}else r[l]=null!==(s=r[l])&&void 0!==s?s:{},r[l][c]=new Set([h5(t,{forAs:!0})]);d2(n)&&"unaggregated"===e.scaleDomain(n)&&(r[l]=null!==(u=r[l])&&void 0!==u?u:{},r[l].min=new Set([h5({field:l,aggregate:"min"},{forAs:!0})]),r[l].max=new Set([h5({field:l,aggregate:"max"},{forAs:!0})]))}else Hnt(i,n,t,e)}),i.size+VQ(r).length===0?null:new Xnt(t,i,r)):null}static makeFromTransform(t,e){var n,r,i;const a=new Set,o={};for(const t of e.aggregate){const{op:e,field:i,as:a}=t;e&&("count"===e?(o["*"]=null!==(n=o["*"])&&void 0!==n?n:{},o["*"].count=new Set([a||h5(t,{forAs:!0})])):(o[i]=null!==(r=o[i])&&void 0!==r?r:{},o[i][e]=new Set([a||h5(t,{forAs:!0})])))}for(const t of null!==(i=e.groupby)&&void 0!==i?i:[])a.add(t);return a.size+VQ(o).length===0?null:new Xnt(t,a,o)}merge(t){return function(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}(this.dimensions,t.dimensions)?(function(t,e){var n;for(const r of VQ(e)){const i=e[r];for(const e of VQ(i))r in t?t[r][e]=new Set([...null!==(n=t[r][e])&&void 0!==n?n:[],...i[e]]):t[r]={[e]:i[e]}}}(this.measures,t.measures),!0):(function(...t){W3.debug(...t)}("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...VQ(this.measures)])}producedFields(){const t=new Set;for(const e of VQ(this.measures))for(const n of VQ(this.measures[e])){const r=this.measures[e][n];0===r.size?t.add(`${n}_${e}`):r.forEach(t.add,t)}return t}hash(){return"Aggregate "+IQ({dimensions:this.dimensions,measures:this.measures})}assemble(){const t=[],e=[],n=[];for(const r of VQ(this.measures))for(const i of VQ(this.measures[r]))for(const a of this.measures[r][i])n.push(a),t.push(i),e.push("*"===r?null:e0(r));return{type:"aggregate",groupby:[...this.dimensions].map(e0),ops:t,fields:e,as:n}}}class Knt extends N9{constructor(t,e,n,r){super(t),this.model=e,this.name=n,this.data=r;for(const t of m1){const n=e.facet[t];if(n){const{bin:r,sort:i}=n;this[t]=Object.assign({name:e.getName(t+"_domain"),fields:[h5(n),...y2(r)?[h5(n,{binSuffix:"end"})]:[]]},W6(i)?{sortField:i}:_t(i)?{sortIndexField:Pet(n,t)}:{})}}this.childModel=e.child}hash(){let t="Facet";for(const e of m1)this[e]&&(t+=` ${e.charAt(0)}:${IQ(this[e])}`);return t}get fields(){var t;const e=[];for(const n of m1)(null===(t=this[n])||void 0===t?void 0:t.fields)&&e.push(...this[n].fields);return e}dependentFields(){const t=new Set(this.fields);for(const e of m1)this[e]&&(this[e].sortField&&t.add(this[e].sortField.field),this[e].sortIndexField&&t.add(this[e].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const e of X1){const n=this.childModel.component.scales[e];if(n&&!n.merged){const r=n.get("type"),i=n.get("range");if(r6(r)&&c4(i)){const n=Nrt(Trt(this.childModel,e));n?t[e]=n:V3(`Unknown field for ${e}. Cannot calculate view size.`)}}}return t}assembleRowColumnHeaderData(t,e,n){const r={row:"y",column:"x"}[t],i=[],a=[],o=[];n&&n[r]&&(e?(i.push("distinct_"+n[r]),a.push("max")):(i.push(n[r]),a.push("distinct")),o.push("distinct_"+n[r]));const{sortField:s,sortIndexField:u}=this[t];if(s){const{op:t=z6,field:e}=s;i.push(e),a.push(t),o.push(h5(s,{forAs:!0}))}else u&&(i.push(u),a.push("max"),o.push(u));return{name:this[t].name,source:null!=e?e:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},i.length?{fields:i,ops:a,as:o}:{})]}}assembleFacetHeaderData(t){var e,n;const{columns:r}=this.model.layout,{layoutHeaders:i}=this.model.component,a=[],o={};for(const t of Vet){for(const r of Get){const a=null!==(e=i[t]&&i[t][r])&&void 0!==e?e:[];for(const e of a)if((null===(n=e.axes)||void 0===n?void 0:n.length)>0){o[t]=!0;break}}if(o[t]){const e=`length(data("${this.facet.name}"))`,n="row"===t?r?{signal:`ceil(${e} / ${r})`}:1:r?{signal:`min(${e}, ${r})`}:{signal:e};a.push({name:`${this.facet.name}_${t}`,transform:[{type:"sequence",start:0,stop:n}]})}}const{row:s,column:u}=o;return(s||u)&&a.unshift(this.assembleRowColumnHeaderData("facet",null,t)),a}assemble(){var t,e;const n=[];let r=null;const i=this.getChildIndependentFieldsWithStep(),{column:a,row:o,facet:s}=this;if(a&&o&&(i.x||i.y)){r=`cross_${this.column.name}_${this.row.name}`;const a=[].concat(null!==(t=i.x)&&void 0!==t?t:[],null!==(e=i.y)&&void 0!==e?e:[]),o=a.map(()=>"distinct");n.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:a,ops:o}]})}for(const t of[Q0,Z0])this[t]&&n.push(this.assembleRowColumnHeaderData(t,r,i));if(s){const t=this.assembleFacetHeaderData(i);t&&n.push(...t)}return n}}function Ynt(t){return"'"===t[0]&&"'"===t[t.length-1]||'"'===t[0]&&'"'===t[t.length-1]?t.slice(1,-1):t}function Jnt(t){const e={};return function t(e,n){if(EQ(e))t(e.not,n);else if(CQ(e))for(const r of e.and)t(r,n);else if(AQ(e))for(const r of e.or)t(r,n);else n(e)}(t.filter,t=>{var n;if(w4(t)){let r=null;p4(t)?r=t.equal:v4(t)?r=t.range[0]:x4(t)&&(r=(null!==(n=t.oneOf)&&void 0!==n?n:t.in)[0]),r&&(G3(r)?e[t.field]="date":be(r)?e[t.field]="number":ve(r)&&(e[t.field]="string")),t.timeUnit&&(e[t.field]="date")}}),e}function Znt(t){const e={};function n(t){var n;N5(t)?e[t.field]="date":"quantitative"===t.type&&(n=t.aggregate,ve(n)&&$Q(["min","max"],n))?e[t.field]="number":i0(t.field)>1?t.field in e||(e[t.field]="flatten"):c5(t)&&W6(t.sort)&&i0(t.sort.field)>1&&(t.sort.field in e||(e[t.sort.field]="flatten"))}if((Xrt(t)||Krt(t))&&t.forEachFieldDef((e,r)=>{if(s5(e))n(e);else{const i=j1(r),a=t.fieldDef(i);n(Object.assign(Object.assign({},e),{type:a.type}))}}),Xrt(t)){const{mark:n,markDef:r,encoding:i}=t;if(F0(n)&&!t.encoding.order){const t=i["horizontal"===r.orient?"y":"x"];e5(t)&&"quantitative"===t.type&&!(t.field in e)&&(e[t.field]="number")}}return e}class Qnt extends N9{constructor(t,e){super(t),this._parse=e}clone(){return new Qnt(null,NQ(this._parse))}hash(){return"Parse "+IQ(this._parse)}static makeExplicit(t,e,n){let r={};const i=e.data;return!D7(i)&&i&&i.format&&i.format.parse&&(r=i.format.parse),this.makeWithAncestors(t,r,{},n)}static makeWithAncestors(t,e,n,r){for(const t of VQ(n)){const e=r.getWithExplicit(t);void 0!==e.value&&(e.explicit||e.value===n[t]||"derived"===e.value||"flatten"===n[t]?delete n[t]:V3(y.differentParse(t,n[t],e.value)))}for(const t of VQ(e)){const n=r.get(t);void 0!==n&&(n===e[t]?delete e[t]:V3(y.differentParse(t,e[t],n)))}const i=new O7(e,n);r.copyAll(i);const a={};for(const t of VQ(i.combine())){const e=i.get(t);null!==e&&(a[t]=e)}return 0===VQ(a).length||r.parseNothing?null:new Qnt(t,a)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const e of VQ(this._parse)){const n=this._parse[e];1===i0(e)&&(t[e]=n)}return t}producedFields(){return new Set(VQ(this._parse))}dependentFields(){return new Set(VQ(this._parse))}assembleTransforms(t=!1){return VQ(this._parse).filter(e=>!t||i0(e)>1).map(t=>{const e=function(t,e){const n=QQ(t);if("number"===e)return`toNumber(${n})`;if("boolean"===e)return`toBoolean(${n})`;if("string"===e)return`toString(${n})`;if("date"===e)return`toDate(${n})`;if("flatten"===e)return n;if(0===e.indexOf("date:")){return`timeParse(${n},'${Ynt(e.slice(5,e.length))}')`}if(0===e.indexOf("utc:")){return`utcParse(${n},'${Ynt(e.slice(4,e.length))}')`}return V3(y.unrecognizedParse(e)),null}(t,this._parse[t]);if(!e)return null;return{type:"formula",expr:e,as:r0(t)}}).filter(t=>null!==t)}}class trt extends N9{clone(){return new trt(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set(["_vgsid_"])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:"_vgsid_"}}}class ert extends N9{constructor(t,e){super(t),this.transform=e}clone(){return new ert(null,NQ(this.transform))}addDimensions(t){this.transform.groupby=LQ(this.transform.groupby.concat(t),t=>t)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(t=>t.field).filter(t=>void 0!==t).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var e;return null!==(e=t.as)&&void 0!==e?e:h5(t)}hash(){return"JoinAggregateTransform "+IQ(this.transform)}assemble(){const t=[],e=[],n=[];for(const r of this.transform.joinaggregate)e.push(r.op),n.push(this.getDefaultName(r)),t.push(void 0===r.field?null:r.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:e,fields:t},void 0!==r?{groupby:r}:{})}}class nrt extends N9{constructor(t,e){super(t),this._stack=e}clone(){return new nrt(null,NQ(this._stack))}static makeFromTransform(t,e){const{stack:n,groupby:r,as:i,offset:a="zero"}=e,o=[],s=[];if(void 0!==e.sort)for(const t of e.sort)o.push(t.field),s.push(a0(t.order,"ascending"));const u={field:o,order:s};let c;return c=function(t){return _t(t)&&t.every(t=>ve(t))&&t.length>1}(i)?i:ve(i)?[i,i+"_end"]:[e.stack+"_start",e.stack+"_end"],new nrt(t,{stackField:n,groupby:r,offset:a,sort:u,facetby:[],as:c})}static makeFromEncoding(t,e){const n=e.stack,{encoding:r}=e;if(!n)return null;const{groupbyChannel:i,fieldChannel:a,offset:o,impute:s}=n;let u;if(i){u=O5(r[i])}const c=function(t){return t.stack.stackBy.reduce((t,e)=>{const n=h5(e.fieldDef);return n&&t.push(n),t},[])}(e),l=e.encoding.order;let d;return d=_t(l)||e5(l)?U5(l):c.reduce((t,e)=>(t.field.push(e),t.order.push("y"===a?"descending":"ascending"),t),{field:[],order:[]}),new nrt(t,{dimensionFieldDef:u,stackField:e.vgField(a),facetby:[],stackby:c,sort:d,offset:o,impute:s,as:[e.vgField(a,{suffix:"start",forAs:!0}),e.vgField(a,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return"Stack "+IQ(this._stack)}getGroupbyFields(){const{dimensionFieldDef:t,impute:e,groupby:n}=this._stack;return t?t.bin?e?[h5(t,{binSuffix:"mid"})]:[h5(t,{}),h5(t,{binSuffix:"end"})]:[h5(t)]:null!=n?n:[]}assemble(){const t=[],{facetby:e,dimensionFieldDef:n,stackField:r,stackby:i,sort:a,offset:o,impute:s,as:u}=this._stack;if(s&&n){const{band:a=.5,bin:o}=n;o&&t.push({type:"formula",expr:a+"*"+h5(n,{expr:"datum"})+`+${1-a}*`+h5(n,{expr:"datum",binSuffix:"end"}),as:h5(n,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:r,groupby:[...i,...e],key:h5(n,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...e],field:r,sort:a,as:u,offset:o}),t}}class rrt extends N9{constructor(t,e){super(t),this.transform=e}clone(){return new rrt(null,NQ(this.transform))}addDimensions(t){this.transform.groupby=LQ(this.transform.groupby.concat(t),t=>t)}dependentFields(){var t,e;const n=new Set;return(null!==(t=this.transform.groupby)&&void 0!==t?t:[]).forEach(n.add,n),(null!==(e=this.transform.sort)&&void 0!==e?e:[]).forEach(t=>n.add(t.field)),this.transform.window.map(t=>t.field).filter(t=>void 0!==t).forEach(n.add,n),n}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var e;return null!==(e=t.as)&&void 0!==e?e:h5(t)}hash(){return"WindowTransform "+IQ(this.transform)}assemble(){var t;const e=[],n=[],r=[],i=[];for(const t of this.transform.window)n.push(t.op),r.push(this.getDefaultName(t)),i.push(void 0===t.param?null:t.param),e.push(void 0===t.field?null:t.field);const a=this.transform.frame,o=this.transform.groupby;if(a&&null===a[0]&&null===a[1]&&n.every(t=>H0(t)))return Object.assign({type:"joinaggregate",as:r,ops:n,fields:e},void 0!==o?{groupby:o}:{});const s=[],u=[];if(void 0!==this.transform.sort)for(const e of this.transform.sort)s.push(e.field),u.push(null!==(t=e.order)&&void 0!==t?t:"ascending");const c={field:s,order:u},l=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:i,as:r,ops:n,fields:e,sort:c},void 0!==l?{ignorePeers:l}:{}),void 0!==o?{groupby:o}:{}),void 0!==a?{frame:a}:{})}}class irt extends Vnt{run(t){const e=t.parent;if(t instanceof Qnt){if(Wnt(e))return this.flags;if(e.numChildren()>1)return this.setContinue(),this.flags;if(e instanceof Qnt)this.setMutated(),e.merge(t);else{if(WQ(e.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}class art extends Gnt{mergeNodes(t,e){const n=e.shift();for(const r of e)t.removeChild(r),r.parent=n,r.remove()}run(t){const e=t.children.map(t=>t.hash()),n={};for(let r=0;r<e.length;r++)void 0===n[e[r]]?n[e[r]]=[t.children[r]]:n[e[r]].push(t.children[r]);for(const e of VQ(n))n[e].length>1&&(this.setMutated(),this.mergeNodes(t,n[e]));for(const e of t.children)this.run(e);return this.mutatedFlag}}class ort extends Vnt{run(t){return t instanceof T9||t.numChildren()>0||t instanceof Knt||(this.setMutated(),t.remove()),this.flags}}class srt extends Vnt{constructor(){super(...arguments),this.fields=new Set,this.prev=null}run(t){if(this.setContinue(),t instanceof F9){const e=t.producedFields();PQ(e,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...e]),this.prev=t}return this.flags}reset(){this.fields.clear()}}class urt extends Vnt{run(t){this.setContinue();const e=t.parent.children.filter(t=>t instanceof F9),n=e.pop();for(const t of e)this.setMutated(),n.merge(t);return this.flags}}function crt(t){if(t instanceof Knt)if(1!==t.numChildren()||t.children[0]instanceof T9){const n=t.model.component.data.main;!function t(e){if(e instanceof T9&&e.type===R7&&1===e.numChildren()){const n=e.children[0];n instanceof Knt||(n.swapWithParent(),t(e))}}(n);const r=(e=t,function t(n){if(!(n instanceof Knt)){const r=n.clone();if(r instanceof T9){const t=grt+r.getSource();r.setSource(t),e.model.component.data.outputNodes[t]=r}else(r instanceof Xnt||r instanceof nrt||r instanceof rrt||r instanceof ert)&&r.addDimensions(e.fields);for(const e of n.children.flatMap(t))e.parent=r;return[r]}return n.children.flatMap(t)}),i=t.children.map(r).flat();for(const t of i)t.parent=n}else{const e=t.children[0];(e instanceof Xnt||e instanceof nrt||e instanceof rrt||e instanceof ert)&&e.addDimensions(t.fields),e.swapWithParent(),crt(t)}else t.children.map(crt);var e}class lrt extends Gnt{constructor(){super()}run(t){t instanceof T9&&!t.isRequired()&&(this.setMutated(),t.remove());for(const e of t.children)this.run(e);return this.mutatedFlag}}class drt extends Gnt{constructor(t){super(),this.requiresSelectionId=t&&ltt(t)}run(t){t instanceof trt&&(this.requiresSelectionId&&(Wnt(t.parent)||t.parent instanceof Xnt||t.parent instanceof Qnt)||(this.setMutated(),t.remove()));for(const e of t.children)this.run(e);return this.mutatedFlag}}class frt extends Vnt{run(t){const e=t.parent,n=[...e.children],r=e.children.filter(t=>t instanceof Qnt);if(e.numChildren()>1&&r.length>=1){const t={},i=new Set;for(const e of r){const n=e.parse;for(const e of VQ(n))e in t?t[e]!==n[e]&&i.add(e):t[e]=n[e]}for(const e of i)delete t[e];if(!UQ(t)){this.setMutated();const r=new Qnt(e,t);for(const i of n){if(i instanceof Qnt)for(const e of VQ(t))delete i.parse[e];e.removeChild(i),i.parent=r,i instanceof Qnt&&0===VQ(i.parse).length&&i.remove()}}}return this.setContinue(),this.flags}}class hrt extends Vnt{run(t){const e=t.parent,n=e.children.filter(t=>t instanceof Xnt),r={};for(const t of n){const e=IQ(t.groupBy);e in r||(r[e]=[]),r[e].push(t)}for(const t of VQ(r)){const n=r[t];if(n.length>1){const t=n.pop();for(const r of n)t.merge(r)&&(e.removeChild(r),r.parent=t,r.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class prt extends Vnt{constructor(t){super(),this.model=t}run(t){const e=t.parent,n=!(Wnt(e)||e instanceof vet||e instanceof Qnt||e instanceof trt),r=[],i=[];for(const t of e.children)t instanceof Bnt&&(n&&!WQ(e.producedFields(),t.dependentFields())?r.push(t):i.push(t));if(r.length>0){const t=r.pop();for(const e of r)t.merge(e,this.model.renameSignal.bind(this.model));this.setMutated(),e instanceof Bnt?e.merge(t,this.model.renameSignal.bind(this.model)):t.swapWithParent()}if(i.length>1){const t=i.pop();for(const e of i)t.merge(e,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class mrt extends Vnt{run(t){const e=t.parent,n=[...e.children];if(!RQ(n,t=>t instanceof T9)||e.numChildren()<=1)return this.setContinue(),this.flags;const r=[];let i;for(const t of n)if(t instanceof T9){let n=t;for(;1===n.numChildren();){const t=n.children[0];if(!(t instanceof T9))break;n=t}r.push(...n.children),i?(e.removeChild(t),t.parent=i.parent,i.parent.removeChild(i),i.parent=n,this.setMutated()):i=n}else r.push(t);if(r.length){this.setMutated();for(const t of r)t.parent.removeChild(t),t.parent=i}return this.setContinue(),this.flags}}const grt="scale_";function brt(t){const e=[];function n(t){if(0===t.numChildren())e.push(t);else for(const e of t.children)n(e)}for(const e of t)n(e);return e}function yrt(t){return t}function vrt(t,e){return e.map(e=>{if(t instanceof Vnt){const n=t.optimizeNextFromLeaves(e);return t.reset(),n}return t.run(e)}).some(yrt)}function xrt(t,e){let n=t.sources;const r=new Set;return r.add(vrt(new lrt,n)),r.add(vrt(new drt(e),n)),n=n.filter(t=>t.numChildren()>0),r.add(vrt(new ort,brt(n))),n=n.filter(t=>t.numChildren()>0),r.add(vrt(new irt,brt(n))),r.add(vrt(new prt(e),brt(n))),r.add(vrt(new srt,brt(n))),r.add(vrt(new frt,brt(n))),r.add(vrt(new hrt,brt(n))),r.add(vrt(new urt,brt(n))),r.add(vrt(new art,n)),r.add(vrt(new mrt,brt(n))),t.sources=n,r.has(!0)}class wrt{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,e){return new wrt(()=>t(e))}}function krt(t){Xrt(t)?function(t){const e=t.component.scales;for(const n of VQ(e)){const r=Ort(t,n);if(e[n].setWithExplicit("domains",r),Ert(t,n),t.component.data.isFaceted){let e=t;for(;!Krt(e)&&e.parent;)e=e.parent;if("shared"===e.component.resolve.scale[n])for(const t of r.value)l4(t)&&(t.data=grt+t.data.replace(grt,""))}}}(t):function(t){for(const e of t.children)krt(e);const e=t.component.scales;for(const n of VQ(e)){let r,i=null;for(const e of t.children){const t=e.component.scales[n];if(t){r=void 0===r?t.getWithExplicit("domains"):S7(r,t.getWithExplicit("domains"),"domains","scale",jrt);const e=t.get("selectionExtent");i&&e&&i.selection!==e.selection&&V3("The same selection must be used to override scale domains in a layered view."),i=e}}e[n].setWithExplicit("domains",r),i&&e[n].set("selectionExtent",i,!0)}}(t)}function Ort(t,e){const n=t.getScaleComponent(e).get("type"),{encoding:r}=t,i=function(t,e,n,r){if("unaggregated"===t){const{valid:t,reason:r}=Srt(e,n);if(!t)return void V3(r)}else if(void 0===t&&r.useUnaggregatedDomain){const{valid:t}=Srt(e,n);if(t)return"unaggregated"}return t}(t.scaleDomain(e),t.typedFieldDef(e),n,t.config.scale);return i!==t.scaleDomain(e)&&(t.specifiedScales[e]=Object.assign(Object.assign({},t.specifiedScales[e]),{domain:i})),"x"===e&&_5(r.x2)?_5(r.x)?S7(Art(n,i,t,"x"),Art(n,i,t,"x2"),"domain","scale",jrt):Art(n,i,t,"x2"):"y"===e&&_5(r.y2)?_5(r.y)?S7(Art(n,i,t,"y"),Art(n,i,t,"y2"),"domain","scale",jrt):Art(n,i,t,"y2"):Art(n,i,t,e)}function _rt(t,e,n){var r;const i=null===(r=s4(n))||void 0===r?void 0:r.unit;return"temporal"===e||i?function(t,e,n){return t.map(t=>({signal:`{data: ${T5(t,{timeUnit:n,type:e})}}`}))}(t,e,i):[t]}function Art(t,e,n,r){const{encoding:i}=n,a=_5(i[r]),{type:o}=a,s=a.timeUnit;if(function(t){return t&&t.unionWith}(e)){const i=Art(t,void 0,n,r),a=_rt(e.unionWith,o,s);return _7([...i.value,...a])}if(u4(e))return _7([e]);if(e&&"unaggregated"!==e&&!s6(e))return _7(_rt(e,o,s));const u=n.stack;if(u&&r===u.fieldChannel){if("normalize"===u.offset)return A7([[0,1]]);const t=n.requestDataName(R7);return A7([{data:t,field:n.vgField(r,{suffix:"start"})},{data:t,field:n.vgField(r,{suffix:"end"})}])}const c=d2(r)&&e5(a)?function(t,e,n){if(!r6(n))return;const r=t.fieldDef(e),i=r.sort;if(U6(i))return{op:"min",field:Pet(r,e),order:"ascending"};const{stack:a}=t,o=a?[...a.groupbyField?[a.groupbyField]:[],...a.stackBy.map(t=>t.fieldDef.field)]:void 0;if(W6(i)){const t=a&&!$Q(o,i.field);return Crt(i,t)}if(q6(i)){const{encoding:e,order:n}=i,r=t.fieldDef(e),{aggregate:s,field:u}=r,c=a&&!$Q(o,u);if(V0(s)||G0(s))return Crt({field:h5(r),order:n},c);if(H0(s)||!s)return Crt({op:s,field:u,order:n},c)}else{if("descending"===i)return{op:"min",field:t.vgField(e),order:"descending"};if($Q(["ascending",void 0],i))return!0}return}(n,r,t):void 0;if(r5(a)){return A7(_rt([a.datum],o,s))}const l=a;if("unaggregated"===e){const t=n.requestDataName(R7),{field:e}=a;return A7([{data:t,field:h5({field:e,aggregate:"min"})},{data:t,field:h5({field:e,aggregate:"max"})}])}if(y2(l.bin)){if(r6(t))return A7("bin-ordinal"===t?[]:[{data:XQ(c)?n.requestDataName(R7):n.requestDataName("raw"),field:n.vgField(r,D5(l,r)?{binSuffix:"range"}:{}),sort:!0!==c&&At(c)?c:{field:n.vgField(r,{}),op:"min"}}]);{const{bin:t}=l;if(y2(t)){const e=$nt(n,l.field,t);return A7([new wrt(()=>{const t=n.getSignalName(e);return`[${t}.start, ${t}.stop]`})])}return A7([{data:n.requestDataName(R7),field:n.vgField(r,{})}])}}if(l.timeUnit&&$Q(["time","utc"],t)&&J6(r,l,Xrt(n)?n.encoding[T1(r)]:void 0,n.stack,n.markDef,n.config)){const t=n.requestDataName(R7);return A7([{data:t,field:n.vgField(r)},{data:t,field:n.vgField(r,{suffix:"end"})}])}return A7(c?[{data:XQ(c)?n.requestDataName(R7):n.requestDataName("raw"),field:n.vgField(r),sort:c}]:[{data:n.requestDataName(R7),field:n.vgField(r)}])}function Crt(t,e){const{op:n,field:r,order:i}=t;return Object.assign(Object.assign({op:null!=n?n:e?"sum":z6},r?{field:e0(r)}:{}),i?{order:i}:{})}function Ert(t,e){var n;const r=t.component.scales[e],i=t.specifiedScales[e].domain,a=null===(n=t.fieldDef(e))||void 0===n?void 0:n.bin,o=s6(i)&&i,s=x2(a)&&w2(a.extent)&&a.extent;(o||s)&&r.set("selectionExtent",null!=o?o:s,!0)}function Srt(t,e){const{aggregate:n,type:r}=t;return n?ve(n)&&!J0[n]?{valid:!1,reason:y.unaggregateDomainWithNonSharedDomainOp(n)}:"quantitative"===r&&"log"===e?{valid:!1,reason:y.unaggregatedDomainWithLogScale(t)}:{valid:!0}:{valid:!1,reason:y.unaggregateDomainHasNoEffectForRawField(t)}}function jrt(t,e,n,r){return t.explicit&&e.explicit&&V3(y.mergeConflictingDomainProperty(n,r,t.value,e.value)),{explicit:t.explicit,value:[...t.value,...e.value]}}function Nrt(t){if(l4(t)&&ve(t.field))return t.field;if(function(t){return!_t(t)&&("fields"in t&&!("data"in t))}(t)){let e;for(const n of t.fields)if(l4(n)&&ve(n.field))if(e){if(e!==n.field)return V3(y.FACETED_INDEPENDENT_DIFFERENT_SOURCES),e}else e=n.field;return V3(y.FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES),e}if(function(t){return!_t(t)&&("fields"in t&&"data"in t)}(t)){V3(y.FACETED_INDEPENDENT_SAME_SOURCE);const e=t.fields[0];return ve(e)?e:void 0}}function Trt(t,e){return function(t){const e=LQ(t.map(t=>{if(l4(t)){const{sort:e}=t;return w(t,["sort"])}return t}),IQ),n=LQ(t.map(t=>{if(l4(t)){const e=t.sort;return void 0===e||XQ(e)||("op"in e&&"count"===e.op&&delete e.field,"ascending"===e.order&&delete e.order),e}}).filter(t=>void 0!==t),IQ);if(0===e.length)return;if(1===e.length){const e=t[0];if(l4(e)&&n.length>0){let t=n[0];if(n.length>1)V3(y.MORE_THAN_ONE_SORT),t=!0;else if(At(t)&&"field"in t){const n=t.field;e.field===n&&(t=!t.order||{order:t.order})}return Object.assign(Object.assign({},e),{sort:t})}return e}const r=LQ(n.map(t=>XQ(t)||!("op"in t)||t.op in U0?t:(V3(y.domainSortDropped(t)),!0)),IQ);let i;1===r.length?i=r[0]:r.length>1&&(V3(y.MORE_THAN_ONE_SORT),i=!0);const a=LQ(t.map(t=>l4(t)?t.data:null),t=>t);if(1===a.length&&null!==a[0]){return Object.assign({data:a[0],fields:e.map(t=>t.field)},i?{sort:i}:{})}return Object.assign({fields:e},i?{sort:i}:{})}(t.component.scales[e].get("domains").map(e=>(l4(e)&&(e.data=t.lookupDataSource(e.data)),e)))}function Frt(t){return VQ(t.component.scales).reduce((e,n)=>{const r=t.component.scales[n];if(r.merged)return e;const i=r.combine(),{name:a,type:o,selectionExtent:s,domains:u,range:c,reverse:l}=i,d=w(i,["name","type","selectionExtent","domains","range","reverse"]),f=function(t,e,n){if(K1(n)&&c4(t))return{step:{signal:e+"_step"}};return t}(i.range,a,n);let h;s&&(h=function(t,e){const n=e.selection;return{signal:wet(t.getSelectionComponent(n,KQ(n)),e)}}(t,s));const p=Trt(t,n);return e.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:a,type:o},p?{domain:p}:{}),h?{domainRaw:h}:{}),{range:f}),void 0!==l?{reverse:l}:{}),d)),e},[])}class Drt extends O7{constructor(t,e){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",e)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||RQ(this.get("domains"),t=>_t(t)&&2===t.length&&t[0]<=0&&t[1]>=0)}}const Irt=["range","scheme"];function Mrt(t){return"x"===t?"width":"y"===t?"height":void 0}function $rt(t,e){const n=t.fieldDef(e);if(n&&n.bin&&y2(n.bin)){const r=$nt(t,n.field,n.bin),i=Mrt(e),a=t.getName(i);return new wrt(()=>{const e=t.getSignalName(r),n=`(${e}.stop - ${e}.start) / ${e}.step`;return`${t.getSignalName(a)} / (${n})`})}}function Rrt(t,e){const n=e.specifiedScales[t],{size:r}=e,i=e.getScaleComponent(t).get("type");for(const r of Irt)if(void 0!==n[r]){const a=m6(i,r),o=g6(t,r);if(a)if(o)V3(o);else switch(r){case"range":return _t(n.range)&&K1(t)?_7(n.range.map(t=>{if("width"===t||"height"===t){const n=e.getName(t),r=e.getSignalName.bind(e);return wrt.fromName(r,n)}return t})):_7(n.range);case"scheme":return _7(Brt(n[r]))}else V3(y.scalePropertyNotWorkWithScaleType(i,r,t))}if("x"===t||"y"===t){const e="x"===t?"width":"height",n=r[e];if(F8(n)){if(r6(i))return _7({step:n.step});V3(y.stepDropped(e))}}return A7(function(t,e){const{size:n,config:r,mark:i,encoding:a}=e,o=e.getSignalName.bind(e),{type:s}=_5(a[t]),u=e.getScaleComponent(t).get("type"),{domain:c,domainMid:l}=e.specifiedScales[t];switch(t){case"x":case"y":{if($Q(["point","band"],u))if("x"!==t||n.width){if("y"===t&&!n.height){const t=R8(r.view,"height");if(F8(t))return t}}else{const t=R8(r.view,"width");if(F8(t))return t}const i=Mrt(t),a=e.getName(i);return"y"===t&&i6(u)?[wrt.fromName(o,a),0]:[0,wrt.fromName(o,a)]}case s1:{const a=e.component.scales[t].get("zero"),o=function t(e,n,r){if(n)return u4(n)?{signal:`${n.signal} ? 0 : ${t(e,!1,r)}`}:0;switch(e){case"bar":case"tick":return r.scale.minBandSize;case"line":case"trail":case"rule":return r.scale.minStrokeWidth;case"text":return r.scale.minFontSize;case"point":case"square":case"circle":return r.scale.minSize}throw new Error(y.incompatibleChannel("size",e))}(i,a,r),s=function(t,e,n,r){const i={x:$rt(n,"x"),y:$rt(n,"y")};switch(t){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const t=zrt(e,i,r.view);return be(t)?t-1:new wrt(()=>t.signal+" - 1")}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const t=zrt(e,i,r.view);return be(t)?Math.pow(.95*t,2):new wrt(()=>`pow(0.95 * ${t.signal}, 2)`)}}throw new Error(y.incompatibleChannel("size",t))}(i,n,e,r);return o6(u)?function(t,e,n){const r=()=>{const r=B5(e),i=B5(t),a=`(${r} - ${i}) / (${n} - 1)`;return`sequence(${i}, ${r} + ${a}, ${a})`};return u4(e)?new wrt(r):{signal:r()}}(o,s,function(t,e,n,r){switch(t){case"quantile":return e.scale.quantileCount;case"quantize":return e.scale.quantizeCount;case"threshold":return void 0!==n&&_t(n)?n.length+1:(V3(y.domainRequiredForThresholdScale(r)),3)}}(u,r,c,t)):[o,s]}case e1:return[0,2*Math.PI];case"angle":return[0,360];case t1:return[0,new wrt(()=>`min(${e.getSignalName("width")},${e.getSignalName("height")})/2`)];case"strokeWidth":return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case"strokeDash":return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case o1:return"symbol";case r1:case i1:case a1:return"ordinal"===u?"nominal"===s?"category":"ordinal":void 0!==l?"diverging":"rect"===i||"geoshape"===i?"heatmap":"ramp";case"opacity":case"fillOpacity":case"strokeOpacity":return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel "+t)}(t,e))}function Brt(t){return function(t){return!ve(t)&&!!t.name}(t)?Object.assign({scheme:t.name},FQ(t,["name"])):{scheme:t}}function zrt(t,e,n){const r=F8(t.width)?t.width.step:$8(n,"width"),i=F8(t.height)?t.height.step:$8(n,"height");return e.x||e.y?new wrt(()=>`min(${[e.x?e.x.signal:r,e.y?e.y.signal:i].join(", ")})`):Math.min(r,i)}function Lrt(t,e){Xrt(t)?function(t,e){const n=t.component.scales,{config:r,encoding:i,markDef:a,specifiedScales:o}=t;for(const s of VQ(n)){const u=o[s],c=n[s],l=t.getScaleComponent(s),d=_5(i[s]),f=u[e],h=l.get("type"),p=l.get("padding"),m=l.get("paddingInner"),g=m6(h,e),b=g6(s,e);if(void 0!==f&&(g?b&&V3(b):V3(y.scalePropertyNotWorkWithScaleType(h,e,s))),g&&void 0===b)if(void 0!==f)c.copyKeyFromObject(e,u);else{const n=e in Prt?Prt[e]({model:t,channel:s,fieldOrDatumDef:d,scaleType:h,scalePadding:p,scalePaddingInner:m,domain:u.domain,markDef:a,config:r}):r.scale[e];void 0!==n&&c.set(e,n,!1)}}}(t,e):Wrt(t,e)}const Prt={bins:({model:t,fieldOrDatumDef:e})=>e5(e)?function(t,e){const n=e.bin;if(y2(n)){const r=$nt(t,e.field,n);return new wrt(()=>t.getSignalName(r))}if(v2(n)&&x2(n)&&void 0!==n.step)return{step:n.step};return}(t,e):void 0,interpolate:({channel:t,fieldOrDatumDef:e})=>function(t,e){if($Q([r1,i1,a1],t)&&"nominal"!==e)return"hcl";return}(t,e.type),nice:({scaleType:t,channel:e,fieldOrDatumDef:n})=>function(t,e,n){var r;if((null===(r=O5(n))||void 0===r?void 0:r.bin)||$Q([B4,z4],t))return;return e in H1||void 0}(t,e,n),padding:({channel:t,scaleType:e,fieldOrDatumDef:n,markDef:r,config:i})=>function(t,e,n,r,i,a){if(t in H1){if(a6(e)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:e,orient:o}=i;if("bar"===e&&(!e5(r)||!r.bin&&!r.timeUnit)&&("vertical"===o&&"x"===t||"horizontal"===o&&"y"===t))return a.continuousBandSize}if(e===W4)return n.pointPadding}return}(t,e,i.scale,n,r,i.bar),paddingInner:({scalePadding:t,channel:e,markDef:n,config:r})=>function(t,e,n,r){if(void 0!==t)return;if(e in H1){const{bandPaddingInner:t,barBandPaddingInner:e,rectBandPaddingInner:i}=r;return a0(t,"bar"===n?e:i)}return}(t,e,n.type,r.scale),paddingOuter:({scalePadding:t,channel:e,scaleType:n,markDef:r,scalePaddingInner:i,config:a})=>function(t,e,n,r,i,a){if(void 0!==t)return;if(e in H1&&n===U4){const{bandPaddingOuter:t}=a;return a0(t,u4(i)?{signal:i.signal+"/2"}:i/2)}return}(t,e,n,r.type,i,a.scale),reverse:({fieldOrDatumDef:t,scaleType:e,channel:n,config:r})=>function(t,e,n,r){if("x"===n&&void 0!==r.xReverse)return i6(t)&&"descending"===e?u4(r.xReverse)?{signal:"!"+r.xReverse.signal}:!r.xReverse:r.xReverse;if(i6(t)&&"descending"===e)return!0;return}(e,e5(t)?t.sort:void 0,n,r.scale),zero:({channel:t,fieldOrDatumDef:e,domain:n,markDef:r,scaleType:i})=>function(t,e,n,r,i){if(n&&"unaggregated"!==n&&i6(i)){if(_t(n)){const t=n[0],e=n[n.length-1];if(t<=0&&e>=0)return!0}return!1}if("size"===t&&"quantitative"===e.type&&!o6(i))return!0;if((!e5(e)||!e.bin)&&$Q([...X1,...J1],t)){const{orient:e,type:n}=r;return!$Q(["bar","area","line","trail"],n)||!("horizontal"===e&&"y"===t||"vertical"===e&&"x"===t)}return!1}(t,e,n,r,i)};function qrt(t){Xrt(t)?function(t){const e=t.component.scales;for(const n of l2){const r=e[n];if(!r)continue;const i=Rrt(n,t);r.setWithExplicit("range",i)}}(t):Wrt(t,"range")}function Wrt(t,e){const n=t.component.scales;for(const n of t.children)"range"===e?qrt(n):Lrt(n,e);for(const r of VQ(n)){let i;for(const n of t.children){const t=n.component.scales[r];if(t){i=S7(i,t.getWithExplicit(e),e,"scale",C7((t,n)=>{switch(e){case"range":return t.step&&n.step?t.step-n.step:0}return 0}))}}n[r].setWithExplicit(e,i)}}function Urt(t,e,n,r){const i=function(t,e,n){var r;switch(e.type){case"nominal":case"ordinal":if(h1(t)||"discrete"===g2(t))return"shape"===t&&"ordinal"===e.type&&V3(y.discreteChannelCannotEncode(t,"ordinal")),"ordinal";if(t in H1){if($Q(["rect","bar","image","rule"],n))return"band"}else if("arc"===n&&t in Y1)return"band";return void 0!==e.band||l5(e)&&(null===(r=e.axis)||void 0===r?void 0:r.tickBand)?"band":"point";case"temporal":return h1(t)?"time":"discrete"===g2(t)?(V3(y.discreteChannelCannotEncode(t,"temporal")),"ordinal"):e5(e)&&e.timeUnit&&s4(e.timeUnit).utc?"utc":"time";case"quantitative":return h1(t)?e5(e)&&y2(e.bin)?"bin-ordinal":"linear":"discrete"===g2(t)?(V3(y.discreteChannelCannotEncode(t,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(y.invalidFieldType(e.type))}(e,n,r),{type:a}=t;return d2(e)?void 0!==a?y6(e,a)?e5(n)&&!b6(a,n.type)?(V3(y.scaleTypeNotWorkWithFieldDef(a,i)),i):a:(V3(y.scaleTypeNotWorkWithChannel(e,a,i)),i):i:null}function Vrt(t){Xrt(t)?t.component.scales=function(t){const{encoding:e,mark:n}=t;return l2.reduce((r,i)=>{const a=_5(e[i]);if(a&&n===T0&&i===o1&&a.type===T4)return r;let o=a&&a.scale;if(a&&null!==o&&!1!==o){o=null!=o?o:{};const e=Urt(o,i,a,n);r[i]=new Drt(t.scaleName(i+"",!0),{value:e,explicit:o.type===e})}return r},{})}(t):t.component.scales=function(t){var e;const n=t.component.scales={},r={},i=t.component.resolve;for(const n of t.children){Vrt(n);for(const a of VQ(n.component.scales))if(i.scale[a]=null!==(e=i.scale[a])&&void 0!==e?e:cnt(a,t),"shared"===i.scale[a]){const t=r[a],e=n.component.scales[a].getWithExplicit("type");t?H4(t.value,e.value)?r[a]=S7(t,e,"type","scale",Grt):(i.scale[a]="independent",delete r[a]):r[a]=e}}for(const e of VQ(r)){const i=t.scaleName(e,!0),a=r[e];n[e]=new Drt(i,a);for(const n of t.children){const t=n.component.scales[e];t&&(n.renameScale(t.get("name"),i),t.merged=!0)}}return n}(t)}const Grt=C7((t,e)=>K4(t)-K4(e));class Hrt{constructor(){this.nameMap={}}rename(t,e){this.nameMap[t]=e}has(t){return void 0!==this.nameMap[t]}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function Xrt(t){return"unit"===(null==t?void 0:t.type)}function Krt(t){return"facet"===(null==t?void 0:t.type)}function Yrt(t){return"concat"===(null==t?void 0:t.type)}function Jrt(t){return"layer"===(null==t?void 0:t.type)}class Zrt{constructor(t,e,n,r,i,a,o){var s,u;this.type=e,this.parent=n,this.config=i,this.view=o,this.children=[],this.correctDataNames=t=>(t.from&&t.from.data&&(t.from.data=this.lookupDataSource(t.from.data)),t.from&&t.from.facet&&t.from.facet.data&&(t.from.facet.data=this.lookupDataSource(t.from.facet.data)),t),this.parent=n,this.config=i,this.name=null!==(s=t.name)&&void 0!==s?s:r,this.title=M5(t.title)?{text:t.title}:t.title,this.scaleNameMap=n?n.scaleNameMap:new Hrt,this.projectionNameMap=n?n.projectionNameMap:new Hrt,this.signalNameMap=n?n.signalNameMap:new Hrt,this.data=t.data,this.description=t.description,this.transforms=(null!==(u=t.transform)&&void 0!==u?u:[]).map(t=>B7(t)?{filter:SQ(t.filter,A4)}:t),this.layout="layer"===e||"unit"===e?{}:function(t,e,n){var r,i;const a=n[e],o={},{spacing:s,columns:u}=a;void 0!==s&&(o.spacing=s),void 0!==u&&(H6(t)&&!V6(t.facet)||j8(t))&&(o.columns=u),N8(t)&&(o.columns=1);for(const e of I8)if(void 0!==t[e])if("spacing"===e){const n=t[e];o[e]=be(n)?n:{row:null!==(r=n.row)&&void 0!==r?r:s,column:null!==(i=n.column)&&void 0!==i?i:s}}else o[e]=t[e];return o}(t,e,i),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:H6(t)||n&&n.component.data.isFaceted&&void 0===t.data},layoutSize:new O7,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},a?NQ(a):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(t,{ignoreRange:e}={}){Vrt(t),krt(t);for(const e of p6)Lrt(t,e);e||qrt(t)}(this)}parseProjection(){Int(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){Ont(this)}assembleGroupStyle(){var t,e;if("unit"===this.type||"layer"===this.type)return null!==(e=null===(t=this.view)||void 0===t?void 0:t.style)&&void 0!==e?e:"cell"}assembleEncodeFromView(t){const{style:e}=t,n=w(t,["style"]),r={};for(const t of VQ(n)){const e=n[t];void 0!==e&&(r[t]=$5(e))}return r}assembleGroupEncodeEntry(t){let e={};return this.view&&(e=this.assembleEncodeFromView(this.view)),t||(this.description&&(e.description=$5(this.description)),"unit"!==this.type&&"layer"!==this.type)?UQ(e)?void 0:e:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!=e?e:{})}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:e}=t,n=w(t,["spacing"]),{component:r,config:i}=this,a=function(t,e){const n={};for(const r of m1){const i=t[r];if(null==i?void 0:i.facetFieldDef){const{titleAnchor:t,titleOrient:a}=Uet(["titleAnchor","titleOrient"],i.facetFieldDef,e,r),o=qet(r,a),s=ent(t,o);void 0!==s&&(n[o]=s)}}return UQ(n)?void 0:n}(r.layoutHeaders,i);return Object.assign(Object.assign(Object.assign({padding:e},this.assembleDefaultLayout()),n),a?{titleBand:a}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let e=[];for(const n of m1)t[n].title&&e.push(Het(this,n));for(const t of Vet)e=e.concat(Yet(this,t));return e}assembleAxes(){return function(t,e){const{x:n=[],y:r=[]}=t;return[...n.map(t=>_et(t,"grid",e)),...r.map(t=>_et(t,"grid",e)),...n.map(t=>_et(t,"main",e)),...r.map(t=>_et(t,"main",e))].filter(t=>t)}(this.component.axes,this.config)}assembleLegends(){return jnt(this)}assembleProjections(){return Nnt(this)}assembleTitle(){var t,e,n;const r=null!==(t=this.title)&&void 0!==t?t:{},{encoding:i}=r,a=w(r,["encoding"]),o=Object.assign(Object.assign(Object.assign({},I5(this.config.title).nonMark),a),i?{encode:{update:i}}:{});if(o.text)return $Q(["unit","layer"],this.type)?$Q(["middle",void 0],o.anchor)&&(o.frame=null!==(e=o.frame)&&void 0!==e?e:"group"):o.anchor=null!==(n=o.anchor)&&void 0!==n?n:"start",UQ(o)?void 0:o}assembleGroup(t=[]){const e={};(t=t.concat(this.assembleSignals())).length>0&&(e.signals=t);const n=this.assembleLayout();n&&(e.layout=n),e.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||Krt(this.parent)?function t(e){return Jrt(e)||Yrt(e)?e.children.reduce((e,n)=>e.concat(t(n)),Frt(e)):Frt(e)}(this):[];r.length>0&&(e.scales=r);const i=this.assembleAxes();i.length>0&&(e.axes=i);const a=this.assembleLegends();return a.length>0&&(e.legends=a),e}getName(t){return KQ((this.name?this.name+"_":"")+t)}requestDataName(t){var e;const n=this.getName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(null!==(e=r[n])&&void 0!==e?e:0)+1,n}getSizeSignalRef(t){if(Krt(this.parent)){const e=Z1(snt(t)),n=this.component.scales[e];if(n&&!n.merged){const t=n.get("type"),r=n.get("range");if(r6(t)&&c4(r)){const t=n.get("name"),r=Nrt(Trt(this,e));if(r){return{signal:ont(t,n,h5({aggregate:"distinct",field:r},{expr:"datum"}))}}return V3(`Unknown field for ${e}. Cannot calculate view size.`),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const e=this.component.data.outputNodes[t];return e?e.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,e){this.signalNameMap.rename(t,e)}renameScale(t,e){this.scaleNameMap.rename(t,e)}renameProjection(t,e){this.projectionNameMap.rename(t,e)}scaleName(t,e){return e?this.getName(t):C1(t)&&d2(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t))?this.scaleNameMap.get(this.getName(t)):void 0}projectionName(t){return t?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const e=this.component.scales[t];return e&&!e.merged?e:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,e){let n=this.component.selection[t];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(t,e)),!n)throw new Error(y.selectionNotFound(e));return n}hasAxisOrientSignalRef(){var t,e;return(null===(t=this.component.axes.x)||void 0===t?void 0:t.some(t=>t.hasOrientSignalRef()))||(null===(e=this.component.axes.y)||void 0===e?void 0:e.some(t=>t.hasOrientSignalRef()))}}class Qrt extends Zrt{vgField(t,e={}){const n=this.fieldDef(t);if(n)return h5(n,e)}reduceFieldDef(t,e){return t8(this.getMapping(),(e,n,r)=>{const i=O5(n);return i?t(e,i,r):e},e)}forEachFieldDef(t,e){Q5(this.getMapping(),(e,n)=>{const r=O5(e);r&&t(r,n)},e)}}class tit extends N9{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=NQ(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:"value",null!==(i=a[1])&&void 0!==i?i:"density"]}clone(){return new tit(null,NQ(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"DensityTransform "+IQ(this.transform)}assemble(){const t=this.transform,{density:e}=t,n=w(t,["density"]);return Object.assign({type:"kde",field:e},n)}}class eit extends N9{constructor(t,e){super(t),this.filter=e}clone(){return new eit(null,Object.assign({},this.filter))}static make(t,e){const{config:n,mark:r,markDef:i}=e;if("filter"!==L5("invalid",i,n))return null;const a=e.reduceFieldDef((t,n,i)=>{const a=d2(i)&&e.getScaleComponent(i);if(a){i6(a.get("type"))&&"count"!==n.aggregate&&!F0(r)&&(t[n.field]=n)}return t},{});return VQ(a).length?new eit(t,a):null}dependentFields(){return new Set(VQ(this.filter))}producedFields(){return new Set}hash(){return"FilterInvalid "+IQ(this.filter)}assemble(){const t=VQ(this.filter).reduce((t,e)=>{const n=this.filter[e],r=h5(n,{expr:"datum"});return null!==n&&("temporal"===n.type?t.push(`(isDate(${r}) || (isValid(${r}) && isFinite(+${r})))`):"quantitative"===n.type&&(t.push(`isValid(${r})`),t.push(`isFinite(+${r})`))),t},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class nit extends N9{constructor(t,e){super(t),this.transform=e,this.transform=NQ(e);const{flatten:n,as:r=[]}=this.transform;this.transform.as=n.map((t,e)=>{var n;return null!==(n=r[e])&&void 0!==n?n:t})}clone(){return new nit(this.parent,NQ(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return"FlattenTransform "+IQ(this.transform)}assemble(){const{flatten:t,as:e}=this.transform;return{type:"flatten",fields:t,as:e}}}class rit extends N9{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=NQ(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:"key",null!==(i=a[1])&&void 0!==i?i:"value"]}clone(){return new rit(null,NQ(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return"FoldTransform "+IQ(this.transform)}assemble(){const{fold:t,as:e}=this.transform;return{type:"fold",fields:t,as:e}}}class iit extends N9{constructor(t,e,n,r){super(t),this.fields=e,this.geojson=n,this.signal=r}clone(){return new iit(null,NQ(this.fields),this.geojson,this.signal)}static parseAll(t,e){if(e.component.projection&&!e.component.projection.isFit)return t;let n=0;for(const r of[["longitude","latitude"],["longitude2","latitude2"]]){const i=r.map(t=>{const n=_5(e.encoding[t]);return e5(n)?n.field:r5(n)?{expr:""+n.datum}:u5(n)?{expr:""+n.value}:void 0});(i[0]||i[1])&&(t=new iit(t,i,null,e.getName("geojson_"+n++)))}if(e.channelHasField(o1)){const r=e.typedFieldDef(o1);r.type===T4&&(t=new iit(t,null,r.field,e.getName("geojson_"+n++)))}return t}dependentFields(){var t;const e=(null!==(t=this.fields)&&void 0!==t?t:[]).filter(ve);return new Set([...this.geojson?[this.geojson]:[],...e])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${IQ(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class ait extends N9{constructor(t,e,n,r){super(t),this.projection=e,this.fields=n,this.as=r}clone(){return new ait(null,this.projection,NQ(this.fields),NQ(this.as))}static parseAll(t,e){if(!e.projectionName())return t;for(const n of[["longitude","latitude"],["longitude2","latitude2"]]){const r=n.map(t=>{const n=_5(e.encoding[t]);return e5(n)?n.field:r5(n)?{expr:""+n.datum}:u5(n)?{expr:""+n.value}:void 0}),i="longitude2"===n[0]?"2":"";(r[0]||r[1])&&(t=new ait(t,e.projectionName(),r,[e.getName("x"+i),e.getName("y"+i)]))}return t}dependentFields(){return new Set(this.fields.filter(ve))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${IQ(this.fields)} ${IQ(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class oit extends N9{constructor(t,e){super(t),this.transform=e}clone(){return new oit(null,NQ(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:e=0,stop:n,step:r}=t;return{signal:`sequence(${[e,n,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,e){return new oit(t,e)}static makeFromEncoding(t,e){const n=e.encoding,r=n.x,i=n.y;if(e5(r)&&e5(i)){const a=r.impute?r:i.impute?i:void 0;if(void 0===a)return;const o=r.impute?i:i.impute?r:void 0,{method:s,value:u,frame:c,keyvals:l}=a.impute,d=e8(e.mark,n);return new oit(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:a.field,key:o.field},s?{method:s}:{}),void 0!==u?{value:u}:{}),c?{frame:c}:{}),void 0!==l?{keyvals:l}:{}),d.length?{groupby:d}:{}))}return null}hash(){return"Impute "+IQ(this.transform)}assemble(){const{impute:t,key:e,keyvals:n,method:r,groupby:i,value:a,frame:o=[null,null]}=this.transform,s=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:e},n?{keyvals:(u=n,void 0!==(null==u?void 0:u.stop)?this.processSequence(n):n)}:{}),{method:"value"}),i?{groupby:i}:{}),{value:r&&"value"!==r?null:a});var u;if(r&&"value"!==r){return[s,Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:o,ignorePeers:!1},i?{groupby:i}:{}),{type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t}]}return[s]}}class sit extends N9{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=NQ(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:e.on,null!==(i=a[1])&&void 0!==i?i:e.loess]}clone(){return new sit(null,NQ(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"LoessTransform "+IQ(this.transform)}assemble(){const t=this.transform,{loess:e,on:n}=t,r=w(t,["loess","on"]);return Object.assign({type:"loess",x:n,y:e},r)}}class uit extends N9{constructor(t,e,n){super(t),this.transform=e,this.secondary=n}clone(){return new uit(null,NQ(this.transform),this.secondary)}static make(t,e,n,r){const i=e.component.data.sources,{from:a}=n;let o=null;if(function(t){return"data"in t}(a)){let t=Oit(a.data,i);t||(t=new znt(a.data),i.push(t));const n=e.getName("lookup_"+r);o=new T9(t,n,"lookup",e.component.data.outputNodeRefCounts),e.component.data.outputNodes[n]=o}else if(function(t){return"selection"in t}(a)){const t=a.selection;if(n=Object.assign({as:t},n),o=e.getSelectionComponent(KQ(t),t).materialized,!o)throw new Error(y.noSameUnitLookup(t))}return new uit(t,n,o.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?Kt(this.transform.as):this.transform.from.fields)}hash(){return"Lookup "+IQ({transform:this.transform,secondary:this.secondary})}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:Kt(this.transform.as)}:{});else{let e=this.transform.as;ve(e)||(V3(y.NO_FIELDS_NEEDS_AS),e="_lookup"),t={as:[e]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class cit extends N9{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=NQ(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:"prob",null!==(i=a[1])&&void 0!==i?i:"value"]}clone(){return new cit(null,NQ(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"QuantileTransform "+IQ(this.transform)}assemble(){const t=this.transform,{quantile:e}=t,n=w(t,["quantile"]);return Object.assign({type:"quantile",field:e},n)}}class lit extends N9{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=NQ(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:e.on,null!==(i=a[1])&&void 0!==i?i:e.regression]}clone(){return new lit(null,NQ(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"RegressionTransform "+IQ(this.transform)}assemble(){const t=this.transform,{regression:e,on:n}=t,r=w(t,["regression","on"]);return Object.assign({type:"regression",x:n,y:e},r)}}class dit extends N9{constructor(t,e){super(t),this.transform=e}clone(){return new dit(null,NQ(this.transform))}addDimensions(t){var e;this.transform.groupby=LQ((null!==(e=this.transform.groupby)&&void 0!==e?e:[]).concat(t),t=>t)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}hash(){return"PivotTransform "+IQ(this.transform)}assemble(){const{pivot:t,value:e,groupby:n,limit:r,op:i}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:e},void 0!==r?{limit:r}:{}),void 0!==i?{op:i}:{}),void 0!==n?{groupby:n}:{})}}class fit extends N9{constructor(t,e){super(t),this.transform=e}clone(){return new fit(null,NQ(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return"SampleTransform "+IQ(this.transform)}assemble(){return{type:"sample",size:this.transform.sample}}}function hit(t){let e=0;return function n(r,i){var a;if(r instanceof znt&&!r.isGenerator&&!N7(r.data)){t.push(i);i={name:null,source:i.name,transform:[]}}if(r instanceof Qnt&&(r.parent instanceof znt&&!i.source?(i.format=Object.assign(Object.assign({},null!==(a=i.format)&&void 0!==a?a:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof Knt){i.name||(i.name="data_"+e++),!i.source||i.transform.length>0?(t.push(i),r.data=i.name):r.data=i.source;for(const e of r.assemble())t.push(e)}else{if((r instanceof Pnt||r instanceof qnt||r instanceof eit||r instanceof vet||r instanceof Let||r instanceof ait||r instanceof iit||r instanceof Xnt||r instanceof uit||r instanceof rrt||r instanceof ert||r instanceof rit||r instanceof nit||r instanceof tit||r instanceof sit||r instanceof cit||r instanceof lit||r instanceof trt||r instanceof fit||r instanceof dit)&&i.transform.push(r.assemble()),(r instanceof Bnt||r instanceof F9||r instanceof oit||r instanceof nrt)&&i.transform.push(...r.assemble()),r instanceof T9)if(i.source&&0===i.transform.length)r.setSource(i.source);else if(r.parent instanceof T9)r.setSource(i.name);else if(i.name||(i.name="data_"+e++),r.setSource(i.name),1===r.numChildren()){t.push(i);i={name:null,source:i.name,transform:[]}}switch(r.numChildren()){case 0:r instanceof T9&&(!i.source||i.transform.length>0)&&t.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name="data_"+e++);let a=i.name;!i.source||i.transform.length>0?t.push(i):a=i.source;for(const t of r.children){n(t,{name:null,source:a,transform:[]})}break}}}}}function pit(t,e){var n;const{facet:r,config:i,child:a,component:o}=t;if(t.channelHasField(e)){const s=r[e],u=Wet("title",null,i,e);let c=v5(s,i,{allowDisabling:!0,includeDefault:void 0===u||!!u});a.component.layoutHeaders[e].title&&(c=_t(c)?c.join(", "):c,c+=" / "+a.component.layoutHeaders[e].title,a.component.layoutHeaders[e].title=null);const l=Wet("labelOrient",s,i,e),d=a0((null!==(n=s.header)&&void 0!==n?n:{}).labels,i.header.labels,!0),f=$Q(["bottom","right"],l)?"footer":"header";o.layoutHeaders[e]={title:c,facetFieldDef:s,[f]:"facet"===e?[]:[mit(t,e,d)]}}}function mit(t,e,n){const r="row"===e?"height":"width";return{labels:n,sizeSignal:t.child.component.layoutSize.get(r)?t.child.getSizeSignalRef(r):void 0,axes:[]}}function git(t,e){var n;const{child:r}=t;if(r.component.axes[e]){const{layoutHeaders:a,resolve:o}=t.component;if(o.axis[e]=lnt(o,e),"shared"===o.axis[e]){const o="x"===e?"column":"row",s=a[o];for(const a of r.component.axes[e]){const e="top"===(i=a.get("orient"))||"left"===i||u4(i)?"header":"footer";s[e]=null!==(n=s[e])&&void 0!==n?n:[mit(t,o,!1)];const r=_et(a,"main",t.config,{header:!0});r&&s[e][0].axes.push(r),a.mainExtracted=!0}}}var i}function bit(t){yit(t);const e=1===t.layout.columns?"width":"childWidth",n=void 0===t.layout.columns?"height":"childHeight";vit(t,e),vit(t,n)}function yit(t){for(const e of t.children)e.parseLayoutSize()}function vit(t,e){const n=snt(e),r=Z1(n),i=t.component.resolve,a=t.component.layoutSize;let o;for(const e of t.children){const t=e.component.layoutSize.getWithExplicit(n),a=i.scale[r];if("independent"===a&&"step"===t.value){o=void 0;break}if(o){if("independent"===a&&o.value!==t.value){o=void 0;break}o=S7(o,t,n,"")}else o=t}if(o){for(const r of t.children)t.renameSignal(r.getName(n),t.getName(e)),r.component.layoutSize.set(n,"merged",!1);a.setWithExplicit(e,o)}else a.setWithExplicit(e,{explicit:!1,value:void 0})}function xit(t,e){const n="width"===e?"x":"y",r=t.config,i=t.getScaleComponent(n);if(i){const t=i.get("type"),n=i.get("range");if(r6(t)){const t=R8(r.view,e);return c4(n)||F8(t)?"step":t}return M8(r.view,e)}if(t.hasProjection||"arc"===t.mark)return M8(r.view,e);{const t=R8(r.view,e);return F8(t)?t.step:t}}function wit(t,e,n){return h5(e,Object.assign({suffix:"by_"+h5(t)},null!=n?n:{}))}class kit extends Qrt{constructor(t,e,n,r){super(t,"facet",e,n,r,t.resolve),this.child=Uit(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet,r)}initFacet(t,e){return V6(t)?t8(t,(t,n,r)=>$Q([Z0,Q0],r)?void 0===n.field?(V3(y.emptyFieldDef(n,r)),t):(t[r]=A5(n,r,e),t):(V3(y.incompatibleChannel(r,"facet")),t),{}):{facet:A5(t,"facet",e)}}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=Ait(this),this.child.parseData()}parseLayoutSize(){yit(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(t){for(const e of m1)pit(t,e);git(t,"x"),git(t,"y")}(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,e,n;const r={};for(const i of m1)for(const a of Get){const o=this.component.layoutHeaders[i],s=o[a],{facetFieldDef:u}=o;if(u){const e=Wet("titleOrient",u,this.config,i);if($Q(["right","bottom"],e)){const n=qet(i,e);r.titleAnchor=null!==(t=r.titleAnchor)&&void 0!==t?t:{},r.titleAnchor[n]="end"}}if(null==s?void 0:s[0]){const t="row"===i?"height":"width",s="header"===a?"headerBand":"footerBand";"facet"===i||this.child.component.layoutSize.get(t)||(r[s]=null!==(e=r[s])&&void 0!==e?e:{},r[s][i]=.5),o.title&&(r.offset=null!==(n=r.offset)&&void 0!==n?n:{},r.offset["row"===i?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:t,row:e}=this.facet,n=t?this.columnDistinctSignal():e?1:void 0;let r="all";return(e||"independent"!==this.component.resolve.scale.x)&&(t||"independent"!==this.component.resolve.scale.y)||(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),n?{columns:n}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof kit)){return{signal:`length(data('${this.getName("column_domain")}'))`}}}assembleGroup(t){return this.parent&&this.parent instanceof kit?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:h5(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],e=[],n=[];if(this.child instanceof kit){if(this.child.channelHasField("column")){const r=h5(this.child.facet.column);t.push(r),e.push("distinct"),n.push("distinct_"+r)}}else for(const r of X1){const i=this.child.component.scales[r];if(i&&!i.merged){const a=i.get("type"),o=i.get("range");if(r6(a)&&c4(o)){const i=Nrt(Trt(this.child,r));i?(t.push(i),e.push("distinct"),n.push("distinct_"+i)):V3(`Unknown field for ${r}. Cannot calculate view size.`)}}}return{fields:t,ops:e,as:n}}assembleFacet(){const{name:t,data:e}=this.component.data.facetRoot,{row:n,column:r}=this.facet,{fields:i,ops:a,as:o}=this.getCardinalityAggregateForChild(),s=[];for(const t of m1){const e=this.facet[t];if(e){s.push(h5(e));const{bin:u,sort:c}=e;if(y2(u)&&s.push(h5(e,{binSuffix:"end"})),W6(c)){const{field:t,op:s=z6}=c,u=wit(e,c);n&&r?(i.push(u),a.push("max"),o.push(u)):(i.push(t),a.push(s),o.push(u))}else if(_t(c)){const n=Pet(e,t);i.push(n),a.push("max"),o.push(n)}}}const u=!!n&&!!r;return Object.assign({name:t,data:e,groupby:s},u||i.length>0?{aggregate:Object.assign(Object.assign({},u?{cross:u}:{}),i.length?{fields:i,ops:a,as:o}:{})}:{})}facetSortFields(t){const{facet:e}=this,n=e[t];return n?W6(n.sort)?[wit(n,n.sort,{expr:"datum"})]:_t(n.sort)?[Pet(n,t,{expr:"datum"})]:[h5(n,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:e}=this,n=e[t];if(n){const{sort:t}=n;return[(W6(t)?t.order:!_t(t)&&t)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:e}=this;if(t.facet)return Zet(t.facet,"facet",e);const n={row:["top","bottom"],column:["left","right"]};for(const r of Vet)if(t[r]){const i=Wet("labelOrient",t[r],e,r);if($Q(n[r],i))return Zet(t[r],r,e)}}assembleMarks(){const{child:t}=this,e=function(t){const e=[],n=hit(e);for(const e of t.children)n(e,{source:t.name,name:null,transform:[]});return e}(this.component.data.facetRoot),n=t.assembleGroupEncodeEntry(!1),r=this.assembleLabelTitle()||t.assembleTitle(),i=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},r?{title:r}:{}),i?{style:i}:{}),{from:{facet:this.assembleFacet()},sort:{field:m1.map(t=>this.facetSortFields(t)).flat(),order:m1.map(t=>this.facetSortOrder(t)).flat()}}),e.length>0?{data:e}:{}),n?{encode:{update:n}}:{}),t.assembleGroup(function(t,e){if(t.component.selection&&VQ(t.component.selection).length){const n=Ee(t.getName("cell"));e.unshift({name:"facet",value:{},on:[{events:OY("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return Y9(e)}(this,[])))]}getMapping(){return this.facet}}function Oit(t,e){var n,r,i,a,o,s,u,c,l,d;for(const f of e){const e=f.data;if((!t.name||!f.hasName()||t.name===f.dataName)&&!((null===(n=t.format)||void 0===n?void 0:n.mesh)&&(null===(r=e.format)||void 0===r?void 0:r.feature)||((null===(i=t.format)||void 0===i?void 0:i.feature)||(null===(a=e.format)||void 0===a?void 0:a.feature))&&(null===(o=t.format)||void 0===o?void 0:o.feature)!==(null===(s=e.format)||void 0===s?void 0:s.feature)||((null===(u=t.format)||void 0===u?void 0:u.mesh)||(null===(c=e.format)||void 0===c?void 0:c.mesh))&&(null===(l=t.format)||void 0===l?void 0:l.mesh)!==(null===(d=e.format)||void 0===d?void 0:d.mesh)))if(T7(t)&&T7(e)){if(jQ(t.values,e.values))return f}else if(N7(t)&&N7(e)){if(t.url===e.url)return f}else if(F7(t)&&t.name===f.dataName)return f}return null}function _it(t,e){if(t.data||!t.parent){if(null===t.data){const t=new znt({values:[]});return e.push(t),t}const n=Oit(t.data,e);if(n)return D7(t.data)||(n.data.format=function(t,...e){for(const n of e)zQ(t,null!=n?n:{});return t}({},t.data.format,n.data.format)),!n.hasName()&&t.data.name&&(n.dataName=t.data.name),n;{const n=new znt(t.data);return e.push(n),n}}return t.parent.component.data.facetRoot?t.parent.component.data.facetRoot:t.parent.component.data.main}function Ait(t){var e,n,r,i,a,o,s,u,c,l;let d=_it(t,t.component.data.sources);const{outputNodes:f,outputNodeRefCounts:h}=t.component.data,p=t.parent?t.parent.component.data.ancestorParse.clone():new j7,m=t.data;D7(m)?(I7(m)?d=new qnt(d,m.sequence):$7(m)&&(d=new Pnt(d,m.graticule)),p.parseNothing=!0):null===(null===(e=null==m?void 0:m.format)||void 0===e?void 0:e.parse)&&(p.parseNothing=!0),d=null!==(n=Qnt.makeExplicit(d,t,p))&&void 0!==n?n:d,d=new trt(d);const g=t.parent&&Jrt(t.parent);(Xrt(t)||Krt(t))&&g&&(d=null!==(r=Bnt.makeFromEncoding(d,t))&&void 0!==r?r:d),t.transforms.length>0&&(d=function(t,e,n){var r,i;let a=0;for(const o of e.transforms){let s,u=void 0;if(K7(o))s=t=new Let(t,o),u="derived";else if(B7(o)){const i=Jnt(o);s=t=null!==(r=Qnt.makeWithAncestors(t,{},i,n))&&void 0!==r?r:t,t=new vet(t,e,o.filter)}else if(Y7(o))s=t=Bnt.makeFromTransform(t,o,e),u="number";else if(Z7(o)){u="date";void 0===n.getWithExplicit(o.field).value&&(t=new Qnt(t,{[o.field]:u}),n.set(o.field,u,!1)),s=t=F9.makeFromTransform(t,o)}else if(Q7(o))s=t=Xnt.makeFromTransform(t,o),u="number",ltt(e)&&(t=new trt(t));else if(z7(o))s=t=uit.make(t,e,o,a++),u="derived";else if(G7(o))s=t=new rrt(t,o),u="number";else if(H7(o))s=t=new ert(t,o),u="number";else if(t9(o))s=t=nrt.makeFromTransform(t,o),u="derived";else if(e9(o))s=t=new rit(t,o),u="derived";else if(X7(o))s=t=new nit(t,o),u="derived";else if(L7(o))s=t=new dit(t,o),u="derived";else if(V7(o))t=new fit(t,o);else if(J7(o))s=t=oit.makeFromTransform(t,o),u="derived";else if(P7(o))s=t=new tit(t,o),u="derived";else if(q7(o))s=t=new cit(t,o),u="derived";else if(W7(o))s=t=new lit(t,o),u="derived";else{if(!U7(o)){V3(y.invalidTransformIgnored(o));continue}s=t=new sit(t,o),u="derived"}if(s&&void 0!==u)for(const t of null!==(i=s.producedFields())&&void 0!==i?i:[])n.set(t,u,!1)}return t}(d,t,p));const b=function(t){const e={};if(Xrt(t)&&t.component.selection)for(const n of VQ(t.component.selection)){const r=t.component.selection[n];for(const t of r.project.items)!t.channel&&i0(t.field)>1&&(e[t.field]="flatten")}return e}(t),v=Znt(t);d=null!==(i=Qnt.makeWithAncestors(d,{},Object.assign(Object.assign({},b),v),p))&&void 0!==i?i:d,Xrt(t)&&(d=iit.parseAll(d,t),d=ait.parseAll(d,t)),(Xrt(t)||Krt(t))&&(g||(d=null!==(a=Bnt.makeFromEncoding(d,t))&&void 0!==a?a:d),d=null!==(o=F9.makeFromEncoding(d,t))&&void 0!==o?o:d,d=Let.parseAllForSortIndex(d,t));const x=t.getName("raw"),w=new T9(d,x,"raw",h);if(f[x]=w,d=w,Xrt(t)){const e=Xnt.makeFromEncoding(d,t);e&&(d=e,ltt(t)&&(d=new trt(d))),d=null!==(s=oit.makeFromEncoding(d,t))&&void 0!==s?s:d,d=null!==(u=nrt.makeFromEncoding(d,t))&&void 0!==u?u:d}Xrt(t)&&(d=null!==(c=eit.make(d,t))&&void 0!==c?c:d);const k=t.getName(R7),O=new T9(d,k,R7,h);f[k]=O,d=O,Xrt(t)&&function(t,e){utt(t,n=>{const r=n.name,i=t.getName("lookup_"+r);t.component.data.outputNodes[i]=n.materialized=new T9(new vet(e,t,{selection:r}),i,"lookup",t.component.data.outputNodeRefCounts)})}(t,O);let _=null;if(Krt(t)){const e=t.getName("facet");d=null!==(l=function(t,e){const{row:n,column:r}=e;if(n&&r){let e=null;for(const i of[n,r])if(W6(i.sort)){const{field:n,op:r=z6}=i.sort;t=e=new ert(t,{joinaggregate:[{op:r,field:n,as:wit(i,i.sort,{forAs:!0})}],groupby:[h5(i)]})}return e}return null}(d,t.facet))&&void 0!==l?l:d,_=new Knt(d,t,e,O.getSource()),f[e]=_}return Object.assign(Object.assign({},t.component.data),{outputNodes:f,outputNodeRefCounts:h,raw:w,main:O,facetRoot:_,ancestorParse:p})}class Cit extends Zrt{constructor(t,e,n,r){var i,a,o,s;super(t,"concat",e,n,r,t.resolve),"shared"!==(null===(a=null===(i=t.resolve)||void 0===i?void 0:i.axis)||void 0===a?void 0:a.x)&&"shared"!==(null===(s=null===(o=t.resolve)||void 0===o?void 0:o.axis)||void 0===s?void 0:s.y)||V3(y.CONCAT_CANNOT_SHARE_AXIS),this.children=this.getChildren(t).map((t,e)=>Uit(t,this,this.getName("concat_"+e),void 0,r))}parseData(){this.component.data=Ait(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of VQ(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return N8(t)?t.vconcat:T8(t)?t.hconcat:t.concat}parseLayoutSize(){bit(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((t,e)=>e.assembleSelectionTopLevelSignals(t),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=rnt(this);for(const e of this.children)t.push(...e.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((t,e)=>e.assembleSelectionData(t),t)}assembleMarks(){return this.children.map(t=>{const e=t.assembleTitle(),n=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},e?{title:e}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())})}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},null!=t?{columns:t}:{}),{bounds:"full",align:"each"})}}const Eit=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},p0),{labelExpr:1,encode:1}),Sit=VQ(Eit);class jit extends O7{constructor(t={},e={},n=!1){super(),this.explicit=t,this.implicit=e,this.mainExtracted=n}clone(){return new jit(NQ(this.explicit),NQ(this.implicit),this.mainExtracted)}hasAxisPart(t){return"axis"===t||("grid"===t||"title"===t?!!this.get(t):!(!1===(e=this.get(t))||null===e));var e}hasOrientSignalRef(){return u4(this.explicit.orient)}}const Nit={bottom:"top",top:"bottom",left:"right",right:"left"};function Tit(t,e){if(!t)return e.map(t=>t.clone());{if(t.length!==e.length)return;const n=t.length;for(let r=0;r<n;r++){const n=t[r],i=e[r];if(!!n!=!!i)return;if(n&&i){const e=n.getWithExplicit("orient"),a=i.getWithExplicit("orient");if(e.explicit&&a.explicit&&e.value!==a.value)return;t[r]=Fit(n,i)}}}return t}function Fit(t,e){for(const n of Sit){const r=S7(t.getWithExplicit(n),e.getWithExplicit(n),n,"axis",(t,e)=>{switch(n){case"title":return H5(t,e);case"gridScale":return{explicit:t.explicit,value:a0(t.value,e.value)}}return E7(t,e,n,"axis")});t.setWithExplicit(n,r)}return t}function Dit(t,e,n,r,i){if("disable"===e)return void 0!==n;switch(n=n||{},e){case"titleAngle":case"labelAngle":return t===(u4(n.labelAngle)?n.labelAngle:u0(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(t===zet(r,i))return!0}return t===n[e]}const Iit=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Mit(t,e){var n,r,i;let a=e.axis(t);const o=new jit,s=_5(e.encoding[t]),{mark:u,config:c}=e,l=(null==a?void 0:a.orient)||(null===(n=c["x"===t?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(r=c.axis)||void 0===r?void 0:r.orient)||function(t){return"x"===t?"bottom":"left"}(t),d=e.getScaleComponent(t).get("type"),f=Fet(t,d,l,e.config),h=void 0!==a?!a:Iet("disable",c,null==a?void 0:a.style,f).configValue;if(o.set("disable",h,void 0!==a),h)return o;a=a||{};const p=function(t,e,n,r,i){const a=null==e?void 0:e.labelAngle;if(void 0!==a)return u4(a)?a:u0(a);{const{configValue:a}=Iet("labelAngle",t.config,null==e?void 0:e.style,i);return void 0!==a?u0(a):"x"===n&&$Q([N4,S4],r.type)?270:void 0}}(e,a,t,s,f),m={fieldOrDatumDef:s,axis:a,channel:t,model:e,scaleType:d,orient:l,labelAngle:p,mark:u,config:c};for(const n of Sit){const r=n in Met?Met[n](m):g0(n)?a[n]:void 0,i=void 0!==r,s=Dit(r,n,a,e,t);if(i&&s)o.set(n,r,s);else{const{configValue:t,configFrom:u}=g0(n)&&"values"!==n?Iet(n,e.config,a.style,f):{},c=void 0!==t;i&&!c?o.set(n,r,s):("vgAxisConfig"!==u||Iit.has(n)&&c||d0(t)||u4(t))&&o.set(n,t,!1)}}const g=null!==(i=a.encoding)&&void 0!==i?i:{},b=f0.reduce((n,r)=>{var i;if(!o.hasAxisPart(r))return n;const a=unt(null!==(i=g[r])&&void 0!==i?i:{},e),s="labels"===r?function(t,e,n){var r;const{encoding:i,config:a}=t,o=null!==(r=_5(i[e]))&&void 0!==r?r:_5(i[T1(e)]),s=t.axis(e)||{},{format:u,formatType:c}=s;return S6(c)?Object.assign({text:F6({fieldOrDatumDef:o,field:"datum.value",format:u,formatType:c,config:a})},n):n}(e,t,a):a;return void 0===s||UQ(s)||(n[r]={update:s}),n},{});return UQ(b)||o.set("encode",b,!!a.encoding||void 0!==a.labelAngle),o}function $it(t,e,n,{graticule:r}){const i=M0(t)?Object.assign({},t):{type:t},a=L5("orient",i,n);if(i.orient=function(t,e,n){switch(t){case O0:case j0:case N0:case C0:case _0:case w0:return}const{x:r,y:i,x2:a,y2:o}=e;switch(t){case x0:if(e5(r)&&(v2(r.bin)||e5(i)&&i.aggregate&&!r.aggregate))return"vertical";if(e5(i)&&(v2(i.bin)||e5(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(o||a){if(n)return n;if(!a&&(e5(r)&&r.type===E4&&!y2(r.bin)||a5(r)))return"horizontal";if(!o&&(e5(i)&&i.type===E4&&!y2(i.bin)||a5(i)))return"vertical"}case A0:if(a&&(!e5(r)||!v2(r.bin))&&o&&(!e5(i)||!v2(i.bin)))return;case v0:if(o)return e5(i)&&v2(i.bin)?"horizontal":"vertical";if(a)return e5(r)&&v2(r.bin)?"vertical":"horizontal";if(t===A0){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case k0:case E0:{const e=i5(r),a=i5(i);if(e&&!a)return"tick"!==t?"horizontal":"vertical";if(!e&&a)return"tick"!==t?"vertical":"horizontal";if(e&&a){const e=r,a=i,o=e.type===j4,s=a.type===j4;return o&&!s?"tick"!==t?"vertical":"horizontal":!o&&s?"tick"!==t?"horizontal":"vertical":!e.aggregate&&a.aggregate?"tick"!==t?"vertical":"horizontal":e.aggregate&&!a.aggregate?"tick"!==t?"horizontal":"vertical":n||"vertical"}return n||void 0}}return"vertical"}(i.type,e,a),void 0!==a&&a!==i.orient&&V3(y.orientOverridden(i.orient,a)),"bar"===i.type&&i.orient){const t=L5("cornerRadiusEnd",i,n);if(void 0!==t){const n="horizontal"===i.orient&&e.x2||"vertical"===i.orient&&e.y2?["cornerRadius"]:B0[i.orient];for(const e of n)i[e]=t;void 0!==i.cornerRadiusEnd&&delete i.cornerRadiusEnd}}void 0===L5("opacity",i,n)&&(i.opacity=function(t,e){if($Q([O0,E0,j0,N0],t)&&!K5(e))return.7;return}(i.type,e));void 0===i.filled&&(i.filled=!r&&function(t,e){const n=P5("filled",t,e),r=t.type;return a0(n,r!==O0&&r!==k0&&r!==A0)}(i,n));return void 0===L5("cursor",i,n)&&(i.cursor=function(t,e,n){if(e.href||t.href||L5("href",t,n))return"pointer";return t.cursor}(i,e,n)),i}function Rit(t,e){const{config:n}=t;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},A9(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),f9("x",t,{defaultPos:"mid"})),f9("y",t,{defaultPos:"mid"})),c9("size",t)),c9("angle",t)),function(t,e,n){if(n)return{shape:{value:n}};return c9("shape",t)}(t,0,e))}function Bit(t){var e;const{config:n,markDef:r}=t,{orient:i}=r,a="horizontal"===i?"width":"height",o=t.getScaleComponent("horizontal"===i?"x":"y"),s=null!==(e=L5("size",r,n,{vgChannel:a}))&&void 0!==e?e:n.tick.bandSize;if(void 0!==s)return s;{const t=o?o.get("range"):void 0;if(t&&c4(t)&&be(t.step))return 3*t.step/4;return 3*$8(n.view,a)/4}}const zit={arc:{vgMark:"arc",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},A9(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),f9("x",t,{defaultPos:"mid"})),f9("y",t,{defaultPos:"mid"})),x9(t,"radius","arc")),x9(t,"theta","arc"))},area:{vgMark:"area",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign({},A9(t,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),b9("x",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===t.markDef.orient})),b9("y",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===t.markDef.orient})),E9(t))},bar:{vgMark:"rect",encodeEntry:t=>Object.assign(Object.assign(Object.assign({},A9(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),x9(t,"x","bar")),x9(t,"y","bar"))},circle:{vgMark:"symbol",encodeEntry:t=>Rit(t,"circle")},geoshape:{vgMark:"shape",encodeEntry:t=>Object.assign({},A9(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:t=>{const{encoding:e}=t,n=e.shape;return[Object.assign({type:"geoshape",projection:t.projectionName()},n&&e5(n)&&n.type===T4?{field:h5(n,{expr:"datum"})}:{})]}},image:{vgMark:"image",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign({},A9(t,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),x9(t,"x","image")),x9(t,"y","image")),r9(t,"url"))},line:{vgMark:"line",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},A9(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),f9("x",t,{defaultPos:"mid"})),f9("y",t,{defaultPos:"mid"})),c9("size",t,{vgChannel:"strokeWidth"})),E9(t))},point:{vgMark:"symbol",encodeEntry:t=>Rit(t)},rect:{vgMark:"rect",encodeEntry:t=>Object.assign(Object.assign(Object.assign({},A9(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),x9(t,"x","rect")),x9(t,"y","rect"))},rule:{vgMark:"rule",encodeEntry:t=>{const{markDef:e}=t,n=e.orient;return t.encoding.x||t.encoding.y||t.encoding.latitude||t.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},A9(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),b9("x",t,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n})),b9("y",t,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n})),c9("size",t,{vgChannel:"strokeWidth"})):{}}},square:{vgMark:"symbol",encodeEntry:t=>Rit(t,"square")},text:{vgMark:"text",encodeEntry:t=>{const{config:e,encoding:n}=t;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},A9(t,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),f9("x",t,{defaultPos:"mid"})),f9("y",t,{defaultPos:"mid"})),r9(t)),c9("size",t,{vgChannel:"fontSize"})),c9("angle",t)),S9("align",function(t,e,n){if(void 0===L5("align",t,n))return"center";return}(t.markDef,0,e))),S9("baseline",function(t,e,n){if(void 0===L5("baseline",t,n))return"middle";return}(t.markDef,0,e))),f9("radius",t,{defaultPos:null,isMidPoint:!0})),f9("theta",t,{defaultPos:null,isMidPoint:!0}))}},tick:{vgMark:"rect",encodeEntry:t=>{const{config:e,markDef:n}=t,r=n.orient,i="horizontal"===r?"width":"height",a="horizontal"===r?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},A9(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),f9("x",t,{defaultPos:"mid",vgChannel:"xc"})),f9("y",t,{defaultPos:"mid",vgChannel:"yc"})),c9("size",t,{defaultValue:Bit(t),vgChannel:i})),{[a]:$5(L5("thickness",n,e))})}},trail:{vgMark:"trail",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},A9(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),f9("x",t,{defaultPos:"mid"})),f9("y",t,{defaultPos:"mid"})),c9("size",t)),E9(t))}};function Lit(t){return $Q([k0,v0,S0],t.mark)?function(t){const e=e8(t.mark,t.encoding),n=Pit(t,{fromPrefix:e.length>0?"faceted_path_":""});return e.length>0?[{name:t.getName("pathgroup"),type:"group",from:{facet:{name:"faceted_path_"+t.requestDataName(R7),data:t.requestDataName(R7),groupby:e}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}(t):$Q([x0],t.mark)?function(t){const e=h4.some(e=>L5(e,t.markDef,t.config));if(t.stack&&!t.fieldDef("size")&&e){const[e]=Pit(t,{fromPrefix:"stack_group_"}),n=t.scaleName(t.stack.fieldChannel),r=(e={})=>t.vgField(t.stack.fieldChannel,e),i=(t,e)=>`${t}(${[r({prefix:"min",suffix:"start",expr:e}),r({prefix:"max",suffix:"start",expr:e}),r({prefix:"min",suffix:"end",expr:e}),r({prefix:"max",suffix:"end",expr:e})].map(t=>`scale('${n}',${t})`).join(",")})`;let a,o;"x"===t.stack.fieldChannel?(a=Object.assign(Object.assign({},TQ(e.encode.update,["y","yc","y2","height",...h4])),{x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}}),o={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},e.encode.update=Object.assign(Object.assign({},FQ(e.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(a=Object.assign(Object.assign({},TQ(e.encode.update,["x","xc","x2","width"])),{y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}}),o={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},e.encode.update=Object.assign(Object.assign({},FQ(e.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const n of h4){const r=P5(n,t.markDef,t.config);e.encode.update[n]?(a[n]=e.encode.update[n],delete e.encode.update[n]):r&&(a[n]=$5(r)),r&&(e.encode.update[n]={value:0})}const s=t.fieldDef(t.stack.groupbyChannel),u=h5(s)?[h5(s)]:[];((null==s?void 0:s.bin)||(null==s?void 0:s.timeUnit))&&u.push(h5(s,{binSuffix:"end"}));return a=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((n,r)=>{if(e.encode.update[r])return Object.assign(Object.assign({},n),{[r]:e.encode.update[r]});{const e=P5(r,t.markDef,t.config);return void 0!==e?Object.assign(Object.assign({},n),{[r]:$5(e)}):n}},a),a.stroke&&(a.strokeForeground={value:!0},a.strokeOffset={value:0}),[{type:"group",from:{facet:{data:t.requestDataName(R7),name:"stack_group_"+t.requestDataName(R7),groupby:u,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:a},marks:[{type:"group",encode:{update:o},marks:[e]}]}]}return Pit(t)}(t):Pit(t)}function Pit(t,e={fromPrefix:""}){const{mark:n,markDef:r,config:i}=t,a=a0(r.clip,function(t){const e=t.getScaleComponent("x"),n=t.getScaleComponent("y");return!!(e&&e.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}(t),function(t){const e=t.component.projection;return!(!e||e.isFit)||void 0}(t)),o=z5(r),s=t.encoding.key,u=function(t){const{encoding:e,stack:n,mark:r,markDef:i,config:a}=t,o=e.order;if(!(!_t(o)&&u5(o)&&MQ(o.value)||!o&&MQ(L5("order",i,a)))){if((_t(o)||e5(o))&&!n)return U5(o,{expr:"datum"});if(F0(r)){const n="horizontal"===i.orient?"y":"x",r=e[n];if(e5(r)){const e=r.sort;if(_t(e))return{field:h5(r,{prefix:n,suffix:"sort_index",expr:"datum"})};if(W6(e))return{field:h5({aggregate:K5(t.encoding)?e.op:void 0,field:e.field},{expr:"datum"})};if(q6(e)){return{field:h5(t.fieldDef(e.encoding),{expr:"datum"}),order:e.order}}return null===e?void 0:{field:h5(r,{binSuffix:t.stack&&t.stack.impute?"mid":void 0,expr:"datum"})}}}else;}}(t),c=function(t){if(!t.component.selection)return null;const e=VQ(t.component.selection).length;let n=e,r=t.parent;for(;r&&0===n;)n=VQ(r.component.selection).length,r=r.parent;return n?{interactive:e>0}:null}(t),l=L5("aria",r,i),d=zit[n].postEncodingTransform?zit[n].postEncodingTransform(t):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:t.getName("marks"),type:zit[n].vgMark},a?{clip:!0}:{}),o?{style:o}:{}),s?{key:s.field}:{}),u?{sort:u}:{}),c||{}),!1===l?{aria:l}:{}),{from:{data:e.fromPrefix+t.requestDataName(R7)},encode:{update:zit[n].encodeEntry(t)}}),d?{transform:d}:{})]}class qit extends Qrt{constructor(t,e,n,r={},i){var a,o;super(t,"unit",e,n,i,void 0,D8(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const s=M0(t.mark)?t.mark.type:t.mark;this.markDef=$it(t.mark,null!==(a=t.encoding)&&void 0!==a?a:{},i,{graticule:t.data&&$7(t.data)});const u=this.encoding=J5(null!==(o=t.encoding)&&void 0!==o?o:{},this.markDef,i);this.size=function({encoding:t,size:e}){for(const n of X1){const r=F1(n);F8(e[r])&&i5(t[n])&&(delete e[r],V3(y.stepDropped(r)))}return e}({encoding:u,size:D8(t)?Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=e7(s,u),this.specifiedScales=this.initScales(s,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegend(u),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){const{encoding:t}=this,e=this.mark===T0,n=t&&d1.some(e=>o5(t[e]));return e||n}scaleDomain(t){const e=this.specifiedScales[t];return e?e.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,e){return l2.reduce((t,n)=>{var r;const i=_5(e[n]);return i&&(t[n]=null!==(r=i.scale)&&void 0!==r?r:{}),t},{})}initAxes(t){return X1.reduce((e,n)=>{const r=t[n];if(o5(r)||"x"===n&&o5(t.x2)||"y"===n&&o5(t.y2)){const t=o5(r)?r.axis:void 0;e[n]=t?Object.assign({},t):t}return e},{})}initLegend(t){return u2.reduce((e,n)=>{const r=_5(t[n]);if(r&&function(t){switch(t){case r1:case i1:case a1:case s1:case o1:case"opacity":case"strokeWidth":case"strokeDash":return!0;case"fillOpacity":case"strokeOpacity":case"angle":return!1}}(n)){const t=r.legend;e[n]=t?Object.assign({},t):t}return e},{})}parseData(){this.component.data=Ait(this)}parseLayoutSize(){!function(t){const{size:e,component:n}=t;for(const r of X1){const i=F1(r);if(e[i]){const t=e[i];n.layoutSize.set(i,F8(t)?"step":t,!0)}else{const e=xit(t,i);n.layoutSize.set(i,e,!1)}}}(this)}parseSelections(){this.component.selection=function(t,e){var n;const r={},i=t.config.selection;for(const a of VQ(null!=e?e:{})){const o=NQ(e[a]),s=i[o.type],{fields:u,encodings:c}=s,l=w(s,["fields","encodings"]);for(const t in l)"encodings"===t&&o.fields||"fields"===t&&o.encodings||("mark"===t&&(o[t]=Object.assign(Object.assign({},l[t]),o[t])),void 0!==o[t]&&!0!==o[t]||(o[t]=null!==(n=l[t])&&void 0!==n?n:o[t]));const d=KQ(a),f=r[d]=Object.assign(Object.assign({},o),{name:d,events:ve(o.on)?OY(o.on,"scope"):NQ(o.on)});H9(f,n=>{n.has(f)&&n.parse&&n.parse(t,f,o,e[a])})}return r}(this,this.selection)}parseMarkGroup(){this.component.mark=Lit(this)}parseAxesAndHeaders(){var t;this.component.axes=(t=this,X1.reduce((e,n)=>(t.component.scales[n]&&(e[n]=[Mit(n,t)]),e),{}))}assembleSelectionTopLevelSignals(t){return function(t,e){let n=!1;if(utt(t,(r,i)=>{const a=r.name,o=Ee(a+rtt);if(0===e.filter(t=>t.name===a).length){const t="global"===r.resolve?"union":r.resolve,n="multi"===r.type?", true)":")";e.push({name:r.name,update:`${ott}(${o}, ${Ee(t)}${n}`})}n=!0,i.topLevelSignals&&(e=i.topLevelSignals(t,r,e)),H9(r,n=>{n.topLevelSignals&&(e=n.topLevelSignals(t,r,e))})}),n){0===e.filter(t=>"unit"===t.name).length&&e.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})}return Y9(e)}(this,t)}assembleSignals(){return[...Aet(this),...(t=this,e=[],utt(t,(n,r)=>{const i=n.name;let a=r.modifyExpr(t,n);e.push(...r.signals(t,n)),H9(n,r=>{r.signals&&(e=r.signals(t,n,e)),r.modifyExpr&&(a=r.modifyExpr(t,n,a))}),e.push({name:i+att,on:[{events:{signal:n.name+itt},update:`modify(${Ee(n.name+rtt)}, ${a})`}]})}),Y9(e))];var t,e}assembleSelectionData(t){return function(t,e){const n=[...e];return utt(t,e=>{const r={name:e.name+rtt};if(e.init){const n=e.project.items.map(t=>{const{signals:e}=t;return w(t,["signals"])}),i=e.init.map(t=>X9(t,!1));r.values="interval"===e.type?[{unit:ctt(t,{escape:!1}),fields:n,values:i}]:i.map(e=>({unit:ctt(t,{escape:!1}),fields:n,values:e}))}n.filter(t=>t.name===e.name+rtt).length||n.push(r)}),n}(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return rnt(this)}assembleMarks(){var t;let e=null!==(t=this.component.mark)&&void 0!==t?t:[];return this.parent&&Jrt(this.parent)||(e=K9(this,e)),e.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return X5(this.encoding,t)}fieldDef(t){return O5(this.encoding[t])}typedFieldDef(t){const e=this.fieldDef(t);return s5(e)?e:null}}class Wit extends Zrt{constructor(t,e,n,r,i){super(t,"layer",e,n,i,t.resolve,t.view);const a=Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((t,e)=>{if(K8(t))return new Wit(t,this,this.getName("layer_"+e),a,i);if(P0(t))return new qit(t,this,this.getName("layer_"+e),a,i);throw new Error(y.invalidSpec(t))})}parseData(){this.component.data=Ait(this);for(const t of this.children)t.parseData()}parseLayoutSize(){var t;yit(t=this),vit(t,"width"),vit(t,"height")}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of VQ(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){!function(t){var e;const{axes:n,resolve:r}=t.component,i={top:0,bottom:0,right:0,left:0};for(const e of t.children){e.parseAxesAndHeaders();for(const i of VQ(e.component.axes))r.axis[i]=lnt(t.component.resolve,i),"shared"===r.axis[i]&&(n[i]=Tit(n[i],e.component.axes[i]),n[i]||(r.axis[i]="independent",delete n[i]))}for(const a of X1){for(const o of t.children)if(o.component.axes[a]){if("independent"===r.axis[a]){n[a]=(null!==(e=n[a])&&void 0!==e?e:[]).concat(o.component.axes[a]);for(const t of o.component.axes[a]){const{value:e,explicit:n}=t.getWithExplicit("orient");if(!u4(e)){if(i[e]>0&&!n){const n=Nit[e];i[e]>i[n]&&t.set("orient",n,!1)}i[e]++}}}delete o.component.axes[a]}if("independent"===r.axis[a]&&n[a]&&n[a].length>1)for(const t of n[a])t.get("grid")&&!t.explicit.grid&&(t.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((t,e)=>e.assembleSelectionTopLevelSignals(t),t)}assembleSignals(){return this.children.reduce((t,e)=>t.concat(e.assembleSignals()),Aet(this))}assembleLayoutSignals(){return this.children.reduce((t,e)=>t.concat(e.assembleLayoutSignals()),rnt(this))}assembleSelectionData(t){return this.children.reduce((t,e)=>e.assembleSelectionData(t),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const e of this.children)if(t=e.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return function(t,e){for(const n of t.children)Xrt(n)&&(e=K9(n,e));return e}(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,e)=>t.concat(e.assembleLegends()),jnt(this))}}function Uit(t,e,n,r,i){if(H6(t))return new kit(t,e,n,i);if(K8(t))return new Wit(t,e,n,r,i);if(P0(t))return new qit(t,e,n,r,i);if(function(t){return N8(t)||T8(t)||j8(t)}(t))return new Cit(t,e,n,i);throw new Error(y.invalidSpec(t))}function Vit(t,e={}){var n;e.logger&&(n=e.logger,W3=n),e.fieldTitle&&y5(e.fieldTitle);try{const n=W8(Et(e.config,t.config)),r=y7(t,n),i=Uit(r,null,"",void 0,n);i.parse(),function(t,e){Lnt(t.sources);let n=0,r=0;for(let r=0;r<5&&xrt(t,e);r++)n++;t.sources.map(crt);for(let n=0;n<5&&xrt(t,e);n++)r++;Lnt(t.sources),5===Math.max(n,r)&&V3("Maximum optimization runs(5) reached.")}(i.component.data,i);return{spec:function(t,e,n={},r){const i=t.config?H8(t.config):void 0,a=[].concat(t.assembleSelectionData([]),function(t,e){var n,r;const i=[],a=hit(i);let o=0;for(const e of t.sources){e.hasName()||(e.dataName="source_"+o++);const t=e.assemble();a(e,t)}for(const t of i)0===t.transform.length&&delete t.transform;let s=0;for(const[t,e]of i.entries())0!==(null!==(n=e.transform)&&void 0!==n?n:[]).length||e.source||i.splice(s++,0,i.splice(t,1)[0]);for(const e of i)for(const n of null!==(r=e.transform)&&void 0!==r?r:[])"lookup"===n.type&&(n.from=t.outputNodes[n.from].getSource());for(const t of i)t.name in e&&(t.values=e[t.name]);return i}(t.component.data,n)),o=t.assembleProjections(),s=t.assembleTitle(),u=t.assembleGroupStyle(),c=t.assembleGroupEncodeEntry(!0);let l=t.assembleLayoutSignals();return l=l.filter(t=>"width"!==t.name&&"height"!==t.name||void 0===t.value||(e[t.name]=+t.value,!1)),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},t.description?{description:t.description}:{}),e),s?{title:s}:{}),u?{style:u}:{}),c?{encode:{update:c}}:{}),{data:a}),o.length>0?{projections:o}:{}),t.assembleGroup([...l,...t.assembleSelectionTopLevelSignals([])])),i?{config:i}:{}),r?{usermeta:r}:{})}(i,function(t,e,n,r){const i=r.component.layoutSize.get("width"),a=r.component.layoutSize.get("height");void 0===e?(e={type:"pad"},r.hasAxisOrientSignalRef()&&(e.resize=!0)):ve(e)&&(e={type:e});if(i&&a&&(o=e.type,"fit"===o||"fit-x"===o||"fit-y"===o))if("step"===i&&"step"===a)V3(y.droppingFit()),e.type="pad";else if("step"===i||"step"===a){const t="step"===i?"width":"height";V3(y.droppingFit(Z1(t)));const n="width"===t?"height":"width";e.type=function(t){return t?"fit-"+Z1(t):"fit"}(n)}var o;return Object.assign(Object.assign(Object.assign({},1===VQ(e).length&&e.type?"pad"===e.type?{}:{autosize:e.type}:{autosize:e}),k7(n)),k7(t))}(t,r.autosize,n,i),t.datasets,t.usermeta),normalized:r}}finally{e.logger&&U3(),e.fieldTitle&&y5(g5)}}const Git=new class extends Y8{mapUnit(t,{config:e}){if(t.encoding){const{encoding:n,transform:r}=t,{bins:i,timeUnits:a,aggregate:o,groupby:s,encoding:u}=Y5(n,e),c=[...r||[],...i,...a,...0===o.length?[]:[{aggregate:o,groupby:s}]];return Object.assign(Object.assign(Object.assign({},t),c.length>0?{transform:c}:{}),{encoding:u})}return t}};function Hit(t,e){return Git.map(t,{config:e})}const Xit=yQ.version;var Kit=n(230),Yit=n.n(Kit);const Jit={background:"#333",title:{color:"#fff"},style:{"guide-label":{fill:"#fff"},"guide-title":{fill:"#fff"}},axis:{domainColor:"#fff",gridColor:"#888",tickColor:"#fff"}},Zit={background:"#fff",arc:{fill:"#4572a7"},area:{fill:"#4572a7"},line:{stroke:"#4572a7",strokeWidth:2},path:{stroke:"#4572a7"},rect:{fill:"#4572a7"},shape:{stroke:"#4572a7"},symbol:{fill:"#4572a7",strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Qit={arc:{fill:"#30a2da"},area:{fill:"#30a2da"},axis:{domainColor:"#cbcbcb",grid:!0,gridColor:"#cbcbcb",gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:"#cbcbcb",tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:"#f0f0f0",group:{fill:"#f0f0f0"},legend:{labelColor:"#333",labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:"#333",titleFontSize:14,titlePadding:10},line:{stroke:"#30a2da",strokeWidth:2},path:{stroke:"#30a2da",strokeWidth:.5},rect:{fill:"#30a2da"},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:"#30a2da"},bar:{binSpacing:2,fill:"#30a2da",stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},tat={group:{fill:"#e5e5e5"},arc:{fill:"#000"},area:{fill:"#000"},line:{stroke:"#000"},path:{stroke:"#000"},rect:{fill:"#000"},shape:{stroke:"#000"},symbol:{fill:"#000",size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},eat="Benton Gothic Bold, sans-serif",nat={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},rat={background:"#ffffff",title:{anchor:"start",color:"#000000",font:eat,fontSize:22,fontWeight:"normal"},arc:{fill:"#82c6df"},area:{fill:"#82c6df"},line:{stroke:"#82c6df",strokeWidth:2},path:{stroke:"#82c6df"},rect:{fill:"#82c6df"},shape:{stroke:"#82c6df"},symbol:{fill:"#82c6df",size:30},axis:{labelFont:"Benton Gothic, sans-serif",labelFontSize:11.5,labelFontWeight:"normal",titleFont:eat,titleFontSize:13,titleFontWeight:"normal"},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:"Benton Gothic, sans-serif",labelFontSize:11.5,symbolType:"square",titleFont:eat,titleFontSize:13,titleFontWeight:"normal"},range:{category:nat["category-6"],diverging:nat["fireandice-6"],heatmap:nat["fire-7"],ordinal:nat["fire-7"],ramp:nat["fire-7"]}},iat={background:"#f9f9f9",arc:{fill:"#ab5787"},area:{fill:"#ab5787"},line:{stroke:"#ab5787"},path:{stroke:"#ab5787"},rect:{fill:"#ab5787"},shape:{stroke:"#ab5787"},symbol:{fill:"#ab5787",size:30},axis:{domainColor:"#979797",domainWidth:.5,gridWidth:.2,labelColor:"#979797",tickColor:"#979797",tickWidth:.2,titleColor:"#979797"},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},aat={background:"#fff",arc:{fill:"#3e5c69"},area:{fill:"#3e5c69"},line:{stroke:"#3e5c69"},path:{stroke:"#3e5c69"},rect:{fill:"#3e5c69"},shape:{stroke:"#3e5c69"},symbol:{fill:"#3e5c69"},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},oat={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},sat={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:"Lato"},axisX:{domain:!0,domainColor:"#000000",domainWidth:1,grid:!1,labelFontSize:12,labelFont:"Lato",labelAngle:0,tickColor:"#000000",tickSize:5,titleFontSize:12,titlePadding:10,titleFont:"Lato"},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:"Lato",labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:"Lato",titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:"Lato",symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:"Lato",orient:"right",offset:10},view:{stroke:"transparent"},range:{category:oat["six-groups-cat-1"],diverging:oat["diverging-colors"],heatmap:oat["diverging-colors"],ordinal:oat["six-groups-seq"],ramp:oat["shades-blue"]},area:{fill:"#1696d2"},rect:{fill:"#1696d2"},line:{color:"#1696d2",stroke:"#1696d2",strokeWidth:5},trail:{color:"#1696d2",stroke:"#1696d2",strokeWidth:0,size:1},path:{stroke:"#1696d2",strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:"#1696d2",fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:"#1696d2",stroke:null}},arc:{fill:"#1696d2"},shape:{stroke:"#1696d2"},symbol:{fill:"#1696d2",size:30}},uat={arc:{fill:"#3366CC"},area:{fill:"#3366CC"},path:{stroke:"#3366CC"},rect:{fill:"#3366CC"},shape:{stroke:"#3366CC"},symbol:{stroke:"#3366CC"},circle:{fill:"#3366CC"},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:"Arial, sans-serif",fontSize:12},"guide-title":{font:"Arial, sans-serif",fontSize:12},"group-title":{font:"Arial, sans-serif",fontSize:12}},title:{font:"Arial, sans-serif",fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:"#ccc",tickColor:"#ccc",domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},cat="2.9.1";var lat=n(319),dat="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n";const fat="vg-tooltip-element",hat={offsetX:10,offsetY:10,id:fat,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};var pat=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function mat(t,e){return JSON.stringify(t,function(t){const e=[];return function(n,r){if("object"!=typeof r||null===r)return r;const i=e.indexOf(this)+1;return e.length=i,e.length>t?"[Object]":e.indexOf(r)>=0?"[Circular]":(e.push(r),r)}}(e))}class gat{constructor(t){this.options=Object.assign(Object.assign({},hat),t);const e=this.options.id;if(this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const t=document.createElement("style");t.setAttribute("id",this.options.styleId),t.innerHTML=function(t){if(!/^[A-Za-z]+[-:.\w]*$/.test(t))throw new Error("Invalid HTML ID");return dat.toString().replace(fat,t)}(e);const n=document.head;n.childNodes.length>0?n.insertBefore(t,n.childNodes[0]):n.appendChild(t)}this.el=document.getElementById(e),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",e),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el))}tooltipHandler(t,e,n,r){if(null==r||""===r)return void this.el.classList.remove("visible",this.options.theme+"-theme");this.el.innerHTML=function(t,e,n){if(_t(t))return`[${t.map(t=>e(ve(t)?t:mat(t,n))).join(", ")}]`;if(At(t)){let r="";const i=t,{title:a,image:o}=i,s=pat(i,["title","image"]);a&&(r+=`<h2>${e(a)}</h2>`),o&&(r+=`<img src="${e(o)}">`);const u=Object.keys(s);if(u.length>0){r+="<table>";for(const t of u){let i=s[t];void 0!==i&&(At(i)&&(i=mat(i,n)),r+=`<tr><td class="key">${e(t)}:</td><td class="value">${e(i)}</td></tr>`)}r+="</table>"}return r||"{}"}return e(t)}(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",this.options.theme+"-theme");const{x:i,y:a}=function(t,e,n,r){let i=t.clientX+n;i+e.width>window.innerWidth&&(i=+t.clientX-n-e.width);let a=t.clientY+r;return a+e.height>window.innerHeight&&(a=+t.clientY-r-e.height),{x:i,y:a}}(e,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${a}px; left: ${i}px`)}}lat.version;var bat,yat='.vega-embed {\n  position: relative;\n  display: inline-block; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: scroll;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n';function vat(t,...e){for(const n of e)xat(t,n);return t}function xat(t,e){for(const n of Object.keys(e))St(t,n,e[n],!0)}String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t}),n.d(e,"vega",(function(){return wat})),n.d(e,"vegaLite",(function(){return kat})),n.d(e,"DEFAULT_ACTIONS",(function(){return _at})),n.d(e,"guessMode",(function(){return Nat})),n.d(e,"default",(function(){return Tat}));const wat=b;let kat=v;const Oat="undefined"!=typeof window?window:void 0;void 0===kat&&(null===(bat=null==Oat?void 0:Oat.vl)||void 0===bat?void 0:bat.compile)&&(kat=Oat.vl);const _at={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},Aat={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Cat={vega:"Vega","vega-lite":"Vega-Lite"},Eat={vega:wat.version,"vega-lite":kat?kat.version:"not available"},Sat={vega:t=>t,"vega-lite":(t,e)=>kat.compile(t,{config:e}).spec};function jat(t,e,n,r){const i=`<html><head>${e}</head><body><pre><code class="json">`,a=`</code></pre>${n}</body></html>`,o=window.open("");o.document.write(i+t+a),o.document.title=Cat[r]+" JSON Source"}function Nat(t,e){var n;if(t.$schema){const r=Yit()(t.$schema);e&&e!==r.library&&console.warn(`The given visualization spec is written in ${Cat[r.library]}, but mode argument sets ${null!==(n=Cat[e])&&void 0!==n?n:e}.`);const i=r.library;return Object(tt.satisfies)(Eat[i],"^"+r.version.slice(1))||console.warn(`The input spec uses ${Cat[i]} ${r.version}, but the current version of ${Cat[i]} is v${Eat[i]}.`),i}return"mark"in t||"encoding"in t||"layer"in t||"hconcat"in t||"vconcat"in t||"facet"in t||"repeat"in t?"vega-lite":"marks"in t||"signals"in t||"scales"in t||"axes"in t?"vega":null!=e?e:"vega"}function Tat(t,e,n={}){var r,i,a;return k(this,void 0,void 0,(function*(){const o=(s=n.loader)&&"load"in s?n.loader:wat.loader(n.loader);var s;const u=ve(e)?JSON.parse(yield o.load(e)):e,c=yield Fat(null!==(r=u.usermeta&&u.usermeta.embedOptions)&&void 0!==r?r:{},o),l=yield Fat(n,o),d=Object.assign(Object.assign({},vat(l,c)),{config:Et(null!==(i=l.config)&&void 0!==i?i:{},null!==(a=c.config)&&void 0!==a?a:{})});return yield function(t,e,n={},r){var i,a,o,s,u,c;return k(this,void 0,void 0,(function*(){const l=n.theme?Et(x[n.theme],null!==(i=n.config)&&void 0!==i?i:{}):n.config,d=me(n.actions)?n.actions:vat({},_at,null!==(a=n.actions)&&void 0!==a?a:{}),f=Object.assign(Object.assign({},Aat),n.i18n),h=null!==(o=n.renderer)&&void 0!==o?o:"canvas",p=null!==(s=n.logLevel)&&void 0!==s?s:wat.Warn,m=null!==(u=n.downloadFileName)&&void 0!==u?u:"visualization";if(!1!==n.defaultStyle){const t="vega-embed-style";if(!document.getElementById(t)){const e=document.createElement("style");e.id=t,e.innerText=void 0===n.defaultStyle||!0===n.defaultStyle?yat.toString():n.defaultStyle,document.head.appendChild(e)}}const g=Nat(e,n.mode);let b=Sat[g](e,l);if("vega-lite"===g&&b.$schema){const t=Yit()(b.$schema);Object(tt.satisfies)(Eat.vega,"^"+t.version.slice(1))||console.warn(`The compiled spec uses Vega ${t.version}, but current version is v${Eat.vega}.`)}const y="string"==typeof t?document.querySelector(t):t;if(!y)throw Error(t+" does not exist");y.classList.add("vega-embed"),d&&y.classList.add("has-actions"),y.innerHTML="";const v=n.patch;v&&(b=v instanceof Function?v(b):z(b,v,!0,!1).newDocument),n.formatLocale&&wat.formatLocale(n.formatLocale),n.timeFormatLocale&&wat.timeFormatLocale(n.timeFormatLocale);const w=wat.parse(b,"vega-lite"===g?{}:l),O=new wat.View(w,{loader:r,logLevel:p,renderer:h});if(!1!==n.tooltip){let t;t="function"==typeof n.tooltip?n.tooltip:new gat(!0===n.tooltip?{}:n.tooltip).call,O.tooltip(t)}let _,{hover:A}=n;if(void 0===A&&(A="vega"===g),A){const{hoverSet:t,updateSet:e}="boolean"==typeof A?{}:A;O.hover(t,e)}if(n&&(null!=n.width&&O.width(n.width),null!=n.height&&O.height(n.height),null!=n.padding&&O.padding(n.padding)),yield O.initialize(t).runAsync(),!1!==d){let t=y;if(!1!==n.defaultStyle){const e=document.createElement("details");e.title=f.CLICK_TO_VIEW_ACTIONS,y.append(e),t=e;const n=document.createElement("summary");n.innerHTML='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',e.append(n),_=t=>{e.contains(t.target)||e.removeAttribute("open")},document.addEventListener("click",_)}const r=document.createElement("div");if(t.append(r),r.classList.add("vega-actions"),!0===d||!1!==d.export)for(const t of["svg","png"])if(!0===d||!0===d.export||d.export[t]){const e=f[t.toUpperCase()+"_ACTION"],i=document.createElement("a");i.text=e,i.href="#",i.target="_blank",i.download=`${m}.${t}`,i.addEventListener("mousedown",(function(e){return k(this,void 0,void 0,(function*(){e.preventDefault();const r=yield O.toImageURL(t,n.scaleFactor);this.href=r}))})),r.append(i)}if(!0===d||!1!==d.source){const t=document.createElement("a");t.text=f.SOURCE_ACTION,t.href="#",t.addEventListener("click",(function(t){var r,i;jat(Q()(e),null!==(r=n.sourceHeader)&&void 0!==r?r:"",null!==(i=n.sourceFooter)&&void 0!==i?i:"",g),t.preventDefault()})),r.append(t)}if("vega-lite"===g&&(!0===d||!1!==d.compiled)){const t=document.createElement("a");t.text=f.COMPILED_ACTION,t.href="#",t.addEventListener("click",(function(t){var e,r;jat(Q()(b),null!==(e=n.sourceHeader)&&void 0!==e?e:"",null!==(r=n.sourceFooter)&&void 0!==r?r:"","vega"),t.preventDefault()})),r.append(t)}if(!0===d||!1!==d.editor){const t=null!==(c=n.editorUrl)&&void 0!==c?c:"https://vega.github.io/editor/",i=document.createElement("a");i.text=f.EDITOR_ACTION,i.href="#",i.addEventListener("click",(function(n){!function(t,e,n){const r=t.open(e),{origin:i}=new URL(e);let a=40;t.addEventListener("message",(function e(n){n.source===r&&(a=0,t.removeEventListener("message",e,!1))}),!1),setTimeout((function t(){a<=0||(r.postMessage(n,i),setTimeout(t,250),a-=1)}),250)}(window,t,{config:l,mode:g,renderer:h,spec:Q()(e)}),n.preventDefault()})),r.append(i)}}return{view:O,spec:e,vgSpec:b,finalize:function(){_&&document.removeEventListener("click",_),O.finalize()}}}))}(t,u,d,o)}))}function Fat(t,e){var n;return k(this,void 0,void 0,(function*(){const r=ve(t.config)?JSON.parse(yield e.load(t.config)):null!==(n=t.config)&&void 0!==n?n:{},i=ve(t.patch)?JSON.parse(yield e.load(t.patch)):t.patch;return Object.assign(Object.assign(Object.assign({},t),i?{patch:i}:{}),r?{config:r}:{})}))}},function(t,e,n){"use strict";n.r(e),n.d(e,"validateUpdateShape",(function(){return i})),n.d(e,"validateInput",(function(){return a})),n.d(e,"calculateShapes",(function(){return o}));var r=n(7);function i(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+`, indices.shape: ${e.shape}, shape: ${t}`+`, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(a+` update.rank < ${i}. `);if(t.length<r+(n.rank-i))throw new Error(a+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(a+" update.rank != "+(i+t.length-r));for(let t=0;t<i;++t)if(n.shape[t]!==e.shape[t])throw new Error(a+` updates.shape[${t}] (${n.shape[t]}) != indices.shape[${t}] (${e.shape[t]}).`);for(let e=0;e<n.rank-i;++e)if(n.shape[e+i]!==t[e+r])throw new Error(a+` updates.shape[${e+i}] (${n.shape[e+i]}) != shape[${e+i}] (${t[e+i]})`)}function a(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}i(n,e,t)}function o(t,e,n){const i=e.shape.length,a=i>1?e.shape[i-1]:1,o=n.length;let s=1;for(let t=a;t<o;++t)s*=n[t];const u=a<1?1:a;return{sliceRank:a,numUpdates:Object(r.N)(e.shape)/u,sliceSize:s,strides:[...Object(r.j)(n.slice(0,a)),1],outputSize:Object(r.N)(n)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(4);const u=Object(s.b)({floorDiv_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","floorDiv"),s=Object(o.a)(e,"b","floorDiv");[n,s]=Object(a.makeTypesMatch)(n,s);const u={a:n,b:s};return r.a.runKernel(i.gb,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(5),i=n(3);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function a(t,e,n){const a={shape:t,value:e,dtype:n};return r.a.runKernel(i.db,{},a)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(11),u=n(27),c=n(4),l=n(8);const d=Object(c.b)({avgPool_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,c,d){const f=Object(a.a)(t,"x","avgPool","float32");o.b(u.h(n,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`);let h=f,p=!1;3===f.rank&&(p=!0,h=Object(l.a)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.b(4===h.rank,()=>`Error in avgPool: x must be rank 4 but got rank ${h.rank}.`),null!=d&&o.b(o.v(c),()=>`Error in avgPool: pad must be an integer when using, dimRoundingMode ${d} but got pad ${c}.`);const m={x:h},g={filterSize:e,strides:n,pad:c,dimRoundingMode:d};let b=r.a.runKernel(i.o,m,g);return b=Object(s.a)(b,f.dtype),p?Object(l.a)(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({cos_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","cos")};return r.a.runKernel(i.I,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({cumsum_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=0,n=!1,o=!1){const s={x:Object(a.a)(t,"x","cumsum")},u={axis:e,exclusive:n,reverse:o};return r.a.runKernel(i.L,s,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({elu_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","elu")};return r.a.runKernel(i.V,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({floor_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","floor")};return r.a.runKernel(i.fb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({imag_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={input:Object(a.a)(t,"input","imag")};return r.a.runKernel(i.rb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({leakyRelu_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=.2){const n={x:Object(a.a)(t,"x","leakyRelu")},o={alpha:e};return r.a.runKernel(i.xb,n,o)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n(1),i=n(7),a=n(12),o=n(38),s=n(40),u=n(72),c=n(66),l=n(4),d=n(8),f=n(13),h=n(18);const p=Object(l.b)({logSumExp_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=null,n=!1){const l=Object(r.a)(t,"x","logSumExp"),p=Object(i.I)(e,l.shape),m=Object(c.a)(l,p,!0),g=Object(f.a)(l,m),b=Object(s.a)(g),y=Object(h.a)(b,p),v=Object(u.a)(y),x=Object(a.a)(Object(d.a)(m,v.shape),v);if(n){const t=Object(o.e)(x.shape,p);return Object(d.a)(x,t)}return x}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(16),s=n(4);const u=Object(s.b)({logicalOr_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const n=Object(a.a)(t,"a","logicalOr","bool"),s=Object(a.a)(e,"b","logicalOr","bool");Object(o.a)(n.shape,s.shape);const u={a:n,b:s};return r.a.runKernel(i.Gb,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(27),u=n(4),c=n(8);const l=Object(u.b)({maxPool_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,u,l){const d=Object(a.a)(t,"x","maxPool");let f=d,h=!1;3===d.rank&&(h=!0,f=Object(c.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),o.b(4===f.rank,()=>`Error in maxPool: input must be rank 4 but got rank ${f.rank}.`),o.b(s.h(n,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`),null!=l&&o.b(o.v(u),()=>`Error in maxPool: pad must be an integer when using, dimRoundingMode ${l} but got pad ${u}.`);const p={x:f},m={filterSize:e,strides:n,pad:u,dimRoundingMode:l},g=r.a.runKernel(i.Ib,p,m);return h?Object(c.a)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(4);const u=Object(s.b)({mod_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","mod"),s=Object(o.a)(e,"b","mod");[n,s]=Object(a.makeTypesMatch)(n,s);const u={a:n,b:s};return r.a.runKernel(i.Sb,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({prelu_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const n={x:Object(a.a)(t,"x","prelu"),alpha:Object(a.a)(e,"alpha","prelu")};return r.a.runKernel(i.gc,n)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({relu6_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","relu6")};return r.a.runKernel(i.nc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(7),o=n(4);const s=Object(o.b)({fft_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){Object(a.b)("complex64"===t.dtype,()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return r.a.runKernel(i.cb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var r=n(7),i=n(57),a=n(31),o=n(130),s=n(4),u=n(112),c=n(8),l=n(25),d=n(73),f=n(64),h=n(21),p=n(138);const m=Object(s.b)({rfft_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){Object(r.b)("float32"===t.dtype,()=>"The dtype for rfft() must be real value but got "+t.dtype);let n=t.shape[t.shape.length-1];const s=t.size/n;let m;if(null!=e&&e<n){const r=t.shape.map(t=>0),i=t.shape.map(t=>t);i[t.shape.length-1]=e,m=Object(l.a)(t,r,i),n=e}else if(null!=e&&e>n){const r=t.shape.map(t=>t);r[t.shape.length-1]=e-n,m=Object(a.a)([t,Object(f.a)(r)],t.shape.length-1),n=e}else m=t;const g=Object(h.a)(m),b=Object(c.a)(Object(i.a)(m,g),[s,n]),y=Object(p.a)(b),v=Math.floor(n/2)+1,x=Object(u.a)(y),w=Object(o.a)(y),k=Object(d.a)(x,[v,n-v],x.shape.length-1),O=Object(d.a)(w,[v,n-v],w.shape.length-1),_=m.shape.slice();return _[m.shape.length-1]=v,Object(c.a)(Object(i.a)(k[0],O[0]),_)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({unsortedSegmentSum_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n){const s=Object(a.a)(t,"x","unsortedSegmentSum"),u=Object(a.a)(e,"segmentIds","unsortedSegmentSum","int32");Object(o.b)(Object(o.v)(n),()=>"numSegments must be of dtype int");const c={x:s,segmentIds:u},l={numSegments:n};return r.a.runKernel(i.Yc,c,l)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n(1),i=n(7),a=n(42),o=n(38),s=n(66),u=n(110),c=n(4),l=n(47),d=n(8),f=n(15),h=n(37),p=n(24),m=n(18);const g=Object(c.b)({norm_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e="euclidean",n=null,c=!1){const g=function t(e,n,r=null){if(0===e.rank)return Object(a.a)(e);if(1!==e.rank&&null===r)return t(Object(d.a)(e,[-1]),n,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return Object(m.a)(Object(a.a)(e),r);if(n===1/0)return Object(s.a)(Object(a.a)(e),r);if(n===-1/0)return Object(u.a)(Object(a.a)(e),r);if("euclidean"===n||2===n)return Object(h.a)(Object(m.a)(Object(l.a)(Object(a.a)(e),Object(f.a)(2,"int32")),r));throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return Object(s.a)(Object(m.a)(Object(a.a)(e),r[0]),r[1]-1);if(n===1/0)return Object(s.a)(Object(m.a)(Object(a.a)(e),r[1]),r[0]);if(n===-1/0)return Object(u.a)(Object(m.a)(Object(a.a)(e),r[1]),r[0]);if("fro"===n||"euclidean"===n)return Object(h.a)(Object(m.a)(Object(p.a)(e),r));throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(t=Object(r.a)(t,"x","norm"),e,n);let b=g.shape;if(c){const e=Object(i.I)(n,t.shape);b=o.e(g.shape,e)}return Object(d.a)(g,b)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(7),o=n(4),s=n(8);const u=Object(o.b)({conv2DBackpropInput_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,o,u,c="NHWC",l){a.b(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let d=t,f=e,h=!1;3===e.rank&&(h=!0,f=Object(s.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]),d=[1,t[0],t[1],t[2]]),a.b(4===d.length,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+d.length+"."),a.b(4===f.rank,()=>"Error in conv2dDerInput: dy must be rank 4, but got rank "+f.rank),a.b(4===n.rank,()=>"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank);const p="NHWC"===c?d[3]:d[1],m="NHWC"===c?f.shape[3]:f.shape[1];a.b(p===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${p}) must match input depth for filter ${n.shape[2]}.`),a.b(m===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${m}) must match output depth for filter ${n.shape[3]}.`),null!=l&&a.b(a.v(u),()=>`Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode ${l} but got pad ${u}.`);const g={dy:f,filter:n},b={strides:o,pad:u,dataFormat:c,dimRoundingMode:l,inputShape:d},y=r.a.runKernel(i.E,g,b);return h?Object(s.a)(y,[y.shape[1],y.shape[2],y.shape[3]]):y}})},function(t,e,n){"use strict";n.r(e),n.d(e,"TEST_EPSILON_FLOAT16",(function(){return s})),n.d(e,"expectArraysClose",(function(){return u})),n.d(e,"testEpsilon",(function(){return c})),n.d(e,"expectPromiseToFail",(function(){return d})),n.d(e,"expectArraysEqual",(function(){return f})),n.d(e,"expectNumbersClose",(function(){return h})),n.d(e,"expectValuesInRange",(function(){return m})),n.d(e,"expectArrayBuffersEqual",(function(){return g})),n.d(e,"encodeStrings",(function(){return b}));var r=n(5),i=n(1),a=n(7),o=n(10);
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const s=.1;function u(t,e,n){return null==n&&(n=c()),l(t,e,(t,e)=>p(t,e,n))}function c(){return 32===r.a.backend.floatPrecision()?.001:s}function l(t,e,n){let r=!0;if((Object(a.A)(t)||Object(a.A)(e))&&(r=!1),Object(a.A)(t)&&Object(a.A)(e)&&(r=!0),r){const n=t.constructor.name,r=e.constructor.name;if(n!==r)throw new Error(`Arrays are of different type. Actual: ${n}. Expected: `+r)}if(Array.isArray(t)&&Array.isArray(e)){const n=Object(i.c)(t),r=Object(i.c)(e);if(!Object(a.a)(n,r))throw new Error(`Arrays have different shapes. Actual: [${n}]. Expected: [${r}]`)}const o=Object(a.A)(t)?t:Object(a.m)(t),s=Object(a.A)(e)?e:Object(a.m)(e);if(o.length!==s.length)throw new Error(`Arrays have different lengths actual: ${o.length} vs expected: ${s.length}.\nActual:   ${o}.\nExpected: ${s}.`);for(let t=0;t<s.length;++t){const e=o[t],r=s[t];if(!n(e,r))throw new Error(`Arrays differ: actual[${t}] = ${e}, expected[${t}] = ${r}.\nActual:   ${o}.\nExpected: ${s}.`)}}function d(t,e){t().then(()=>e.fail(),()=>e())}function f(t,e){const n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return Object(a.z)(t)||Object(a.z)(t[0])||Object(a.z)(e)||Object(a.z)(e[0])?l(t,n,(t,e)=>t==e):l(t,e,(t,e)=>p(t,e,0))}function h(t,e,n){if(null==n&&(n=c()),!p(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`)}function p(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function m(t,e,n){for(let r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error(`Value out of range:${t[r]} low: ${e}, high: ${n}`)}function g(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}function b(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?b(n):t[e]=Object(o.encodeString)(n)}return t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(7),o=n(4),s=n(8);const u=Object(o.b)({conv2DBackpropFilter_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,o,u,c="NHWC",l){let d=t;3===t.rank&&(d=Object(s.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let f=e;3===f.rank&&(f=Object(s.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]])),a.b(4===d.rank,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+d.shape+"."),a.b(4===f.rank,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+f.shape+"."),a.b(4===n.length,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+".");const h="NHWC"===c?d.shape[3]:d.shape[1],p="NHWC"===c?f.shape[3]:f.shape[1];a.b(h===n[2],()=>`Error in conv2dDerFilter: depth of input ${h}) must match input depth in filter (${n[2]}.`),a.b(p===n[3],()=>`Error in conv2dDerFilter: depth of dy (${p}) must match output depth for filter (${n[3]}).`),null!=l&&a.b(a.v(u),()=>`Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode ${l} but got pad ${u}.`);const m={x:d,dy:f},g={strides:o,pad:u,dataFormat:c,dimRoundingMode:l,filterShape:n};return r.a.runKernel(i.D,m,g)}})},function(t,e,n){"use strict";e.a=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}},,,function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if((n=r[i])===e||n.fn===e){r.splice(i,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,e);return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,n){"use strict";(function(t){n(5);var e=n(173),r=n(23);
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=Object(r.c)();i.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),i.registerFlag("IS_BROWSER",()=>e.isBrowser()),i.registerFlag("IS_NODE",()=>void 0!==t&&void 0!==t.versions&&void 0!==t.versions.node),i.registerFlag("IS_CHROME",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),i.registerFlag("PROD",()=>!1),i.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>i.getBool("DEBUG")),i.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),i.registerFlag("IS_TEST",()=>!1),i.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0)}).call(this,n(93))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.compose=e.merge=e.$=e.style=e.presets=e.keyframes=e.fontFace=e.insertGlobal=e.insertRule=e.plugins=e.styleSheet=void 0,e.speedy=function(t){return d.speedy(t)},e.simulations=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];p=!!t},e.simulate=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(!(e=(0,o.default)(e)))return{};if(!p)return m||(console.warn("can't simulate without once calling simulations(true)"),m=!0),g||(console.warn("don't use simulation outside dev"),g=!0),{};return e.reduce((function(t,e){return t["data-simulate-"+y(e)]="",t}),{})},e.cssLabels=function(t){b=!!t},e.isLikeRule=x,e.idFor=w,e.css=q,e.rehydrate=function(t){(0,r.default)(S,t.reduce((function(t,e){return t[e]=!0,t}),{}))},e.flush=function(){S=d.inserted={},j=d.registered={},T={},d.flush(),d.inject()},e.select=U,e.parent=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return q(l({},t+" &",n))},e.media=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return q(l({},"@media "+t,n))},e.pseudo=V,e.active=function(t){return V(":active",t)},e.any=function(t){return V(":any",t)},e.checked=function(t){return V(":checked",t)},e.disabled=function(t){return V(":disabled",t)},e.empty=function(t){return V(":empty",t)},e.enabled=function(t){return V(":enabled",t)},e._default=function(t){return V(":default",t)},e.first=function(t){return V(":first",t)},e.firstChild=function(t){return V(":first-child",t)},e.firstOfType=function(t){return V(":first-of-type",t)},e.fullscreen=function(t){return V(":fullscreen",t)},e.focus=function(t){return V(":focus",t)},e.hover=function(t){return V(":hover",t)},e.indeterminate=function(t){return V(":indeterminate",t)},e.inRange=function(t){return V(":in-range",t)},e.invalid=function(t){return V(":invalid",t)},e.lastChild=function(t){return V(":last-child",t)},e.lastOfType=function(t){return V(":last-of-type",t)},e.left=function(t){return V(":left",t)},e.link=function(t){return V(":link",t)},e.onlyChild=function(t){return V(":only-child",t)},e.onlyOfType=function(t){return V(":only-of-type",t)},e.optional=function(t){return V(":optional",t)},e.outOfRange=function(t){return V(":out-of-range",t)},e.readOnly=function(t){return V(":read-only",t)},e.readWrite=function(t){return V(":read-write",t)},e.required=function(t){return V(":required",t)},e.right=function(t){return V(":right",t)},e.root=function(t){return V(":root",t)},e.scope=function(t){return V(":scope",t)},e.target=function(t){return V(":target",t)},e.valid=function(t){return V(":valid",t)},e.visited=function(t){return V(":visited",t)},e.dir=function(t,e){return V(":dir("+t+")",e)},e.lang=function(t,e){return V(":lang("+t+")",e)},e.not=function(t,e){var n=t.split(",").map((function(t){return t.trim()})).map((function(t){return":not("+t+")"}));if(1===n.length)return V(":not("+t+")",e);return U(n.join(""),e)},e.nthChild=function(t,e){return V(":nth-child("+t+")",e)},e.nthLastChild=function(t,e){return V(":nth-last-child("+t+")",e)},e.nthLastOfType=function(t,e){return V(":nth-last-of-type("+t+")",e)},e.nthOfType=function(t,e){return V(":nth-of-type("+t+")",e)},e.after=function(t){return V("::after",t)},e.before=function(t){return V("::before",t)},e.firstLetter=function(t){return V("::first-letter",t)},e.firstLine=function(t){return V("::first-line",t)},e.selection=function(t){return V("::selection",t)},e.backdrop=function(t){return V("::backdrop",t)},e.placeholder=function(t){return q({"::placeholder":t})},e.cssFor=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(e=(0,o.default)(e))?e.map((function(t){var e={label:[]};return $(e,{src:t}),E(v(e),C(e)).join("")})).join(""):""},e.attribsFor=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=(e=(0,o.default)(e))?e.map((function(t){w(t);var e=Object.keys(t)[0];return e+'="'+(t[e]||"")+'"'})).join(" "):"";return r};var r=c(n(224)),i=n(400),a=n(288),o=c(n(409)),s=n(410),u=c(n(427));function c(t){return t&&t.__esModule?t:{default:t}}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=e.styleSheet=new i.StyleSheet;d.inject();var f=e.plugins=d.plugins=new s.PluginSet([s.prefixes,s.contentWrap,s.fallbacks]);f.media=new s.PluginSet,f.fontFace=new s.PluginSet,f.keyframes=new s.PluginSet([s.prefixes,s.fallbacks]);var h="undefined"!=typeof window,p=!1,m=!1,g=!1;var b=!1;function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.toLowerCase().replace(/[^a-z0-9]/g,e)}function v(t){var e=JSON.stringify(t),n=(0,u.default)(e).toString(36);return t.label&&t.label.length,n}function x(t){var e=Object.keys(t).filter((function(t){return"toString"!==t}));return 1===e.length&&!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(e[0])}function w(t){var e=Object.keys(t).filter((function(t){return"toString"!==t}));if(1!==e.length)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/.exec(e[0]);if(!n)throw new Error("not a rule");return n[1]}var k=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function O(t){if(-1===t.indexOf(","))return[t];for(var e,n=[],r=[],i=0;e=k.exec(t);)switch(e[0]){case"(":i++;break;case")":i--;break;case",":if(i)break;n.push(e.index)}for(e=n.length;e--;)r.unshift(t.slice(n[e]+1)),t=t.slice(0,n[e]);return r.unshift(t),r}function _(t,e){if(!t)return e.replace(/\&/g,"");if(!e)return".css-"+t+",[data-css-"+t+"]";var n=O(e).map((function(e){return e.indexOf("&")>=0?[e.replace(/\&/gm,".css-"+t),e.replace(/\&/gm,"[data-css-"+t+"]")].join(","):".css-"+t+e+",[data-css-"+t+"]"+e})).join(",");return p&&/^\&\:/.exec(e)&&!/\s/.exec(e)&&(n+=",.css-"+t+"[data-simulate-"+y(e)+"],[data-css-"+t+"][data-simulate-"+y(e)+"]"),n}function A(t){var e=t.selector,n=t.style,r=f.transform({selector:e,style:n});return r.selector+"{"+(0,a.createMarkupForStyles)(r.style)+"}"}function C(t){var e=void 0,n=void 0,r=void 0,i=void 0;return Object.keys(t).forEach((function(a){a.indexOf("&")>=0?(n=n||{})[a]=t[a]:0===a.indexOf("@media")?(r=r||{})[a]=C(t[a]):0===a.indexOf("@supports")?(i=i||{})[a]=C(t[a]):"label"===a?t.label.length>0&&((e=e||{}).label=b?t.label.join("."):""):(e=e||{})[a]=t[a]})),{plain:e,selects:n,medias:r,supports:i}}function E(t,e){var n=[],r=e.plain,i=e.selects,a=e.medias,o=e.supports;return r&&n.push(A({style:r,selector:_(t)})),i&&Object.keys(i).forEach((function(e){return n.push(A({style:i[e],selector:_(t,e)}))})),a&&Object.keys(a).forEach((function(e){return n.push(e+"{"+E(t,a[e]).join("")+"}")})),o&&Object.keys(o).forEach((function(e){return n.push(e+"{"+E(t,o[e]).join("")+"}")})),n}var S=d.inserted={};var j=d.registered={};function N(t){j[t.id]||(j[t.id]=t)}var T={};function F(t){if(N(t),function(t){if(!S[t.id]){S[t.id]=!0;var e=C(t.style),n=E(t.id,e);S[t.id]=!!h||n,n.forEach((function(t){return d.insert(t)}))}}(t),T[t.id])return T[t.id];var e=l({},"data-css-"+t.id,b&&t.label||"");return Object.defineProperty(e,"toString",{enumerable:!1,value:function(){return"css-"+t.id}}),T[t.id]=e,e}function D(t,e){var n=O(t).map((function(t){return t.indexOf("&")>=0?t:"&"+t}));return O(e).map((function(t){return t.indexOf("&")>=0?t:"&"+t})).reduce((function(t,e){return t.concat(n.map((function(t){return e.replace(/\&/g,t)})))}),[]).join(",")}function I(t,e){return t?"@supports "+t.substring(9)+" and "+e.substring(9):e}var M={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function $(t,e){var n=e.selector,r=void 0===n?"":n,i=e.mq,a=void 0===i?"":i,s=e.supp,u=void 0===s?"":s,c=e.src,l=void 0===c?{}:c;Array.isArray(l)||(l=[l]),(l=function t(e){for(var n=[],r=0;r<e.length;r++)n=Array.isArray(e[r])?n.concat(t(e[r])):n.concat(e[r]);return n}(l)).forEach((function(e){if(x(e)){var n=function(t){if(x(t)){var e=j[w(t)];if(null==e)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return e}return t}(e);if("css"!==n.type)throw new Error("cannot merge this rule");e=n.style}(e=(0,o.default)(e))&&e.composes&&$(t,{selector:r,mq:a,supp:u,src:e.composes}),Object.keys(e||{}).forEach((function(n){if(function(t){for(var e=[":",".","[",">"," "],n=!1,r=t.charAt(0),i=0;i<e.length;i++)if(r===e[i]){n=!0;break}return n||t.indexOf("&")>=0}(n))M[n]&&M[n].forEach((function(i){return $(t,{selector:D(r,i),mq:a,supp:u,src:e[n]})})),$(t,{selector:D(r,n),mq:a,supp:u,src:e[n]});else if(function(t){return 0===t.indexOf("@media")}(n))$(t,{selector:r,mq:(o=a,s=n,o?"@media "+o.substring(6)+" and "+s.substring(6):s),supp:u,src:e[n]});else if(function(t){return 0===t.indexOf("@supports")}(n))$(t,{selector:r,mq:a,supp:I(u,n),src:e[n]});else if("composes"===n);else{var i=t;u&&(i[u]=i[u]||{},i=i[u]),a&&(i[a]=i[a]||{},i=i[a]),r&&(i[r]=i[r]||{},i=i[r]),"label"===n?b&&(t.label=t.label.concat(e.label)):i[n]=e[n]}var o,s}))}))}function R(t){var e={label:[]};return $(e,{src:t}),F({id:v(e),style:e,label:b?e.label.join("."):"",type:"css"})}var B={};Object.defineProperty(B,"toString",{enumerable:!1,value:function(){return"css-nil"}});var z="undefined"!=typeof WeakMap?[B,new WeakMap,new WeakMap,new WeakMap]:[B];var L,P="undefined"!=typeof WeakMap?(L=R,function(t){if(z[t.length]){for(var e=z[t.length],n=0;n<t.length-1;)e.has(t[n])||e.set(t[n],new WeakMap),e=e.get(t[n]),n++;if(e.has(t[t.length-1])){var r=e.get(t[n]);if(j[r.toString().substring(4)])return r}}var i=L(t);if(z[t.length]){for(var a=0,o=z[t.length];a<t.length-1;)o=o.get(t[a]),a++;try{o.set(t[a],i)}catch(t){}}return i}):R;function q(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(e[0]&&e[0].length&&e[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return(e=(0,o.default)(e))?P(e):B}q.insert=function(t){var e={id:v(t),css:t,type:"raw"};N(e),S[e.id]||(d.insert(e.css),S[e.id]=!!h||[e.css])};e.insertRule=q.insert;q.global=function(t,e){if(e=(0,o.default)(e))return q.insert(A({selector:t,style:e}))};e.insertGlobal=q.global;q.keyframes=function(t,e){e||(e=t,t="animation");var n={id:v({name:t,kfs:e=(0,o.default)(e)||{}}),type:"keyframes",name:t,keyframes:e};return N(n),function(t){if(!S[t.id]){var e=Object.keys(t.keyframes).map((function(e){var n=f.keyframes.transform({id:t.id,name:e,style:t.keyframes[e]});return n.name+"{"+(0,a.createMarkupForStyles)(n.style)+"}"})).join(""),n=["-webkit-","-moz-","-o-",""].map((function(n){return"@"+n+"keyframes "+t.name+"_"+t.id+"{"+e+"}"}));n.forEach((function(t){return d.insert(t)})),S[t.id]=!!h||n}}(n),t+"_"+n.id},q.fontFace=function(t){var e={id:v(t=(0,o.default)(t)),type:"font-face",font:t};return N(e),function(t){if(!S[t.id]){var e="@font-face{"+(0,a.createMarkupForStyles)(t.font)+"}";d.insert(e),S[t.id]=!!h||[e]}}(e),t.fontFamily};e.fontFace=q.fontFace,e.keyframes=q.keyframes;e.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var W=e.style=q;function U(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t?q(l({},t,n)):W(n)}e.$=U;e.merge=q,e.compose=q;function V(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return q(l({},t,n))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return"string"==typeof t&&r.test(t)};var r=/-webkit-|-moz-|-ms-/;t.exports=e.default},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));class r{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class i{time(t){return a("time")}read(t){return a("read")}readSync(t){return a("readSync")}numDataIds(){return a("numDataIds")}disposeData(t){return a("disposeData")}write(t,e,n){return a("write")}move(t,e,n,r){return a("move")}memory(){return a("memory")}floatPrecision(){return a("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}batchMatMul(t,e,n,r){return a("batchMatMul")}fusedBatchMatMul({a:t,b:e,transposeA:n,transposeB:r,bias:i,activation:o,preluActivationWeights:s}){return a("fusedBatchMatMul")}slice(t,e,n){return a("slice")}stridedSlice(t,e,n,r){return a("stridedSlice")}unstack(t,e){return a("unstack")}reverse(t,e){return a("reverse")}concat(t,e){return a("concat")}neg(t){return a("neg")}add(t,e){return a("add")}addN(t){return a("addN")}subtract(t,e){return a("subtract")}multiply(t,e){return a("multiply")}realDivide(t,e){return a("realDivide")}floorDiv(t,e){return a("floorDiv")}sum(t,e){return a("sum")}prod(t,e){return a("prod")}unsortedSegmentSum(t,e,n){return a("unsortedSegmentSum")}argMin(t,e){return a("argMin")}argMax(t,e){return a("argMax")}equal(t,e){return a("equal")}notEqual(t,e){return a("notEqual")}less(t,e){return a("less")}lessEqual(t,e){return a("lessEqual")}greater(t,e){return a("greater")}greaterEqual(t,e){return a("greaterEqual")}logicalNot(t){return a("logicalNot")}logicalAnd(t,e){return a("logicalAnd")}logicalOr(t,e){return a("logicalOr")}where(t){return a("where")}select(t,e,n){return a("select")}topk(t,e,n){return a("topk")}min(t,e){return a("min")}minimum(t,e){return a("minimum")}mod(t,e){return a("mod")}max(t,e){return a("max")}maximum(t,e){return a("maximum")}all(t,e){return a("all")}any(t,e){return a("any")}squaredDifference(t,e){return a("squaredDifference")}ceil(t){return a("ceil")}floor(t){return a("floor")}round(t){return a("round")}sign(t){return a("sign")}isNaN(t){return a("isNaN")}isInf(t){return a("isInf")}isFinite(t){return a("isFinite")}pow(t,e){return a("pow")}exp(t){return a("exp")}expm1(t){return a("expm1")}softmax(t,e){return a("softmax")}log(t){return a("log")}log1p(t){return a("log1p")}sqrt(t){return a("sqrt")}rsqrt(t){return a("rsqrt")}square(t){return a("square")}reciprocal(t){return a("reciprocal")}relu(t){return a("relu")}relu6(t){return a("relu6")}prelu(t,e){return a("prelu")}elu(t){return a("elu")}eluDer(t,e){return a("eluDer")}selu(t){return a("selu")}int(t){return a("int")}clip(t,e,n){return a("clip")}abs(t){return a("abs")}complexAbs(t){return a("complexAbs")}sigmoid(t){return a("sigmoid")}softplus(t){return a("softplus")}sin(t){return a("sin")}cos(t){return a("cos")}tan(t){return a("tan")}asin(t){return a("asin")}acos(t){return a("acos")}atan(t){return a("atan")}atan2(t,e){return a("atan2")}sinh(t){return a("sinh")}cosh(t){return a("cosh")}tanh(t){return a("tanh")}asinh(t){return a("asinh")}acosh(t){return a("acosh")}atanh(t){return a("atanh")}erf(t){return a("erf")}step(t,e){return a("step")}fusedConv2d({input:t,filter:e,convInfo:n,bias:r,activation:i,preluActivationWeights:o}){return a("fusedConv2d")}conv2d(t,e,n){return a("conv2d")}conv2dDerInput(t,e,n){return a("conv2dDerInput")}conv2dDerFilter(t,e,n){return a("conv2dDerFilter")}fusedDepthwiseConv2D({input:t,filter:e,convInfo:n,bias:r,activation:i,preluActivationWeights:o}){return a("fusedDepthwiseConv2D")}depthwiseConv2D(t,e,n){return a("depthwiseConv2D")}depthwiseConv2DDerInput(t,e,n){return a("depthwiseConv2DDerInput")}depthwiseConv2DDerFilter(t,e,n){return a("depthwiseConv2DDerFilter")}conv3d(t,e,n){return a("conv3d")}conv3dDerInput(t,e,n){return a("conv3dDerInput")}conv3dDerFilter(t,e,n){return a("conv3dDerFilter")}maxPool(t,e){return a("maxPool")}maxPoolBackprop(t,e,n,r){return a("maxPoolBackprop")}avgPool(t,e){return a("avgPool")}avgPoolBackprop(t,e,n){return a("avgPoolBackprop")}avgPool3d(t,e){return a("avgPool3d")}avgPool3dBackprop(t,e,n){return a("avgPool3dBackprop")}maxPool3d(t,e){return a("maxPool3d")}maxPool3dBackprop(t,e,n,r){return a("maxPool3dBackprop")}reshape(t,e){return a("reshape")}cast(t,e){return a("cast")}tile(t,e){return a("tile")}pad(t,e,n){return a("pad")}transpose(t,e){return a("transpose")}gather(t,e,n,r=0){return a("gather")}gatherND(t,e){return a("gatherND")}scatterND(t,e,n){return a("scatterND")}batchToSpaceND(t,e,n){return a("batchToSpaceND")}spaceToBatchND(t,e,n){return a("spaceToBatchND")}resizeBilinear(t,e,n,r,i){return a("resizeBilinear")}resizeBilinearBackprop(t,e,n){return a("resizeBilinearBackprop")}resizeNearestNeighbor(t,e,n,r,i){return a("resizeNearestNeighbor")}resizeNearestNeighborBackprop(t,e,n){return a("resizeNearestNeighborBackprop")}batchNorm(t,e,n,r,i,o){return a("batchNorm")}localResponseNormalization4D(t,e,n,r,i){return a("localResponseNormalization4D")}LRNGrad(t,e,n,r,i,o,s){return a("LRNGrad")}multinomial(t,e,n,r){return a("multinomial")}oneHot(t,e,n,r){return a("oneHot")}cumsum(t,e,n,r){return a("cumsum")}nonMaxSuppression(t,e,n,r,i){return a("nonMaxSuppression")}fft(t){return a("fft")}ifft(t){return a("ifft")}complex(t,e){return a("complex")}real(t){return a("real")}imag(t){return a("imag")}cropAndResize(t,e,n,r,i,o){return a("cropAndResize")}depthToSpace(t,e,n){return a("depthToSpace")}split(t,e,n){return a("split")}sparseToDense(t,e,n,r){return a("sparseToDense")}diag(t){return a("diag")}fill(t,e,n){return a("fill")}onesLike(t){return a("onesLike")}zerosLike(t){return a("zerosLike")}linspace(t,e,n){return a("linspace")}dispose(){return a("dispose")}}function a(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({tanh_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","tanh")};return r.a.runKernel(i.Sc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(5),i=n(3);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function a(t,e,n=1,a="float32"){if(0===n)throw new Error("Cannot have a step of zero");const o={start:t,stop:e,step:n,dtype:a};return r.a.runKernel(i.ic,{},o)}},function(t,e,n){"use strict";(function(t,r){
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
let i;function a(){if(null==i){let e;if("undefined"!=typeof window)e=window;else if(void 0!==t)e=t;else if(void 0!==r)e=r;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}i=e}return i}function o(t,e){const n=function(){const t=a();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return o}))}).call(this,n(148),n(93))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}},function(t,e,n){"use strict";var r=n(30),i=Object(r.a)((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));i.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Object(r.a)((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null},e.a=i;i.range},function(t,e,n){"use strict";var r=n(30),i=Object(r.a)((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));i.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Object(r.a)((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null},e.a=i;i.range},function(t,e,n){(function(r){function i(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(329)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,a=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(i++,"%c"===t&&(a=i))})),t.splice(a,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=i,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(i())}).call(this,n(93))},function(t,e){e.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},e.decode=function(t){for(var e={},n=t.split("&"),r=0,i=n.length;r<i;r++){var a=n[r].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}},function(t,e){t.exports=function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){(function(r){function i(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(350)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,a=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(i++,"%c"===t&&(a=i))})),t.splice(a,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=i,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(i())}).call(this,n(93))},function(t,e){const n=Number.MAX_SAFE_INTEGER||9007199254740991;t.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:n,MAX_SAFE_COMPONENT_LENGTH:16}},function(t,e,n){(function(e){const n="object"==typeof e&&e.env&&e.env.NODE_DEBUG&&/\bsemver\b/i.test(e.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};t.exports=n}).call(this,n(93))},function(t,e){const n=["includePrerelease","loose","rtl"];t.exports=t=>t?"object"!=typeof t?{loose:!0}:n.filter(e=>t[e]).reduce((t,e)=>(t[e]=!0,t),{}):{}},function(t,e,n){const r=n(69);t.exports=(t,e,n)=>r(t,e,n)>0},function(t,e,n){const r=Symbol("SemVer ANY");class i{static get ANY(){return r}constructor(t,e){if(e=a(e),t instanceof i){if(t.loose===!!e.loose)return t;t=t.value}c("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===r?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(t){const e=this.options.loose?o[s.COMPARATORLOOSE]:o[s.COMPARATOR],n=t.match(e);if(!n)throw new TypeError("Invalid comparator: "+t);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new l(n[2],this.options.loose):this.semver=r}toString(){return this.value}test(t){if(c("Comparator.test",t,this.options.loose),this.semver===r||t===r)return!0;if("string"==typeof t)try{t=new l(t,this.options)}catch(t){return!1}return u(t,this.operator,this.semver,this.options)}intersects(t,e){if(!(t instanceof i))throw new TypeError("a Comparator is required");if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),""===this.operator)return""===this.value||new d(t.value,e).test(this.value);if(""===t.operator)return""===t.value||new d(this.value,e).test(t.semver);const n=!(">="!==this.operator&&">"!==this.operator||">="!==t.operator&&">"!==t.operator),r=!("<="!==this.operator&&"<"!==this.operator||"<="!==t.operator&&"<"!==t.operator),a=this.semver.version===t.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==t.operator&&"<="!==t.operator),s=u(this.semver,"<",t.semver,e)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),c=u(this.semver,">",t.semver,e)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return n||r||a&&o||s||c}}t.exports=i;const a=n(166),{re:o,t:s}=n(119),u=n(286),c=n(165),l=n(51),d=n(70)},function(t,e,n){const r=n(70);t.exports=(t,e,n)=>{try{e=new r(e,n)}catch(t){return!1}return e.test(t)}},function(t,e,n){"use strict";
/*
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function r(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function i(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}Object.defineProperty(e,"__esModule",{value:!0}),e.assert=r,e.assertShapesMatch=function(t,e,n=""){r(i(t,e),n+` Shapes ${t} and ${e} must match`)},e.arraysEqual=i,e.DECIMAL_PLACES_TO_CHECK=4},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(227),a=n(170);e.arrayStats=function(t){if(!Array.isArray(t))throw new Error("input must be an array");if(0===t.length)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};const e=t.length;let n=-1/0,r=1/0,i=0,a=0,o=0;for(let s=0;s<e;s++){const e=t[s];e>n&&(n=e),e<r&&(r=e),0===e&&(i+=1),isNaN(e)?a+=1:isFinite(e)||(o+=1)}const s={numVals:e,numZeros:i,numNans:a,max:n,min:r,numInfs:o};return s.max===-1/0&&(s.max=NaN),s.min===1/0&&(s.min=NaN),s},e.tensorStats=function(t){return r(this,void 0,void 0,(function*(){const[e,n,r]=i.tidy(()=>{const e=i.scalar(0,t.dtype);return[t.min(),t.max(),t.equal(e).sum()]});return Promise.all([t.data(),e.data(),n.data(),r.data()]).then(([t,e,n,r])=>{const i=t.length;let a=0,o=0;for(let e=0;e<i;e++){const n=t[e];isNaN(n)?a+=1:isFinite(n)||(o+=1)}let s=e[0],u=n[0];a===i&&(s=NaN,u=NaN);return{numVals:i,numZeros:r[0],numNans:a,min:s,max:u,numInfs:o}})}))},e.confusionMatrix=function(t,e,n,o){return r(this,void 0,void 0,(function*(){a.assert(1===t.rank,"labels must be a 1D tensor"),a.assert(1===e.rank,"predictions must be a 1D tensor"),a.assert(t.size===e.size,"labels and predictions must be the same length"),null!=o&&a.assert(o.size===e.size,"labels and predictions must be the same length");const r=t.cast("int32"),s=e.cast("int32");null==n&&(n=i.tidy(()=>i.maximum(r.max(),s.max()).cast("int32").dataSync()[0]+1));let u=Promise.resolve(null);return null!=o&&(u=o.data()),Promise.all([r.data(),s.data(),u]).then(([t,e,r])=>{const i=Array(n).fill(0);for(let t=0;t<n;t++)i[t]=Array(n).fill(0);for(let n=0;n<t.length;n++){const a=t[n],o=e[n];i[a][o]+=null!=r?r[n]:1}return i})}))},e.accuracy=function(t,e){return r(this,void 0,void 0,(function*(){a.assertShapesMatch(t.shape,e.shape,"Error computing accuracy.");const n=t.equal(e),r=n.mean(),o=(yield r.data())[0];return i.dispose([n,r]),o}))},e.perClassAccuracy=function(t,e,n){return r(this,void 0,void 0,(function*(){return a.assert(1===t.rank,"labels must be a 1D tensor"),a.assert(1===e.rank,"predictions must be a 1D tensor"),a.assert(t.size===e.size,"labels and predictions must be the same length"),null==n&&(n=i.tidy(()=>i.maximum(t.max(),e.max()).dataSync()[0]+1)),Promise.all([t.data(),e.data()]).then(([t,e])=>{const r=Array(n).fill(0),i=Array(n).fill(0);for(let n=0;n<t.length;n++){const a=t[n],o=e[n];r[a]+=1,a===o&&(i[a]+=1)}const a=[];for(let t=0;t<r.length;t++)a.push({count:r[t],accuracy:0===r[t]?0:i[t]/r[t]});return a})}))}},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});const r=n(75),i=n(439),a=n(151),o=n(71);e.table=function(t,e,n={}){if(e&&null==e.headers)throw new Error('Data to render must have a "headers" property');if(e&&null==e.values)throw new Error('Data to render must have a "values" property');const u=o.getDrawArea(t),c=Object.assign({},s,n);let l=i.select(u).select("table.tf-table");const d=a.css({fontSize:c.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(0===l.size()&&(l=i.select(u).append("table"),l.attr("class",` ${d} tf-table`),l.append("thead").append("tr"),l.append("tbody")),1!==l.size())throw new Error("Error inserting table");const f=a.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),h=l.select("thead").select("tr").selectAll("th").data(e.headers),p=h.enter().append("th").attr("class",""+f);h.merge(p).html(t=>t),h.exit().remove();const m=r.format(",.4~f"),g=l.select("tbody").selectAll("tr").data(e.values),b=g.enter().append("tr"),y=a.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),v=g.merge(b).selectAll("td").data(t=>t),x=v.enter().append("td").attr("class",""+y);v.merge(x).html(t=>"number"==typeof t?m(t):t),v.exit().remove(),g.exit().remove()};const s={fontSize:14}},function(t,e,n){"use strict";function r(){if("undefined"!=typeof navigator&&null!=navigator){const t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function i(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}n.r(e),n.d(e,"isMobile",(function(){return r})),n.d(e,"isBrowser",(function(){return i}))},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function r(t,e=!1){console.log(t.toString(e))}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({all_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=null,n=!1){const o={x:Object(a.a)(t,"x","all","bool")},s={axis:e,keepDims:n};return r.a.runKernel(i.f,o,s)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({any_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=null,n=!1){const o={x:Object(a.a)(t,"x","any","bool")},s={axis:e,keepDims:n};return r.a.runKernel(i.g,o,s)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({argMax_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=0){const n={x:Object(a.a)(t,"x","argMax")},o={axis:e};return r.a.runKernel(i.h,n,o)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({argMin_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=0){const n={x:Object(a.a)(t,"x","argMin")},o={axis:e};return r.a.runKernel(i.i,n,o)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(22),o=n(1),s=n(4);const u=Object(s.b)({atan2_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(o.a)(t,"a","atan2"),s=Object(o.a)(e,"b","atan2");[n,s]=Object(a.makeTypesMatch)(n,s);const u={a:n,b:s};return r.a.runKernel(i.m,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1),i=n(7),a=n(63),o=n(27),s=n(4),u=n(8);const c=Object(s.b)({conv1d_:function(t,e,n,s,c="NWC",l=1,d){const f=Object(r.a)(t,"x","conv1d"),h=Object(r.a)(e,"filter","conv1d");let p=f,m=!1;2===f.rank&&(m=!0,p=Object(u.a)(f,[1,f.shape[0],f.shape[1]])),i.b(3===p.rank,()=>`Error in conv1d: input must be rank 3, but got rank ${p.rank}.`),i.b(3===h.rank,()=>"Error in conv1d: filter must be rank 3, but got rank "+h.rank+"."),null!=d&&i.b(i.v(s),()=>`Error in conv1d: pad must be an integer when using, dimRoundingMode ${d} but got pad ${s}.`),i.b(p.shape[2]===h.shape[1],()=>`Error in conv1d: depth of input (${p.shape[2]}) must match input depth for filter ${h.shape[1]}.`),i.b(o.h(n,l),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${l}'`),i.b("NWC"===c,()=>`Error in conv1d: got dataFormat of ${c} but only NWC is currently supported.`);const g=Object(u.a)(h,[1,h.shape[0],h.shape[1],h.shape[2]]),b=Object(u.a)(p,[p.shape[0],1,p.shape[1],p.shape[2]]),y=[1,n],v=[1,l],x=Object(a.a)(b,g,y,s,"NHWC",v,d);return m?Object(u.a)(x,[x.shape[2],x.shape[3]]):Object(u.a)(x,[x.shape[0],x.shape[2],x.shape[3]])}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1),i=n(142),a=n(4);const o=Object(a.b)({conv2dTranspose_:function(t,e,n,a,o,s){const u=Object(r.a)(t,"x","conv2dTranspose"),c=Object(r.a)(e,"filter","conv2dTranspose");return Object(i.a)(n,u,c,a,o,"NHWC",s)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({cosh_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","cosh")};return r.a.runKernel(i.J,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({depthToSpace_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n="NHWC"){const s=Object(a.a)(t,"x","depthToSpace"),u="NHWC"===n?s.shape[1]:s.shape[2],c="NHWC"===n?s.shape[2]:s.shape[3],l="NHWC"===n?s.shape[3]:s.shape[1];o.b(u*e>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${u} and ${e}  for depthToSpace with input shape\n    ${s.shape}`),o.b(c*e>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${c} and ${e} for depthToSpace with input shape\n        ${s.shape}`),o.b(l%(e*e)==0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${l} for depthToSpace with input shape ${s.shape}`);const d={x:s},f={blockSize:e,dataFormat:n};return r.a.runKernel(i.N,d,f)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4),u=n(8);const c=Object(s.b)({dilation2d_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,s,c=[1,1],l="NHWC"){const d=Object(a.a)(t,"x","dilation2d"),f=Object(a.a)(e,"filter","dilation2d");o.b(3===d.rank||4===d.rank,()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+d.rank+"."),o.b(3===f.rank,()=>"Error in dilation2d: filter must be rank 3, but got rank "+f.rank+"."),o.b("NHWC"===l,()=>"Error in dilation2d: Only NHWC is currently supported, but got dataFormat of "+l);let h=d,p=!1;3===d.rank&&(h=Object(u.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]]),p=!0);const m={x:h,filter:f},g={strides:n,pad:s,dilations:c},b=r.a.runKernel(i.S,m,g);return p?Object(u.a)(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(22),i=n(1),a=n(14),o=n(79),s=n(4),u=n(36),c=n(21);const l=Object(s.b)({divNoNan_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){let n=Object(i.a)(t,"a","div"),s=Object(i.a)(e,"b","div");[n,s]=Object(r.makeTypesMatch)(n,s);const l=Object(a.a)(n,s),d=Object(c.a)(l),f=Object(o.a)(s,d);return Object(u.a)(f,d,l)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1),i=n(7),a=n(26),o=n(4),s=n(8);const u=Object(o.b)({dot_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const n=Object(r.a)(t,"t1","dot"),o=Object(r.a)(e,"t2","dot");i.b(!(1!==n.rank&&2!==n.rank||1!==o.rank&&2!==o.rank),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${o.rank}.`);const u=1===n.rank?n.size:n.shape[1],c=1===o.rank?o.size:o.shape[0];if(i.b(u===c,()=>`Error in dot: inner dimensions of inputs must match, but got ${u} and ${c}.`),1===n.rank&&1===o.rank){const t=Object(s.a)(n,[1,-1]),e=Object(s.a)(o,[-1,1]),r=Object(a.a)(t,e);return Object(s.a)(r,[])}if(1===n.rank&&2===o.rank){const t=Object(s.a)(n,[1,-1]),e=Object(s.a)(o,[o.shape[0],o.shape[1]]),r=Object(a.a)(t,e);return Object(s.a)(r,[r.size])}if(2===n.rank&&1===o.rank){const t=Object(s.a)(o,[-1,1]),e=Object(a.a)(n,t);return Object(s.a)(e,[e.size])}{const t=Object(s.a)(o,[o.shape[0],o.shape[1]]);return Object(a.a)(n,t)}}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4),u=n(8);const c=Object(s.b)({localResponseNormalization_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=5,n=1,s=1,c=.5){const l=Object(a.a)(t,"x","localResponseNormalization");o.b(4===l.rank||3===l.rank,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${l.rank}.`),o.b(o.v(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let d=l,f=!1;3===l.rank&&(f=!0,d=Object(u.a)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));const h={x:d},p={depthRadius:e,bias:n,alpha:s,beta:c},m=r.a.runKernel(i.vb,h,p);return f?Object(u.a)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({log1p_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","log1p")};return r.a.runKernel(i.Cb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({softplus_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","softplus")};return r.a.runKernel(i.Gc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1),i=n(16),a=n(58),o=n(100),s=n(133),u=n(4);const c=Object(u.b)({logicalXor_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const n=Object(r.a)(t,"a","logicalXor","bool"),u=Object(r.a)(e,"b","logicalXor","bool");return Object(i.a)(n.shape,u.shape),Object(a.a)(Object(s.a)(t,e),Object(o.a)(Object(a.a)(t,e)))}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({mirrorPad_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n){o.b("reflect"===n||"symmetric"===n,()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=Object(a.a)(t,"x","mirrorPad");if(0===s.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");o.b(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const u="reflect"===n?1:0;for(let t=0;t<s.rank;t++)o.b(2===e[t].length,()=>"Invalid number of paddings. Must be length of 2 each."),o.b(e[t][0]>=0&&e[t][0]<=s.shape[t]-u&&e[t][1]>=0&&e[t][1]<=s.shape[t]-u,()=>`Padding in dimension ${t} cannot be greater than or equal to ${s.shape[t]-u} or less than 0 for input of shape `+s.shape);const c={paddings:e,mode:n},l={x:s};return r.a.runKernel(i.Rb,l,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(1),i=n(7),a=n(125),o=n(97),s=n(27),u=n(134),c=n(4),l=n(8),d=n(103);const f=Object(c.b)({pool_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,c,f,h){null==f&&(f=[1,1]),null==h&&(h=1),0===c&&(c="valid");const p=Object(r.a)(t,"x","maxPool");let m=p,g=!1;3===p.rank&&(g=!0,m=Object(l.a)(p,[1,p.shape[0],p.shape[1],p.shape[2]])),i.b(s.h(h,f),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${h} and dilations '${f}'`);const b=s.e(m.shape,e,h,f,c),y=[b.dilationHeight,b.dilationWidth];let v;v="same"===c?function(t,e){const n=t.map((t,n)=>t+(t-1)*(e[n]-1)).map(t=>t-1),r=n.map(t=>Math.floor(t/2)),i=n.map((t,e)=>t-r[e]);return n.map((t,e)=>[r[e],i[e]])}([b.filterHeight,b.filterWidth],y):[[0,0],[0,0]];const x=1===y[0]&&1===y[1],[w,k]=function(t,e,n){const r=n.map(t=>t[0]),i=n.map(t=>t[1]),a=t.concat(r,i),o=e.map((t,e)=>(t-a[e]%t)%t),s=i.map((t,e)=>t+o[e]),u=e.map((t,e)=>[r[e],s[e]]),c=e.map((t,e)=>[0,o[e]]);return[u,c]}([b.inHeight,b.inWidth],y,v),O=x?c:"valid",_=x?m:Object(d.a)(m,y,w),A=("avg"===n?()=>Object(a.a)(_,e,h,O):()=>Object(u.a)(_,e,h,O))(),C=x?A:Object(o.a)(A,y,k);return g?Object(l.a)(C,[C.shape[1],C.shape[2],C.shape[3]]):C}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(11),s=n(4);const u=Object(s.b)({prod_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=null,n=!1){let s=Object(a.a)(t,"x","prod");"bool"===s.dtype&&(s=Object(o.a)(s,"int32"));const u={x:s},c={axis:e,keepDims:n};return r.a.runKernel(i.hc,u,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(46),i=n(4),a=n(107);const o=Object(i.b)({randomUniform_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=0,n=1,i="float32",o){const s=Object(r.a)(t,i),u=new a.c(e,n,null,o);for(let t=0;t<s.values.length;t++)s.values[t]=u.nextValue();return s.toTensor()}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({rsqrt_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","rsqrt")};return r.a.runKernel(i.wc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({selu_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","selu")};return r.a.runKernel(i.zc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1),i=n(7),a=n(63),o=n(78),s=n(4),u=n(8);const c=Object(s.b)({separableConv2d_:function(t,e,n,s,c,l=[1,1],d="NHWC"){const f=Object(r.a)(t,"x","separableConv2d"),h=Object(r.a)(e,"depthwiseFilter","separableConv2d"),p=Object(r.a)(n,"pointwiseFilter","separableConv2d");let m=f,g=!1;if(3===f.rank&&(g=!0,m=Object(u.a)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),"NCHW"===d)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");i.b(4===m.rank,()=>`Error in separableConv2d: input must be rank 4, but got rank ${m.rank}.`),i.b(4===h.rank,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${h.rank}.`),i.b(4===p.rank,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${h.rank}.`),i.b(1===p.shape[0],()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${p.shape[0]}.`),i.b(1===p.shape[1],()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${p.shape[1]}.`);const b=h.shape[2],y=h.shape[3];i.b(p.shape[2]===b*y,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${b*y}, but got ${p.shape[2]}.`);const v=Object(o.a)(m,h,s,c,d,l),x=Object(a.a)(v,p,1,"valid",d);return g?Object(u.a)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({sin_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","sin")};return r.a.runKernel(i.Cc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({sinh_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","sinh")};return r.a.runKernel(i.Dc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n(57),i=n(31),a=n(130),o=n(9),s=n(4),u=n(112),c=n(8),l=n(48),d=n(15),f=n(25),h=n(113);const p=Object(s.b)({irfft_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=Object(c.a)(t,[n,e]);s=Object(h.a)(r)}else{const p=[n,2*(e-1)],m=Object(c.a)(Object(u.a)(t),[n,e]),g=Object(c.a)(Object(a.a)(t),[n,e]),b=Object(l.a)(Object(f.a)(m,[0,1],[n,e-2]),1),y=Object(o.a)(Object(l.a)(Object(f.a)(g,[0,1],[n,e-2]),1),Object(d.a)(-1)),v=Object(i.a)([m,b],1),x=Object(i.a)([g,y],1),w=Object(c.a)(Object(r.a)(v,x),[p[0],p[1]]);s=Object(h.a)(w)}if(s=Object(u.a)(s),3===t.rank&&0!==t.shape[0]){const e=s,n=t.shape[0];s=Object(c.a)(s,[n,s.shape[0]/n,s.shape[1]]),e.dispose()}return s}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1),i=n(7),a=n(49);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function o(t,e,n){if(Object(i.d)(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");const o=Object(r.c)(t,n);if(3!==o.length&&1!==o.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===o.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Object(a.a)(t,e,o,n)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({topk_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=1,n=!0){const o=Object(a.a)(t,"x","topk");if(0===o.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const s=o.shape[o.shape.length-1];if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got `+e);const u={x:o},c={k:e,sorted:n},[l,d]=r.a.runKernel(i.Uc,u,c);return{values:l,indices:d}}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({unique_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=0){const n=Object(a.a)(t,"x","unique","string_or_numeric");Object(o.b)(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},u={axis:e},[c,l]=r.a.runKernel(i.Wc,s,u);return{values:c,indices:l}}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(205),i=n(1);const a=
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
async function(t){const e=Object(i.a)(t,"condition","whereAsync","bool"),n=await e.data(),a=Object(r.a)(e.shape,n);return t!==e&&e.dispose(),a}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(46);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(t,e){const n=[];for(let t=0;t<e.length;t++)e[t]&&n.push(t);const i=Object(r.a)(t,"int32"),a=Object(r.a)([n.length,t.length],"int32");for(let e=0;e<n.length;e++){const r=i.indexToLoc(n[e]),o=e*t.length;a.values.set(r,o)}return a.toTensor()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(7),o=n(4),s=n(8);const u=Object(o.b)({conv3DBackpropInput_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,o,u){a.b(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let c=t,l=e,d=!1;4===e.rank&&(d=!0,l=Object(s.a)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),c=[1,t[0],t[1],t[2],t[3]]);const f=c[4],h=l.shape[4];a.b(5===c.length,()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+c.length+"."),a.b(5===l.rank,()=>"Error in conv3dDerInput: dy must be rank 5, but got rank "+l.rank),a.b(5===n.rank,()=>"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank),a.b(f===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${f}) must match input depth for filter ${n.shape[3]}.`),a.b(h===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[4]}.`);const p={dy:l,filter:n},m={pad:u,strides:o,inputShape:c},g=r.a.runKernel(i.H,p,m);return d?Object(s.a)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4),u=n(8);const c=Object(s.b)({resizeNearestNeighbor_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n=!1,s=!1){const c=Object(a.a)(t,"images","resizeNearestNeighbor");o.b(3===c.rank||4===c.rank,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${c.rank}.`),o.b(2===e.length,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."),o.b("float32"===c.dtype||"int32"===c.dtype,()=>"`images` must have `int32` or `float32` as dtype"),o.b(!1===s||!1===n,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let l=c,d=!1;3===c.rank&&(d=!0,l=Object(u.a)(c,[1,c.shape[0],c.shape[1],c.shape[2]]));const[]=e,f={images:l},h={alignCorners:n,halfPixelCenters:s,size:e},p=r.a.runKernel(i.rc,f,h);return d?Object(u.a)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4),u=n(8);const c=Object(s.b)({resizeBilinear_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n=!1,s=!1){const c=Object(a.a)(t,"images","resizeBilinear");o.b(3===c.rank||4===c.rank,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${c.rank}.`),o.b(2===e.length,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."),o.b(!1===s||!1===n,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let l=c,d=!1;3===c.rank&&(d=!0,l=Object(u.a)(c,[1,c.shape[0],c.shape[1],c.shape[2]]));const[]=e,f={images:l},h={alignCorners:n,halfPixelCenters:s,size:e},p=r.a.runKernel(i.pc,f,h);return d?Object(u.a)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(4),o=n(8);const s=Object(a.b)({depthwiseConv2dNativeBackpropInput_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,a,s,u=[1,1],c){let l=e,d=!1;3===e.rank&&(d=!0,l=Object(o.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const f={dy:l,filter:n},h={strides:a,pad:s,dimRoundingMode:c,dilations:u,inputShape:t},p=r.a.runKernel(i.Q,f,h);return d?Object(o.a)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(4),o=n(8);const s=Object(a.b)({depthwiseConv2dNativeBackpropFilter_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,a,s,u=[1,1],c){let l=t;3===t.rank&&(l=Object(o.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let d=e;3===d.rank&&(d=Object(o.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const f={x:l,dy:d},h={strides:a,pad:s,dimRoundingMode:c,dilations:u,filterShape:n};return r.a.runKernel(i.P,f,h)}})},function(t,e,n){"use strict";var r=/("(?:[^\\"]|\\.)*")|[:,]/g;t.exports=function(t,e){var n,i,a;return e=e||{},n=JSON.stringify([1],void 0,void 0===e.indent?2:e.indent).slice(2,-3),i=""===n?1/0:void 0===e.maxLength?80:e.maxLength,a=e.replacer,function t(e,o,s){var u,c,l,d,f,h,p,m,g,b,y,v;if(e&&"function"==typeof e.toJSON&&(e=e.toJSON()),void 0===(y=JSON.stringify(e,a)))return y;if(p=i-o.length-s,y.length<=p&&(g=y.replace(r,(function(t,e){return e||t+" "}))).length<=p)return g;if(null!=a&&(e=JSON.parse(y),a=void 0),"object"==typeof e&&null!==e){if(m=o+n,l=[],c=0,Array.isArray(e))for(b="[",u="]",p=e.length;c<p;c++)l.push(t(e[c],m,c===p-1?0:1)||"null");else for(b="{",u="}",p=(h=Object.keys(e)).length;c<p;c++)d=h[c],f=JSON.stringify(d)+": ",void 0!==(v=t(e[d],m,f.length+(c===p-1?0:1)))&&l.push(f+v);if(l.length>0)return[b,n+l.join(",\n"+m),u].join("\n"+o)}return y}(t,"",0)}},,,function(t,e,n){var r=n(331)("socket.io-parser"),i=n(334),a=n(335),o=n(236),s=n(237);function u(){}e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=u,e.Decoder=d;var c=e.ERROR+'"encode error"';function l(t){var n=""+t.type;if(e.BINARY_EVENT!==t.type&&e.BINARY_ACK!==t.type||(n+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(n+=t.nsp+","),null!=t.id&&(n+=t.id),null!=t.data){var i=function(t){try{return JSON.stringify(t)}catch(t){return!1}}(t.data);if(!1===i)return c;n+=i}return r("encoded %j as %s",t,n),n}function d(){this.reconstructor=null}function f(t){this.reconPack=t,this.buffers=[]}function h(t){return{type:e.ERROR,data:"parser error: "+t}}u.prototype.encode=function(t,n){(r("encoding packet %j",t),e.BINARY_EVENT===t.type||e.BINARY_ACK===t.type)?function(t,e){a.removeBlobs(t,(function(t){var n=a.deconstructPacket(t),r=l(n.packet),i=n.buffers;i.unshift(r),e(i)}))}(t,n):n([l(t)])},i(d.prototype),d.prototype.add=function(t){var n;if("string"==typeof t)n=function(t){var n=0,i={type:Number(t.charAt(0))};if(null==e.types[i.type])return h("unknown packet type "+i.type);if(e.BINARY_EVENT===i.type||e.BINARY_ACK===i.type){for(var a="";"-"!==t.charAt(++n)&&(a+=t.charAt(n),n!=t.length););if(a!=Number(a)||"-"!==t.charAt(n))throw new Error("Illegal attachments");i.attachments=Number(a)}if("/"===t.charAt(n+1))for(i.nsp="";++n;){if(","===(u=t.charAt(n)))break;if(i.nsp+=u,n===t.length)break}else i.nsp="/";var s=t.charAt(n+1);if(""!==s&&Number(s)==s){for(i.id="";++n;){var u;if(null==(u=t.charAt(n))||Number(u)!=u){--n;break}if(i.id+=t.charAt(n),n===t.length)break}i.id=Number(i.id)}if(t.charAt(++n)){var c=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(n));if(!(!1!==c&&(i.type===e.ERROR||o(c))))return h("invalid payload");i.data=c}return r("decoded %s as %j",t,i),i}(t),e.BINARY_EVENT===n.type||e.BINARY_ACK===n.type?(this.reconstructor=new f(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!s(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",n))}},d.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},f.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=a.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},f.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(t,e,n){var r=n(341);t.exports=function(t){var e=t.xdomain,n=t.xscheme,i=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||r))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!n&&i)return new XDomainRequest}catch(t){}if(!e)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}},function(t,e,n){var r=n(116),i=n(149);function a(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.isReactNative=t.isReactNative,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}t.exports=a,i(a.prototype),a.prototype.onError=function(t,e){var n=new Error(t);return n.type="TransportError",n.description=e,this.emit("error",n),this},a.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},a.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},a.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},a.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},a.prototype.onData=function(t){var e=r.decodePacket(t,this.socket.binaryType);this.onPacket(e)},a.prototype.onPacket=function(t){this.emit("packet",t)},a.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(t,e){const n=/^[0-9]+$/,r=(t,e)=>{const r=n.test(t),i=n.test(e);return r&&i&&(t=+t,e=+e),t===e?0:r&&!i?-1:i&&!r?1:t<e?-1:1};t.exports={compareIdentifiers:r,rcompareIdentifiers:(t,e)=>r(e,t)}},function(t,e,n){const r=n(69);t.exports=(t,e,n)=>0===r(t,e,n)},function(t,e,n){const r=n(51);t.exports=(t,e,n)=>{const i=new r(t,n),a=new r(e,n);return i.compare(a)||i.compareBuild(a)}},function(t,e,n){const r=n(69);t.exports=(t,e,n)=>r(t,e,n)<0},function(t,e,n){const r=n(69);t.exports=(t,e,n)=>r(t,e,n)>=0},function(t,e,n){const r=n(69);t.exports=(t,e,n)=>r(t,e,n)<=0},function(t,e,n){const r=n(51),i=n(168),{ANY:a}=i,o=n(70),s=n(169),u=n(167),c=n(220),l=n(222),d=n(221);t.exports=(t,e,n,f)=>{let h,p,m,g,b;switch(t=new r(t,f),e=new o(e,f),n){case">":h=u,p=l,m=c,g=">",b=">=";break;case"<":h=c,p=d,m=u,g="<",b="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(t,e,f))return!1;for(let n=0;n<e.set.length;++n){const r=e.set[n];let o=null,s=null;if(r.forEach(t=>{t.semver===a&&(t=new i(">=0.0.0")),o=o||t,s=s||t,h(t.semver,o.semver,f)?o=t:m(t.semver,s.semver,f)&&(s=t)}),o.operator===g||o.operator===b)return!1;if((!s.operator||s.operator===g)&&p(t,s.semver))return!1;if(s.operator===b&&m(t,s.semver))return!1}return!0}},function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function o(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,s,u=o(t),c=1;c<arguments.length;c++){for(var l in n=Object(arguments[c]))i.call(n,l)&&(u[l]=n[l]);if(r){s=r(n);for(var d=0;d<s.length;d++)a.call(n,s[d])&&(u[s[d]]=n[s[d]])}}return u}},function(t,e,n){"use strict";function r(){}n.r(e),n.d(e,"h",(function(){return s})),n.d(e,"createElement",(function(){return s})),n.d(e,"cloneElement",(function(){return l})),n.d(e,"Component",(function(){return $})),n.d(e,"render",(function(){return R})),n.d(e,"rerender",(function(){return p})),n.d(e,"options",(function(){return i}));var i={},a=[],o=[];function s(t,e){var n,s,u,c,l=o;for(c=arguments.length;c-- >2;)a.push(arguments[c]);for(e&&null!=e.children&&(a.length||a.push(e.children),delete e.children);a.length;)if((s=a.pop())&&void 0!==s.pop)for(c=s.length;c--;)a.push(s[c]);else"boolean"==typeof s&&(s=null),(u="function"!=typeof t)&&(null==s?s="":"number"==typeof s?s=String(s):"string"!=typeof s&&(u=!1)),u&&n?l[l.length-1]+=s:l===o?l=[s]:l.push(s),n=u;var d=new r;return d.nodeName=t,d.children=l,d.attributes=null==e?void 0:e,d.key=null==e?void 0:e.key,void 0!==i.vnode&&i.vnode(d),d}function u(t,e){for(var n in e)t[n]=e[n];return t}var c="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function l(t,e){return s(t.nodeName,u(u({},t.attributes),e),arguments.length>2?[].slice.call(arguments,2):t.children)}var d=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,f=[];function h(t){!t._dirty&&(t._dirty=!0)&&1==f.push(t)&&(i.debounceRendering||c)(p)}function p(){var t,e=f;for(f=[];t=e.pop();)t._dirty&&I(t)}function m(t,e,n){return"string"==typeof e||"number"==typeof e?void 0!==t.splitText:"string"==typeof e.nodeName?!t._componentConstructor&&g(t,e.nodeName):n||t._componentConstructor===e.nodeName}function g(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function b(t){var e=u({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===e[r]&&(e[r]=n[r]);return e}function y(t){var e=t.parentNode;e&&e.removeChild(t)}function v(t,e,n,r,i){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)n&&n(null),r&&r(t);else if("class"!==e||i)if("style"===e){if(r&&"string"!=typeof r&&"string"!=typeof n||(t.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var a in n)a in r||(t.style[a]="");for(var a in r)t.style[a]="number"==typeof r[a]&&!1===d.test(a)?r[a]+"px":r[a]}}else if("dangerouslySetInnerHTML"===e)r&&(t.innerHTML=r.__html||"");else if("o"==e[0]&&"n"==e[1]){var o=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),r?n||t.addEventListener(e,x,o):t.removeEventListener(e,x,o),(t._listeners||(t._listeners={}))[e]=r}else if("list"!==e&&"type"!==e&&!i&&e in t)!function(t,e,n){try{t[e]=n}catch(t){}}(t,e,null==r?"":r),null!=r&&!1!==r||t.removeAttribute(e);else{var s=i&&e!==(e=e.replace(/^xlink:?/,""));null==r||!1===r?s?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof r&&(s?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),r):t.setAttribute(e,r))}else t.className=r||""}function x(t){return this._listeners[t.type](i.event&&i.event(t)||t)}var w=[],k=0,O=!1,_=!1;function A(){for(var t;t=w.pop();)i.afterMount&&i.afterMount(t),t.componentDidMount&&t.componentDidMount()}function C(t,e,n,r,i,a){k++||(O=null!=i&&void 0!==i.ownerSVGElement,_=null!=t&&!("__preactattr_"in t));var o=E(t,e,n,r,a);return i&&o.parentNode!==i&&i.appendChild(o),--k||(_=!1,a||A()),o}function E(t,e,n,r,i){var a=t,o=O;if(null!=e&&"boolean"!=typeof e||(e=""),"string"==typeof e||"number"==typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||i)?t.nodeValue!=e&&(t.nodeValue=e):(a=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(a,t),S(t,!0))),a.__preactattr_=!0,a;var s,u,c=e.nodeName;if("function"==typeof c)return function(t,e,n,r){var i=t&&t._component,a=i,o=t,s=i&&t._componentConstructor===e.nodeName,u=s,c=b(e);for(;i&&!u&&(i=i._parentComponent);)u=i.constructor===e.nodeName;i&&u&&(!r||i._component)?(D(i,c,3,n,r),t=i.base):(a&&!s&&(M(a),t=o=null),i=T(e.nodeName,c,n),t&&!i.nextBase&&(i.nextBase=t,o=null),D(i,c,1,n,r),t=i.base,o&&t!==o&&(o._component=null,S(o,!1)));return t}(t,e,n,r);if(O="svg"===c||"foreignObject"!==c&&O,c=String(c),(!t||!g(t,c))&&(s=c,(u=O?document.createElementNS("http://www.w3.org/2000/svg",s):document.createElement(s)).normalizedNodeName=s,a=u,t)){for(;t.firstChild;)a.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(a,t),S(t,!0)}var l=a.firstChild,d=a.__preactattr_,f=e.children;if(null==d){d=a.__preactattr_={};for(var h=a.attributes,p=h.length;p--;)d[h[p].name]=h[p].value}return!_&&f&&1===f.length&&"string"==typeof f[0]&&null!=l&&void 0!==l.splitText&&null==l.nextSibling?l.nodeValue!=f[0]&&(l.nodeValue=f[0]):(f&&f.length||null!=l)&&function(t,e,n,r,i){var a,o,s,u,c,l=t.childNodes,d=[],f={},h=0,p=0,g=l.length,b=0,v=e?e.length:0;if(0!==g)for(var x=0;x<g;x++){var w=l[x],k=w.__preactattr_;null!=(O=v&&k?w._component?w._component.__key:k.key:null)?(h++,f[O]=w):(k||(void 0!==w.splitText?!i||w.nodeValue.trim():i))&&(d[b++]=w)}if(0!==v)for(x=0;x<v;x++){var O;if(u=e[x],c=null,null!=(O=u.key))h&&void 0!==f[O]&&(c=f[O],f[O]=void 0,h--);else if(!c&&p<b)for(a=p;a<b;a++)if(void 0!==d[a]&&m(o=d[a],u,i)){c=o,d[a]=void 0,a===b-1&&b--,a===p&&p++;break}c=E(c,u,n,r),s=l[x],c&&c!==t&&c!==s&&(null==s?t.appendChild(c):c===s.nextSibling?y(s):t.insertBefore(c,s))}if(h)for(var x in f)void 0!==f[x]&&S(f[x],!1);for(;p<=b;)void 0!==(c=d[b--])&&S(c,!1)}(a,f,n,r,_||null!=d.dangerouslySetInnerHTML),function(t,e,n){var r;for(r in n)e&&null!=e[r]||null==n[r]||v(t,r,n[r],n[r]=void 0,O);for(r in e)"children"===r||"innerHTML"===r||r in n&&e[r]===("value"===r||"checked"===r?t[r]:n[r])||v(t,r,n[r],n[r]=e[r],O)}(a,e.attributes,d),O=o,a}function S(t,e){var n=t._component;n?M(n):(null!=t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),!1!==e&&null!=t.__preactattr_||y(t),j(t))}function j(t){for(t=t.lastChild;t;){var e=t.previousSibling;S(t,!0),t=e}}var N={};function T(t,e,n){var r,i=N[t.name];if(t.prototype&&t.prototype.render?(r=new t(e,n),$.call(r,e,n)):((r=new $(e,n)).constructor=t,r.render=F),i)for(var a=i.length;a--;)if(i[a].constructor===t){r.nextBase=i[a].nextBase,i.splice(a,1);break}return r}function F(t,e,n){return this.constructor(t,n)}function D(t,e,n,r,a){t._disable||(t._disable=!0,(t.__ref=e.ref)&&delete e.ref,(t.__key=e.key)&&delete e.key,!t.base||a?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,r),r&&r!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=r),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==n&&(1!==n&&!1===i.syncComponentUpdates&&t.base?h(t):I(t,1,a)),t.__ref&&t.__ref(t))}function I(t,e,n,r){if(!t._disable){var a,o,s,c=t.props,l=t.state,d=t.context,f=t.prevProps||c,h=t.prevState||l,p=t.prevContext||d,m=t.base,g=t.nextBase,y=m||g,v=t._component,x=!1;if(m&&(t.props=f,t.state=h,t.context=p,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(c,l,d)?x=!0:t.componentWillUpdate&&t.componentWillUpdate(c,l,d),t.props=c,t.state=l,t.context=d),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!x){a=t.render(c,l,d),t.getChildContext&&(d=u(u({},d),t.getChildContext()));var O,_,E=a&&a.nodeName;if("function"==typeof E){var j=b(a);(o=v)&&o.constructor===E&&j.key==o.__key?D(o,j,1,d,!1):(O=o,t._component=o=T(E,j,d),o.nextBase=o.nextBase||g,o._parentComponent=t,D(o,j,0,d,!1),I(o,1,n,!0)),_=o.base}else s=y,(O=v)&&(s=t._component=null),(y||1===e)&&(s&&(s._component=null),_=C(s,a,d,n||!m,y&&y.parentNode,!0));if(y&&_!==y&&o!==v){var N=y.parentNode;N&&_!==N&&(N.replaceChild(_,y),O||(y._component=null,S(y,!1)))}if(O&&M(O),t.base=_,_&&!r){for(var F=t,$=t;$=$._parentComponent;)(F=$).base=_;_._component=F,_._componentConstructor=F.constructor}}if(!m||n?w.unshift(t):x||(t.componentDidUpdate&&t.componentDidUpdate(f,h,p),i.afterUpdate&&i.afterUpdate(t)),null!=t._renderCallbacks)for(;t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);k||r||A()}}function M(t){i.beforeUnmount&&i.beforeUnmount(t);var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var n=t._component;n?M(n):e&&(e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),t.nextBase=e,y(e),function(t){var e=t.constructor.name;(N[e]||(N[e]=[])).push(t)}(t),j(e)),t.__ref&&t.__ref(null)}function $(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{}}function R(t,e,n){return C(n,t,{},!1,e,!1)}u($.prototype,{setState:function(t,e){var n=this.state;this.prevState||(this.prevState=u({},n)),u(n,"function"==typeof t?t(n,this.props):t),e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),h(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),I(this,2)},render:function(){}});var B={h:s,createElement:s,cloneElement:l,Component:$,render:R,rerender:p,options:i};e.default=B},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(75),o=i(n(121)),s=n(95),u=n(171),c=n(172),l={maxBins:12,fontSize:11};e.histogram=function(t,e,n={}){return r(this,void 0,void 0,(function*(){const r=function(t){if(null==t.length)throw new Error("input data must be an array");if(0===t.length)return[];if("object"==typeof t[0]){if(null==t[0].value)throw new Error("input data must have a value field");return t}{const e=Array(t.length);for(let n=0;n<t.length;n++)e[n]={value:t[n]};return e}}(e),i=Object.assign({},l,n),d=s.subSurface(t,"histogram");if(!1!==n.stats){const e=s.subSurface(t,"stats",{prepend:!0});let o;o=n.stats?n.stats:u.arrayStats(r.map(t=>t.value)),function(t,e,n){const r=a.format(",.4~f"),i=a.format(".4~p"),o=[],s=[];null!=t.numVals&&(o.push("Num Vals"),s.push(r(t.numVals)));null!=t.min&&(o.push("Min"),s.push(r(t.min)));null!=t.max&&(o.push("Max"),s.push(r(t.max)));if(null!=t.numZeros){o.push("# Zeros");let e="";t.numVals&&(e=t.numZeros>0?`(${i(t.numZeros/t.numVals)})`:""),s.push(`${r(t.numZeros)} ${e}`)}if(null!=t.numNans){o.push("# NaNs");let e="";t.numVals&&(e=t.numNans>0?`(${i(t.numNans/t.numVals)})`:""),s.push(`${r(t.numNans)} ${e}`)}if(null!=t.numInfs){o.push("# Infinity");let e="";t.numVals&&(e=t.numInfs>0?`(${i(t.numInfs/t.numVals)})`:""),s.push(`${r(t.numInfs)} ${e}`)}c.table(e,{headers:o,values:[s]},n)}(o,e,{fontSize:i.fontSize})}if(0===r.length)return;const f=[];for(let t=0;t<r.length;t++){const e=r[t].value;null!=e&&isFinite(e)&&f.push(r[t])}const h={width:i.width||s.getDefaultWidth(d),height:i.height||s.getDefaultHeight(d),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:f},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},encoding:{x:{bin:{maxbins:i.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:i.color||"#001B44"}}};return o.default(d,h,{actions:!1,mode:"vega-lite",defaultStyle:!1})}))}},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"maxNorm",(function(){return G})),n.d(r,"unitNorm",(function(){return H})),n.d(r,"nonNeg",(function(){return X})),n.d(r,"minMaxNorm",(function(){return K}));var i={};n.r(i),n.d(i,"zeros",(function(){return te})),n.d(i,"ones",(function(){return ee})),n.d(i,"constant",(function(){return ne})),n.d(i,"randomUniform",(function(){return re})),n.d(i,"randomNormal",(function(){return ie})),n.d(i,"truncatedNormal",(function(){return ae})),n.d(i,"identity",(function(){return oe})),n.d(i,"varianceScaling",(function(){return se})),n.d(i,"glorotUniform",(function(){return ue})),n.d(i,"glorotNormal",(function(){return ce})),n.d(i,"heNormal",(function(){return le})),n.d(i,"heUniform",(function(){return de})),n.d(i,"leCunNormal",(function(){return fe})),n.d(i,"leCunUniform",(function(){return he})),n.d(i,"orthogonal",(function(){return pe}));var a={};n.r(a),n.d(a,"inputLayer",(function(){return fa})),n.d(a,"elu",(function(){return ha})),n.d(a,"reLU",(function(){return pa})),n.d(a,"leakyReLU",(function(){return ma})),n.d(a,"prelu",(function(){return ga})),n.d(a,"softmax",(function(){return ba})),n.d(a,"thresholdedReLU",(function(){return ya})),n.d(a,"conv1d",(function(){return va})),n.d(a,"conv2d",(function(){return xa})),n.d(a,"conv2dTranspose",(function(){return wa})),n.d(a,"conv3d",(function(){return ka})),n.d(a,"separableConv2d",(function(){return Oa})),n.d(a,"cropping2D",(function(){return _a})),n.d(a,"upSampling2d",(function(){return Aa})),n.d(a,"depthwiseConv2d",(function(){return Ca})),n.d(a,"activation",(function(){return Ea})),n.d(a,"dense",(function(){return Sa})),n.d(a,"dropout",(function(){return ja})),n.d(a,"spatialDropout1d",(function(){return Na})),n.d(a,"flatten",(function(){return Ta})),n.d(a,"repeatVector",(function(){return Fa})),n.d(a,"reshape",(function(){return Da})),n.d(a,"permute",(function(){return Ia})),n.d(a,"embedding",(function(){return Ma})),n.d(a,"add",(function(){return $a})),n.d(a,"average",(function(){return Ra})),n.d(a,"concatenate",(function(){return Ba})),n.d(a,"maximum",(function(){return za})),n.d(a,"minimum",(function(){return La})),n.d(a,"multiply",(function(){return Pa})),n.d(a,"dot",(function(){return qa})),n.d(a,"batchNormalization",(function(){return Wa})),n.d(a,"layerNormalization",(function(){return Ua})),n.d(a,"zeroPadding2d",(function(){return Va})),n.d(a,"averagePooling1d",(function(){return Ga})),n.d(a,"avgPool1d",(function(){return Ha})),n.d(a,"avgPooling1d",(function(){return Xa})),n.d(a,"averagePooling2d",(function(){return Ka})),n.d(a,"avgPool2d",(function(){return Ya})),n.d(a,"avgPooling2d",(function(){return Ja})),n.d(a,"averagePooling3d",(function(){return Za})),n.d(a,"avgPool3d",(function(){return Qa})),n.d(a,"avgPooling3d",(function(){return to})),n.d(a,"globalAveragePooling1d",(function(){return eo})),n.d(a,"globalAveragePooling2d",(function(){return no})),n.d(a,"globalMaxPooling1d",(function(){return ro})),n.d(a,"globalMaxPooling2d",(function(){return io})),n.d(a,"maxPooling1d",(function(){return ao})),n.d(a,"maxPooling2d",(function(){return oo})),n.d(a,"maxPooling3d",(function(){return so})),n.d(a,"gru",(function(){return uo})),n.d(a,"gruCell",(function(){return co})),n.d(a,"lstm",(function(){return lo})),n.d(a,"lstmCell",(function(){return fo})),n.d(a,"simpleRNN",(function(){return ho})),n.d(a,"simpleRNNCell",(function(){return po})),n.d(a,"convLstm2d",(function(){return mo})),n.d(a,"convLstm2dCell",(function(){return go})),n.d(a,"rnn",(function(){return bo})),n.d(a,"stackedRNNCells",(function(){return yo})),n.d(a,"bidirectional",(function(){return vo})),n.d(a,"timeDistributed",(function(){return xo})),n.d(a,"globalMaxPool1d",(function(){return wo})),n.d(a,"globalMaxPool2d",(function(){return ko})),n.d(a,"maxPool1d",(function(){return Oo})),n.d(a,"maxPool2d",(function(){return _o})),n.d(a,"Layer",(function(){return Fe})),n.d(a,"RNN",(function(){return ai})),n.d(a,"RNNCell",(function(){return oi})),n.d(a,"input",(function(){return or})),n.d(a,"gaussianNoise",(function(){return Ao})),n.d(a,"gaussianDropout",(function(){return Co})),n.d(a,"alphaDropout",(function(){return Eo})),n.d(a,"masking",(function(){return So}));var o={};n.r(o),n.d(o,"binaryAccuracy",(function(){return jo})),n.d(o,"binaryCrossentropy",(function(){return No})),n.d(o,"sparseCategoricalAccuracy",(function(){return To})),n.d(o,"categoricalAccuracy",(function(){return Fo})),n.d(o,"categoricalCrossentropy",(function(){return Do})),n.d(o,"precision",(function(){return Io})),n.d(o,"recall",(function(){return Mo})),n.d(o,"cosineProximity",(function(){return $o})),n.d(o,"meanAbsoluteError",(function(){return Ro})),n.d(o,"meanAbsolutePercentageError",(function(){return Bo})),n.d(o,"MAPE",(function(){return zo})),n.d(o,"mape",(function(){return Lo})),n.d(o,"meanSquaredError",(function(){return Po})),n.d(o,"MSE",(function(){return qo})),n.d(o,"mse",(function(){return Wo}));var s={};n.r(s),n.d(s,"modelFromJSON",(function(){return tr}));var u={};n.r(u),n.d(u,"l1l2",(function(){return Uo})),n.d(u,"l1",(function(){return Vo})),n.d(u,"l2",(function(){return Go}));var c={};n.r(c),n.d(c,"array",(function(){return tl})),n.d(c,"Dataset",(function(){return Zc})),n.d(c,"zip",(function(){return el})),n.d(c,"CSVDataset",(function(){return cl})),n.d(c,"TextLineDataset",(function(){return rl})),n.d(c,"csv",(function(){return vl})),n.d(c,"func",(function(){return xl})),n.d(c,"generator",(function(){return wl})),n.d(c,"microphone",(function(){return Ol})),n.d(c,"webcam",(function(){return kl})),n.d(c,"FileDataSource",(function(){return bl})),n.d(c,"URLDataSource",(function(){return yl})),n.d(c,"version_data",(function(){return _l}));var l={};n.r(l),n.d(l,"simpleAbsImpl",(function(){return cd})),n.d(l,"addImpl",(function(){return td})),n.d(l,"bincountImpl",(function(){return Gd})),n.d(l,"bincountReduceImpl",(function(){return Hd})),n.d(l,"ceilImpl",(function(){return Yd})),n.d(l,"concatImpl",(function(){return nf})),n.d(l,"expImpl",(function(){return Wf})),n.d(l,"expm1Impl",(function(){return Xf})),n.d(l,"floorImpl",(function(){return ph})),n.d(l,"gatherV2Impl",(function(){return Oh})),n.d(l,"greaterImpl",(function(){return Ah})),n.d(l,"lessImpl",(function(){return Bh})),n.d(l,"linSpaceImpl",(function(){return Uh})),n.d(l,"logImpl",(function(){return Gh})),n.d(l,"maxImpl",(function(){return sp})),n.d(l,"maximumImpl",(function(){return lp})),n.d(l,"minimumImpl",(function(){return kp})),n.d(l,"multiplyImpl",(function(){return Jf})),n.d(l,"negImpl",(function(){return Fp})),n.d(l,"notEqualImpl",(function(){return Lp})),n.d(l,"prodImpl",(function(){return Qp})),n.d(l,"rangeImpl",(function(){return em})),n.d(l,"rsqrtImpl",(function(){return hm})),n.d(l,"sliceImpl",(function(){return qd})),n.d(l,"squaredDifferenceImpl",(function(){return Lm})),n.d(l,"stridedSliceImpl",(function(){return Vm})),n.d(l,"subImpl",(function(){return ih})),n.d(l,"tileImpl",(function(){return Jm})),n.d(l,"topKImpl",(function(){return Qm})),n.d(l,"transposeImpl",(function(){return gd})),n.d(l,"uniqueImpl",(function(){return eg}));var d=n(0);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let f;function h(){return null==f&&(f=Object(d.Kd)().epsilon()),f}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class p extends Error{constructor(t){super(t),Object.setPrototypeOf(this,p.prototype)}}class m extends Error{constructor(t){super(t),Object.setPrototypeOf(this,m.prototype)}}class g extends Error{constructor(t){super(t),Object.setPrototypeOf(this,g.prototype)}}class b extends Error{constructor(t){super(t),Object.setPrototypeOf(this,b.prototype)}}class y extends Error{constructor(t){super(t),Object.setPrototypeOf(this,y.prototype)}}Error;
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function v(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}{const n=new Array(e);return n.fill(t),n}}function x(t,e){if(!t)throw new y(e)}function w(t,e){let n=0;for(const r of t)r===e&&n++;return n}function k(t){return 1===t.length?t[0]:t}function O(t){return Array.isArray(t)?t:[t]}function _(t){const e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function A(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,(t,e)=>e.toUpperCase())}let C={};function E(t){if(null==t)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function S(t,e={},n={},r="object",i=!1){if("string"==typeof t){const i=t;let a;if(i in n)a=n[i];else if(i in C)a=C[i];else if(a=e[i],null==a)throw new g(`Unknown ${r}: ${t}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return a}{const a=t;if(null==a.className||null==a.config)throw new g(r+": Improper config format: "+JSON.stringify(a)+".\n'className' and 'config' must set.");const o=a.className;let s,u;if(o in n?[s,u]=n[o]:o in C?[s,u]=C.className:o in e&&([s,u]=e[o]),null==s)throw new g(`Unknown ${r}: ${o}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(null!=u){const t={};for(const e of Object.keys(C))t[e]=C[e];for(const e of Object.keys(n))t[e]=n[e];a.config.customObjects=t;const e=Object.assign({},C);for(const t of Object.keys(n))C[t]=n[t];!function t(e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))e.forEach(e=>t(e));else{const n=Object.keys(e);for(const r of n){const n=e[r];null!=n&&"object"==typeof n&&(Array.isArray(n)||"ndarray"!==n.type||"number"!=typeof n.value?t(n):e[r]=n.value)}}}(a.config);const r=u(s,a.config,n,i);return C=Object.assign({},e),r}{const t=Object.assign({},C);for(const t of Object.keys(n))C[t]=n[t];const e=new s(a.config);return C=Object.assign({},t),e}}}function j(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function N(t){if(null==t)return t;const e=[];for(const n of t)-1===e.indexOf(n)&&e.push(n);return e}function T(t){if(null==t)throw new g("Invalid value in obj: "+JSON.stringify(t));for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function F(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new g(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function D(t,e,n=0,r=1/0){return x(n>=0),x(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(t=>typeof t===e)}function I(t,e){Array.isArray(t)?(d.qi.assert(t.length>0,()=>e+" is unexpectedly an empty array."),t.forEach((t,n)=>I(t,`element ${n+1} of ${e}`))):d.qi.assert(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got `+function t(e){return null===e?"null":Array.isArray(e)?"["+e.map(e=>t(e)).join(",")+"]":"string"==typeof e?`"${e}"`:""+e}(t)+".")}function M(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function $(t,e){return Object(d.di)(()=>d.Gh(d.Qh(d.jg(t,t),e,!0)))}class R extends d.lh.Serializable{getConfig(){return{}}}class B extends R{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Object(d.di)(()=>{const e=$(t,this.axis),n=d.Zd(e,0,this.maxValue);return d.jg(t,d.Ce(n,d.wd(h(),e)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}B.className="MaxNorm",d.lh.registerClass(B);class z extends R{constructor(t){super(),this.defaultAxis=0,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Object(d.di)(()=>d.Ce(t,d.wd(h(),$(t,this.axis))))}getConfig(){return{axis:this.axis}}}z.className="UnitNorm",d.lh.registerClass(z);class L extends R{apply(t){return d.Ug(t)}}L.className="NonNeg",d.lh.registerClass(L);class P extends R{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=t.minValue?t.minValue:this.defaultMinValue,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.rate=null!=t.rate?t.rate:this.defaultRate,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Object(d.di)(()=>{const e=$(t,this.axis),n=d.wd(d.jg(this.rate,d.Zd(e,this.minValue,this.maxValue)),d.jg(1-this.rate,e));return d.jg(t,d.Ce(n,d.wd(h(),e)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}P.className="MinMaxNorm",d.lh.registerClass(P);const q={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function W(t){return E(t)}function U(t,e={}){return S(t,d.lh.SerializationMap.getMap().classNameMap,e,"constraint")}function V(t){if(null==t)return null;if("string"==typeof t){return U({className:t in q?q[t]:t,config:{}})}return t instanceof R?t:U(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function G(t){return new B(t)}function H(t){return new z(t)}function X(){return new L}function K(t){return new P(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Y=["channelsFirst","channelsLast"],J=["nearest","bilinear"],Z=["valid","same","causal"],Q=["max","avg"],tt=["sum","mul","concat","ave"],et=new Map;function nt(t){F(Y,"DataFormat",t)}function rt(t){F(Z,"PaddingMode",t)}function it(t){F(Q,"PoolMode",t)}const at=[];function ot(t,e){at.push(t);try{const t=e();return at.pop(),t}catch(t){throw at.pop(),t}}function st(t){if(!lt(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===at.length?"":at.join("/")+"/")+t}function ut(t){if(!lt(t))throw new Error("Not a valid tensor name: '"+t+"'");et.has(t)||et.set(t,0);const e=et.get(t);if(et.set(t,et.get(t)+1),e>0){const n=`${t}_${e}`;return et.set(n,1),n}return t}const ct=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function lt(t){return!!t.match(ct)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dt(t,e,n){null==e&&(e=0),null==n&&(n=t.length);let r=1;for(let i=e;i<n;++i)r*=t[i];return r}function ft(t){return t=Array.isArray(t)?new Float32Array(t):t,Object(d.Vh)(t)}function ht(t){return d.bg(ft(t)).dataSync()[0]}function pt(t){return d.Tf(ft(t)).dataSync()[0]}function mt(t,e){if(e<t)throw new g(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gt(t,e){return t.asType(e)}function bt(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),t.reshape(n)}function yt(t,e,n){return Object(d.di)(()=>{switch(t.rank){case 1:return d.vh(t,e,n);case 2:return d.wh(t,[e,0],[n,t.shape[1]]);case 3:return d.xh(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return d.yh(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return d.uh(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return d.uh(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new g("sliceAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}})}function vt(t,e,n){return Object(d.di)(()=>{switch(t.rank){case 1:return d.vh(t,e,n);case 2:return d.wh(t,[0,e],[t.shape[0],n]);case 3:return d.xh(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return d.yh(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new g("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}})}function xt(t,e,n,r){return Object(d.di)(()=>{switch(t.rank){case 1:return d.vh(t,e,n);case 2:switch(r){case 1:return yt(t,e,n);case 2:return vt(t,e,n);default:throw new g("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return yt(t,e,n);case 2:return d.xh(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return vt(t,e,n);default:throw new g("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return yt(t,e,n);case 2:return d.yh(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return d.yh(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return vt(t,e,n);default:throw new g("The axis is not within the rank of the tensor "+r)}default:throw new g("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}})}function wt(t,e=-1){let n;return e<0&&(n=t[0].rank,e=0!==n?n:0),e===t[0].rank&&(e=-1),d.ce(t,e)}function kt(t,e){switch(t.rank){case 1:return d.de([t,e]);case 2:return d.ee([t,e],0);case 3:return d.fe([t,e],0);case 4:return d.ge([t,e],0);default:throw new g("concatAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}}function Ot(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new g(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return d.ei(t,e)}function _t(t,e=0,n=1,r,i){return d.Lg(t,e,n,r,i)}function At(t,e,n,r){if(t.rank<2||e.rank<2)throw new b(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){if(t.shape.slice(-1)[0]!==e.shape.slice(-2)[0])throw new b(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = `+e.shape)}if(2===t.rank&&2===e.rank){const i=!1,a=!1;return d.af.matMul({a:t,b:e,transposeA:i,transposeB:a,bias:r?St(t.rank,r,"channelsLast"):null,activation:n})}{const i=t.shape.slice(),a=i.pop();t=t.reshape([-1,a]);const o=e.shape.slice(),s=o.pop(),u=o.pop(),c=[...o,s],l=Array.from({length:e.rank},(t,n)=>0===n?e.rank-2:n<=e.rank-2?n-1:n);e=e.transpose(l).reshape([u,-1]);const f=[...i,...c],h=!1,p=!1;return d.af.matMul({a:t,b:e,transposeA:h,transposeB:p,bias:r?St(t.rank,r,"channelsLast"):null,activation:n}).reshape(f)}}function Ct(t,e,n){return Object(d.di)(()=>(e=Array.isArray(e)?Object(d.Vh)(e,"int32"):e.toInt(),d.bf(t,e,n)))}function Et(t){return d.jg(t,t)}function St(t,e,n){const r=e.shape;if(1!==e.rank&&e.rank!==t)throw new g("Unexpected bias dimensions: "+e.rank+"; expected it to be 1 or "+t);if(5===t){if("channelsFirst"===n)return 1===r.length?e.reshape([1,r[0],1,1,1]):e.reshape([1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?e.reshape([1,1,1,1,r[0]]):e.reshape([1].concat(r))}else if(4===t){if("channelsFirst"===n)return 1===r.length?e.reshape([1,r[0],1,1]):e.reshape([1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?e.reshape([1,1,1,r[0]]):e.reshape([1].concat(r))}else if(3===t){if("channelsFirst"===n)return 1===r.length?e.reshape([1,r[0],1]):e.reshape([1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?e.reshape([1,1,r[0]]):e.reshape([1].concat(r))}else if(t<3)return e;throw new g("Unsupported input rank by biasAdd: "+e.rank)}function jt(t,e,n){return Object(d.di)(()=>(null==n&&(n="channelsLast"),nt(n),t.add(St(t.rank,e,n))))}function Nt(t,e,n,r){return Object(d.di)(()=>d.Ge(t,e,n,r))}function Tt(t,e,n=!1){return n?t():e()}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Ft=["fanIn","fanOut","fanAvg"],Dt=["normal","uniform","truncatedNormal"];class It extends d.lh.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class Mt extends It{apply(t,e){return Object(d.yi)(t,e)}}Mt.className="Zeros",d.lh.registerClass(Mt);class $t extends It{apply(t,e){return Object(d.tg)(t,e)}}$t.className="Ones",d.lh.registerClass($t);class Rt extends It{constructor(t){if(super(),"object"!=typeof t)throw new g("Expected argument of type ConstantConfig but got "+t);if(void 0===t.value)throw new g("config must have value set but got "+t);this.value=t.value}apply(t,e){return Object(d.di)(()=>Object(d.jg)(Object(d.gh)(this.value),Object(d.tg)(t,e)))}getConfig(){return{value:this.value}}}Rt.className="Constant",d.lh.registerClass(Rt);class Bt extends It{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,e){return Object(d.Mg)(t,this.minval,this.maxval,e)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}Bt.className="RandomUniform",d.lh.registerClass(Bt);class zt extends It{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new b(`randomNormal does not support dType ${e}.`);return _t(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}zt.className="RandomNormal",d.lh.registerClass(zt);class Lt extends It{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new b(`truncatedNormal does not support dType ${e}.`);return Object(d.ji)(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Lt.className="TruncatedNormal",d.lh.registerClass(Lt);class Pt extends It{constructor(t){super(),this.gain=null!=t.gain?t.gain:1}apply(t,e){return Object(d.di)(()=>{if(2!==t.length||t[0]!==t[1])throw new g("Identity matrix initializer can only be used for 2D square matrices.");return Object(d.jg)(this.gain,Object(d.Te)(t[0]))})}getConfig(){return{gain:this.gain}}}Pt.className="Identity",d.lh.registerClass(Pt);class qt extends It{constructor(t){if(super(),t.scale<0)throw new g("scale must be a positive float. Got: "+t.scale);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
var e;this.scale=null==t.scale?1:t.scale,this.mode=null==t.mode?"fanIn":t.mode,e=this.mode,F(Ft,"FanMode",e),this.distribution=null==t.distribution?"normal":t.distribution,function(t){F(Dt,"Distribution",t)}(this.distribution),this.seed=t.seed}apply(t,e){const n=function(t,e="channelsLast"){let n,r;if(nt(e),2===t.length)n=t[0],r=t[1];else if(-1!==[3,4,5].indexOf(t.length)){if("channelsFirst"===e){const e=dt(t,2);n=t[1]*e,r=t[0]*e}else if("channelsLast"===e){const e=dt(t,0,t.length-2);n=t[t.length-2]*e,r=t[t.length-1]*e}}else{const e=dt(t);n=Math.sqrt(e),r=Math.sqrt(e)}return[n,r]}(t),r=n[0],i=n[1];let a=this.scale;if("fanIn"===this.mode?a/=Math.max(1,r):"fanOut"===this.mode?a/=Math.max(1,i):a/=Math.max(1,(r+i)/2),"normal"===this.distribution){const n=Math.sqrt(a);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new b(`${this.getClassName()} does not support dType ${e}.`);return Object(d.ji)(t,0,n,e,this.seed)}{const n=Math.sqrt(3*a);return Object(d.Mg)(t,-n,n,e)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}qt.className="VarianceScaling",d.lh.registerClass(qt);class Wt extends qt{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return qt.className}}Wt.className="GlorotUniform",d.lh.registerClass(Wt);class Ut extends qt{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return qt.className}}Ut.className="GlorotNormal",d.lh.registerClass(Ut);class Vt extends qt{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return qt.className}}Vt.className="HeNormal",d.lh.registerClass(Vt);class Gt extends qt{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return qt.className}}Gt.className="HeUniform",d.lh.registerClass(Gt);class Ht extends qt{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return qt.className}}Ht.className="LeCunNormal",d.lh.registerClass(Ht);class Xt extends qt{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return qt.className}}Xt.className="LeCunNormal",d.lh.registerClass(Xt);class Kt extends It{constructor(t){if(super(),this.DEFAULT_GAIN=1,this.gain=null==t.gain?this.DEFAULT_GAIN:t.gain,this.seed=t.seed,null!=this.seed)throw new b("Random seed is not implemented for Orthogonal Initializer yet.")}apply(t,e){return Object(d.di)(()=>{if(t.length<2)throw new b("Shape must be at least 2D.");t[0]*t[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${t[0]*t[1]}) elements: Slowness may result.`);const e=_t(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32");let n=d.Ef.gramSchmidt(e);return t[0]>t[1]&&(n=n.transpose()),Object(d.jg)(this.gain,n)})}getConfig(){return{gain:this.gain,seed:this.seed}}}Kt.className="Orthogonal",d.lh.registerClass(Kt);const Yt={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Jt(t,e={}){return S(t,d.lh.SerializationMap.getMap().classNameMap,e,"initializer")}function Zt(t){return E(t)}function Qt(t){if("string"==typeof t){const e=t in Yt?Yt[t]:t;if("GlorotNormal"===e)return new Ut;if("GlorotUniform"===e)return new Wt;if("HeNormal"===e)return new Vt;if("HeUniform"===e)return new Gt;if("LeCunNormal"===e)return new Ht;if("LeCunUniform"===e)return new Xt;{const t={};return t.className=e,t.config={},Jt(t)}}return t instanceof It?t:Jt(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function te(){return new Mt}function ee(){return new $t}function ne(t){return new Rt(t)}function re(t){return new Bt(t)}function ie(t){return new zt(t)}function ae(t){return new Lt(t)}function oe(t){return new Pt(t)}function se(t){return new qt(t)}function ue(t){return new Wt(t)}function ce(t){return new Ut(t)}function le(t){return new Vt(t)}function de(t){return new Gt(t)}function fe(t){return new Ht(t)}function he(t){return new Xt(t)}function pe(t){return new Kt(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let me=0;function ge(){return me++}const be={};function ye(t=""){return t in be||(be[t]=0),be[t]+=1,t+be[t].toString()}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ve(t){return Array.isArray(t)&&Array.isArray(t[0])}function xe(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function we(t){let e;if(Array.isArray(t)){if(1!==t.length)throw new g("Expected Tensor length to be 1; got "+t.length);e=t[0]}else e=t;return e}function ke(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return(t=t)[0];throw new g("Expected exactly 1 Shape; got "+t.length)}return t}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Oe(t){let e=0;for(const n of t)0===n.shape.length?e+=1:e+=n.shape.reduce((t,e)=>t*e);return e}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _e{constructor(t,e="float32",n="Variable",r=!0,i=null){this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=ge(),n=null==n?"Variable":n,this.originalName=st(n),this.name=ut(this.originalName),this.trainable_=r,this.constraint=i,this.val=d.ti(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function Ae(t){return t.map(t=>t.read())}function Ce(t){t.forEach(t=>{t[0].write(t[1])})}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class Ee{constructor(t){this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class Se{constructor(t,e,n,r,i,a,o){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=o,this.id=ge(),null!=a&&(this.originalName=st(a),this.name=ut(this.originalName)),this.rank=e.length}}let je=0;class Ne{constructor(t,e){this.callArgs=e,this.id=je++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const e of t.inboundLayers)null!=e&&e.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)null!=e?t.push(e.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Te=0;class Fe extends d.lh.Serializable{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Te++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const t=this.getClassName();e=_(t)+"_"+ye(t)}if(this.name=e,this.trainable_=null==t.trainable||t.trainable,null!=t.inputShape||null!=t.batchInputShape){let e;if(null!=t.batchInputShape)e=t.batchInputShape;else if(null!=t.inputShape){let n=null;null!=t.batchSize&&(n=t.batchSize),e=[n].concat(t.inputShape)}this.batchInputShape=e;let n=t.dtype;null==n&&(n=t.inputDType),null==n&&(n="float32"),this.dtype=n}null!=t.weights?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new m(`The layer has never been called and thus has no defined ${e}.`);if(this.inboundNodes.length<=t)throw new g(`Asked to get ${e} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return k(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return k(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new p("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new p("Layer "+this.name+" is not connected, no input to return.");return k(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new p("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new p("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return k(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(e=>e.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=O(t),null==this.inputSpec||0===this.inputSpec.length)return;const e=O(this.inputSpec);if(t.length!==e.length)throw new g(`Layer ${this.name} expects ${e.length} inputs, but it received ${t.length} input tensors. Input received: `+t);for(let n=0;n<t.length;n++){const r=t[n],i=e[n];if(null==i)continue;const a=r.rank;if(null!=i.ndim&&a!==i.ndim)throw new g(`Input ${n} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${a}`);if(null!=i.maxNDim&&a>i.maxNDim)throw new g(`Input ${n} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(null!=i.minNDim&&a<i.minNDim)throw new g(`Input ${n} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(null!=i.dtype&&r.dtype!==i.dtype)throw new g(`Input ${n} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${r.dtype}.`);if(i.axes){const t=r.shape;for(const e in i.axes){const r=Number(e),a=i.axes[e],o=r>=0?t[r]:t[t.length+r];if(null!=a&&-1===[a,null].indexOf(o))throw new g(`Input ${n} is incompatible with layer ${this.name}: expected axis ${r} of input shape to have value ${a} but got shape ${t}.`)}}if(null!=i.shape)for(let t=0;t<i.shape.length;++t){const e=i.shape[t],a=r.shape[t];if(null!=e&&null!=a&&e!==a)throw new g(`Input ${n} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${r.shape}.`)}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const n=O(t);let r=!0;for(const t of n)if(!(t instanceof Se)){r=!1;break}let i=!0;for(const t of n)if(t instanceof Se){i=!1;break}if(r===i)throw new g("Arguments to apply() must be all SymbolicTensors or all Tensors");return ot(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const e=[];for(const n of O(t))e.push(n.shape);this.build(k(e)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&i&&(this._refCount=1)}if(this.assertInputCompatibility(t),i){let r=this.call(t,e);const i=O(r),a=[];for(let t of i)-1!==n.indexOf(t)&&(t=t.clone()),a.push(t);if(r=k(a),null!=this.activityRegularizer)throw new b("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=function(t){t=O(t);const e=[];for(const n of t)e.push(n.shape);return k(e)}(t),r=this.computeOutputShape(n);let i;const a="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(t)?n[0]:n),i=null!=r&&r.length>0&&Array.isArray(r[0])?r.map((n,r)=>new Se(a,n,this,O(t),e,this.name,r)):new Se(a,r,this,O(t),e,this.name),this.addInboundNode(t,i,null,null,n,r,e),this._refCount++,null!=this.activityRegularizer)throw new b("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}})}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(t)+") does not match that of the "+`batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer `+this.name);else{let e=!1;this.batchInputShape.forEach((n,r)=>{null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)}),e&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: `+JSON.stringify(this.batchInputShape))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new p(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const e of this.inboundNodes){const n=JSON.stringify(e.outputShapes);-1===t.indexOf(n)&&t.push(n)}if(1===t.length){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&1===t.length?t[0]:t}throw new p(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new m(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Oe(this.weights)}build(t){this.built=!0}getWeights(t=!1){return Ae(t?this.trainableWeights:this.weights)}setWeights(t){Object(d.di)(()=>{const e=this.weights;if(e.length!==t.length)throw new g(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${e.length} weights. Provided weights: ${t}...`);if(0===e.length)return;const n=[],r=Ae(e);for(let i=0;i<r.length;++i){const a=r[i],o=e[i],s=t[i];if(!d.qi.arraysEqual(a.shape,s.shape))throw new g(`Layer weight shape ${a.shape} not compatible with provided weight shape `+s.shape);n.push([o,s])}Ce(n)})}addWeight(t,e,n,r,i,a,o){if(-1!==this._addedWeightNames.indexOf(t))throw new g(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=Qt("zeros"));const s=r.apply(e,n),u=new _e(s,n,t,a,o);return s.dispose(),null!=i&&this.addLoss(()=>i.apply(u.read())),null==a&&(a=!0),a?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=O(t),void 0!==this._losses&&null!==this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);e.forEach(t=>{if(null!=t)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)})}return null}return e}addInboundNode(t,e,n,r,i,a,o=null){const s=O(t);e=O(e),n=O(n),r=O(r),i=xe(i),a=xe(a);const u=[],c=[],l=[];for(const t of s)u.push(t.sourceLayer),c.push(t.nodeIndex),l.push(t.tensorIndex);new Ne({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:l,inputTensors:s,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:a},o);for(let t=0;t<e.length;t++)e[t].sourceLayer=this,e[t].nodeIndex=this.inboundNodes.length-1,e[t].tensorIndex=t}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class De extends Fe{constructor(t){if(super({dtype:t.dtype,name:null!=t.name?t.name:ye("input").toString()}),null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new g("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let e=t.batchInputShape;if(null==e){if(null==t.inputShape)throw new g("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");e=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new g("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=t.dtype||"float32";this.batchInputShape=e,this.dtype=n,this.inputSpec=[{shape:e}];const r=new Se(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Ne({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[e],outputShapes:[e]})}apply(t,e){throw new g("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}function Ie(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new g("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));let n=t.dtype;null==n&&(n="float32");return new De({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Me(t){if(null==t)return;const e=[],n=[],r=[];for(const i in t){const a=t[i];if("number"!=typeof a){const t=a;e.push(t.data()),n.push(i),r.push(t)}}if(e.length>0){const i=await Promise.all(e);for(let e=0;e<i.length;++e)t[n[e]]=i[e][0];Object(d.Ae)(r)}}function $e(t){if(null!=t)for(const e in t){const n=t[e];"number"!=typeof n&&n.dispose()}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Re;De.className="InputLayer",d.lh.registerClass(De),function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(Re||(Re={}));class Be{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,e){}async onEpochEnd(t,e){}async onBatchBegin(t,e){}async onBatchEnd(t,e){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class ze{constructor(t,e=10){null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}async onEpochBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochBegin(t,e)}async onEpochEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochEnd(t,e)}async onBatchBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchBegin(t,e)}async onBatchEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchEnd(t,e)}async onTrainBegin(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainBegin(t)}async onTrainEnd(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainEnd(t)}}class Le extends Be{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,e){null==e&&(e={});const n=null==e.size?0:e.size;this.seen+=n;for(const t in e){const r=e[t];if("number"==typeof r)this.totals.hasOwnProperty(t)||(this.totals[t]=0),this.totals[t]=this.totals[t]+r*n;else{let e;t in this.totals?e=this.totals[t]:this.totals[t]=0;const i=Object(d.di)(()=>Object(d.wd)(this.totals[t],Object(d.jg)(r,n)));this.totals[t]=i,null!=e&&e.dispose()}}}async onEpochEnd(t,e){if(null!=e)for(const t of this.params.metrics)null!=this.totals[t]&&("number"==typeof this.totals[t]?e[t]=this.totals[t]/this.seen:Object(d.di)(()=>{const n=Object(d.jg)(Object(d.Ce)(1,this.seen),this.totals[t]);e[t]=n,this.totals[t].dispose(),Object(d.xf)(e[t])}))}}class Pe extends Be{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,e){null==e&&(e={}),this.epoch.push(t);for(const t in e)null==this.history[t]&&(this.history[t]=[]),this.history[t].push(e[t])}async syncData(){const t=[],e=[],n=[];for(const r in this.history){const i=this.history[r];for(let a=0;a<i.length;++a)if("number"!=typeof i[a]){const o=i[a];t.push(o.data()),e.push(r),n.push(a)}}const r=await Promise.all(t);for(let t=0;t<r.length;++t){this.history[e[t]][n[t]].dispose(),this.history[e[t]][n[t]]=r[t][0]}}}class qe extends Be{constructor(t,e){if(super(),this.currentEpoch=0,this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");d.qi.isNumber(this.yieldEvery)&&(this.maybeWait=function(t,e){let n,r=d.qi.now();return(...i)=>{const a=d.qi.now();return a-r<e||(r=a,n=t(...i)),n}}(this.maybeWait.bind(this),this.yieldEvery)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,e,n){const r=[];null!=this.yield&&(await Me(n),r.push(this.yield(t,e,n))),r.push(Object(d.og)()),await Promise.all(r)}async onEpochBegin(t,e){this.currentEpoch=t,null!=this.epochBegin&&(await Me(e),await this.epochBegin(t,e))}async onEpochEnd(t,e){const n=[];null!=this.epochEnd&&(await Me(e),n.push(this.epochEnd(t,e))),"epoch"===this.yieldEvery&&n.push(Object(d.og)()),await Promise.all(n)}async onBatchBegin(t,e){null!=this.batchBegin&&(await Me(e),await this.batchBegin(t,e))}async onBatchEnd(t,e){const n=[];null!=this.batchEnd&&(await Me(e),n.push(this.batchEnd(t,e))),"batch"===this.yieldEvery?n.push(Object(d.og)()):d.qi.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),await Promise.all(n)}async onTrainBegin(t){null!=this.trainBegin&&(await Me(t),await this.trainBegin(t))}async onTrainEnd(t){null!=this.trainEnd&&(await Me(t),await this.trainEnd(t))}}function We(t,e){if(null==t&&(t={}),t instanceof Be)return[t];if(Array.isArray(t)&&t[0]instanceof Be)return t;return O(t).map(t=>new qe(t,e))}class Ue{constructor(){}static registerCallbackConstructor(t,e){d.qi.assert(t>=0&&Number.isInteger(t),()=>"Verbosity level is expected to be an integer >= 0, but got "+t),Ue.checkForDuplicate(e),null==Ue.constructors[t]&&(Ue.constructors[t]=[]),Ue.constructors[t].push(e)}static checkForDuplicate(t){for(const e in Ue.constructors){Ue.constructors[+e].forEach(e=>{if(e===t)throw new g("Duplicate callback constructor.")})}}static clear(){Ue.constructors={}}static createCallbacks(t){const e=[];for(const n in Ue.constructors){const r=+n;t>=r&&e.push(...Ue.constructors[r])}return e.map(t=>new t)}}function Ve(t,e,n,r,i,a,o,s,u){const c=new Pe,l=[new Le,...Ue.createCallbacks(e)];null!=t&&l.push(...t),l.push(c);const d=new ze(l);return d.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:o,verbose:e,doValidation:s,metrics:u}),{callbackList:d,history:c}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ge(t,e={},n=!1){return S(t,d.lh.SerializationMap.getMap().classNameMap,e,"layer",n)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function He(t,e){return Object(d.di)(()=>{"float32"!==t.dtype&&(t=t.asType("float32"));const n=d.Qh(Et(t),e,!0),r=d.Ve(n.shape,h()),i=d.Gh(d.Xf(n,r));return d.Ce(t,i)})}function Xe(t,e){return Object(d.di)(()=>d.Zf(Et(d.Oh(e,t)),-1))}function Ke(t,e){return Object(d.di)(()=>d.Zf(d.td(d.Oh(e,t)),-1))}function Ye(t,e){return Object(d.di)(()=>{const n=d.Oh(t,e),r=d.Zd(d.td(t),h(),Number.MAX_VALUE),i=d.td(d.Ce(n,r));return d.jg(100,d.Zf(i,-1))})}function Je(t,e){return Object(d.di)(()=>{const n=d.Zd(e,h(),Number.MAX_VALUE),r=d.Hf(d.wd(1,n)),i=d.Zd(t,h(),Number.MAX_VALUE),a=d.Hf(d.wd(1,i));return d.Zf(Et(d.Oh(r,a)),-1)})}function Ze(t,e,n=!1){return Object(d.di)(()=>{if(n)e=d.Ah(e);else{const t=d.Qh(e,e.shape.length-1,!0);e=d.Ce(e,t)}return e=d.Zd(e,h(),1-h()),d.ng(d.Qh(d.jg(t.toFloat(),d.Hf(e)),e.shape.length-1))})}function Qe(t,e,n=!1){return Object(d.di)(()=>{const r=d.Ye(function(t){const e=[dt(t.shape)];return t.reshape(e)}(t)).toInt(),i=(e=d.Zd(e,h(),1-h())).shape;return Ze(d.sg(r,i[i.length-1]).reshape(i),e,n)})}function tn(t,e){return Object(d.di)(()=>{let n;return n=d.Zd(e,h(),1-h()),n=d.Hf(d.Ce(n,d.Oh(1,n))),d.Zf(function(t,e){if(!d.qi.arraysEqual(t.shape,e.shape))throw new g(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return Object(d.di)(()=>{const n=e.relu(),r=e.abs().neg();return n.sub(e.mul(t)).add(r.exp().log1p())})}(t,n),-1)})}function en(t,e){return Object(d.di)(()=>{const n=d.Zd(t,h(),1),r=d.Zd(e,h(),1);return d.Qh(d.jg(t,d.Hf(d.Ce(n,r))),-1)})}function nn(t,e){return Object(d.di)(()=>{const n=He(t,-1),r=He(e,-1),i=d.jg(n,r);return d.ng(d.Qh(i,-1))})}Ue.constructors={};const rn={meanSquaredError:Xe,meanAbsoluteError:Ke,meanAbsolutePercentageError:Ye,meanSquaredLogarithmicError:Je,squaredHinge:function(t,e){return Object(d.di)(()=>{const n=d.Xf(0,d.Oh(1,d.jg(t,e)));return d.Zf(Et(n),-1)})},hinge:function(t,e){return Object(d.di)(()=>{const n=d.Xf(0,d.Oh(1,d.jg(t,e)));return d.Zf(n,-1)})},categoricalHinge:function(t,e){return Object(d.di)(()=>{const n=d.Qh(d.jg(t,e),-1),r=d.Tf(d.jg(d.Oh(1,t),e),-1);return d.Xf(0,d.wd(1,d.Oh(r,n)))})},logcosh:function(t,e){return Object(d.di)(()=>{const n=Math.log(2),r=d.Oh(e,t),i=d.Oh(d.wd(r,d.Bh(d.jg(-2,r))),n);return d.Zf(i,-1)})},categoricalCrossentropy:Ze,sparseCategoricalCrossentropy:Qe,binaryCrossentropy:tn,kullbackLeiblerDivergence:en,poisson:function(t,e){return Object(d.di)(()=>{const n=d.Hf(d.wd(h(),e));return d.Zf(d.Oh(e,d.jg(t,n)),-1)})},cosineProximity:nn};function an(t){if("string"==typeof t){if(t in rn)return rn[t];let e="Unknown loss "+t;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new g(e)}return t}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function on(t,e){return Object(d.di)(()=>{const n=d.jg(.5,d.ug(e)),r=gt(d.kf(e,n),t.dtype);return d.Zf(d.Ne(t,r),-1)})}function sn(t,e){return Object(d.di)(()=>gt(d.Ne(d.Bd(t,-1),d.Bd(e,-1)),"float32"))}function un(t,e){return Object(d.di)(()=>d.Mf(t.equal(1),e.equal(1)).sum().cast("float32"))}function cn(t,e){return Object(d.di)(()=>{const n=un(t,e),r=function(t,e){return Object(d.di)(()=>d.Mf(t.equal(0),e.equal(1)).sum().cast("float32"))}(t,e),i=n.add(r);return d.wi(d.kf(i,0),n.div(i),0).cast("float32")})}function ln(t,e){return Object(d.di)(()=>{const n=un(t,e),r=function(t,e){return Object(d.di)(()=>d.Mf(t.equal(1),e.equal(0)).sum().cast("float32"))}(t,e),i=n.add(r);return d.wi(d.kf(i,0),n.div(i),0).cast("float32")})}function dn(t,e){return tn(t,e)}function fn(t,e){return t.rank===e.rank&&(t=t.squeeze([t.rank-1])),(e=e.argMax(-1)).dtype!==t.dtype&&(e=e.asType(t.dtype)),d.Ne(t,e).asType("float32")}const hn=Ze,pn=Qe,mn={binaryAccuracy:on,categoricalAccuracy:sn,precision:cn,categoricalCrossentropy:hn,sparseCategoricalCrossentropy:pn,mse:Xe,MSE:Xe,mae:Ke,MAE:Ke,mape:Ye,MAPE:Ye,cosine:nn};function gn(t){if("string"==typeof t&&t in mn)return mn[t];if("string"!=typeof t&&null!=t)return t;throw new g("Unknown metric "+t)}function bn(t){if(x(null!==t,"Unknown LossOrMetricFn "+t),"string"==typeof t)return t;{let e;for(const n of Object.keys(rn))if(rn[n]===t){e=n;break}if(void 0!==e)return e;for(const n of Object.keys(mn))if(mn[n]===t){e=n;break}return void 0!==e?e:t.name}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yn(t,e,n=!1){if(null==t||"object"!=typeof t||Object.getPrototypeOf(t)!==Object.prototype||!function t(e){if(null===e)return!0;if("object"==typeof e){if(Object.getPrototypeOf(e)===Object.prototype){const n=Object.keys(e);for(const r of n){if("string"!=typeof r)return!1;if(!t(e[r]))return!1}return!0}if(Array.isArray(e)){for(const n of e)if(!t(n))return!1;return!0}return!1}{const t=typeof e;return"string"===t||"number"===t||"boolean"===t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(t);n.length>1048576&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${n.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function vn(t,e,n,r=console.log){const i=function(t){let e=!0;const n=[],r=[];for(const e in t.nodesByDepth)n.push(t.nodesByDepth[e]);for(const t of n){if(t.length>1||1===t.length&&t[0].inboundLayers.length>1){e=!1;break}r.push(...t)}if(e)for(const n of t.layers){let t=!1;for(const i of n.inboundNodes)if(-1!==r.indexOf(i)){if(t){e=!1;break}t=!0}if(!e)break}return e}(t),a=["Layer (type)","Output shape","Param #"];let o;if(i?(e=e||65,n=n||[.45,.85,1]):(e=e||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map(t=>Math.floor(e*t))),!i){a.push("Receives inputs"),o=[];for(const e in t.nodesByDepth)o.push(...t.nodesByDepth[e])}r("_".repeat(e)),xn(a,n,r),r("=".repeat(e));const s=t.layers;for(let t=0;t<s.length;++t)i?wn(s[t],n,r):kn(s[t],n,o,r),r((t===s.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const u=function(t){let e;e=null!=t.collectedTrainableWeights?Oe(t.collectedTrainableWeights):Oe(t.trainableWeights);return e}(t),c=Oe(t.nonTrainableWeights);r("Total params: "+(u+c)),r("Trainable params: "+u),r("Non-trainable params: "+c),r("_".repeat(e))}function xn(t,e,n=console.log){let r="";for(let n=0;n<t.length;++n)n>0&&(r=r.slice(0,r.length-1)+" "),r+=t[n],r=r.slice(0,e[n]),r+=" ".repeat(e[n]-r.length);n(r)}function wn(t,e,n){let r;try{r=JSON.stringify(t.outputShape)}catch(t){r="multiple"}xn([`${t.name} (${t.getClassName()})`,r,t.countParams().toString()],e,n)}function kn(t,e,n,r){let i;try{i=JSON.stringify(t.outputShape)}catch(t){i="multiple"}const a=[];for(const e of t.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(e)))for(let t=0;t<e.inboundLayers.length;++t){const n=e.inboundLayers[t].name,r=e.nodeIndices[t],i=e.tensorIndices[t];a.push(`${n}[${r}][${i}]`)}const o=t.name,s=t.getClassName(),u=0===a.length?"":a[0];xn([`${o} (${s})`,i,t.countParams().toString(),u],e,r);for(let t=1;t<a.length;++t)xn(["","","",a[t]],e,r)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function On(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"==typeof n}function _n(t,e){if(null===t)return null;if("string"==typeof t)return A(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let i=0;i<r;++i){const r=t[i];On(e,i,r)?n.push(r):n.push(_n(r,e))}return n}{const e={};for(const n of Object.keys(t)){const r=t[n];if("name"===n&&"string"==typeof r)e[n]=r;else{const t=A(n);e[t]=_n(r,t)}}return e}}class An{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof An)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,n){if(null!=this.id2Value[t.id])throw new g(`Duplicate key: name=${t.name}, id=${t.id}`);return this.id2Value[t.id]=
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return Object(d.Xd)(e,t.dtype)}catch(n){throw new g(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof Se){if(null==this.id2Value[t.id])throw new g("Nonexistent key: "+t.name);return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new g("Feed dict has no SymbolicTensor name: "+t);return this.id2Value[e]}}getMask(t){if(t instanceof Se){if(null==this.id2Value[t.id])throw new g("Nonexistent key: "+t.name);return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new g("Feed dict has no SymbolicTensor name: "+t);return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&Object(d.Ae)(this.id2Mask)}}const Cn={},En={};function Sn(t,e,n,r){const i=null!=n&&n.training,a=Array.isArray(t),o=a?t:[t],s=o.map(t=>t.name),u=[],c=e.names();for(const t of s)-1!==c.indexOf(t)?u.push(e.getValue(t)):u.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const l=s.join(",")+"|"+e.names().join(",");let f,h;if(null==Cn[l]){const t=function(t,e){d.qi.assert(null!=t&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(1===t.length){const i=Nn(t[0],e);n=i.sorted,r=i.recipientMap}else{const i=new Set;for(const a of t){const{sorted:t,recipientMap:o}=Nn(a,e);for(const e of t)i.has(e.name)||(n.push(e),i.add(e.name));for(const t in o)null==r[t]&&(r[t]=new Set),o[t].forEach(e=>r[t].add(e))}}return{sorted:n,recipientCounts:jn(r)}}(o,e);f=t.sorted,h=t.recipientCounts,Cn[l]=f,En[l]=h}f=Cn[l],h={},i||Object.assign(h,En[l]);const p=new An(e);for(let t=0;t<f.length;++t){if(null!=r){const t=Object(d.ag)().numTensors;t>r.maxNumTensors&&(r.maxNumTensors=t),t<r.minNumTensors&&(r.minNumTensors=t)}const a=f[t],o=a.sourceLayer;if(o instanceof De)continue;const c=[],l=[],m=[];let g=!1;for(const t of a.inputs){const n=p.getValue(t),r=p.getMask(t);c.push(n),l.push(r),null!=r&&(g=!0),i||(h[t.name]--,0!==h[t.name]||e.hasKey(t)||-1!==s.indexOf(t.name)||n.isDisposed||!0===t.sourceLayer.stateful||m.push(n))}g&&((n=n||{}).mask=l[0]);const b=O(o.apply(c,n));let y=null;o.supportsMasking&&(y=o.computeMask(c,l));const v=Tn(a),x=Array.isArray(v)?v:[v];for(let t=0;t<x.length;++t){p.hasKey(x[t])||p.add(x[t],b[t],Array.isArray(y)?y[0]:y);const e=s.indexOf(x[t].name);-1!==e&&(u[e]=b[t])}i||Object(d.Ae)(m)}return p.disposeMasks(),a?u:u[0]}function jn(t){const e={};for(const n in t)e[n]=t[n].size;return e}function Nn(t,e){const n=new Set,r=[],i={};for(const t of e.names())n.add(t);const a=[],o=[];for(a.push(t);a.length>0;){const t=a[a.length-1];if(n.has(t.name)){a.pop();continue}const e=o[o.length-1]===a.length-1;if(0===t.inputs.length||e)a.pop(),r.push(t),n.add(t.name),e&&o.pop();else{o.push(a.length-1);for(const e of t.inputs)null==i[e.name]&&(i[e.name]=new Set),i[e.name].add(t.name),n.has(e.name)||a.push(e)}}return{sorted:r,recipientMap:i}}function Tn(t){let e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{let n=null;for(let e=0;e<t.sourceLayer.inboundNodes.length;++e)for(const r of t.sourceLayer.inboundNodes[e].outputTensors)if(r.id===t.id){n=e;break}e=t.sourceLayer.getOutputAt(n)}return e}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Fn extends Fe{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const t=this.getClassName().toLowerCase();this.name=ye(t)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],N(this.inputs).length!==this.inputs.length)throw new g("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+this.inputs.map(t=>t.name));N(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+this.outputs.map(t=>t.name)),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const t of this.outputs){const e=t.sourceLayer,n=t.nodeIndex,r=t.tensorIndex;this.outputLayers.push(e),this.outputLayersNodeIndices.push(n),this.outputLayersTensorIndices.push(r)}for(const t of this.inputs){const e=t.sourceLayer,n=t.nodeIndex,r=t.tensorIndex;x(0===n,"input layer has >1 nodes"),x(0===r,"input layer has >1 tensors"),this.inputLayers.push(e),this.inputLayersNodeIndices.push(n),this.inputLayersTensorIndices.push(r)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let e=0;e<this.inputLayers.length;e++){const n=this.inputLayers[e];if(!(n instanceof De))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${e} (0-based) originates from layer type ${n.getClassName()}.`);this.inputNames.push(n.name),this.feedInputShapes.push(n.batchInputShape),this.feedInputNames.push(n.name)}for(const t of this.outputLayers)this.outputNames.push(t.name);this.internalInputShapes=this.inputs.map(t=>t.shape),this.internalOutputShapes=this.outputs.map(t=>t.shape);const e={},n={},r={},i={},a={},o=[],s=(t,e,n,r,i,u)=>{null!=r&&null!=i&&null!=u||(r=t.sourceLayer,i=t.nodeIndex,u=t.tensorIndex);const c=r.inboundNodes[i];if(-1!==n.indexOf(c))throw new m(`The tensor ${t.name} at layer "${r.name}" is part of a cycle.`);if(-1!==e.indexOf(c))return;this.containerNodes.add(Fn.nodeKey(r,i)),r.id in a||(a[r.id]=Object.keys(a).length),-1===n.indexOf(c)&&n.push(c);const l=c.inboundLayers.length;for(let t=0;t<l;t++){const r=c.inputTensors[t],i=c.inboundLayers[t],a=c.nodeIndices[t],o=c.tensorIndices[t];s(r,e,n,i,a,o)}for(e.push(c);n.indexOf(c)>=0;)n.splice(n.indexOf(c),1);o.push(c)},u=[],c=[];for(const t of this.outputs)s(t,u,c);const l=o.slice().reverse();for(const t of l){n[t.id]=t,t.id in e||(e[t.id]=0);let a=e[t.id];const o=null==r[t.outboundLayer.id]?0:r[t.outboundLayer.id];a=Math.max(a,o),r[t.outboundLayer.id]=a,i[t.outboundLayer.id]=t.outboundLayer,e[t.id]=a;for(let r=0;r<t.inboundLayers.length;r++){const i=t.inboundLayers[r],o=t.nodeIndices[r],s=i.inboundNodes[o],u=null==e[s.id]?0:e[s.id];e[s.id]=Math.max(a+1,u),n[s.id]=s}}const d={};for(const t in e){const r=e[t];r in d||(d[r]=[]),d[r].push(n[t])}const f={};for(const t in r){const e=r[t];e in f||(f[e]=[]),f[e].push(i[t])}let h=Object.keys(f).map(t=>parseInt(t,10)).sort(j);this.layers=[];for(const t of h){const e=f[t];e.sort((t,e)=>{const n=a[t.id],r=a[e.id];return n<r?-1:n>r?1:0});for(const t of e)t instanceof Fn&&this.internalContainerRefs.push(t),this.layers.push(t)}this.layersByDepth=f,h=Object.keys(d).map(t=>parseInt(t,10)).sort(j);const p=this.inputs.slice(),b=[];for(const t of h)for(const e of d[t]){const t=e.outboundLayer;if(null!=t){for(const n of e.inputTensors)if(-1===p.indexOf(n))throw new m("Graph disconnected: cannot obtain value for tensor "+n+` at layer "${t.name}". The following previous layers were accessed without issue: `+b);for(const t of e.outputTensors)p.push(t);b.push(t.name)}}this.nodesByDepth=d;const y=this.layers.map(t=>t.name);for(const t of y){const e=y.filter(e=>e===t).length;if(1!==e)throw new m(`The name "${t}" is used ${e} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new Ne({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(t=>null),outputMasks:this.outputs.map(t=>null),inputShapes:this.inputs.map(t=>t.shape),outputShapes:this.outputs.map(t=>t.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(e=>{e._trainableWeights.forEach(e=>e.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new g("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.layers)e.push(...t.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,e=!0){const n={};let r=0;for(const t of this.layers)for(const e of t.weights){if(null!=n[e.originalName])throw new g("Duplicate weight name: "+e.originalName);n[e.originalName]=e,r++}const i=[];for(const r in t){let a=r;if(null==n[r]){const t=r.split("/");a=t.slice(0,-2).concat([t[t.length-1]]).join("/")}if(null!=n[a])i.push([n[a],t[r]]);else if(e)throw new g("Provided weight data has no target variable: "+r);delete n[a]}if(e){const t=[];for(const e in n)t.push(e);if(t.length>0)throw new g(`${t.length} of ${r} weights are not set: `+t)}Ce(i)}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers 2.8.2",e.backend="TensorFlow.js",e}toJSON(t,e=!0){const n=function t(e,n){if(null==e)return null;if("string"==typeof e)return _(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){const r=[],i=e.length;for(let a=0;a<i;++a){const i=e[a];On(n,a,i)?r.push(i):r.push(t(i,n))}return r}{const n={};for(const r of Object.keys(e)){const i=e[r],a=_(r);n[a]="name"!==r&&"className"!==r||"string"!=typeof i?t(i,r):i}return n}}
/** @license See the LICENSE file. */(this.updatedConfig());return e?JSON.stringify(n):n}call(t,e){return Object(d.di)(()=>{t=O(t);const n=new An;for(let e=0;e<this.inputs.length;++e)n.add(this.inputs[e],t[e]);return Sn(this.outputs,n,e)})}computeMask(t,e){return Object(d.di)(()=>{let n;return t=O(t),n=null==e?v(null,t.length):O(e),this.runInternalGraph(t,n)[1]})}computeOutputShape(t){const e=xe(t);if(e.length!==this.inputLayers.length)throw new g(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const n={};for(let t=0;t<e.length;t++){const r=this.inputLayers[t],i=e[t];n[r.name+"_0_0"]=i}const r=Object.keys(this.nodesByDepth).map(t=>parseInt(t,10)).sort(j);if(r.length>1)for(const t of r){const e=this.nodesByDepth[t];for(const t of e){const e=t.outboundLayer;if(-1!==this.inputLayers.map(t=>t.id).indexOf(e.id))continue;const r=[];for(let e=0;e<t.inboundLayers.length;e++){const i=t.inboundLayers[e],a=t.nodeIndices[e],o=t.tensorIndices[e],s=n[`${i.name}_${a}_${o}`];r.push(s)}const i=xe(e.computeOutputShape(k(r))),a=e.inboundNodes.indexOf(t);for(let t=0;t<i.length;t++){n[`${e.name}_${a}_${t}`]=i[t]}}}const i=[],a=[];for(let t=0;t<this.outputLayers.length;t++){const e=this.outputLayers[t],n=this.outputLayersNodeIndices[t],r=this.outputLayersTensorIndices[t],i=`${e.name}_${n}_${r}`;a.push(i)}for(let t=0;t<a.length;t++){const e=a[t];x(e in n),i.push(n[e])}return k(i)}runInternalGraph(t,e){null==e&&(e=v(null,t.length));const n={};for(let r=0;r<this.inputs.length;++r){const i=this.inputs[r],a=t[r],o=e[r];n[i.id]=[a,o]}const r=Object.keys(this.nodesByDepth).map(t=>parseInt(t,10)).sort(j);for(const t of r){const e=this.nodesByDepth[t];for(const t of e){const e=t.outboundLayer,r=t.inputTensors,i=t.outputTensors,a=new Array;for(const t of r)t.id in n&&a.push(n[t.id]);if(a.length===r.length){let r,o,s,u,c={};if(null!=t.callArgs&&(c=t.callArgs),1===a.length){const[t,n]=a[0];null==c.mask&&(c.mask=n),s=O(e.call(t,c)),u=O(e.computeMask(t,n)),r=[t],o=[n]}else r=a.map(t=>t[0]),o=a.map(t=>t[1]),null==c.mask&&(c.mask=o),s=O(e.call(r,c)),u=O(e.computeMask(r,o));if(e.activityRegularizer)throw new b("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let t=0;t<i.length;++t){const e=i[t],r=s[t],a=u[t];n[e.id]=[r,a]}}}}const i=[],a=[],o=[];for(const t of this.outputs){x(t.id in n,`Could not compute output ${t.name} : ${t.id}`);const[e,r]=n[t.id];o.push(e.shape),i.push(e),a.push(r)}return[i,a,o]}buildNodeConversionMap(t){const e={};let n;for(const t of this.layers){n=t instanceof Fn?1:0;for(let r=0;r<t.inboundNodes.length;r++){const i=Fn.nodeKey(t,r);this.containerNodes.has(i)&&(e[i]=n,n+=1)}}return e}getLayer(t,e){if(null!=e){if(this.layers.length<=e)throw new g(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}if(null==t)throw new g("Provide either a layer name or layer index");for(const e of this.layers)if(e.name===t)return e;throw new g("No such layer: "+t)}calculateLosses(){return Object(d.di)(()=>{const t=[];for(const e of this.layers)for(let n=0;n<e.inboundNodes.length;++n){const r=Fn.nodeKey(e,n);this.containerNodes.has(r)&&t.push(...e.calculateLosses())}return t})}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),n=[];for(const t of this.layers){const r=t.getClassName(),i=t.getConfig(),a=[];for(let n=0;n<t.inboundNodes.length;n++){const r=t.inboundNodes[n],i=Fn.nodeKey(t,n);let o={};if(this.containerNodes.has(i)){if(r.callArgs)try{JSON.stringify(r.callArgs),o=r.callArgs}catch(e){console.warn(`Layer ${t.name} was passed non-serializable keyword arguments: `+r.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),o={}}if(r.inboundLayers.length>0){const t=[];for(let n=0;n<r.inboundLayers.length;n++){const i=r.inboundLayers[n],a=r.nodeIndices[n],s=r.tensorIndices[n];let u=e[Fn.nodeKey(i,a)];null==u&&(u=0),t.push([i.name,u,s,o])}a.push(t)}}}const o={};o.name=t.name,o.className=r,o.config=i,o.inboundNodes=a,n.push(o)}t.layers=n;const r=[];for(let t=0;t<this.inputLayers.length;t++){const n=this.inputLayers[t],i=this.inputLayersNodeIndices[t],a=Fn.nodeKey(n,i);if(!this.containerNodes.has(a))continue;let o=e[a];null==o&&(o=0);const s=this.inputLayersTensorIndices[t];r.push([n.name,o,s])}t.inputLayers=r;const i=[];for(let t=0;t<this.outputLayers.length;t++){const n=this.outputLayers[t],r=this.outputLayersNodeIndices[t],a=Fn.nodeKey(n,r);if(!this.containerNodes.has(a))continue;let o=e[a];null==o&&(o=0);const s=this.outputLayersTensorIndices[t];i.push([n.name,o,s])}return t.outputLayers=i,t}static fromConfig(t,e,n={},r=!1){const i={},a={};function o(t,e){t.name in a?a[t.name].push(e):a[t.name]=[e]}function s(t,e){const n=[];let r;for(const a of e){const s=a[0],u=a[1],c=a[2];if(r=null==a[3]?{}:a[3],!(s in i))return void o(t,e);const l=i[s];if(l.inboundNodes.length<=u)return void o(t,e);const d=l.inboundNodes[u];n.push(d.outputTensors[c])}n.length>0&&t.apply(k(n),r)}function u(t){const n=t.name,a=Ge(t,null!=e.customObjects?e.customObjects:{});a.setFastWeightInitDuringBuild(r),i[n]=a;t.inboundNodes.forEach(t=>{if(!(t instanceof Array))throw new g("Corrupted configuration, expected array for nodeData: "+t);o(a,t)})}const c=e.name,l=e.layers;for(const t of l)u(t);for(;!T(a);)for(const t of l){const e=i[t.name];if(e.name in a){const t=a[e.name];delete a[e.name];for(const n of t)s(e,n)}}const d=[],f=[],h=e.inputLayers;for(const t of h){const e=t[0],n=t[1],r=t[2];x(e in i);const a=i[e].inboundNodes[n].outputTensors;d.push(a[r])}const p=e.outputLayers;for(const t of p){const e=t[0],n=t[1],r=t[2];x(e in i);const a=i[e].inboundNodes[n].outputTensors;f.push(a[r])}return new t({inputs:d,outputs:f,name:c})}get stateful(){if(this._stateful)throw new g("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){Object(d.di)(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dn(t,e,n){const r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map(t=>null);if(1===r)return Array.isArray(t)&&1===t.length?t:"object"==typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}if("object"==typeof t&&Object.keys(t).length>0&&"object"==typeof t[Object.keys(t)[0]]){const n=[];return e.forEach(e=>{e in t?n.push(t[e]):n.push(null)}),n}throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function In(t,e){return Dn(t,e,"classWeight")}async function Mn(t,e,n,r){if(null!=e||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const e=Object(d.di)(()=>{if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1){const e=1;return t.argMax(e)}if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),r=Array.from(await e.data());Object(d.Ae)(e);const i=[];return r.forEach(t=>{if(null==n[t])throw new Error(`classWeight must contain all classes in the training data. The class ${t} exists in the data but not in classWeight`);i.push(n[t])}),Object(d.Vh)(i,"float32")}return null}function $n(t,e){return Object(d.jg)(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rn(t,e){let n,r;const i=e;n=i.xs,r=i.ys,d.qi.assert(null!=n&&null!=r,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+e);const a=Bn("input",t.inputNames,n),o=Bn("output",t.outputNames,r),s=a[0].shape[0];d.qi.assert(a.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${a.length} inputs.  (Expected input keys: `+JSON.stringify(t.inputNames)+")"),d.qi.assert(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: `+JSON.stringify(t.outputNames)+")");for(let e=0;e<a.length;e++)d.qi.assert(a[e].shape[0]===s,()=>`Batch size mismatch: input ${t.inputNames[e]} has ${a[e].shape[0]}; expected  ${s} based on input ${t.inputNames[0]}.`);for(let e=0;e<o.length;e++)d.qi.assert(o[e].shape[0]===s,()=>`Batch size mismatch: output ${t.outputNames[e]} has ${o[e].shape[0]}; expected  ${s} based on input ${t.inputNames[0]}.`);return{xs:a,ys:o}}function Bn(t,e,n){if(n instanceof d.id)return[n];if(Array.isArray(n))return d.qi.assert(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const r=[];for(const i of e){if(null==n[i])throw new g(`The feature data generated by the dataset lacks the required ${t} key '${i}'.`);r.push(n[i])}return r}}async function zn(t,e,n){const r=null!=n.batchesPerEpoch;if(d.qi.assert(null!=t.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),d.qi.assert(null!=n,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),d.qi.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive integer, but got "+n.epochs),d.qi.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+n.batchesPerEpoch),d.qi.assert(null==n.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const i=null!=n.validationData;let a,o;if(i)if(Ln(n.validationData))d.qi.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+n.validationBatches);else{const t=function(t){if(3===t.length)throw new b("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(n.validationData);a=t.xs,o=t.ys}const s=t.makeTrainFunction(),u=t.getDedupedMetricsNames();let c;c=i?u.slice().concat(u.map(t=>"val_"+t)):u.slice();const l=We(n.callbacks,n.yieldEvery),f=null==n.verbose?1:n.verbose,{callbackList:h,history:p}=Ve(l,f,n.epochs,null,null,function(t,e){let n=null;null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size);return n}(e,n),null,i,c);h.setModel(t),t.history=p,await h.onTrainBegin(),t.stopTraining_=!1;let m=null==n.initialEpoch?0:n.initialEpoch,g=await e.iterator();for(;m<n.epochs;){const c={};await h.onEpochBegin(m);let l=0,f=0;for(r||(g=await e.iterator());!r||l<n.batchesPerEpoch;){const e=await g.next();if(r&&e.done){console.warn("You provided `batchesPerEpoch` as "+n.batchesPerEpoch+", but your dataset iterator ran out of data after "+l+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset.");break}if(null!=e.value){const{xs:r,ys:i}=Rn(t,e.value),a={};a.batch=f,a.size=r[0].shape[0],await h.onBatchBegin(f,a);const o=[];if(null!=n.classWeight){const e=In(n.classWeight,t.outputNames);for(let t=0;t<e.length;++t)o.push(await Mn(i[t],null,e[t]))}const c=r.concat(i).concat(o),p=s(c);d.Ae(c);for(let t=0;t<u.length;++t){const e=u[t],n=p[t];a[e]=n,d.xf(n)}await h.onBatchEnd(f,a),$e(a),f++,l++}if(r?l>=n.batchesPerEpoch:e.done){if(i){let e;e=Ln(n.validationData)?O(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):O(t.evaluate(a,o,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<t.metricsNames.length;++n)c["val_"+t.metricsNames[n]]=e[n]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(m,c),m++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function Ln(t){return"function"==typeof t.iterator}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Pn(t){d.qi.assert(t>0&&Number.isInteger(t),()=>"batchSize is required to be a positive integer, but got "+t)}function qn(t,e,n){return null==t?[null]:Array.isArray(t)?t.map(t=>yt(t,e,n-e)):yt(t,e,n-e)}function Wn(t,e){return d.di(()=>null==t?null:Array.isArray(t)?t.map(t=>Wn(t,e)):Ct(t,"int32"===e.dtype?e:e.toInt()))}function Un(t,e){const n=[];let r=0,i=null;for(;r<t;)i=r+e,i>=t&&(i=t),n.push([r,i]),r=i;return n}async function Vn(t,e,n,r={}){if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");let i,a,o,s,u,c,l;t.isTraining=!0;try{const f=null==r.batchSize?32:r.batchSize;Pn(f);const h=!1,p=await t.standardizeUserData(e,n,r.sampleWeight,r.classWeight,h,f);i=p[0],a=p[1],l=p[2];let m,y=!1;if(null!=r.validationData&&r.validationData.length>0){if(y=!0,2!==r.validationData.length)throw 3===r.validationData.length?new b("validationData including sample weights is not supported yet."):new g("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+r.validationData+" is invalid.");o=r.validationData[0],s=r.validationData[1];const e=!0,n=await t.standardizeUserData(o,s,null,null,e,f);u=n[0],c=n[1],m=u.concat(c)}else if(null!=r.validationSplit&&r.validationSplit>0&&r.validationSplit<1){y=!0;const t=Math.floor(i[0].shape[0]*(1-r.validationSplit)),e=i[0].shape[0];u=qn(i,t,e),i=qn(i,0,t),c=qn(a,t,e),a=qn(a,0,t),m=u.concat(c)}else null!=r.validationSteps&&(y=!0);const v=i.concat(a).concat(l);t.checkTrainableWeightsConsistency();const x=t.makeTrainFunction(),w=t.getDedupedMetricsNames();let k,O;y?(t.makeTestFunction(),k=t.testFunction,O=w.slice().concat(w.map(t=>"val_"+t))):(k=null,m=[],O=w.slice());const _=We(r.callbacks,r.yieldEvery);return await async function(t,e,n,r,i,a,o,s,u,c,l,f,h,p,m){null==i&&(i=32),null==a&&(a=1),null==l&&(l=!0),null==h&&(h=0);let y=!1;if(null!=u&&null!=c&&(y=!0),null!=m&&(y=!0,null==p))throw new g("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const v=t.checkNumSamples(n,i,p,"steps_per_epoch");let x;null!=v&&(x=mt(0,v)),null==o&&(o=1);const{callbackList:w,history:k}=Ve(s,o,a,h,v,p,i,y,f);w.setModel(t),t.history=k,await w.onTrainBegin(),t.stopTraining_=!1;for(let o=h;o<a;++o){await w.onEpochBegin(o);const a={};if(null!=p)throw new b("stepsPerEpoch mode is not implemented yet.");{if("batch"===l)throw new b("batch shuffling is not implemneted yet");l&&d.qi.shuffle(x);const o=Object(d.Vh)(x),s=Un(v,i);for(let l=0;l<s.length;++l){const f={};if(await w.onBatchBegin(l,f),d.di(()=>{const h=s[l][0],p=s[l][1],m=yt(o,h,p-h);f.batch=l,f.size=p-h;const g=Wn(n,m),b=e(g);for(let t=0;t<r.length;++t){const e=r[t],n=b[t];f[e]=n,d.xf(n)}if(l===s.length-1&&y){const e=t.testLoop(u,c,i);for(let t=0;t<r.length;++t){const n=r[t],i=e[t];d.xf(i),a["val_"+n]=i}}}),await w.onBatchEnd(l,f),$e(f),t.stopTraining_)break}o.dispose()}if(await w.onEpochEnd(o,a),t.stopTraining_)break}return await w.onTrainEnd(),await t.history.syncData(),t.history}(t,x,v,w,f,r.epochs,r.verbose,_,k,m,r.shuffle,O,r.initialEpoch,null,null)}finally{t.isTraining=!1,Hn(i,e),Hn(a,n),Hn(u,o),Hn(c,s),null!=l&&d.Ae(l)}}function Gn(t){const e=[];t instanceof d.id&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(1===r.rank)e.push(bt(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function Hn(t,e){if(null==t)return;const n=[];if(e instanceof d.id)n.push(e.id);else if(Array.isArray(e))e.forEach(t=>n.push(t.id));else if(null!=e)for(const t in e){const r=e[t];n.push(r.id)}const r=[];if(t instanceof d.id)-1===n.indexOf(t.id)&&r.push(t);else if(Array.isArray(t))t.forEach(t=>{-1===n.indexOf(t.id)&&r.push(t)});else if(null!=t)for(const e in t){const i=t[e];-1===n.indexOf(i.id)&&r.push(i)}r.forEach(t=>{t.isDisposed||t.dispose()})}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xn(t){return Array.isArray(t)}function Kn(t){return!function(t){return t instanceof d.id}(t)&&!Xn(t)}function Yn(t,e,n,r=!0,i=""){if(null==e||0===e.length){if(null!=t){let e=!1;if(Xn(t)&&t.length>0)e=!0;else if(Kn(t)){for(const n in t)if(t.hasOwnProperty(n)){e=!0;break}}else e=!0;if(e)throw new g(`Error when checking model ${i} expected no data, but got `+t)}return[]}if(null==t)return e.map(t=>null);let a;if(Kn(t)){t=t,a=[];for(const n of e){if(null==t[n])throw new g(`No data provided for "${n}". Need data for each key in: `+e);a.push(t[n])}}else if(Xn(t)){if((t=t).length!==e.length)throw new g(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): `+t);a=t}else{if(t=t,e.length>1)throw new g(`The model ${i} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape `+t.shape);a=[t]}if(a=Gn(a),null!=n)for(let t=0;t<e.length;++t){if(null==n[t])continue;const o=a[t];if(o.shape.length!==n[t].length)throw new g(`Error when checking ${i}: expected ${e[t]} to have ${n[t].length} dimension(s). but got array with shape `+o.shape);for(let a=0;a<n[t].length;++a){if(0===a&&!r)continue;const s=o.shape[a],u=n[t][a];if(null!=u&&u>=0&&s!==u)throw new g(`Error when checking ${i}: expected ${e[t]} to have shape [${n[t]}], but got array with shape [${o.shape}].`)}}return a}function Jn(t,e,n,r=!0,i=""){let a;if(Array.isArray(t)){if(t.length!==e.length)throw new g(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);a=t}else{if(e.length>1)throw new g(`The model expects ${e.length} ${i} Tensors, but only received one Tensor. Found: array with shape `+JSON.stringify(t.shape)+".");a=[t]}if(null!=n)for(let t=0;t<e.length;++t){if(null==n[t])continue;const o=a[t];if(o.shape.length!==n[t].length)throw new g(`Error when checking ${i}: expected ${e[t]} to have ${n[t].length} dimension(s), but got array with shape `+JSON.stringify(o.shape));for(let a=0;a<n[t].length;++a){if(0===a&&!r)continue;const s=o.shape[a],u=n[t][a];if(null!=u&&u!==s)throw new g(`Error when checking ${i}: expected ${e[t]} to have shape ${JSON.stringify(n[t])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}class Zn extends Fn{constructor(t){super(t),this.isTraining=!1}summary(t,e,n=console.log){if(!this.built)throw new g("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");vn(this,t,e,n)}compile(t){if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"==typeof t.optimizer)this.optimizer_=function(t){const e={Adagrad:()=>d.hi.adagrad(.01),Adadelta:()=>d.hi.adadelta(1,.95,h()),Adam:()=>d.hi.adam(.001,.9,.999,h()),Adamax:()=>d.hi.adamax(.002,.9,.999,h(),0),RMSProp:()=>d.hi.rmsprop(.001,.9,0,h()),SGD:()=>d.hi.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new g("Unknown Optimizer "+t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof d.mc))throw new g("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let e=[];if(Array.isArray(t.loss)||"string"==typeof t.loss||"function"==typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new g(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);const n=t.loss;e=n.map(t=>an(t))}else{const n=an(t.loss);this.outputs.forEach(t=>{e.push(n)})}else{t.loss=t.loss;for(const e in t.loss)if(-1===this.outputNames.indexOf(e))throw new g(`Unknown entry in loss dictionary: "${e}". Only expected the following keys: `+this.outputNames);for(const n of this.outputNames)null==t.loss[n]&&console.warn(`Output "${n}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${n} during training`),e.push(an(t.loss[n]))}this.lossFunctions=e,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let t=0;t<this.outputs.length;++t){const e=this.internalOutputShapes[t],n=this.outputNames[t];this.feedOutputNames.push(n),this.feedOutputShapes.push(e),this.feedLossFns.push(this.lossFunctions[t])}const n=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],ot("loss",()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;const e=this.lossFunctions[t];this.outputs.length>1&&(this.metricsTensors.push([e,t]),this.metricsNames.push(this.outputNames[t]+"_loss"))}});const r=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map(t=>[]);let n;if("string"==typeof t||"function"==typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!=typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+t);n=t}if(Array.isArray(n))return e.map(t=>n);{const t=[];for(const r of e){let e=n.hasOwnProperty(r)?n[r]:[];Array.isArray(e)||(e=[e]),t.push(e)}return t}}(t.metrics,this.outputNames),i=(t,e,n)=>{this.outputNames.length>1&&(e=this.outputNames[t]+"_"+e),this.metricsNames.push(e),this.metricsTensors.push([n,t])};ot("metric",()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;(e=>{let n,r,a;for(const o of e){if("string"==typeof o&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(o)){const e=this.internalOutputShapes[t];let i;1===e[e.length-1]||this.lossFunctions[t]===tn?-1!==["accuracy","acc"].indexOf(o)?r=on:-1!==["crossentropy","ce"].indexOf(o)&&(r=dn):this.lossFunctions[t]===Qe?-1!==["accuracy","acc"].indexOf(o)?r=fn:-1!==["crossentropy","ce"].indexOf(o)&&(r=pn):-1!==["accuracy","acc"].indexOf(o)?r=sn:-1!==["crossentropy","ce"].indexOf(o)&&(r=hn),-1!==["accuracy","acc"].indexOf(o)?i="acc":-1!==["crossentropy","ce"].indexOf(o)&&(i="ce"),a=r,n=""+i}else{const t=gn(o);a=t,n=""+bn(o)}let e;ot(n,()=>{e=a}),i(t,n,e)}})(r[t])}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,e,n={}){const r=null==n.batchSize?32:n.batchSize;Pn(r);const i=this.standardizeUserDataXY(t,e,!0,r);try{const a=i[0].concat(i[1]);this.makeTestFunction();const o=this.testFunction;return k(this.testLoop(o,a,r,n.verbose,n.steps))}finally{Hn(i[0],t),Hn(i[1],e)}}async evaluateDataset(t,e){return this.makeTestFunction(),async function(t,e,n){const r=null!=(n=n||{}).batches,i=t.testFunction;let a=[];if(n.verbose>0)throw new b("Verbose mode is not implemented yet.");d.qi.assert(!r||n.batches>0&&Number.isInteger(n.batches),()=>"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(n.batches));const o="function"==typeof e.next?e:await e.iterator();let s=0,u=0;for(;!r||u<n.batches;){const e=await o.next();if(a=d.di(()=>{if(e.value){const{xs:n,ys:r}=Rn(t,e.value),o=n.concat(r),c=d.di(()=>i(o));if(d.Ae(o),0===u)for(let t=0;t<c.length;++t)a.push(Object(d.gh)(0));const l=o[0].shape[0];for(let t=0;t<c.length;++t){const e=c[t],n=a[t];a[t]=d.di(()=>d.wd(a[t],d.jg(l,e))),u>0&&d.Ae(n)}d.Ae(c),s+=l,++u}return a}),e.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let t=0;t<a.length;++t){const e=a[t];a[t]=d.Ce(a[t],s),d.Ae(e)}return k(a)}(this,t,e)}checkNumSamples(t,e,n,r="steps"){let i;if(null!=n){if(i=null,null!=e)throw new g(`If ${r} is set, batchSize must be null or undefined.Got batchSize = `+e)}else{if(null==t)throw new g("Either the input data should have a defined shape, or "+r+" shoud be specified.");i=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return i}execute(t,e){if(Array.isArray(e)&&0===e.length)throw new g("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(e),r=n?e:[e],i=this.retrieveSymbolicTensors(r),a=new An;if(t instanceof d.id&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new g(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let e=0;e<this.inputs.length;++e)a.add(this.inputs[e],t[e])}else for(const e of this.inputs){const n=t[e.name];if(null==n)throw new g("No value is provided for the model's input "+e.name);a.add(e,n)}const o=Sn(i,a);return n?o:o[0]}retrieveSymbolicTensors(t){const e=v(null,t.length);let n=t.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],a=i.map(t=>t.name);for(let r=0;r<t.length;++r){const o=a.indexOf(t[r]);if(-1!==o&&(e[r]=i[o],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw e.forEach((e,r)=>{null==e&&n.push(t[r])}),new g("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(n))}return e}predictLoop(t,e=32,n=!1){return d.di(()=>{const r=this.checkNumSamples(t);if(n)throw new b("Verbose predictLoop() is not implemented yet.");const i=Un(r,e),a=this.outputs.map(t=>[]);for(let e=0;e<i.length;++e){d.di(()=>{const n=i[e][0],r=i[e][1],a=qn(t,n,r),o=[];if(Array.isArray(a))for(let t=0;t<a.length;++t)o.push({key:this.inputs[t],value:a[t]});else o.push({key:this.inputs[0],value:a});const s=new An(o);return Sn(this.outputs,s)}).forEach((t,e)=>a[e].push(t))}return k(a.map(t=>d.ce(t,0)))})}predict(t,e={}){const n=Gn(t);Jn(n,this.inputNames,this.feedInputShapes,!1);try{const r=null==e.batchSize?32:e.batchSize;return Pn(r),this.predictLoop(n,r)}finally{Hn(n,t)}}predictOnBatch(t){Jn(t,this.inputNames,this.feedInputShapes,!0);const e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}standardizeUserDataXY(t,e,n=!0,r){if(null==this.optimizer_)throw new m("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let t=0;t<this.feedOutputShapes.length;++t){const e=this.feedOutputShapes[t];this.feedLossFns[t]===Qe?i.push(e.slice(0,e.length-1).concat([1])):i.push(e)}if(function(t,e,n){const r=N(t.map(t=>t.shape[0]));r.sort();const i=N(e.map(t=>t.shape[0]));if(i.sort(),r.length>1)throw new g("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map(t=>t.shape)));if(i.length>1)throw new g("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map(t=>t.shape)));if(r.length>0&&i.length>0&&!d.qi.arraysEqual(r,i))throw new g(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}(t=Yn(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=Yn(e,this.feedOutputNames,i,!1,"target")),function(t,e,n){const r=[Xe,tn,Ze];for(let i=0;i<t.length;++i){const a=t[i],o=e[i],s=n[i];if(null!=o){if(o===Ze&&1===a.shape[a.shape.length-1])throw new g(`You are passing a target array of shape ${a.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(-1!==r.indexOf(o)){const t=a.shape.slice(1),e=s.slice(1);for(let n=0;n<t.length;++n){const r=t[n],i=e[n];if(null!=i&&r!==i)throw new g(`A target Tensor with shape ${a.shape} was passed for an output of shape ${s}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&t[0].shape[0]%r!=0)throw new g(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${t[0].shape[0]} sample(s).`);return[t,e]}async standardizeUserData(t,e,n,r,i=!0,a){const[o,s]=this.standardizeUserDataXY(t,e,i,a);if(null!=n)throw new Error("sample weight is not supported yet.");let u=null;if(null!=r){const t=In(r,this.outputNames);u=[];for(let e=0;e<t.length;++e)u.push(await Mn(s[e],null,t[e]))}return[o,s,u]}testLoop(t,e,n,r=0,i){return d.di(()=>{const a=this.checkNumSamples(e,n,i,"steps"),o=[];if(r>0)throw new b("Verbose mode is not implemented yet.");if(null!=i)throw new b("steps mode in testLoop() is not implemented yet");{const r=Un(a,n),i=Object(d.Vh)(mt(0,a));for(let n=0;n<r.length;++n){const a=r[n][0],s=r[n][1],u=yt(i,a,s-a),c=Wn(e,u),l=t(c);if(0===n)for(let t=0;t<l.length;++t)o.push(Object(d.gh)(0));for(let t=0;t<l.length;++t){const e=l[t];o[t]=d.wd(o[t],d.jg(s-a,e))}}for(let t=0;t<o.length;++t)o[t]=d.Ce(o[t],a)}return o})}getDedupedMetricsNames(){const t=this.metricsNames,e=[];for(let n=0;n<t.length;++n){const r=t[n];let i=r;if(w(t,r)>1){i+="_"+w(t.slice(0,n),r)}e.push(i)}return e}makeTrainFunction(){return t=>{const e=[],n=t.slice(0,this.inputs.length),r=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),a=[],o=this.collectedTrainableWeights.map(t=>t.read());return[this.optimizer_.minimize(()=>{const t=[];for(let e=0;e<this.inputs.length;++e)t.push({key:this.inputs[e],value:n[e]});const o=new An(t),s=Sn(this.outputs,o,{training:!0});let u;for(let t=0;t<this.lossFunctions.length;++t){let n=(0,this.lossFunctions[t])(r[t],s[t]);null!=i[t]&&(n=$n(n,i[t]));const a=d.Zf(n);e.push(a),u=0===t?n:d.wd(u,n)}for(let t=0;t<this.metricsTensors.length;++t){let n;if(this.outputs.length>1&&t<this.outputs.length)n=e[t];else{const e=this.metricsTensors[t][0],i=this.metricsTensors[t][1];n=d.Zf(e(r[i],s[i]))}d.xf(n),a.push(n)}return u=d.Zf(u),this.calculateLosses().forEach(t=>{u=d.wd(u,t)}),u},!0,o)].concat(a)}}makeTestFunction(){this.testFunction=t=>d.di(()=>{const e=[];let n;const r=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let t=0;t<this.inputs.length;++t)a.push({key:this.inputs[t],value:r[t]});const o=new An(a),s=Sn(this.outputs,o);for(let t=0;t<this.lossFunctions.length;++t){const r=this.lossFunctions[t],a=d.Zf(r(i[t],s[t]));n=0===t?a:d.wd(n,a),e.push(n)}for(let t=0;t<this.metricsTensors.length;++t){const n=this.metricsTensors[t][0],r=this.metricsTensors[t][1],a=d.Zf(n(i[r],s[r]));e.push(a)}return e})}async fit(t,e,n={}){return Vn(this,t,e,n)}async fitDataset(t,e){return zn(this,t,e)}async trainOnBatch(t,e){const n=await this.standardizeUserData(t,e),r=n[0],i=n[1],a=this.makeTrainFunction()(r.concat(i)),o=[];for(const t of a){const e=await t.data();o.push(e[0])}return d.Ae(a),k(o)}getNamedWeights(t){const e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n);for(let t=0;t<r.length;++t)n&&!r[t].trainable||e.push({name:r[t].originalName,tensor:i[t]});return e}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(0===t.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const e=d.ag().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-d.ag().numTensors}return t}getLossIdentifiers(){let t;if("string"==typeof this.loss)t=_(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if("string"!=typeof t)throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(t=>_(t))}else{const e=Object.keys(this.loss);t={};const n=this.loss;for(const r of e){if("string"!=typeof n[r])throw new Error("Serialization of non-string loss is not supported.");t[r]=_(n[r])}}return t}getMetricIdentifiers(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[_(bn(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>_(bn(t)));{const t={};for(const e in this.metrics)t[e]=_(bn(this.metrics[e]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const e=Ge(_n(t.optimizer_config));let n,r;if("string"==typeof t.loss)n=A(t.loss);else if(Array.isArray(t.loss))n=t.loss.map(t=>A(t));else if(null!=t.loss){n={};for(const e in t.loss)n[e]=A(t.loss[e])}if(Array.isArray(t.metrics))r=t.metrics.map(t=>A(t));else if(null!=t.metrics){r={};for(const e in t.metrics)r[e]=A(t.metrics[e])}this.compile({loss:n,metrics:r,optimizer:e})}async save(t,e){if("string"==typeof t){const e=d.sf.getSaveHandlers(t);if(0===e.length)throw new g(`Cannot find any save handlers for URL '${t}'`);if(e.length>1)throw new g(`Found more than one (${e.length}) save handlers for URL '${t}'`);t=e[0]}if(null==t.save)throw new g("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await d.sf.encodeWeights(this.getNamedWeights(e)),r={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v2.8.2",convertedBy:null};if(null!=e&&e.includeOptimizer&&null!=this.optimizer){r.trainingConfig=this.getTrainingConfig();const t="optimizer",{data:e,specs:i}=await d.sf.encodeWeights(await this.optimizer.getWeights(),t);n.specs.push(...i),n.data=d.sf.concatenateArrayBuffers([n.data,e])}if(null!=this.userDefinedMetadata){const t=!0;yn(this.userDefinedMetadata,this.name,t),r.userDefinedMetadata=this.userDefinedMetadata}return r.weightData=n.data,r.weightSpecs=n.specs,t.save(r)}setUserDefinedMetadata(t){yn(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}Zn.className="Model",d.lh.registerClass(Zn);class Qn extends Zn{}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
async function tr(t,e){"modelTopology"in t||(t={modelTopology:t});let n=(t=t).modelTopology;null!=n.model_config&&(n=n.model_config);const r=Ge(_n(n),e);if(null!=t.weightsManifest){const e=await d.sf.loadWeights(t.weightsManifest,t.pathPrefix,r.weights.map(t=>t.originalName)),n={};for(const t of r.weights)n[t.originalName]=e[t.originalName];r.loadWeights(n),Object(d.Ae)(e)}return r}async function er(t,e){if(null==e&&(e={}),"string"==typeof t){const n=d.sf.getLoadHandlers(t,e);if(0===n.length)n.push(d.sf.browserHTTPRequest(t,e));else if(n.length>1)throw new g(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return async function(t,e,n){null==n&&(n={});if(null==t.load)throw new g("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const r=await t.load();let i=r.modelTopology;null!=i.model_config&&(i=i.model_config);const a=null==n.strict||n.strict,o=null!=r.weightData&&null!=r.weightSpecs&&a,s=Ge(_n(i),e,o),u=r.trainingConfig;null!=u&&s.loadTrainingConfig(u);null!=r.userDefinedMetadata&&s.setUserDefinedMetadata(r.userDefinedMetadata);if(null!=r.weightData){if(null==r.weightSpecs)throw new g("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:t,optimizerWeights:e}=function(t,e){const n=d.sf.decodeWeights(t,e),r={},i=[];return e.forEach(t=>{"optimizer"===t.group?i.push({name:t.name,tensor:n[t.name]}):r[t.name]=n[t.name]}),{modelWeights:r,optimizerWeights:i}}(r.weightData,r.weightSpecs);s.loadWeights(t,a),null!=s.optimizer&&e.length>0&&await s.optimizer.setWeights(e),Object(d.Ae)(t),Object(d.Ae)(e.map(t=>t.tensor))}return s}(t,void 0,e)}Qn.className="Functional",d.lh.registerClass(Qn);class nr extends Zn{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=null!=t.name?t.name:ye("sequential_"),null!=t.layers)for(const e of t.layers)this.add(e)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(t=>t<0))throw new g("Negative dimension size caused by adding layer "+t.name+" with input shape ["+t.inboundNodes[0].inputTensors[0].shape+"]")}add(t){const e=t instanceof nr||t instanceof Zn;let n;if(e){if(n=t,1!==n.outputs.length)throw new g("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new g("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new g("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const e=Ie({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(e)}if(e)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new g(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(1!==t.inboundNodes[0].outputTensors.length)throw new g("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=function t(e,n,r){if((null==n||null!=r&&r>0)&&(n=e.sourceLayer,r=e.nodeIndex),0===n.inboundNodes.length)return[e];{const e=n.inboundNodes[r];if(0===e.inboundLayers.length)return e.inputTensors;{const n=[];for(let r=0;r<e.inboundLayers.length;r++){const i=t(e.inputTensors[r],e.inboundLayers[r],e.nodeIndices[r]);for(const t of i)-1===n.indexOf(t)&&n.push(t)}return n}}}(this.outputs[0])}this.inboundNodes=[],new Ne({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:v(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(t=>t.shape),outputShapes:this.outputs[0].shape})}else{const e=t.apply(this.outputs[0]);if(Array.isArray(e))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,e){return null==this.model&&this.build(),this.model.call(t,e)}build(t){if(ke(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Zn({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,e,n=console.log){this.built||this.build(),super.summary(t,e,n)}setWeights(t){null==this.model&&this.build(),this.model.setWeights(t)}evaluate(t,e,n={}){if(!this.built)throw new m("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)}async evaluateDataset(t,e){if(!this.built)throw new m("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,e)}predict(t,e={}){return null==this.model&&this.build(),this.model.predict(t,e)}predictOnBatch(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,e,n={}){if(!this.built)throw new m("The model needs to be compiled before being used.");return this.model.fit(t,e,n)}async fitDataset(t,e){if(!this.built)throw new m("The model needs to be compiled before being used.");return this.model.fitDataset(t,e)}async trainOnBatch(t,e){return this.model.trainOnBatch(t,e)}static fromConfig(t,e,n={},r=!1){let i,a={};if(e instanceof Array){if(null==e[0].className||"Merge"===e[0].className)throw new g("Legacy serialization format not supported yet.");i=e}else d.qi.assert(null!=e.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=e.layers,delete e.layers,a=e;const o=new t(a);if(!(o instanceof nr))throw new b("Sequential.fromConfig called on non-Sequential input: "+o);for(const t of i){const e=Ge(t,void 0,r);r&&e.setFastWeightInitDuringBuild(!0),o.add(e)}return o}set stopTraining(t){if(null==this.model)throw new g("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(null==this.model)throw new g("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const e of this.layers){const n={};n.className=e.getClassName(),n.config=e.getConfig(),t.push(n)}return{name:this.name,layers:t}}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function rr(t){return new Zn(t)}function ir(t){return new nr(t)}function ar(t,e){return null==e&&(e={}),er(t,e)}function or(t){return Ie(t)}function sr(t,e){Ue.registerCallbackConstructor(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */nr.className="Sequential",d.lh.registerClass(nr);class ur extends d.lh.Serializable{getConfig(){return{}}}class cr extends ur{apply(t,e=1){return function(t,e=1){if(1!==e)throw new b(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return d.He(t)}(t,e)}}cr.className="elu",d.lh.registerClass(cr);class lr extends ur{apply(t){return d.jh(t)}}lr.className="selu",d.lh.registerClass(lr);class dr extends ur{apply(t){return d.Ug(t)}}dr.className="relu",d.lh.registerClass(dr);class fr extends ur{apply(t){return Object(d.di)(()=>d.cg(6,d.Ug(t)))}}fr.className="relu6",d.lh.registerClass(fr);class hr extends ur{apply(t){return t}}hr.className="linear",d.lh.registerClass(hr);class pr extends ur{apply(t){return d.ph(t)}}pr.className="sigmoid",d.lh.registerClass(pr);class mr extends ur{apply(t){return function(t){return Object(d.di)(()=>{const e=d.wd(.5,d.jg(.2,t));return d.Zd(e,0,1)})}(t)}}mr.className="hardSigmoid",d.lh.registerClass(mr);class gr extends ur{apply(t){return d.Bh(t)}}gr.className="softplus",d.lh.registerClass(gr);class br extends ur{apply(t){return function(t){return Object(d.di)(()=>d.Ce(t,d.td(t).add(1)))}(t)}}br.className="softsign",d.lh.registerClass(br);class yr extends ur{apply(t){return d.Th(t)}}yr.className="tanh",d.lh.registerClass(yr);class vr extends ur{apply(t,e=-1){return d.Ah(t,e)}}vr.className="softmax",d.lh.registerClass(vr);class xr extends ur{apply(t,e=-1){return d.Kf(t,e)}}xr.className="logSoftmax",d.lh.registerClass(xr);class wr extends ur{apply(t,e=1){return Object(d.di)(()=>d.ph(t.mul(e)).mul(t))}}function kr(t){return t.getClassName()}function Or(t,e={}){return S(t,d.lh.SerializationMap.getMap().classNameMap,e,"activation")}function _r(t){if(null==t){const t={className:"linear",config:{}};return Or(t)}if("string"==typeof t){const e={};return e.className=t,e.config={},Or(e)}return t instanceof ur?t:Or(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ar(t){if(null!=t&&"object"!=typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+t)}wr.className="swish",d.lh.registerClass(wr);class Cr extends d.lh.Serializable{}class Er extends Cr{constructor(t){super(),Ar(t),this.l1=null==t||null==t.l1?.01:t.l1,this.l2=null==t||null==t.l2?.01:t.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(t){return Object(d.di)(()=>{let e=Object(d.yi)([1]);return this.hasL1&&(e=Object(d.wd)(e,Object(d.Qh)(d.jg(this.l1,Object(d.td)(t))))),this.hasL2&&(e=Object(d.wd)(e,Object(d.Qh)(d.jg(this.l2,Et(t))))),e.asScalar()})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,e){return new t({l1:e.l1,l2:e.l2})}}Er.className="L1L2",d.lh.registerClass(Er);const Sr={l1l2:"L1L2"};function jr(t){return E(t)}function Nr(t,e={}){return S(t,d.lh.SerializationMap.getMap().classNameMap,e,"regularizer")}function Tr(t){if(null==t)return null;if("string"==typeof t){return Nr({className:t in Sr?Sr[t]:t,config:{}})}return t instanceof Cr?t:Nr(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Fr extends Fe{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,null!=t&&(this.maxValue=t.maxValue)}call(t,e){t=we(t);let n=Object(d.Ug)(t);return null!=this.maxValue&&(n=Object(d.Zd)(n,0,this.maxValue)),n}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},e=super.getConfig();return Object.assign(t,e),t}}Fr.className="ReLU",d.lh.registerClass(Fr);class Dr extends Fe{constructor(t){super(null==t?{}:t),this.DEFAULT_ALPHA=.3,null==t&&(t={}),this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=we(t);return Object(d.zf)(n,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}Dr.className="LeakyReLU",d.lh.registerClass(Dr);class Ir extends Fe{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==t&&(t={}),this.supportsMasking=!0,this.alphaInitializer=Qt(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Tr(t.alphaRegularizer),this.alphaConstraint=V(t.alphaConstraint),null==t.sharedAxes)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else{if("number"!=typeof t.sharedAxes)throw new g("Expected sharedAxes to be a number or an array of numbers, but got "+t.sharedAxes);this.sharedAxes=[t.sharedAxes]}}build(t){const e=(t=ke(t)).slice(1);if(null!=this.sharedAxes)for(const t of this.sharedAxes)e[t-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let e=1;e<t.length;++e)n[e]=t[e];this.inputSpec=[new Ee({ndim:t.length,axes:n})],this.built=!0}call(t,e){return t=we(t),Object(d.Fg)(t,this.alpha.read())}getConfig(){const t={alphaInitializer:Zt(this.alphaInitializer),alphaRegularizer:jr(this.alphaRegularizer),alphaConstraint:W(this.alphaConstraint),sharedAxes:this.sharedAxes},e=super.getConfig();return Object.assign(t,e),t}}Ir.className="PReLU",d.lh.registerClass(Ir);class Mr extends Fe{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==this.DEFAULT_ALPHA)throw new b(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=we(t);return Object(d.He)(n)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}Mr.className="ELU",d.lh.registerClass(Mr);class $r extends Fe{constructor(t){super(null==t?{}:t),this.DEFAULT_THETA=1,null==t&&(t={}),this.theta=null==t.theta?this.DEFAULT_THETA:t.theta}call(t,e){const n=we(t);return n.mul(gt(n.greater(this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},e=super.getConfig();return Object.assign(t,e),t}}$r.className="ThresholdedReLU",d.lh.registerClass($r);class Rr extends Fe{constructor(t){super(null==t?{}:t),this.DEFAULT_AXIS=1,null==t&&(t={}),this.softmax=(new vr).apply,this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis}call(t,e){const n=we(t);return this.softmax(n,this.axis)}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Br(t,e,n){if("number"==typeof t)return v(t,e);if(t.length!==e)throw new g(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let i=0;i<e;++i){const a=t[i];if((r=a)!==parseInt(r.toString(),10))throw new g(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number `+a)}return t;var r}function zr(t,e,n,r,i=1){if(null==t)return t;let a;return a="same"===n?t:t-(e+(e-1)*(i-1))+1,Math.floor((a+r-1)/r)}function Lr(t,e,n,r){if(null==t)return null;if("valid"===r)t=t*e+pt([n-e,0]);else{if("same"!==r)throw new g(`Unsupport padding mode: ${r}.`);t*=e}return t}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Pr(t,e){return Object(d.di)(()=>(nt(e),"channelsFirst"===e?d.ii(t,[0,2,3,1]):t))}function qr(t,e){return Object(d.di)(()=>(nt(e),"channelsFirst"===e?d.ii(t,[0,2,3,4,1]):t))}function Wr(t,e,n,r=1,i="valid",a,o=1){return Object(d.di)(()=>{if(null==a&&(a="channelsLast"),nt(a),3!==t.shape.length)throw new g("The input of a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead.");if(3!==e.shape.length)throw new g("The kernel for a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead");if(null!=n&&1!==n.shape.length)throw new g("The bias for a conv1dWithBias operation should be 1, but is "+e.shape.length+" instead");if("channelsFirst"===a&&(t=d.ii(t,[0,2,1])),"causal"===i)throw new b("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let s=d.he(t,e,r,"same"===i?"same":"valid","NWC",o);return null!=n&&(s=jt(s,n)),s})}function Ur(t,e,n,r=[1,1],i="valid",a,o,s=null){return Object(d.di)(()=>{if(null==a&&(a="channelsLast"),nt(a),3!==t.rank&&4!==t.rank)throw new g(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(3!==e.rank&&4!==e.rank)throw new g(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let u=Pr(t,a);if("causal"===i)throw new b("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=d.af.conv2d({x:u,filter:e,strides:r,pad:"same"===i?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===a&&(u=d.ii(u,[0,3,1,2])),u})}function Vr(t,e,n,r=[1,1,1],i="valid",a,o){return Object(d.di)(()=>{if(null==a&&(a="channelsLast"),nt(a),4!==t.rank&&5!==t.rank)throw new g("conv3dWithBias expects input to be of rank 4 or 5, but received "+t.rank+".");if(4!==e.rank&&5!==e.rank)throw new g("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+t.rank+".");let s=qr(t,a);if("causal"===i)throw new b("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=d.ke(s,e,r,"same"===i?"same":"valid","NDHWC",o),null!=n&&(s=jt(s,n)),"channelsFirst"===a&&(s=d.ii(s,[0,4,1,2,3])),s})}Rr.className="Softmax",d.lh.registerClass(Rr);class Gr extends Fe{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Gr.verifyArgs(e),this.rank=t,I(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new b(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Br(e.kernelSize,t,"kernelSize"),this.strides=Br(null==e.strides?1:e.strides,t,"strides"),this.padding=null==e.padding?"valid":e.padding,rt(this.padding),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,nt(this.dataFormat),this.activation=_r(e.activation),this.useBias=null==e.useBias||e.useBias,this.biasInitializer=Qt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=V(e.biasConstraint),this.biasRegularizer=Tr(e.biasRegularizer),this.activityRegularizer=Tr(e.activityRegularizer),this.dilationRate=Br(null==e.dilationRate?1:e.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new g("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(this.dilationRate));if(2===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new g("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(this.dilationRate))}else if(3===this.rank)if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new g("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(this.dilationRate))}static verifyArgs(t){if(x("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!D(t.kernelSize,"number",1,3))throw new g(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:kr(this.activation),useBias:this.useBias,biasInitializer:Zt(this.biasInitializer),biasRegularizer:jr(this.biasRegularizer),activityRegularizer:jr(this.activityRegularizer),biasConstraint:W(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class Hr extends Gr{constructor(t,e){super(t,e),this.kernel=null,Hr.verifyArgs(e),this.filters=e.filters,I(this.filters,"filters"),this.kernelInitializer=Qt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=V(e.kernelConstraint),this.kernelRegularizer=Tr(e.kernelRegularizer)}build(t){t=ke(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new g("The channel dimension of the input should be defined. Found "+t[e]);const n=t[e],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:n}}],this.built=!0}call(t,e){return Object(d.di)(()=>{let e;t=we(t);const n=null==this.bias?null:this.bias.read(),r=M(this.activation.getClassName());if(null!=r&&2===this.rank)e=Ur(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)e=Wr(t,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)e=Ur(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new b("convolutions greater than 3D are not implemented yet.");e=Vr(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(e=this.activation.apply(e))}return e})}computeOutputShape(t){t=ke(t);const e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let t=0;t<n.length;++t){const r=zr(n[t],this.kernelSize[t],this.padding,this.strides[t],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[t]);e.push(r)}let r=[t[0]];return"channelsLast"===this.dataFormat?(r=r.concat(e),r.push(this.filters)):(r.push(this.filters),r=r.concat(e)),r}getConfig(){const t={filters:this.filters,kernelInitializer:Zt(this.kernelInitializer),kernelRegularizer:jr(this.kernelRegularizer),kernelConstraint:W(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new g("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(t.filters))}}class Xr extends Hr{constructor(t){super(2,t),Xr.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&!D(t.kernelSize,"number",1,2))throw new g(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}Xr.className="Conv2D",d.lh.registerClass(Xr);class Kr extends Hr{constructor(t){super(3,t),Kr.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new g(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}Kr.className="Conv3D",d.lh.registerClass(Kr);class Yr extends Xr{constructor(t){if(super(t),this.inputSpec=[new Ee({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new g("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+this.padding)}build(t){if(4!==(t=ke(t)).length)throw new g("Input should have rank 4; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new g("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ee({ndim:4,axes:{[e]:n}})],this.built=!0}call(t,e){return d.di(()=>{let e=we(t);if(4!==e.shape.length)throw new g("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+e.shape.length);const n=e.shape,r=n[0];let i,a;"channelsFirst"===this.dataFormat?(i=2,a=3):(i=1,a=2);const o=n[i],s=n[a],u=this.kernelSize[0],c=this.kernelSize[1],l=this.strides[0],f=this.strides[1],h=[r,Lr(o,l,u,this.padding),Lr(s,f,c,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(e=d.ii(e,[0,2,3,1]));let p=d.je(e,this.kernel.read(),h,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(p=d.ii(p,[0,3,1,2])),null!=this.bias&&(p=jt(p,this.bias.read(),this.dataFormat)),null!=this.activation&&(p=this.activation.apply(p)),p})}computeOutputShape(t){const e=(t=ke(t)).slice();let n,r,i;"channelsFirst"===this.dataFormat?(n=1,r=2,i=3):(n=3,r=1,i=2);const a=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return e[n]=this.filters,e[r]=Lr(e[r],s,a,this.padding),e[i]=Lr(e[i],u,o,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}Yr.className="Conv2DTranspose",d.lh.registerClass(Yr);class Jr extends Hr{constructor(t,e){if(super(t,e),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==e.filters)throw new g("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=e.kernelInitializer||null!=e.kernelRegularizer||null!=e.kernelConstraint)throw new g("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=e.padding&&"same"!==e.padding&&"valid"!==e.padding)throw new g(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received `+JSON.stringify(e.padding));this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=Qt(e.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Tr(e.depthwiseRegularizer),this.depthwiseConstraint=V(e.depthwiseConstraint),this.pointwiseInitializer=Qt(e.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Tr(e.pointwiseRegularizer),this.pointwiseConstraint=V(e.pointwiseConstraint)}build(t){if((t=ke(t)).length<this.rank+2)throw new g(`Inputs to SeparableConv${this.rank}D should have rank `+(this.rank+2)+", but received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e]||t[e]<0)throw new g("The channel dimension of the inputs should be defined, but found "+JSON.stringify(t[e]));const n=t[e],r=this.kernelSize.concat([n,this.depthMultiplier]),i=[];for(let t=0;t<this.rank;++t)i.push(1);i.push(n*this.depthMultiplier,this.filters);this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new Ee({ndim:this.rank+2,axes:{[e]:n}})],this.built=!0}call(t,e){return Object(d.di)(()=>{let e;if(t=we(t),1===this.rank)throw new b("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(t=d.ii(t,[0,2,3,1])),e=d.kh(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(e=jt(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),"channelsFirst"===this.dataFormat&&(e=d.ii(e,[0,3,1,2])),e})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=Zt(this.depthwiseInitializer),t.pointwiseInitializer=Zt(this.pointwiseInitializer),t.depthwiseRegularizer=jr(this.depthwiseRegularizer),t.pointwiseRegularizer=jr(this.pointwiseRegularizer),t.depthwiseConstraint=W(this.depthwiseConstraint),t.pointwiseConstraint=W(this.pointwiseConstraint),t}}Jr.className="SeparableConv";class Zr extends Jr{constructor(t){super(2,t)}}Zr.className="SeparableConv2D",d.lh.registerClass(Zr);class Qr extends Hr{constructor(t){super(1,t),Qr.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&!D(t.kernelSize,"number",1,1))throw new g(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}Qr.className="Conv1D",d.lh.registerClass(Qr);class ti extends Fe{constructor(t){super(t),"number"==typeof t.cropping?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"==typeof t.cropping[0]?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,e){return Object(d.di)(()=>{if(t=we(t),"channelsLast"===this.dataFormat){const e=xt(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return xt(e,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const e=xt(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return xt(e,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}ti.className="Cropping2D",d.lh.registerClass(ti);class ei extends Fe{constructor(t){var e;super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==t.size?this.DEFAULT_SIZE:t.size,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,nt(this.dataFormat),this.interpolation=null==t.interpolation?"nearest":t.interpolation,e=this.interpolation,F(J,"InterpolationFormat",e)}computeOutputShape(t){if("channelsFirst"===this.dataFormat){const e=null==t[2]?null:this.size[0]*t[2],n=null==t[3]?null:this.size[1]*t[3];return[t[0],t[1],e,n]}{const e=null==t[1]?null:this.size[0]*t[1],n=null==t[2]?null:this.size[1]*t[2];return[t[0],e,n,t[3]]}}call(t,e){return d.di(()=>{let e=we(t);const n=e.shape;if("channelsFirst"===this.dataFormat){e=d.ii(e,[0,2,3,1]);const t=this.size[0]*n[2],r=this.size[1]*n[3],i="nearest"===this.interpolation?e.resizeNearestNeighbor([t,r]):e.resizeBilinear([t,r]);return d.ii(i,[0,3,1,2])}{const t=this.size[0]*n[1],r=this.size[1]*n[2];return"nearest"===this.interpolation?e.resizeNearestNeighbor([t,r]):e.resizeBilinear([t,r])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}ei.className="UpSampling2D",d.lh.registerClass(ei);class ni extends Gr{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=Qt(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=V(t.depthwiseConstraint),this.depthwiseRegularizer=Tr(t.depthwiseRegularizer)}build(t){if((t=ke(t)).length<4)throw new g(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new g(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[e]}).`);const n=t[e],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return Object(d.di)(()=>{let e=
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function(t,e,n=[1,1],r="valid",i,a){return Object(d.di)(()=>{null==i&&(i="channelsLast"),nt(i);let o=Pr(t,i);if(4!==t.rank)throw new g("Input for depthwiseConv2d is required to be 4-D, but is instead "+t.rank+"-D");if(4!==e.rank)throw new g("depthwiseKernel is required to be 4-D, but is instead "+e.rank+"-D");return o=d.ve(o,e,n,"same"===r?"same":"valid","NHWC",a),"channelsFirst"===i&&(o=d.ii(o,[0,3,1,2])),o})}(t=we(t),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(e=jt(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),e})}computeOutputShape(t){t=ke(t);const e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,i=zr(e,this.kernelSize[0],this.padding,this.strides[0]),a=zr(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],r,i,a]:[t[0],i,a,r]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=Zt(this.depthwiseInitializer),t.depthwiseRegularizer=jr(this.depthwiseRegularizer),t.depthwiseConstraint=W(this.depthwiseRegularizer),t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function ri(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new g("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function i(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=i(e),constants:n=i(n)}}function ii(t,e,n,r=!1,i,a,o=!1,s=!1){return d.di(()=>{const u=e.shape.length;if(u<3)throw new g(`Input should be at least 3D, but is ${u}D.`);const c=[1,0].concat(mt(2,u));if(e=d.ii(e,c),null!=a)throw new b("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=i&&((i=i.asType("bool").asType("float32")).rank===u-1&&(i=d.Re(i,-1)),i=d.ii(i,c)),r&&(e=d.Yg(e,0),null!=i&&(i=d.Yg(i,0)));const l=[];let f,h=n;const p=e.shape[0],m=d.oi(e);let y,v;null!=i&&(y=d.oi(i));for(let e=0;e<p;++e){const n=m[e],r=d.di(()=>t(n,h));if(null==i)f=r[0],h=r[1];else{const t=d.di(()=>{const t=y[e],n=d.ug(t).sub(t);return{output:r[0].mul(t).add(h[0].mul(n)),newStates:h.map((e,i)=>r[1][i].mul(t).add(e.mul(n)))}});f=t.output,h=t.newStates}s&&l.push(f)}if(s){const t=1;v=d.Lh(l,t)}return[f,v,h]})}ni.className="DepthwiseConv2D",d.lh.registerClass(ni);class ai extends Fe{constructor(t){let e;if(super(t),null==t.cell)throw new g("cell property is missing for the constructor of RNN.");if(e=Array.isArray(t.cell)?new hi({cells:t.cell}):t.cell,null==e.stateSize)throw new g("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=e,this.returnSequences=null!=t.returnSequences&&t.returnSequences,this.returnState=null!=t.returnState&&t.returnState,this.goBackwards=null!=t.goBackwards&&t.goBackwards,this._stateful=null!=t.stateful&&t.stateful,this.unroll=null!=t.unroll&&t.unroll,this.supportsMasking=!0,this.inputSpec=[new Ee({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){return mt(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(t=>null)}return this.states_}setStates(t){this.states_=t}computeOutputShape(t){ve(t)&&(t=t[0]),t=t;let e=this.cell.stateSize;Array.isArray(e)||(e=[e]);const n=e[0];let r;if(r=this.returnSequences?[t[0],t[1],n]:[t[0],n],this.returnState){const n=[];for(const r of e)n.push([t[0],r]);return[r].concat(n)}return r}computeMask(t,e){return d.di(()=>{Array.isArray(e)&&(e=e[0]);const t=this.returnSequences?e:null;if(this.returnState){const e=this.states.map(t=>null);return[t].concat(e)}return t})}get states(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[];for(let n=0;n<t;++n)e.push(null);return e}return this.states_}set states(t){this.states_=t}build(t){if(null!=this.numConstants)throw new b("Constants support is not implemented in RNN yet.");ve(t)&&(t=t[0]),t=t;const e=this.stateful?t[0]:null,n=t.slice(2);this.inputSpec[0]=new Ee({shape:[e,null,...n]});const r=[t[0]].concat(t.slice(2));let i;if(this.cell.build(r),i=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!d.qi.arraysEqual(this.stateSpec.map(t=>t.shape[t.shape.length-1]),i))throw new g(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is `+this.cell.stateSize)}else this.stateSpec=i.map(t=>new Ee({shape:[null,t]}));this.stateful&&this.resetStates()}resetStates(t,e=!1){Object(d.di)(()=>{if(!this.stateful)throw new p("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new g("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(t=>d.yi([n,t])):this.states_=[d.yi([n,this.cell.stateSize])];else if(null==t)d.Ae(this.states_),null!=this.keptStates&&(d.Ae(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(t=>d.yi([n,t])):this.states_[0]=d.yi([n,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new g(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: `+t);!0===e?this.keptStates.push(this.states_.slice()):d.Ae(this.states_);for(let e=0;e<this.states_.length;++e){const r=t[e],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[e]:this.cell.stateSize,a=[n,i];if(!d.qi.arraysEqual(r.shape,a))throw new g(`State ${e} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${r.shape}`);this.states_[e]=r}}this.states_=this.states_.map(t=>d.xf(t.clone()))})}apply(t,e){let n=null==e?null:e.initialState,r=null==e?null:e.constants;null==e&&(e={});const i=ri(t,n,r,this.numConstants);t=i.inputs,n=i.initialState,r=i.constants;let a=[],o=[];if(null!=n){e.initialState=n,a=a.concat(n),this.stateSpec=[];for(const t of n)this.stateSpec.push(new Ee({shape:t.shape}));o=o.concat(this.stateSpec)}null!=r&&(e.constants=r,a=a.concat(r),this.numConstants=r.length);if(a[0]instanceof Se){const n=[t].concat(a),r=this.inputSpec.concat(o),i=this.inputSpec;this.inputSpec=r;const s=super.apply(n,e);return this.inputSpec=i,s}return super.apply(t,e)}call(t,e){return Object(d.di)(()=>{const n=null==e?null:e.mask,r=null==e?null:e.training;let i=null==e?null:e.initialState;t=we(t),null==i&&(i=this.stateful?this.states_:this.getInitialState(t));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==a)throw new g(`RNN Layer has ${a} state(s) but was passed `+i.length+" initial state(s).");this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:r},s=ii((t,e)=>{const n=this.cell.call([t].concat(e),o);return[n[0],n.slice(1)]},t,i,this.goBackwards,n,null,this.unroll,this.returnSequences),u=s[0],c=s[1],l=s[2];this.stateful&&this.resetStates(l,r);const d=this.returnSequences?c:u;return this.returnState?[d].concat(l):d})}getInitialState(t){return Object(d.di)(()=>{let e=d.yi(t.shape);return e=d.Qh(e,[1,2]),e=bt(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(t=>t>1?Ot(e,[1,t]):e):this.cell.stateSize>1?[Ot(e,[1,this.cell.stateSize])]:[e]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===ai.className&&(e.cell={className:this.cell.getClassName(),config:n}),Object.assign({},n,t,e)}static fromConfig(t,e,n={}){const r=Ge(e.cell,n);return new t(Object.assign(e,{cell:r}))}}ai.className="RNN",d.lh.registerClass(ai);class oi extends Fe{}class si extends oi{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,I(this.units,"units"),this.activation=_r(null==t.activation?this.DEFAULT_ACTIVATION:t.activation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=Qt(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Qt(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Qt(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Tr(t.kernelRegularizer),this.recurrentRegularizer=Tr(t.recurrentRegularizer),this.biasRegularizer=Tr(t.biasRegularizer),this.kernelConstraint=V(t.kernelConstraint),this.recurrentConstraint=V(t.recurrentConstraint),this.biasConstraint=V(t.biasConstraint),this.dropout=ht([1,pt([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=ht([1,pt([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=ke(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return Object(d.di)(()=>{if(2!==(t=t).length)throw new g(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let n=t[1];t=t[0];const r=null!=e.training&&e.training;let i;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=pi({ones:()=>d.ug(t),rate:this.dropout,training:r})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=pi({ones:()=>d.ug(n),rate:this.recurrentDropout,training:r}));const a=this.dropoutMask,o=this.recurrentDropoutMask;i=At(null!=a?d.jg(t,a):t,this.kernel.read()),null!=this.bias&&(i=jt(i,this.bias.read())),null!=o&&(n=d.jg(n,o));let s=d.wd(i,At(n,this.recurrentKernel.read()));return null!=this.activation&&(s=this.activation.apply(s)),[s,s]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:kr(this.activation),useBias:this.useBias,kernelInitializer:Zt(this.kernelInitializer),recurrentInitializer:Zt(this.recurrentInitializer),biasInitializer:Zt(this.biasInitializer),kernelRegularizer:jr(this.kernelRegularizer),recurrentRegularizer:jr(this.recurrentRegularizer),biasRegularizer:jr(this.biasRegularizer),activityRegularizer:jr(this.activityRegularizer),kernelConstraint:W(this.kernelConstraint),recurrentConstraint:W(this.recurrentConstraint),biasConstraint:W(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},t,e)}}si.className="SimpleRNNCell",d.lh.registerClass(si);class ui extends ai{constructor(t){t.cell=new si(t),super(t)}call(t,e){return Object(d.di)(()=>{null!=this.cell.dropoutMask&&(d.Ae(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(d.Ae(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,r=null==e?null:e.training,i=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:i})})}static fromConfig(t,e){return new t(e)}}ui.className="SimpleRNN",d.lh.registerClass(ui);class ci extends oi{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new g("GRUCell does not support reset_after parameter set to true.");this.units=t.units,I(this.units,"units"),this.activation=_r(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=_r(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=Qt(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Qt(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Qt(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Tr(t.kernelRegularizer),this.recurrentRegularizer=Tr(t.recurrentRegularizer),this.biasRegularizer=Tr(t.biasRegularizer),this.kernelConstraint=V(t.kernelConstraint),this.recurrentConstraint=V(t.recurrentConstraint),this.biasConstraint=V(t.biasConstraint),this.dropout=ht([1,pt([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=ht([1,pt([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){const e=(t=ke(t))[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return Object(d.di)(()=>{if(2!==(t=t).length)throw new g("GRUCell expects 2 input Tensors (inputs, h, c), got "+t.length+".");const n=null!=e.training&&e.training;let r=t[1];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=pi({ones:()=>d.ug(t),rate:this.dropout,training:n,count:3})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=pi({ones:()=>d.ug(r),rate:this.recurrentDropout,training:n,count:3}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let o,s,u;0<this.dropout&&this.dropout<1&&(t=d.jg(t,i[0]));let c=At(t,this.kernel.read());this.useBias&&(c=jt(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=d.jg(r,a[0]));const l=this.recurrentKernel.read(),[f,h]=d.Fh(l,[2*this.units,this.units],l.rank-1),p=At(r,f),[m,b,y]=d.Fh(c,3,c.rank-1),[v,x]=d.Fh(p,2,p.rank-1);o=this.recurrentActivation.apply(d.wd(m,v)),s=this.recurrentActivation.apply(d.wd(b,x));const w=At(d.jg(s,r),h);u=this.activation.apply(d.wd(y,w));const k=d.wd(d.jg(o,r),d.jg(d.wd(1,d.ng(o)),u));return[k,k]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:kr(this.activation),recurrentActivation:kr(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Zt(this.kernelInitializer),recurrentInitializer:Zt(this.recurrentInitializer),biasInitializer:Zt(this.biasInitializer),kernelRegularizer:jr(this.kernelRegularizer),recurrentRegularizer:jr(this.recurrentRegularizer),biasRegularizer:jr(this.biasRegularizer),activityRegularizer:jr(this.activityRegularizer),kernelConstraint:W(this.kernelConstraint),recurrentConstraint:W(this.recurrentConstraint),biasConstraint:W(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},t,e)}}ci.className="GRUCell",d.lh.registerClass(ci);class li extends ai{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new ci(t),super(t)}call(t,e){return Object(d.di)(()=>{null!=this.cell.dropoutMask&&(d.Ae(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(d.Ae(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,r=null==e?null:e.training,i=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:i})})}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}li.className="GRU",d.lh.registerClass(li);class di extends oi{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,I(this.units,"units"),this.activation=_r(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=_r(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=Qt(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Qt(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Qt(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=Tr(t.kernelRegularizer),this.recurrentRegularizer=Tr(t.recurrentRegularizer),this.biasRegularizer=Tr(t.biasRegularizer),this.kernelConstraint=V(t.kernelConstraint),this.recurrentConstraint=V(t.recurrentConstraint),this.biasConstraint=V(t.biasConstraint),this.dropout=ht([1,pt([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=ht([1,pt([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var e;const n=(t=ke(t))[t.length-1];let r;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const t=this.biasInitializer,n=this.units;r=new((e=class extends It{apply(e,r){const i=t.apply([n]),a=(new $t).apply([n]),o=t.apply([2*n]);return kt(kt(i,a),o)}}).className="CustomInit",e)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,e){return Object(d.di)(()=>{const n=null!=e.training&&e.training;if(3!==(t=t).length)throw new g("LSTMCell expects 3 input Tensors (inputs, h, c), got "+t.length+".");let r=t[1];const i=t[2];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=pi({ones:()=>d.ug(t),rate:this.dropout,training:n,count:4})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=pi({ones:()=>d.ug(r),rate:this.recurrentDropout,training:n,count:4}));const a=this.dropoutMask,o=this.recurrentDropoutMask;let s,u,c,l;0<this.dropout&&this.dropout<1&&(t=d.jg(t,a[0]));let f=At(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=d.jg(r,o[0])),f=d.wd(f,At(r,this.recurrentKernel.read())),this.useBias&&(f=jt(f,this.bias.read()));const[h,p,m,b]=d.Fh(f,4,f.rank-1);s=this.recurrentActivation.apply(h),u=this.recurrentActivation.apply(p),c=d.wd(d.jg(u,i),d.jg(s,this.activation.apply(m))),l=this.recurrentActivation.apply(b);const y=d.jg(l,this.activation.apply(c));return[y,y,c]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:kr(this.activation),recurrentActivation:kr(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Zt(this.kernelInitializer),recurrentInitializer:Zt(this.recurrentInitializer),biasInitializer:Zt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:jr(this.kernelRegularizer),recurrentRegularizer:jr(this.recurrentRegularizer),biasRegularizer:jr(this.biasRegularizer),activityRegularizer:jr(this.activityRegularizer),kernelConstraint:W(this.kernelConstraint),recurrentConstraint:W(this.recurrentConstraint),biasConstraint:W(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},t,e)}}di.className="LSTMCell",d.lh.registerClass(di);class fi extends ai{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new di(t),super(t)}call(t,e){return Object(d.di)(()=>{null!=this.cell.dropoutMask&&(d.Ae(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(d.Ae(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,r=null==e?null:e.training,i=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:i})})}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}fi.className="LSTM",d.lh.registerClass(fi);class hi extends oi{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?t.push(...e.stateSize):t.push(e.stateSize);return t}call(t,e){return Object(d.di)(()=>{let n=(t=t).slice(1);const r=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?r.push(n.splice(0,t.stateSize.length)):r.push(n.splice(0,1));r.reverse();const i=[];let a;for(let o=0;o<this.cells.length;++o){const s=this.cells[o];n=r[o],a=0===o?[t[0]].concat(n):[a[0]].concat(n),a=s.call(a,e),i.push(a.slice(1))}n=[];for(const t of i.slice().reverse())n.push(...t);return[a[0]].concat(n)})}build(t){let e;ve(t)&&(t=t[0]),t=t,this.cells.forEach((n,r)=>{ot("RNNCell_"+r,()=>{n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]})}),this.built=!0}getConfig(){const t=super.getConfig(),e={cells:this.cells.map(t=>({className:t.getClassName(),config:t.getConfig()}))};return Object.assign({},t,e)}static fromConfig(t,e,n={}){const r=[];for(const t of e.cells)r.push(Ge(t,n));return new t({cells:r})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.cells)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e.concat(t)}return t}getWeights(){const t=[];for(const e of this.cells)t.push(...e.weights);return Ae(t)}setWeights(t){const e=[];for(const n of this.cells){const r=n.weights.length,i=t.splice(r);for(let t=0;t<n.weights.length;++t)e.push([n.weights[t],i[t]])}Ce(e)}}function pi(t){const{ones:e,rate:n,training:r=!1,count:i=1}=t,a=()=>Nt(e(),n),o=()=>Tt(a,e,r);if(!i||i<=1)return d.xf(o().clone());return Array(i).fill(void 0).map(o).map(t=>d.xf(t.clone()))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */hi.className="StackedRNNCells",d.lh.registerClass(hi);var mi=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class gi extends ai{constructor(t){if(t.unroll)throw new b("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new b("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new Ee({ndim:5})]}call(t,e){return d.di(()=>{if(null!=this.cell.dropoutMask&&(d.Ae(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(d.Ae(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),e&&e.constants)throw new g("ConvRNN2D cell does not support constants");const n=null==e?null:e.mask,r=null==e?null:e.training,i=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:i})})}computeOutputShape(t){let e=this.computeSingleOutputShape(t);return this.returnSequences||(e=[e[0],...e.slice(2)]),this.returnState&&(e=[e,...Array(2).fill([t[0],...e.slice(-3)])]),e}getInitialState(t){return d.di(()=>{const{stateSize:e}=this.cell,n=t.shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)],a=d.yi(i);return Array.isArray(e)?Array(e.length).fill(a):[a]})}resetStates(t,e=!1){d.di(()=>{if(!this.stateful)throw new p("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)];if(null==n[0])throw new g("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>d.yi(i)):this.states_=[d.yi(i)];else if(null==t)d.Ae(this.states_),null!=this.keptStates&&(d.Ae(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>d.yi(i)):this.states_[0]=d.yi(i);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new g(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: `+t);e?this.keptStates.push(this.states_.slice()):d.Ae(this.states_);for(let e=0;e<this.states_.length;++e){const n=t[e],r=i;if(!d.qi.arraysEqual(n.shape,r))throw new g(`State ${e} is incompatible with layer ${this.name}: expected shape=${r}, received shape=${n.shape}`);this.states_[e]=n}}this.states_=this.states_.map(t=>d.xf(t.clone()))})}computeSingleOutputShape(t){const{dataFormat:e,filters:n,kernelSize:r,padding:i,strides:a,dilationRate:o}=this.cell,s="channelsFirst"===e,u=t[s?3:2],c=t[s?4:3],l=zr(u,r[0],i,a[0],o[0]),d=zr(c,r[1],i,a[1],o[1]);return[...t.slice(0,2),...s?[n,l,d]:[l,d,n]]}}gi.className="ConvRNN2D";class bi extends di{constructor(t){const{filters:e,kernelSize:n,strides:r,padding:i,dataFormat:a,dilationRate:o}=t;super(Object.assign({},t,{units:e})),this.filters=e,I(this.filters,"filters"),this.kernelSize=Br(n,2,"kernelSize"),this.kernelSize.forEach(t=>I(t,"kernelSize")),this.strides=Br(r||1,2,"strides"),this.strides.forEach(t=>I(t,"strides")),this.padding=i||"valid",rt(this.padding),this.dataFormat=a||"channelsLast",nt(this.dataFormat),this.dilationRate=Br(o||1,2,"dilationRate"),this.dilationRate.forEach(t=>I(t,"dilationRate"))}build(t){var e;t=ke(t);const n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new g("The channel dimension of the input should be defined. Found "+t[n]);const r=t[n],i=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let t;if(this.unitForgetBias){const n=this.biasInitializer,r=this.filters;t=new((e=class extends It{apply(t,e){return wt([n.apply([r]),d.tg([r]),n.apply([2*r])])}}).className="CustomInit",e)}else t=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,t,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,e){return d.di(()=>{if(3!==t.length)throw new g("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+t.length+".");const n=e.training||!1,r=t[0],i=t[1],a=t[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=pi({ones:()=>d.ug(r),rate:this.dropout,training:n,count:4}));const o=this.dropoutMask,s=(t,e,n)=>e&&e[n]?d.jg(e[n],t):t;let u=s(r,o,0),c=s(r,o,1),l=s(r,o,2),f=s(r,o,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=pi({ones:()=>d.ug(i),rate:this.recurrentDropout,training:n,count:4}));const h=this.recurrentDropoutMask;let p=s(i,h,0),m=s(i,h,1),b=s(i,h,2),y=s(i,h,3);const[v,x,w,k]=d.Fh(this.kernel.read(),4,3),[O,_,A,C]=this.useBias?d.Fh(this.bias.read(),4):[null,null,null,null];u=this.inputConv(u,v,O,this.padding),c=this.inputConv(c,x,_,this.padding),l=this.inputConv(l,w,A,this.padding),f=this.inputConv(f,k,C,this.padding);const[E,S,j,N]=d.Fh(this.recurrentKernel.read(),4,3);p=this.recurrentConv(p,E),m=this.recurrentConv(m,S),b=this.recurrentConv(b,j),y=this.recurrentConv(y,N);const T=this.recurrentActivation.apply(d.wd(u,p)),F=this.recurrentActivation.apply(d.wd(c,m)),D=d.wd(d.jg(F,a),d.jg(T,this.activation.apply(d.wd(l,b)))),I=d.jg(this.recurrentActivation.apply(d.wd(f,y)),this.activation.apply(D));return[I,I,D]})}getConfig(){const t=super.getConfig(),{units:e}=t,n=mi(t,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},n,r)}inputConv(t,e,n,r){const i=d.ie(t,e,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?jt(i,n,this.dataFormat):i}recurrentConv(t,e){return d.ie(t,e,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}bi.className="ConvLSTM2DCell",d.lh.registerClass(bi);class yi extends gi{constructor(t){const e=new bi(t);super(Object.assign({},t,{cell:e}))}static fromConfig(t,e){return new t(e)}}yi.className="ConvLSTM2D",d.lh.registerClass(yi);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class vi extends Fe{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(null==this.noiseShape)return this.noiseShape;const e=t.shape,n=[];for(let t=0;t<this.noiseShape.length;++t)n.push(null==this.noiseShape[t]?e[t]:this.noiseShape[t]);return n}call(t,e){return Object(d.di)(()=>{this.invokeCallHook(t,e);const n=we(t);if(0<this.rate&&this.rate<1){const t=null!=e.training&&e.training,r=this.getNoiseShape(n);return Tt(()=>Nt(n,this.rate,r,this.seed),()=>n,t)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=super.getConfig();return Object.assign(t,e),t}dispose(){return super.dispose()}}vi.className="Dropout",d.lh.registerClass(vi);class xi extends vi{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const e=t.shape;return[e[0],1,e[2]]}}xi.className="SpatialDropout1D",d.lh.registerClass(xi);class wi extends Fe{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=[e,t.inputDim]}this.units=t.units,I(this.units,"units"),this.activation=_r(t.activation),null!=t.useBias&&(this.useBias=t.useBias),this.kernelInitializer=Qt(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Qt(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=V(t.kernelConstraint),this.biasConstraint=V(t.biasConstraint),this.kernelRegularizer=Tr(t.kernelRegularizer),this.biasRegularizer=Tr(t.biasRegularizer),this.activityRegularizer=Tr(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){const e=(t=ke(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:e}}],this.built=!0}computeOutputShape(t){const e=(t=ke(t)).slice();return e[e.length-1]=this.units,e}call(t,e){return Object(d.di)(()=>{this.invokeCallHook(t,e);const n=we(t),r=M(this.activation.getClassName());let i;return null!=r?i=At(n,this.kernel.read(),r,this.bias?this.bias.read():null):(i=At(n,this.kernel.read()),null!=this.bias&&(i=jt(i,this.bias.read())),null!=this.activation&&(i=this.activation.apply(i))),i})}getConfig(){const t={units:this.units,activation:kr(this.activation),useBias:this.useBias,kernelInitializer:Zt(this.kernelInitializer),biasInitializer:Zt(this.biasInitializer),kernelRegularizer:jr(this.kernelRegularizer),biasRegularizer:jr(this.biasRegularizer),activityRegularizer:jr(this.activityRegularizer),kernelConstraint:W(this.kernelConstraint),biasConstraint:W(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}wi.className="Dense",d.lh.registerClass(wi);class ki extends Fe{constructor(t){super(t=t||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=ke(t);for(const e of t.slice(1))if(null==e)throw new g(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],dt(t,1)]}call(t,e){return Object(d.di)(()=>{this.invokeCallHook(t,e);let n=we(t);if("channelsFirst"===this.dataFormat&&n.rank>1){const t=[0];for(let e=2;e<n.rank;++e)t.push(e);t.push(1),n=n.transpose(t)}return function(t){if(t.rank<=1)throw new g(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],dt(t.shape,1)];return t.reshape(e)}(n)})}getConfig(){const t={};null!=this.dataFormat&&(t.dataFormat=this.dataFormat);const e=super.getConfig();return Object.assign(t,e),t}}ki.className="Flatten",d.lh.registerClass(ki);class Oi extends Fe{constructor(t){super(t),this.supportsMasking=!0,this.activation=_r(t.activation)}call(t,e){return Object(d.di)(()=>{this.invokeCallHook(t,e);const n=we(t);return this.activation.apply(n)})}getConfig(){const t={activation:kr(this.activation)},e=super.getConfig();return Object.assign(t,e),t}}Oi.className="Activation",d.lh.registerClass(Oi);class _i extends Fe{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,e){return Object(d.di)(()=>{return t=we(t),e=t,n=this.n,Object(d.di)(()=>{if(2!==e.shape.length)throw new g(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);return Ot(bt(e,1),[1,n,1])});var e,n})}getConfig(){const t={n:this.n},e=super.getConfig();return Object.assign(t,e),t}}_i.className="RepeatVector",d.lh.registerClass(_i);class Ai extends Fe{constructor(t){super(t),this.targetShape=t.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(t){return t<0||null==t}fixUnknownDimension(t,e){const n="Total size of new array must be unchanged.",r=e.slice();let i=1,a=null;for(let t=0;t<r.length;++t){const e=r[t];if(this.isUnknown(e)){if(null!==a)throw new g("Can only specifiy one unknown dimension.");a=t}else i*=e}const o=dt(t);if(null!==a){if(0===i||o%i!=0)throw new g(n);r[a]=o/i}else if(o!==i)throw new g(n);return r}computeOutputShape(t){let e=!1;for(let n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,e){return Object(d.di)(()=>{this.invokeCallHook(t,e);const n=we(t),r=n.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return n.reshape(i)})}getConfig(){const t={targetShape:this.targetShape},e=super.getConfig();return Object.assign(t,e),t}}Ai.className="Reshape",d.lh.registerClass(Ai);class Ci extends Fe{constructor(t){if(super(t),null==t.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+t.dims+" instead.");const e=mt(1,t.dims.length+1);if(!d.qi.arraysEqual(t.dims.slice().sort(),e))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Ee({ndim:this.dims.length+1})]}computeOutputShape(t){const e=(t=ke(t)).slice();return this.dims.forEach((n,r)=>{e[r+1]=t[n]}),e}call(t,e){return Object(d.ii)(we(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},e=super.getConfig();return Object.assign(t,e),t}}Ci.className="Permute",d.lh.registerClass(Ci);class Ei extends Fe{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,this.maskValue=null!=t?null==t.maskValue?0:t.maskValue:0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={maskValue:this.maskValue};return Object.assign(e,t),e}computeMask(t,e){const n=we(t);return Object(d.Ad)(Object(d.qg)(n,this.maskValue),-1)}call(t,e){return Object(d.di)(()=>{this.invokeCallHook(t,e);const n=we(t),r=Object(d.Ad)(Object(d.qg)(n,this.maskValue),-1,!0);return n.mul(r.asType(n.dtype))})}}Ei.className="Masking",d.lh.registerClass(Ei);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class Si extends Fe{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){let e=null;null!=t.batchSize&&(e=t.batchSize),null==t.inputLength?this.batchInputShape=[e,null]:this.batchInputShape=[e].concat(O(t.inputLength))}this.inputDim=t.inputDim,I(this.inputDim,"inputDim"),this.outputDim=t.outputDim,I(this.outputDim,"outputDim"),this.embeddingsInitializer=Qt(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Tr(t.embeddingsRegularizer),this.activityRegularizer=Tr(t.activityRegularizer),this.embeddingsConstraint=V(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,e){return Object(d.di)(()=>this.maskZero?(t=we(t),Object(d.qg)(t,Object(d.zi)(t))):null)}computeOutputShape(t){if(t=ke(t),null==this.inputLength)return[...t,this.outputDim];const e=O(this.inputLength);if(e.length!==t.length-1)throw new g(`"inputLength" is ${this.inputLength}, but received input shape has shape `+t);{let n=0;for(let r=0;r<e.length;++r){const i=e[r],a=t[r+1];if(null!=i&&null!=a&&i!==a)throw new g(`"inputLength" is ${this.inputLength}, but received input shape has shape `+t);null==i&&(e[n]=a),n++}}return[t[0],...e,this.outputDim]}call(t,e){return Object(d.di)(()=>{this.invokeCallHook(t,e);let n=we(t);"int32"!==n.dtype&&(n=gt(n,"int32"));return Ct(this.embeddings.read(),n.as1D()).reshape(ke(this.computeOutputShape(n.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Zt(this.embeddingsInitializer),embeddingsRegularizer:jr(this.embeddingsRegularizer),activityRegularizer:jr(this.activityRegularizer),embeddingsConstraint:W(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=super.getConfig();return Object.assign(t,e),t}}Si.className="Embedding",d.lh.registerClass(Si);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class ji extends Fe{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new b}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const n=t.slice(0,t.length-e.length);for(let r=0;r<e.length;++r){const i=t[t.length-e.length+r],a=e[r];if(null==i||null==a||i<0||a<0)n.push(null);else if(1===i)n.push(a);else if(1===a)n.push(i);else{if(i!==a)throw new g("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(i)}}return n}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[ke(t)]),(t=t).length<2)throw new g(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let e=[];for(const n of t)null!=n&&null!==n[0]&&e.push(n[0]);if(e=N(e),e.length>1)throw new g(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let n=null==t[0]?null:t[0].slice(1);for(let e=1;e<t.length;++e){const r=null==t[e]?null:t[e].slice(1);n=this.computeElementwiseOpOutputShape(n,r)}const r=t.map(t=>t.length);-1===t.indexOf(null)&&1===N(r).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,e){return Object(d.di)(()=>{if(t=t,this.reshapeRequired){const e=[],n=t.map(t=>t.rank);if(-1===n.indexOf(null)){const r=pt(n);for(let n of t){const t=n.rank;for(let e=0;e<r-t;++e)n=bt(n,1);e.push(n)}return this.mergeFunction(e)}{let n=!1;for(const r of t){const t=r.rank;if(null==t){const t=r.shape,i=t[0],a=t.slice(1).concat([i]);let o=r.reshape([i].concat(dt(t.slice(1))));o=d.ii(o,[1,0]),o=o.reshape(a),e.push(o),n=!0}else if(t>1){const i=mt(1,t).concat([0]);e.push(d.ii(r,i)),n=!0}else e.push(r)}let r=this.mergeFunction(e);const i=r.rank;if(n)if(null==i){const t=r.shape,e=t[t.length-1],n=[e].concat(t.slice(0,t.length-1));r=d.ii(r.reshape([-1,e]),[1,0]).reshape(n)}else if(i>1){const t=[i-1].concat(mt(0,i-1));r=d.ii(r,t)}return r}}return this.mergeFunction(t)})}computeOutputShape(t){let e;e=null==(t=t)[0]?null:t[0].slice(1);for(let n=1;n<t.length;++n){const r=null==t[n]?null:t[n].slice(1);e=this.computeElementwiseOpOutputShape(e,r)}let n=[];for(const e of t)null!=e&&null!==e[0]&&n.push(e[0]);return n=N(n),e=1===n.length?n.concat(e):[null].concat(e),e}computeMask(t,e){return d.di(()=>{if(null==e)return null;if(!Array.isArray(e))throw new g("`mask` should be an Array");if(!Array.isArray(t))throw new g("`inputs` should be an Array");if(e.length!==t.length)throw new g(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${e.length})`);if(e.every(t=>null==t))return null;let n=(e=e.map(t=>null==t?t:d.Re(t,0)))[0];for(let t=1;t<e.length-1;++t)n=d.Mf(n,e[t]);return n})}}class Ni extends ji{constructor(t){super(t)}mergeFunction(t){return Object(d.di)(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=d.wd(e,t[n]);return e})}}Ni.className="Add",d.lh.registerClass(Ni);class Ti extends ji{constructor(t){super(t)}mergeFunction(t){return Object(d.di)(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=d.jg(e,t[n]);return e})}}Ti.className="Multiply",d.lh.registerClass(Ti);class Fi extends ji{constructor(t){super(t)}mergeFunction(t){return Object(d.di)(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=d.wd(e,t[n]);return d.jg(1/t.length,e)})}}Fi.className="Average",d.lh.registerClass(Fi);class Di extends ji{constructor(t){super(t)}mergeFunction(t){return Object(d.di)(()=>{let e=t[0];for(let n=1;n<t.length;++n)e=d.Xf(e,t[n]);return e})}}Di.className="Maximum",d.lh.registerClass(Di);class Ii extends ji{constructor(t){super(t)}mergeFunction(t){return Object(d.di)(()=>{let e=t[0];for(let n=1;n<t.length;++n)e=d.cg(e,t[n]);return e})}}Ii.className="Minimum",d.lh.registerClass(Ii);class Mi extends ji{constructor(t){super(t),this.DEFAULT_AXIS=-1,null==t&&(t={}),this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new g("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let e=!0;for(const n of t)if(null!=n){e=!1;break}if(e)return;const n=[];for(let e=0;e<t.length;++e){const r=t[e].slice();r.splice(this.axis,1);let i=!1;for(const t of n)if(d.qi.arraysEqual(t,r)){i=!0;break}i||n.push(r)}if(n.length>1)throw new g("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return Object(d.di)(()=>wt(t,this.axis))}computeOutputShape(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new g("A `Concatenate` layer should be called on a list of inputs.");const e=t,n=e[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const t of e.slice(1)){if(null==n[r]||null==t[r]){n[r]=null;break}n[r]+=t[r]}return n}computeMask(t,e){if(null==e)return null;if(!Array.isArray(e))throw new g("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new g("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new g(`Mismatch in the length of mask (${e.length}) and the legnth of inputs (${t.length})`);return d.di(()=>{let n=!0;if(e.forEach(t=>{null==t||(n=!1)}),n)return null;const r=[];for(let n=0;n<t.length;++n)null==e[n]?r.push(d.ug(t[n]).asType("bool")):e[n].rank<t[n].rank?r.push(d.Re(e[n],-1)):r.push(e[n]);const i=d.ce(r,this.axis);return d.zd(i,-1,!1)})}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function $i(t,e){for(;t<0;)t+=e;return t}Mi.className="Concatenate",d.lh.registerClass(Mi);class Ri extends ji{constructor(t){super(t),this.axes=t.axes,this.normalize=null!=t.normalize&&t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){d.qi.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0],n=t[1];if(e.length>3||n.length>3)throw new b("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,n);if(e[r[0]]!==n[r[1]])throw new g(`Dimension incompatibility: ${e[r[0]]} !== ${n[r[1]]}`)}mergeFunction(t){if(2!==t.length)throw new g(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let e,n=t[0],r=t[1];return e=Array.isArray(this.axes)?this.axes.map((e,n)=>$i(e,t[n].shape.length)):[$i(this.axes,n.shape.length),$i(this.axes,r.shape.length)],this.normalize&&(n=He(n,e[0]),r=He(r,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new b("batchDot is not implemented for tensors of 4D or higher rank yet");if(d.qi.assert(t.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, but got "+t.shape.length),d.qi.assert(t.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, but got "+e.shape.length),"number"==typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new b("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,i=e.shape.length;null==n&&(n=[r-1,i-2]);const a=n;return d.di(()=>{let n,o;if(r>i){n=r-i;const t=[];for(let e=0;e<n;++e)t.push(1);e=e.reshape(e.shape.concat(t))}else if(i>r){n=i-r;const e=[];for(let t=0;t<n;++t)e.push(1);t=t.reshape(t.shape.concat(e))}else n=0;if(2===t.shape.length&&2===e.shape.length)o=a[0]===a[1]?t.mul(e).sum(a[0]):t.transpose([1,0]).mul(e).sum(a[1]);else{const n=a[0]!==t.shape.length-1,r=a[1]===e.shape.length-1;o=t.matMul(e,n,r)}if(n>0){let t;t=r>i?r+i-3:r-1;const e=[];for(let r=t;r<t+n;++r)e.push(r);o=o.squeeze(e)}return 1===o.shape.length&&(o=o.expandDims(1)),o})}(n,r,e)}interpretAxes(t,e){let n;return n=Array.isArray(this.axes)?this.axes:[$i(this.axes,t.length),$i(this.axes,e.length)],n}computeOutputShape(t){d.qi.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new b("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,n);e.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);const i=e.concat(n);return 1===i.length&&i.push(1),i}computeMask(t,e){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},e=super.getConfig();return Object.assign(t,e),t}}Ri.className="Dot",d.lh.registerClass(Ri);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class Bi extends Fe{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={stddev:this.stddev};return Object.assign(e,t),e}call(t,e){return Object(d.di)(()=>{this.invokeCallHook(t,e);const n=we(t);return Tt(()=>_t(n.shape,0,this.stddev).add(n),()=>n,e.training||!1)})}}Bi.className="GaussianNoise",d.lh.registerClass(Bi);class zi extends Fe{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return Object(d.di)(()=>{this.invokeCallHook(t,e);const n=we(t);if(this.rate>0&&this.rate<1){return Tt(()=>{const t=Math.sqrt(this.rate/(1-this.rate));return n.mul(_t(n.shape,1,t))},()=>n,e.training||!1)}return n})}}zi.className="GaussianDropout",d.lh.registerClass(zi);class Li extends Fe{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||we(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return Object(d.di)(()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(t);return Tt(()=>{const e=we(t),r=-1.7580993408473766;let i=Object(d.lf)(Object(d.Mg)(n),this.rate);i=gt(i,"float32");const a=((1-this.rate)*(1+this.rate*r**2))**-.5,o=-a*r*this.rate;return e.mul(i).add(i.add(-1).mul(r)).mul(a).add(o)},()=>we(t),e.training||!1)}return t})}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Pi(t,e,n,r,i,a=.001){let o;if(2===t.rank)o=d.Od(t,e,n,r,i,a);else if(3===t.rank)o=d.Pd(t,e,n,r,i,a);else{if(4!==t.rank)throw new b(`batchNormalization is not implemented for array of rank ${t.rank} yet`);o=d.Qd(t,e,n,r,i,a)}return o}function qi(t,e,n,r,i=.001){return d.qi.arraysEqual(r.slice().sort(),mt(0,t.rank-1))?function(t,e,n,r,i=.001){return Object(d.di)(()=>{const a=d.hg(t,r),o=a.mean,s=a.variance;return[Pi(t,o,s,n,e,i),o,s]})}(t,e,n,r,i):function(t,e,n,r,i=.001){return Object(d.di)(()=>{const a=d.hg(t,r),o=a.mean,s=a.variance,u=[];for(const e of mt(0,t.rank))-1!==r.indexOf(e)?u.push(1):u.push(t.shape[e]);const c=o.reshape(u),l=s.reshape(u),f=null==e?null:e.reshape(u),h=null==n?null:n.reshape(u);return[Pi(t,c,l,h,f,i),o,s]})}(t,e,n,r,i)}Li.className="AlphaDropout",d.lh.registerClass(Li);class Wi extends Fe{constructor(t){null==t&&(t={}),super(t),this.supportsMasking=!0,this.axis=null==t.axis?-1:t.axis,this.momentum=null==t.momentum?.99:t.momentum,this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=Qt(t.betaInitializer||"zeros"),this.gammaInitializer=Qt(t.gammaInitializer||"ones"),this.movingMeanInitializer=Qt(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Qt(t.movingVarianceInitializer||"ones"),this.betaConstraint=V(t.betaConstraint),this.gammaConstraint=V(t.gammaConstraint),this.betaRegularizer=Tr(t.betaRegularizer),this.gammaRegularizer=Tr(t.gammaRegularizer)}build(t){t=ke(t);const e=this.axis>=0?this.axis:this.axis+t.length,n=t[e];if(null==n)throw new g(`Axis ${e} of input tensor should have a defined dimension but the layer received an input with shape `+JSON.stringify(t)+".");this.inputSpec=[new Ee({ndim:t.length,axes:{[e]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,e){return Object(d.di)(()=>{const n=null!=e.training&&e.training,r=we(t),i=r.shape,a=i.length,o=mt(0,a),s=this.axis>=0?this.axis:this.axis+a;o.splice(s,1);const u=v(1,a);u[s]=i[s];const c=o.slice();c.sort();const l=!d.qi.arraysEqual(c,mt(0,a).slice(0,a-1));if(!n)return(()=>{if(l){const t=this.movingMean.read().reshape(u),e=this.movingVariance.read().reshape(u),n=this.center?this.beta.read().reshape(u):null,i=this.scale?this.gamma.read().reshape(u):null;return Pi(r,t,e,n,i,this.epsilon)}return Pi(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[f,h,p]=qi(r,this.gamma.read(),this.beta.read(),o,this.epsilon),m=(t,e,n)=>{d.di(()=>{const r=1-n,i=t.read(),a=i.sub(e).mul(r);t.write(i.sub(a))})};return(()=>{m(this.movingMean,h,this.momentum),m(this.movingVariance,p,this.momentum)})(),f})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Zt(this.betaInitializer),gammaInitializer:Zt(this.gammaInitializer),movingMeanInitializer:Zt(this.movingMeanInitializer),movingVarianceInitializer:Zt(this.movingVarianceInitializer),betaRegularizer:jr(this.betaRegularizer),gammaRegularizer:jr(this.gammaRegularizer),betaConstraint:W(this.betaConstraint),gammaConstraint:W(this.gammaConstraint)},e=super.getConfig();return Object.assign(t,e),t}}Wi.className="BatchNormalization",d.lh.registerClass(Wi);class Ui extends Fe{constructor(t){if(null==t&&(t={}),super(t),this.axis=null==t.axis?-1:t.axis,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received "+this.axis)}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(this.axis));for(const t of this.axis)if(!Number.isInteger(t))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(this.axis))}this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=Qt(t.betaInitializer||"zeros"),this.gammaInitializer=Qt(t.gammaInitializer||"ones"),this.betaRegularizer=Tr(t.betaRegularizer),this.gammaRegularizer=Tr(t.gammaRegularizer),this.supportsMasking=!0}build(t){const e=(t=ke(t)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let t=0;t<this.axis.length;++t)this.axis[t]<0&&(this.axis[t]+=e);for(const t of this.axis)if(t<0||t>=e)throw new Error("Invalid axis: "+t);if(this.axis.length!==N(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);const n=this.axis.map(e=>t[e]);this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0}call(t,e){const n=we(t),r=n.shape,i=r.length;return Object(d.di)(()=>{let{mean:t,variance:e}=Object(d.hg)(n,this.axis,!0);const a=v(1,i);for(const t of this.axis)a[t]=r[t];const o=t=>null!=t&&t.shape.length!==i&&this.axis!==[i-1]?t.reshape(a):t;let s=o(this.gamma.read()),u=o(this.beta.read());const c=[],l=[];for(let t=0;t<i;++t)-1!==this.axis.indexOf(t)?(c.push(r[t]),l.push(1)):(c.push(1),l.push(r[t]));return t=t.tile(c),e=e.tile(c),s=s.tile(l),u=u.tile(l),Pi(n,t,e,u,s,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Zt(this.betaInitializer),gammaInitializer:Zt(this.gammaInitializer),betaRegularizer:jr(this.betaRegularizer),gammaRegularizer:jr(this.gammaRegularizer)},e=super.getConfig();return Object.assign(t,e),t}}Ui.className="LayerNormalization",d.lh.registerClass(Ui);class Vi extends Fe{constructor(t){if(null==t&&(t={}),super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,null==t.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof t.padding)this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new g(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let e,n;if("number"==typeof t.padding[0])e=[t.padding[0],t.padding[0]],n=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new g(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(e=t.padding[0],2!==t.padding[1].length)throw new g(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);n=t.padding[1]}this.padding=[e,n]}this.inputSpec=[new Ee({ndim:4})]}computeOutputShape(t){let e,n;return t=ke(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,n]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,n,t[3]])}call(t,e){return Object(d.di)(()=>{return e=we(t),n=this.padding,r=this.dataFormat,Object(d.di)(()=>{if(4!==e.rank)throw new g("temporalPadding expects input tensor to be 4-D, but received a "+e.rank+"-D tensor.");if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new g("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==r&&(r="channelsLast"),"channelsLast"!==r&&"channelsFirst"!==r)throw new g(`Unknown data format: ${r}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let t;return t="channelsFirst"===r?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],d.xg(e,t)});var e,n,r})}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Gi(t,e,n,r,i,a){return Object(d.di)(()=>{let o;nt(i),it(a),rt(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==a&&(a="max"),t=Pr(t,i);const s="same"===r?"same":"valid";return o="max"===a?d.Uf(t,e,n,s):d.Id(t,e,n,s),"channelsFirst"===i&&(o=d.ii(o,[0,3,1,2])),o})}function Hi(t,e,n,r,i,a){return Object(d.di)(()=>{let o;nt(i),it(a),rt(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==a&&(a="max"),t=qr(t,i);const s="same"===r?"same":"valid";return o="max"===a?d.Vf(t,e,n,s):d.Jd(t,e,n,s),"channelsFirst"===i&&(o=d.ii(o,[0,4,1,2,3])),o})}Vi.className="ZeroPadding2D",d.lh.registerClass(Vi);class Xi extends Fe{constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"==typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!=typeof t.poolSize[0])throw new g("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.poolSize));this.poolSize=t.poolSize}if(I(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"==typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!=typeof t.strides[0])throw new g("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.strides));this.strides=t.strides}I(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,rt(this.padding),this.inputSpec=[new Ee({ndim:3})]}computeOutputShape(t){const e=zr((t=ke(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return Object(d.di)(()=>{this.invokeCallHook(t,e),t=bt(we(t),2);const n=this.poolingFunction(we(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return d.Kh(n,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}class Ki extends Xi{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return nt(i),rt(r),Gi(t,e,n,r,i,"max")}}Ki.className="MaxPooling1D",d.lh.registerClass(Ki);class Yi extends Xi{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return nt(i),rt(r),Gi(t,e,n,r,i,"avg")}}Yi.className="AveragePooling1D",d.lh.registerClass(Yi);class Ji extends Fe{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new g("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+t.strides.length+".");this.strides=t.strides}else this.strides=[t.strides,t.strides];I(this.poolSize,"poolSize"),I(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,nt(this.dataFormat),rt(this.padding),this.inputSpec=[new Ee({ndim:4})]}computeOutputShape(t){t=ke(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=zr(e,this.poolSize[0],this.padding,this.strides[0]),n=zr(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]}call(t,e){return Object(d.di)(()=>(this.invokeCallHook(t,e),this.poolingFunction(we(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class Zi extends Ji{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return nt(i),rt(r),Gi(t,e,n,r,i,"max")}}Zi.className="MaxPooling2D",d.lh.registerClass(Zi);class Qi extends Ji{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return nt(i),rt(r),Gi(t,e,n,r,i,"avg")}}Qi.className="AveragePooling2D",d.lh.registerClass(Qi);class ta extends Fe{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new g("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+t.strides.length+".");this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];I(this.poolSize,"poolSize"),I(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,nt(this.dataFormat),rt(this.padding),this.inputSpec=[new Ee({ndim:5})]}computeOutputShape(t){t=ke(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[4]:t[3];return e=zr(e,this.poolSize[0],this.padding,this.strides[0]),n=zr(n,this.poolSize[1],this.padding,this.strides[1]),r=zr(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,r]:[t[0],e,n,r,t[4]]}call(t,e){return Object(d.di)(()=>(this.invokeCallHook(t,e),this.poolingFunction(we(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class ea extends ta{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return nt(i),rt(r),Hi(t,e,n,r,i,"max")}}ea.className="MaxPooling3D",d.lh.registerClass(ea);class na extends ta{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return nt(i),rt(r),Hi(t,e,n,r,i,"avg")}}na.className="AveragePooling3D",d.lh.registerClass(na);class ra extends Fe{constructor(t){super(t),this.inputSpec=[new Ee({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new b}}class ia extends ra{constructor(t){super(t||{})}call(t,e){return Object(d.di)(()=>{const e=we(t);return d.Zf(e,1)})}}ia.className="GlobalAveragePooling1D",d.lh.registerClass(ia);class aa extends ra{constructor(t){super(t||{})}call(t,e){return Object(d.di)(()=>{const e=we(t);return d.Tf(e,1)})}}aa.className="GlobalMaxPooling1D",d.lh.registerClass(aa);class oa extends Fe{constructor(t){super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,nt(this.dataFormat),this.inputSpec=[new Ee({ndim:4})]}computeOutputShape(t){return t=t,"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new b}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class sa extends oa{call(t,e){return Object(d.di)(()=>{const e=we(t);return"channelsLast"===this.dataFormat?d.Zf(e,[1,2]):d.Zf(e,[2,3])})}}sa.className="GlobalAveragePooling2D",d.lh.registerClass(sa);class ua extends oa{call(t,e){return Object(d.di)(()=>{const e=we(t);return"channelsLast"===this.dataFormat?d.Tf(e,[1,2]):d.Tf(e,[2,3])})}}ua.className="GlobalMaxPooling2D",d.lh.registerClass(ua);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class ca extends Fe{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e,n={}){const r=Ge(e.layer,n);delete e.layer;const i={layer:r};return Object.assign(i,e),new t(i)}}class la extends ca{constructor(t){super(t),this.supportsMasking=!0}build(t){if((t=ke(t)).length<3)throw new g("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(t));this.inputSpec=[{shape:t}];const e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),super.build(t)}computeOutputShape(t){const e=[(t=ke(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e),r=t[1];return[n[0],r].concat(n.slice(1))}call(t,e){return Object(d.di)(()=>ii((t,n)=>[we(this.layer.call(t,e)),[]],t=we(t),[],!1,null,null,!1,!0)[1])}}la.className="TimeDistributed",d.lh.registerClass(la);class da extends ca{constructor(t){super(t);const e=t.layer.getConfig(),n={};n.className=t.layer.getClassName(),n.config=e,this.forwardLayer=Ge(n),e.goBackwards=!0!==e.goBackwards;const r={};var i;if(r.className=t.layer.getClassName(),r.config=e,this.backwardLayer=Ge(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===t.mergeMode?"concat":t.mergeMode,i=this.mergeMode,F(tt,"BidirectionalMergeMode",i),t.weights)throw new b("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const e=t.length,n=Math.floor(e/2);this.forwardLayer.setWeights(t.slice(0,n)),this.backwardLayer.setWeights(t.slice(n))}computeOutputShape(t){let e,n,r,i=this.forwardLayer.computeOutputShape(t);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),i=i,this.returnState?(r=i.slice(1),e=i[0]):e=i[0],e=e,"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):k(n)}apply(t,e){let n=null==e?null:e.initialState,r=null==e?null:e.constants;null==e&&(e={});const i=ri(t,n,r,this.numConstants);if(t=i.inputs,n=i.initialState,r=i.constants,Array.isArray(t)&&(n=t.slice(1),t=t[0]),(null==n||0===n.length)&&null==r)return super.apply(t,e);const a=[],o=[];if(null!=n){const t=n.length;if(t%2>0)throw new g("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e.initialState=n,a.push(...n);const r=n.map(t=>new Ee({shape:t.shape}));this.forwardLayer.stateSpec=r.slice(0,t/2),this.backwardLayer.stateSpec=r.slice(t/2),o.push(...r)}if(null!=r)throw new b("Support for constants in Bidirectional layers is not implemented yet.");const s=a[0]instanceof Se;for(const t of a)if(t instanceof Se!==s)throw new g("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(s){const n=[t].concat(a),r=this.inputSpec.concat(o),i=this.inputSpec;this.inputSpec=r;const s=super.apply(n,e);return this.inputSpec=i,s}return super.apply(t,e)}call(t,e){return Object(d.di)(()=>{const n=e.initialState;let r,i,a,o;if(null==n)r=this.forwardLayer.call(t,e),i=this.backwardLayer.call(t,e);else{const a=n.slice(0,n.length/2),o=n.slice(n.length/2);r=this.forwardLayer.call(t,Object.assign(e,{initialState:a})),i=this.backwardLayer.call(t,Object.assign(e,{initialState:o}))}return this.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=d.Yg(i,1)),"concat"===this.mergeMode?o=wt([r,i]):"sum"===this.mergeMode?o=d.wd(r,i):"ave"===this.mergeMode?o=d.jg(.5,d.wd(r,i)):"mul"===this.mergeMode?o=d.jg(r,i):null==this.mergeMode&&(o=[r,i]),this.returnState?null==this.mergeMode?o.concat(a):[o].concat(a):o})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){ot(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),ot(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,e){let n;if(Array.isArray(e)&&(e=e[0]),n=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){const t=this.forwardLayer.states.map(t=>null);return Array.isArray(n)?n.concat(t).concat(t):[n].concat(t).concat(t)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(t),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},e=super.getConfig();return Object.assign(t,e),t}static fromConfig(t,e){const n=Ge(e.layer);if(delete e.layer,null!=e.numConstants)throw new b("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=e;return r.layer=n,new t(r)}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function fa(t){return new De(t)}function ha(t){return new Mr(t)}function pa(t){return new Fr(t)}function ma(t){return new Dr(t)}function ga(t){return new Ir(t)}function ba(t){return new Rr(t)}function ya(t){return new $r(t)}function va(t){return new Qr(t)}function xa(t){return new Xr(t)}function wa(t){return new Yr(t)}function ka(t){return new Kr(t)}function Oa(t){return new Zr(t)}function _a(t){return new ti(t)}function Aa(t){return new ei(t)}function Ca(t){return new ni(t)}function Ea(t){return new Oi(t)}function Sa(t){return new wi(t)}function ja(t){return new vi(t)}function Na(t){return new xi(t)}function Ta(t){return new ki(t)}function Fa(t){return new _i(t)}function Da(t){return new Ai(t)}function Ia(t){return new Ci(t)}function Ma(t){return new Si(t)}function $a(t){return new Ni(t)}function Ra(t){return new Fi(t)}function Ba(t){return new Mi(t)}function za(t){return new Di(t)}function La(t){return new Ii(t)}function Pa(t){return new Ti(t)}function qa(t){return new Ri(t)}function Wa(t){return new Wi(t)}function Ua(t){return new Ui(t)}function Va(t){return new Vi(t)}function Ga(t){return new Yi(t)}function Ha(t){return Ga(t)}function Xa(t){return Ga(t)}function Ka(t){return new Qi(t)}function Ya(t){return Ka(t)}function Ja(t){return Ka(t)}function Za(t){return new na(t)}function Qa(t){return Za(t)}function to(t){return Za(t)}function eo(t){return new ia(t)}function no(t){return new sa(t)}function ro(t){return new aa(t)}function io(t){return new ua(t)}function ao(t){return new Ki(t)}function oo(t){return new Zi(t)}function so(t){return new ea(t)}function uo(t){return new li(t)}function co(t){return new ci(t)}function lo(t){return new fi(t)}function fo(t){return new di(t)}function ho(t){return new ui(t)}function po(t){return new si(t)}function mo(t){return new yi(t)}function go(t){return new bi(t)}function bo(t){return new ai(t)}function yo(t){return new hi(t)}function vo(t){return new da(t)}function xo(t){return new la(t)}da.className="Bidirectional",d.lh.registerClass(da);const wo=ro,ko=io,Oo=ao,_o=oo;function Ao(t){return new Bi(t)}function Co(t){return new zi(t)}function Eo(t){return new Li(t)}function So(t){return new Ei(t)}function jo(t,e){return on(t,e)}function No(t,e){return dn(t,e)}function To(t,e){return fn(t,e)}function Fo(t,e){return sn(t,e)}function Do(t,e){return hn(t,e)}function Io(t,e){return cn(t,e)}function Mo(t,e){return ln(t,e)}function $o(t,e){return nn(t,e)}function Ro(t,e){return Ke(t,e)}function Bo(t,e){return Ye(t,e)}function zo(t,e){return Ye(t,e)}function Lo(t,e){return Ye(t,e)}function Po(t,e){return Xe(t,e)}function qo(t,e){return Xe(t,e)}function Wo(t,e){return Xe(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Uo(t){return new Er(t)}function Vo(t){return Ar(e=t),new Er({l1:null!=e?e.l1:null,l2:0});var e}function Go(t){return Ar(e=t),new Er({l2:null!=e?e.l2:null,l1:0});var e}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ho extends Be{constructor(){super(...arguments),this.model=null}setModel(t){if(!(t instanceof Zn))throw new Error("model must be a LayersModel, not some other Container");this.model=t}}function Xo(t,e){return t<e}function Ko(t,e){return t>e}class Yo extends Ho{constructor(t){if(super(),null==t&&(t={}),t.restoreBestWeights)throw new b("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=t.monitor||"val_loss",this.minDelta=Math.abs(t.minDelta||0),this.patience=t.patience||0,this.verbose=t.verbose||0,this.mode=t.mode||"auto",this.baseline=t.baseline,-1===["auto","min","max"].indexOf(this.mode)&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),"min"===this.mode?this.monitorFunc=Xo:"max"===this.mode||-1!==this.monitor.indexOf("acc")?this.monitorFunc=Ko:this.monitorFunc=Xo,this.monitorFunc===Xo&&(this.minDelta*=-1)}async onTrainBegin(t){this.wait=0,this.stoppedEpoch=0,null!=this.baseline?this.best=this.baseline:this.best=this.monitorFunc===Xo?1/0:-1/0}async onEpochEnd(t,e){await Me(e);const n=this.getMonitorValue(e);null!=n&&(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0)))}async onTrainEnd(t){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(t){null==t&&(t={});const e=t[this.monitor];return null==e&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: `+Object.keys(t)),e}}const Jo={earlyStopping:function(t){return new Yo(t)}};
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Zo=n(56),Qo=n(2);
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ts{constructor(t,e,n){this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(t=>this.getInput(t)),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((t,e)=>(t[e]=this.getAttr(e),t),{}))}getInput(t){return Object(Qo.e)(t,this.tensorMap,this.context)}getAttr(t,e){const n=this.node.rawAttrs[t];if(null!=n.tensor)return Object(Qo.e)(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Object(Zo.f)(this.node.rawAttrs,t,e);if(null!=n.s)return Object(Zo.i)(this.node.rawAttrs,t,e);if(null!=n.b)return Object(Zo.c)(this.node.rawAttrs,t,e);if(null!=n.shape)return Object(Zo.k)(this.node.rawAttrs,t,e);if(null!=n.type)return Object(Zo.e)(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return Object(Zo.g)(this.node.rawAttrs,t,e);if(null!=n.list.s)return Object(Zo.h)(this.node.rawAttrs,t,e);if(null!=n.list.shape)return Object(Zo.j)(this.node.rawAttrs,t,e);if(null!=n.list.b)return Object(Zo.b)(this.node.rawAttrs,t,e);if(null!=n.list.type)return Object(Zo.d)(this.node.rawAttrs,t,e)}return e}}var es=n(108),ns=n(12),rs=n(249),is=n(135),as=n(9),os=n(14),ss=n(185),us=n(123),cs=n(13),ls=n(101),ds=n(77),fs=n(47),hs=n(104);var ps=n(42),ms=n(247),gs=n(248),bs=n(250),ys=n(251),vs=n(252),xs=n(179),ws=n(253),ks=n(256),Os=n(57),_s=n(126),As=n(182),Cs=n(128),Es=n(260),Ss=n(40),js=n(261),Ns=n(129),Ts=n(72),Fs=n(188),Ds=n(130),Is=n(28),Ms=n(272),$s=n(112),Rs=n(81),Bs=n(273),zs=n(196),Ls=n(85),Ps=n(198),qs=n(275),Ws=n(199),Us=n(189),Vs=n(37),Gs=n(24),Hs=n(154),Xs=n(278),Ks=n(257),Ys=n(137),Js=n(195),Zs=n(193),Qs=n(131),tu=n(136);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function eu(t,e,n=""){d.qi.assert(function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(-1!==t[n]&&-1!==e[n]&&t[n]!==e[n])return!1;return!0}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(t,e),()=>n+` Shapes ${t} and ${e} must match`)}class nu{constructor(t,e,n,r,i,a,o){this.name=t,this.dtype=e,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=a,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=Object(d.gh)(0),Object(d.xf)(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(e=>{null!=t&&t.has(e.tensor.id)||e.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const e=this.tensors[t];if(e.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}readMany(t){return t.map(t=>this.read(t))}write(t,e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},\n          because the value dtype is ${e.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),eu(this.elementShape,e.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);n.tensor=e,Object(d.xf)(e),n.written=!0,this.tensors[t]=n}writeMany(t,e){if(t.length!==e.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${e.length}.`);t.forEach((t,n)=>this.write(t,e[n]))}gather(t,e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${e}`);if(t)t=t.slice(0,this.size());else{t=[];for(let e=0;e<this.size();e++)t.push(e)}if(0===t.length)return Object(d.Uh)([],[0].concat(this.elementShape));const n=this.readMany(t);return eu(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),Object(d.Lh)(n,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(0===this.size())return Object(d.Uh)([],[0].concat(this.elementShape));const e=[];for(let t=0;t<this.size();t++)e.push(t);const n=this.readMany(e);return eu(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),Object(d.ce)(n,0)}scatter(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const n=Math.max(...t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(t,Object(d.oi)(e,0))}split(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);let n=0;const r=t.map(t=>(n+=t,n));if(n!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${n}, and tensor's shape is: ${e.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const i=0===n?0:e.size/n,a=[];Object(d.di)(()=>{e=Object(d.Xg)(e,[1,n,i]);for(let n=0;n<t.length;++n){const o=[0,0===n?0:r[n-1],0],s=[1,t[n],i];a[n]=Object(d.Xg)(Object(d.uh)(e,o,s),this.elementShape)}return a});const o=[];for(let e=0;e<t.length;e++)o[e]=e;this.writeMany(o,a)}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ru{constructor(t,e,n,r=-1){this.tensors=t,this.elementShape=e,this.elementDtype=n,null!=t&&t.forEach(t=>{if(n!==t.dtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${t.dtype}`);eu(e,t.shape,"TensorList shape mismatch: "),Object(d.xf)(t)}),this.idTensor=Object(d.gh)(0),this.maxNumElements=r,Object(d.xf)(this.idTensor)}get id(){return this.idTensor.id}copy(){return new ru([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(e=>{null!=t&&t.has(e.id)||e.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,e,n=-1){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(-1!==n&&this.tensors.length!==n)throw new Error(`Operation expected a list with ${n} elements but got a list with ${this.tensors.length} elements.`);return eu(t,this.elementShape,"TensorList shape mismatch: "),Object(d.di)(()=>{const e=this.tensors.map(e=>Object(d.Xg)(e,t));return Object(d.Lh)(e,0)})}popBack(t,e){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(0===this.size())throw new Error("Trying to pop from an empty list.");const n=this.tensors.pop();return eu(n.shape,t,"TensorList shape mismatch: "),Object(d.Xg)(n,t)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(eu(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Object(d.xf)(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error("TensorListResize expects size to be non-negative. Got: "+t);if(-1!==this.maxNumElements&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);this.tensors.length=t}getItem(t,e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(null==this.tensors[t])throw new Error(`element at index ${t} is null.`);return eu(this.tensors[t].shape,e,"TensorList shape mismatch: "),this.tensors[t]}setItem(t,e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(t<0||-1!==this.maxNumElements&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);eu(this.elementShape,e.shape,"TensorList shape mismatch: "),Object(d.xf)(e),this.tensors[t]=e}gather(t,e,n){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);return eu(this.elementShape,n,"TensorList shape mismatch: "),0===(t=t.slice(0,this.size())).length?Object(d.Uh)([],[0].concat(this.elementShape)):Object(d.di)(()=>{const e=t.map(t=>Object(d.Xg)(this.tensors[t],n));return Object(d.Lh)(e,0)})}concat(t,e){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);return eu(this.elementShape,e,"TensorList shape mismatch: "),0===this.size()?Object(d.Uh)([],[0].concat(this.elementShape)):Object(d.di)(()=>{const t=this.tensors.map(t=>Object(d.Xg)(t,e));return Object(d.ce)(t,0)})}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const iu=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=Object(Qo.d)("thenBranch",t,e,n),i=Object(Qo.d)("elseBranch",t,e,n),a=Object(Qo.d)("cond",t,e,n),o=Object(Qo.d)("args",t,e,n);return(await a.data())[0]?n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[i].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=Object(Qo.d)("body",t,e,n),i=Object(Qo.d)("cond",t,e,n),a=Object(Qo.d)("args",t,e,n),o=await n.functionMap[i].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap),s=a.map(t=>t.id);let u=await o[0].data();o.forEach(t=>{t.kept||-1!==s.indexOf(t.id)||t.dispose()});let c=a;for(;u[0];){const t=c;c=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const e=c.map(t=>t.id);t.forEach(t=>{t.kept||-1!==s.indexOf(t.id)||-1!==e.indexOf(t.id)||t.dispose()});const a=await n.functionMap[i].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);u=await a[0].data(),a.forEach(t=>{t.kept||-1!==s.indexOf(t.id)||-1!==e.indexOf(t.id)||t.dispose()})}return c}case"LoopCond":{const r=Object(Qo.d)("pred",t,e,n);return[Object(Qo.a)(r)]}case"Switch":{const r=Object(Qo.d)("pred",t,e,n);let i=Object(Qo.d)("data",t,e,n);return i.kept||(i=Object(Qo.a)(i)),(await r.data())[0]?[void 0,i]:[i,void 0]}case"Merge":{const r=t.inputNames.find(t=>void 0!==Object(Qo.e)(t,e,n));if(r){const t=Object(Qo.e)(r,e,n);return[Object(Qo.a)(t)]}return}case"Enter":{const r=Object(Qo.d)("frameName",t,e,n),i=Object(Qo.d)("tensor",t,e,n);return n.enterFrame(r),[Object(Qo.a)(i)]}case"Exit":{const r=Object(Qo.d)("tensor",t,e,n);return n.exitFrame(),[Object(Qo.a)(r)]}case"NextIteration":{const r=Object(Qo.d)("tensor",t,e,n);return n.nextIteration(),[Object(Qo.a)(r)]}case"TensorArrayV3":{const r=Object(Qo.d)("size",t,e,n),i=Object(Qo.d)("dtype",t,e,n),a=Object(Qo.d)("elementShape",t,e,n),o=Object(Qo.d)("dynamicSize",t,e,n),s=Object(Qo.d)("clearAfterRead",t,e,n),u=Object(Qo.d)("identicalElementShapes",t,e,n),c=Object(Qo.d)("name",t,e,n),l=new nu(c,i,r,a,u,o,s);return n.addTensorArray(l),[l.idTensor,Object(d.gh)(1)]}case"TensorArrayWriteV3":{const r=Object(Qo.d)("tensorArrayId",t,e,n),i=Object(Qo.d)("index",t,e,n),a=Object(Qo.d)("tensor",t,e,n),o=n.getTensorArray(r.id);return o.write(i,a),[o.idTensor]}case"TensorArrayReadV3":{const r=Object(Qo.d)("tensorArrayId",t,e,n),i=Object(Qo.d)("index",t,e,n);return[n.getTensorArray(r.id).read(i)]}case"TensorArrayGatherV3":{const r=Object(Qo.d)("tensorArrayId",t,e,n),i=Object(Qo.d)("indices",t,e,n),a=Object(Qo.d)("dtype",t,e,n);return[n.getTensorArray(r.id).gather(i,a)]}case"TensorArrayScatterV3":{const r=Object(Qo.d)("tensorArrayId",t,e,n),i=Object(Qo.d)("indices",t,e,n),a=Object(Qo.d)("tensor",t,e,n),o=n.getTensorArray(r.id);return o.scatter(i,a),[o.idTensor]}case"TensorArrayConcatV3":{const r=Object(Qo.d)("tensorArrayId",t,e,n),i=n.getTensorArray(r.id),a=Object(Qo.d)("dtype",t,e,n);return[i.concat(a)]}case"TensorArraySplitV3":{const r=Object(Qo.d)("tensorArrayId",t,e,n),i=Object(Qo.d)("tensor",t,e,n),a=Object(Qo.d)("lengths",t,e,n),o=n.getTensorArray(r.id);return o.split(a,i),[o.idTensor]}case"TensorArraySizeV3":{const r=Object(Qo.d)("tensorArrayId",t,e,n),i=n.getTensorArray(r.id);return[Object(d.gh)(i.size(),"int32")]}case"TensorArrayCloseV3":{const r=Object(Qo.d)("tensorArrayId",t,e,n),i=n.getTensorArray(r.id);return i.clearAndClose(),[i.idTensor]}case"TensorListSetItem":{const r=Object(Qo.d)("tensorListId",t,e,n),i=Object(Qo.d)("index",t,e,n),a=Object(Qo.d)("tensor",t,e,n),o=n.getTensorList(r.id);return o.setItem(i,a),[o.idTensor]}case"TensorListGetItem":{const r=Object(Qo.d)("tensorListId",t,e,n),i=Object(Qo.d)("index",t,e,n),a=Object(Qo.d)("elementShape",t,e,n),o=Object(Qo.d)("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(i,a,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=Object(Qo.d)("indices",t,e,n),i=function(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const i=Math.max(...e);if(null!=r&&-1!==r&&i>=r)throw new Error(`Max index must be < array size (${i}  vs. ${r})`);const a=new ru([],n,t.dtype,r),o=Object(d.oi)(t,0);return e.forEach((t,e)=>{a.setItem(t,o[e])}),a}(Object(Qo.d)("tensor",t,e,n),r,Object(Qo.d)("elementShape",t,e,n),Object(Qo.d)("numElements",t,e,n));return n.addTensorList(i),[i.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=Object(Qo.d)("elementShape",t,e,n),i=Object(Qo.d)("elementDType",t,e,n);let a;a="TensorListReserve"===t.op?"numElements":"maxNumElements";const o=function(t,e,n){return new ru([],t,e,n)}(r,i,Object(Qo.d)(a,t,e,n));return n.addTensorList(o),[o.idTensor]}case"TensorListGather":{const r=Object(Qo.d)("tensorListId",t,e,n),i=Object(Qo.d)("indices",t,e,n),a=Object(Qo.d)("elementShape",t,e,n),o=Object(Qo.d)("elementDType",t,e,n);return[n.getTensorList(r.id).gather(i,o,a)]}case"TensorListStack":{const r=Object(Qo.d)("tensorListId",t,e,n),i=Object(Qo.d)("elementShape",t,e,n),a=Object(Qo.d)("elementDType",t,e,n),o=Object(Qo.d)("numElements",t,e,n);return[n.getTensorList(r.id).stack(i,a,o)]}case"TensorListFromTensor":{const r=function(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: "+t.shape);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);eu(t.shape.slice(1),e,"TensorList shape mismatch: ");const i=Object(d.oi)(t);return new ru(i,e,r)}(Object(Qo.d)("tensor",t,e,n),Object(Qo.d)("elementShape",t,e,n),Object(Qo.d)("elementDType",t,e,n));return n.addTensorList(r),[r.idTensor]}case"TensorListConcat":{const r=Object(Qo.d)("tensorListId",t,e,n),i=n.getTensorList(r.id),a=Object(Qo.d)("dtype",t,e,n),o=Object(Qo.d)("elementShape",t,e,n);return[i.concat(a,o)]}case"TensorListPushBack":{const r=Object(Qo.d)("tensorListId",t,e,n),i=Object(Qo.d)("tensor",t,e,n),a=n.getTensorList(r.id);return a.pushBack(i),[a.idTensor]}case"TensorListPopBack":{const r=Object(Qo.d)("tensorListId",t,e,n),i=Object(Qo.d)("elementShape",t,e,n),a=Object(Qo.d)("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(i,a)]}case"TensorListSplit":{const r=Object(Qo.d)("tensor",t,e,n),i=Object(Qo.d)("elementShape",t,e,n),a=function(t,e,n){let r=0;const i=e.map(t=>(r+=t,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${r}, and tensor's shape is: ${t.shape}`);const a=0===r?0:t.size/r,o=Object(d.di)(()=>{const o=[];t=Object(d.Xg)(t,[1,r,a]);for(let r=0;r<e.length;++r){const s=[0,0===r?0:i[r-1],0],u=[1,e[r],a];o[r]=Object(d.Xg)(Object(d.uh)(t,s,u),n)}return t.dispose(),o}),s=new ru([],n,t.dtype,e.length);for(let t=0;t<o.length;t++)s.setItem(t,o[t]);return s}(r,Object(Qo.d)("lengths",t,e,n),i);return n.addTensorList(a),[a.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};var au=n(180),ou=n(63),su=n(17),uu=n(181),cu=n(78),lu=n(258),du=n(125),fu=n(134),hu=n(269),pu=n(254),mu=n(268),gu=n(184);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function bu(t,e,n){const[r,i]=Object(Qo.d)("fusedOps",t,e,n),a="biasadd"===r,o="prelu"===i,s="fusedbatchnorm"===r,u=Object(Qo.d)("numArgs",t,e,n);if(a){if(o&&2!==u)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&1!==u)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(s)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");const c=Object(Qo.d)("strides",t,e,n),l=Object(Qo.c)(t,e,n),d=Object(Qo.d)("dataFormat",t,e,n).toUpperCase(),f=Object(Qo.d)("dilations",t,e,n),[h,p]=Object(Qo.d)("args",t,e,n);return{stride:c,pad:l,dataFormat:d,dilations:f,biasArg:h,preluArg:p,activationFunc:i,leakyreluAlpha:Object(Qo.d)("leakyreluAlpha",t,e,n)}}var yu=n(124),vu=n(265),xu=n(270),wu=n(111),ku=n(80),Ou=n(271),_u=n(194),Au=n(155),Cu=n(279),Eu=n(64),Su=n(21);var ju=n(11),Nu=n(204),Tu=n(274);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Fu(t,e,n){return{boxes:Object(Qo.d)("boxes",t,e,n),scores:Object(Qo.d)("scores",t,e,n),maxOutputSize:Object(Qo.d)("maxOutputSize",t,e,n),iouThreshold:Object(Qo.d)("iouThreshold",t,e,n),scoreThreshold:Object(Qo.d)("scoreThreshold",t,e,n),softNmsSigma:Object(Qo.d)("softNmsSigma",t,e,n)}}var Du=n(202),Iu=n(203);var Mu=n(74),$u=n(15);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Ru{constructor(t,e){this.keyDType=t,this.valueDType=e,this.handle=Object(d.gh)(0),this.tensorMap=new Map,Object(d.xf)(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}async import(t,e){this.checkKeyAndValueTensor(t,e);const n=await t.data();return this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),Object(d.di)(()=>{const t=Object(d.oi)(e),r=n.length,i=t.length;d.qi.assert(r===i,()=>`The number of elements doesn't match, keys has ${r} elements, the values has ${i} elements.`);for(let e=0;e<r;e++){const r=n[e],i=t[e];Object(d.xf)(i),this.tensorMap.set(r,i)}return this.handle})}async find(t,e){this.checkKeyAndValueTensor(t,e);const n=await t.data();return Object(d.di)(()=>{const t=[];for(let r=0;r<n.length;r++){const i=n[r],a=this.findWithDefault(i,e);t.push(a)}return Object(d.Lh)(t)})}findWithDefault(t,e){const n=this.tensorMap.get(t);return null!=n?n:e}checkKeyAndValueTensor(t,e){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got `+t.dtype);if(e.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got `+e.dtype)}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Bu=n(79),zu=n(102),Lu=n(45),Pu=n(53),qu=n(99),Wu=n(54),Uu=n(58),Vu=n(100),Gu=n(133),Hu=n(36);var Xu=n(26),Ku=n(50);var Yu=n(84),Ju=n(187),Zu=n(276),Qu=n(267),tc=n(294);var ec=n(66),nc=n(89),rc=n(110),ic=n(18),ac=n(175),oc=n(176),sc=n(177),uc=n(178),cc=n(127),lc=n(255),dc=n(259);var fc=n(31),hc=n(98),pc=n(48),mc=n(25),gc=n(277),bc=n(105),yc=n(8),vc=n(59),xc=n(83),wc=n(86),kc=n(73),Oc=n(282),_c=n(283);var Ac=n(138),Cc=n(113),Ec=n(139),Sc=n(200);var jc=n(60),Nc=n(191),Tc=n(55),Fc=n(103),Dc=n(97),Ic=n(183),Mc=n(109);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function $c(t,e,n,r){const i=((t,e,n)=>{switch(t.category){case"arithmetic":return d.di(()=>((t,e,n)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[ns.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"AddN":return[rs.a(Object(Qo.d)("tensors",t,e,n))];case"FloorMod":case"Mod":return[is.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"Mul":return[as.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"RealDiv":case"Div":return[os.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"DivNoNan":return[ss.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"FloorDiv":return[us.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"Sub":return[cs.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"Minimum":return[ls.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"Maximum":return[ds.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"Pow":return[fs.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"SquaredDifference":return[hs.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"basic_math":return d.di(()=>((t,e,n)=>{switch(t.op){case"Abs":case"ComplexAbs":return[ps.a(Object(Qo.d)("x",t,e,n))];case"Acos":return[ms.a(Object(Qo.d)("x",t,e,n))];case"Acosh":return[gs.a(Object(Qo.d)("x",t,e,n))];case"Asin":return[bs.a(Object(Qo.d)("x",t,e,n))];case"Asinh":return[ys.a(Object(Qo.d)("x",t,e,n))];case"Atan":return[vs.a(Object(Qo.d)("x",t,e,n))];case"Atan2":return[xs.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("y",t,e,n))];case"Atanh":return[ws.a(Object(Qo.d)("x",t,e,n))];case"Ceil":return[ks.a(Object(Qo.d)("x",t,e,n))];case"Complex":return[Os.a(Object(Qo.d)("real",t,e,n),Object(Qo.d)("imag",t,e,n))];case"Cos":return[_s.a(Object(Qo.d)("x",t,e,n))];case"Cosh":return[As.a(Object(Qo.d)("x",t,e,n))];case"Elu":return[Cs.a(Object(Qo.d)("x",t,e,n))];case"Erf":return[Es.a(Object(Qo.d)("x",t,e,n))];case"Exp":return[Ss.a(Object(Qo.d)("x",t,e,n))];case"Expm1":return[js.a(Object(Qo.d)("x",t,e,n))];case"Floor":return[Ns.a(Object(Qo.d)("x",t,e,n))];case"Log":return[Ts.a(Object(Qo.d)("x",t,e,n))];case"Log1p":return[Fs.a(Object(Qo.d)("x",t,e,n))];case"Imag":return[Ds.a(Object(Qo.d)("x",t,e,n))];case"Neg":return[Is.a(Object(Qo.d)("x",t,e,n))];case"Reciprocal":return[Ms.a(Object(Qo.d)("x",t,e,n))];case"Real":return[$s.a(Object(Qo.d)("x",t,e,n))];case"Relu":return[Rs.a(Object(Qo.d)("x",t,e,n))];case"Round":return[Bs.a(Object(Qo.d)("x",t,e,n))];case"Selu":return[zs.a(Object(Qo.d)("x",t,e,n))];case"Sigmoid":return[Ls.a(Object(Qo.d)("x",t,e,n))];case"Sin":return[Ps.a(Object(Qo.d)("x",t,e,n))];case"Sign":return[qs.a(Object(Qo.d)("x",t,e,n))];case"Sinh":return[Ws.a(Object(Qo.d)("x",t,e,n))];case"Softplus":return[Us.a(Object(Qo.d)("x",t,e,n))];case"Sqrt":return[Vs.a(Object(Qo.d)("x",t,e,n))];case"Square":return[Gs.a(Object(Qo.d)("x",t,e,n))];case"Tanh":return[Hs.a(Object(Qo.d)("x",t,e,n))];case"Tan":return[Xs.a(Object(Qo.d)("x",t,e,n))];case"ClipByValue":return[Ks.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("clipValueMin",t,e,n),Object(Qo.d)("clipValueMax",t,e,n))];case"Relu6":return[Ys.a(Object(Qo.d)("x",t,e,n))];case"Rsqrt":return[Js.a(Object(Qo.e)(t.inputNames[0],e,n))];case"Prod":return[Zs.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("axes",t,e,n))];case"LeakyRelu":return[Qs.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("alpha",t,e,n))];case"Prelu":return[tu.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("alpha",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"control":return iu(t,e,n);case"convolution":return d.di(()=>((t,e,n)=>{switch(t.op){case"Conv1D":{const r=Object(Qo.d)("stride",t,e,n),i=Object(Qo.d)("pad",t,e,n),a=Object(Qo.d)("dataFormat",t,e,n).toUpperCase(),o=Object(Qo.d)("dilation",t,e,n);return[au.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("filter",t,e,n),r,i,a,o)]}case"Conv2D":{const r=Object(Qo.d)("strides",t,e,n),i=Object(Qo.c)(t,e,n),a=Object(Qo.d)("dataFormat",t,e,n).toUpperCase(),o=Object(Qo.d)("dilations",t,e,n);return[ou.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("filter",t,e,n),[r[1],r[2]],i,a,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:r,pad:i,dataFormat:a,dilations:o,biasArg:s,preluArg:u,activationFunc:c,leakyreluAlpha:l}=bu(t,e,n);return[su.sb.conv2d({x:Object(Qo.d)("x",t,e,n),filter:Object(Qo.d)("filter",t,e,n),strides:[r[1],r[2]],pad:i,dataFormat:a,dilations:[o[1],o[2]],bias:s,activation:c,preluActivationWeights:u,leakyreluAlpha:l})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:i,dataFormat:a,dilations:o,biasArg:s,preluArg:u,activationFunc:c,leakyreluAlpha:l}=bu(t,e,n);return[su.sb.depthwiseConv2d({x:Object(Qo.d)("x",t,e,n),filter:Object(Qo.d)("filter",t,e,n),strides:[r[1],r[2]],pad:i,dataFormat:a,dilations:[o[1],o[2]],bias:s,activation:c,preluActivationWeights:u,leakyreluAlpha:l})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=Object(Qo.d)("outputShape",t,e,n),i=Object(Qo.d)("strides",t,e,n),a=Object(Qo.c)(t,e,n);return[uu.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("filter",t,e,n),r,[i[1],i[2]],a)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=Object(Qo.d)("strides",t,e,n),i=Object(Qo.c)(t,e,n),a=Object(Qo.d)("dilations",t,e,n),o=Object(Qo.d)("dataFormat",t,e,n).toUpperCase();return[cu.a(Object(Qo.d)("input",t,e,n),Object(Qo.d)("filter",t,e,n),[r[1],r[2]],i,o,[a[1],a[2]])]}case"Conv3D":{const r=Object(Qo.d)("strides",t,e,n),i=Object(Qo.d)("pad",t,e,n),a=Object(Qo.d)("dataFormat",t,e,n).toUpperCase(),o=Object(Qo.d)("dilations",t,e,n);return[lu.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("filter",t,e,n),[r[1],r[2],r[3]],i,a,[o[1],o[2],o[3]])]}case"AvgPool":{const r=Object(Qo.d)("strides",t,e,n),i=Object(Qo.d)("pad",t,e,n),a=Object(Qo.d)("kernelSize",t,e,n);return[du.a(Object(Qo.d)("x",t,e,n),[a[1],a[2]],[r[1],r[2]],i)]}case"MaxPool":{const r=Object(Qo.d)("strides",t,e,n),i=Object(Qo.d)("pad",t,e,n),a=Object(Qo.d)("kernelSize",t,e,n);return[fu.a(Object(Qo.d)("x",t,e,n),[a[1],a[2]],[r[1],r[2]],i)]}case"MaxPoolWithArgmax":{const r=Object(Qo.d)("strides",t,e,n),i=Object(Qo.d)("pad",t,e,n),a=Object(Qo.d)("kernelSize",t,e,n),o=Object(Qo.d)("includeBatchInIndex",t,e,n),{result:s,indexes:u}=hu.a(Object(Qo.d)("x",t,e,n),[a[1],a[2]],[r[1],r[2]],i,o);return[s,u]}case"AvgPool3D":{const r=Object(Qo.d)("strides",t,e,n),i=Object(Qo.d)("pad",t,e,n),a=Object(Qo.d)("kernelSize",t,e,n);return[pu.a(Object(Qo.d)("x",t,e,n),[a[1],a[2],a[3]],[r[1],r[2],r[3]],i)]}case"MaxPool3D":{const r=Object(Qo.d)("strides",t,e,n),i=Object(Qo.d)("pad",t,e,n),a=Object(Qo.d)("kernelSize",t,e,n);return[mu.a(Object(Qo.d)("x",t,e,n),[a[1],a[2],a[3]],[r[1],r[2],r[3]],i)]}case"Dilation2D":{const r=Object(Qo.d)("strides",t,e,n),i=Object(Qo.d)("pad",t,e,n),a=Object(Qo.d)("dilations",t,e,n),o=r[1],s=r[2],u=a[1],c=a[2];return[gu.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("filter",t,e,n),[o,s],i,[u,c],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"creation":return d.di(()=>((t,e,n)=>{switch(t.op){case"Fill":{const r=Object(Qo.d)("shape",t,e,n),i=Object(Qo.d)("dtype",t,e,n),a=Object(Qo.d)("value",t,e,n);return[yu.a(r,a,i)]}case"LinSpace":{const r=Object(Qo.d)("start",t,e,n),i=Object(Qo.d)("stop",t,e,n),a=Object(Qo.d)("num",t,e,n);return[vu.a(r,i,a)]}case"Multinomial":{const r=Object(Qo.d)("logits",t,e,n),i=Object(Qo.d)("numSamples",t,e,n),a=Object(Qo.d)("seed",t,e,n);return[xu.a(r,i,a)]}case"OneHot":{const r=Object(Qo.d)("indices",t,e,n),i=Object(Qo.d)("depth",t,e,n),a=Object(Qo.d)("onValue",t,e,n),o=Object(Qo.d)("offValue",t,e,n);return[wu.a(r,i,a,o)]}case"Ones":return[ku.a(Object(Qo.d)("shape",t,e,n),Object(Qo.d)("dtype",t,e,n))];case"OnesLike":return[Ou.a(Object(Qo.d)("x",t,e,n))];case"RandomUniform":return[_u.a(Object(Qo.d)("shape",t,e,n),Object(Qo.d)("minval",t,e,n),Object(Qo.d)("maxval",t,e,n),Object(Qo.d)("dtype",t,e,n))];case"Range":{const r=Object(Qo.d)("start",t,e,n),i=Object(Qo.d)("stop",t,e,n),a=Object(Qo.d)("step",t,e,n);return[Au.a(r,i,a,Object(Qo.d)("dtype",t,e,n))]}case"TruncatedNormal":{const r=Object(Qo.d)("shape",t,e,n),i=Object(Qo.d)("mean",t,e,n),a=Object(Qo.d)("stdDev",t,e,n),o=Object(Qo.d)("seed",t,e,n);return[Cu.a(r,i,a,Object(Qo.d)("dtype",t,e,n),o)]}case"Zeros":return[Eu.a(Object(Qo.d)("shape",t,e,n),Object(Qo.d)("dtype",t,e,n))];case"ZerosLike":return[Su.a(Object(Qo.d)("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"dynamic":return(async(t,e,n)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:r,scores:i,maxOutputSize:a,iouThreshold:o,scoreThreshold:s,softNmsSigma:u}=Fu(t,e,n),c=await su.Bb.nonMaxSuppressionWithScoreAsync(r,i,a,o,s,u);return[c.selectedIndices,c.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:r,scores:i,maxOutputSize:a,iouThreshold:o,scoreThreshold:s}=Fu(t,e,n),u=Object(Qo.d)("padToMaxOutputSize",t,e,n),c=await su.Bb.nonMaxSuppressionPaddedAsync(r,i,a,o,s,u);return[c.selectedIndices,c.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:r,scores:i,maxOutputSize:a,iouThreshold:o,scoreThreshold:s}=Fu(t,e,n);return[await su.Bb.nonMaxSuppressionAsync(r,i,a,o,s)]}case"Where":{const r=ju.a(Object(Qo.d)("condition",t,e,n),"bool"),i=[await Nu.a(r)];return r.dispose(),i}case"ListDiff":return Tu.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n);case"evaluation":return d.di(()=>((t,e,n)=>{switch(t.op){case"TopKV2":{const r=Object(Qo.d)("x",t,e,n),i=Object(Qo.d)("k",t,e,n),a=Object(Qo.d)("sorted",t,e,n),o=Du.a(r,i,a);return[o.values,o.indices]}case"Unique":{const r=Object(Qo.d)("x",t,e,n),i=Iu.a(r);return[i.values,i.indices]}case"UniqueV2":{const r=Object(Qo.d)("x",t,e,n),i=Object(Qo.d)("axis",t,e,n),a=Iu.a(r,i);return[a.values,a.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"image":return d.di(()=>((t,e,n)=>{switch(t.op){case"ResizeBilinear":{const r=Object(Qo.d)("images",t,e,n),i=Object(Qo.d)("size",t,e,n),a=Object(Qo.d)("alignCorners",t,e,n),o=Object(Qo.d)("halfPixelCenters",t,e,n);return[su.Bb.resizeBilinear(r,[i[0],i[1]],a,o)]}case"ResizeNearestNeighbor":{const r=Object(Qo.d)("images",t,e,n),i=Object(Qo.d)("size",t,e,n),a=Object(Qo.d)("alignCorners",t,e,n),o=Object(Qo.d)("halfPixelCenters",t,e,n);return[su.Bb.resizeNearestNeighbor(r,[i[0],i[1]],a,o)]}case"CropAndResize":{const r=Object(Qo.d)("image",t,e,n),i=Object(Qo.d)("boxes",t,e,n),a=Object(Qo.d)("boxInd",t,e,n),o=Object(Qo.d)("cropSize",t,e,n),s=Object(Qo.d)("method",t,e,n),u=Object(Qo.d)("extrapolationValue",t,e,n);return[su.Bb.cropAndResize(r,i,a,o,s,u)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"graph":return d.di(()=>((t,e,n)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const r=Object(Qo.d)("default",t,e,n);return[Object(Qo.e)(t.name,e,n)||r];case"Placeholder":return[Object(Qo.e)(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const r=Object(Qo.d)("x",t,e,n);return[Object(Qo.a)(r)]}case"IdentityN":return Object(Qo.d)("x",t,e,n).map(t=>Object(Qo.a)(t));case"Snapshot":const i=Object(Qo.d)("x",t,e,n);return[Object(Qo.a)(i)];case"Shape":return[Mu.a(Object(Qo.d)("x",t,e,n).shape,"int32")];case"ShapeN":return Object(Qo.d)("x",t,e,n).map(t=>Mu.a(t.shape));case"Size":return[$u.a(Object(Qo.d)("x",t,e,n).size,"int32")];case"Rank":return[$u.a(Object(Qo.d)("x",t,e,n).rank,"int32")];case"NoOp":return[$u.a(1)];case"Print":const a=Object(Qo.d)("x",t,e,n),o=Object(Qo.d)("data",t,e,n),s=Object(Qo.d)("message",t,e,n),u=Object(Qo.d)("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(let t=0;t<o.length;t++)console.log(Array.prototype.slice.call(o[t].dataSync()).slice(0,u));return[a];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"logical":return d.di(()=>((t,e,n)=>{switch(t.op){case"Equal":return[Bu.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"NotEqual":return[zu.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"Greater":return[Lu.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"GreaterEqual":return[Pu.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"Less":return[qu.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"LessEqual":return[Wu.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"LogicalAnd":return[Uu.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"LogicalNot":return[Vu.a(Object(Qo.d)("a",t,e,n))];case"LogicalOr":return[Gu.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];case"Select":case"SelectV2":return[Hu.a(Object(Qo.d)("condition",t,e,n),Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"matrices":return d.di(()=>((t,e,n)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[Xu.a(Object(Qo.d)("a",t,e,n),Object(Qo.d)("b",t,e,n),Object(Qo.d)("transposeA",t,e,n),Object(Qo.d)("transposeB",t,e,n))];case"Transpose":return[Ku.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("perm",t,e,n))];case"_FusedMatMul":const[r,i]=Object(Qo.d)("fusedOps",t,e,n),a="biasadd"===r,o="prelu"===i,s=Object(Qo.d)("numArgs",t,e,n),u=Object(Qo.d)("leakyreluAlpha",t,e,n);if(a){if(o&&2!==s)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&1!==s)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,l]=Object(Qo.d)("args",t,e,n);return[su.sb.matMul({a:Object(Qo.d)("a",t,e,n),b:Object(Qo.d)("b",t,e,n),transposeA:Object(Qo.d)("transposeA",t,e,n),transposeB:Object(Qo.d)("transposeB",t,e,n),bias:c,activation:i,preluActivationWeights:l,leakyreluAlpha:u})];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"normalization":return d.di(()=>((t,e,n)=>{switch(t.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Yu.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("mean",t,e,n),Object(Qo.d)("variance",t,e,n),Object(Qo.d)("offset",t,e,n),Object(Qo.d)("scale",t,e,n),Object(Qo.d)("epsilon",t,e,n))];case"LRN":return[Ju.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("radius",t,e,n),Object(Qo.d)("bias",t,e,n),Object(Qo.d)("alpha",t,e,n),Object(Qo.d)("beta",t,e,n))];case"Softmax":return[Zu.a(Object(Qo.d)("x",t,e,n))];case"LogSoftmax":return[Qu.a(Object(Qo.d)("x",t,e,n))];case"SparseToDense":return[tc.a(Object(Qo.d)("sparseIndices",t,e,n),Object(Qo.d)("outputShape",t,e,n),Object(Qo.d)("sparseValues",t,e,n),Object(Qo.d)("defaultValue",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"reduction":return d.di(()=>((t,e,n)=>{switch(t.op){case"Max":{const r=Object(Qo.d)("axis",t,e,n),i=Object(Qo.d)("keepDims",t,e,n);return[ec.a(Object(Qo.d)("x",t,e,n),r,i)]}case"Mean":{const r=Object(Qo.d)("axis",t,e,n),i=Object(Qo.d)("keepDims",t,e,n);return[nc.a(Object(Qo.d)("x",t,e,n),r,i)]}case"Min":{const r=Object(Qo.d)("axis",t,e,n),i=Object(Qo.d)("keepDims",t,e,n);return[rc.a(Object(Qo.d)("x",t,e,n),r,i)]}case"Sum":{const r=Object(Qo.d)("axis",t,e,n),i=Object(Qo.d)("keepDims",t,e,n);return[ic.a(Object(Qo.d)("x",t,e,n),r,i)]}case"All":{const r=Object(Qo.d)("axis",t,e,n),i=Object(Qo.d)("keepDims",t,e,n);return[ac.a(Object(Qo.d)("x",t,e,n),r,i)]}case"Any":{const r=Object(Qo.d)("axis",t,e,n),i=Object(Qo.d)("keepDims",t,e,n);return[oc.a(Object(Qo.d)("x",t,e,n),r,i)]}case"ArgMax":{const r=Object(Qo.d)("axis",t,e,n);return[sc.a(Object(Qo.d)("x",t,e,n),r)]}case"ArgMin":{const r=Object(Qo.d)("axis",t,e,n);return[uc.a(Object(Qo.d)("x",t,e,n),r)]}case"Prod":{const r=Object(Qo.d)("axis",t,e,n),i=Object(Qo.d)("keepDims",t,e,n);return[Zs.a(Object(Qo.d)("x",t,e,n),r,i)]}case"Cumsum":{const r=Object(Qo.d)("axis",t,e,n),i=Object(Qo.d)("exclusive",t,e,n),a=Object(Qo.d)("reverse",t,e,n);return[cc.a(Object(Qo.d)("x",t,e,n),r,i,a)]}case"Bincount":const r=Object(Qo.d)("x",t,e,n),i=Object(Qo.d)("weights",t,e,n),a=Object(Qo.d)("size",t,e,n);return[lc.a(r,i,a)];case"DenseBincount":{const r=Object(Qo.d)("x",t,e,n),i=Object(Qo.d)("weights",t,e,n),a=Object(Qo.d)("size",t,e,n),o=Object(Qo.d)("binaryOutput",t,e,n);return[dc.a(r,i,a,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"slice_join":return d.di(()=>((t,e,n)=>{switch(t.op){case"ConcatV2":case"Concat":{const r=Object(Qo.d)("n",t,e,n),i=Object(Qo.d)("axis",t,e,n);let a=Object(Qo.d)("tensors",t,e,n);return a=a.slice(0,r),[fc.a(a,i)]}case"Gather":{const r=Object(Qo.d)("x",t,e,n),i=Object(Qo.d)("indices",t,e,n);return[hc.a(r,ju.a(i,"int32"),0)]}case"GatherV2":{const r=Object(Qo.d)("axis",t,e,n),i=Object(Qo.d)("batchDims",t,e,n),a=Object(Qo.d)("x",t,e,n),o=Object(Qo.d)("indices",t,e,n);return[hc.a(a,ju.a(o,"int32"),r,i)]}case"Reverse":{const r=Object(Qo.d)("dims",t,e,n),i=[];for(let t=0;t<r.length;t++)r[t]&&i.push(t);const a=Object(Qo.d)("x",t,e,n);return[pc.a(a,i)]}case"ReverseV2":{const r=Object(Qo.d)("axis",t,e,n),i=Object(Qo.d)("x",t,e,n);return[pc.a(i,r)]}case"Slice":{const r=Object(Qo.d)("begin",t,e,n),i=Object(Qo.d)("size",t,e,n);return[mc.a(Object(Qo.d)("x",t,e,n),r,i)]}case"StridedSlice":{const r=Object(Qo.d)("begin",t,e,n),i=Object(Qo.d)("end",t,e,n),a=Object(Qo.d)("strides",t,e,n),o=Object(Qo.d)("beginMask",t,e,n),s=Object(Qo.d)("endMask",t,e,n),u=Object(Qo.d)("ellipsisMask",t,e,n),c=Object(Qo.d)("newAxisMask",t,e,n),l=Object(Qo.d)("shrinkAxisMask",t,e,n),d=Object(Qo.d)("x",t,e,n);return[gc.a(d,r,i,a,o,s,u,c,l)]}case"Pack":return Object(d.di)(()=>{const r=Object(Qo.d)("axis",t,e,n),i=Object(Qo.d)("tensors",t,e,n),a=i[0].shape,o=bc.a(i[0]).shape,s=i.map(t=>{const e=d.qi.arraysEqual(t.shape,a);if(!e&&!d.qi.arraysEqual(bc.a(t).shape,o))throw new Error("the input tensors shape does not match");return e?t:yc.a(t,a)});return[vc.a(s,r)]});case"Unpack":{const r=Object(Qo.d)("axis",t,e,n),i=Object(Qo.d)("tensor",t,e,n);return xc.a(i,r)}case"Tile":{const r=Object(Qo.d)("reps",t,e,n);return[wc.a(Object(Qo.d)("x",t,e,n),r)]}case"Split":case"SplitV":{const r=Object(Qo.d)("axis",t,e,n),i=Object(Qo.d)("numOrSizeSplits",t,e,n),a=Object(Qo.d)("x",t,e,n);return kc.a(a,i,r)}case"ScatterNd":{const r=Object(Qo.d)("indices",t,e,n),i=Object(Qo.d)("values",t,e,n),a=Object(Qo.d)("shape",t,e,n);return[Oc.a(r,i,a)]}case"GatherNd":{const r=Object(Qo.d)("x",t,e,n),i=Object(Qo.d)("indices",t,e,n);return[_c.a(r,i)]}case"SparseToDense":{const r=Object(Qo.d)("sparseIndices",t,e,n),i=Object(Qo.d)("outputShape",t,e,n),a=Object(Qo.d)("sparseValues",t,e,n),o=Object(Qo.d)("defaultValue",t,e,n);return[tc.a(r,a,i,a.dtype===o.dtype?o:ju.a(o,a.dtype))]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"spectral":return d.di(()=>((t,e,n)=>{switch(t.op){case"FFT":return[Ac.a(Object(Qo.d)("x",t,e,n))];case"IFFT":return[Cc.a(Object(Qo.d)("x",t,e,n))];case"RFFT":return[Ec.a(Object(Qo.d)("x",t,e,n))];case"IRFFT":return[Sc.a(Object(Qo.d)("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"transformation":return d.di(()=>((t,e,n)=>{switch(t.op){case"Cast":return[ju.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("dtype",t,e,n))];case"ExpandDims":{const r=Object(Qo.d)("axis",t,e,n);return[jc.a(Object(Qo.d)("x",t,e,n),r)]}case"Squeeze":{const r=Object(Qo.d)("axis",t,e,n);return[bc.a(Object(Qo.d)("x",t,e,n),r)]}case"Reshape":return[yc.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("shape",t,e,n))];case"MirrorPad":return[Nc.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("padding",t,e,n),Object(Qo.d)("mode",t,e,n))];case"PadV2":case"Pad":return[Tc.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("padding",t,e,n),Object(Qo.d)("constantValue",t,e,n))];case"SpaceToBatchND":{const r=Object(Qo.d)("blockShape",t,e,n),i=Object(Qo.d)("paddings",t,e,n);return[Fc.a(Object(Qo.d)("x",t,e,n),r,i)]}case"BatchToSpaceND":{const r=Object(Qo.d)("blockShape",t,e,n),i=Object(Qo.d)("crops",t,e,n);return[Dc.a(Object(Qo.d)("x",t,e,n),r,i)]}case"DepthToSpace":{const r=Object(Qo.d)("blockSize",t,e,n),i=Object(Qo.d)("dataFormat",t,e,n).toUpperCase();return[Ic.a(Object(Qo.d)("x",t,e,n),r,i)]}case"BroadcastTo":return[Mc.a(Object(Qo.d)("x",t,e,n),Object(Qo.d)("shape",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"hash_table":return(async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const i=Object(Qo.d)("keyDType",t,e,n),a=Object(Qo.d)("valueDType",t,e,n),o=new Ru(i,a);return r.addHashTable(t.name,o),[o.handle]}case"LookupTableImport":case"LookupTableImportV2":{const i=Object(Qo.d)("tableHandle",t,e,n,r),a=Object(Qo.d)("keys",t,e,n),o=Object(Qo.d)("values",t,e,n),s=r.getHashTableById(i.id);return[await s.import(a,o)]}case"LookupTableFind":case"LookupTableFindV2":{const i=Object(Qo.d)("tableHandle",t,e,n,r),a=Object(Qo.d)("keys",t,e,n),o=Object(Qo.d)("defaultValue",t,e,n),s=r.getHashTableById(i.id);return[await s.find(a,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n,r);case"custom":const i=Object(es.b)(t.op);if(i&&i.customExecutor)return i.customExecutor(new ts(t,e,n));throw TypeError(`Custom op ${t.op} is not registered.`);default:throw TypeError(`Unknown op '${t.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return d.qi.isPromise(i)?i.then(t=>[].concat(t)):[].concat(i)}class Rc{constructor(t={},e={},n={},r={}){this.weightMap=t,this.tensorArrayMap=e,this.tensorListMap=n,this.functionMap=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,e){return{id:t,frameName:e,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let e=0;e<this.contexts.length-1;e++){const n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(t=>0===t.id&&0===t.iterationId?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const e in this.tensorArrayMap)this.tensorArrayMap[e].clearAndClose(t);for(const e in this.tensorListMap)this.tensorListMap[e].clearAndClose(t)}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bc(t,e,n,r){const i=new Set,a=[];let o=null,s=null;const u=new Set,c=Object.keys(t).map(t=>Object(Qo.g)(t)[0]);let l=[];null!=r&&(l=r.map(t=>Object(Qo.g)(t.name)[0]));const d=[...e];for(;d.length>0;){const t=d.pop();(qc(t)||Wc(t)||Uc(t))&&null==o&&(o=t,s=o.children.map(t=>t.name).filter(t=>i.has(t))),i.add(t.name),null==n[t.name]&&(-1===c.indexOf(t.name)&&-1===l.indexOf(t.name)&&(0!==t.inputs.length?t.inputs.forEach(t=>{u.has(t.name)||(u.add(t.name),d.push(t))}):a.push(t.name)))}return{inputs:t,outputs:e,usedNodes:i,missingInputs:a,dynamicNode:o,syncInputs:s}}const zc=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],Lc=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],Pc=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2"];function qc(t){return zc.indexOf(t.op)>=0}function Wc(t){return Lc.indexOf(t.op)>=0}function Uc(t){return Pc.indexOf(t.op)>=0}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vc{constructor(t,e){this.graph=t,this.parent=e,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach(e=>{this._functionExecutorMap[e]=new Vc(t.functions[e],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const e=Object.keys(t).map(e=>t[e].map(t=>t.id));this._weightIds=[].concat(...e),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const e=t.signatureKey||t.name;return t.defaultOutput?`${e}:${t.defaultOutput}`:e})}get functions(){return Object.keys(this._functions).reduce((t,e)=>(t[e]=this._functions[e].signature,t),{})}getCompilationKey(t,e){const n=t.map(t=>t.name).sort(),r=e.map(t=>t.name).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}compile(t,e){const n=Bc(t,e,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:i,syncInputs:a}=n;if(null!=i)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${a}]`);if(r.length>0){const n=e.map(t=>t.name),i=Object.keys(t);throw new Error(`Cannot compute the outputs [${n}] from the provided inputs [${i}]. Missing the following inputs: [${r}]`)}return function(t,e,n){const{usedNodes:r,inputs:i}=n,a=[],o=Object.keys(i).map(t=>Object(Qo.g)(t)[0]).map(e=>t.nodes[e]),s=t.initNodes;o.forEach(t=>{r.has(t.name)&&a.push(t)}),t.weights.forEach(t=>{r.has(t.name)&&a.push(t)}),null!=s&&s.forEach(t=>{r.has(t.name)&&a.push(t)});const u=new Set,c=[];for(;a.length>0;){const t=a.pop();u.add(t.name),e[t.name]||c.push(t),t.children.forEach(t=>{!u.has(t.name)&&r.has(t.name)&&t.inputs.every(t=>u.has(t.name))&&a.push(t)})}return c}(this.graph,this.weightMap,n)}execute(t,e){t=this.mapInputs(t);const n=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);const r=n.map(t=>this.graph.nodes[Object(Qo.g)(t)[0]]),i=e.map(t=>Object(Qo.g)(t)[0]);let a=i.map(t=>this.graph.nodes[t]);0===a.length&&(a=this._outputs);const o=this.getCompilationKey(r,a);let s=this.compiledMap.get(o);null==s&&(s=this.compile(t,a),this.compiledMap.set(o,s));const u={},c={};return Object(d.di)(()=>{const n=new Rc(this.weightMap,u,c,this.functionExecutorMap),r=Object.assign({},this.weightMap);Object.keys(t).forEach(e=>{const[n,i]=Object(Qo.g)(e),a=[];a[i]=t[e],r[n]=a});const a=this.getFrozenTensorIds(r),o={};for(let t=0;t<s.length;t++){const e=s[t];if(!r[e.name]){const t=$c(e,r,n,this._resourceManager);if(d.qi.isPromise(t))throw new Error(`The execution of the op '${e.op}' returned a promise. Please use model.executeAsync() instead.`);r[e.name]=t,this.checkTensorForDisposal(e.name,e,r,n,a,i,o)}}return null==this.parent&&n.dispose(a),e.map(t=>Object(Qo.e)(t,r,n))})}getFrozenTensorIds(t){const e=[].concat.apply([],Object.keys(t).map(e=>t[e]).map(t=>t.map(t=>t.id)));return new Set(e)}checkTensorForDisposal(t,e,n,r,i,a,o){"control"!==e.category&&-1===a.indexOf(t)&&(n[t].forEach(t=>{null!=t&&(o[t.id]=(o[t.id]||0)+e.children.length)}),e.inputs.forEach(t=>{if("control"!==t.category){const e=Object(Qo.f)(t.name,n,r);null!=e&&e.forEach(t=>{if(t&&!i.has(t.id)){const e=o[t.id];1===e?(t.dispose(),delete o[t.id]):null!=e&&o[t.id]--}})}}))}async executeAsync(t,e){return this._executeAsync(t,e)}async _executeAsync(t,e,n=!1,r={},i={}){n||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e));const a=new Rc(this.weightMap,r,i,this.functionExecutorMap),o=await this.executeWithControlFlow(t,a,e,n),s=e.map(t=>Object(Qo.e)(t,o,a)),u=s.map(t=>t.id),c=Object.keys(t).map(e=>t[e].id),l=new Set([...u,...c,...this.weightIds]);return Object.keys(o).forEach(t=>{o[t].forEach(t=>{!t||t.isDisposed||l.has(t.id)||t.dispose()})}),null==this.parent&&a.dispose(l),s}async executeFunctionAsync(t,e,n){const r=t.reduce((t,e,n)=>(t[this.inputs[n].name]=e,t),{});return this._executeAsync(r,this.outputNodes,!0,e,n)}async executeWithControlFlow(t,e,n,r){const i=Object.keys(t),a=i.map(t=>this.graph.nodes[Object(Qo.g)(t)[0]]),o=n.map(t=>Object(Qo.g)(t)[0]);let s=o.map(t=>this.graph.nodes[t]);0===s.length&&(s=this._outputs);const{usedNodes:u,missingInputs:c,dynamicNode:l,syncInputs:d}=Bc(t,s,this.weightMap,this._initNodes),f=[...a,...this.graph.weights,...this._initNodes||[]].map(t=>({node:t,contexts:e.currentContext})),h=Object.assign({},this.weightMap);Object.keys(t).forEach(e=>{const[n,r]=Object(Qo.g)(e),i=[];i[r]=t[e],h[n]=i});const p={},m=this.getFrozenTensorIds(h),g={};for(;f.length>0;){const t=this.processStack(a,f,e,h,g,m,o,p,u);await Promise.all(t)}null!=l||r||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const b=s.filter(t=>!qc(t)&&!Object(Qo.e)(t.name,h,e)).map(t=>t.name);if(b.length>0){let t="";throw null!=l&&(t=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${d}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${i}]. Consider providing the following inputs: [${c}]. ${t}`)}return h}processStack(t,e,n,r,i,a,o,s,u){const c=[];for(;e.length>0;){const t=e.pop();n.currentContext=t.contexts;let l="";if("Enter"===t.node.op&&Object(Qo.d)("isConstant",t.node,r,n)&&([l]=Object(Qo.b)(t.node.name,n)),null==r[t.node.name]){const f=$c(t.node,r,n,this._resourceManager);l||([l]=Object(Qo.b)(t.node.name,n));const h=n.currentContext;d.qi.isPromise(f)?c.push(f.then(c=>(r[l]=c,n.currentContext=h,this.checkTensorForDisposal(l,t.node,r,n,a,o,s),this.processChildNodes(t.node,e,n,r,i,u),c))):(r[l]=f,this.checkTensorForDisposal(l,t.node,r,n,a,o,s),this.processChildNodes(t.node,e,n,r,i,u))}else this.processChildNodes(t.node,e,n,r,i,u)}return c}processChildNodes(t,e,n,r,i,a){t.children.forEach(t=>{const[o]=Object(Qo.b)(t.name,n);!i[o]&&a.has(t.name)&&("Merge"===t.op?t.inputNames.some(t=>!!Object(Qo.e)(t,r,n))&&(i[o]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every(t=>!!Object(Qo.e)(t,r,n))&&(i[o]=!0,e.push({contexts:n.currentContext,node:t})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(t=>t.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(e=>{const n=t[e],[r]=Object(Qo.g)(e),i=this.graph.nodes[r];if(i.attrParams.shape&&i.attrParams.shape.value){const t=i.attrParams.shape.value,e=t.length===n.shape.length&&n.shape.every((e,n)=>-1===t[n]||t[n]===e);d.qi.assert(e,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${t}], but was [${n.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&d.qi.assert(n.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${n.dtype}`)})}mapInputs(t){const e={};for(const n in t)if(null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]){e[this._signature.inputs[n].name]=t[n]}else e[n]=t[n];return e}checkInputs(t){const e=Object.keys(t).filter(t=>{const[e]=Object(Qo.g)(t);return null==this.graph.nodes[e]});if(e.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${e}] that are not part of graph`)}mapOutputs(t){return t.map(t=>{if(null!=this._signature&&null!=this._signature.outputs&&null!=this._signature.outputs[t]){return this._signature.outputs[t].name}return t},{})}checkOutputs(t){t.forEach(t=>{const[e]=Object(Qo.g)(t);if(!this.graph.nodes[e])throw new Error(`The output '${t}' is not found in the graph`)})}}class Gc{constructor(t={},e={}){this.hashTableNameToHandle=t,this.hashTableMap=e}addHashTable(t,e){this.hashTableNameToHandle[t]=e.handle,this.hashTableMap[e.id]=e}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hc{constructor(t,e={}){this.modelUrl=t,this.loadOptions=e,this.version="n/a",null==e&&(this.loadOptions={}),this.resourceManager=new Gc}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}findIOHandler(){const t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=d.sf.browserHTTPRequest(t,this.loadOptions);else{const e=d.sf.getLoadHandlers(t,this.loadOptions);if(0===e.length)e.push(d.sf.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error(`Found more than one (${e.length}) load handlers for URL '${[t]}'`);this.handler=e[0]}}async load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=await this.handler.load();return this.loadSync(t)}loadSync(t){this.artifacts=t;const e=this.artifacts.modelTopology;let n;n=null!=this.artifacts.userDefinedMetadata&&null!=this.artifacts.userDefinedMetadata.signature?this.artifacts.userDefinedMetadata.signature:this.artifacts.signature,this.signature=n,this.version=`${e.versions.producer}.${e.versions.minConsumer}`;const r=d.sf.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new Vc(Zo.a.Instance.transformGraph(e,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,null!=t.modelInitializer&&null!=t.modelInitializer.node){const e=Zo.a.Instance.transformGraph(t.modelInitializer);this.initializer=new Vc(e),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(t,e){if("string"==typeof t){const e=d.sf.getSaveHandlers(t);if(0===e.length)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(e.length>1)throw new Error(`Found more than one (${e.length}) save handlers for URL '${t}'`);t=e[0]}if(null==t.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)}predict(t,e){return this.execute(t,this.outputNodes)}normalizeInputs(t){if(!(t instanceof d.id||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${t.length} input tensors.`);return this.inputNodes.reduce((e,n,r)=>(e[n]=t[r],e),{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}execute(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const n=this.executor.execute(t,e);return n.length>1?n:n[0]}async executeAsync(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const n=await this.executor.executeAsync(t,e);return n.length>1?n:n[0]}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((e,n)=>(e[n]=[t[n]],e),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function Xc(t,e={}){if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==e&&(e={}),e.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t+="model.json?tfjs-format=file");const n=new Hc(t,e);return await n.load(),n}
/** @license See the LICENSE file. */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var Kc=n(87),Yc=n(44),Jc=n(68);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
class Zc{constructor(){this.size=null}batch(t,e=!0){const n=this;let r;return d.qi.assert(t>0,()=>"batchSize needs to be positive, but it is\n      "+t),r=this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t),Qc(async()=>(await n.iterator()).columnMajorBatch(t,e,nl),r)}concatenate(t){const e=this;let n;return n=this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null,Qc(async()=>(await e.iterator()).concatenate(await t.iterator()),n)}filter(t){const e=this;let n;return n=this.size===1/0?1/0:null,Qc(async()=>(await e.iterator()).filter(e=>d.di(()=>t(e))),n)}async forEachAsync(t){return(await this.iterator()).forEachAsync(t)}map(t){const e=this;return Qc(async()=>(await e.iterator()).map(e=>d.di(()=>t(e))),this.size)}mapAsync(t){const e=this;return Qc(async()=>(await e.iterator()).mapAsync(t),this.size)}prefetch(t){if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const e=this;return Qc(async()=>(await e.iterator()).prefetch(t),this.size)}repeat(t){const e=this;let n;return n=null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null,Qc(async()=>{const n=Object(Yc.e)(async()=>({value:await e.iterator(),done:!1}));return Object(Yc.d)(n.take(t))},n)}skip(t){const e=this;let n;return n=null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null,Qc(async()=>(await e.iterator()).skip(t),n)}shuffle(t,e,n=!0){if(null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const r=this,i=Kc.alea(e||d.qi.now().toString());return Qc(async()=>{let e=i.int32();return n&&(e+=i.int32()),(await r.iterator()).shuffle(t,e.toString())},this.size)}take(t){const e=this;let n;return n=null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null,Qc(async()=>(await e.iterator()).take(t),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function Qc(t,e=null){return new class extends Zc{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function tl(t){return Qc(async()=>Object(Yc.f)(t),t.length)}function el(t){if(!Object(Jc.e)(t))throw new Error("The argument to zip() must be an object or array.");let e;if(Array.isArray(t))for(let n=0;n<t.length;n++)e=null==e?t[n].size:Math.min(e,t[n].size);else if(t instanceof Object)for(const n in t)e=null==e?t[n].size:Math.min(e,t[n].size);return Qc(async()=>{const e=await Object(Jc.c)(t,t=>{if(t instanceof Zc)return{value:t.iterator(),recurse:!1};if(Object(Jc.e)(t))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return Object(Yc.g)(e,Yc.c.SHORTEST)},e)}function nl(t){if(null===t)return null;const e=t[0];if(Object(Jc.a)(e)){return{value:function(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof d.id?d.Lh(t):d.Uh(t)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */(t),recurse:!1}}return{value:null,recurse:!0}}Zc.MAX_BUFFER_SIZE=1e4;class rl extends Zc{constructor(t){super(),this.input=t}async iterator(){return(await this.input.iterator()).decodeUTF8().split("\n").map(t=>(t.endsWith("\r")&&(t=t.slice(0,-1)),t))}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */const il=Symbol("out"),al=Symbol("field"),ol=Symbol("quote"),sl=Symbol("quoteafterquote"),ul=Symbol("quoteinquote");class cl extends Zc{constructor(t,e){super(),this.input=t,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new rl(t),e||(e={}),this.hasHeader=!1!==e.hasHeader,this.fullColumnNames=e.columnNames,this.columnConfigs=e.columnConfigs,this.configuredColumnsOnly=e.configuredColumnsOnly,e.delimWhitespace?(d.qi.assert(null==e.delimiter,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=e.delimiter?e.delimiter:","}async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){const t=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&t&&d.qi.assert(t.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=t);const e=this.fullColumnNames.reduce((t,e)=>(t[e]=t[e]+1||1,t),{}),n=Object.keys(e).filter(t=>e[t]>1);if(d.qi.assert(0===n.length,()=>"Duplicate column names found: "+n.toString()),this.columnConfigs)for(const t of Object.keys(this.columnConfigs)){if(-1===this.fullColumnNames.indexOf(t))throw new Error('The key "'+t+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){const t=await this.base.iterator(),e=await t.next();if(e.done)throw new Error("No data was found for CSV parsing.");const n=e.value;return this.parseRow(n,!1)}return null}async iterator(){this.columnNamesValidated||await this.setColumnNames();let t=await this.base.iterator();return this.hasHeader&&(t=t.skip(1)),t.map(t=>this.makeDataElement(t))}makeDataElement(t){const e=this.parseRow(t),n={},r={};for(let i=0;i<this.fullColumnNames.length;i++){const a=this.fullColumnNames[i],o=this.columnConfigs?this.columnConfigs[a]:null;if(!this.configuredColumnsOnly||o){const s=e[i];let u=null;if(""===s)if(o&&void 0!==o.default)u=o.default;else{if(o&&(o.required||o.isLabel))throw new Error(`Required column ${a} is empty in this line: ${t}`);u=void 0}else{const t=Number(s);if(isNaN(t))u=o&&"bool"===o.dtype?this.getBoolean(s):s;else if(o&&o.dtype)switch(o.dtype){case"float32":u=t;break;case"int32":u=Math.floor(t);break;case"bool":u=this.getBoolean(s);break;default:u=t}else u=t}o&&o.isLabel?r[a]=u:n[a]=u}}return 0===Object.keys(r).length?n:{xs:n,ys:r}}getBoolean(t){return"1"===t||"true"===t.toLowerCase()?1:0}parseRow(t,e=!0){const n=[];let r=0;const i=t.length;let a=il;for(let e=0;e<i;e++)switch(a){case il:switch(t.charAt(e)){case'"':r=e+1,a=ol;break;case this.delimiter:if(r=e+1," "===this.delimiter&&this.delimWhitespace)break;n.push(""),a=il;break;default:a=al,r=e}break;case al:switch(t.charAt(e)){case this.delimiter:n.push(t.substring(r,e)),a=il,r=e+1}break;case ol:switch(t.charAt(e)){case'"':a=sl}break;case sl:switch(t.charAt(e)){case this.delimiter:n.push(t.substring(r,e-1)),a=il,r=e+1;break;case'"':a=ol;break;default:a=ul}break;case ul:switch(t.charAt(e)){case'"':a=ol}}if(a===sl?n.push(t.substring(r,i-1)):n.push(t.substring(r)),e&&n.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${n}`);return n}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class ll extends Yc.a{constructor(t){super(),this.microphoneConfig=t,this.isClosed=!1,this.fftSize=t.fftSize||1024;const e=Math.log2(this.fftSize);if(this.fftSize<0||e<4||e>14||!Number.isInteger(e))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+this.fftSize);if(this.numFrames=t.numFramesPerSpectrogram||43,this.sampleRateHz=t.sampleRateHz,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.audioTrackConstraints=t.audioTrackConstraints,this.smoothingTimeConstant=t.smoothingTimeConstant||0,this.includeSpectrogram=!1!==t.includeSpectrogram,this.includeWaveform=!0===t.includeWaveform,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(t={}){if(Object(d.Me)().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");const e=new ll(t);return await e.start(),e}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})}catch(t){throw new Error("Error thrown while initializing video stream: "+t.message)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const t=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new t,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: `+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;const e=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,e.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let t,e;const n=await this.getAudioData();if(this.includeSpectrogram){const e=this.flattenQueue(n.freqDataQueue);t=this.getTensorFromAudioDataArray(e,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const t=this.flattenQueue(n.timeDataQueue);e=this.getTensorFromAudioDataArray(t,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:t,waveform:e},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){const t=[],e=[];let n=0;return new Promise(r=>{const i=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&r({freqDataQueue:t,timeDataQueue:e}),t.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),e.push(this.timeData.slice())),++n===this.numFrames&&(clearInterval(i),r({freqDataQueue:t,timeDataQueue:e}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(t){const e=t[0].length,n=new Float32Array(t.length*e);return t.forEach((t,r)=>n.set(t,r*e)),n}getTensorFromAudioDataArray(t,e){const n=new Float32Array(d.qi.sizeFromShape(e));return n.set(t,n.length-t.length),Object(d.Uh)(n,e)}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class dl extends Yc.a{constructor(t,e){if(super(),this.webcamVideoElement=t,this.webcamConfig=e,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=Object(d.Vh)([0],"int32"),this.webcamConfig.centerCrop){const t=1*this.webcamConfig.resizeWidth/this.webcamVideoElement.width,e=1*this.webcamConfig.resizeHeight/this.webcamVideoElement.height,n=(1-t)/2,r=(1-e)/2,i=n+t,a=e+r;this.cropBox=Object(d.Wh)([r,n,a,i],[1,4])}else this.cropBox=Object(d.Wh)([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(t,e={}){if(Object(d.Me)().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!e.resizeWidth||!e.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=e.resizeWidth,t.height=e.resizeHeight}const n=new dl(t,e);return await n.start(),n}async start(){this.webcamConfig.facingMode&&d.qi.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(t){throw t.message="Error thrown while initializing video stream: "+t.message,t}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(t=>{this.webcamVideoElement.onloadedmetadata=()=>{t()}})}async next(){if(this.isClosed)return{value:null,done:!0};let t;try{t=d.Vd.fromPixels(this.webcamVideoElement)}catch(t){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(t))}if(!this.resize)return{value:t,done:!1};try{return{value:this.cropAndResizeFrame(t),done:!1}}catch(t){throw new Error("Error thrown cropping the video: "+t.message)}finally{t.dispose()}}needToResize(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)}cropAndResizeFrame(t){return Object(d.di)(()=>{const e=t.toFloat().expandDims(0);let n;n=d.qf.cropAndResize(e,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const r=n.shape;return n.reshape(r.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(t=>t.stop());try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class fl{}var hl=n(313);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class pl extends hl.a{constructor(t,e={}){super(),this.file=t,this.options=e,d.qi.assert(t instanceof Uint8Array||!!Object(d.Me)().get("IS_BROWSER")&&(t instanceof File||t instanceof Blob),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=e.offset||0,this.chunkSize=e.chunkSize||1048576}summary(){return"FileChunks "+this.file}async next(){if(this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size))return{value:null,done:!0};const t=new Promise((t,e)=>{const n=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)t(new Uint8Array(this.file.slice(this.offset,n)));else{const r=new FileReader;r.onload=n=>{let i=r.result;if(i instanceof ArrayBuffer&&(i=new Uint8Array(i)),!(i instanceof Uint8Array))return e(new TypeError("FileReader returned unknown type."));t(i)},r.onabort=t=>e(new Error("Aborted")),r.onerror=t=>e(new Error(t.type));const i=this.file.slice(this.offset,n);r.readAsArrayBuffer(i)}this.offset=n});return{value:await t,done:!1}}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */const ml=t=>({method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function gl(t){return"string"==typeof t&&"file://"===t.substr(0,7)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class bl extends fl{constructor(t,e={}){super(),this.input=t,this.options=e}async iterator(){if(gl(this.input)&&Object(d.Me)().get("IS_NODE")){const t=n(371);this.input=t.readFileSync(this.input.substr(7))}return new pl(this.input,this.options)}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class yl extends fl{constructor(t,e={}){super(),this.url=t,this.fileOptions=e}async iterator(){return gl(this.url)?new bl(this.url,this.fileOptions).iterator():async function(t,e={}){let n,r;"string"==typeof t?n=t:(n=t.url,r=ml(t));const i=await d.qi.fetch(n,r);if(i.ok){const t=new Uint8Array(await i.arrayBuffer());return new pl(t,e)}throw new Error(i.statusText)}(this.url,this.fileOptions)}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function vl(t,e={}){return new cl(new yl(t),e)}function xl(t){const e=Object(Yc.e)(t);return Qc(async()=>e)}function wl(t){return Qc(async()=>{const e=await t();return Object(Yc.e)(()=>e.next())})}async function kl(t,e){return dl.create(t,e)}async function Ol(t){return ll.create(t)}
/** @license See the LICENSE file. */const _l="2.8.2";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Al(t,e){Array.isArray(t)||(t=[t]),t.forEach(t=>{null!=t&&d.qi.assert("complex64"!==t.dtype,()=>e+" does not support complex64 tensors in the CPU backend.")})}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cl=d.yf.whereImpl;class El extends d.Cb{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new d.Q(this,Object(d.Le)())}write(t,e,n){this.firstUse&&(this.firstUse=!1,Object(d.Me)().get("IS_NODE")&&d.Ld.warn("\n============================\nHi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));const r={};return this.data.set(r,{values:t,dtype:n,refCount:1}),r}makeTensorInfo(t,e,n){let r;if("string"===e&&null!=n&&n.length>0&&d.qi.isString(n[0])){const i=n.map(t=>d.qi.encodeString(t));r=this.write(i,t,e)}else r=this.write(n,t,e);return{dataId:r,shape:t,dtype:e}}incRef(t){this.data.get(t).refCount++}decRef(t){if(this.data.has(t)){this.data.get(t).refCount--}}move(t,e,n,r){this.data.set(t,{values:e,dtype:r,refCount:1})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:e,complexTensorInfos:n}=this.data.get(t);if("complex64"===e){const t=this.readSync(n.real.dataId),e=this.readSync(n.imag.dataId);return d.Ld.mergeRealAndImagArrays(t,e)}return this.data.get(t).values}bufferSync(t){const e=this.readSync(t.dataId);let n=e;if("string"===t.dtype)try{n=e.map(t=>d.qi.decodeString(t))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return Object(d.Wd)(t.shape,t.dtype,n)}makeOutput(t,e,n){const r=this.write(t,e,n);return Object(d.Le)().makeTensorFromDataId(r,e,n,this)}disposeData(t){if(this.data.has(t)){const{complexTensorInfos:e}=this.data.get(t);null!=e&&(this.disposeData(e.real.dataId),this.disposeData(e.imag.dataId)),this.data.delete(t)}}disposeIntermediateTensorInfo(t){const e=t.dataId;if(this.data.has(e)){const t=this.data.get(e);t.refCount--,t.refCount<1&&this.disposeData(e)}}async time(t){const e=d.qi.now();t();return{kernelMs:d.qi.now()-e}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Al([t],"where");const e=this.readSync(t.dataId);return Cl(t.shape,e)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}
/** @license See the LICENSE file. */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Sl(t,e,n){return({inputs:r,attrs:i,backend:a})=>{const{x:o}=r;if(Al(o,t),"string"===o.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");const s=a,u=s.data.get(o.dataId).values,c=d.qi.sizeFromShape(o.shape),l=n||o.dtype,f=d.qi.getArrayFromDType(l,c);for(let t=0;t<c;++t)f[t]=e(u[t],i);return s.makeTensorInfo(o.shape,l,f)}}function jl(t,e,n){return({inputs:r,attrs:i,backend:a})=>{const{x:o}=r;if(Al(o,t),"string"===o.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");const s=a,u=s.data.get(o.dataId).values,c=n||o.dtype,l=e(u,c,i);return s.makeTensorInfo(o.shape,c,l)}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Object(d.Rg)("cpu",()=>new El,1);const Nl=Sl(d.bb,t=>t>=0?t:Math.exp(t)-1),Tl={kernelName:d.bb,backendName:"cpu",kernelFunc:Nl};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Fl(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Dl={kernelName:d.xb,backendName:"cpu",kernelFunc:Fl};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Il(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{alpha:a}=r;Al([i],"leakyRelu");const o=d.qi.sizeFromShape(i.shape),s=n.data.get(i.dataId).values,u=d.qi.getTypedArrayFromDType("float32",o);for(let t=0;t<s.length;t++)u[t]=s[t]<0?a*s[t]:s[t];return n.makeTensorInfo(i.shape,"float32",u)}const Ml={kernelName:d.Fb,backendName:"cpu",kernelFunc:Il};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $l(t){return(e,n,r,i,a)=>{const o=d.Ld.assertAndGetBroadcastShape(e,n),s=o.length,u=d.qi.computeStrides(o),c=d.qi.sizeFromShape(o),l=d.qi.getTypedArrayFromDType(a,c),f=e.length,h=n.length,p=d.qi.computeStrides(e),m=d.qi.computeStrides(n),g=d.Ld.getBroadcastDims(e,o),b=d.Ld.getBroadcastDims(n,o);if(g.length+b.length===0)for(let e=0;e<l.length;++e)l[e]=t(r[e%r.length],i[e%i.length]);else for(let e=0;e<l.length;++e){const n=d.qi.indexToLoc(e,s,u),a=n.slice(-f);g.forEach(t=>a[t]=0);const o=d.qi.locToIndex(a,f,p),c=n.slice(-h);b.forEach(t=>c[t]=0);const y=d.qi.locToIndex(c,h,m);l[e]=t(r[o],i[y])}return[l,o]}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rl=$l((t,e)=>t<0?e*t:t);function Bl(t){const{inputs:e,backend:n}=t,{x:r,alpha:i}=e;Al([r,i],"prelu");const a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,[s,u]=Rl(r.shape,i.shape,a,o,r.dtype);return n.makeTensorInfo(u,r.dtype,s)}const zl={kernelName:d.rc,backendName:"cpu",kernelFunc:Bl},Ll=Sl(d.Ac,t=>Math.max(0,t)),Pl={kernelName:d.Ac,backendName:"cpu",kernelFunc:Ll},ql=Sl(d.Bc,t=>Math.min(Math.max(0,t),6)),Wl={kernelName:d.Bc,backendName:"cpu",kernelFunc:ql};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ul(t,e,n,r,i){if("linear"===n)return Fl({inputs:{x:e},backend:t});if("relu"===n)return Ll({inputs:{x:e},backend:t});if("elu"===n)return Nl({inputs:{x:e},backend:t});if("relu6"===n)return ql({inputs:{x:e},backend:t});if("prelu"===n)return Bl({inputs:{x:e,alpha:r},backend:t});if("leakyrelu"===n)return Il({inputs:{x:e},backend:t,attrs:{alpha:i}});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vl(t){const{inputs:e,backend:n}=t,{real:r,imag:i}=e,a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",a),imag:n.makeTensorInfo(i.shape,"float32",o)},s}const Gl={kernelName:d.D,backendName:"cpu",kernelFunc:Vl};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hl(t,e,n="float32"){if("complex64"===n){return Vl({inputs:{real:Hl(t,e,"float32"),imag:Hl(t,e,"float32")},backend:t})}const r=d.qi.makeZerosTypedArray(d.qi.sizeFromShape(e),n);return t.makeTensorInfo(e,n,r)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xl(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.data.get(r.dataId).complexTensorInfos.real,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}const Kl={kernelName:d.wc,backendName:"cpu",kernelFunc:Xl};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yl(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dtype:a}=r;if("complex64"===a){if("complex64"===i.dtype)return Fl({inputs:{x:i},backend:n});const t=Hl(n,i.shape,i.dtype),e=Yl({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),r=Vl({inputs:{real:e,imag:t},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),r}if("complex64"===i.dtype){const t=Xl({inputs:{input:i},backend:n}),e=Yl({inputs:{x:t},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(t),e}if(!d.qi.hasEncodingLoss(i.dtype,a)){const t=Fl({inputs:{x:i},backend:n});return{dataId:t.dataId,shape:t.shape,dtype:a}}if("int32"===a){const t=n.data.get(i.dataId).values,e=Int32Array.from(t);return n.makeTensorInfo(i.shape,"int32",e)}if("bool"===a){const t=n.data.get(i.dataId).values,e=d.qi.toTypedArray([0],i.dtype),[r,a]=$l((t,e)=>t!==e?1:0)(i.shape,[],t,e,"bool");return n.makeTensorInfo(a,"bool",r)}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${a}`)}const Jl={kernelName:d.A,backendName:"cpu",kernelFunc:Yl};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zl(t,e,n,r){return null==n?({inputs:n,backend:i})=>{const{a:a,b:o}=n,s=i;Al([a,o],t);const u=s.data.get(a.dataId).values,c=s.data.get(o.dataId).values,l=r||a.dtype,[d,f]=e(a.shape,o.shape,u,c,l);return s.makeTensorInfo(f,l,d)}:({inputs:t,backend:i})=>{const{a:a,b:o}=t,s=i;if("complex64"===a.dtype||"complex64"===o.dtype){const t=Yl({inputs:{x:a},backend:s,attrs:{dtype:"complex64"}}),e=s.data.get(t.dataId),r=e.complexTensorInfos.real,i=e.complexTensorInfos.imag,u=s.data.get(r.dataId).values,c=s.data.get(i.dataId).values,l=Yl({inputs:{x:o},backend:s,attrs:{dtype:"complex64"}}),d=s.data.get(l.dataId),f=d.complexTensorInfos.real,h=d.complexTensorInfos.imag,p=s.data.get(f.dataId).values,m=s.data.get(h.dataId).values,[g,b,y]=n(a.shape,o.shape,u,c,p,m),v=s.makeTensorInfo(y,"float32",g),x=s.makeTensorInfo(y,"float32",b),w=Vl({inputs:{real:v,imag:x},backend:s});return s.disposeIntermediateTensorInfo(t),s.disposeIntermediateTensorInfo(l),s.disposeIntermediateTensorInfo(v),s.disposeIntermediateTensorInfo(x),w}{const t=s.data.get(a.dataId).values,n=s.data.get(o.dataId).values,i=r||a.dtype,[u,c]=e(a.shape,o.shape,t,n,i);return s.makeTensorInfo(c,i,u)}}}function Ql(t){return(e,n,r,i,a,o)=>{const s=d.Ld.assertAndGetBroadcastShape(e,n),u=d.qi.sizeFromShape(s),c=s.length,l=d.qi.computeStrides(s),f=d.qi.getTypedArrayFromDType("float32",u),h=d.qi.getTypedArrayFromDType("float32",u),p=d.Ld.getBroadcastDims(e,s),m=d.Ld.getBroadcastDims(n,s),g=d.Ld.mergeRealAndImagArrays(r,i),b=d.Ld.mergeRealAndImagArrays(a,o),y=e.length,v=d.qi.computeStrides(e),x=n.length,w=d.qi.computeStrides(n);if(p.length+m.length===0)for(let e=0;e<f.length;e++){const n=e%g.length,r=e%b.length,i=t(g[2*n],g[2*n+1],b[2*r],b[2*r+1]);f[e]=i.real,h[e]=i.imag}else for(let e=0;e<f.length;e++){const n=d.qi.indexToLoc(e,c,l),r=n.slice(-y);p.forEach(t=>r[t]=0);const i=d.qi.locToIndex(r,y,v),a=n.slice(-x);m.forEach(t=>a[t]=0);const o=d.qi.locToIndex(a,x,w),s=t(g[2*i],g[2*i+1],b[2*o],b[2*o+1]);f[e]=s.real,h[e]=s.imag}return[f,h,s]}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const td=$l((t,e)=>t+e),ed=Ql((t,e,n,r)=>({real:t+n,imag:e+r})),nd=Zl(d.h,td,ed),rd={kernelName:d.h,backendName:"cpu",kernelFunc:nd};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function id(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{shape:a}=r,o=d.qi.sizeFromShape(i.shape),s=d.qi.inferFromImplicitShape(a,o),u=d.qi.sizeFromShape(s);d.qi.assert(o===u,()=>`The new shape (${s}) has ${u} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(i.dataId);const c=n.data.get(i.dataId);if(null!=c.complexTensorInfos){const t=c.complexTensorInfos.real,e=c.complexTensorInfos.imag;t.shape=s,e.shape=s}return{dataId:i.dataId,shape:s,dtype:i.dtype}}const ad={kernelName:d.Cc,backendName:"cpu",kernelFunc:id};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function od(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:a}=e,{transposeA:o,transposeB:s}=r;Al([i,a],"matMul");const u=i.shape.length,c=a.shape.length,l=o?i.shape[u-2]:i.shape[u-1],f=s?a.shape[c-1]:a.shape[c-2],h=o?i.shape[u-1]:i.shape[u-2],p=s?a.shape[c-2]:a.shape[c-1],m=i.shape.slice(0,-2),g=a.shape.slice(0,-2),b=d.qi.sizeFromShape(m),y=d.qi.sizeFromShape(g),v=b===y||1===b||1===y;d.qi.assert(u>=2&&c>=2&&v,()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${m}) and (${g}).`);const x=(b>y?i.shape.slice(0,-2):a.shape.slice(0,-2)).concat([h,p]);d.qi.assert(l===f,()=>`Error in matMul: inner shapes (${l}) and (${f}) of Tensors with shapes ${i.shape} and ${a.shape} and transposeA=${o} and transposeB=${s} must match.`);const w=s?[y,p,f]:[y,f,p],k=id({inputs:{x:i},backend:n,attrs:{shape:o?[b,l,h]:[b,h,l]}}),O=id({inputs:{x:a},backend:n,attrs:{shape:w}}),_=o?k.shape[1]:k.shape[2],A=o?k.shape[2]:k.shape[1],C=s?O.shape[1]:O.shape[2],E=Math.max(b,y),S=n.data.get(k.dataId).values,j=n.data.get(O.dataId).values,N=d.qi.computeStrides(k.shape),T=d.qi.computeStrides(O.shape),[F,D,I]=o?[N[0],1,N[1]]:[N[0],N[1],1],[M,$,R]=s?[1,T[1],T[0]]:[T[1],1,T[0]],B=A*C,z=Object(d.Wd)([E,A,C],k.dtype),L=z.values,P=n.blockSize;for(let t=0;t<E;t++)for(let e=0;e<A;e+=P)for(let n=0;n<C;n+=P)for(let r=0;r<_;r+=P){const i=Math.min(e+P,A),a=Math.min(n+P,C),o=Math.min(r+P,_);for(let s=e;s<i;s++)for(let e=n;e<a;e++){let n=0;for(let i=r;i<o;i++){const r=Math.min(t,b-1)*F,a=Math.min(t,y-1)*R;n+=S[r+s*D+i*I]*j[i*M+e*$+a]}L[t*B+(s*C+e)]+=n}}return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(O),n.makeTensorInfo(x,z.dtype,z.values)}const sd={kernelName:d.w,backendName:"cpu",kernelFunc:od};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ud={kernelName:d.sd,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:a,bias:o,preluActivationWeights:s}=e,{transposeA:u,transposeB:c,activation:l,leakyreluAlpha:d}=r;let f,h,p;const m=[];f=od({inputs:{a:i,b:a},attrs:{transposeA:u,transposeB:c},backend:n}),o&&(h=nd({inputs:{a:f,b:o},backend:n}),m.push(f),f=h),l&&(p=Ul(n,f,l,s,d),m.push(f),f=p);for(const t of m)n.disposeIntermediateTensorInfo(t);return f}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cd(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const ld={kernelName:d.a,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend;Al(e,"abs");let r=new Float32Array(d.qi.sizeFromShape(e.shape));return r=cd(n.data.get(e.dataId).values),n.makeOutput(r,e.shape,"float32")}},dd=Sl(d.b,t=>Math.acos(t)),fd={kernelName:d.b,backendName:"cpu",kernelFunc:dd},hd=Sl(d.c,t=>Math.acosh(t)),pd={kernelName:d.c,backendName:"cpu",kernelFunc:hd};const md={kernelName:d.i,backendName:"cpu",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n}=t,r=e;Al(e,"addN");const i=r.map(t=>n.data.get(t.dataId).values),a=Object(d.Wd)(r[0].shape,r[0].dtype),o=a.values;for(let t=0;t<r.length;t++){const e=i[t];for(let t=0;t<o.length;t++)o[t]+=e[t]}return n.makeTensorInfo(a.shape,a.dtype,a.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gd(t,e,n,r,i){const a=e.length,o=d.qi.sizeFromShape(e),s=d.qi.computeStrides(e),u=d.qi.computeStrides(i),c=d.qi.getTypedArrayFromDType(n,d.qi.sizeFromShape(i));for(let e=0;e<o;++e){const n=d.qi.indexToLoc(e,a,s),i=new Array(n.length);for(let t=0;t<i.length;t++)i[t]=n[r[t]];c[d.qi.locToIndex(i,a,u)]=t[e]}return c}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bd(t){const{inputs:e,attrs:n,backend:r}=t,{x:i}=e,{perm:a}=n;Al(i,"transpose");const o=i.shape.length,s=new Array(o);for(let t=0;t<s.length;t++)s[t]=i.shape[a[t]];const u=gd(r.data.get(i.dataId).values,i.shape,i.dtype,a,s);return{dataId:r.write(u,s,i.dtype),shape:s,dtype:i.dtype}}const yd={kernelName:d.md,backendName:"cpu",kernelFunc:bd};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vd={kernelName:d.j,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:o}=r;Al(i,"all");const s=d.qi.parseAxisParam(a,i.shape);let u=s;const c=d.Ld.getAxesPermutation(u,i.shape.length);let l=i;null!=c&&(l=bd({inputs:{x:i},backend:n,attrs:{perm:c}}),u=d.Ld.getInnerMostAxes(u.length,i.shape.length)),d.Ld.assertAxesAreInnerMostDims("all",u,l.shape.length);const[f,h]=d.Ld.computeOutAndReduceShapes(l.shape,u),p=d.qi.sizeFromShape(h),m=d.qi.makeZerosTypedArray(d.qi.sizeFromShape(f),l.dtype),g=n.data.get(l.dataId).values;for(let t=0;t<m.length;++t){const e=t*p;let n=g[e];for(let t=0;t<p;++t){const r=g[e+t];n=n&&r}m[t]=n}null!=c&&n.disposeIntermediateTensorInfo(l);const b=n.makeTensorInfo(f,l.dtype,m);if(o){const t=id({inputs:{x:b},backend:n,attrs:{shape:d.Ld.expandShapeToKeepDim(f,s)}});return n.disposeIntermediateTensorInfo(b),t}return b}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xd={kernelName:d.k,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:o}=r;Al(i,"any");const s=d.qi.parseAxisParam(a,i.shape);let u=s;const c=d.Ld.getAxesPermutation(u,i.shape.length);let l=i;null!=c&&(l=bd({inputs:{x:i},backend:n,attrs:{perm:c}}),u=d.Ld.getInnerMostAxes(u.length,i.shape.length)),d.Ld.assertAxesAreInnerMostDims("any",u,l.shape.length);const[f,h]=d.Ld.computeOutAndReduceShapes(l.shape,u),p=d.qi.sizeFromShape(h),m=d.qi.makeZerosTypedArray(d.qi.sizeFromShape(f),l.dtype),g=n.data.get(l.dataId).values;for(let t=0;t<m.length;++t){const e=t*p;let n=g[e];for(let t=0;t<p;++t){const r=g[e+t];n=n||r}m[t]=n}null!=c&&n.disposeIntermediateTensorInfo(l);const b=n.makeTensorInfo(f,l.dtype,m);if(o){const t=id({inputs:{x:b},backend:n,attrs:{shape:d.Ld.expandShapeToKeepDim(f,s)}});return n.disposeIntermediateTensorInfo(b),t}return b}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wd={kernelName:d.l,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a}=r;Al(i,"argMax");let o=d.qi.parseAxisParam(a,i.shape);const s=d.Ld.getAxesPermutation(o,i.shape.length);let u=i;const c=[];null!=s&&(u=bd({inputs:{x:i},backend:n,attrs:{perm:s}}),c.push(u),o=d.Ld.getInnerMostAxes(o.length,u.shape.length)),o=[o[0]],d.Ld.assertAxesAreInnerMostDims("argMax",o,u.shape.length);const[l,f]=d.Ld.computeOutAndReduceShapes(u.shape,o),h=d.qi.sizeFromShape(l),p=d.qi.makeZerosTypedArray(h,"int32"),m=d.qi.sizeFromShape(f),g=n.data.get(u.dataId).values;for(let t=0;t<p.length;++t){const e=t*m;let n=g[e],r=0;for(let t=0;t<m;++t){const i=g[e+t];i>n&&(n=i,r=t)}p[t]=r}return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(l,"int32",p)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kd={kernelName:d.m,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a}=r;Al(i,"argMin");let o=d.qi.parseAxisParam(a,i.shape);const s=d.Ld.getAxesPermutation(o,i.shape.length);let u=i;const c=[];null!=s&&(u=bd({inputs:{x:i},backend:n,attrs:{perm:s}}),c.push(u),o=d.Ld.getInnerMostAxes(o.length,u.shape.length)),o=[o[0]],d.Ld.assertAxesAreInnerMostDims("argMin",o,u.shape.length);const[l,f]=d.Ld.computeOutAndReduceShapes(u.shape,o),h=d.qi.sizeFromShape(l),p=d.qi.makeZerosTypedArray(h,"int32"),m=d.qi.sizeFromShape(f),g=n.data.get(u.dataId).values;for(let t=0;t<p.length;++t){const e=t*m;let n=g[e],r=0;for(let t=0;t<m;++t){const i=g[e+t];i<n&&(n=i,r=t)}p[t]=r}return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(l,"int32",p)}},Od=Sl(d.n,t=>Math.asin(t)),_d={kernelName:d.n,backendName:"cpu",kernelFunc:Od},Ad=Sl(d.o,t=>Math.asinh(t)),Cd={kernelName:d.o,backendName:"cpu",kernelFunc:Ad},Ed=Sl(d.p,t=>Math.atan(t)),Sd={kernelName:d.p,backendName:"cpu",kernelFunc:Ed},jd=$l((t,e)=>Math.atan2(t,e)),Nd=Zl(d.q,jd),Td={kernelName:d.q,backendName:"cpu",kernelFunc:Nd},Fd=Sl(d.r,t=>Math.atanh(t)),Dd={kernelName:d.r,backendName:"cpu",kernelFunc:Fd};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Id(t,e,n,r,i,a){const o=i.strideHeight,s=i.strideWidth,u=i.dilationHeight,c=i.dilationWidth,l=i.effectiveFilterHeight,f=i.effectiveFilterWidth,h=i.padInfo.top,p=i.padInfo.left,m="max"===a?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Object(d.Wd)(i.outShape,n),b=g.values,y=i.outShape[1]*i.outShape[2]*i.outShape[3],v=i.outShape[2]*i.outShape[3],x=i.outShape[3];for(let e=0;e<i.batchSize;++e){const n=e*y,d=e*r[0];for(let e=0;e<i.inChannels;++e)for(let g=0;g<i.outHeight;++g){const y=g*o-h,w=Math.max(0,y),k=Math.min(i.inHeight,l+y),O=n+g*v;for(let n=0;n<i.outWidth;++n){const o=n*s-p,l=Math.max(0,o),h=Math.min(i.inWidth,f+o);let g=m,y=0,v=0;for(let n=w;n<k;n+=u){const i=d+n*r[1];for(let n=l;n<h;n+=c){const o=t[i+n*r[2]+e];"max"===a&&o>g?g=o:"avg"===a&&(y+=o,v++)}if(isNaN(g))break}b[O+n*x+e]="avg"===a?y/v:g}}}return g}function Md(t,e,n,r,i=!1,a=!1){const o=Object(d.Wd)(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.top,m=r.padInfo.left,g=Object(d.Wd)(e,n,t);for(let t=0;t<r.batchSize;++t)for(let e=0;e<r.inChannels;++e)for(let n=0;n<r.outHeight;++n){const d=n*s-p;let b=d;for(;b<0;)b+=c;const y=Math.min(r.inHeight,f+d);for(let s=0;s<r.outWidth;++s){const f=s*u-m;let p=f;for(;p<0;)p+=l;const v=Math.min(r.inWidth,h+f);let x=Number.NEGATIVE_INFINITY,w=-1;for(let n=b;n<y;n+=c){const o=n-d;for(let s=p;s<v;s+=l){const u=s-f,c=g.get(t,n,s,e);c>x&&(x=c,w=i?a?((t*r.inHeight+n)*r.inWidth+s)*r.inChannels+e:(n*r.inWidth+s)*r.inChannels+e:o*h+u)}}o.set(w,t,n,s,e)}}return o}function $d(t,e,n,r,i,a){const o=i.strideDepth,s=i.strideHeight,u=i.strideWidth,c=i.dilationDepth,l=i.dilationHeight,f=i.dilationWidth,h=i.effectiveFilterDepth,p=i.effectiveFilterHeight,m=i.effectiveFilterWidth,g=i.padInfo.front,b=i.padInfo.top,y=i.padInfo.left,v="max"===a?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=Object(d.Wd)(i.outShape,n),w=x.values,k=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],O=i.outShape[2]*i.outShape[3]*i.outShape[4],_=i.outShape[3]*i.outShape[4],A=i.outShape[4];for(let e=0;e<i.batchSize;++e){const n=e*k,d=e*r[0];for(let e=0;e<i.inChannels;++e)for(let x=0;x<i.outDepth;++x){const k=x*o-g;let C=k;for(;C<0;)C+=c;const E=Math.min(i.inDepth,h+k),S=n+x*O;for(let n=0;n<i.outHeight;++n){const o=n*s-b;let h=o;for(;h<0;)h+=l;const g=Math.min(i.inHeight,p+o),x=S+n*_;for(let n=0;n<i.outWidth;++n){const o=n*u-y;let s=o;for(;s<0;)s+=f;const p=Math.min(i.inWidth,m+o),b=x+n*A;let k=v,O=0,_=0;for(let n=C;n<E;n+=c){const i=d+n*r[1];for(let n=h;n<g;n+=l){const o=i+n*r[2];for(let n=s;n<p;n+=f){const i=t[o+n*r[3]+e];if("max"===a&&i>k?k=i:"avg"===a&&(O+=i,_++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}w[b+e]="avg"===a?O/_:k}}}}return x}const Rd={kernelName:d.s,backendName:"cpu",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;Al(i,"avgPool");const{filterSize:a,strides:o,pad:s,dimRoundingMode:u}=r;d.qi.assert(d.Ld.eitherStridesOrDilationsAreOne(o,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const c=d.Ld.computePool2DInfo(i.shape,a,o,1,s,u);let l;if(1===c.filterWidth&&1===c.filterHeight&&d.qi.arraysEqual(c.inShape,c.outShape))l=Fl({inputs:{x:i},backend:n});else{const t=n.data.get(i.dataId).values,e=d.qi.computeStrides(i.shape),r=Id(t,i.shape,i.dtype,e,c,"avg");l=n.makeTensorInfo(c.outShape,i.dtype,r.values)}return l}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bd={kernelName:d.t,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:a,strides:o,pad:s,dimRoundingMode:u,dataFormat:c,dilations:l}=r;Al(i,"avgPool3d");let f=l;null==f&&(f=[1,1,1]);const h=d.Ld.computePool3DInfo(i.shape,a,o,f,s,u,c),p=$d(n.data.get(i.dataId).values,i.shape,i.dtype,d.qi.computeStrides(i.shape),h,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zd={kernelName:d.u,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a}=e,{filterSize:o,strides:s,pad:u,dilations:c,dimRoundingMode:l}=r;Al([i,a],"avgPool3DGrad");const f=d.Ld.computePool3DInfo(a.shape,o,s,c,u,l),h=f.strideDepth,p=f.strideHeight,m=f.strideWidth,g=f.filterDepth,b=f.filterHeight,y=f.filterWidth,v=f.dilationDepth,x=f.dilationHeight,w=f.dilationWidth,k=f.effectiveFilterDepth,O=f.effectiveFilterHeight,_=f.effectiveFilterWidth,A=k-1-f.padInfo.front,C=_-1-f.padInfo.left,E=O-1-f.padInfo.top,S=Object(d.Wd)(a.shape,"float32"),j=1/(g*b*y),N=n.bufferSync(i);for(let t=0;t<f.batchSize;++t)for(let e=0;e<f.inChannels;++e)for(let n=0;n<f.inDepth;++n)for(let r=0;r<f.inHeight;++r)for(let i=0;i<f.inWidth;++i){const a=n-A,o=r-E,s=i-C;let u=0;for(let n=0;n<k;n+=v){const r=(a+n)/h;if(!(r<0||r>=f.outDepth||Math.floor(r)!==r))for(let n=0;n<O;n+=x){const i=(o+n)/p;if(!(i<0||i>=f.outHeight||Math.floor(i)!==i))for(let n=0;n<_;n+=w){const a=(s+n)/m;if(a<0||a>=f.outWidth||Math.floor(a)!==a)continue;u+=N.get(t,r,i,a,e)}}}S.set(u*j,t,n,r,i,e)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ld={kernelName:d.v,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a}=e,o=a;Al([i,a],"avgPoolGrad");const{filterSize:s,strides:u,pad:c}=r,l=d.Ld.computePool2DInfo(o.shape,s,u,1,c),f=l.strideHeight,h=l.strideWidth,p=l.filterHeight,m=l.filterWidth,g=l.dilationHeight,b=l.dilationWidth,y=l.effectiveFilterHeight,v=l.effectiveFilterWidth,x=v-1-l.padInfo.left,w=y-1-l.padInfo.top,k=Object(d.Wd)(o.shape,"float32"),O=1/(p*m),_=n.data.get(i.dataId).values,A=Object(d.Wd)(i.shape,"float32",_);for(let t=0;t<l.batchSize;++t)for(let e=0;e<l.inChannels;++e)for(let n=0;n<l.inHeight;++n)for(let r=0;r<l.inWidth;++r){const i=n-w,a=r-x;let o=0;for(let n=0;n<y;n+=g){const r=(i+n)/f;if(!(r<0||r>=l.outHeight||Math.floor(r)!==r))for(let n=0;n<v;n+=b){const i=(a+n)/h;if(i<0||i>=l.outWidth||Math.floor(i)!==i)continue;o+=A.get(t,r,i,e)}}k.set(o*O,t,n,r,e)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pd={kernelName:d.pb,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,scale:a,offset:o,mean:s,variance:u}=e;d.qi.assert(s.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),d.qi.assert(null==o||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),d.qi.assert(null==a||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Al([i,s,u,a,o],"batchNorm");let{varianceEpsilon:c}=r;null==c&&(c=.001);const l=n.data.get(i.dataId).values,f=n.data.get(s.dataId).values,h=n.data.get(u.dataId).values,p=a?n.data.get(a.dataId).values:new Float32Array([1]),m=o?n.data.get(o.dataId).values:new Float32Array([0]),g=new Float32Array(l.length),b=m.length,y=p.length,v=h.length,x=f.length;let w=0,k=0,O=0,_=0;for(let t=0;t<l.length;++t)g[t]=m[w++]+(l[t]-f[k++])*p[O++]/Math.sqrt(h[_++]+c),w>=b&&(w=0),k>=x&&(k=0),O>=y&&(O=0),_>=v&&(_=0);return n.makeTensorInfo(i.shape,i.dtype,g)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qd(t,e,n,r,i){const a=d.zh.isSliceContinous(r,e,n),o=d.qi.sizeFromShape(n),s=d.qi.computeStrides(r);if(a){const n=d.zh.computeFlatOffset(e,s);return"string"===i?t.slice(n,n+o):t.subarray(n,n+o)}const u="string"===i?d.Ld.fromUint8ToStringArray(t):t,c=Object(d.Wd)(r,i,u),l=Object(d.Wd)(n,i);for(let t=0;t<l.size;++t){const n=l.indexToLoc(t),r=n.map((t,n)=>t+e[n]);l.set(c.get(...r),...n)}return"string"===i?d.Ld.fromStringArrayToUint8(l.values):l.values}function Wd(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:a,size:o}=r;Al(i,"slice");const[s,u]=d.zh.parseSliceParams(i,a,o);d.zh.assertParamsValid(i,s,u);const c=qd(n.data.get(i.dataId).values,s,u,i.shape,i.dtype);return n.makeTensorInfo(u,i.dtype,c)}const Ud={kernelName:d.Tc,backendName:"cpu",kernelFunc:Wd};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vd={kernelName:d.x,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:a,crops:o}=r;Al([i],"batchToSpaceND");const s=a.reduce((t,e)=>t*e),u=d.Ld.getReshaped(i.shape,a,s),c=d.Ld.getPermuted(u.length,a.length),l=d.Ld.getReshapedPermuted(i.shape,a,s),f=d.Ld.getSliceBeginCoords(o,a.length),h=d.Ld.getSliceSize(l,o,a.length),p=id({inputs:{x:i},backend:n,attrs:{shape:u}}),m=bd({inputs:{x:p},backend:n,attrs:{perm:c}}),g=id({inputs:{x:m},backend:n,attrs:{shape:l}}),b=Wd({inputs:{x:g},backend:n,attrs:{begin:f,size:h}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),b}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gd(t,e,n,r,i){const a=d.qi.sizeFromShape(r),o=d.qi.makeZerosTypedArray(i,n);for(let n=0;n<t.length;n++){const r=t[n];if(r<0)throw new Error("Input x must be non-negative!");r>=i||(o[r]+=a>0?e[n]:1)}return o}function Hd(t,e,n,r=!1){const i=t.shape[0],a=t.shape[1],o=Object(d.Wd)([i,n],e.dtype);for(let s=0;s<i;s++)for(let i=0;i<a;i++){const a=t.get(s,i);if(a<0)throw new Error("Input x must be non-negative!");a>=n||(r?o.set(1,s,a):e.size>0?o.set(o.get(s,a)+e.get(s,i),s,a):o.set(o.get(s,a)+1,s,a))}return o}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xd={kernelName:d.y,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:a}=e,{size:o}=r,s=Gd(n.data.get(i.dataId).values,n.data.get(a.dataId).values,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,s)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kd(t){return(e,n,r)=>{const i=d.qi.getTypedArrayFromDType(n,e.length);for(let n=0;n<e.length;++n)i[n]=t(e[n],r);return i}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yd=Kd(t=>Math.ceil(t)),Jd=jl(d.B,Yd),Zd={kernelName:d.B,backendName:"cpu",kernelFunc:Jd},Qd=Sl(d.C,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),tf={kernelName:d.C,backendName:"cpu",kernelFunc:Qd},ef={kernelName:d.E,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(d.qi.sizeFromShape(e.shape)),i=n.data.get(e.dataId),a=i.complexTensorInfos.real,o=i.complexTensorInfos.imag,s=n.data.get(a.dataId).values,u=n.data.get(o.dataId).values;for(let t=0;t<s.length;t++){const e=s[t],n=u[t];r[t]=Math.hypot(e,n)}return n.makeOutput(r,e.shape,"float32")}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function nf(t,e,n,r){const i=d.qi.getArrayFromDType(n,d.qi.sizeFromShape(e));if(r&&"string"!==n){let e=0;t.forEach(t=>{const n=d.qi.sizeFromShape(t.shape);i.set(t.vals,e),e+=n})}else{let r=0;t.forEach(t=>{const a="string"===n?d.Ld.fromUint8ToStringArray(t.vals):t.vals;let o=0;for(let n=0;n<t.shape[0];++n){const s=n*e[1]+r;for(let e=0;e<t.shape[1];++e)i[s+e]=a[o++]}r+=t.shape[1]})}return i}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rf(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.data.get(r.dataId).complexTensorInfos.imag,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}const af={kernelName:d.yb,backendName:"cpu",kernelFunc:rf};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function of(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r,a=d.qi.parseAxisParam(i,e[0].shape)[0];let o=d.Ld.computeOutShape(e.map(t=>t.shape),a);if(0===d.qi.sizeFromShape(o))return n.makeTensorInfo(o,e[0].dtype,[]);const s=e.filter(t=>d.qi.sizeFromShape(t.shape)>0);if(1===s.length)return Fl({inputs:{x:s[0]},backend:n});const u=s.map(t=>t.shape);if(d.Ld.assertParamsConsistent(u,a),"complex64"===s[0].dtype){const t=s.map(t=>Xl({inputs:{input:t},backend:n})),e=s.map(t=>rf({inputs:{input:t},backend:n})),r=of({inputs:t,backend:n,attrs:{axis:a}}),i=of({inputs:e,backend:n,attrs:{axis:a}}),o=Vl({inputs:{real:r,imag:i},backend:n});return t.forEach(t=>n.disposeIntermediateTensorInfo(t)),e.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),o}const c=s.map(t=>{const e=d.qi.sizeFromShape(t.shape.slice(a));return id({inputs:{x:t},backend:n,attrs:{shape:[-1,e]}})}),l=c.map(t=>({vals:n.data.get(t.dataId).values,shape:t.shape}));o=d.Ld.computeOutShape(c.map(t=>t.shape),1);const f=1===c[0].shape[0],h=nf(l,o,e[0].dtype,f),p=d.Ld.computeOutShape(s.map(t=>t.shape),a),m=n.makeTensorInfo(p,e[0].dtype,h);return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),m}const sf={kernelName:d.F,backendName:"cpu",kernelFunc:of};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uf(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a}=e,{strides:o,pad:s,dataFormat:u,dilations:c,dimRoundingMode:l}=r;Al([i,a],"conv2d");const f=d.Ld.convertConv2DDataFormat(u),h=d.Ld.computeConv2DInfo(i.shape,a.shape,o,c,s,l,!1,f),p=h.filterHeight,m=h.filterWidth,g=h.dilationHeight,b=h.dilationWidth,y=h.padInfo.left,v=h.padInfo.top,x="channelsLast"===h.dataFormat,w=new d.jd(h.outShape,i.dtype),k=d.qi.computeStrides(i.shape),O=d.qi.computeStrides(a.shape),_=k[0],A=x?k[1]:k[2],C=x?k[2]:1,E=x?1:k[1],S=w.strides[0],j=x?w.strides[1]:w.strides[2],N=x?w.strides[2]:1,T=x?1:w.strides[1],F=n.data.get(i.dataId).values,D=n.data.get(a.dataId).values,I=w.values;for(let t=0;t<h.batchSize;++t){const e=t*_,n=t*S;for(let t=0;t<h.outHeight;++t){const r=n+t*j,i=t*h.strideHeight-v;for(let t=0;t<p;++t){const n=i+t*g;if(n<0||n>=h.inHeight)continue;const a=t*O[0],o=e+n*A;for(let t=0;t<h.outWidth;++t){const e=r+t*N,n=t*h.strideWidth-y;for(let t=0;t<m;++t){const r=n+t*b;if(r<0||r>=h.inWidth)continue;const i=o+r*C;let s=a+t*O[1];for(let t=0;t<h.inChannels;++t){const n=F[i+t*E];for(let t=0;t<h.outChannels;++t)I[e+t*T]+=n*D[s+t];s+=h.outChannels}}}}}}return n.makeTensorInfo(w.shape,w.dtype,I)}const cf={kernelName:d.G,backendName:"cpu",kernelFunc:uf};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lf={kernelName:d.H,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:a}=e,{strides:o,pad:s,dataFormat:u,dimRoundingMode:c,filterShape:l}=r;Al([i,a],"conv2dBackpropFilter");const f=d.Ld.convertConv2DDataFormat(u),h=d.Ld.computeConv2DInfo(i.shape,l,o,1,s,c,!1,f),{strideHeight:p,strideWidth:m,filterHeight:g,filterWidth:b}=h,y="channelsLast"===h.dataFormat,v=new d.jd(h.filterShape,"float32"),x=h.padInfo.left,w=h.padInfo.top,k=n.data.get(i.dataId).values,O=n.data.get(a.dataId).values,_=new d.jd(i.shape,i.dtype,k),A=new d.jd(a.shape,a.dtype,O);for(let t=0;t<g;++t){const e=Math.max(0,Math.ceil((w-t)/p)),n=Math.min(h.outHeight,(h.inHeight+w-t)/p);for(let r=0;r<b;++r){const i=Math.max(0,Math.ceil((x-r)/m)),a=Math.min(h.outWidth,(h.inWidth+x-r)/m);for(let o=0;o<h.inChannels;++o)for(let s=0;s<h.outChannels;++s){let u=0;for(let c=0;c<h.batchSize;++c)for(let l=e;l<n;++l){const e=t+l*p-w;for(let t=i;t<a;++t){const n=r+t*m-x;u+=y?_.get(c,e,n,o)*A.get(c,l,t,s):_.get(c,o,e,n)*A.get(c,s,l,t)}}v.set(u,t,r,o,s)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const df={kernelName:d.I,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:a}=e,{inputShape:o,strides:s,pad:u,dataFormat:c,dimRoundingMode:l}=r;Al([i,a],"conv2dBackpropInput");const f=d.qi.computeStrides(a.shape),h=d.qi.computeStrides(i.shape);let p=d.Ld.convertConv2DDataFormat(c);const m=d.Ld.computeConv2DInfo(o,a.shape,s,1,u,l,!1,p),g=new d.jd(m.inShape,"float32"),b=g.values,y=n.data.get(i.dataId).values,v=n.data.get(a.dataId).values,[x,w,k]=f,{batchSize:O,filterHeight:_,filterWidth:A,inChannels:C,inHeight:E,inWidth:S,outChannels:j,outHeight:N,outWidth:T,strideHeight:F,strideWidth:D}=m;p=m.dataFormat;const I=_-1-m.padInfo.top,M=A-1-m.padInfo.left,$="channelsLast"===p,R=g.strides[0],B=$?g.strides[1]:g.strides[2],z=$?g.strides[2]:1,L=$?1:g.strides[1],P=h[0],q=$?h[1]:h[2],W=$?h[2]:1,U=$?1:h[1];for(let t=0;t<O;++t)for(let e=0;e<C;++e)for(let n=0;n<E;++n){const r=n-I,i=Math.max(0,Math.ceil(r/F)),a=Math.min(N,(_+r)/F);for(let o=0;o<S;++o){const s=o-M,u=Math.max(0,Math.ceil(s/D)),c=Math.min(T,(A+s)/D);let l=0;for(let n=i;n<a;++n){const i=n*F-r;for(let r=u;r<c;++r){const a=P*t+q*n+W*r,o=x*(_-1-i)+w*(A-1-(r*D-s))+k*e;for(let t=0;t<j;++t){l+=y[a+U*t]*v[o+t]}}}b[R*t+B*n+z*o+L*e]=l}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ff={kernelName:d.J,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a}=e,{strides:o,pad:s,dilations:u}=r;Al([i,a],"conv3d");const c=d.Ld.computeConv3DInfo(i.shape,a.shape,o,u,s),{filterDepth:l,filterHeight:f,filterWidth:h,dilationDepth:p,dilationHeight:m,dilationWidth:g,padInfo:b}=c,y=b.front,v=b.left,x=b.top,w=new d.jd(c.outShape,i.dtype),k=n.data.get(i.dataId).values,O=n.data.get(a.dataId).values,_=w.values,A=d.qi.computeStrides(i.shape),C=d.qi.computeStrides(a.shape);for(let t=0;t<c.batchSize;++t){const e=t*A[0],n=t*w.strides[0];for(let t=0;t<c.outDepth;++t){const r=n+t*w.strides[1],i=t*c.strideDepth-y;for(let t=0;t<l;++t){const n=i+t*p;if(n<0||n>=c.inDepth)continue;const a=t*C[0],o=e+n*A[1];for(let t=0;t<c.outHeight;++t){const e=r+t*w.strides[2],n=t*c.strideHeight-x;for(let t=0;t<f;++t){const r=n+t*m;if(r<0||r>=c.inHeight)continue;const i=a+t*C[1],s=o+r*A[2];for(let t=0;t<c.outWidth;++t){const n=e+t*c.outChannels,r=t*c.strideWidth-v;for(let t=0;t<h;++t){const e=r+t*g;if(e<0||e>=c.inWidth)continue;const a=i+t*C[2],o=s+e*c.inChannels;let u=a;for(let t=0;t<c.inChannels;++t){const e=k[o+t];for(let t=0;t<c.outChannels;++t)_[n+t]+=e*O[u+t];u+=c.outChannels}}}}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hf={kernelName:d.K,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:a}=e,{strides:o,pad:s,filterShape:u}=r;Al([i,a],"conv3dBackpropFilterV2");const c=d.qi.computeStrides(i.shape),l=d.qi.computeStrides(a.shape),f=d.Ld.computeConv3DInfo(i.shape,u,o,1,s),h=f.strideDepth,p=f.strideHeight,m=f.strideWidth,g=f.filterDepth,b=f.filterHeight,y=f.filterWidth,v=new d.jd(f.filterShape,"float32"),x=v.values,[w,k,O,_]=v.strides,A=n.data.get(a.dataId).values,[C,E,S,j]=l,N=n.data.get(i.dataId).values,[T,F,D,I]=c,M=f.padInfo.front,$=f.padInfo.left,R=f.padInfo.top;for(let t=0;t<g;++t){const e=Math.max(0,Math.ceil((M-t)/h)),n=Math.min(f.outDepth,(f.inDepth+M-t)/h),r=t*w;for(let i=0;i<b;++i){const a=Math.max(0,Math.ceil((R-i)/p)),o=Math.min(f.outHeight,(f.inHeight+R-i)/p),s=i*k+r;for(let r=0;r<y;++r){const u=Math.max(0,Math.ceil(($-r)/m)),c=Math.min(f.outWidth,(f.inWidth+$-r)/m),l=r*O+s;for(let s=0;s<f.inChannels;++s){const d=s*_+l;for(let l=0;l<f.outChannels;++l){let g=0;for(let d=0;d<f.batchSize;++d){const f=d*T,b=d*C;for(let d=e;d<n;++d){const e=(t+d*h-M)*F+f,n=d*E+b;for(let t=a;t<o;++t){const a=(i+t*p-R)*D+e,o=t*S+n;for(let t=u;t<c;++t){const e=t*j+o;g+=N[(r+t*m-$)*I+a+s]*A[e+l]}}}}x[d+l]=g}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pf={kernelName:d.L,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:a}=e,{pad:o,strides:s,inputShape:u}=r;Al([i],"conv3dBackpropInputV2");const c=d.qi.computeStrides(i.shape),l=d.qi.computeStrides(a.shape),f=d.Ld.computeConv3DInfo(u,a.shape,s,1,o),h=new d.jd(f.inShape,"float32"),p=h.values,[m,g,b,y]=h.strides,v=n.data.get(i.dataId).values,[x,w,k,O]=c,_=n.data.get(a.dataId).values,[A,C,E,S]=l,{batchSize:j,filterDepth:N,filterHeight:T,filterWidth:F,inChannels:D,inDepth:I,inHeight:M,inWidth:$,outChannels:R,outDepth:B,outHeight:z,outWidth:L,strideDepth:P,strideHeight:q,strideWidth:W}=f,U=N-1-f.padInfo.front,V=T-1-f.padInfo.top,G=F-1-f.padInfo.left;for(let t=0;t<j;++t)for(let e=0;e<D;++e)for(let n=0;n<I;++n){const r=n-U,i=Math.max(0,Math.ceil(r/P)),a=Math.min(B,(N+r)/P);for(let o=0;o<M;++o){const s=o-V,u=Math.max(0,Math.ceil(s/q)),c=Math.min(z,(T+s)/q);for(let l=0;l<$;++l){const d=l-G,f=Math.max(0,Math.ceil(d/W)),h=Math.min(L,(F+d)/W);let j=0;for(let n=i;n<a;++n){const i=n*P-r;for(let r=u;r<c;++r){const a=r*q-s;for(let o=f;o<h;++o){const s=x*t+w*n+k*r+O*o,u=A*(N-1-i)+C*(T-1-a)+E*(F-1-(o*W-d))+S*e;for(let t=0;t<R;++t){j+=v[s+t]*_[u+t]}}}}p[m*t+g*n+b*o+y*l+e]=j}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}},mf=Sl(d.M,t=>Math.cos(t)),gf={kernelName:d.M,backendName:"cpu",kernelFunc:mf},bf=Sl(d.N,t=>Math.cosh(t)),yf={kernelName:d.N,backendName:"cpu",kernelFunc:bf};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vf={kernelName:d.O,backendName:"cpu",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n,attrs:r}=t,{image:i,boxes:a,boxInd:o}=e,{cropSize:s,method:u,extrapolationValue:c}=r,[l,f,h,p]=i.shape,m=a.shape[0],[g,b]=s,y=Object(d.Wd)([m,g,b,p],"float32"),v=n.data.get(a.dataId).values,x=n.data.get(o.dataId).values,w=n.data.get(i.dataId).values,k=d.qi.computeStrides(i.shape),O=d.qi.computeStrides(y.shape);for(let t=0;t<m;t++){const e=4*t,n=v[e],r=v[e+1],i=v[e+2],a=v[e+3],o=x[t];if(o>=l)continue;const s=g>1?(i-n)*(f-1)/(g-1):0,d=b>1?(a-r)*(h-1)/(b-1):0;for(let e=0;e<g;e++){const l=g>1?n*(f-1)+e*s:.5*(n+i)*(f-1);if(l<0||l>f-1)for(let n=0;n<b;n++)for(let r=0;r<p;r++){const i=r+n*O[2]+e*O[1]+t*O[0];y.values[i]=c}else if("bilinear"===u){const n=Math.floor(l),i=Math.ceil(l),s=l-n;for(let u=0;u<b;u++){const l=b>1?r*(h-1)+u*d:.5*(r+a)*(h-1);if(l<0||l>h-1){for(let n=0;n<p;n++){const r=n+u*O[2]+e*O[1]+t*O[0];y.values[r]=c}continue}const f=Math.floor(l),m=Math.ceil(l),g=l-f;for(let r=0;r<p;r++){let a=r+f*k[2]+n*k[1]+o*k[0];const c=w[a];a=r+m*k[2]+n*k[1]+o*k[0];const l=w[a];a=r+f*k[2]+i*k[1]+o*k[0];const d=w[a];a=r+m*k[2]+i*k[1]+o*k[0];const h=c+(l-c)*g,p=d+(w[a]-d)*g;a=r+u*O[2]+e*O[1]+t*O[0],y.values[a]=h+(p-h)*s}}}else for(let n=0;n<b;++n){const i=b>1?r*(h-1)+n*d:.5*(r+a)*(h-1);if(i<0||i>h-1){for(let r=0;r<p;r++){const i=r+n*O[2]+e*O[1]+t*O[0];y.values[i]=c}continue}const s=Math.round(i),u=Math.round(l);for(let r=0;r<p;r++){const i=r+s*k[2]+u*k[1]+o*k[0],a=r+n*O[2]+e*O[1]+t*O[0];y.values[a]=w[i]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xf={kernelName:d.P,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,exclusive:o,reverse:s}=r;Al(i,"cumsum");const u=d.Ld.getAxesPermutation([a],i.shape.length);let c=i;null!=u&&(c=bd({inputs:{x:i},backend:n,attrs:{perm:u}}));const l=d.Ld.getInnerMostAxes(1,i.shape.length)[0];if(l!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${l}`);const f=Object(d.pi)(c.dtype,"int32"),h=d.qi.makeZerosTypedArray(d.qi.sizeFromShape(c.shape),f),p=n.data.get(c.dataId).values,m=c.shape[c.shape.length-1],g=s?(t,e)=>t+m-e-1:(t,e)=>t+e;for(let t=0;t<p.length;t+=m)for(let e=0;e<m;e++){const n=g(t,e);if(0===e)h[n]=o?0:p[n];else{const r=g(t,e-1);h[n]=o?p[r]+h[r]:p[n]+h[r]}}const b=n.makeTensorInfo(c.shape,f,h);if(null!=u){const t=bd({inputs:{x:b},backend:n,attrs:{perm:d.Ld.getUndoAxesPermutation(u)}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(c),t}return b}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wf={kernelName:d.R,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:a}=e,{size:o,binaryOutput:s}=r;if(1===i.shape.length){const t=Gd(n.data.get(i.dataId).values,n.data.get(a.dataId).values,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,t)}if(2===i.shape.length){const t=Hd(n.bufferSync(i),n.bufferSync(a),o,s);return n.makeTensorInfo(t.shape,a.dtype,t.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+i.shape.length+".")}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kf={kernelName:d.S,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockSize:a,dataFormat:o}=r;d.qi.assert("NHWC"===o,()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o),d.qi.assert(a>1,()=>"blockSize should be > 1 for depthToSpace, but was: "+a);const s=i.shape[0],u=i.shape[1],c=i.shape[2],l=i.shape[3],f=u*a,h=c*a,p=l/(a*a),m=n.data.get(i.dataId).values,g=new Float32Array(s*f*h*p);let b=0;for(let t=0;t<s;++t)for(let e=0;e<f;++e){const n=Math.floor(e/a),r=e%a;for(let e=0;e<h;++e){const i=Math.floor(e/a),o=(r*a+e%a)*p;for(let e=0;e<p;++e){const r=e+o+l*(i+c*(n+u*t));g[b++]=m[r]}}}return n.makeTensorInfo([s,f,h,p],i.dtype,g)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Of(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a}=e,{strides:o,pad:s,dilations:u,dimRoundingMode:c}=r;Al([i,a],"depthwiseConv2DNative");const l=d.qi.computeStrides(i.shape),f=d.qi.computeStrides(a.shape);let h=u;null==h&&(h=[1,1]),d.qi.assert(d.Ld.eitherStridesOrDilationsAreOne(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const p=d.Ld.computeConv2DInfo(i.shape,a.shape,o,h,s,c,!0),{filterHeight:m,filterWidth:g,dilationHeight:b,dilationWidth:y,padInfo:v}=p,x=v.left,w=v.top,k=p.outChannels/p.inChannels,O=new d.jd(p.outShape,i.dtype),_=n.data.get(i.dataId).values,A=n.data.get(a.dataId).values,C=O.values;for(let t=0;t<p.batchSize;++t){const e=t*l[0],n=t*O.strides[0];for(let t=0;t<p.outHeight;++t){const r=n+t*O.strides[1],i=t*p.strideHeight-x;for(let t=0;t<m;++t){const n=i+t*b;if(n<0||n>=p.inHeight)continue;const a=t*f[0],o=e+n*l[1];for(let t=0;t<p.outWidth;++t){const e=r+t*O.strides[2],n=t*p.strideWidth-w;for(let t=0;t<g;++t){const r=n+t*y;if(r<0||r>=p.inWidth)continue;const i=a+t*f[1],s=o+r*p.inChannels;let u=e,c=i;for(let t=0;t<p.inChannels;++t){const e=_[s+t];for(let t=0;t<k;++t)C[u+t]+=e*A[c+t];u+=k,c+=k}}}}}}return n.makeTensorInfo(O.shape,O.dtype,O.values)}const _f={kernelName:d.T,backendName:"cpu",kernelFunc:Of};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Af={kernelName:d.U,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:a}=e,{strides:o,dilations:s,pad:u,dimRoundingMode:c,filterShape:l}=r;Al([i,a],"depthwiseConv2dNativeBackpropFilter");const f=d.Ld.computeConv2DInfo(i.shape,l,o,s,u,c,!0),{strideHeight:h,strideWidth:p,filterHeight:m,filterWidth:g}=f,b=new d.jd(f.filterShape,"float32"),y=f.padInfo.left,v=f.padInfo.top,x=f.outChannels/f.inChannels,w=n.data.get(i.dataId).values,k=new d.jd(i.shape,i.dtype,w),O=n.data.get(a.dataId).values,_=new d.jd(a.shape,a.dtype,O);for(let t=0;t<m;++t){const e=Math.max(0,Math.ceil((v-t)/h)),n=Math.min(f.outHeight,(f.inHeight+v-t)/h);for(let r=0;r<g;++r){const i=Math.max(0,Math.ceil((y-r)/p)),a=Math.min(f.outWidth,(f.inWidth+y-r)/p);for(let o=0;o<f.outChannels;++o){const s=Math.trunc(o/x),u=o%x;let c=0;for(let u=0;u<f.batchSize;++u)for(let l=e;l<n;++l){const e=t+l*h-v;for(let t=i;t<a;++t){const n=r+t*p-y;c+=k.get(u,e,n,s)*_.get(u,l,t,o)}}b.set(c,t,r,s,u)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cf={kernelName:d.V,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:a}=e,{strides:o,dilations:s,pad:u,dimRoundingMode:c,inputShape:l}=r;Al([i,a],"depthwiseConv2DNativeBackpropInput");const f=d.qi.computeStrides(i.shape),h=d.qi.computeStrides(a.shape),p=d.Ld.computeConv2DInfo(l,a.shape,o,s,u,c,!0),m=new d.jd(p.inShape,"float32"),g=m.values,[b,y,v]=m.strides,x=n.data.get(i.dataId).values,[w,k,O]=f,_=n.data.get(a.dataId).values,[A,C,E]=h,{batchSize:S,filterHeight:j,filterWidth:N,inChannels:T,inHeight:F,inWidth:D,outChannels:I,outHeight:M,outWidth:$,strideHeight:R,strideWidth:B}=p,z=j-1-p.padInfo.top,L=N-1-p.padInfo.left,P=I/T;for(let t=0;t<S;++t)for(let e=0;e<T;++e)for(let n=0;n<F;++n){const r=n-z,i=Math.max(0,Math.ceil(r/R)),a=Math.min(M,(j+r)/R);for(let o=0;o<D;++o){const s=o-L,u=Math.max(0,Math.ceil(s/B)),c=Math.min($,(N+s)/B);let l=0;for(let n=i;n<a;++n){const i=n*R-r;for(let r=u;r<c;++r){const a=w*t+k*n+O*r,o=A*(j-1-i)+C*(N-1-(r*B-s))+E*e;for(let t=0;t<P;++t){l+=x[a+(e*P+t)]*_[o+t]}}}g[b*t+y*n+v*o+e]=l}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ef={kernelName:d.W,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e,i=d.qi.sizeFromShape(r.shape),a=n.data.get(r.dataId).values,o=Object(d.Wd)([i,i],r.dtype),s=o.values;for(let t=0;t<a.length;t++)s[t*i+t]=a[t];const u=[...r.shape,...r.shape];return n.makeTensorInfo(u,o.dtype,o.values)}},Sf={kernelName:d.X,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:i}=t,{strides:a,pad:o,dilations:s}=n,u=e,c=u.data.get(r.dataId).values,l=r.shape.length,f=u.data.get(i.dataId).values,h=i.shape.length,{batchSize:p,inHeight:m,inWidth:g,inChannels:b,outHeight:y,outWidth:v,padInfo:x,strideHeight:w,strideWidth:k,filterHeight:O,filterWidth:_,dilationHeight:A,dilationWidth:C,outShape:E}=d.Ld.computeDilation2DInfo(r.shape,i.shape,a,o,"NHWC",s),S=d.qi.sizeFromShape(E),j=E.length,N=d.qi.getArrayFromDType(r.dtype,S);for(let t=0;t<p;++t)for(let e=0;e<y;++e){const n=e*w-x.top;for(let a=0;a<v;++a){const o=a*k-x.left;for(let s=0;s<b;++s){let u=Number.MIN_SAFE_INTEGER;for(let e=0;e<O;++e){const a=n+e*A;if(a>=0&&a<m)for(let n=0;n<_;++n){const p=o+n*C;if(p>=0&&p<g){const o=d.qi.locToIndex([t,a,p,s],l,d.qi.computeStrides(r.shape)),m=d.qi.locToIndex([e,n,s],h,d.qi.computeStrides(i.shape)),g=c[o]+f[m];g>u&&(u=g)}}}N[d.qi.locToIndex([t,e,a,s],j,d.qi.computeStrides(E))]=u}}}return{dataId:u.write(d.qi.toTypedArray(N,r.dtype),E,r.dtype),shape:E,dtype:r.dtype}}},jf={kernelName:d.Y,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:i,dy:a}=t,{strides:o,pad:s,dilations:u}=n,c=e,l=d.qi.toNestedArray(r.shape,c.data.get(r.dataId).values),f=d.qi.toNestedArray(i.shape,c.data.get(i.dataId).values),{batchSize:h,inHeight:p,inWidth:m,inChannels:g,outHeight:b,outWidth:y,padInfo:v,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:O,dilationHeight:_,dilationWidth:A,outShape:C}=d.Ld.computeDilation2DInfo(r.shape,i.shape,o,s,"NHWC",u);d.qi.assert(a.rank===C.length,()=>`Error in ${d.Y}, dy must have the same rank as output ${C.length}, but got `+a.rank);const E=d.qi.toNestedArray(C,c.data.get(a.dataId).values),S=d.qi.makeZerosNestedTypedArray(i.shape,i.dtype);for(let t=0;t<h;++t)for(let e=0;e<b;++e){const n=e*x-v.top;for(let r=0;r<y;++r){const i=r*w-v.left;for(let a=0;a<g;++a){let o=Number.MIN_SAFE_INTEGER,s=0,u=0;for(let e=0;e<k;++e){const r=n+e*_;if(r>=0&&r<p)for(let n=0;n<O;++n){const c=i+n*A;if(c>=0&&c<m){const i=l[t][r][c][a]+f[e][n][a];i>o&&(o=i,s=e,u=n)}}}S[s][u][a]+=E[t][e][r][a]}}}return{dataId:c.write(d.qi.toTypedArray(S,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},Nf={kernelName:d.Z,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:i,dy:a}=t,{strides:o,pad:s,dilations:u}=n,c=e,l=d.qi.toNestedArray(r.shape,c.data.get(r.dataId).values),f=d.qi.toNestedArray(i.shape,c.data.get(i.dataId).values),{batchSize:h,inHeight:p,inWidth:m,inChannels:g,outHeight:b,outWidth:y,padInfo:v,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:O,dilationHeight:_,dilationWidth:A,outShape:C}=d.Ld.computeDilation2DInfo(r.shape,i.shape,o,s,"NHWC",u);d.qi.assert(a.rank===C.length,()=>`Error in ${d.Z}, dy must have the same rank as output ${C.length}, but got `+a.rank);const E=d.qi.toNestedArray(C,c.data.get(a.dataId).values),S=d.qi.makeZerosNestedTypedArray(r.shape,r.dtype);for(let t=0;t<h;++t)for(let e=0;e<b;++e){const n=e*x-v.top;for(let r=0;r<y;++r){const i=r*w-v.left;for(let a=0;a<g;++a){let o=Number.MIN_SAFE_INTEGER,s=n<0?0:n,u=i<0?0:i;for(let e=0;e<k;++e){const r=n+e*_;if(r>=0&&r<p)for(let n=0;n<O;++n){const c=i+n*A;if(c>=0&&c<m){const i=l[t][r][c][a]+f[e][n][a];i>o&&(o=i,s=r,u=c)}}}S[t][s][u][a]+=E[t][e][r][a]}}}return{dataId:c.write(d.qi.toTypedArray(S,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tf={kernelName:d.cb,backendName:"cpu",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n}=t,{dy:r,y:i}=e;Al([r,i],"eluGrad");const a=new Float32Array(d.qi.sizeFromShape(i.shape)),o=n.data.get(i.dataId).values,s=n.data.get(r.dataId).values;for(let t=0;t<o.length;++t){const e=o[t];a[t]=e>=1?s[t]:s[t]*(e+1)}return n.makeTensorInfo(i.shape,"float32",a)}},Ff=$l((t,e)=>t===e?1:0),Df=Zl(d.eb,Ff,null,"bool"),If={kernelName:d.eb,backendName:"cpu",kernelFunc:Df},Mf=d.Ld.ERF_P,$f=d.Ld.ERF_A1,Rf=d.Ld.ERF_A2,Bf=d.Ld.ERF_A3,zf=d.Ld.ERF_A4,Lf=d.Ld.ERF_A5,Pf=Sl(d.fb,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+Mf*n);return e*(1-((((Lf*r+zf)*r+Bf)*r+Rf)*r+$f)*r*Math.exp(-n*n))}),qf={kernelName:d.fb,backendName:"cpu",kernelFunc:Pf},Wf=Kd(t=>Math.exp(t)),Uf=jl(d.gb,Wf),Vf={kernelName:d.gb,backendName:"cpu",kernelFunc:Uf};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Gf(t){const{inputs:e,backend:n,attrs:r}=t,{input:i}=e,{dim:a}=r,o=i.shape.length,s=i.shape.slice();let u=a;return a<0&&(d.qi.assert(-(o+1)<=a,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),u=o+a+1),s.splice(u,0,1),id({inputs:{x:i},backend:n,attrs:{shape:s}})}const Hf={kernelName:d.hb,backendName:"cpu",kernelFunc:Gf},Xf=Kd(t=>Math.expm1(t)),Kf=jl(d.ib,Xf),Yf={kernelName:d.ib,backendName:"cpu",kernelFunc:Kf},Jf=$l((t,e)=>t*e),Zf=Ql((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),Qf=Zl(d.dc,Jf,Zf),th={kernelName:d.dc,backendName:"cpu",kernelFunc:Qf},eh=$l((t,e)=>t/e),nh=Zl(d.xc,eh),rh={kernelName:d.xc,backendName:"cpu",kernelFunc:nh},ih=$l((t,e)=>t-e),ah=Ql((t,e,n,r)=>({real:t-n,imag:e-r})),oh=Zl(d.ed,ih,ah),sh={kernelName:d.ed,backendName:"cpu",kernelFunc:oh};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function uh(t,e,n){const r=t.shape,i=r[0],a=r[1],o=n.data.get(t.dataId),s=o.complexTensorInfos.real,u=o.complexTensorInfos.imag,c=[i,a],l=d.qi.sizeFromShape(c),f=d.qi.getTypedArrayFromDType("float32",l),h=d.qi.getTypedArrayFromDType("float32",l);for(let t=0;t<i;t++){const r=Wd({inputs:{x:s},backend:n,attrs:{begin:[t,0],size:[1,a]}}),i=Wd({inputs:{x:u},backend:n,attrs:{begin:[t,0],size:[1,a]}}),o=Vl({inputs:{real:r,imag:i},backend:n}),{real:c,imag:l}=ch(o,e,n),p=d.Ld.mergeRealAndImagArrays(c,l);for(let e=0;e<a;e++){const n=d.Ld.getComplexWithIndex(p,e);f[t*a+e]=n.real,h[t*a+e]=n.imag}n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o)}const p=n.makeTensorInfo(c,"float32",f),m=n.makeTensorInfo(c,"float32",h),g=Vl({inputs:{real:p,imag:m},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}function ch(t,e,n){const r=d.qi.sizeFromShape(t.shape),i=n.data.get(t.dataId),a=n.data.get(i.complexTensorInfos.real.dataId).values,o=n.data.get(i.complexTensorInfos.imag.dataId).values;if(0==((s=r)&s-1)){const i=function t(e,n,r,i,a){if(1===r)return{real:e,imag:n};const o=d.Ld.mergeRealAndImagArrays(e,n),s=r/2,u=d.Ld.complexWithEvenIndex(o),c=u.real,l=u.imag,f=[c.length],h=a.makeTensorInfo(f,"float32",c),p=a.makeTensorInfo(f,"float32",l),m=Vl({inputs:{real:h,imag:p},backend:a}),g=d.Ld.complexWithOddIndex(o),b=g.real,y=g.imag,v=[b.length],x=a.makeTensorInfo(v,"float32",b),w=a.makeTensorInfo(v,"float32",y),k=Vl({inputs:{real:x,imag:w},backend:a}),O=t(c,l,s,i,a),_=O.real,A=O.imag,C=[_.length],E=a.makeTensorInfo(C,"float32",_),S=a.makeTensorInfo(C,"float32",A),j=Vl({inputs:{real:E,imag:S},backend:a}),N=t(b,y,s,i,a),T=N.real,F=N.imag,D=[T.length],I=a.makeTensorInfo(D,"float32",T),M=a.makeTensorInfo(D,"float32",F),$=Vl({inputs:{real:I,imag:M},backend:a}),R=d.Ld.exponents(r,i),B=[R.real.length],z=a.makeTensorInfo(B,"float32",R.real),L=a.makeTensorInfo(B,"float32",R.imag),P=Vl({inputs:{real:z,imag:L},backend:a}),q=Qf({inputs:{a:P,b:$},backend:a}),W=nd({inputs:{a:j,b:q},backend:a}),U=oh({inputs:{a:j,b:q},backend:a}),V=Xl({inputs:{input:W},backend:a}),G=Xl({inputs:{input:U},backend:a}),H=rf({inputs:{input:W},backend:a}),X=rf({inputs:{input:U},backend:a}),K=of({inputs:[V,G],backend:a,attrs:{axis:0}}),Y=of({inputs:[H,X],backend:a,attrs:{axis:0}}),J=a.data.get(K.dataId).values,Z=a.data.get(Y.dataId).values;return a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(m),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(w),a.disposeIntermediateTensorInfo(k),a.disposeIntermediateTensorInfo(E),a.disposeIntermediateTensorInfo(S),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(I),a.disposeIntermediateTensorInfo(M),a.disposeIntermediateTensorInfo($),a.disposeIntermediateTensorInfo(z),a.disposeIntermediateTensorInfo(L),a.disposeIntermediateTensorInfo(P),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(X),a.disposeIntermediateTensorInfo(K),a.disposeIntermediateTensorInfo(Y),{real:J,imag:Z}}(a,o,r,e,n),s=[t.shape[0],t.shape[1]];if(e){const t=n.makeTensorInfo(s,"float32",i.real),e=n.makeTensorInfo(s,"float32",i.imag),a=n.makeTensorInfo([],"float32",d.qi.createScalarValue(r,"float32")),o=Fl({inputs:{x:a},backend:n}),u=rh.kernelFunc({inputs:{a:t,b:a},backend:n}),c=rh.kernelFunc({inputs:{a:e,b:o},backend:n}),l=n.data.get(u.dataId).values,f=n.data.get(c.dataId).values;return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),{real:l,imag:f}}return i}{const t=function(t,e,n){const r=new Float32Array(2*e);for(let i=0;i<e;i++){let a=0,o=0;for(let r=0;r<e;r++){const s=d.Ld.exponent(i*r,e,n),u=d.Ld.getComplexWithIndex(t,r);a+=u.real*s.real-u.imag*s.imag,o+=u.real*s.imag+u.imag*s.real}n&&(a/=e,o/=e),d.Ld.assignToTypedArray(r,a,o,i)}return r}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(d.Ld.mergeRealAndImagArrays(a,o),r,e);return d.Ld.splitRealAndImagArrays(t)}var s}const lh={kernelName:d.jb,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e,i=d.qi.sizeFromShape(r.shape),a=r.shape[r.shape.length-1],o=id({inputs:{x:r},backend:n,attrs:{shape:[i/a,a]}}),s=uh(o,!1,n),u=id({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dh(t){const{backend:e,attrs:n}=t,{shape:r,value:i,dtype:a}=n,o=a||d.qi.inferDtype(i),s=d.qi.getArrayFromDType(o,d.qi.sizeFromShape(r));return function(t,e,n){t.fill(e)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(s,i),e.makeTensorInfo(r,o,s)}const fh={kernelName:d.kb,backendName:"cpu",kernelFunc:dh};const hh={kernelName:d.lb,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,i=n,a=d.qi.getTypedArrayFromDType(r.dtype,d.qi.sizeFromShape(r.shape)),[o,s,u,c]=r.shape,l=i.data.get(r.dataId).values;for(let t=0;t<o;t++){const e=t*u*s*c;for(let t=0;t<s;t++){const n=t*(u*c);for(let r=0;r<u;r++){const i=r*c;for(let s=0;s<c;s++){const d=[o,t,r,s][2],f=Math.round(u-d),h=e+n+i+s;let p=l[h];if(f>=0&&f<u){p=l[e+n+f*c+s]}a[h]=p}}}}return{dataId:i.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},ph=Kd(t=>Math.floor(t)),mh=jl(d.mb,ph),gh={kernelName:d.mb,backendName:"cpu",kernelFunc:mh},bh=$l((t,e)=>Math.floor(t/e)),yh=Zl(d.nb,bh,null,"int32"),vh={kernelName:d.nb,backendName:"cpu",kernelFunc:yh};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xh={kernelName:d.qb,backendName:"cpu",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a,bias:o,preluActivationWeights:s}=e,{strides:u,pad:c,dataFormat:l,dilations:d,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=r;let m=uf({inputs:{x:i,filter:a},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:d,dimRoundingMode:f}});if(o){const t=m;m=nd({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(t)}if(h){const t=m;m=Ul(n,m,h,s,p),n.disposeIntermediateTensorInfo(t)}return m}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wh={kernelName:d.rb,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a,bias:o,preluActivationWeights:s}=e,{strides:u,pad:c,dataFormat:l,dilations:d,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=r;let m=Of({inputs:{x:i,filter:a},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:d,dimRoundingMode:f}});if(o){const t=m;m=nd({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(t)}if(h){const t=m;m=Ul(n,m,h,s,p),n.disposeIntermediateTensorInfo(t)}return m}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kh={kernelName:d.sb,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{params:r,indices:i}=e,a=d.qi.sizeFromShape(r.shape),o=i.shape,s=o[o.length-1],[u,c,l,f]=d.Ld.prepareAndValidate(r,i);if(0===c)return n.makeTensorInfo(u,r.dtype,[]);const h=Object(d.Wd)([c,l],r.dtype),p=n.data.get(i.dataId).values,m=n.data.get(r.dataId).values;for(let t=0;t<c;t++){const e=[];let n=0;for(let r=0;r<s;r++){const i=p[t*s+r];n+=i*f[r],e.push(i)}if(n<0||n>=a/l)throw new Error(`Invalid indices: ${e} does not index into ${r.shape}`);for(let e=0;e<l;e++)h.values[t*l+e]=m[n*l+e]}return n.makeTensorInfo(u,h.dtype,h.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oh(t,e,n){const r=Object(d.Wd)(n,t.dtype);for(let n=0;n<r.size;++n){const i=r.indexToLoc(n).slice(),a=i[0],o=i[2],s=e.locToIndex([a,o]);i[2]=e.values[s];const u=t.locToIndex(i);r.values[n]=t.values[u]}return r}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _h={kernelName:d.tb,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,indices:a}=e,{axis:o,batchDims:s}=r;Al([i,a],"gatherV2");let u=s;null==s&&(u=0);const c=d.qi.sizeFromShape(a.shape),l=d.qi.parseAxisParam(o,i.shape)[0],f=d.Ld.segment_util.collectGatherOpShapeInfo(i,a,l,u),h=id({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),p=id({inputs:{x:a},backend:n,attrs:{shape:[f.batchSize,c/f.batchSize]}}),m=[f.batchSize,f.outerSize,c/f.batchSize,f.sliceSize],g=n.bufferSync(p),b=Oh(n.bufferSync(h),g,m);return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.makeTensorInfo(f.outputShape,b.dtype,b.values)}},Ah=$l((t,e)=>t>e?1:0),Ch=Zl(d.ub,Ah,null,"bool"),Eh={kernelName:d.ub,backendName:"cpu",kernelFunc:Ch},Sh=$l((t,e)=>t>=e?1:0),jh=Zl(d.vb,Sh,null,"bool"),Nh={kernelName:d.vb,backendName:"cpu",kernelFunc:jh};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Th={kernelName:d.wb,backendName:"cpu",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n}=t,{input:r}=e,i=d.qi.sizeFromShape(r.shape),a=r.shape[r.shape.length-1],o=id({inputs:{x:r},backend:n,attrs:{shape:[i/a,a]}}),s=uh(o,!0,n),u=id({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}},Fh=Sl(d.zb,t=>Number.isFinite(t)?1:0,"bool"),Dh={kernelName:d.zb,backendName:"cpu",kernelFunc:Fh},Ih=Sl(d.Ab,t=>Math.abs(t)===1/0?1:0,"bool"),Mh={kernelName:d.Ab,backendName:"cpu",kernelFunc:Ih},$h=Sl(d.Bb,t=>Number.isNaN(t)?1:0,"bool"),Rh={kernelName:d.Bb,backendName:"cpu",kernelFunc:$h},Bh=$l((t,e)=>t<e?1:0),zh=Zl(d.Gb,Bh,null,"bool"),Lh={kernelName:d.Gb,backendName:"cpu",kernelFunc:zh},Ph=$l((t,e)=>t<=e?1:0),qh=Zl(d.Hb,Ph,null,"bool"),Wh={kernelName:d.Hb,backendName:"cpu",kernelFunc:qh};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Uh(t,e,n){const r=(e-t)/(n-1),i=d.qi.makeZerosTypedArray(n,"float32");i[0]=t;for(let t=1;t<i.length;t++)i[t]=i[t-1]+r;return i}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vh={kernelName:d.Ib,backendName:"cpu",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:i,num:a}=n,o=Uh(r,i,a);return e.makeTensorInfo([o.length],"float32",o)}},Gh=Kd(t=>Math.log(t)),Hh=jl(d.Jb,Gh),Xh={kernelName:d.Jb,backendName:"cpu",kernelFunc:Hh},Kh=Sl(d.Kb,t=>Math.log1p(t)),Yh={kernelName:d.Kb,backendName:"cpu",kernelFunc:Kh},Jh=$l((t,e)=>t&&e),Zh=Zl(d.Mb,Jh,null,"bool"),Qh={kernelName:d.Mb,backendName:"cpu",kernelFunc:Zh},tp=Sl(d.Nb,t=>t?0:1,"bool"),ep={kernelName:d.Nb,backendName:"cpu",kernelFunc:tp},np=$l((t,e)=>t||e),rp=Zl(d.Ob,np,null,"bool"),ip={kernelName:d.Ob,backendName:"cpu",kernelFunc:rp};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ap={kernelName:d.Db,backendName:"cpu",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{depthRadius:a,bias:o,alpha:s,beta:u}=r;Al(i,"LRN");const c=i.shape[3],l=c-1,f=n.data.get(i.dataId).values,h=d.qi.sizeFromShape(i.shape),p=new Float32Array(h);function m(t){const e=t%c;let n=t-e+Math.max(0,e-a);const r=t-e+Math.min(e+a,l);let i=0;for(;n<=r;n++){const t=f[n];i+=t*t}return i}for(let t=0;t<h;t++){const e=m(t),n=f[t]*Math.pow(o+s*e,-u);p[t]=n}return n.makeTensorInfo(i.shape,i.dtype,p)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const op={kernelName:d.Eb,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,y:a,dy:o}=e,{depthRadius:s,bias:u,alpha:c,beta:l}=r;Al(o,"LRNGrad");const f=d.qi.sizeFromShape(o.shape),h=o.shape[3],p=n.data.get(o.dataId).values,m=n.data.get(i.dataId).values,g=n.data.get(a.dataId).values,b=new Float32Array(f),y=f;for(let t=0;t<y;t++){const e=t%h,n=t-e+Math.max(0,e-s),r=t-e+Math.min(h,e+s+1);let i=0;for(let t=n;t<r;t++)i+=Math.pow(m[t],2);i=c*i+u;for(let e=n;e<r;e++){let n=-2*c*l*m[e]*g[t]/i;t===e&&(n+=Math.pow(i,-l)),n*=p[t],b[e]+=n}}return n.makeTensorInfo(o.shape,i.dtype,b)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sp(t,e,n,r){const i=d.qi.getTypedArrayFromDType(r,d.qi.sizeFromShape(n));for(let n=0;n<i.length;++n){const r=n*e;let a=t[r];for(let n=0;n<e;++n){const e=t[r+n];e>a&&(a=e)}i[n]=a}return i}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function up(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reductionIndices:a,keepDims:o}=r,s=n;let u=i.shape;const c=u.length,l=d.qi.parseAxisParam(a,u);let f=l;const h=d.Ld.getAxesPermutation(f,c);let p=s.data.get(i.dataId).values;if(null!=h){const t=new Array(c);for(let e=0;e<t.length;e++)t[e]=u[h[e]];p=gd(p,u,i.dtype,h,t),f=d.Ld.getInnerMostAxes(f.length,c),u=t}Al(i,"max"),d.Ld.assertAxesAreInnerMostDims("max",f,c);const[m,g]=d.Ld.computeOutAndReduceShapes(u,f),b=sp(p,d.qi.sizeFromShape(g),m,i.dtype),y=s.write(b,m,i.dtype);let v=m;if(o){v=d.Ld.expandShapeToKeepDim(m,l)}return{dataId:y,shape:v,dtype:i.dtype}}const cp={kernelName:d.Pb,backendName:"cpu",kernelFunc:up},lp=$l((t,e)=>Math.max(t,e)),dp=Zl(d.Vb,lp),fp={kernelName:d.Vb,backendName:"cpu",kernelFunc:dp};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hp={kernelName:d.Qb,backendName:"cpu",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;Al(i,"maxPool");const{filterSize:a,strides:o,pad:s,dimRoundingMode:u}=r;d.qi.assert(d.Ld.eitherStridesOrDilationsAreOne(o,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const c=d.Ld.computePool2DInfo(i.shape,a,o,1,s,u);let l;if(1===c.filterWidth&&1===c.filterHeight&&d.qi.arraysEqual(c.inShape,c.outShape))l=Fl({inputs:{x:i},backend:n});else{const t=n.data.get(i.dataId).values,e=d.qi.computeStrides(i.shape),r=Id(t,i.shape,i.dtype,e,c,"max");l=n.makeTensorInfo(c.outShape,i.dtype,r.values)}return l}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pp={kernelName:d.Rb,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:a,strides:o,pad:s,dimRoundingMode:u,dataFormat:c,dilations:l}=r;Al(i,"maxPool3d");let f=l;null==f&&(f=[1,1,1]);const h=d.Ld.computePool3DInfo(i.shape,a,o,f,s,u,c),p=$d(n.data.get(i.dataId).values,i.shape,i.dtype,d.qi.computeStrides(i.shape),h,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mp={kernelName:d.Sb,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a}=e,{filterSize:o,strides:s,pad:u,dilations:c,dimRoundingMode:l}=r;Al([i,a],"maxPool3DGrad");const f=d.Ld.computePool3DInfo(a.shape,o,s,c,u,l),h=function(t,e){const n=Object(d.Wd)(e.outShape,"int32"),r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.front,p=e.padInfo.top,m=e.padInfo.left;for(let d=0;d<e.batchSize;++d)for(let g=0;g<e.inChannels;++g)for(let b=0;b<e.outDepth;++b){const y=b*r-h;let v=y;for(;v<0;)v+=o;const x=Math.min(e.inDepth,c+y);for(let r=0;r<e.outHeight;++r){const c=r*i-p;let h=c;for(;h<0;)h+=s;const w=Math.min(e.inHeight,l+c);for(let i=0;i<e.outWidth;++i){const p=i*a-m;let k=p;for(;k<0;)k+=u;const O=Math.min(e.inWidth,f+p);let _=Number.NEGATIVE_INFINITY,A=-1;for(let e=v;e<x;e+=o){const n=e-y;for(let r=h;r<w;r+=s){const i=r-c;for(let a=k;a<O;a+=u){const o=a-p,s=t.get(d,e,r,a,g);s>=_&&(_=s,A=n*l*f+i*l+o)}}}n.set(A,d,b,r,i,g)}}}return n}(n.bufferSync(a),f),p=f.strideDepth,m=f.strideHeight,g=f.strideWidth,b=f.dilationDepth,y=f.dilationHeight,v=f.dilationWidth,x=f.effectiveFilterDepth,w=f.effectiveFilterHeight,k=f.effectiveFilterWidth,O=x-1-f.padInfo.front,_=k-1-f.padInfo.left,A=w-1-f.padInfo.top,C=Object(d.Wd)(a.shape,"float32"),E=n.bufferSync(i);for(let t=0;t<f.batchSize;++t)for(let e=0;e<f.inChannels;++e)for(let n=0;n<f.inDepth;++n)for(let r=0;r<f.inHeight;++r)for(let i=0;i<f.inWidth;++i){const a=n-O,o=r-A,s=i-_;let u=0;for(let n=0;n<x;n+=b){const r=(a+n)/p;if(!(r<0||r>=f.outDepth||Math.floor(r)!==r))for(let i=0;i<w;i+=y){const a=(o+i)/m;if(!(a<0||a>=f.outHeight||Math.floor(a)!==a))for(let o=0;o<k;o+=v){const c=(s+o)/g;if(c<0||c>=f.outWidth||Math.floor(c)!==c)continue;const l=x*w*k-1-h.get(t,r,a,c,e)===n*w*k+i*k+o?1:0;if(0===l)continue;u+=E.get(t,r,a,c,e)*l}}}C.set(u,t,n,r,i,e)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gp={kernelName:d.Tb,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a,output:o}=e,s=a;Al([a,o],"maxPoolGrad");const{filterSize:u,strides:c,pad:l,dimRoundingMode:f}=r,h=d.Ld.computePool2DInfo(s.shape,u,c,1,l,f),p=n.data.get(s.dataId).values,m=Object(d.Wd)(h.outShape,s.dtype,Md(p,s.shape,s.dtype,h).values),g=h.strideHeight,b=h.strideWidth,y=h.dilationHeight,v=h.dilationWidth,x=h.effectiveFilterHeight,w=h.effectiveFilterWidth,k=w-1-h.padInfo.left,O=x-1-h.padInfo.top,_=Object(d.Wd)(s.shape,"float32"),A=n.data.get(i.dataId).values,C=Object(d.Wd)(i.shape,"float32",A);for(let t=0;t<h.batchSize;++t)for(let e=0;e<h.inChannels;++e)for(let n=0;n<h.inHeight;++n)for(let r=0;r<h.inWidth;++r){const i=n-O,a=r-k;let o=0;for(let n=0;n<x;n+=y){const r=(i+n)/g;if(!(r<0||r>=h.outHeight||Math.floor(r)!==r))for(let i=0;i<w;i+=v){const s=(a+i)/b;if(s<0||s>=h.outWidth||Math.floor(s)!==s)continue;const u=x*w-1-m.get(t,r,s,e)===n*w+i?1:0;if(0===u)continue;o+=C.get(t,r,s,e)*u}}_.set(o,t,n,r,e)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const bp={kernelName:d.Ub,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:i,strides:a,pad:o,includeBatchInIndex:s}=e,u=n;Al(r,"MaxPoolWithArgmax");const c=u.data.get(r.dataId).values,l=d.Ld.computePool2DInfo(r.shape,i,a,[1,1],o),[f,h]=function(t,e,n,r,i){const a=Id(t,0,n,d.qi.computeStrides(e),i,"max"),o=Md(t,e,n,i,!0,r);return[a.values,o.values]}(c,r.shape,r.dtype,s,l),p=u.write(f,l.outShape,r.dtype),m=u.write(h,l.outShape,r.dtype);return[{dataId:p,shape:l.outShape,dtype:r.dtype},{dataId:m,shape:l.outShape,dtype:"int32"}]}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yp(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:o}=r;let s;Al(i,"sum"),s="bool"===i.dtype?Yl({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):Fl({inputs:{x:i},backend:n});const u=s.shape.length,c=d.qi.parseAxisParam(a,s.shape),l=d.Ld.getAxesPermutation(c,u);let f=c,h=s;null!=l&&(h=bd({inputs:{x:s},backend:n,attrs:{perm:l}}),f=d.Ld.getInnerMostAxes(f.length,u)),d.Ld.assertAxesAreInnerMostDims("sum",f,h.shape.length);const[p,m]=d.Ld.computeOutAndReduceShapes(h.shape,f);let g=Hl(n,p,d.Ld.upcastType(h.dtype,"int32"));const b=d.qi.sizeFromShape(m),y=n.data.get(g.dataId).values,v=n.data.get(h.dataId).values;for(let t=0;t<y.length;++t){const e=t*b;let n=0;for(let t=0;t<b;++t)n+=v[e+t];y[t]=n}if(o){const t=g;g=id({inputs:{x:g},backend:n,attrs:{shape:d.Ld.expandShapeToKeepDim(g.shape,c)}}),n.disposeIntermediateTensorInfo(t)}return n.disposeIntermediateTensorInfo(s),null!=l&&n.disposeIntermediateTensorInfo(h),g}const vp={kernelName:d.fd,backendName:"cpu",kernelFunc:yp};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xp={kernelName:d.Wb,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:o}=r,s=d.qi.parseAxisParam(a,i.shape),u=d.Ld.computeOutAndReduceShapes(i.shape,s)[1],c=d.qi.sizeFromShape(u),l=[],f=n.makeTensorInfo([],"float32",new Float32Array([c]));l.push(f);const h=Yl({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});l.push(h);const p=nh({inputs:{a:h,b:f},backend:n});l.push(p);const m=yp({inputs:{x:p},backend:n,attrs:{axis:a,keepDims:o}});return l.forEach(t=>n.disposeIntermediateTensorInfo(t)),m}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wp={kernelName:d.Xb,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:o}=r;Al(i,"min");const s=d.qi.parseAxisParam(a,i.shape);let u=s;const c=d.Ld.getAxesPermutation(u,i.shape.length);let l=i;null!=c&&(l=bd({inputs:{x:i},backend:n,attrs:{perm:c}}),u=d.Ld.getInnerMostAxes(u.length,i.shape.length)),d.Ld.assertAxesAreInnerMostDims("min",u,l.shape.length);const[f,h]=d.Ld.computeOutAndReduceShapes(l.shape,u),p=d.qi.sizeFromShape(h),m=d.qi.makeZerosTypedArray(d.qi.sizeFromShape(f),l.dtype),g=n.data.get(l.dataId).values;for(let t=0;t<m.length;++t){const e=t*p;let n=g[e];for(let t=0;t<p;++t){const r=g[e+t];r<n&&(n=r)}m[t]=n}null!=c&&n.disposeIntermediateTensorInfo(l);const b=n.makeTensorInfo(f,l.dtype,m);if(o){const t=id({inputs:{x:b},backend:n,attrs:{shape:d.Ld.expandShapeToKeepDim(f,s)}});return n.disposeIntermediateTensorInfo(b),t}return b}},kp=$l((t,e)=>Math.min(t,e)),Op=Zl(d.Yb,kp),_p={kernelName:d.Yb,backendName:"cpu",kernelFunc:Op};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ap={kernelName:d.Zb,backendName:"cpu",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{paddings:a,mode:o}=r;Al(i,"mirrorPad");const s=a.map((t,e)=>t[0]+i.shape[e]+t[1]),u=a.map(t=>t[0]),c=a.map((t,e)=>t[0]+i.shape[e]),l="reflect"===o?0:1,f=n.data.get(i.dataId).values,h=i.shape.length,p=d.qi.computeStrides(i.shape),m=d.qi.sizeFromShape(s),g=s.length,b=d.qi.computeStrides(s),y=d.qi.getTypedArrayFromDType(i.dtype,m);for(let t=0;t<m;t++){let e=d.qi.indexToLoc(t,g,b);for(let t=0;t<g;t++)e[t]<u[t]?e[t]=2*u[t]-e[t]-l:e[t]>=c[t]&&(e[t]=2*(c[t]-1)-e[t]+l);e=e.map((t,e)=>t-u[e]);const n=d.qi.locToIndex(e,h,p);y[t]=f[n]}return{dataId:n.write(y,s,i.dtype),shape:s,dtype:i.dtype}}},Cp=$l((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),Ep=Zl(d.ac,Cp),Sp={kernelName:d.ac,backendName:"cpu",kernelFunc:Ep};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function jp(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{dim:a}=r,o=i.shape.length;let s=a;if(-1===s&&(s=o-1),s!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${s}`);const u=d.qi.parseAxisParam([s],i.shape),c=up({inputs:{x:i},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),l=d.Ld.expandShapeToKeepDim(c.shape,u),f=id({inputs:{x:c},backend:n,attrs:{shape:l}}),h=oh({inputs:{a:i,b:f},backend:n}),p=Uf({inputs:{x:h},backend:n}),m=yp({inputs:{x:p},backend:n,attrs:{axis:u,keepDims:!1}}),g=id({inputs:{x:m},backend:n,attrs:{shape:l}}),b=nh({inputs:{a:p,b:g},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),b}const Np={kernelName:d.Uc,backendName:"cpu",kernelFunc:jp};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tp={kernelName:d.cc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{numSamples:a,seed:o,normalized:s}=r;Al(i,"multinomial");const u=s?i:jp({inputs:{logits:i},backend:n,attrs:{dim:-1}}),c=u.shape[0],l=u.shape[1],f=n.data.get(u.dataId).values,h=[c,a],p=d.qi.makeZerosTypedArray(d.qi.sizeFromShape(h),"int32");for(let t=0;t<c;++t){const e=t*l,n=new Float32Array(l-1);n[0]=f[e];for(let t=1;t<n.length;++t)n[t]=n[t-1]+f[e+t];const r=Kc.alea(o.toString()),i=t*a;for(let t=0;t<a;++t){const e=r();p[i+t]=n.length;for(let r=0;r<n.length;r++)if(e<n[r]){p[i+t]=r;break}}}return s||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(h,"int32",p)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fp(t,e,n){const r=d.qi.createScalarValue(-1,n);return Jf([],e,r,t,n)}const Dp={kernelName:d.ec,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;Al(r,"neg");const i=n.data.get(r.dataId).values,[a,o]=Fp(i,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,a)}},Ip=d.yf.nonMaxSuppressionV3Impl;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mp={kernelName:d.fc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:a}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:u}=r;Al(i,"NonMaxSuppression");const c=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,{selectedIndices:d}=Ip(c,l,o,s,u);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},$p=d.yf.nonMaxSuppressionV4Impl;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rp={kernelName:d.gc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:a}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:u,padToMaxOutputSize:c}=r;Al(i,"NonMaxSuppressionPadded");const l=n.data.get(i.dataId).values,d=n.data.get(a.dataId).values,{selectedIndices:f,validOutputs:h}=$p(l,d,o,s,u,c);return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}},Bp=d.yf.nonMaxSuppressionV5Impl;
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zp={kernelName:d.hc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:a}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:u,softNmsSigma:c}=r;Al(i,"NonMaxSuppressionWithScore");const l=n.data.get(i.dataId).values,d=n.data.get(a.dataId).values,f=o,h=s,p=u,m=c,{selectedIndices:g,selectedScores:b}=Bp(l,d,f,h,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}},Lp=$l((t,e)=>t!==e?1:0),Pp=Zl(d.ic,Lp,null,"bool"),qp={kernelName:d.ic,backendName:"cpu",kernelFunc:Pp};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wp={kernelName:d.kc,backendName:"cpu",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n,attrs:r}=t,{indices:i}=e,{depth:a,onValue:o,offValue:s}=r;Al(i,"oneHot");const u=d.qi.sizeFromShape(i.shape),c=new Float32Array(u*a);c.fill(s);const l=n.data.get(i.dataId).values;for(let t=0;t<u;++t)l[t]>=0&&l[t]<a&&(c[t*a+l[t]]=o);return n.makeTensorInfo([...i.shape,a],"int32",c)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Up(t){const{inputs:e,backend:n}=t,{x:r}=e;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const t=Xl({inputs:{input:r},backend:n}),e=Up({inputs:{x:t},backend:n}),i=rf({inputs:{input:r},backend:n}),a=Up({inputs:{x:i},backend:n}),o=Vl({inputs:{real:e,imag:a},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),o}return dh({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const Vp={kernelName:d.rd,backendName:"cpu",kernelFunc:Up};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gp={kernelName:d.lc,backendName:"cpu",kernelFunc:function t(e){const{inputs:n,backend:r}=e,{x:i}=n;if("string"===i.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===i.dtype){const e=Xl({inputs:{input:i},backend:r}),n=t({inputs:{x:e},backend:r}),a=rf({inputs:{input:i},backend:r}),o=Up({inputs:{x:a},backend:r}),s=Vl({inputs:{real:n,imag:o},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(o),s}return dh({backend:r,attrs:{shape:i.shape,value:1,dtype:i.dtype}})}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hp(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r;if(1===e.length)return Gf({inputs:{input:e[0]},backend:n,attrs:{dim:i}});const a=e[0].shape,o=e[0].dtype;e.forEach(t=>{d.qi.assertShapesMatch(a,t.shape,"All tensors passed to stack must have matching shapes"),d.qi.assert(o===t.dtype,()=>"All tensors passed to stack must have matching dtypes")});const s=[],u=of({inputs:e.map(t=>{const e=Gf({inputs:{input:t},backend:n,attrs:{dim:i}});return s.push(e),e}),backend:n,attrs:{axis:i}});return s.forEach(t=>n.disposeIntermediateTensorInfo(t)),u}const Xp={kernelName:d.nc,backendName:"cpu",kernelFunc:Hp};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kp={kernelName:d.oc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{paddings:a,constantValue:o}=r;Al(i,"pad");const s=a.map((t,e)=>t[0]+i.shape[e]+t[1]),u=a.map(t=>t[0]),c=n.data.get(i.dataId).values,l=d.qi.sizeFromShape(i.shape),f=i.shape.length,h=d.qi.computeStrides(i.shape),p=d.qi.sizeFromShape(s),m=s.length,g=d.qi.computeStrides(s),b=d.qi.getTypedArrayFromDType(i.dtype,p);0!==o&&b.fill(o);for(let t=0;t<l;t++){const e=d.qi.indexToLoc(t,f,h).map((t,e)=>t+u[e]);b[d.qi.locToIndex(e,m,g)]=c[t]}return{dataId:n.write(b,s,i.dtype),shape:s,dtype:i.dtype}}},Yp=$l((t,e)=>Math.pow(t,e)),Jp=Zl(d.qc,Yp),Zp={kernelName:d.qc,backendName:"cpu",kernelFunc:Jp};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Qp(t,e,n,r){const[i,a]=d.Ld.computeOutAndReduceShapes(t,r),o=Object(d.pi)(e,"int32"),s=d.qi.makeZerosTypedArray(d.qi.sizeFromShape(i),o),u=d.qi.sizeFromShape(a);for(let t=0;t<s.length;++t){const e=t*u;let r=1;for(let t=0;t<u;++t)r*=n[e+t];s[t]=r}return{outVals:s,outShape:i,outDtype:o}}const tm={kernelName:d.sc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:o}=r;Al(i,"prod");const s=i.shape.length,u=d.qi.parseAxisParam(a,i.shape),c=d.Ld.getAxesPermutation(u,s);let l=u,f=i;const h=[];null!=c&&(f=bd({inputs:{x:i},backend:n,attrs:{perm:c}}),h.push(f),l=d.Ld.getInnerMostAxes(l.length,s));const p=n.data.get(f.dataId).values,{outVals:m,outShape:g,outDtype:b}=Qp(f.shape,f.dtype,p,l);let y=g;return o&&(y=d.Ld.expandShapeToKeepDim(g,u)),h.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(y,b,m)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function em(t,e,n,r){if(t===e||t<e&&n<0||e<t&&n>1)return d.qi.makeZerosTypedArray(0,r);const i=Math.abs(Math.ceil((e-t)/n)),a=d.qi.makeZerosTypedArray(i,r);e<t&&1===n&&(n=-1),a[0]=t;for(let t=1;t<a.length;t++)a[t]=a[t-1]+n;return a}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nm={kernelName:d.uc,backendName:"cpu",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:i,dtype:a,step:o}=n,s=em(r,i,o,a);return e.makeTensorInfo([s.length],a,s)}},rm=Sl(d.yc,t=>1/t),im={kernelName:d.yc,backendName:"cpu",kernelFunc:rm};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const am={kernelName:d.Dc,backendName:"cpu",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:a,halfPixelCenters:o,size:s}=r;Al(i,"resizeBilinear");const u=d.qi.computeStrides(i.shape),[c,l]=s,[f,h,p,m]=i.shape,g=n.data.get(i.dataId).values,b=new Float32Array(d.qi.sizeFromShape([f,c,l,m])),y=[a&&c>1?h-1:h,a&&l>1?p-1:p],v=[a&&c>1?c-1:c,a&&l>1?l-1:l];let x=0;const w=y[0]/v[0],k=y[1]/v[1];for(let t=0;t<f;t++)for(let e=0;e<c;e++){let n;n=o?w*(e+.5)-.5:w*e;const r=Math.max(0,Math.floor(n)),i=n-r,a=Math.min(h-1,Math.ceil(n)),s=t*u[0]+r*u[1],c=t*u[0]+a*u[1];for(let t=0;t<l;t++){let e;e=o?k*(t+.5)-.5:k*t;const n=Math.max(0,Math.floor(e)),r=e-n,a=Math.min(p-1,Math.ceil(e)),l=s+n*u[2],d=c+n*u[2],f=s+a*u[2],h=c+a*u[2];for(let t=0;t<m;t++){const e=g[l+t],n=g[d+t],a=e+(g[f+t]-e)*r,o=a+(n+(g[h+t]-n)*r-a)*i;b[x++]=o}}}return n.makeTensorInfo([f,c,l,m],"float32",b)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const om={kernelName:d.Ec,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:a}=e,{alignCorners:o}=r;Al([a,i],"resizeBilinearGrad");const s=d.qi.computeStrides(i.shape),[u,c,l,f]=i.shape,[,h,p]=a.shape,m=new Float32Array(u*c*l*f),g=[o&&h>1?c-1:c,o&&p>1?l-1:l],b=[o&&h>1?h-1:h,o&&p>1?p-1:p],y=g[0]/b[0],v=g[1]/b[1],x=n.data.get(a.dataId).values;let w=0;for(let t=0;t<u;t++){const e=t*s[0];for(let t=0;t<h;t++){const n=t*y,r=Math.floor(n),i=Math.min(Math.ceil(n),c-1),a=e+r*s[1],o=e+i*s[1],u=n-r,d=1-u;for(let t=0;t<p;t++){const e=t*v,n=Math.floor(e),r=Math.min(Math.ceil(e),l-1),i=e-n,c=1-i,h=a+n*s[2],p=a+r*s[2],g=o+n*s[2],b=o+r*s[2],y=d*c,k=d*i,O=u*c,_=u*i;for(let t=0;t<f;t++){const e=x[w++];m[h+t]+=e*y,m[p+t]+=e*k,m[g+t]+=e*O,m[b+t]+=e*_}}}}return n.makeTensorInfo([u,l,c,f],"float32",m)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sm={kernelName:d.Fc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:a,halfPixelCenters:o,size:s}=r;Al(i,"resizeNearestNeighbor");const u=d.qi.computeStrides(i.shape),[c,l]=s,[f,h,p,m]=i.shape,g=n.data.get(i.dataId).values,b=new Float32Array(f*c*l*m),y=[a&&c>1?h-1:h,a&&l>1?p-1:p],v=[a&&c>1?c-1:c,a&&l>1?l-1:l],x=y[0]/v[0],w=y[1]/v[1];let k=0;for(let t=0;t<f;t++){const e=t*u[0];for(let t=0;t<c;t++){const n=o?x*(t+.5):x*t;let r=Math.min(h-1,a?Math.round(n):Math.floor(n));o&&(r=Math.max(0,r));const i=e+r*u[1];for(let t=0;t<l;t++){const e=o?w*(t+.5):w*t;let n=Math.min(p-1,a?Math.round(e):Math.floor(e));o&&(n=Math.max(0,n));const r=i+n*u[2];for(let t=0;t<m;t++){const e=g[r+t];b[k++]=e}}}}return n.makeTensorInfo([f,c,l,m],i.dtype,b)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const um={kernelName:d.Gc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:a}=e,{alignCorners:o}=r;Al([a,i],"resizeNearestNeighborGrad");const s=d.qi.computeStrides(i.shape),u=d.qi.computeStrides(a.shape),[c,l,f,h]=i.shape,[,p,m]=a.shape,g=new Float32Array(c*l*f*h),b=n.data.get(a.dataId).values,y=[o&&p>1?l-1:l,o&&m>1?f-1:f],v=[o&&p>1?p-1:p,o&&m>1?m-1:m],x=y[0]/v[0],w=y[1]/v[1],k=1/x,O=1/w,_=2*Math.ceil(k)+2,A=2*Math.ceil(O)+2;for(let t=0;t<c;t++){const e=t*s[0];for(let t=0;t<l;t++){const n=e+t*s[1],r=Math.floor(t*k),i=Math.floor(r-_/2);for(let r=0;r<f;r++){const a=n+r*s[2],c=Math.floor(r*O),d=Math.floor(c-A/2);for(let n=0;n<h;n++){let s=0;for(let a=0;a<_;a++){const c=a+i;if(c<0||c>=p)continue;const h=e+c*u[1],g=c*x;if(t===Math.min(l-1,o?Math.round(g):Math.floor(g)))for(let t=0;t<A;t++){const e=t+d;if(e<0||e>=m)continue;const i=h+e*u[2],a=e*w;r===Math.min(f-1,o?Math.round(a):Math.floor(a))&&(s+=b[i+n])}}g[a+n]=s}}}}return n.makeTensorInfo(i.shape,i.dtype,g)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cm={kernelName:d.Hc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dims:a}=r;Al(i,"reverse");const o=i.shape.length,s=d.qi.parseAxisParam(a,i.shape);if(0===o)return Fl({inputs:{x:i},backend:n});const u=new d.jd(i.shape,i.dtype),c=n.bufferSync(i);for(let t=0;t<u.size;t++){const e=u.indexToLoc(t),n=e.slice();s.forEach(t=>n[t]=i.shape[t]-1-n[t]),u.set(c.get(...n),...e)}return n.makeTensorInfo(u.shape,u.dtype,u.values)}},lm={kernelName:d.Ic,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:i,fillValue:a,center:o}=e,s=n,u=d.qi.getTypedArrayFromDType(r.dtype,d.qi.sizeFromShape(r.shape)),[c,l,f,h]=r.shape,[p,m]=d.Ld.getImageCenter(o,l,f),g=Math.sin(i),b=Math.cos(i),y=s.data.get(r.dataId).values;for(let t=0;t<c;t++){const e=t*f*l*h;for(let t=0;t<l;t++){const n=t*(f*h);for(let r=0;r<f;r++){const i=r*h;for(let o=0;o<h;o++){const s=[c,t,r,o],d=s[2],v=s[1];let x=(d-p)*b-(v-m)*g,w=(d-p)*g+(v-m)*b;x=Math.round(x+p),w=Math.round(w+m);let k=a;if("number"!=typeof a&&(k=3===o?255:a[o]),x>=0&&x<f&&w>=0&&w<l){k=y[e+w*(f*h)+x*h+o]}u[e+n+i+o]=k}}}}return{dataId:s.write(u,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},dm=Sl(d.Jc,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2==0?e:e+1}),fm={kernelName:d.Jc,backendName:"cpu",kernelFunc:dm},hm=Kd(t=>1/Math.sqrt(t)),pm=jl(d.Kc,hm),mm={kernelName:d.Kc,backendName:"cpu",kernelFunc:pm};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function gm(t,e,n,r,i,a,o,s,u,c){const l=[r/i,i],f=t.values,h=e.values;if(0===r)return Object(d.Wd)(n,e.dtype);const p=Object(d.Wd)(l,e.dtype);p.values.fill(u);for(let t=0;t<a;t++){const a=[];let u=0;for(let e=0;e<o;e++){const n=f[t*o+e];a.push(n),u+=n*s[e]}if(u<0||u>=r/i)throw new Error(`Invalid indices: ${a} does not index into ${n}`);for(let n=0;n<i;n++)c?p.values[u*i+n]+=h[t*i+n]:p.values[u*i+n]=0===e.rank?h[0]:h[t*i+n]}return p}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bm={kernelName:d.Mc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{indices:i,updates:a}=e,{shape:o}=r,{sliceRank:s,numUpdates:u,sliceSize:c,strides:l,outputSize:f}=d.Ld.calculateShapes(a,i,o),h=gm(n.bufferSync(i),n.bufferSync(a),o,f,c,u,s,l,0,!0);return n.makeTensorInfo(o,h.dtype,h.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ym={kernelName:d.Nc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{condition:r,t:i,e:a}=e;Al([r,i,a],"select");const o=r.shape.length,s=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,l=Object(d.pi)(i.dtype,a.dtype),f=d.qi.makeZerosTypedArray(d.qi.sizeFromShape(i.shape),l);let h=0;const p=0===o||o>1||1===i.shape.length?1:d.qi.sizeFromShape(i.shape.slice(1));for(let t=0;t<s.length;t++)for(let e=0;e<p;e++)1===s[t]?f[h++]=u[t]:f[h++]=c[t];return n.makeTensorInfo(i.shape,l,f)}},vm=d.Ld.SELU_SCALEALPHA,xm=d.Ld.SELU_SCALE,wm=Sl(d.Oc,t=>t>=0?xm*t:vm*(Math.exp(t)-1)),km={kernelName:d.Oc,backendName:"cpu",kernelFunc:wm},Om=Sl(d.Pc,t=>1/(1+Math.exp(-t))),_m={kernelName:d.Pc,backendName:"cpu",kernelFunc:Om},Am=Sl(d.Qc,t=>t<0?-1:t>0?1:0),Cm={kernelName:d.Qc,backendName:"cpu",kernelFunc:Am},Em=Sl(d.Rc,t=>Math.sin(t)),Sm={kernelName:d.Rc,backendName:"cpu",kernelFunc:Em},jm=Sl(d.Sc,t=>Math.sinh(t)),Nm={kernelName:d.Sc,backendName:"cpu",kernelFunc:jm},Tm=Math.log(1.1920928955078125e-7)+2,Fm=Sl(d.Vc,t=>{const e=t>-Tm,n=t<Tm,r=Math.exp(t);let i;return i=n?r:e?t:Math.log(1+r),i}),Dm={kernelName:d.Vc,backendName:"cpu",kernelFunc:Fm};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Im={kernelName:d.Wc,backendName:"cpu",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:a,paddings:o}=r;Al([i],"spaceToBatchND");const s=d.qi.sizeFromShape(a),u=[[0,0]];u.push(...o);for(let t=1+a.length;t<i.shape.length;++t)u.push([0,0]);const c=Kp.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:u,constantValue:0}}),l=d.Ld.getReshaped(c.shape,a,s,!1),f=d.Ld.getPermuted(l.length,a.length,!1),h=d.Ld.getReshapedPermuted(c.shape,a,s,!1),p=id({inputs:{x:c},backend:n,attrs:{shape:l}}),m=bd({inputs:{x:p},backend:n,attrs:{perm:f}}),g=id({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mm={kernelName:d.Xc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:i,sparseValues:a,defaultValue:o}=e,{outputShape:s}=r,{sliceRank:u,numUpdates:c,sliceSize:l,strides:f,outputSize:h}=d.Ld.calculateShapes(a,i,s),p=gm(n.bufferSync(i),n.bufferSync(a),s,h,l,c,u,f,n.data.get(o.dataId).values[0],!1);return n.makeTensorInfo(s,p.dtype,p.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $m={kernelName:d.Yc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{numOrSizeSplits:a,axis:o}=r,s=d.qi.parseAxisParam(o,i.shape)[0],u=d.Ld.prepareSplitSize(i,a,s),c=new Array(i.shape.length).fill(0),l=i.shape.slice();return u.map(t=>{const e=[...l];e[s]=t;const r=Wd({inputs:{x:i},backend:n,attrs:{begin:c,size:e}});return c[s]+=t,r})}},Rm=Sl(d.Zc,t=>Math.sqrt(t)),Bm={kernelName:d.Zc,backendName:"cpu",kernelFunc:Rm},zm={kernelName:d.ad,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;Al(n,"square");const i=r.data.get(n.dataId).values,a=new Float32Array(i.length);for(let t=0;t<i.length;++t){const e=i[t];a[t]=e*e}return{dataId:r.write(a,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},Lm=$l((t,e)=>{const n=t-e;return n*n}),Pm=Zl(d.bd,Lm),qm={kernelName:d.bd,backendName:"cpu",kernelFunc:Pm},Wm=Sl(d.cd,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),Um={kernelName:d.cd,backendName:"cpu",kernelFunc:Wm};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Vm(t,e,n,r){const i=Object(d.Wd)(t,e.dtype);for(let t=0;t<i.size;t++){const a=i.indexToLoc(t),o=new Array(a.length);for(let t=0;t<o.length;t++)o[t]=a[t]*n[t]+r[t];i.set(e.get(...o),...a)}return i}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gm={kernelName:d.dd,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:a,end:o,strides:s,beginMask:u,endMask:c,ellipsisMask:l,newAxisMask:f,shrinkAxisMask:h}=r;Al(i,"stridedSlice");const{nonStrided:p,$begin:m,$strides:g,size:b,newShape:y,outShape:v}=d.zh.sliceInfo(i.shape,a,o,s,u,c,l,f,h),x=id({inputs:{x:i},backend:n,attrs:{shape:y}});let w;if(p){const t=Wd({inputs:{x:x},backend:n,attrs:{begin:m,size:b}});w=id({inputs:{x:t},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(t)}else if(v.some(t=>0===t))w=n.makeTensorInfo(v,i.dtype,[]);else{const t=Vm(v,n.bufferSync(x),g,m);w=n.makeTensorInfo(t.shape,t.dtype,t.values)}const k=id({inputs:{x:w},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),k}},Hm=Sl(d.gd,t=>Math.tan(t)),Xm={kernelName:d.gd,backendName:"cpu",kernelFunc:Hm},Km=Sl(d.hd,t=>Math.tanh(t)),Ym={kernelName:d.hd,backendName:"cpu",kernelFunc:Km};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Jm(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const r=Object(d.Wd)(n,t.dtype);for(let e=0;e<r.values.length;++e){const n=r.indexToLoc(e),i=new Array(t.rank);for(let e=0;e<i.length;e++)i[e]=n[e]%t.shape[e];const a=t.locToIndex(i);r.values[e]=t.values[a]}return r}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zm={kernelName:d.kd,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reps:a}=r;Al(i,"tile");const o=Jm(n.bufferSync(i),a);return n.makeTensorInfo(o.shape,o.dtype,o.values)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qm(t,e,n,r,i){const a=e[e.length-1],[o,s]=[t.length/a,a],u=d.qi.getTypedArrayFromDType(n,o*r),c=d.qi.getTypedArrayFromDType("int32",o*r);for(let e=0;e<o;e++){const n=e*s,i=t.subarray(n,n+s),a=[];for(let t=0;t<i.length;t++)a.push({value:i[t],index:t});a.sort((t,e)=>e.value-t.value);const o=e*r,l=u.subarray(o,o+r),d=c.subarray(o,o+r);for(let t=0;t<r;t++)l[t]=a[t].value,d[t]=a[t].index}const l=e.slice();return l[l.length-1]=r,[Object(d.Wd)(l,n,u),Object(d.Wd)(l,"int32",c)]}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tg={kernelName:d.ld,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{k:a,sorted:o}=r;Al(i,"topk");const s=n.data.get(i.dataId).values,[u,c]=Qm(s,i.shape,i.dtype,a);return[n.makeTensorInfo(u.shape,u.dtype,u.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eg(t,e,n,r){const i=d.qi.parseAxisParam(e,n)[0],a=[1,n[0],1];for(let t=0;t<i;t++)a[0]*=n[t];a[1]=n[i];for(let t=i+1;t<n.length;t++)a[2]*=n[t];const o={},s=new Int32Array(n[i]),u=new d.jd(a,r,t),c=[],l=1===a[0]&&1===a[2];for(let e=0;e<n[i];e++){let n;if(l)n=t[e].toString();else{const t=[];for(let n=0;n<a[0];n++)for(let r=0;r<a[2];r++)t.push(u.get(n,e,r));n=t.join(",")}if(void 0!==o[n])s[e]=o[n];else{const t=Object.keys(o).length;o[n]=t,s[e]=t,c.push(e)}}const f=a.slice();f[1]=Object.keys(o).length;const h=new d.jd(f,r);c.forEach((t,e)=>{for(let n=0;n<a[0];n++)for(let r=0;r<a[2];r++)h.set(u.get(n,t,r),n,e,r)});const p=n.slice();return p[i]=f[1],{outputValues:h.values,outputShape:p,indices:s}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ng={kernelName:d.nd,backendName:"cpu",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{axis:i}=n,{x:a}=e;Al(a,"unique");const o=r.data.get(a.dataId).values,{outputValues:s,outputShape:u,indices:c}=eg(o,i,a.shape,a.dtype);return[r.makeTensorInfo(u,a.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rg={kernelName:d.od,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{value:i}=e;let{axis:a}=r;a<0&&(a+=i.shape.length);const o=i.shape.length,s=i.shape[a],u=new Array(o-1);let c=0;for(let t=0;t<o;t++)t!==a&&(u[c++]=i.shape[t]);const l=new Array(o).fill(0),d=i.shape.slice();d[a]=1;const f=new Array(s);for(let t=0;t<f.length;t++){l[a]=t;const e=Wd({inputs:{x:i},backend:n,attrs:{begin:l,size:d}});f[t]=id({inputs:{x:e},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(e)}return f}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ig={kernelName:d.pd,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,segmentIds:a}=e,{numSegments:o}=r;Al(i,"unsortedSegmentSum");const s=[],u=[],c=i.shape.length-a.shape.length;let l=a;for(let t=0;t<c;++t){const e=Gf({inputs:{input:l},backend:n,attrs:{dim:t+1}});l=e,u.push(e)}for(let t=0;t<o;++t){const e=d.qi.createScalarValue(t,"int32"),r=n.makeTensorInfo([],"int32",e),a=Df({inputs:{a:r,b:l},backend:n}),o=Yl({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),c=Qf({inputs:{a:o,b:i},backend:n}),f=yp({inputs:{x:c},backend:n,attrs:{axis:0,keepDims:!1}});s.push(f),u.push(r),u.push(a),u.push(o),u.push(c),u.push(f)}const f=Hp({inputs:s,backend:n,attrs:{axis:0}});return u.forEach(t=>n.disposeIntermediateTensorInfo(t)),f}},ag=[ud,ld,fd,pd,rd,md,vd,xd,wd,kd,_d,Cd,Sd,Td,Dd,Rd,Bd,zd,Ld,sd,Pd,Vd,Xd,Jl,Zd,tf,Gl,ef,sf,lf,df,cf,hf,pf,ff,gf,yf,vf,xf,wf,kf,_f,Af,Cf,Ef,Sf,Nf,jf,rh,Tl,Tf,If,qf,Vf,Hf,Yf,lh,fh,hh,gh,vh,xh,wh,kh,_h,Eh,Nh,Dl,Th,af,Dh,Mh,Rh,Ml,Lh,Wh,Vh,Xh,Yh,Qh,ep,ip,ap,op,fp,hp,pp,mp,gp,bp,cp,xp,wp,_p,Ap,Sp,Tp,th,Dp,Mp,Rp,zp,qp,Wp,Gp,Xp,Kp,Zp,zl,tm,nm,Kl,im,Pl,Wl,ad,am,om,sm,um,cm,lm,fm,mm,bm,ym,km,_m,Cm,Sm,Nm,Ud,Np,Dm,Im,Mm,$m,Bm,zm,qm,Um,Gm,sh,vp,Xm,Ym,Zm,tg,yd,ng,rg,ig,Vp];
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */for(const t of ag)Object(d.Tg)(t);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const og={},sg={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function ug(t){if(!(t in og)){const e=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const e=function(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);if(e.addEventListener("webglcontextlost",e=>{e.preventDefault(),delete og[t]},!1),1===t)return e.getContext("webgl",sg)||e.getContext("experimental-webgl",sg);return e.getContext("webgl2",sg)}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(t);if(null===e)return console.log("Could not get context for WebGL version",t),null;og[t]=e}const e=og[t];return e.isContextLost()?(delete og[t],ug(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),og[t])}var cg,lg,dg;function fg(t,e){return[e,t]}function hg(t){const e=d.qi.sizeFromShape(t),n=Math.ceil(e/4);return d.qi.sizeToSquarishShape(n)}function pg(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function mg(t,e){const n=t;let r,i,a,o,s,u,c,l,f,h;return 2===Object(d.Me)().getNumber("WEBGL_VERSION")?(r=n.R32F,i=n.R16F,a=n.RGBA16F,o=n.RGBA32F,s=n.RED,c=4,l=1,f=n.HALF_FLOAT,h=n.FLOAT):(r=t.RGBA,i=t.RGBA,a=t.RGBA,o=n.RGBA,s=t.RGBA,c=4,l=4,f=null!=e?e.HALF_FLOAT_OES:null,h=t.FLOAT),u=t.RGBA,{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:u,downloadUnpackNumChannels:c,defaultNumChannels:l,textureTypeHalfFloat:f,textureTypeFloat:h}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gg(t,e){const n=e();return Object(d.Me)().getBool("DEBUG")&&function(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+function(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}(t,e))}(t),n}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(cg||(cg={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(lg||(lg={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(dg||(dg={}));function bg(t){return!!(Object(d.Me)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function yg(t,e){return Eg(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function vg(t,e){const n=Eg(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(gg(t,()=>t.shaderSource(n,e)),gg(t,()=>t.compileShader(n)),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw function(t,e){const n=xg.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);const r=+n[1],i=t.split("\n"),a=i.length.toString().length+2,o=i.map((t,e)=>d.qi.rightPad((e+1).toString(),a)+t);let s=0;for(let t=0;t<o.length;t++)s=Math.max(o[t].length,s);const u=o.slice(0,r-1),c=o.slice(r-1,r),l=o.slice(r);console.log(u.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+d.qi.rightPad(c[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(l.join("\n"))}(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const xg=/ERROR: [0-9]+:([0-9]+):/g;function wg(t,e){if(gg(t,()=>t.validateProgram(e)),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function kg(t,e,n,r,i,a,o){const s=t.getAttribLocation(e,n);return-1!==s&&(gg(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),gg(t,()=>t.vertexAttribPointer(s,i,t.FLOAT,!1,a,o)),gg(t,()=>t.enableVertexAttribArray(s)),!0)}function Og(t,e,n,r){gg(t,()=>function(t,e,n){Sg(t,n),gg(t,()=>t.activeTexture(t.TEXTURE0+n)),gg(t,()=>t.bindTexture(t.TEXTURE_2D,e))}(t,e,r)),gg(t,()=>t.uniform1i(n,r))}function _g(t,e,n){gg(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),gg(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function Ag(t,e){gg(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),gg(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Cg(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}(t,e))}function Eg(t,e,n){const r=gg(t,()=>e());if(null==r)throw new Error(n);return r}function Sg(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){throw new Error(`textureUnit must be in ${`[gl.TEXTURE0, gl.TEXTURE${n}]`}.`)}}function jg(t,e=2){return d.qi.sizeFromShape(t.slice(0,t.length-e))}function Ng(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Tg(t){let e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[jg(t),...Ng(t)]),e}function Fg(t){return t%2==0}function Dg(t,e){if(t=t.slice(-2),e=e.slice(-2),d.qi.arraysEqual(t,e))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){const n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(Fg(n)&&Fg(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&Fg(t[0])&&Fg(e[0])}let Ig,Mg;function $g(t,e){return null!=t.getExtension(e)}function Rg(t){try{if(null!=ug(t))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function Bg(t){if(0===t)return!1;const e=ug(t);if(1!==t){if($g(e,"EXT_color_buffer_float"))return zg(e);const t="EXT_color_buffer_half_float";if($g(e,t)){const n=e.getExtension(t);return function(t,e){const n=mg(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),a}(e,n)}return!1}if(!$g(e,"OES_texture_float"))return!1;if(!$g(e,"WEBGL_color_buffer_float"))return!1;return zg(e)}function zg(t){const e=mg(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}function Lg(t,e){Array.isArray(t)||(t=[t]),t.forEach(t=>{null!=t&&d.qi.assert("complex64"!==t.dtype,()=>e+" does not support complex64 tensors in the WebGL backend.")})}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pg=Object(d.Me)();
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function qg(){let t,e,n,r,i,a,o,s,u,c;return 2===Object(d.Me)().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",a="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",a="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wg(t,e,n="index"){const r=d.qi.computeStrides(e);return r.map((e,i)=>`${`int ${t[i]} = ${n} / ${e}`}; ${i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${e}`:`index -= ${t[i]} * ${e}`};`).join("")}function Ug(t){const e=d.qi.computeStrides(t).map(t=>t.toString());return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;\n  }\n`}Pg.registerFlag("HAS_WEBGL",()=>Pg.getNumber("WEBGL_VERSION")>0),Pg.registerFlag("WEBGL_VERSION",()=>Rg(2)?2:Rg(1)?1:0),Pg.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),Pg.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===Pg.get("WEBGL_VERSION")),Pg.registerFlag("WEBGL_CPU_FORWARD",()=>!0),Pg.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),Pg.registerFlag("WEBGL_PACK",()=>Pg.getBool("HAS_WEBGL")),Pg.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Pg.getBool("WEBGL_PACK")),Pg.registerFlag("WEBGL_PACK_CLIP",()=>Pg.getBool("WEBGL_PACK")),Pg.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>!1),Pg.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Pg.getBool("WEBGL_PACK")),Pg.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Pg.getBool("WEBGL_PACK")),Pg.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Pg.getBool("WEBGL_PACK")),Pg.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Pg.getBool("WEBGL_PACK")),Pg.registerFlag("WEBGL_PACK_REDUCE",()=>Pg.getBool("WEBGL_PACK")),Pg.registerFlag("WEBGL_LAZILY_UNPACK",()=>Pg.getBool("WEBGL_PACK")),Pg.registerFlag("WEBGL_CONV_IM2COL",()=>Pg.getBool("WEBGL_PACK")),Pg.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>function(t){if(null==Ig){const e=ug(t);Ig=e.getParameter(e.MAX_TEXTURE_SIZE)}return Ig}(Pg.getNumber("WEBGL_VERSION"))),Pg.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>function(t){if(null==Mg){const e=ug(t);Mg=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Mg)}(Pg.getNumber("WEBGL_VERSION"))),Pg.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Pg.getNumber("WEBGL_VERSION");return 0===t?0:function(t){if(0===t)return 0;let e;const n=ug(t);return e=$g(n,"EXT_disjoint_timer_query_webgl2")&&2===t?2:$g(n,"EXT_disjoint_timer_query")?1:0,e}(t)}),Pg.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Pg.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!d.we.isMobile()),Pg.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>function(t){if(0===t)return!1;const e=ug(t);if(1===t){if(!$g(e,"OES_texture_float"))return!1}else if(!$g(e,"EXT_color_buffer_float"))return!1;return zg(e)}(Pg.getNumber("WEBGL_VERSION"))),Pg.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!Pg.getBool("WEBGL_FORCE_F16_TEXTURES")&&Pg.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),Pg.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Bg(Pg.getNumber("WEBGL_VERSION"))),Pg.registerFlag("WEBGL_FENCE_API_ENABLED",()=>{return 2===(t=Pg.getNumber("WEBGL_VERSION"))&&null!=ug(t).fenceSync;var t}),Pg.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Pg.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),Pg.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(t<0&&-1!==t)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});const Vg="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gg{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=cg.DENSE;const e=hg(t),n=qg();this.outputShape=t,this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${Wg(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(${e[0]}, ${e[1]}));\n        int index = 4 * (resTexRC.x * ${e[1]} + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${n.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hg{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=cg.DENSE;const e=hg(t),n=qg();this.outputShape=t,this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${Wg(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(${e[0]}, ${e[1]}));\n        int index = 4 * (resTexRC.x * ${e[1]} + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${n.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xg{constructor(t){this.variableNames=["A"],this.outTexUsage=lg.DOWNLOAD;const e=qg();this.outputShape=t,this.userCode=`\n      ${Vg}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${e.output} = encode_float(x);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kg{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=lg.DOWNLOAD;const e=qg();this.outputShape=t,this.userCode=`\n      ${Vg}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${e.output} = encode_float(x);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yg{constructor(t,e,n=!1){this.variableNames=["A"];const r=qg(),[i,a]=e;this.outputShape=t;let o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode=`\n      ${Ug(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / ${a};\n        int c = imod(flatIndex, ${a});\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(${a}.0, ${i}.0);\n        vec4 values = ${r.texture2D}(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ${r.output} = vec4(${o}, 0., 0., 0.);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jg{constructor(t,e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const r=qg(),[i,a]=e;this.outputShape=t;let o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(let e=0;e<=1;e++)for(let n=0;n<=1;n++){const s=2*e+n;o+=`\n          localCoords = coords;\n          if(localCoords[2] + ${n} < ${t[2]}) {\n            localCoords[2] += ${n};\n            if(localCoords[1] + ${e} < ${t[1]}) {\n              localCoords[1] += ${e};\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ${a};\n              c = imod(flatIndex, ${a});\n              uv = (vec2(c, r) + halfCR) / vec2(${a}.0, ${i}.0);\n              values = ${r.texture2D}(A, uv);\n\n              if(offset == 0) {\n                result[${s}] = values[0];\n              } else if(offset == 1) {\n                result[${s}] = values[1];\n              } else if(offset == 2) {\n                result[${s}] = values[2];\n              } else {\n                result[${s}] = values[3];\n              }\n            }\n          }\n        `}this.userCode=`\n      ${Ug(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ${o}\n\n        ${r.output} = ${s};\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zg(t){const e=qg();return function(t,e){const n=Eg(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(gg(t,()=>t.shaderSource(n,e)),gg(t,()=>t.compileShader(n)),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(t,`${e.version}\n    precision highp float;\n    ${e.attribute} vec3 clipSpacePos;\n    ${e.attribute} vec2 uv;\n    ${e.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`)}function Qg(t){return function(t,e){const n=Eg(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return gg(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),gg(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}(t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function tb(t){return function(t,e){const n=Eg(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return gg(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),gg(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}(t,new Uint16Array([0,1,2,2,1,3]))}function eb(t,e,n,r,i,a){!function(t,e){const n=Object(d.Me)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){throw new Error("Requested texture size "+`[${t}x${e}]`+" is invalid.")}if(t>n||e>n){throw new Error("Requested texture size "+`[${t}x${e}]`+" greater than WebGL maximum on this browser / GPU "+`[${n}x${n}]`+".")}}(e,n);const o=function(t){return Eg(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}(t),s=t.TEXTURE_2D;return gg(t,()=>t.bindTexture(s,o)),gg(t,()=>t.texParameteri(s,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),gg(t,()=>t.texParameteri(s,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),gg(t,()=>t.texParameteri(s,t.TEXTURE_MIN_FILTER,t.NEAREST)),gg(t,()=>t.texParameteri(s,t.TEXTURE_MAG_FILTER,t.NEAREST)),gg(t,()=>t.texImage2D(s,0,r,e,n,0,i,a,null)),gg(t,()=>t.bindTexture(t.TEXTURE_2D,null)),o}function nb(t){return t.internalFormatFloat}function rb(t){return t.internalFormatHalfFloat}function ib(t){return t.downloadTextureFormat}function ab(t){return t.internalFormatPackedFloat}function ob(t){return t.internalFormatPackedHalfFloat}function sb(t,e,n,r,i,a,o,s){const u=t,c=new Float32Array(function(t,e){const[n,r]=pg(t,e);return n*r*4}(a,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ub{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const e=Object(d.Me)().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(t,e){og[t]=e}(e,t)):this.gl=ug(e);let n="WEBGL_color_buffer_float";if(1===Object(d.Me)().getNumber("WEBGL_VERSION")){const t="OES_texture_float",e="OES_texture_half_float";if(this.textureFloatExtension=yg(this.gl,t),$g(this.gl,e))this.textureHalfFloatExtension=yg(this.gl,e);else if(Object(d.Me)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),$g(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=yg(this.gl,"EXT_color_buffer_half_float");else if(Object(d.Me)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",$g(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!$g(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=Qg(this.gl),this.indexBuffer=tb(this.gl),this.framebuffer=function(t){return Eg(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=mg(this.gl,this.textureHalfFloatExtension)}get debug(){return Object(d.Me)().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;gg(t,()=>t.finish()),gg(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),gg(t,()=>t.deleteFramebuffer(this.framebuffer)),gg(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),gg(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),gg(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,a]=fg(e,n);return eb(t,i,a,nb(r),r.textureFormatFloat,t.FLOAT)}(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,a]=fg(e,n);return eb(t,i,a,rb(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,a]=fg(e,n);return eb(t,i,a,ib(r),t.RGBA,t.UNSIGNED_BYTE)}(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),function(t,e,n){gg(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?gg(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):gg(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),gg(t,()=>t.bindTexture(t.TEXTURE_2D,null))}(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,n,r){this.throwIfDisposed(),function(t,e,n,r,i,a){let o,s,u;gg(t,()=>t.bindTexture(t.TEXTURE_2D,e)),i instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=t.UNSIGNED_BYTE,u=t.RGBA):(o=new Float32Array(n*r*4),s=t.FLOAT,u=a.internalFormatPackedFloat),o.set(i),gg(t,()=>t.texImage2D(t.TEXTURE_2D,0,u,n,r,0,t.RGBA,s,o)),gg(t,()=>t.bindTexture(t.TEXTURE_2D,null))}(this.gl,t,e,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,a]=pg(e,n);return eb(t,i,a,ob(r),t.RGBA,r.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,a]=pg(e,n);return eb(t,i,a,ab(r),t.RGBA,t.FLOAT)}(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(Ag(this.gl,this.framebuffer),this.outputTexture=null),gg(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,n){return this.downloadMatrixDriver(t,()=>function(t,e,n,r){const[i,a]=fg(e,n),o=new Uint8Array(e*n*4);return gg(t,()=>t.readPixels(0,0,i,a,r.downloadTextureFormat,t.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}(this.gl,e,n,this.textureConfig))}downloadPackedMatrixFromBuffer(t,e,n,r,i,a){return sb(this.gl,t,0,0,0,i,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,e){return function(t,e,n){const r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}(this.gl,t,e)}createBufferFromTexture(t,e,n){this.bindTextureToFrameBuffer(t);const r=function(t,e,n,r){const i=t.createBuffer();gg(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,i));const a=16*e*n;return gg(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),gg(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),gg(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),i}(this.gl,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,n;if(Object(d.Me)().getBool("WEBGL_FENCE_API_ENABLED")){const r=t,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=()=>{const t=r.clientWaitSync(i,0,0);return t===r.ALREADY_SIGNALED||t===r.CONDITION_SATISFIED},e=i}else Object(d.Me)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(e,Object(d.Me)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:e,isFencePassed:n}}downloadMatrixFromPackedTexture(t,e,n){return this.downloadMatrixDriver(t,()=>function(t,e,n){const r=new Float32Array(e*n*4);return gg(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}(this.gl,e,n))}createProgram(t){this.throwIfDisposed();const e=this.gl,n=vg(e,t),r=Zg(e),i=function(t){return Eg(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}(e);return gg(e,()=>e.attachShader(i,r)),gg(e,()=>e.attachShader(i,n)),function(t,e){if(gg(t,()=>t.linkProgram(e)),!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}(e,i),this.debug&&wg(e,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=function(t,e,n){return gg(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),kg(t,e,"clipSpacePos",n,3,20,0)&&kg(t,e,"uv",n,2,20,12)}(e,this.program,this.vertexBuffer)),i}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&gg(this.gl,()=>this.gl.deleteProgram(t))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&wg(this.gl,this.program),gg(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,e,n=!0){return this.throwIfDisposed(),n?function(t,e,n){return Eg(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}(this.gl,t,e):function(t,e,n){return t.getUniformLocation(e,n)}(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),gg(this.gl,()=>this.gl.getAttribLocation(t,e))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),Og(this.gl,t,e,n)}setOutputMatrixTexture(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}setOutputPackedMatrixTexture(t,e,n){this.throwIfDisposed();const[r,i]=pg(e,n);this.setOutputMatrixTextureDriver(t,r,i)}setOutputMatrixWriteRegion(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)}setOutputPackedMatrixWriteRegion(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&wg(this.gl,this.program),Cg(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;this.debug&&this.debugValidate(),gg(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),gg(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=yg(this.gl,2===Object(d.Me)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===Object(d.Me)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===Object(d.Me)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2();return void t.endQuery(e.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await d.qi.repeatedTry(()=>this.disposed||this.isQueryAvailable(t,Object(d.Me)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,Object(d.Me)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(0===e)return null;if(2===e){const e=this.gl;return e.getQueryParameter(t,e.QUERY_RESULT)/1e6}{const e=this.getQueryTimerExtensionWebGL1();return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const e=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const e=this.getQueryTimerExtensionWebGL1(),n=e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(e.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(t){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})}pollItems(){const t=function(t){let e=0;for(;e<t.length;++e){if(!t[e]())break}return e-1}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(this.itemsToPoll.map(t=>t.isDoneFn));for(let e=0;e<=t;++e){const{resolveFn:t}=this.itemsToPoll[e];t()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||d.qi.repeatedTry(()=>(this.pollItems(),0===this.itemsToPoll.length))}bindTextureToFrameBuffer(t){this.throwIfDisposed(),_g(this.gl,t,this.framebuffer),this.debug&&Cg(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(_g(this.gl,this.outputTexture,this.framebuffer),this.debug&&Cg(this.gl)):Ag(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const n=e();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(t,e,n){this.throwIfDisposed();const r=this.gl;_g(r,t,this.framebuffer),this.debug&&Cg(r),this.outputTexture=t,gg(r,()=>r.viewport(0,0,e,n)),gg(r,()=>r.scissor(0,0,e,n))}setOutputMatrixWriteRegionDriver(t,e,n,r){this.throwIfDisposed(),gg(this.gl,()=>this.gl.scissor(t,e,n,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{getBroadcastDims:cb}=d.Ld;function lb(t,e,n,r){const i=[];t.forEach(t=>{const e=d.qi.sizeFromShape(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?i.push(`uniform float ${t.name}${e>1?`[${e}]`:""};`):(i.push(`uniform sampler2D ${t.name};`),i.push(`uniform int offset${t.name};`))});const a=i.join("\n"),o=t.map(t=>function(t,e,n=!1){let r="";r+=n?fb(t):db(t);const i=t.shapeInfo.logicalShape,a=e.logicalShape;i.length<=a.length&&(r+=n?function(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",a=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,s=cb(t.shapeInfo.logicalShape,e.logicalShape),u=xb(o),c=o-a;let l;const f=["x","y","z","w","u","v"];l=0===a?"":o<2&&s.length>=1?"coords = 0;":s.map(t=>`coords.${f[t+c]} = 0;`).join("\n");let h="";h=o<2&&a>0?"coords":t.shapeInfo.logicalShape.map((t,e)=>"coords."+f[e+c]).join(", ");let p="return outputValue;";const m=1===d.qi.sizeFromShape(t.shapeInfo.logicalShape),g=1===d.qi.sizeFromShape(e.logicalShape);if(1!==a||m||g){if(m&&!g)p=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(s.length){const t=a-2,e=a-1;s.indexOf(t)>-1&&s.indexOf(e)>-1?p="return vec4(outputValue.x);":s.indexOf(t)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(e)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${i}() {\n      ${u} coords = getOutputCoords();\n      ${l}\n      vec4 outputValue = get${r}(${h});\n      ${p}\n    }\n  `}(t,e):function(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",a=e.texShape,o=t.shapeInfo.texShape,s=t.shapeInfo.logicalShape.length,u=e.logicalShape.length;if(!t.shapeInfo.isUniform&&s===u&&null==t.shapeInfo.flatOffset&&d.qi.arraysEqual(o,a))return`\n      float ${i}() {\n        return sampleTexture(${n}, resultUV);\n      }\n    `;const c=xb(u),l=cb(t.shapeInfo.logicalShape,e.logicalShape),f=u-s;let h;const p=["x","y","z","w","u","v"];h=0===s?"":u<2&&l.length>=1?"coords = 0;":l.map(t=>`coords.${p[t+f]} = 0;`).join("\n");let m="";m=u<2&&s>0?"coords":t.shapeInfo.logicalShape.map((t,e)=>"coords."+p[e+f]).join(", ");return`\n    float ${i}() {\n      ${c} coords = getOutputCoords();\n      ${h}\n      return get${r}(${m});\n    }\n  `}(t,e));return r}(t,e,r)).join("\n"),s=e.texShape,u=qg(),c=function(t){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${t.texture2D}(textureSampler, uv).r;\n    }\n  `}(u);let l,f,h=function(t){return`${t.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${t.varyingFs} vec2 resultUV;\n    ${t.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${t.defineSpecialNaN}\n    ${t.defineSpecialInf}\n    ${t.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${hb}\n    ${pb}\n    ${mb}\n  `}(u);e.isPacked?(l=function(t,e){switch(t.length){case 0:return bb();case 1:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(1===n[0])return`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${n[1]}.0);\n      }\n    `;if(1===n[1])return`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${n[0]}.0);\n      }\n    `;return`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      return 2 * (resTexRC.x * ${n[1]} + resTexRC.y);\n    }\n  `}(0,e);case 2:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(d.qi.arraysEqual(t,e))return`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${n[0]}, ${n[1]}));\n      }\n    `;const r=Math.ceil(t[1]/2);return`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n      int r = 2 * (index / ${r});\n      int c = imod(index, ${r}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}(t,e);case 3:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),i=r*Math.ceil(t[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n\n      int b = index / ${i};\n      index -= b * ${i};\n\n      int r = 2 * (index / ${r});\n      int c = imod(index, ${r}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}(t,e);default:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2);let a=i,o="",s="b, r, c";for(let e=2;e<t.length-1;e++)a*=t[t.length-e-1],o=`\n      int b${e} = index / ${a};\n      index -= b${e} * ${a};\n    `+o,s=`b${e}, `+s;return`\n    ivec${t.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n\n      ${o}\n\n      int b = index / ${i};\n      index -= b * ${i};\n\n      int r = 2 * (index / ${r});\n      int c = imod(index, ${r}) * 2;\n\n      return ivec${t.length}(${s});\n    }\n  `}(t,e)}}(e.logicalShape,s),f=function(t){return`\n    void setOutput(vec4 val) {\n      ${t.output} = val;\n    }\n  `}(u)):(l=function(t,e){switch(t.length){case 0:return bb();case 1:return function(t,e){if(1===e[0])return`\n      int getOutputCoords() {\n        return int(resultUV.x * ${e[1]}.0);\n      }\n    `;if(1===e[1])return`\n      int getOutputCoords() {\n        return int(resultUV.y * ${e[0]}.0);\n      }\n    `;return`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      return resTexRC.x * ${e[1]} + resTexRC.y;\n    }\n  `}(0,e);case 2:return function(t,e){if(d.qi.arraysEqual(t,e))return`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));\n      }\n    `;if(1===t[1])return`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${e[0]}, ${e[1]}));\n        int index = resTexRC.x * ${e[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `;if(1===t[0])return`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${e[0]}, ${e[1]}));\n        int index = resTexRC.x * ${e[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `;return`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      int r = index / ${t[1]};\n      int c = index - r * ${t[1]};\n      return ivec2(r, c);\n    }\n  `}(t,e);case 3:return function(t,e){const n=Wg(["r","c","d"],t);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      ${n}\n      return ivec3(r, c, d);\n    }\n  `}(t,e);case 4:return function(t,e){const n=Wg(["r","c","d","d2"],t);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      ${n}\n      return ivec4(r, c, d, d2);\n    }\n  `}(t,e);case 5:return function(t,e){const n=Wg(["r","c","d","d2","d3"],t);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},\n                             ${e[1]}));\n\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}(t,e);case 6:return function(t,e){const n=Wg(["r","c","d","d2","d3","d4"],t);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}}(e.logicalShape,s),f=function(t){return`\n    void setOutput(float val) {\n      ${t.output} = vec4(val, 0, 0, 0);\n    }\n  `}(u)),r&&(h+=gb);return[h,c,f,a,l,o,n].join("\n")}function db(t){const e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return`float ${n}() {return ${e};}`;const[r,i]=t.shapeInfo.texShape;if(1===r&&1===i)return`\n      float ${n}() {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const[a,o]=t.shapeInfo.texShape,s=yb(e);return`\n    float ${n}() {\n      vec2 uv = uvFromFlat(${a}, ${o}, ${s});\n      return sampleTexture(${e}, uv);\n    }\n  `}(t);case 1:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return`\n      float ${n}(int index) {\n        ${vb(t)}\n      }\n    `;const r=t.shapeInfo.texShape,i=r[0],a=r[1];if(1===a&&1===i)return`\n      float ${n}(int index) {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const o=yb(e);if(1===a)return`\n      float ${n}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${i}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `;if(1===i)return`\n      float ${n}(int index) {\n        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${a}.0, 0.5);\n        return sampleTexture(${e}, uv);\n      }\n    `;return`\n    float ${n}(int index) {\n      vec2 uv = uvFromFlat(${i}, ${a}, index + ${o});\n      return sampleTexture(${e}, uv);\n    }\n  `}(t);case 2:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape;if(null!=i&&d.qi.arraysEqual(e,i)){const t=i[0],e=i[1];return`\n    float ${r}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${e}.0, ${t}.0);\n      return sampleTexture(${n}, uv);\n    }\n  `}const{newShape:a,keptDims:o}=d.qi.squeezeShape(e),s=a;if(s.length<e.length){const e=wb(t,s),n=["row","col"];return`\n      ${db(e)}\n      float ${r}(int row, int col) {\n        return ${r}(${kb(n,o)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${r}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${e[1]}, 1)));\n        ${vb(t)}\n      }\n    `;const u=i[0],c=i[1],l=yb(n);if(1===c)return`\n    float ${r}(int row, int col) {\n      float index = dot(vec3(row, col, ${l}), vec3(${e[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);\n      return sampleTexture(${n}, uv);\n    }\n  `;if(1===u)return`\n    float ${r}(int row, int col) {\n      float index = dot(vec3(row, col, ${l}), vec3(${e[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);\n      return sampleTexture(${n}, uv);\n    }\n  `;return`\n  float ${r}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${e[1]} + col + ${l};\n    vec2 uv = uvFromFlat(${u}, ${c}, index);\n    return sampleTexture(${n}, uv);\n  }\n`}(t);case 3:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e[1]*e[2],a=e[2],{newShape:o,keptDims:s}=d.qi.squeezeShape(e),u=o;if(u.length<e.length){const e=wb(t,u),n=["row","col","depth"];return`\n        ${db(e)}\n        float ${r}(int row, int col, int depth) {\n          return ${r}(${kb(n,s)});\n        }\n      `}if(t.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${i}, ${a}, 1)));\n        ${vb(t)}\n      }\n    `;const c=t.shapeInfo.texShape,l=c[0],f=c[1],h=t.shapeInfo.flatOffset;if(f===i&&null==h)return`\n        float ${r}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${a}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${f}.0, ${l}.0);\n          return sampleTexture(${n}, uv);\n        }\n      `;if(f===a&&null==h)return`\n    float ${r}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${e[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}.0, ${l}.0);\n      return sampleTexture(${n}, uv);\n    }\n  `;const p=yb(n);return`\n      float ${r}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${i} + col * ${a} + depth + ${p};\n        vec2 uv = uvFromFlat(${l}, ${f}, index);\n        return sampleTexture(${n}, uv);\n      }\n  `}(t);case 4:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e[3],a=e[2]*i,o=e[1]*a,{newShape:s,keptDims:u}=d.qi.squeezeShape(e);if(s.length<e.length){const e=wb(t,s),n=["row","col","depth","depth2"];return`\n      ${db(e)}\n      float ${r}(int row, int col, int depth, int depth2) {\n        return ${r}(${kb(n,u)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${o}, ${a}, ${i}, 1)));\n        ${vb(t)}\n      }\n    `;const c=t.shapeInfo.flatOffset,l=t.shapeInfo.texShape,f=l[0],h=l[1];if(h===o&&null==c)return`\n      float ${r}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${a}, ${i}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${h}.0, ${f}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(h===i&&null==c)return`\n      float ${r}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${e[1]*e[2]}, ${e[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${h}.0, ${f}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;const p=yb(n);return`\n    float ${r}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${o} + col * ${a} +\n          depth * ${i} + depth2;\n      vec2 uv = uvFromFlat(${f}, ${h}, index + ${p});\n      return sampleTexture(${n}, uv);\n    }\n  `}(t);case 5:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e[4],a=e[3]*i,o=e[2]*a,s=e[1]*o,{newShape:u,keptDims:c}=d.qi.squeezeShape(e);if(u.length<e.length){const e=wb(t,u),n=["row","col","depth","depth2","depth3"];return`\n      ${db(e)}\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        return ${r}(${kb(n,c)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${s}, ${o}, ${a}, ${i})) +\n          depth3;\n        ${vb(t)}\n      }\n    `;const l=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,h=f[0],p=f[1];if(p===s&&null==l)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${o}, ${a}, ${i}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${h}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(p===i&&null==l)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${e[1]*e[2]*e[3]},\n               ${e[2]*e[3]}, ${e[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${h}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;const m=yb(n);return`\n    float ${r}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${s} + col * ${o} + depth * ${a} +\n          depth2 * ${i} + depth3 + ${m};\n      vec2 uv = uvFromFlat(${h}, ${p}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(t);case 6:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:a}=d.qi.squeezeShape(e);if(i.length<e.length){const e=wb(t,i),n=["row","col","depth","depth2","depth3","depth4"];return`\n      ${db(e)}\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${r}(${kb(n,a)});\n      }\n    `}const o=e[5],s=e[4]*o,u=e[3]*s,c=e[2]*u,l=e[1]*c;if(t.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${l}, ${c}, ${u}, ${s})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${o}, 1)));\n        ${vb(t)}\n      }\n    `;const f=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,p=h[0],m=h[1];if(m===l&&null==f)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${c}, ${u}, ${s}, ${o})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${m}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(m===o&&null==f)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${e[1]*e[2]*e[3]*e[4]},\n               ${e[2]*e[3]*e[4]},\n               ${e[3]*e[4]},\n               ${e[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${m}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;const g=yb(n);return`\n    float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${l} + col * ${c} + depth * ${u} +\n          depth2 * ${s} + depth3 * ${o} + depth4 + ${g};\n      vec2 uv = uvFromFlat(${p}, ${m}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(t);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function fb(t){switch(t.shapeInfo.logicalShape.length){case 0:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=qg();return`\n    vec4 ${n}() {\n      return ${r.texture2D}(${e}, halfCR);\n    }\n  `}(t);case 1:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=qg();return`\n    vec4 ${n}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${i[0]}, ${i[1]}, index);\n      return ${a.texture2D}(${e}, uv);\n    }\n  `}(t);case 2:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,a=i[0],o=i[1],s=qg();if(null!=i&&d.qi.arraysEqual(e,i))return`\n      vec4 ${r}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${a}.0);\n\n        return ${s.texture2D}(${n}, uv);\n      }\n    `;const u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],c=Math.ceil(e[1]/2);return`\n    vec4 ${r}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);\n      return ${s.texture2D}(${n}, uv);\n    }\n  `}(t);case 3:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===e[0]){const n=e.slice(1),i=[1,2],a=wb(t,n),o=["b","row","col"];return`\n        ${fb(a)}\n        vec4 ${r}(int b, int row, int col) {\n          return ${r}(${kb(o,i)});\n        }\n      `}const o=a[0],s=a[1],u=Math.ceil(e[2]/2),c=u*Math.ceil(e[1]/2),l=qg();return`\n    vec4 ${r}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${o}, ${s}, ${c}, ${u}, b, row, col);\n      return ${l.texture2D}(${n}, uv);\n    }\n  `}(t);default:return function(t){const e=t.shapeInfo.logicalShape,n=e.length,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],s=o[0],u=o[1],c=Math.ceil(e[n-1]/2);let l=c*Math.ceil(e[n-2]/2),d="int b, int row, int col",f=`b * ${l} + (row / 2) * ${c} + (col / 2)`;for(let t=2;t<n-1;t++)d=`int b${t}, `+d,l*=e[n-t-1],f=`b${t} * ${l} + `+f;const h=qg();return`\n    vec4 ${i}(${d}) {\n      int index = ${f};\n      int texR = index / ${u};\n      int texC = index - texR * ${u};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${s});\n      return ${h.texture2D}(${r}, uv);\n    }\n  `}(t)}}const hb="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",pb="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",mb="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",gb="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function bb(){return"\n    int getOutputCoords() {\n      return 0;\n    }\n  "}function yb(t){return"offset"+t}function vb(t){const e=t.name,n=d.qi.sizeFromShape(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`\n    for (int i = 0; i < ${n}; i++) {\n      if (i == index) {\n        return ${e}[i];\n      }\n    }\n  `}function xb(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function wb(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function kb(t,e){return e.map(e=>t[e]).join(", ")}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ob(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((t,n)=>{const r=t.logicalShape,i=e[n],a=i.shape;if(!d.qi.arraysEqual(r,a))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${a} must match`);if(t.isUniform&&i.isUniform)return;const o=t.texShape,s=i.isUniform?null:i.texData.texShape;if(!d.qi.arraysEqual(o,s))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${s} must match`)})}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const{addImpl:_b,bincountImpl:Ab,bincountReduceImpl:Cb,ceilImpl:Eb,concatImpl:Sb,expImpl:jb,expm1Impl:Nb,floorImpl:Tb,gatherV2Impl:Fb,greaterImpl:Db,lessImpl:Ib,linSpaceImpl:Mb,logImpl:$b,maxImpl:Rb,maximumImpl:Bb,minimumImpl:zb,multiplyImpl:Lb,negImpl:Pb,prodImpl:qb,rangeImpl:Wb,rsqrtImpl:Ub,simpleAbsImpl:Vb,sliceImpl:Gb,stridedSliceImpl:Hb,subImpl:Xb,tileImpl:Kb,topKImpl:Yb,transposeImpl:Jb,uniqueImpl:Zb}=l;
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qb(t,e){return["x","y","z","w","u","v"].slice(0,e).map(e=>`${t}.${e}`)}function ty(t,e){return 1===e?[t]:Qb(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ey{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;const e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const n=ty("rc",e),r=xb(e),i=function(t,e,n){if(1===t)return"rc > "+e[0];let r="";for(let i=t-2;i<t;i++)r+=`${n[i]} >= ${e[i]}`,i<t-1&&(r+="||");return r}(e,t,n),a=function(t,e,n,r){if(1===t)return"";const i=r.slice(-2);return`\n    int r = ${i[0]};\n    int c = ${i[1]};\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ${e};\n    bool rEdge = rp1 >= ${n};\n  `}(e,t[t.length-1],t[t.length-2],n),o=function(t,e){const n=t.length,r=function(t,e){const n=[];for(let r=0;r<=1;r++)for(let i=0;i<=1;i++){let a=`${0===r?"r":"rp1"}, ${0===i?"c":"cp1"}`;for(let n=2;n<t;n++)a=e[e.length-1-n]+","+a;n.push(a)}return n}(n,e);if(1===n)return`getA(rc),\n            rc + 1 >= ${t[0]} ? 0. : getA(rc + 1),\n            0, 0`;return`getA(${r[0]}),\n          cEdge ? 0. : getA(${r[1]}),\n          rEdge ? 0. : getA(${r[2]}),\n          rEdge || cEdge ? 0. : getA(${r[3]})`}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(t,n);this.userCode=`\n        void main() {\n          ${r} rc = getOutputCoords();\n\n          if(${i}) {\n            setOutput(vec4(0));\n          } else {\n            ${a}\n\n            setOutput(vec4(${o}));\n          }\n        }\n      `}}}class ny{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;let n="";for(let t=0;t<4;t++){let e="thisRC = rc;";t%2==1&&(e+="thisRC.z += 1;"),t>1&&(e+="thisRC.y += 1;"),n+=`\n        ${e}\n        ${t>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${t}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${t>0?"}":""}\n      `}var r;
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */this.userCode=`\n      ${r=e,`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${Wg(["r","c","d"],r)}\n      return ivec3(r, c, d);\n    }\n  `}\n      ${Ug(t)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${t[1]};\n        int cols = ${t[2]};\n\n        ${n}\n\n        setOutput(result);\n      }\n    `}}class ry{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(t,e,n){const r=ay(e,n),i=oy(t,r,n);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const a=iy(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();const t=this.freeTextures[i].shift();return this.usedTextures[i].push(t),t}let o;return r===dg.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===dg.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===dg.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===dg.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===dg.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[i].push(o),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),o}releaseTexture(t,e,n,r){if(null==this.freeTextures)return;const i=ay(n,r),a=oy(e,i,r);a in this.freeTextures||(this.freeTextures[a]=[]);const o=iy(e,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=Object(d.Me)().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(t),this._numBytesAllocated-=o):(this.freeTextures[a].push(t),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const u=this.usedTextures[a],c=u.indexOf(t);if(c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(c,1),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const e=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: "+this._numBytesAllocated),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*e)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach(t=>{this.gpgpu.deleteMatrixTexture(t)});for(const t in this.usedTextures)this.usedTextures[t].forEach(t=>{this.gpgpu.deleteMatrixTexture(t)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function iy(t,e,n,r,i){const a=function(t,e){switch(t){case dg.PACKED_2X2_FLOAT32:return ab(e);case dg.PACKED_2X2_FLOAT16:return ob(e);case dg.UNPACKED_FLOAT32:return nb(e);case dg.UNPACKED_FLOAT16:return rb(e);case dg.PACKED_4X1_UNSIGNED_BYTE:return ib(e);default:throw new Error("Unknown physical texture type "+t)}}(e,r);let o;if(i){const[e,n]=pg(t[0],t[1]);o=e*n}else{const[e,n]=fg(t[0],t[1]);o=e*n}return o*function(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;throw new Error("Unknown internal format "+e)}(n,a)}function ay(t,e){if(t===lg.UPLOAD)return dg.PACKED_2X2_FLOAT32;if(t===lg.RENDER||null==t)return function(t){return Object(d.Me)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?dg.PACKED_2X2_FLOAT32:dg.UNPACKED_FLOAT32:t?dg.PACKED_2X2_FLOAT16:dg.UNPACKED_FLOAT16}(e);if(t===lg.DOWNLOAD||t===lg.PIXELS)return dg.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function oy(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sy{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode=`\n      float unaryOperation(float x) {\n        ${e}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const uy="return abs(x);";const cy="return x;";class ly{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${e}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dy{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;const e=t.length,n=ty("rc",e),r=xb(e),i=function(t,e){if(1===t)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),a=n.slice(-2),o=e<=1?"rc":`vec2(${a.join(",")})`;this.userCode=`\n      void main() {\n        ${r} rc = getOutputCoords();\n        vec4 packedInput = getA(${i});\n\n        setOutput(getChannel(packedInput, ${o}));\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fy=d.yf.whereImpl,hy={};class py extends d.Cb{constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.warnedAboutCPUBackend=!1,this.pendingDeletes=0,this.disposed=!1,!Object(d.Me)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){const t=ug(Object(d.Me)().getNumber("WEBGL_VERSION"));this.binaryCache=((e=Object(d.Me)().getNumber("WEBGL_VERSION"))in hy||(hy[e]={}),hy[e]),this.gpgpu=new ub(t),this.canvas=t.canvas,this.gpgpuCreatedLocally=!0}else this.gpgpu=t,this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;var e;this.textureManager=new ry(this.gpgpu),this.numMBBeforeWarning=null==Object(d.Me)().global.screen?1024:Object(d.Me)().global.screen.height*Object(d.Me)().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new d.Q(this,Object(d.Le)())}numDataIds(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}write(t,e,n){if((Object(d.Me)().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Object(d.Me)().getBool("DEBUG"))&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:lg.UPLOAD,refCount:1,complexParentRefCount:0}),r}incRef(t){this.texData.get(t).refCount++}decRef(t){if(this.texData.has(t)){this.texData.get(t).refCount--}}move(t,e,n,r){if(Object(d.Me)().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:lg.UPLOAD,refCount:1,complexParentRefCount:0})}disposeIntermediateTensorInfo(t){const e=t.dataId;if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--,t.refCount<1&&this.disposeData(e)}}readSync(t){const e=this.texData.get(t),{values:n,dtype:r,complexTensorInfos:i,slice:a,shape:o,isPacked:s}=e;if(null!=a){let e;e=s?new ly(o,cy):new sy(o,cy);const n=this.runWebGLProgram(e,[{dataId:t,shape:o,dtype:r}],r),i=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),i}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;const u=null!=this.activeTimers;let c,l;if(u&&(c=d.qi.now()),"complex64"===r){const t=this.readSync(i.real.dataId),e=this.readSync(i.imag.dataId);l=d.Ld.mergeRealAndImagArrays(t,e)}else l=this.getValuesFromTexture(t);return u&&(this.downloadWaitMs+=d.qi.now()-c),this.convertAndCacheOnCPU(t,l)}async read(t){if(this.pendingRead.has(t)){const e=this.pendingRead.get(t);return new Promise(t=>e.push(t))}const e=this.texData.get(t),{values:n,shape:r,slice:i,dtype:a,complexTensorInfos:o,isPacked:s}=e;if(null!=i){let e;e=s?new ly(r,cy):new sy(r,cy);const n=this.runWebGLProgram(e,[{dataId:t,shape:r,dtype:a}],a),i=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),i}if(null!=n)return this.convertAndCacheOnCPU(t);if(!Object(d.Me)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===Object(d.Me)().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u,c,l=null;if("complex64"!==a&&Object(d.Me)().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(t);const e=this.texData.get(u.dataId);l=this.gpgpu.createBufferFromTexture(e.texture,...hg(r))}if(this.pendingRead.set(t,[]),"complex64"!==a&&await this.gpgpu.createAndWaitForFence(),"complex64"===a){const t=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),e=t[0],n=t[1];c=d.Ld.mergeRealAndImagArrays(e,n)}else if(null==l)c=this.getValuesFromTexture(t);else{const t=d.qi.sizeFromShape(r);c=this.gpgpu.downloadFloat32MatrixFromBuffer(l,t)}null!=u&&this.disposeIntermediateTensorInfo(u);const f=this.convertAndCacheOnCPU(t,c),h=this.pendingRead.get(t);return this.pendingRead.delete(t),h.forEach(t=>t(f)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),f}bufferSync(t){const e=this.readSync(t.dataId);let n=e;if("string"===t.dtype)try{n=e.map(t=>d.qi.decodeString(t))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return Object(d.Wd)(t.shape,t.dtype,n)}checkNumericalProblems(t){if(null!=t)for(let e=0;e<t.length;e++){const n=t[e];if(!bg(n)){if(Object(d.Me)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`);throw Error(`The value ${n} cannot be represented on this device.`)}}}getValuesFromTexture(t){const{shape:e,dtype:n,isPacked:r}=this.texData.get(t),i=d.qi.sizeFromShape(e);if(Object(d.Me)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(t),r=this.texData.get(n.dataId),a=this.gpgpu.downloadMatrixFromPackedTexture(r.texture,...hg(e)).subarray(0,i);return this.disposeIntermediateTensorInfo(n),a}const a=Object(d.Me)().getBool("WEBGL_PACK")&&!0===r,o=a?Tg(e):e,s=a?new Kg(o):new Xg(o),u=this.runWebGLProgram(s,[{shape:o,dtype:n,dataId:t}],"float32"),c=this.texData.get(u.dataId),l=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture,c.texShape[0],c.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),l}async time(t){const e=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t();const i=d.qi.flatten(this.activeTimers.map(t=>t.query)).filter(t=>null!=t),a=d.qi.flatten(this.activeTimers.map(t=>t.name)).filter(t=>null!=t);this.activeTimers=e,r&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};if(Object(d.Me)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const t=await Promise.all(i);o.kernelMs=d.qi.sum(t),o.getExtraProfileInfo=()=>t.map((t,e)=>({name:a[e],ms:t})).map(t=>`${t.name}: ${t.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Object(d.Me)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:d.qi.now(),endMs:null}}endTimer(t){return Object(d.Me)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=d.qi.now(),t)}async getQueryTime(t){if(Object(d.Me)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const e=t;return e.endMs-e.startMs}disposeData(t){if(this.pendingDisposal.has(t))return;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(!this.texData.has(t))return;if(this.texData.get(t).complexParentRefCount>0)return void this.texData.get(t).refCount--;this.releaseGPUData(t);const{complexTensorInfos:e}=this.texData.get(t);null!=e&&(this.texData.get(e.real.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(e.real),this.texData.get(e.imag.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(e.imag)),this.texData.delete(t)}releaseGPUData(t){const{texture:e,dtype:n,texShape:r,usage:i,isPacked:a,slice:o}=this.texData.get(t),s=o&&o.origDataId||t,u=this.dataRefCount.get(s);u>1?this.dataRefCount.set(s,u-1):(this.dataRefCount.delete(s),null!=e&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(e,r,i,a)));const c=this.texData.get(t);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture}getDataInfo(t){return this.texData.get(t)}getCPUBackend(){return Object(d.Me)().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Object(d.Le)().findBackend("cpu")),this.cpuBackend):null}shouldExecuteOnCPU(t,e=128){const n=this.getCPUBackend();return Object(d.Me)().getBool("IS_TEST")||this.warnedAboutCPUBackend||null!=n||(console.warn("Your application contains ops that are small enough to be executed on the CPU backend, however the CPU backend cannot be found. Consider importing the CPU backend (@tensorflow/tfjs-backend-cpu) for better performance."),this.warnedAboutCPUBackend=!0),null!=n&&t.every(t=>null==this.texData.get(t.dataId).texture&&d.qi.sizeFromShape(t.shape)<e)}getGPGPUContext(){return this.gpgpu}where(t){d.Ld.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return fy(t.shape,e)}packedUnaryOp(t,e,n){const r=new ly(t.shape,e);return this.compileAndRun(r,[t],n)}abs(t){if(this.shouldExecuteOnCPU([t])&&"complex64"!==t.dtype){const e=Vb(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,e)}if(Object(d.Me)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,uy,t.dtype);const e=new sy(t.shape,uy);return this.compileAndRun(e,[t])}makeTensorInfo(t,e,n){let r;if("string"===e&&null!=n&&n.length>0&&d.qi.isString(n[0])){const i=n.map(t=>d.qi.encodeString(t));r=this.write(i,t,e)}else r=this.write(n,t,e);return this.texData.get(r).usage=null,{dataId:r,shape:t,dtype:e}}makeOutput(t,e,n){const{dataId:r}=this.makeTensorInfo(t,e,n);return Object(d.Le)().makeTensorFromDataId(r,t,e,this)}unpackTensor(t){const e=new dy(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new ey(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}packedReshape(t,e){const n=[jg(t.shape),...Ng(t.shape)],r={dtype:t.dtype,shape:n,dataId:t.dataId},i=[jg(e),...Ng(e)],a=new ny(i,n),o=this.runWebGLProgram(a,[r],t.dtype,null,!0);return{dataId:o.dataId,shape:e,dtype:o.dtype}}decode(t){const e=this.texData.get(t),{isPacked:n,shape:r,dtype:i}=e,a=Tg(r);let o;o=n?new Hg(a):new Gg(a);return{dtype:i,shape:r,dataId:this.runWebGLProgram(o,[{shape:a,dtype:i,dataId:t}],i,null,!0).dataId}}runWebGLProgram(t,e,n,r,i=!1){const a=this.makeTensorInfo(t.outputShape,n),o=this.texData.get(a.dataId);if(t.packedOutput&&(o.isPacked=!0),t.outPackingScheme===cg.DENSE){const e=hg(t.outputShape);o.texShape=e.map(t=>2*t)}if(null!=t.outTexUsage&&(o.usage=t.outTexUsage),0===d.qi.sizeFromShape(a.shape))return o.values=d.qi.getTypedArrayFromDType(a.dtype,0),a;const s=[],u=e.map(e=>{if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&d.qi.sizeFromShape(e.shape)<=Object(d.Me)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.packedInputs)e=n.isPacked?this.unpackTensor(e):this.packTensor(e),s.push(e),n=this.texData.get(e.dataId);else if(n.isPacked&&!Dg(n.shape,e.shape)){const t=e,r=e.shape;e.shape=n.shape,e=this.packedReshape(e,r),s.push(e),n=this.texData.get(e.dataId),t.shape=r}return this.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}});this.uploadToGPU(a.dataId);const c={shape:a.shape,texData:o,isUniform:!1},l=function(t,e,n){let r="";e.concat(n).forEach(t=>{const e=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0,n=t.isUniform?"uniform":t.texData.texShape;r+=`${t.shape}_${n}_${e}`});const i=t.userCode;let a=t.constructor.name;return a+="_"+r+"_"+i,a}(t,u,c),f=this.getAndSaveBinary(l,()=>function(t,e,n,r){const i=e.userCode,a=n.map((t,n)=>{const r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}}),o=a.map(t=>t.shapeInfo),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=lb(a,s,i,e.packedInputs),c=t.createProgram(u);let l=null;const f=t.getUniformLocation(c,"NAN",!1);1===Object(d.Me)().getNumber("WEBGL_VERSION")&&(l=t.getUniformLocation(c,"INFINITY",!1));const h={};for(let n=0;n<e.variableNames.length;n++){const r=e.variableNames[n],i=!1;h[r]=t.getUniformLocation(c,r,i),h["offset"+r]=t.getUniformLocation(c,"offset"+r,i)}return{program:e,source:u,webGLProgram:c,uniformLocations:h,inShapeInfos:o,outShapeInfo:s,infLoc:l,nanLoc:f}}(this.gpgpu,t,u,c)),h=null!=this.activeTimers;let p;if(h&&(p=this.startTimer()),function(t,e,n,r,i){Ob(e.inShapeInfos,n),Ob([e.outShapeInfo],[r]);const a=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(a,o[0],o[1]):t.setOutputMatrixTexture(a,o[0],o[1]),t.setProgram(e.webGLProgram),1===Object(d.Me)().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((n,r)=>{const i=e.program.variableNames[r],a=e.uniformLocations[i],o=e.uniformLocations["offset"+i];if(null!=a)if(n.isUniform)if(d.qi.sizeFromShape(n.shape)<2)t.gl.uniform1f(a,n.uniformValues[0]);else{let e=n.uniformValues;e instanceof Float32Array||(e=new Float32Array(e)),t.gl.uniform1fv(a,e)}else null!=n.texData.slice&&null!=o&&t.gl.uniform1i(o,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,a,r)}),null!=i&&i(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,f,u,c,r),s.forEach(t=>this.disposeIntermediateTensorInfo(t)),h&&(p=this.endTimer(p),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(p)})),!Object(d.Me)().getBool("WEBGL_LAZILY_UNPACK")&&o.isPacked&&!1===i){const t=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),t}return a}compileAndRun(t,e,n,r,i=!1){n=n||e[0].dtype;const a=this.runWebGLProgram(t,e,n,r,i);return Object(d.Le)().makeTensorFromDataId(a.dataId,a.shape,a.dtype)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!Object(d.Me)().getBool("IS_TEST")){Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]})}this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Object(d.di)(()=>{if(!Object(d.Me)().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=Object(d.Me)().getBool("DEBUG");Object(d.Me)().set("DEBUG",!1);const e=this.abs(Object(d.gh)(1e-8)).dataSync()[0];if(Object(d.Me)().set("DEBUG",t),e>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(t){const e=this.texData.get(t),{shape:n,dtype:r,values:i,texture:a,usage:o,isPacked:s}=e;if(null!=a)return;const u=null!=this.activeTimers;let c;u&&(c=d.qi.now());let l=e.texShape;if(null==l&&(l=function(t,e=!1){let n=Object(d.Me)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(n*=2,1===(t=t.map((e,n)=>n>=t.length-2?d.qi.nearestLargerEven(t[n]):t[n])).length&&(t=[2,t[0]])),2!==t.length){const e=d.qi.squeezeShape(t);t=e.newShape}let r=d.qi.sizeFromShape(t);if(t.length<=1&&r<=n)return[1,r];if(2===t.length&&t[0]<=n&&t[1]<=n)return t;if(3===t.length&&t[0]*t[1]<=n&&t[2]<=n)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=n&&t[1]*t[2]<=n)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=n&&t[3]<=n)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n)return[t[0],t[1]*t[2]*t[3]];if(e){const e=jg(t);let n=2,i=2;return t.length&&([n,i]=Ng(t)),r=e*(n/2)*(i/2),d.qi.sizeToSquarishShape(r).map(t=>2*t)}return d.qi.sizeToSquarishShape(r)}(n,s),e.texShape=l),null!=i){const t=Tg(n);let a,o=l[1],f=l[0];const h=i instanceof Uint8Array;s?([o,f]=pg(l[0],l[1]),a=new Jg(t,[f,o],h)):a=new Yg(t,[f,o],h);const p=this.makeTensorInfo([f,o],r);this.texData.get(p.dataId).usage=h?lg.PIXELS:lg.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(p.dataId),o,f,i);const m=!0,g=this.runWebGLProgram(a,[p],r,null,m),b=this.texData.get(g.dataId);e.texture=b.texture,e.texShape=b.texShape,e.isPacked=b.isPacked,e.usage=b.usage,this.disposeIntermediateTensorInfo(p),this.texData.delete(g.dataId),e.values=null,u&&(this.uploadWaitMs+=d.qi.now()-c)}else{const t=this.acquireTexture(l,o,r,s);e.texture=t}}convertAndCacheOnCPU(t,e){const n=this.texData.get(t),{dtype:r}=n;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){const n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length);for(let e=0;e<n.length;++e)n[e]=Math.round(t[e]);return n}throw new Error("Unknown dtype "+e)}
/** @license See the LICENSE file. */(e,r)),n.values}acquireTexture(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const t=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${t} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,e,r)}computeBytes(t,e){return t[0]*t[1]*d.qi.bytesPerElement(e)}}
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
d.we.isBrowser()&&Object(d.Rg)("webgl",()=>new py,2);class my{constructor(t,e,n){this.variableNames=["A","B"],this.outputShape=d.Ld.assertAndGetBroadcastShape(e,n),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${t}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gy{constructor(t,e,n,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=d.Ld.assertAndGetBroadcastShape(e,n);const i=this.outputShape.length;let a="";if(r)if(0===i||1===d.qi.sizeFromShape(this.outputShape))a="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{if(a=`\n          ${xb(i)} coords = getOutputCoords();\n        `,1===i)a+=`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const t=ty("coords",i);a+=`\n            bool nextRowOutOfBounds =\n              (${t[i-2]} + 1) >= ${this.outputShape[i-2]};\n            bool nextColOutOfBounds =\n              (${t[i-1]} + 1) >= ${this.outputShape[i-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${t}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${a}\n\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function by(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const yy={kernelName:d.xb,backendName:"webgl",kernelFunc:by};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vy(t){const{inputs:e,backend:n}=t,{real:r,imag:i}=e,a=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(a.dataId),s=by({inputs:{x:r},backend:n});n.texData.get(s.dataId).complexParentRefCount++;const u=by({inputs:{x:i},backend:n});return n.texData.get(u.dataId).complexParentRefCount++,o.complexTensorInfos={real:s,imag:u},a}const xy={kernelName:d.D,backendName:"webgl",kernelFunc:vy},wy="return (a < 0.) ? b * a : a;",ky="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oy={kernelName:d.Fb,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{alpha:a}=r,o=n.makeTensorInfo([],"float32",d.qi.createScalarValue(a,"float32")),s=Object(d.Me)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new gy(ky,i.shape,o.shape):new my(wy,i.shape,o.shape),u=n.runWebGLProgram(s,[i,o],i.dtype);return n.disposeIntermediateTensorInfo(o),u}},_y="return (a < 0.) ? b * a : a;",Ay="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cy={kernelName:d.rc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r,alpha:i}=e,a=Object(d.Me)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new gy(Ay,r.shape,i.shape):new my(_y,r.shape,i.shape);return n.runWebGLProgram(a,[r,i],r.dtype)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ey({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:i,backend:a})=>{const{x:o}=i,s=a,u=r||o.dtype;if(s.shouldExecuteOnCPU([o])&&null!=n){const t=s.texData.get(o.dataId),e=n(t.values,u);return s.makeTensorInfo(o.shape,u,e)}let c;return c=Object(d.Me)().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=e?new ly(o.shape,e):new sy(o.shape,t),s.runWebGLProgram(c,[o],u)}}function Sy({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:a}){return({inputs:o,backend:s})=>{const{a:u,b:c}=o,l=s;if(r&&"complex64"===u.dtype){const e=l.texData.get(u.dataId),n=l.texData.get(c.dataId),[r,i]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map(e=>{const[n,r]=e,i={dataId:n.dataId,dtype:n.dtype,shape:u.shape},a={dataId:r.dataId,dtype:r.dtype,shape:c.shape},o=new my(t,u.shape,c.shape);return l.runWebGLProgram(o,[i,a],Object(d.pi)(n.dtype,r.dtype))}),a=vy({inputs:{real:r,imag:i},backend:l});return l.disposeIntermediateTensorInfo(r),l.disposeIntermediateTensorInfo(i),a}const f=a||Object(d.pi)(u.dtype,c.dtype);if(l.shouldExecuteOnCPU([u,c])&&null!=i){const t=l.texData.get(u.dataId),e=l.texData.get(c.dataId),[n,r]=i(u.shape,c.shape,t.values,e.values,f),a=l.makeTensorInfo(r,f);return l.texData.get(a.dataId).values=n,a}let h;return h=Object(d.Me)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=e?new gy(e,u.shape,c.shape,n):new my(t,u.shape,c.shape),l.runWebGLProgram(h,[u,c],f)}}function jy(t,e=!1){if("linear"===t)return"return x;";if("relu"===t)return e?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n";if("elu"===t)return e?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===t)return e?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n";if("prelu"===t)return e?Ay:_y;if("leakyrelu"===t)return e?ky:wy;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ny{constructor(t,e,n,r=!1,i=!1,a=!1,o=null,s=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;const c=r?t[1]:t[2],l=Math.ceil(c/2),d=r?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",h=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",g="";o&&(m=s?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${o}\n        }`:u?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${o}\n        }`:`vec4 activation(vec4 x) {\n          ${o}\n        }`,g="result = activation(result);");const b=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let y="rc.x",v="rc.x";t[0]<e[0]?y=`int(min(float(rc.x), ${t[0]-1}.))`:e[0]<t[0]&&(v=`int(min(float(rc.x), ${e[0]-1}.))`),this.userCode=`\n      ${m}\n\n      const float sharedDimension = ${l}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ${l}; i++) {\n          int batchA = ${y};\n          int batchB = ${v};\n          vec4 a = getMatrixA(batchA, ${d});\n          vec4 b = getMatrixB(batchB, ${f});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${h[0]} * ${p[0]});\n          result += (${h[1]} * ${p[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${b}\n\n        ${g}\n\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ty="return areal * breal - aimag * bimag;",Fy="return areal * bimag + aimag * breal;";class Dy{constructor(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=d.Ld.assertAndGetBroadcastShape(e,n),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${t}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iy="return a * b;";function My(t){const{inputs:e,backend:n}=t,{a:r,b:i}=e,a=d.Ld.upcastType(r.dtype,i.dtype);if("complex64"===r.dtype){const t=n.texData.get(r.dataId),e=n.texData.get(i.dataId),a=new Dy(Ty,r.shape,i.shape),o=new Dy(Fy,r.shape,i.shape),s=[{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:r.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:i.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:i.shape}],u=n.runWebGLProgram(a,s,"float32"),c=n.runWebGLProgram(o,s,"float32"),l=vy({inputs:{real:u,imag:c},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),l}if(n.shouldExecuteOnCPU([r,i])){const t=n.texData.get(r.dataId),e=n.texData.get(i.dataId),[o,s]=Lb(r.shape,i.shape,t.values,e.values,a),u=n.makeTensorInfo(s,a);return n.texData.get(u.dataId).values=o,u}let o;return o=Object(d.Me)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new gy(Iy,r.shape,i.shape):new my(Iy,r.shape,i.shape),n.runWebGLProgram(o,[r,i],a)}const $y={kernelName:d.dc,backendName:"webgl",kernelFunc:My};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ry(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{shape:a}=r,o=n,s=d.qi.sizeFromShape(i.shape),u=d.qi.inferFromImplicitShape(a,s),c=d.qi.sizeFromShape(u);d.qi.assert(s===c,()=>`The new shape (${u}) has ${c} elements and the old shape (${i.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`);const l=o.texData.get(i.dataId);return!l.isPacked||Dg(i.shape,u)||null!==l.texture&&Dg(l.shape,u)?(o.incRef(i.dataId),{dataId:i.dataId,shape:u,dtype:i.dtype}):function(t,e,n){const r=[jg(t.shape),...Ng(t.shape)],i={dtype:t.dtype,shape:r,dataId:t.dataId},a=[jg(e),...Ng(e)],o=new ny(a,r),s=n.runWebGLProgram(o,[i],t.dtype,null,!0);return{dataId:s.dataId,shape:e,dtype:s.dtype}}(i,u,o)}const By={kernelName:d.Cc,backendName:"webgl",kernelFunc:Ry};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zy{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:a}=t;this.outputShape=[r,a];const o=4*Math.floor(n/4),s=n%4;let u="sumValue += dot(values, ones);";if(null!=e){const t=1/e;u=`sumValue += dot(values * ${d.qi.isInt(t)?t.toPrecision(2):t}, ones);`}let c="";i%n>0&&(c=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return 0.0;\n        }\n      `),this.userCode=`\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${c}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${o}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${u}\n        }\n\n        int inIdx = inOffset + ${o};\n        if (${1===s}) {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ${u}\n        } else if (${2===s}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ${u}\n        } else if (${3===s}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ${u}\n        }\n        setOutput(sumValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ly{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:a}=t;this.outputShape=[r,a];let o="0.0",s="";"prod"===e?o="1.0":"min"===e?(o="1.0 / 1e-20",s="min"):"max"===e&&(o="-1.0 / 1e-20",s="max");let u=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");const c=4*Math.floor(n/4),l=n%4;let d=`\n      if (${"sum"===e}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===e}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${s}(values, minMaxValue);\n      }\n    `,f="vec4";"all"===e?(o="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",f="bvec4"):"any"===e&&(o="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",f="bvec4");let h="";i%n>0&&(h=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${o};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${h}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        vec4 minMaxValue = vec4(${o});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${c}; i += 4) {\n          int inIdx = inOffset + i;\n          ${f} values = ${f}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${d}\n        }\n\n        int inIdx = inOffset + ${c};\n        if (${1===l}) {\n          ${f} values = ${f}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${d}\n        } else if (${2===l}) {\n          ${f} values = ${f}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${d}\n        } else if (${3===l}) {\n          ${f} values = ${f}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${d}\n        }\n        setOutput(${u});\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Py(t,e,n,r){const i=function(t){const e=[];for(;0===e.length||1!==e[e.length-1].outSize;){const n=e.length?e[e.length-1].outSize:t[1],r=d.Ld.computeOptimalWindowSize(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}(t.shape);let a=t;for(let o=0;o<i.length;o++){const{inSize:s,windowSize:u,outSize:c}=i[o];let l,d;l="mean"===n?0===o?new zy({windowSize:u,inSize:s,batchSize:t.shape[0],outSize:c},s):new zy({windowSize:u,inSize:s,batchSize:t.shape[0],outSize:c}):new Ly({windowSize:u,inSize:s,batchSize:t.shape[0],outSize:c},n),d=a,a=r.runWebGLProgram(l,[a],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return a}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qy{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;const r=xb(this.rank),i=function(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let e=0;e<t.length;e++)r[t[e]]=n[e];return r.join()}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(e);this.userCode=`\n    void main() {\n      ${r} resRC = getOutputCoords();\n      setOutput(getA(${i}));\n    }\n    `}}class Wy{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=xb(this.rank),i=Qb("rc",this.rank),a=new Array(this.rank);for(let t=0;t<e.length;t++)a[e[t]]=i[t];const o=`vec2(${a.slice(-2).join()})`,s=`++${i[this.rank-1]} < ${n[this.rank-1]}`,u=`getChannel(getA(${a.join()}), ${o})`;this.userCode=`\n    void main() {\n      ${r} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${u};\n      if(${s}) {\n        result[1] = ${u};\n      }\n      --${i[this.rank-1]};\n      if(++${i[this.rank-2]} < ${n[this.rank-2]}) {\n        result[2] = ${u};\n        if(${s}) {\n          result[3] = ${u};\n        }\n      }\n      setOutput(result);\n    }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uy(t,e,n){const r=Object(d.Me)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Wy(t.shape,e):new qy(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Vy(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:o}=r;return function(t,e,n,r){const i=e,a=t.shape.length,o=d.qi.parseAxisParam(i,t.shape);let s=o;const u=d.Ld.getAxesPermutation(s,a),c=null!=u;let l=t;c&&(l=Uy(t,u,r),s=d.Ld.getInnerMostAxes(s.length,a)),d.Ld.assertAxesAreInnerMostDims("sum",s,a);const[f,h]=d.Ld.computeOutAndReduceShapes(l.shape,s);let p=f;n&&(p=d.Ld.expandShapeToKeepDim(f,o));const m=d.qi.sizeFromShape(h),g=Ry({inputs:{x:l},attrs:{shape:[d.qi.sizeFromShape(t.shape)/m,m]},backend:r}),b=Py(g,Object(d.Rh)(t.dtype),"sum",r),y=Ry({inputs:{x:b},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(b),c&&r.disposeIntermediateTensorInfo(l),y}(i,a,o,n)}const Gy={kernelName:d.fd,backendName:"webgl",kernelFunc:Vy};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hy(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{perm:a}=r,o=n,s=i.shape.length,u=new Array(s);for(let t=0;t<u.length;t++)u[t]=i.shape[a[t]];let c;if(o.shouldExecuteOnCPU([i])){const t=o.texData.get(i.dataId).values,e=Jb(t,i.shape,i.dtype,a,u);c=o.makeTensorInfo(u,i.dtype);o.texData.get(c.dataId).values=e}else c=Uy(i,a,o);return c}const Xy={kernelName:d.md,backendName:"webgl",kernelFunc:Hy};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ky({a:t,b:e,transposeA:n,transposeB:r,backend:i,bias:a=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:u=null}){const c=t.shape.length,l=e.shape.length,f=n?t.shape[c-2]:t.shape[c-1],h=r?e.shape[l-1]:e.shape[l-2],p=n?t.shape[c-1]:t.shape[c-2],m=r?e.shape[l-2]:e.shape[l-1],g=t.shape.slice(0,-2),b=e.shape.slice(0,-2),y=d.qi.sizeFromShape(g),v=d.qi.sizeFromShape(b),x=y===v||1===y||1===v;d.qi.assert(c>=2&&l>=2&&x,()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${g}) and (${b}).`);const w=(y>v?t.shape.slice(0,-2):e.shape.slice(0,-2)).concat([p,m]);d.qi.assert(f===h,()=>`Error in matMul: inner shapes (${f}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const k=n?[y,f,p]:[y,p,f],O=r?[v,m,h]:[v,h,m],_=Ry({inputs:{x:t},backend:i,attrs:{shape:k}}),A=Ry({inputs:{x:e},backend:i,attrs:{shape:O}}),C=[_,A],E=Math.max(y,v),S=n?_.shape[1]:_.shape[2],j=null!=a,N=null!=o,T="leakyrelu"===u,F=null!=u?jy(u,!0):null;let D;if((1===p||1===m)&&S>1e3&&!1===(j||N||T||null!=F)){let t=_,e=A;n&&(t=Hy({inputs:{x:_},backend:i,attrs:{perm:[0,2,1]}}),C.push(t)),r&&(e=Hy({inputs:{x:A},backend:i,attrs:{perm:[0,2,1]}}),C.push(e));const a=1===m;let o=t;1!==m&&(o=Ry({inputs:{x:t},backend:i,attrs:{shape:[E,S,1]}}),C.push(o));const s=1===m?2:1;let u=e;a&&(u=Ry({inputs:{x:e},backend:i,attrs:{shape:[E,1,S]}}),C.push(u));const c=My({inputs:{a:o,b:u},backend:i});D=Vy({inputs:{x:c},backend:i,attrs:{axis:s,keepDims:!0}}),C.push(c)}else{const u=Object(d.pi)(t.dtype,e.dtype),c=new Ny(k,O,[E,p,m],n,r,j,F,N,T),l=[_,A];if(null!=a&&l.push(a),N&&l.push(o),T){const t=i.makeTensorInfo([],"float32",d.qi.createScalarValue(s,"float32"));l.push(t),C.push(t)}D=i.runWebGLProgram(c,l,u)}const I=Ry({inputs:{x:D},backend:i,attrs:{shape:w}});C.push(D);for(const t of C)i.disposeIntermediateTensorInfo(t);return I}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yy={kernelName:d.sd,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:a,bias:o,preluActivationWeights:s}=e,{transposeA:u,transposeB:c,activation:l,leakyreluAlpha:d}=r;return Ky({a:i,b:a,transposeA:u,transposeB:c,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:d,activation:l})}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jy={kernelName:d.a,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const t=n.texData.get(r.dataId),e=Vb(t.values);return n.makeTensorInfo(r.shape,r.dtype,e)}let i;return i=Object(d.Me)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new ly(r.shape,"return abs(x);"):new sy(r.shape,"return abs(x);"),n.runWebGLProgram(i,[r],r.dtype)}},Zy=Ey({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),Qy={kernelName:d.b,backendName:"webgl",kernelFunc:Zy},tv=Ey({opSnippet:"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),ev={kernelName:d.c,backendName:"webgl",kernelFunc:tv},nv="return a + b;",rv=Sy({opSnippet:nv,packedOpSnippet:nv,supportsComplex:!0,cpuKernelImpl:_b}),iv={kernelName:d.h,backendName:"webgl",kernelFunc:rv};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class av{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((t,e)=>"T"+e);const n=[];this.variableNames.forEach(t=>{n.push(`float v${t} = get${t}AtOutCoords();`)});const r=this.variableNames.map(t=>"v"+t).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        float result = ${r};\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ov{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((t,e)=>"T"+e);const n=[];this.variableNames.forEach(t=>{n.push(`vec4 v${t} = get${t}AtOutCoords();`)});const r=this.variableNames.map(t=>"v"+t).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        vec4 result = ${r};\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sv={kernelName:d.i,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:r}=e,i=n;if(1===i.length)return by({inputs:{x:i[0]},backend:r});if(i.length>Object(d.Me)().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const e=Math.floor(i.length/2),n=t({inputs:i.slice(0,e),backend:r}),a=t({inputs:i.slice(e),backend:r});return t({inputs:[n,a],backend:r})}const a=i.map(t=>t.dtype).reduce((t,e)=>Object(d.pi)(t,e)),o=i.map(t=>t.shape),s=Object(d.Me)().getBool("WEBGL_PACK")?new ov(i[0].shape,o):new av(i[0].shape,o);return r.runWebGLProgram(s,i,a)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uv={kernelName:d.j,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:o}=r,s=i.shape.length,u=d.qi.parseAxisParam(a,i.shape);let c=u;const l=d.Ld.getAxesPermutation(c,s);let f=i;null!=l&&(f=Hy({inputs:{x:i},backend:n,attrs:{perm:l}}),c=d.Ld.getInnerMostAxes(c.length,s)),d.Ld.assertAxesAreInnerMostDims("all",c,s);const[h,p]=d.Ld.computeOutAndReduceShapes(f.shape,c),m=Ry({inputs:{x:f},backend:n,attrs:{shape:[-1,d.qi.sizeFromShape(p)]}}),g=Py(m,m.dtype,"all",n);let b;if(o){b=Ry({inputs:{x:g},backend:n,attrs:{shape:d.Ld.expandShapeToKeepDim(h,u)}})}else b=Ry({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),null!=l&&n.disposeIntermediateTensorInfo(f),b}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cv={kernelName:d.k,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:o}=r,s=i.shape.length,u=d.qi.parseAxisParam(a,i.shape);let c=u;const l=d.Ld.getAxesPermutation(c,s);let f=i;null!=l&&(f=Hy({inputs:{x:i},backend:n,attrs:{perm:l}}),c=d.Ld.getInnerMostAxes(c.length,s)),d.Ld.assertAxesAreInnerMostDims("any",c,s);const[h,p]=d.Ld.computeOutAndReduceShapes(f.shape,c),m=Ry({inputs:{x:f},backend:n,attrs:{shape:[-1,d.qi.sizeFromShape(p)]}}),g=Py(m,m.dtype,"any",n);let b;if(o){b=Ry({inputs:{x:g},backend:n,attrs:{shape:d.Ld.expandShapeToKeepDim(h,u)}})}else b=Ry({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),null!=l&&n.disposeIntermediateTensorInfo(f),b}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lv{constructor(t,e,n){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:a}=t;n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a];const o="max"===e?">":"<",s=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${r}; i++) {\n          int inIdx = ${s};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${o} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dv{constructor(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,d.qi.assert(t.length>2,()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`);const i=t[t.length-1],a=Math.ceil(i/e);this.outputShape=t.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");const o=this.outputShape,s=o.length,u=xb(s),c=ty("coords",s);let l,f;if(1===a){f=s+1;const t=xb(f);l=`\n        ${t} sourceLocR = ${t}(${c.join()}, 0);\n        ++${c[s-1]};\n        ${t} sourceLocG = ${t}(${c.join()}, 0);\n        ++${c[s-2]};\n        ${t} sourceLocA = ${t}(${c.join()}, 0);\n        --${c[s-1]};\n        ${t} sourceLocB = ${t}(${c.join()}, 0);\n        --${c[s-2]};`}else f=s,l=`\n        ${u} sourceLocR = coords;\n        ++${c[s-1]};\n        ${u} sourceLocG = coords;\n        ++${c[s-2]};\n        ${u} sourceLocA = coords;\n        --${c[s-1]};\n        ${u} sourceLocB = coords;\n        --${c[s-2]};`;const h=["x","y","z","w","u","v"].slice(0,f),p="."+h[f-1],m=h.map(t=>"int "+t),g=ty("sourceLocR",f-1).concat("inIdx.r"),b=ty("sourceLocG",f-1).concat("inIdx.g"),y=ty("sourceLocB",f-1).concat("inIdx.b"),v=ty("sourceLocA",f-1).concat("inIdx.a"),x="max"===n?"greaterThan":"lessThan",w=r?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),\n                             getBestIndicesAChannel(${b.join()}),\n                             getBestIndicesAChannel(${y.join()}),\n                             getBestIndicesAChannel(${v.join()})));`,k=`vec4(\n            getAChannel(${g.join()}),\n            hasNextCol ? getAChannel(${b.join()}) : 0.,\n            hasNextRow ? getAChannel(${y.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,O=r?"":`\n      float getBestIndicesAChannel(${m.join()}) {\n        return getChannel(getBestIndicesA(${h.join()}),\n                                          vec2(${h.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${m.join()}) {\n        return getChannel(getA(${h.join()}),\n                               vec2(${h.slice(-2).join()}));\n      }\n      ${O}\n      void main() {\n        ${u} coords = getOutputCoords();\n        bool hasNextCol = ${c[s-1]} < ${o[s-1]-1};\n        bool hasNextRow = ${c[s-2]} < ${o[s-2]-1};\n        ${l}\n        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},\n          sourceLocB${p}, sourceLocA${p}) * ${e};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${k};\n\n        for (int i = 0; i < ${e}; i++) {\n          inIdx = srcIdx;\n          ${w}\n          vec4 candidate = ${k};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${x}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fv(t,e,n,r){const i=[n];if(d.Ld.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,e.shape.length),!Object(d.Me)().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const n=[],[a,o]=d.Ld.computeOutAndReduceShapes(e.shape,i),s=d.qi.sizeFromShape(o),u=Ry({inputs:{x:e},backend:t,attrs:{shape:[-1,s]}});n.push(u);const c=function t(e,n,r,i=null){let a=n.shape[0],o=n.shape[1];null!=i&&(a=i.shape[0],o=i.shape[1]);const s=d.Ld.computeOptimalWindowSize(o),u={windowSize:s,inSize:o,batchSize:a,outSize:Math.ceil(o/s)},c=new lv(u,r,null==i),l=[n];null!=i&&l.push(i);const f=e.runWebGLProgram(c,l,"int32");if(1===f.shape[1])return f;const h=t(e,n,r,f);return e.disposeIntermediateTensorInfo(f),h}(t,u,r);n.push(c);const l=Ry({inputs:{x:c},backend:t,attrs:{shape:a}});return n.forEach(e=>t.disposeIntermediateTensorInfo(e)),l}return function t(e,n,r,i=null){const a=null!=i?i.shape:n.shape,o=a[a.length-1],s=d.Ld.computeOptimalWindowSize(o),u=new dv(a,s,r,null==i),c=null==i?[n]:[n,i],l=e.runWebGLProgram(u,c,"int32");if(l.shape.length===n.shape.length){const i=t(e,n,r,l);return e.disposeIntermediateTensorInfo(l),i}return l}(t,e,r)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hv={kernelName:d.l,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a}=r;let o=d.qi.parseAxisParam(a,i.shape);const s=d.Ld.getAxesPermutation(o,i.shape.length);let u=i;const c=[];null!=s&&(u=Hy({inputs:{x:i},backend:n,attrs:{perm:s}}),c.push(u),o=d.Ld.getInnerMostAxes(o.length,u.shape.length)),d.Ld.assertAxesAreInnerMostDims("argMax",[o[0]],u.shape.length);const l=fv(n,u,o[0],"max");return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),l}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pv={kernelName:d.m,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a}=r;let o=d.qi.parseAxisParam(a,i.shape);const s=d.Ld.getAxesPermutation(o,i.shape.length);let u=i;const c=[];null!=s&&(u=Hy({inputs:{x:i},backend:n,attrs:{perm:s}}),c.push(u),o=d.Ld.getInnerMostAxes(o.length,u.shape.length)),d.Ld.assertAxesAreInnerMostDims("argMin",[o[0]],u.shape.length);const l=fv(n,u,o[0],"min");return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),l}},mv=Ey({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),gv={kernelName:d.n,backendName:"webgl",kernelFunc:mv},bv=Ey({opSnippet:"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));"}),yv={kernelName:d.o,backendName:"webgl",kernelFunc:bv},vv=Ey({opSnippet:"if (isnan(x)) return x;\n  return atan(x);\n"}),xv={kernelName:d.p,backendName:"webgl",kernelFunc:vv},wv=Sy({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),kv={kernelName:d.q,backendName:"webgl",kernelFunc:wv},Ov=Ey({opSnippet:"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),_v={kernelName:d.r,backendName:"webgl",kernelFunc:Ov};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Av{constructor(t,e,n,r=!1,i=!1){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const a=t.filterWidth,o=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterHeight,d=t.effectiveFilterWidth,f=t.padInfo.top,h=t.padInfo.left;this.outputShape=t.outShape;const p="avg"===e,m=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,g=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let b="0.0";if(p||(b="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode=`\n        const ivec2 strides = ivec2(${o}, ${s});\n        const ivec2 pads = ivec2(${f}, ${h});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${l};\n              wR += ${u}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${d};\n                wC += ${c}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ${e} currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${r?i?m:g:`wR * ${d} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let y=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(y="avgValue / count");const v=4*Math.floor(a/4),x=a%4,w=`\n      if (${p}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${o}, ${s});\n      const ivec2 pads = ivec2(${f}, ${h});\n      const float initializationValue = ${b};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${b});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${l};\n            wR += ${u}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${v}; wC += 4) {\n            int xC = xCCorner + wC * ${c};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${c}, d),\n              getValue(batch, xR, xC + 2 * ${c}, d),\n              getValue(batch, xR, xC + 3 * ${c}, d)\n            );\n\n            ${w}\n          }\n\n          int xC = xCCorner + ${v};\n          if (${1===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${w}\n          } else if (${2===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${c}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${w}\n          } else if (${3===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${c}, d),\n              getValue(batch, xR, xC + 2 * ${c}, d),\n              initializationValue\n            );\n\n            ${w}\n          }\n        }\n        setOutput(${y});\n      }\n    `}}class Cv{constructor(t,e,n,r=!1,i=!1){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const a=t.filterWidth,o=t.strideDepth,s=t.strideHeight,u=t.strideWidth,c=t.dilationDepth,l=t.dilationHeight,d=t.dilationWidth,f=t.effectiveFilterDepth,h=t.effectiveFilterHeight,p=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,b=t.padInfo.left;this.outputShape=t.outShape;const y="avg"===e;let v="0.0";if(y||(v="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${o}, ${s}, ${u});\n        const ivec3 pads = ivec3(${m}, ${g}, ${b});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${f};\n              wD += ${c}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${h};\n                wR += ${l}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${p};\n                  wC += ${d}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ${e} currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${r?i?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${h} * ${p} +\n                      wR * ${p} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let x=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(x="avgValue / count");const w=4*Math.floor(a/4),k=a%4,O=`\n      if (${y}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${o}, ${s}, ${u});\n      const ivec3 pads = ivec3(${m}, ${g}, ${b});\n      const float initializationValue = ${v};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${v});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${f};\n            wD += ${c}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${h};\n            wR += ${l}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${w}; wC += 4) {\n              int xC = xCCorner + wC * ${d};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${d}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${d}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${d}, ch)\n              );\n\n              ${O}\n            }\n\n            int xC = xCCorner + ${w};\n            if (${1===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${O}\n            } else if (${2===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${d}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${O}\n            } else if (${3===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${d}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${d}, ch),\n                initializationValue\n              );\n\n              ${O}\n            }\n          }\n          setOutput(${x});\n        }\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ev={kernelName:d.s,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;Lg(i,"avgPool");const{filterSize:a,strides:o,pad:s,dimRoundingMode:u}=r;d.qi.assert(d.Ld.eitherStridesOrDilationsAreOne(o,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const c=d.Ld.computePool2DInfo(i.shape,a,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&d.qi.arraysEqual(c.inShape,c.outShape))return by({inputs:{x:i},backend:n});const l=new Av(c,"avg",!1);return n.runWebGLProgram(l,[i],"float32")}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sv={kernelName:d.t,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:a,strides:o,pad:s,dimRoundingMode:u,dataFormat:c}=r,l=d.Ld.computePool3DInfo(i.shape,a,o,[1,1,1],s,u,c),f=new Cv(l,"avg",!1);return n.runWebGLProgram(f,[i],"float32")}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jv{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=s-1-t.padInfo.top,l=u-1-t.padInfo.left,d=1/(e*n);this.userCode=`\n      const ivec2 pads = ivec2(${c}, ${l});\n      const float avgMultiplier = float(${d});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${s};\n            wR += ${a}) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${u};\n            wC+= ${o}) {\n            float dyC = float(dyCCorner + wC) / ${i}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Nv{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,d=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=l-1-t.padInfo.front,p=d-1-t.padInfo.top,m=f-1-t.padInfo.left,g=1/(e*n*r);this.userCode=`\n      const ivec3 pads = ivec3(${h}, ${p}, ${m});\n      const float avgMultiplier = float(${g});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${l};\n            wD += ${s}) {\n          float dyD = float(dyDCorner + wD) / ${i}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${d};\n              wR += ${u}) {\n            float dyR = float(dyRCorner + wR) / ${a}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${f};\n                wC += ${c}) {\n              float dyC = float(dyCCorner + wC) / ${o}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tv={kernelName:d.u,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a}=e,o=a,{filterSize:s,strides:u,pad:c,dimRoundingMode:l}=r,f=d.Ld.computePool3DInfo(o.shape,s,u,[1,1,1],c,l),h=new Nv(f);return n.runWebGLProgram(h,[i],o.dtype)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fv={kernelName:d.v,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a}=e,o=a;Lg([i,a],"avgPoolGrad");const{filterSize:s,strides:u,pad:c}=r,l=d.Ld.computePool2DInfo(o.shape,s,u,1,c),f=new jv(l);return n.runWebGLProgram(f,[i],o.dtype)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dv={kernelName:d.w,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:a}=e,{transposeA:o,transposeB:s}=r;return Ky({a:i,b:a,transposeA:o,transposeB:s,backend:n})}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Iv{constructor(t,e,n,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],d.Ld.assertAndGetBroadcastShape(t,e),d.Ld.assertAndGetBroadcastShape(t,n);let o="0.0";null!=r&&(d.Ld.assertAndGetBroadcastShape(t,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let s="1.0";null!=i&&(d.Ld.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${o};\n        float scale = ${s};\n        float inv = scale * inversesqrt(variance + float(${a}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mv{constructor(t,e,n,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],d.Ld.assertAndGetBroadcastShape(t,e),d.Ld.assertAndGetBroadcastShape(t,n);let o="vec4(0.0)";null!=r&&(d.Ld.assertAndGetBroadcastShape(t,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let s="vec4(1.0)";null!=i&&(d.Ld.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        vec4 offset = ${o};\n        vec4 scale = ${s};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${a}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $v={kernelName:d.pb,backendName:"webgl",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:i,variance:a,offset:o,scale:s}=t;d.qi.assert(i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),d.qi.assert(null==o||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),d.qi.assert(null==s||i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=n;null==u&&(u=.001);const c=[r,i,a];let l=null;null!=o&&(l=o.shape,c.push(o));let f=null;null!=s&&(f=s.shape,c.push(s));const h=Object(d.Me)().getBool("WEBGL_PACK_NORMALIZATION")?new Mv(r.shape,i.shape,a.shape,l,f,u):new Iv(r.shape,i.shape,a.shape,l,f,u);return e.runWebGLProgram(h,c,c[0].dtype)}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Rv{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=xb(this.rank),n=`uniform int start[${this.rank}];`,r=function(t){if(1===t)return"sourceLoc";if(t<=6)return Bv.slice(0,t).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(this.rank);let i;i=`\n        ${e} sourceLoc;\n        ${e} coords = getOutputCoords();\n        ${t.map((t,e)=>`sourceLoc.${Bv[e]} = start[${e}] + coords.${Bv[e]};`).join("\n")}\n      `,this.userCode=`\n      ${n}\n      void main() {\n        ${i}\n        setOutput(getSource(${r}));\n      }\n    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the length of start (${t.length})`);return(e,n)=>{null==this.startLoc&&(this.startLoc=e.getUniformLocationNoThrow(n,"start"),null==this.startLoc)||e.gl.uniform1iv(this.startLoc,t)}}}const Bv=["x","y","z","w","u","v"];class zv{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;const e=xb(this.rank),n=ty("coords",this.rank),r=ty("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":`vec2(${r.slice(-2).join()})`,a=`getChannel(getSource(${r.join()}), ${i})`,o=`\n      result.x = ${a};\n      if (++${n[this.rank-1]} < ${t[this.rank-1]}) {\n        ++${r[this.rank-1]};\n        result.y = ${a};\n        --${r[this.rank-1]};\n      }\n    `,s=1===this.rank?"":`\n      --${n[this.rank-1]};\n      if (++${n[this.rank-2]} < ${t[this.rank-2]}) {\n        ++${r[this.rank-2]};\n        result.z = ${a};\n        if (++${n[this.rank-1]} < ${t[this.rank-1]}) {\n          ++${r[this.rank-1]};\n          result.w = ${a};\n        }\n      }\n    `,u=this.rank<=4?`sourceLoc = coords +\n            ${e}(${t.map((t,e)=>`start[${e}]`).join()});`:t.map((t,e)=>`${r[e]} = ${n[e]} + start[${e}];`).join("\n");this.userCode=`\n      uniform int start[${this.rank}];\n      void main() {\n        ${e} coords = getOutputCoords();\n        ${e} sourceLoc;\n        ${u}\n        vec4 result = vec4(0.);\n        ${o}\n        ${s}\n        setOutput(result);\n      }\n    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the length of start (${t.length})`);return(e,n)=>{null==this.startLoc&&(this.startLoc=e.getUniformLocationNoThrow(n,"start"),null==this.startLoc)||e.gl.uniform1iv(this.startLoc,t)}}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lv(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:a,size:o}=r,[s,u]=d.zh.parseSliceParams(i,a,o);if(d.zh.assertParamsValid(i,s,u),0===d.qi.sizeFromShape(u))return n.makeTensorInfo(u,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||"string"===i.dtype){const t=n.texData.get(i.dataId),e=Gb(t.values,s,u,i.shape,i.dtype);return n.makeTensorInfo(u,i.dtype,e)}const{isPacked:c}=n.texData.get(i.dataId),l=d.zh.isSliceContinous(i.shape,s,u);if(c||!l){const t=Object(d.Me)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new zv(u):new Rv(u),e=t.getCustomSetupFunc(s);return n.runWebGLProgram(t,[i],i.dtype,e)}return n.uploadToGPU(i.dataId),function(t,e,n,r){const i=r.texData.get(t.dataId),a=r.makeTensorInfo(n,t.dtype),o=r.texData.get(a.dataId);Object.assign(o,i),o.shape=n,o.dtype=t.dtype;let s=d.zh.computeFlatOffset(e,d.qi.computeStrides(t.shape));i.slice&&(s+=i.slice.flatOffset),o.slice={flatOffset:s,origDataId:i.slice&&i.slice.origDataId||t.dataId};const u=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,u+1),a}(i,s,u,n)}const Pv={kernelName:d.Tc,backendName:"webgl",kernelFunc:Lv},qv={kernelName:d.x,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:a,crops:o}=r;d.qi.assert(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const s=a.reduce((t,e)=>t*e),u=d.Ld.getReshaped(i.shape,a,s),c=d.Ld.getPermuted(u.length,a.length),l=d.Ld.getReshapedPermuted(i.shape,a,s),f=d.Ld.getSliceBeginCoords(o,a.length),h=d.Ld.getSliceSize(l,o,a.length),p=[],m=Ry({inputs:{x:i},backend:n,attrs:{shape:u}}),g=Hy({inputs:{x:m},backend:n,attrs:{perm:c}}),b=Ry({inputs:{x:g},backend:n,attrs:{shape:l}}),y=Lv({inputs:{x:b},backend:n,attrs:{begin:f,size:h}});return p.push(m),p.push(g),p.push(b),p.forEach(t=>n.disposeIntermediateTensorInfo(t)),y}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wv={kernelName:d.y,backendName:"webgl",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:a}=e,{size:o}=r,s=n.texData.get(i.dataId).values,u=n.texData.get(a.dataId).values,c=Ab(s,u,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,c)}},Uv=Sy({opSnippet:"return float(a != b);",dtype:"bool"}),Vv={kernelName:d.ic,backendName:"webgl",kernelFunc:Uv};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Gv(t){const{inputs:e,backend:n}=t,{input:r}=e;return by({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}const Hv={kernelName:d.wc,backendName:"webgl",kernelFunc:Gv};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xv={kernelName:d.A,backendName:"webgl",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function t(e){const{inputs:n,backend:r,attrs:i}=e,{x:a}=n,{dtype:o}=i;if("complex64"===o){if("complex64"===a.dtype)return by({inputs:{x:a},backend:r});const e=d.yi(a.shape),n=t({inputs:{x:a},backend:r,attrs:{dtype:"float32"}}),i=vy({inputs:{real:n,imag:e},backend:r});return e.dispose(),r.disposeIntermediateTensorInfo(n),i}if("complex64"===a.dtype){const e=Gv({inputs:{input:a},backend:r}),n=t({inputs:{x:e},backend:r,attrs:{dtype:o}});return r.disposeIntermediateTensorInfo(e),n}if(!d.qi.hasEncodingLoss(a.dtype,o)){const t=by({inputs:{x:a},backend:r});return{dataId:t.dataId,shape:t.shape,dtype:o}}if("int32"===o)return function(t,e){const n=new sy(t.shape,"return float(int(x));"),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(a,r);if("bool"===o){const t=r.makeTensorInfo([],"bool",d.qi.getTypedArrayFromDType("bool",1)),e=Uv({inputs:{a:a,b:t},backend:r});return r.disposeIntermediateTensorInfo(t),e}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${o}`)}},Kv="return ceil(x);",Yv=Ey({opSnippet:Kv,packedOpSnippet:Kv,cpuKernelImpl:Eb}),Jv={kernelName:d.B,backendName:"webgl",kernelFunc:Yv};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Zv{constructor(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}getCustomSetupFunc(t,e){return(n,r)=>{null==this.minLoc&&(this.minLoc=n.getUniformLocationNoThrow(r,"minVal"),this.maxLoc=n.getUniformLocationNoThrow(r,"maxVal")),n.gl.uniform1f(this.minLoc,t),n.gl.uniform1f(this.maxLoc,e)}}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qv{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}getCustomSetupFunc(t,e){return(n,r)=>{null==this.minLoc&&(this.minLoc=n.getUniformLocationNoThrow(r,"minVal"),this.maxLoc=n.getUniformLocationNoThrow(r,"maxVal")),n.gl.uniform1f(this.minLoc,t),n.gl.uniform1f(this.maxLoc,e)}}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tx={kernelName:d.C,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{clipValueMin:a,clipValueMax:o}=r;let s;s=Object(d.Me)().getBool("WEBGL_PACK_CLIP")?new Qv(i.shape):new Zv(i.shape);const u=s.getCustomSetupFunc(a,o);return n.runWebGLProgram(s,[i],i.dtype,u)}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ex{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nx(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}const rx={kernelName:d.E,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e,i=n.texData.get(r.dataId),a=new ex(r.shape),o=[nx(r,i.complexTensorInfos.real),nx(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(a,o,o[0].dtype)}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ix{constructor(t){this.outputShape=[],this.outputShape=d.Ld.computeOutShape(t,1),this.variableNames=t.map((t,e)=>"T"+e);const e=new Array(t.length-1);e[0]=t[0][1];for(let n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];const n=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let t=1;t<e.length;t++){const r=e[t-1];n.push(`else if (yC < ${e[t]}) setOutput(getT${t}(yR, yC-${r}));`)}const r=e.length,i=e[e.length-1];n.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${n.join("\n        ")}\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ax{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=d.Ld.computeOutShape(t,e);const n=this.outputShape,r=n.length,i=xb(r),a=ty("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((t,e)=>"T"+e);const s=new Array(t.length-1);s[0]=t[0][e];for(let n=1;n<s.length;n++)s[n]=s[n-1]+t[n][e];const u=o[e],c=o.slice(-2),l=o.join();let f=`if (${u} < ${s[0]}) {\n        return getChannel(\n            getT0(${l}), vec2(${c.join()}));\n        }`;for(let t=1;t<s.length;t++){const e=s[t-1];f+=`\n        if (${u} < ${s[t]}  && ${u} >= ${s[t-1]}) {\n          return getChannel(\n            getT${t}(${ox(o,u,e)}),\n            vec2(${ox(c,u,e)}));\n        }`}const h=s.length,p=s[s.length-1];f+=`\n        return getChannel(\n          getT${h}(${ox(o,u,p)}),\n          vec2(${ox(c,u,p)}));`,this.userCode=`\n      float getValue(${o.map(t=>"int "+t)}) {\n        ${f}\n      }\n\n      void main() {\n        ${i} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${a}), 0., 0., 0.);\n\n        ${a[r-1]} = ${a[r-1]} + 1;\n        if (${a[r-1]} < ${n[r-1]}) {\n          result.g = getValue(${a});\n        }\n\n        ${a[r-2]} = ${a[r-2]} + 1;\n        if (${a[r-2]} < ${n[r-2]}) {\n          result.a = getValue(${a});\n        }\n\n        ${a[r-1]} = ${a[r-1]} - 1;\n        if (${a[r-2]} < ${n[r-2]} &&\n            ${a[r-1]} < ${n[r-1]}) {\n          result.b = getValue(${a});\n        }\n        setOutput(result);\n      }\n    `}}function ox(t,e,n){const r=t.indexOf(e);return t.map((t,e)=>e===r?`${t} - ${n}`:t).join()}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sx(t){const{inputs:e,backend:n}=t,{input:r}=e;return by({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}const ux={kernelName:d.yb,backendName:"webgl",kernelFunc:sx};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cx(t,e,n){const r=d.Ld.computeOutShape(t.map(t=>t.shape),e);return{tensors2D:t.map(t=>Ry({inputs:{x:t},attrs:{shape:[-1,d.qi.sizeFromShape(t.shape.slice(e))]},backend:n})),outShape:r}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lx(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r,a=d.qi.parseAxisParam(i,e[0].shape)[0],o=d.Ld.computeOutShape(e.map(t=>t.shape),a);if(0===d.qi.sizeFromShape(o))return n.makeTensorInfo(o,e[0].dtype,[]);const s=e.filter(t=>d.qi.sizeFromShape(t.shape)>0);if(1===s.length)return by({inputs:{x:s[0]},backend:n});const u=s.map(t=>t.shape);return d.Ld.assertParamsConsistent(u,a),function t(e,n,r){const i=e[0].dtype;if("complex64"===i){const i=e.map(t=>Gv({inputs:{input:t},backend:r})),a=e.map(t=>sx({inputs:{input:t},backend:r})),o=t(i,n,r),s=t(a,n,r),u=vy({inputs:{real:o,imag:s},backend:r});return i.forEach(t=>r.disposeIntermediateTensorInfo(t)),a.forEach(t=>r.disposeIntermediateTensorInfo(t)),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),u}if("string"===i){const{tensors2D:t,outShape:a}=cx(e,n,r),o=t.map(t=>({vals:r.texData.get(t.dataId).values,shape:t.shape})),s=1===t[0].shape[0],u=Sb(o,a,i,s),c=d.Ld.computeOutShape(e.map(t=>t.shape),n),l=r.makeTensorInfo(c,i,u);return t.forEach(t=>r.disposeIntermediateTensorInfo(t)),l}if(e.length>Object(d.Me)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const i=Math.floor(e.length/2),a=t(e.slice(0,i),n,r),o=t(e.slice(i),n,r),s=t([a,o],n,r);return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(o),s}if(Object(d.Me)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].shape.length>1){const t=new ax(e.map(t=>t.shape),n);return r.runWebGLProgram(t,e,i)}const{tensors2D:a,outShape:o}=cx(e,n,r),s=new ix(a.map(t=>t.shape)),u=r.runWebGLProgram(s,a,i);a.forEach(t=>r.disposeIntermediateTensorInfo(t));const c=Ry({inputs:{x:u},attrs:{shape:o},backend:r});return r.disposeIntermediateTensorInfo(u),c}(s,a,n)}const dx={kernelName:d.F,backendName:"webgl",kernelFunc:lx};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fx{constructor(t,e=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const a=t.padInfo.top,o=t.padInfo.left,s=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,d=t.filterHeight,f=t.filterWidth,h=4*Math.floor(t.inChannels/4),p=t.inChannels%4,m="channelsLast"===t.dataFormat,g=m?1:2,b=m?2:3,y=m?3:1;let v="",x="";n&&(v=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,x="result = activation(result);");const w=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${v}\n\n      const ivec2 strides = ivec2(${s}, ${u});\n      const ivec2 pads = ivec2(${a}, ${o});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${y}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${g}], coords[${b}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${d}; wR++) {\n          int xR = xRCorner + wR * ${c};\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${f}; wC++) {\n            int xC = xCCorner + wC * ${l};\n\n            if (xC < 0 || xC >= ${t.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${h}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${m}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===p}) {\n\n              if (${m}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${h}) *\n                    getW(wR, wC, ${h}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${h}, xR, xC) *\n                    getW(wR, wC, ${h}, d2);\n              }\n\n            } else if (${2===p}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${h}, d2),\n                getW(wR, wC, ${h} + 1, d2)\n              );\n\n              if (${m}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${h}),\n                  getX(batch, xR, xC, ${h} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${h}, xR, xC),\n                  getX(batch, ${h} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===p}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${h}, d2),\n                getW(wR, wC, ${h} + 1, d2),\n                getW(wR, wC, ${h} + 2, d2)\n              );\n\n              if (${m}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${h}),\n                  getX(batch, xR, xC, ${h} + 1),\n                  getX(batch, xR, xC, ${h} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${h}, xR, xC),\n                  getX(batch, ${h} + 1, xR, xC),\n                  getX(batch, ${h} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${w}\n        ${x}\n        setOutput(result);\n      }\n    `}}class hx{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterDepth,d=t.filterHeight,f=t.filterWidth,h=4*Math.floor(t.inChannels/4),p=t.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${i}, ${a}, ${o});\n      const ivec3 pads = ivec3(${e}, ${n}, ${r});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${l}; wF++) {\n          int xF = xFCorner + wF * ${s};\n\n          if (xF < 0 || xF >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${d}; wR++) {\n            int xR = xRCorner + wR * ${u};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${f}; wC++) {\n              int xC = xCCorner + wC * ${c};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${h}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===p}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${h}) *\n                  getW(wF, wR, wC, ${h}, d2);\n              } else if (${2===p}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${h}),\n                  getX(batch, xF, xR, xC, ${h} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${h}, d2),\n                  getW(wF, wR, wC, ${h} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===p}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${h}),\n                  getX(batch, xF, xR, xC, ${h} + 1),\n                  getX(batch, xF, xR, xC, ${h} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${h}, d2),\n                  getW(wF, wR, wC, ${h} + 1, d2),\n                  getW(wF, wR, wC, ${h} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class px{constructor(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;const{filterWidth:r,inChannels:i,strideWidth:a,strideHeight:o,padInfo:s,outWidth:u,dilationWidth:c,dilationHeight:l,dataFormat:d}=n,{left:f,top:h}=s,p=i*r,m=qg(),g="channelsLast"===d,b=g?0:1,y=g?1:2;let v="";for(let n=0;n<=1;n++)for(let r=0;r<=1;r++)v+=`\n          blockIndex = rc.y + ${r};\n          pos = rc.x + ${n};\n\n          if(blockIndex < ${t[1]} && pos < ${t[0]}) {\n            offsetY = int(blockIndex / (${u})) * ${o} - ${h};\n            d0 = offsetY + ${l} * (pos / ${p});\n\n            if(d0 < ${e[b]} && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ${u}.) * ${a}. - ${f}.);\n              d1 = offsetX + ${c} * (int(mod(float(pos), ${p}.) / ${i}.));\n\n              if(d1 < ${e[y]} && d1 >= 0) {\n\n                ch = int(mod(float(pos), ${i}.));\n\n                if (${g}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*n+r}] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*n+r}] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${v}\n\n        ${m.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mx({x:t,filter:e,convInfo:n,backend:r,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:s=null}){const u=t.shape,c=r.texData.get(t.dataId),l=n.inChannels,f=u[0]*u[1]*u[2],h=n.outChannels,p="channelsLast"===n.dataFormat;let m;const g=[],b=(1===f||1===h)&&l>1e3,y=u[2]%2!=0&&!!c.isPacked;if(!b&&Object(d.Me)().getBool("WEBGL_LAZILY_UNPACK")&&Object(d.Me)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&y){const l=p?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),f={dataId:t.dataId,shape:[1,l,n.inChannels],dtype:t.dtype},h=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,d.qi.assert(Dg(c.shape,f.shape),()=>`packed reshape ${c.shape} to ${f.shape} isn't free`);const b=Ry({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});g.push(b);const y=Ky({a:f,b:b,backend:r,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:a,leakyreluAlpha:o}),v=r.texData.get(y.dataId);d.qi.assert(v.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=h,v.shape=n.outShape,m=by({inputs:{x:y},backend:r}),m.shape=n.outShape,g.push(y)}else{const c=Ry({inputs:{x:t},backend:r,attrs:{shape:[1,p?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],n.inChannels]}}),l=Ry({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),d=Ky({a:c,b:l,transposeA:!1,transposeB:!1,backend:r,bias:i,activation:s,preluActivationWeights:a,leakyreluAlpha:o});m=Ry({inputs:{x:d},backend:r,attrs:{shape:n.outShape}}),g.push(c),g.push(l),g.push(d)}for(const t of g)r.disposeIntermediateTensorInfo(t);return m}function gx({x:t,filter:e,convInfo:n,backend:r,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:s=null}){const{filterWidth:u,filterHeight:c,inChannels:l,outWidth:f,outHeight:h,dataFormat:p}=n,m="channelsLast"===p,g=u*c*l,b=h*f,y=[g,b],v=[],x=Ry({inputs:{x:t},backend:r,attrs:{shape:t.shape.slice(1)}}),w=Ry({inputs:{x:e},backend:r,attrs:{shape:[1,g,d.qi.sizeFromShape(e.shape)/g]}});v.push(x),v.push(w);const k=new px(y,x.shape,n),O=r.runWebGLProgram(k,[x],"float32"),_=Ry({inputs:{x:O},backend:r,attrs:{shape:[1,y[0],y[1]]}});v.push(O),v.push(_);const A=null!=i,C=null!=a,E="leakyrelu"===s,S=s?jy(s,!0):null,j=new Ny(_.shape,w.shape,[1,b,n.outChannels],!0,!1,A,S,C,E),N=[_,w];if(i&&N.push(i),C&&N.push(a),E){const t=r.makeTensorInfo([],"float32",d.qi.createScalarValue(o,"float32"));N.push(t),v.push(t)}const T=r.runWebGLProgram(j,N,"float32"),F=Ry({inputs:{x:T},backend:r,attrs:{shape:m?[1,h,f,n.outChannels]:[1,n.outChannels,h,f]}});v.push(T);for(const t of v)r.disposeIntermediateTensorInfo(t);return F}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bx={kernelName:d.G,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a}=e,{strides:o,pad:s,dataFormat:u,dilations:c,dimRoundingMode:l}=r,f=d.Ld.convertConv2DDataFormat(u),h=d.Ld.computeConv2DInfo(i.shape,a.shape,o,c,s,l,!1,f);let p;if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(Object(d.Me)().getBool("WEBGL_CONV_IM2COL")&&1===i.shape[0])p=gx({x:i,filter:a,convInfo:h,backend:n});else{const t=new fx(h);p=n.runWebGLProgram(t,[i,a],"float32")}else p=mx({x:i,filter:a,convInfo:h,backend:n});const m=Ry({inputs:{x:p},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(p),m}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yx{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,a="channelsLast"===t.dataFormat;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${e} - ${r};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${n} - ${i};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              if (${a}) {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class vx{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a="channelsLast"===t.dataFormat,o=e-1-t.padInfo.top,s=n-1-t.padInfo.left,u=a?1:2,c=a?2:3,l=a?3:1;this.userCode=`\n      const ivec2 pads = ivec2(${o}, ${s});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${l}];\n\n        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${i}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n\n              if (${a}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class xx{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.padInfo.front,a=t.padInfo.top,o=t.padInfo.left;this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yF = 0; yF < ${t.outDepth}; yF++) {\n            int xF = wF + yF * ${e} - ${i};\n\n            if (xF < 0 || xF >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${t.outHeight}; yR++) {\n              int xR = wR + yR * ${n} - ${a};\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${t.outWidth}; yC++) {\n                int xC = wC + yC * ${r} - ${o};\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class wx{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=e-1-t.padInfo.front,u=n-1-t.padInfo.top,c=r-1-t.padInfo.left;this.userCode=`\n      const ivec3 pads = ivec3(${s}, ${u}, ${c});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${e}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${i}.0;\n\n          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${e} - 1 - wF;\n\n          for (int wR = 0; wR < ${n}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${a}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${n} - 1 - wR;\n\n            for (int wC = 0; wC < ${r}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${o}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${r} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kx={kernelName:d.H,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:a}=e,{strides:o,pad:s,dataFormat:u,dimRoundingMode:c,filterShape:l}=r,f=d.Ld.convertConv2DDataFormat(u),h=d.Ld.computeConv2DInfo(i.shape,l,o,1,s,c,!1,f),p=new yx(h);return n.runWebGLProgram(p,[i,a],"float32")}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ox={kernelName:d.I,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:a}=e,{inputShape:o,strides:s,pad:u,dataFormat:c,dimRoundingMode:l}=r,f=d.Ld.convertConv2DDataFormat(c),h=d.Ld.computeConv2DInfo(o,a.shape,s,1,u,l,!1,f),p=new vx(h);return n.runWebGLProgram(p,[i,a],"float32")}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _x={kernelName:d.J,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a}=e,{strides:o,pad:s,dilations:u}=r,c=d.Ld.computeConv3DInfo(i.shape,a.shape,o,u,s),l=new hx(c);return n.runWebGLProgram(l,[i,a],"float32")}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ax={kernelName:d.K,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:a}=e,{strides:o,pad:s,filterShape:u}=r,c=d.Ld.computeConv3DInfo(i.shape,u,o,1,s),l=new xx(c);return n.runWebGLProgram(l,[i,a],"float32")}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cx={kernelName:d.L,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:a}=e,{pad:o,strides:s,inputShape:u}=r,c=d.Ld.computeConv3DInfo(u,a.shape,s,1,o),l=new wx(c);return n.runWebGLProgram(l,[i,a],"float32")}},Ex=Ey({opSnippet:"if (isnan(x)) return x;\n  return cos(x);\n"}),Sx={kernelName:d.M,backendName:"webgl",kernelFunc:Ex},jx=Ey({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),Nx={kernelName:d.N,backendName:"webgl",kernelFunc:jx};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Tx{constructor(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,o,s,u]=t,[c]=e,[l,d]=n;this.outputShape=[c,l,d,u];const f="bilinear"===r?1:0,[h,p]=[o-1+".0",s-1+".0"],[m,g,b]=l>1?[""+(o-1)/(l-1),"(y2-y1) * height_ratio",`y1*${h} + float(y)*(height_scale)`]:["0.0","0.0","0.5 * (y1+y2) * "+h],[y,v,x]=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio",`x1*${p} + float(x)*(width_scale)`]:["0.0","0.0","0.5 * (x1+x2) * "+p];this.userCode=`\n      const float height_ratio = float(${m});\n      const float width_ratio = float(${y});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${a}) {\n          return;\n        }\n\n        float height_scale = ${g};\n        float width_scale = ${v};\n\n        float in_y = ${b};\n        if( in_y < 0.0 || in_y > ${h} ) {\n          setOutput(float(${i}));\n          return;\n        }\n        float in_x = ${x};\n        if( in_x < 0.0 || in_x > ${p} ) {\n          setOutput(float(${i}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${f} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fx={kernelName:d.O,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{image:i,boxes:a,boxInd:o}=e,{cropSize:s,method:u,extrapolationValue:c}=r,l=new Tx(i.shape,a.shape,s,u,c);return n.runWebGLProgram(l,[i,a,o],"float32")}};class Dx{constructor(t,e,n){this.variableNames=["x"],this.outputShape=t;const r=t.length,i=e?"0.0":`getX(${Ix(r,"coords")})`,a=t[t.length-1];let o="",s="";e?(o=n?"end != "+(a-1):"end != 0",s=n?"end + 1":"end - 1"):(o=n?"end + pow2 < "+a:"end >= pow2",s=n?"end + pow2":"end - pow2"),this.userCode=`\n      uniform float index;\n      void main() {\n        ${xb(r)} coords = getOutputCoords();\n        int end = ${Mx(r,"coords")};\n        float val = ${i};\n        int pow2 = int(pow(2.0, index));\n        if (${o}) {\n          int idx = ${s};\n          ${Mx(r,"coords")} = idx;\n          val += getX(${Ix(r,"coords")});\n        }\n        setOutput(val);\n      }\n    `}getCustomSetupFunc(t){return(e,n)=>{null==this.index&&(this.index=e.getUniformLocation(n,"index")),e.gl.uniform1f(this.index,t)}}}function Ix(t,e){if(1===t)return""+e;if(2===t)return`${e}.x, ${e}.y`;if(3===t)return`${e}.x, ${e}.y, ${e}.z`;if(4===t)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw Error(`Cumulative sum for rank ${t} is not yet supported`)}function Mx(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error(`Cumulative sum for rank ${t} is not yet supported`)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $x={kernelName:d.P,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,exclusive:o,reverse:s}=r,u=i.shape.length,c=d.Ld.getAxesPermutation([a],u);let l=i;null!=c&&(l=Hy({inputs:{x:i},backend:n,attrs:{perm:c}}));const f=d.Ld.getInnerMostAxes(1,u)[0];if(f!==u-1)throw new Error(`WebGL cumsum shader expects an inner-most axis=${i.shape.length-1} but got axis=`+a);const h=i.shape[f];let p=by({inputs:{x:l},backend:n});for(let t=0;t<=Math.ceil(Math.log2(h))-1;t++){const e=new Dx(l.shape,!1,s),r=e.getCustomSetupFunc(t),i=p;p=n.runWebGLProgram(e,[p],p.dtype,r),n.disposeIntermediateTensorInfo(i)}if(o){const t=new Dx(l.shape,o,s),e=p;p=n.runWebGLProgram(t,[p],p.dtype),n.disposeIntermediateTensorInfo(e)}if(null!=c){const t=Hy({inputs:{x:p},backend:n,attrs:{perm:d.Ld.getUndoAxesPermutation(c)}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(l),t}return p}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rx={kernelName:d.R,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:a}=e,{size:o,binaryOutput:s}=r;if(1===i.shape.length){const t=n.texData.get(i.dataId).values,e=n.texData.get(a.dataId).values,r=Ab(t,e,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,r)}if(2===i.shape.length){const t=n.bufferSync(i),e=n.bufferSync(a),r=Cb(t,e,o,s);return n.makeTensorInfo(r.shape,a.dtype,r.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+i.shape.length+".")}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bx{constructor(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${e};\n      int offset_h = imod(h, ${e});\n      int in_w = w / ${e};\n      int offset_w = imod(w, ${e});\n      int offset_d = (offset_h * ${e} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zx={kernelName:d.S,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockSize:a,dataFormat:o}=r;d.qi.assert(a>1,()=>"blockSize should be > 1 for depthToSpace, but was: "+a);const s=i.shape[0],u="NHWC"===o?i.shape[1]:i.shape[2],c="NHWC"===o?i.shape[2]:i.shape[3],l="NHWC"===o?i.shape[3]:i.shape[1],f=u*a,h=c*a,p=l/(a*a),m=new Bx("NHWC"===o?[s,f,h,p]:[s,p,f,h],a,o);return n.runWebGLProgram(m,[i],i.dtype)}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lx{constructor(t,e=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const a=t.inHeight,o=t.inWidth,s=t.padInfo.top,u=t.padInfo.left,c=t.strideHeight,l=t.strideWidth,d=t.dilationHeight,f=t.dilationWidth,h=t.filterHeight,p=t.filterWidth,m=t.outChannels/t.inChannels;let g="",b="";n&&(g=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,b="result = activation(result);");const y=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${g}\n\n      const ivec2 strides = ivec2(${c}, ${l});\n      const ivec2 pads = ivec2(${s}, ${u});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${m};\n        int q = d2 - d1 * ${m};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${h}; wR++) {\n          int xR = xRCorner + wR * ${d};\n\n          if (xR < 0 || xR >= ${a}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${p}; wC++) {\n            int xC = xCCorner + wC * ${f};\n\n            if (xC < 0 || xC >= ${o}) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${y}\n        ${b}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Px{constructor(t,e=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;const a=t.inHeight,o=t.inWidth,s=t.padInfo.top,u=t.padInfo.left,c=t.strideHeight,l=t.strideWidth,f=t.dilationHeight,h=t.dilationWidth,p=t.filterHeight,m=t.filterWidth,g=m;let b="int xR; int xC; int xCOffset;";for(let t=0;t<p;t++)for(let e=0;e<m;e++)b+=`\n          vec4 xTexelR${t}C${2*e} = vec4(0.);\n          vec4 wR${t}C${e} = vec4(0.);\n          vec4 xR${t}C${e} = vec4(0.);`;for(let t=0;t<p;t++)for(let e=0;e<g;e++){const n=2*e;if(b+=`\n          xR = xRCorner + ${t*f};\n          xC = xCCorner + ${n*h};\n        `,1===l){if(n<m&&(b+=u%2==1?`\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ${a} && xCOffset >= 0 && xCOffset < ${o}) {\n                  xTexelR${t}C${n} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ${o}) {\n                    xTexelR${t}C${n}.zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR${t}C${n} = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ${a} && xCOffset >= 0 && xCOffset < ${o}) {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ${o}) {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR${t}C${n} = vec4(previous.zw, xTexelR${t}C${n}.xy);\n                } else {\n                  xR${t}C${n} = vec4(0, 0, xTexelR${t}C${n}.xy);\n                }\n              `:`\n                if(xR >= 0 && xR < ${a} && xC >= 0 && xC < ${o}) {\n                  xTexelR${t}C${n} = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR${t}C${n} = vec4(0.);\n                }\n\n                xR${t}C${n} = xTexelR${t}C${n};\n              `,n+1<m)){const e=u%2==0?d.qi.nearestLargerEven(h):h;h%2==0&&u%2==1||h%2!=0&&u%2!=1?(b+=`\n                  xCOffset = xC + ${u%2} + ${e};\n\n                  if(xR >= 0 && xR < ${a} &&\n                    xCOffset >= 0 && xCOffset < ${o}) {\n                    xTexelR${t}C${n+2} = getX(batch, xR, xCOffset, d1);\n                  }\n                `,h>1&&(b+=`\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ${a} &&\n                      xCOffset >= 0 && xCOffset < ${o}) {\n                      xTexelR${t}C${n} = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR${t}C${n} = vec4(0.);\n                    }\n                  `),b+=`\n                  xR${t}C${n+1} = vec4(\n                    xTexelR${t}C${n}.zw, xTexelR${t}C${n+2}.xy);\n                `):b+=`\n                  xCOffset = xC + ${e};\n\n                  if(xR >= 0 && xR < ${a} &&\n                    xCOffset >= 0 && xCOffset < ${o}) {\n                    xTexelR${t}C${n+2} = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR${t}C${n+1} = xTexelR${t}C${n+2};\n                `}}else n<m&&(b+=`\n              if(xR >= 0 && xR < ${a}) {\n            `,u%2==1?(b+=`\n                xCOffset = xC + 1 - ${l};\n                if(xCOffset >= 0 && xCOffset < ${o}) {\n                  xTexelR${t}C${n} = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR${t}C${n} = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ${o}) {\n                  xTexelR${t}C${n+2} = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR${t}C${n+2} = vec4(0.);\n                }\n\n                xR${t}C${n} = vec4(\n                  xTexelR${t}C${n}.zw, xTexelR${t}C${n+2}.zw);\n              `,n+1<m&&(b+=`\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ${l};\n                  if(xCOffset >= 0 && xCOffset < ${o}) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR${t}C${n+1} = vec4(xTexelR${t}C${n+2}.xy, final.xy);\n                `)):(b+=`\n                if(xC >= 0 && xC < ${o}) {\n                  xTexelR${t}C${n} = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR${t}C${n} = vec4(0.);\n                }\n\n                xCOffset = xC + ${l};\n                if(xCOffset >= 0 && xCOffset < ${o}) {\n                  xTexelR${t}C${n+2} = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR${t}C${n+2} = vec4(0.);\n                }\n\n                xR${t}C${n} = vec4(\n                  xTexelR${t}C${n}.xy, xTexelR${t}C${n+2}.xy);\n              `,n+1<m&&(b+=`\n                  xR${t}C${n+1} = vec4(\n                    xTexelR${t}C${n}.zw, xTexelR${t}C${n+2}.zw);\n                `)),b+="}");n<m&&(b+=`\n            vec4 wTexelR${t}C${n} = getW(${t}, ${n}, d1, q);\n            wR${t}C${n} = vec4(wTexelR${t}C${n}.xz, wTexelR${t}C${n}.xz);\n          `,n+1<m&&(b+=`\n              vec4 wTexelR${t}C${n+1} = getW(${t}, ${n+1}, d1, q);\n              wR${t}C${n+1} =\n                vec4(wTexelR${t}C${n+1}.xz, wTexelR${t}C${n+1}.xz);`))}for(let t=0;t<p;t++)for(let e=0;e<m;e++)b+=`dotProd += xR${t}C${e} * wR${t}C${e};`;let y="",v="";n&&(y=r?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`vec4 activation(vec4 x) {\n          ${n}\n        }`,v="result = activation(result);");const x=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${y}\n\n      const ivec2 strides = ivec2(${c}, ${l});\n      const ivec2 pads = ivec2(${s}, ${u});\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ${b}\n\n        vec4 result = dotProd;\n        ${x}\n        ${v}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qx={kernelName:d.T,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a}=e,{strides:o,pad:s,dilations:u,dimRoundingMode:c}=r;let l=u;null==l&&(l=[1,1]),d.qi.assert(d.Ld.eitherStridesOrDilationsAreOne(o,l),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const f=d.Ld.computeConv2DInfo(i.shape,a.shape,o,l,s,c,!0);let h;return h=Object(d.Me)().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels==1?new Px(f):new Lx(f),n.runWebGLProgram(h,[i,a],"float32")}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wx{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,a=t.outChannels/t.inChannels;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${a} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${e} - ${r};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${n} - ${i};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Ux{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a=e-1-t.padInfo.top,o=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${a}, ${o});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${i}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${s}; dm++) {\n              int d2 = d1 * ${s} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vx={kernelName:d.U,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:a}=e,{strides:o,dilations:s,pad:u,dimRoundingMode:c,filterShape:l}=r,f=d.Ld.computeConv2DInfo(i.shape,l,o,s,u,c,!0),h=new Wx(f);return n.runWebGLProgram(h,[i,a],"float32")}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gx={kernelName:d.V,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:a}=e,{strides:o,dilations:s,pad:u,dimRoundingMode:c,inputShape:l}=r,f=d.Ld.computeConv2DInfo(l,a.shape,o,s,u,c,!0),h=new Ux(f);return n.runWebGLProgram(h,[i,a],"float32")}};
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hx{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xx={kernelName:d.W,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e,i=[...r.shape,...r.shape],a=d.qi.sizeFromShape(r.shape),o=Ry({inputs:{x:r},backend:n,attrs:{shape:[a]}}),s=new Hx(a),u=n.runWebGLProgram(s,[o],o.dtype),c=Ry({inputs:{x:u},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),c}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kx{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:e,inWidth:n,padInfo:r,strideHeight:i,strideWidth:a,filterHeight:o,filterWidth:s,dilationHeight:u,dilationWidth:c}=t,{top:l,left:d}=r;this.userCode=`\n      const ivec2 strides = ivec2(${i}, ${a});\n      const ivec2 pads = ivec2(${l}, ${d});\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ${o}; h++) {\n          int hIn = hBeg + h * ${u};\n\n          if (hIn >= 0 && hIn < ${e}) {\n            for (int w = 0; w < ${s}; w++) {\n              int wIn = wBeg + w * ${c};\n\n              if (wIn >= 0 && wIn < ${n}) {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yx={kernelName:d.X,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a}=e,{strides:o,pad:s,dilations:u}=r,c=d.Ld.computeDilation2DInfo(i.shape,a.shape,o,s,"NHWC",u);let l;const f=new Kx(c);l=n.runWebGLProgram(f,[i,a],"float32");const h=Ry({inputs:{x:l},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(l),h}},Jx=Ey({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),Zx={kernelName:d.bb,backendName:"webgl",kernelFunc:Jx},Qx={kernelName:d.cb,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n}=t,{dy:r,y:i}=e,a=Object(d.Me)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new gy("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,i.shape):new my("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,i.shape);return n.runWebGLProgram(a,[r,i],r.dtype)}},tw=Sy({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool"}),ew={kernelName:d.eb,backendName:"webgl",kernelFunc:tw},nw=Ey({opSnippet:`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${d.Ld.ERF_P};\n  float a1 = ${d.Ld.ERF_A1};\n  float a2 = ${d.Ld.ERF_A2};\n  float a3 = ${d.Ld.ERF_A3};\n  float a4 = ${d.Ld.ERF_A4};\n  float a5 = ${d.Ld.ERF_A5};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`}),rw={kernelName:d.fb,backendName:"webgl",kernelFunc:nw},iw="return exp(x);",aw=Ey({opSnippet:iw,packedOpSnippet:iw,cpuKernelImpl:jb}),ow={kernelName:d.gb,backendName:"webgl",kernelFunc:aw};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function sw(t){const{inputs:e,attrs:n,backend:r}=t,{dim:i}=n,{input:a}=e,o=a.shape.length,s=a.shape.slice();let u=i;return i<0&&(d.qi.assert(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),u=o+i+1),s.splice(u,0,1),Ry({inputs:{x:a},backend:r,attrs:{shape:s}})}const uw={kernelName:d.hb,backendName:"webgl",kernelFunc:sw},cw="return exp(x) - 1.0;",lw=Ey({opSnippet:cw,packedOpSnippet:cw,cpuKernelImpl:Nb}),dw={kernelName:d.ib,backendName:"webgl",kernelFunc:lw};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class fw{constructor(t,e,n){this.variableNames=["real","imag"];const r=e[1];this.outputShape=e;const i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,a=n?r+".0":"1.0";let o;if("real"===t)o="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);o="return real * expI + imag * expR;"}this.userCode=`\n      const float exponentMultiplier = ${i};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${o}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${r});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${r}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${a};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hw(t,e,n){const r=n.texData.get(t.dataId),i=d.qi.sizeFromShape(t.shape),a=t.shape[t.shape.length-1],o=Ry({inputs:{x:t},backend:n,attrs:{shape:[i/a,a]}}).shape,s=new fw("real",o,e),u=new fw("imag",o,e),c=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:o},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:o}],l=n.runWebGLProgram(s,c,"float32"),f=n.runWebGLProgram(u,c,"float32"),h=vy({inputs:{real:l,imag:f},backend:n});n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f);const p=Ry({inputs:{x:h},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(p),p}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pw={kernelName:d.jb,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e;return hw(r,!1,n)}};
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mw{constructor(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}getCustomSetupFunc(t){return(e,n)=>{null==this.valueLoc&&(this.valueLoc=e.getUniformLocationNoThrow(n,"value")),e.gl.uniform1f(this.valueLoc,t)}}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gw(t){const{backend:e,attrs:n}=t,{shape:r,value:i}=n;let{dtype:a}=n;if(a=a||d.qi.inferDtype(i),"string"===a){const t=d.qi.getArrayFromDType(a,d.qi.sizeFromShape(r));return t.fill(i),e.makeTensorInfo(r,a,t)}{const t=new mw(r,i),n=t.getCustomSetupFunc(i);return e.runWebGLProgram(t,[],a,n)}}const bw={kernelName:d.kb,backendName:"webgl",kernelFunc:gw};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yw{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ${e} - x;\n          float outputValue;\n          if(coordX >= 0 && coordX < ${e}) {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vw={kernelName:d.lb,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,i=new yw(n.shape);return r.runWebGLProgram(i,[n],n.dtype)}},xw="return floor(x);",ww=Ey({opSnippet:xw,packedOpSnippet:xw,cpuKernelImpl:Tb}),kw={kernelName:d.mb,backendName:"webgl",kernelFunc:ww},Ow=Sy({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),_w={kernelName:d.nb,backendName:"webgl",kernelFunc:Ow};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Aw{constructor(t){this.variableNames=["A"];const e=qg(),[n,r]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);\n\n        vec4 values = ${e.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cw{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=qg(),[n,r]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${r}.0, ${n}.0);\n            vec4 values = ${e.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${e.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ew={kernelName:d.ob,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:i}=e;const{numChannels:a}=r,o="undefined"!=typeof HTMLVideoElement&&i instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&i instanceof HTMLImageElement,[u,c]=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],l=[c,u],f=[c,u,a];(s||o)&&(null==Sw&&(Sw=document.createElement("canvas").getContext("2d")),Sw.canvas.width=u,Sw.canvas.height=c,Sw.drawImage(i,0,0,u,c),i=Sw.canvas);const h=n.makeTensorInfo(l,"int32");n.texData.get(h.dataId).usage=lg.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),i);const p=Object(d.Me)().getBool("WEBGL_PACK")?new Cw(f):new Aw(f),m=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),m}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */};let Sw;const jw={kernelName:d.qb,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a,bias:o,preluActivationWeights:s}=e,{strides:u,pad:c,dataFormat:l,dilations:f,dimRoundingMode:h,activation:p,leakyreluAlpha:m}=r,g=d.Ld.convertConv2DDataFormat(l),b=d.Ld.computeConv2DInfo(i.shape,a.shape,u,f,c,h,!1,g);let y;const v=[];if(1!==b.filterHeight||1!==b.filterWidth||1!==b.dilationHeight||1!==b.dilationWidth||1!==b.strideHeight||1!==b.strideWidth||"SAME"!==b.padInfo.type&&"VALID"!==b.padInfo.type)if(Object(d.Me)().getBool("WEBGL_CONV_IM2COL")&&1===i.shape[0])y=gx({x:i,filter:a,convInfo:b,backend:n,bias:o,activation:p,preluActivationWeights:s,leakyreluAlpha:m});else{const t=null!=o,e=null!=s,r="leakyrelu"===p,u=p?jy(p,!1):null,c=new fx(b,t,u,e,r),l=[i,a];if(o&&l.push(o),s&&l.push(s),r){const t=n.makeTensorInfo([],"float32",d.qi.createScalarValue(m,"float32"));l.push(t),v.push(t)}y=n.runWebGLProgram(c,l,"float32")}else y=mx({x:i,filter:a,convInfo:b,backend:n,bias:o,activation:p,preluActivationWeights:s,leakyreluAlpha:m});const x=Ry({inputs:{x:y},backend:n,attrs:{shape:b.outShape}});return v.push(y),v.forEach(t=>n.disposeIntermediateTensorInfo(t)),x}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nw={kernelName:d.rb,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a,bias:o,preluActivationWeights:s}=e,{strides:u,pad:c,dilations:l,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=r,m=[];let g=l;null==g&&(g=[1,1]),d.qi.assert(d.Ld.eitherStridesOrDilationsAreOne(u,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${g}'`);const b=d.Ld.computeConv2DInfo(i.shape,a.shape,u,g,c,f,!0),y=Object(d.Me)().getBool("WEBGL_PACK_DEPTHWISECONV")&&b.strideWidth<=2&&b.outChannels/b.inChannels==1,v=h?jy(h,y):null,x=[i,a],w=null!=o,k=null!=s,O="leakyrelu"===h;if(w&&x.push(o),k&&x.push(s),O){const t=n.makeTensorInfo([],"float32",d.qi.createScalarValue(p,"float32"));x.push(t),m.push(t)}let _;_=y?new Px(b,w,v,k,O):new Lx(b,w,v,k,O);const A=n.runWebGLProgram(_,x,"float32");return m.forEach(t=>n.disposeIntermediateTensorInfo(t)),A}};class Tw{constructor(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;const r=xb(e.length),i=xb(n.length),a=this.sliceDim>1?"strides[j]":"strides";this.userCode=`\n        ${r} strides = ${r}(${this.strides});\n         void main() {\n          ${i} coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ${this.sliceDim}; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ${a};\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fw={kernelName:d.sb,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{params:r,indices:i}=e,a=i.shape,o=a[a.length-1],[s,u,c,l]=d.Ld.prepareAndValidate(r,i),f=Ry({inputs:{x:i},backend:n,attrs:{shape:[u,o]}}),h=Ry({inputs:{x:r},backend:n,attrs:{shape:[d.qi.sizeFromShape(r.shape)/c,c]}}),p=new Tw(o,l,[u,c]),m=n.runWebGLProgram(p,[h,f],h.dtype),g=Ry({inputs:{x:m},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),g}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dw{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;const n=xb(this.rank),r=function(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let e=0;e<t.length;e++)2===e?r.push("int(getIndices(resRC.x, resRC.z))"):r.push(""+n[e]);return r.join()}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(t);this.userCode=`\n      void main() {\n        ${n} resRC = getOutputCoords();\n        setOutput(getA(${r}));\n      }\n    `}}const Iw={kernelName:d.tb,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,indices:a}=e,{axis:o,batchDims:s}=r,u=d.qi.parseAxisParam(o,i.shape)[0],c=d.Ld.segment_util.collectGatherOpShapeInfo(i,a,u,s),l=d.qi.sizeFromShape(a.shape),f=[],h=Ry({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),p=Ry({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,l/c.batchSize]}});f.push(h),f.push(p);const m=[c.batchSize,c.outerSize,l/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([i,a])||"string"===i.dtype){const t=n.bufferSync(p),e=n.bufferSync(h),r=Fb(e,t,m);return f.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(c.outputShape,r.dtype,r.values)}const g=new Dw(h.shape,m),b=n.runWebGLProgram(g,[h,p],h.dtype);f.push(b);const y=Ry({inputs:{x:b},backend:n,attrs:{shape:c.outputShape}});return f.forEach(t=>n.disposeIntermediateTensorInfo(t)),y}},Mw=Sy({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:Db,dtype:"bool"}),$w={kernelName:d.ub,backendName:"webgl",kernelFunc:Mw},Rw=Sy({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool"}),Bw={kernelName:d.vb,backendName:"webgl",kernelFunc:Rw};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zw={kernelName:d.wb,backendName:"webgl",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n}=t,{input:r}=e;return hw(r,!0,n)}},Lw=Ey({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),Pw={kernelName:d.zb,backendName:"webgl",kernelFunc:Lw},qw=Ey({opSnippet:"return float(isinf(x));",dtype:"bool"}),Ww={kernelName:d.Ab,backendName:"webgl",kernelFunc:qw},Uw=Ey({opSnippet:"return float(isnan(x));",dtype:"bool"}),Vw={kernelName:d.Bb,backendName:"webgl",kernelFunc:Uw},Gw=Sy({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:Ib,dtype:"bool"}),Hw={kernelName:d.Gb,backendName:"webgl",kernelFunc:Gw},Xw=Sy({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",dtype:"bool"}),Kw={kernelName:d.Hb,backendName:"webgl",kernelFunc:Xw};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yw={kernelName:d.Ib,backendName:"webgl",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{backend:e,attrs:n}=t,{start:r,stop:i,num:a}=n,o=Mb(r,i,a);return e.makeTensorInfo([o.length],"float32",o)}},Jw=Ey({opSnippet:"if (x < 0.0) return NAN;\n  return log(x);",packedOpSnippet:"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:$b}),Zw={kernelName:d.Jb,backendName:"webgl",kernelFunc:Jw},Qw=Ey({opSnippet:"return log(1.0 + x);"}),tk={kernelName:d.Kb,backendName:"webgl",kernelFunc:Qw},ek=Sy({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),nk={kernelName:d.Mb,backendName:"webgl",kernelFunc:ek},rk=Ey({opSnippet:"return float(!(x >= 1.0));"}),ik={kernelName:d.Nb,backendName:"webgl",kernelFunc:rk},ak=Sy({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),ok={kernelName:d.Ob,backendName:"webgl",kernelFunc:ak};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class sk{constructor(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];const a=e,o=t[3]-1;let s;this.outputShape=t;const u=`float(${n}) + float(${r}) * sum`;s=.5===i?`inversesqrt(${u})`:1===i?`1.0/(${u})`:`exp(log(${u}) * float(-${i}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${a}; j <= ${a}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${o}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${s};\n        setOutput(val);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uk{constructor(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=e,o=t[3]-1;let s;this.outputShape=t;const u=`float(${n}) + float(${r}) * sum`;s=.5===i?`inversesqrt(${u})`:1===i?`1.0/(${u})`:`exp(log(${u}) * float(-${i}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${a};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${a}; j <= ${a}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${s};\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ck={kernelName:d.Db,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{depthRadius:a,bias:o,alpha:s,beta:u}=r,c=Object(d.Me)().getBool("WEBGL_PACK_NORMALIZATION")?new uk(i.shape,a,o,s,u):new sk(i.shape,a,o,s,u);return n.runWebGLProgram(c,[i],i.dtype)}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class lk{constructor(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${e})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${e} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${r}) * norm + float(${n});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${r})\n                * float(${i})\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${i});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dk={kernelName:d.Eb,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i,y:a,dy:o}=e,{depthRadius:s,bias:u,alpha:c,beta:l}=r,d=new lk(i.shape,s,u,c,l);return n.runWebGLProgram(d,[i,a,o],i.dtype)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function fk(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reductionIndices:a,keepDims:o}=r,s=i.shape.length,u=d.qi.parseAxisParam(a,i.shape);let c=u;const l=d.Ld.getAxesPermutation(c,s),f=null!=l,h=n.shouldExecuteOnCPU([i]);let p=i;if(f){if(h){const t=n.texData.get(p.dataId).values,e=new Array(s);for(let t=0;t<e.length;t++)e[t]=i.shape[l[t]];const r=Jb(t,i.shape,i.dtype,l,e);p=n.makeTensorInfo(e,i.dtype);n.texData.get(p.dataId).values=r}else p=Uy(i,l,n);c=d.Ld.getInnerMostAxes(c.length,s)}d.Ld.assertAxesAreInnerMostDims("max",c,s);const[m,g]=d.Ld.computeOutAndReduceShapes(p.shape,c);let b,y=m;if(o&&(y=d.Ld.expandShapeToKeepDim(m,u)),h){const t=n.texData.get(p.dataId).values,e=Rb(t,d.qi.sizeFromShape(g),y,i.dtype);b=n.makeTensorInfo(y,i.dtype);n.texData.get(b.dataId).values=e}else b=
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,r){const i=d.qi.sizeFromShape(e),a=Ry({inputs:{x:t},attrs:{shape:[d.qi.sizeFromShape(t.shape)/i,i]},backend:r}),o=Py(a,t.dtype,"max",r),s=Ry({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(o),s}(p,g,y,n);return f&&n.disposeIntermediateTensorInfo(p),b}const hk={kernelName:d.Pb,backendName:"webgl",kernelFunc:fk},pk=Sy({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:Bb}),mk={kernelName:d.Vb,backendName:"webgl",kernelFunc:pk};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gk={kernelName:d.Qb,backendName:"webgl",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;Lg(i,"maxPool");const{filterSize:a,strides:o,pad:s,dimRoundingMode:u}=r;d.qi.assert(d.Ld.eitherStridesOrDilationsAreOne(o,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const c=d.Ld.computePool2DInfo(i.shape,a,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&d.qi.arraysEqual(c.inShape,c.outShape))return by({inputs:{x:i},backend:n});const l=new Av(c,"max",!1);return n.runWebGLProgram(l,[i],i.dtype)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bk={kernelName:d.Rb,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:a,strides:o,pad:s,dataFormat:u,dimRoundingMode:c}=r,l=d.Ld.computePool3DInfo(i.shape,a,o,[1,1,1],s,c,u),f=new Cv(l,"max",!1);return n.runWebGLProgram(f,[i],i.dtype)}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yk{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,i=t.effectiveFilterHeight,a=t.effectiveFilterWidth,o=i-1-t.padInfo.top,s=a-1-t.padInfo.left,u=i*a-1;this.userCode=`\n      const ivec2 pads = ivec2(${o}, ${s});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${i};\n          wR += ${r}) {\n          float dyR = float(dyRCorner + wR) / ${e}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${a}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${n}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${a} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class vk{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.dilationDepth,a=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=s-1-t.padInfo.front,d=u-1-t.padInfo.top,f=c-1-t.padInfo.left,h=s*u*c-1;this.userCode=`\n      const ivec3 pads = ivec3(${l}, ${d}, ${f});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${s};\n           wD += ${i}) {\n          float dyD = float(dyDCorner + wD) / ${e}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${u};\n              wR += ${a}) {\n            float dyR = float(dyRCorner + wR) / ${n}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${c};\n                wC += ${o}) {\n              float dyC = float(dyCCorner + wC) / ${r}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${h} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${u} * ${c} +\n                  wR * ${c} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xk={kernelName:d.Sb,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a}=e,o=a,{filterSize:s,strides:u,pad:c,dimRoundingMode:l}=r,f=d.Ld.computePool3DInfo(o.shape,s,u,[1,1,1],c,l),h=new Cv(f,"max",!0),p=n.runWebGLProgram(h,[o],o.dtype),m=new vk(f),g=n.runWebGLProgram(m,[i,p],o.dtype);return n.disposeIntermediateTensorInfo(p),g}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wk={kernelName:d.Tb,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a,output:o}=e,s=a;Lg([a,o],"maxPoolGrad");const{filterSize:u,strides:c,pad:l,dimRoundingMode:f}=r,h=d.Ld.computePool2DInfo(s.shape,u,c,1,l,f),p=new Av(h,"max",!0),m=n.runWebGLProgram(p,[s],s.dtype),g=new yk(h),b=n.runWebGLProgram(g,[i,m],s.dtype);return n.disposeIntermediateTensorInfo(m),b}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const kk={kernelName:d.Ub,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:i,strides:a,pad:o,includeBatchInIndex:s}=e,u=n;d.qi.assert(4===r.shape.length,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const c=[1,1];d.qi.assert(d.Ld.eitherStridesOrDilationsAreOne(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const l=d.Ld.computePool2DInfo(r.shape,i,a,c,o),[f,h]=function(t,e,n,r){let i=new Av(n,"max",!1);const a=r.runWebGLProgram(i,[t],"float32");return i=new Av(n,"max",!0,!0,e),[a,r.runWebGLProgram(i,[t],"float32")]}(r,s,l,u);return[f,h]}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Ok={kernelName:d.Wb,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:i,axis:a}=e,o=n,s=r.shape.length,u=d.qi.parseAxisParam(a,r.shape);let c=u;const l=d.Ld.getAxesPermutation(c,s),f=null!=l,h=o.shouldExecuteOnCPU([r]),p=[];let m=r;if(f){if(h){const t=o.texData.get(m.dataId).values,e=new Array(s);for(let t=0;t<e.length;t++)e[t]=r.shape[l[t]];const n=Jb(t,r.shape,r.dtype,l,e);m=o.makeTensorInfo(e,r.dtype);o.texData.get(m.dataId).values=n}else m=Uy(r,l,o);p.push(m),c=d.Ld.getInnerMostAxes(c.length,s)}d.Ld.assertAxesAreInnerMostDims("sum",c,s);const[g,b]=d.Ld.computeOutAndReduceShapes(m.shape,c);let y=g;i&&(y=d.Ld.expandShapeToKeepDim(g,u));const v=function(t,e,n,r){const i=d.qi.sizeFromShape(e),a=Ry({inputs:{x:t},attrs:{shape:[d.qi.sizeFromShape(t.shape)/i,i]},backend:r}),o=Py(a,"float32","mean",r),s=Ry({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(o),s}(m,b,y,o);for(const t of p)o.disposeIntermediateTensorInfo(t);return v}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _k={kernelName:d.Xb,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:o}=r,s=i.shape.length,u=d.qi.parseAxisParam(a,i.shape);let c=u;const l=d.Ld.getAxesPermutation(c,s);let f=i;null!=l&&(f=Hy({inputs:{x:i},backend:n,attrs:{perm:l}}),c=d.Ld.getInnerMostAxes(c.length,i.shape.length)),d.Ld.assertAxesAreInnerMostDims("min",c,s);const[h,p]=d.Ld.computeOutAndReduceShapes(f.shape,c),m=Ry({inputs:{x:f},backend:n,attrs:{shape:[-1,d.qi.sizeFromShape(p)]}}),g=Py(m,m.dtype,"min",n);let b;if(o){b=Ry({inputs:{x:g},backend:n,attrs:{shape:d.Ld.expandShapeToKeepDim(h,u)}})}else b=Ry({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),null!=l&&n.disposeIntermediateTensorInfo(f),b}},Ak=Sy({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:zb}),Ck={kernelName:d.Yb,backendName:"webgl",kernelFunc:Ak};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Ek{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,i=xb(r),a=e.map(t=>t[0]).join(","),o=e.map((e,n)=>e[0]+t[n]).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),u="reflect"===n?0:1;this.userCode=1!==r?`\n      ${i} start = ${i}(${a});\n      ${i} end = ${i}(${o});\n\n      void main() {\n        ${i} outC = getOutputCoords();\n        for (int i = 0; i < ${r}; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ${u};\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};\n          }\n        }\n        ${i} coords = outC - start;\n        setOutput(getX(${s}));\n      }\n    `:`\n        int start = ${a};\n        int end = ${o};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ${u};\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ${u};\n          }\n          setOutput(getX(outC - start));\n        }\n      `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sk{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,i=xb(r),a=e.map(t=>t[0]).join(","),o=e.map((e,n)=>e[0]+t[n]).join(","),s=ty("rc",r),u=ty("source",r),c=`${s[r-1]} < ${this.outputShape[r-1]}`,l=1===r?"source":`vec2(${u.slice(-2).join()})`,d="reflect"===n?0:1;let f="";if(1===r){const t=`\n        ${i} source = rc;\n        if (source < start) {\n          source = start * 2 - source - ${d};\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ${d};\n        }\n        source -= start;\n      `;f=`\n        ${i} rc = outputLoc;\n        ${t}\n        result[0] = getChannel(getX(${u.join()}), ${l});\n        ${s[r-1]} += 1;\n        if(${c}) {\n          ${t}\n          result[1] = getChannel(getX(${u.join()}), ${l});\n        }\n      `}else{const t=`\n        ${i} source = rc;\n        ${i} lt = ${i}(lessThan(source, start));\n        ${i} gte = ${i}(greaterThanEqual(source, end));\n        ${i} orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ${d}) +\n                gte * ((end - 1) * 2 - source + ${d});\n        source -= start;\n      `;f=`\n        ${i} rc = outputLoc;\n        ${t}\n        result[0] = getChannel(getX(${u.join()}), ${l});\n        ${s[r-1]} += 1;\n        if(${c}) {\n          ${t}\n          result[1] = getChannel(getX(${u.join()}), ${l});\n        }\n        rc = outputLoc;\n        ${s[r-2]} += 1;\n        if(${s[r-2]} < ${this.outputShape[r-2]}) {\n          ${t}\n          result[2] = getChannel(getX(${u.join()}), ${l});\n          ${s[r-1]} += 1;\n          if(${c}) {\n            ${t}\n            result[3] = getChannel(getX(${u.join()}), ${l});\n          }\n        }\n      `}this.userCode=`\n      const ${i} start = ${i}(${a});\n      const ${i} end = ${i}(${o});\n\n      void main() {\n        ${i} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${f}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jk={kernelName:d.Zb,backendName:"webgl",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:i,mode:a}=n,o=Object(d.Me)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Sk(r.shape,i,a):new Ek(r.shape,i,a);return e.runWebGLProgram(o,[r],r.dtype)}},Nk=Sy({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),Tk={kernelName:d.ac,backendName:"webgl",kernelFunc:Nk};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Fk{constructor(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode=`\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${e-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${e-1}));\n      }\n    `}getCustomSetupFunc(t){return(e,n)=>{null==this.seedLoc&&(this.seedLoc=e.getUniformLocation(n,"seed")),e.gl.uniform1f(this.seedLoc,t)}}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dk=Sy({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),Ik={kernelName:d.xc,backendName:"webgl",kernelFunc:Dk},Mk="return a - b;",$k=Sy({opSnippet:Mk,packedOpSnippet:Mk,supportsComplex:!0,cpuKernelImpl:Xb}),Rk={kernelName:d.ed,backendName:"webgl",kernelFunc:$k};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Bk(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{dim:a}=r,o=d.qi.parseAxisParam([a],i.shape),s=fk({inputs:{x:i},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),u=d.Ld.expandShapeToKeepDim(s.shape,o),c=Ry({inputs:{x:s},backend:n,attrs:{shape:u}}),l=$k({inputs:{a:i,b:c},backend:n}),f=aw({inputs:{x:l},backend:n}),h=Vy({inputs:{x:f},backend:n,attrs:{axis:o,keepDims:!1}}),p=Ry({inputs:{x:h},backend:n,attrs:{shape:u}}),m=Dk({inputs:{a:f,b:p},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),m}const zk={kernelName:d.Uc,backendName:"webgl",kernelFunc:Bk};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lk={kernelName:d.cc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{numSamples:a,seed:o,normalized:s}=r,u=s?i:Bk({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),c=u.shape[0],l=u.shape[1],d=new Fk(c,l,a),f=d.getCustomSetupFunc(o),h=n.runWebGLProgram(d,[u],"int32",f);return s||n.disposeIntermediateTensorInfo(u),h}},Pk="return -x;";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qk={kernelName:d.ec,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const t=n.texData.get(r.dataId),[e,i]=Pb(t.values,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,e)}let i;return i=Object(d.Me)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new ly(r.shape,Pk):new sy(r.shape,Pk),n.runWebGLProgram(i,[r],r.dtype)}},Wk=d.yf.nonMaxSuppressionV3Impl;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uk={kernelName:d.fc,backendName:"webgl",kernelFunc:function(t){d.Ld.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:a}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:u}=r,c=n.readSync(i.dataId),l=n.readSync(a.dataId),{selectedIndices:f}=Wk(c,l,o,s,u);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}},Vk=d.yf.nonMaxSuppressionV4Impl;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gk={kernelName:d.gc,backendName:"webgl",kernelFunc:function(t){d.Ld.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:a}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:u,padToMaxOutputSize:c}=r,l=n.readSync(i.dataId),f=n.readSync(a.dataId),{selectedIndices:h,validOutputs:p}=Vk(l,f,o,s,u,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},Hk=d.yf.nonMaxSuppressionV5Impl;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xk={kernelName:d.hc,backendName:"webgl",kernelFunc:function(t){d.Ld.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:a}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:u,softNmsSigma:c}=r,l=n.readSync(i.dataId),f=n.readSync(a.dataId),h=o,p=s,m=u,g=c,{selectedIndices:b,selectedScores:y}=Hk(l,f,h,p,m,g);return[n.makeTensorInfo([b.length],"int32",new Int32Array(b)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kk{constructor(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${r}), float(${n}),\n                      float(index == coords.y)));\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yk={kernelName:d.kc,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:i}=e,{depth:a,onValue:o,offValue:s}=r,u=d.qi.sizeFromShape(i.shape),c=new Kk(u,a,o,s),l=Ry({inputs:{x:i},backend:n,attrs:{shape:[u]}}),f=n.runWebGLProgram(c,[l],i.dtype);n.disposeIntermediateTensorInfo(l);const h=Ry({inputs:{x:f},backend:n,attrs:{shape:[...i.shape,a]}});return n.disposeIntermediateTensorInfo(f),h}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Jk(t){const{inputs:e,backend:n}=t,{x:r}=e;if("complex64"===r.dtype){const t=Gv({inputs:{input:r},backend:n}),e=Jk({inputs:{x:t},backend:n}),i=sx({inputs:{input:r},backend:n}),a=Jk({inputs:{x:i},backend:n}),o=vy({inputs:{real:e,imag:a},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),o}return gw({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const Zk={kernelName:d.rd,backendName:"webgl",kernelFunc:Jk};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qk={kernelName:d.lc,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:r}=e,{x:i}=n;if("string"===i.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===i.dtype){const e=Gv({inputs:{input:i},backend:r}),n=t({inputs:{x:e},backend:r}),a=sx({inputs:{input:i},backend:r}),o=Jk({inputs:{x:a},backend:r}),s=vy({inputs:{real:n,imag:o},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(o),s}return gw({attrs:{shape:i.shape,dtype:i.dtype,value:1},backend:r})}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tO={kernelName:d.nc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r;if(1===e.length)return sw({inputs:{input:e[0]},backend:n,attrs:{dim:i}});const a=e[0].shape,o=e[0].dtype;e.forEach(t=>{d.qi.assertShapesMatch(a,t.shape,"All tensors passed to stack must have matching shapes"),d.qi.assert(o===t.dtype,()=>"All tensors passed to stack must have matching dtypes")});const s=[],u=lx({inputs:e.map(t=>{const e=sw({inputs:{input:t},backend:n,attrs:{dim:i}});return s.push(e),e}),backend:n,attrs:{axis:i}});return s.forEach(t=>n.disposeIntermediateTensorInfo(t)),u}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eO{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,i=xb(r),a=e.map(t=>t[0]).join(","),o=e.map((e,n)=>e[0]+t[n]).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?`\n      ${i} start = ${i}(${a});\n      ${i} end = ${i}(${o});\n\n      void main() {\n        ${i} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float(${n}));\n        } else {\n          ${i} coords = outC - start;\n          setOutput(getX(${s}));\n        }\n      }\n    `:`\n        int start = ${a};\n        int end = ${o};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float(${n}));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nO{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,i=xb(r),a=e.map(t=>t[0]).join(","),o=e.map((e,n)=>e[0]+t[n]).join(","),s=ty("rc",r),u=ty("source",r),c=`${s[r-1]} < ${this.outputShape[r-1]}`,l=1===r?"source":`vec2(${u.slice(-2).join()})`,d=[i+" rc = outputLoc;",`${s[r-1]} += 1;\n       if(${c}) {\n      `,1===r?"":`}\n       rc = outputLoc;\n       ${s[r-2]} += 1;\n       if(${s[r-2]} < ${this.outputShape[r-2]}) {`,1===r?"":`  ${s[r-1]} += 1;\n         if(${c}) {`],f=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let h="";for(let t=0,e=1===r?2:4;t<e;t++)h+=`\n        ${d[t]}\n        if (${f}) {\n          result[${t}] = float(${n});\n        } else {\n          ${i} source = rc - start;\n          result[${t}] = getChannel(getX(${u.join()}), ${l});\n        }\n      `;h+=1===r?"} ":"}}",this.userCode=`\n      const ${i} start = ${i}(${a});\n      const ${i} end = ${i}(${o});\n\n      void main() {\n        ${i} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${h}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rO=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{paddings:a,constantValue:o}=r,s=Object(d.Me)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new nO(i.shape,a,o):new eO(i.shape,a,o);return n.runWebGLProgram(s,[i],i.dtype)},iO={kernelName:d.oc,backendName:"webgl",kernelFunc:rO},aO=Sy({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),oO={kernelName:d.qc,backendName:"webgl",kernelFunc:aO};const sO={kernelName:d.sc,backendName:"webgl",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:o}=r,s=i.shape.length,u=[],c=d.qi.parseAxisParam(a,i.shape);let l=c;const f=d.Ld.getAxesPermutation(l,s);let h,p=i;if(null!=f&&(p=Hy({inputs:{x:i},backend:n,attrs:{perm:f}}),l=d.Ld.getInnerMostAxes(l.length,s),u.push(p)),d.Ld.assertAxesAreInnerMostDims("prod",l,s),n.shouldExecuteOnCPU([p])){const t=n.texData.get(p.dataId).values,{outVals:e,outShape:r,outDtype:i}=qb(p.shape,p.dtype,t,l);h=n.makeTensorInfo(r,i,e)}else{const[t,e]=d.Ld.computeOutAndReduceShapes(p.shape,l),r=d.qi.sizeFromShape(e),a=Ry({inputs:{x:p},backend:n,attrs:{shape:[-1,r]}}),o=Py(a,Object(d.Rh)(i.dtype),"prod",n);h=Ry({inputs:{x:o},backend:n,attrs:{shape:t}}),u.push(a),u.push(o)}if(o){u.push(h);const t=d.Ld.expandShapeToKeepDim(h.shape,c);h=Ry({inputs:{x:h},backend:n,attrs:{shape:t}})}return u.forEach(t=>n.disposeIntermediateTensorInfo(t)),h}},uO=t=>{const{backend:e,attrs:n}=t,{start:r,stop:i,step:a,dtype:o}=n,s=Wb(r,i,a,o);return e.makeTensorInfo([s.length],o,s)},cO={kernelName:d.uc,backendName:"webgl",kernelFunc:uO},lO=Ey({opSnippet:"return 1.0 / x;"}),dO={kernelName:d.yc,backendName:"webgl",kernelFunc:lO},fO=Ey({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),hO={kernelName:d.Ac,backendName:"webgl",kernelFunc:fO},pO=Ey({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),mO={kernelName:d.Bc,backendName:"webgl",kernelFunc:pO};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class gO{constructor(t,e,n,r,i){this.variableNames=["A"],this.outputShape=[];const[a,o,s,u]=t;this.outputShape=[a,e,n,u];const c=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n];let d;d=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${c[0]/l[0]},\n          ${c[1]/l[1]});\n      const vec2 inputShapeRC = vec2(${o}.0, ${s}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${d};\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bO{constructor(t,e,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,s,u]=t;this.outputShape=[a,e,n,u];const c=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n];let d;d=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${c[0]/l[0]},\n          ${c[1]/l[1]},\n          ${c[1]/l[1]});\n      const vec3 inputShapeRC = vec3(${o}.0, ${s}.0,\n                                     ${s}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${d};\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${u-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yO={kernelName:d.Dc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:a,halfPixelCenters:o,size:s}=r,[u,c]=s,l=Object(d.Me)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new bO(i.shape,u,c,a,o):new gO(i.shape,u,c,a,o);return n.runWebGLProgram(l,[i],"float32")}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vO{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,i]=e,[,a,o]=t,s=[n&&a>1?r-1:r,n&&o>1?i-1:i],u=[n&&a>1?a-1:a,n&&o>1?o-1:o],c=s[0]/u[0],l=s[1]/u[1],d=1/c,f=1/l,h=2*Math.ceil(d)+2,p=2*Math.ceil(f)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${c});\n        const float widthScale = float(${l});\n\n        const float invHeightScale = float(${d});\n        const float invWidthScale = float(${f});\n\n        const int winHeight = int(${h});\n        const int winWidth = int(${p});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${a}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${o}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xO={kernelName:d.Ec,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:a}=e,{alignCorners:o}=r,s=new vO(a.shape,i.shape,o);return n.runWebGLProgram(s,[a],a.dtype)}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wO{constructor(t,e,n,r,i){this.variableNames=["A"],this.outputShape=[];const[a,o,s,u]=t;this.outputShape=[a,e,n,u];const c=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=r?"0.5":"0.0";let f;f=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${c[0]/l[0]},\n          ${c[1]/l[1]});\n      const vec2 inputShapeRC = vec2(${o}.0, ${s}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${f};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kO={kernelName:d.Fc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:a,halfPixelCenters:o,size:s}=r,[u,c]=s,l=new wO(i.shape,u,c,a,o);return n.runWebGLProgram(l,[i],i.dtype)}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OO{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,i]=e,[,a,o]=t,s=[n&&a>1?r-1:r,n&&o>1?i-1:i],u=[n&&a>1?a-1:a,n&&o>1?o-1:o],c=s[0]/u[0],l=s[1]/u[1],d=1/c,f=1/l,h=2*Math.ceil(d)+2,p=2*Math.ceil(f)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${c});\n        const float widthScale = float(${l});\n\n        const float invHeightScale = float(${d});\n        const float invWidthScale = float(${f});\n\n        const int winHeight = int(${h});\n        const int winWidth = int(${p});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${a}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${o}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${s[0]}) *\n                (float(dyR) / float(${u[0]}));\n\n            float sourceFracCol =\n                float(${s[1]}) *\n                  (float(dyC) / float(${u[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${r}) - 1),\n                ${n} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${i}) - 1),\n                ${n} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _O={kernelName:d.Gc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:a}=e,{alignCorners:o}=r,s=new OO(a.shape,i.shape,o);return n.runWebGLProgram(s,[a],a.dtype)}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AO{constructor(t,e){this.variableNames=["x"];const n=t.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=t,1===n)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${t[0]} - coord - 1));\n        }\n      `);const r=t.map((n,r)=>(n=>-1!==e.indexOf(n)&&1!==t[n]?`${t[n]} - coords[${n}] - 1`:`coords[${n}]`)(r)).join(","),i=xb(n);this.userCode=`\n      void main() {\n        ${i} coords = getOutputCoords();\n        setOutput(getX(${r}));\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CO{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=t.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=t;const r=ty("rc",n),i=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,a=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,o=xb(n);function s(n){const r=t.map((r,i)=>function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?`${t[n]} - ${r[n]} - 1`:""+r[n]}(i,n));return`getChannel(getX(${r.join(",")}), vec2(${r.slice(-2).join(",")}))`}this.userCode=1===n?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${t[0]} - rc - 1),\n            ${t[0]} - rc - 1);\n          if(${i}){\n              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),\n                ${t[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${o} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${function(t){return s(t)}(r.slice())};\n          if(${i}){\n            result.g = ${function(t){return t[n-1]="("+t[n-1]+" + 1)",s(t)}(r.slice())};\n          }\n          if(${a}) {\n            result.b = ${function(t){return t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())};\n            if(${i}) {\n              result.a = ${function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EO={kernelName:d.Hc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dims:a}=r,o=i.shape.length,s=d.qi.parseAxisParam(a,i.shape);if(0===o)return by({inputs:{x:i},backend:n});const u=Object(d.Me)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new CO(i.shape,s):new AO(i.shape,s);return n.runWebGLProgram(u,[i],i.dtype)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SO{constructor(t,e,n,r){this.variableNames=["Image"],this.outputShape=[];const i=t[1],a=t[2],o=Math.sin(e).toFixed(3),s=Math.cos(e).toFixed(3);this.outputShape=t;const[u,c]=d.Ld.getImageCenter(r,i,a),l=u.toFixed(3),f=c.toFixed(3);let h="";h="number"==typeof n?`float outputValue = ${n.toFixed(2)};`:`\n        vec3 fill = vec3(${n.join(",")});\n        float outputValue = fill[coords[3]];`,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - ${l}) * ${s} - (float(y) - ${f}) * ${o};\n          float coordYFloat = (float(x) - ${l}) * ${o} + (float(y) - ${f}) * ${s};\n          int coordX = int(round(coordXFloat + ${l}));\n          int coordY = int(round(coordYFloat + ${f}));\n          ${h}\n          if(coordX >= 0 && coordX < ${a} && coordY >= 0 && coordY < ${i}) {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jO={kernelName:d.Ic,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:i,fillValue:a,center:o}=e,s=n,u=new SO(r.shape,i,a,o);return s.runWebGLProgram(u,[r],r.dtype)}},NO=Ey({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),TO={kernelName:d.Jc,backendName:"webgl",kernelFunc:NO},FO=Ey({opSnippet:"return inversesqrt(x);",cpuKernelImpl:Ub}),DO={kernelName:d.Kc,backendName:"webgl",kernelFunc:FO};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class IO{constructor(t,e,n,r,i,a,o=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;const s=xb(i.length),u=xb(a.length);let c="";1===n?c="i":2===n&&(c="i, j");const l=`getIndices(${c})`;let d="";1===r?d="i":2===r&&(d="i, coords[1]");const f=`getUpdates(${d})`,h=e>1?"strides[j]":"strides";this.userCode=`\n        ${s} strides = ${s}(${i});\n\n        void main() {\n          ${u} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${t}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${e}; j++) {\n              int index = round(${l});\n              flattenedIndex += index * ${h};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ${f};\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MO={kernelName:d.Mc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{indices:i,updates:a}=e,{shape:o}=r,{sliceRank:s,numUpdates:u,sliceSize:c,strides:l,outputSize:f}=d.Ld.calculateShapes(a,i,o),h=[f/c,c];if(0===f)return n.makeTensorInfo(o,i.dtype);const p=Ry({inputs:{x:i},backend:n,attrs:{shape:[u,s]}}),m=Ry({inputs:{x:a},backend:n,attrs:{shape:[u,c]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0])),b=new IO(u,s,p.shape.length,m.shape.length,l,h),y=n.runWebGLProgram(b,[m,p,g],m.dtype),v=Ry({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),v}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $O{constructor(t,e,n){let r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error(`Where for rank ${n} is not yet supported`);if(1===n)i="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],o=[];for(let r=0;r<e.length;r++)o.push(""+n[r]),r<t&&a.push(""+n[r]);r=a.join(),i=o.join()}const a=xb(n);this.userCode=`\n      void main() {\n        ${a} resRC = getOutputCoords();\n        float cVal = getC(${r});\n        if (cVal >= 1.0) {\n          setOutput(getA(${i}));\n        } else {\n          setOutput(getB(${i}));\n        }\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RO={kernelName:d.Nc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{condition:r,t:i,e:a}=e,o=new $O(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(o,[r,i,a],Object(d.pi)(i.dtype,a.dtype))}},BO=Ey({opSnippet:`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${d.Ld.SELU_SCALEALPHA};\n  float scale = ${d.Ld.SELU_SCALE};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`}),zO={kernelName:d.Oc,backendName:"webgl",kernelFunc:BO},LO=Ey({opSnippet:"return 1.0 / (1.0 + exp(-1.0 * x));"}),PO={kernelName:d.Pc,backendName:"webgl",kernelFunc:LO},qO=Ey({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),WO={kernelName:d.Qc,backendName:"webgl",kernelFunc:qO},UO=Ey({opSnippet:"if (isnan(x)) return x;\n  return sin(x);\n"}),VO={kernelName:d.Rc,backendName:"webgl",kernelFunc:UO},GO=Ey({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),HO={kernelName:d.Sc,backendName:"webgl",kernelFunc:GO},XO=Ey({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),KO={kernelName:d.Vc,backendName:"webgl",kernelFunc:XO},YO={kernelName:d.Wc,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:a,paddings:o}=r;d.qi.assert(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const s=a.reduce((t,e)=>t*e),u=[[0,0]];u.push(...o);for(let t=1+a.length;t<i.shape.length;++t)u.push([0,0]);const c=[],l=rO({inputs:{x:i},backend:n,attrs:{paddings:u,constantValue:0}}),f=d.Ld.getReshaped(l.shape,a,s,!1),h=d.Ld.getPermuted(f.length,a.length,!1),p=d.Ld.getReshapedPermuted(l.shape,a,s,!1),m=Ry({inputs:{x:l},backend:n,attrs:{shape:f}}),g=Hy({inputs:{x:m},backend:n,attrs:{perm:h}}),b=Ry({inputs:{x:g},backend:n,attrs:{shape:p}});return c.push(l),c.push(m),c.push(g),c.forEach(t=>n.disposeIntermediateTensorInfo(t)),b}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JO={kernelName:d.Xc,backendName:"webgl",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:i,sparseValues:a,defaultValue:o}=e,{outputShape:s}=r,{sliceRank:u,numUpdates:c,strides:l,outputSize:f}=d.Ld.calculateShapes(a,i,s),h=new IO(c,u,i.shape.length,a.shape.length,l,[f,1],!1),p=n.runWebGLProgram(h,[a,i,o],a.dtype),m=Ry({inputs:{x:p},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(p),m}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZO={kernelName:d.Yc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{numOrSizeSplits:a,axis:o}=r,s=d.qi.parseAxisParam(o,i.shape)[0],u=d.Ld.prepareSplitSize(i,a,s),c=i.shape.length,l=new Array(c).fill(0),f=i.shape.slice();return u.map(t=>{const e=[...f];e[o]=t;const r=Lv({inputs:{x:i},backend:n,attrs:{begin:l,size:e}});return l[o]+=t,r})}},QO=Ey({opSnippet:"return sqrt(x);"}),t_={kernelName:d.Zc,backendName:"webgl",kernelFunc:QO},e_=Ey({opSnippet:"return x * x;"}),n_={kernelName:d.ad,backendName:"webgl",kernelFunc:e_},r_=Sy({opSnippet:"return (a - b) * (a - b);",packedOpSnippet:"return (a - b) * (a - b);"}),i_={kernelName:d.bd,backendName:"webgl",kernelFunc:r_};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a_={kernelName:d.cd,backendName:"webgl",kernelFunc:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function({inputs:t,attrs:e,backend:n}){const{x:r}=t,i=`if (isnan(x)) return x;\n    return x > 0.0 ? 1.0 : float(${e.alpha});\n  `,a=new sy(r.shape,i);return n.runWebGLProgram(a,[r],r.dtype)}};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o_{constructor(t,e,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,i=xb(n.length),a=xb(n.length);let o="";if(1===r)o="coords * strides + begin";else{let t=0;o=n.map((e,r)=>(t++,1===n.length?`coords * strides[${r}] + begin[${r}]`:`coords[${t-1}] * strides[${r}] + begin[${r}]`)).join(",")}this.userCode=`\n      ${i} begin = ${i}(${t});\n      ${i} strides = ${i}(${e});\n\n      void main() {\n        ${a} coords = getOutputCoords();\n        setOutput(getX(${o}));\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s_={kernelName:d.dd,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:a,end:o,strides:s,beginMask:u,endMask:c,ellipsisMask:l,newAxisMask:f,shrinkAxisMask:h}=r,{nonStrided:p,$begin:m,$strides:g,size:b,newShape:y,outShape:v}=d.zh.sliceInfo(i.shape,a,o,s,u,c,l,f,h),x=Ry({inputs:{x:i},backend:n,attrs:{shape:y}});let w;if(p){const t=Lv({inputs:{x:x},backend:n,attrs:{begin:m,size:b}});w=Ry({inputs:{x:t},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(t)}else if(v.some(t=>0===t))w=n.makeTensorInfo(v,i.dtype,[]);else{if(n.shouldExecuteOnCPU([x])){const t=n.texData.get(x.dataId).values,e=Object(d.Wd)(x.shape,x.dtype,t),r=Hb(v,e,g,m);w=n.makeTensorInfo(v,x.dtype,r.values)}else{const t=new o_(m,g,v);w=n.runWebGLProgram(t,[x],x.dtype)}}const k=Ry({inputs:{x:w},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),k}},u_=Ey({opSnippet:"return tan(x);"}),c_={kernelName:d.gd,backendName:"webgl",kernelFunc:u_},l_=Ey({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),d_={kernelName:d.hd,backendName:"webgl",kernelFunc:l_};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class f_{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;const r=xb(this.rank),i=function(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(1===e)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let e=0;e<t.length;e++)r.push(`imod(${n[e]}, ${t[e]})`);return r.join()}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(t);this.userCode=`\n      void main() {\n        ${r} resRC = getOutputCoords();\n        setOutput(getA(${i}));\n      }\n    `}}function h_(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reps:a}=r;if("string"===i.dtype){const t=n.texData.get(i.dataId).values.map(t=>d.qi.decodeString(t)),e=Object(d.Wd)(i.shape,i.dtype,t),r=Kb(e,a);return n.makeTensorInfo(r.shape,r.dtype,r.values)}const o=new f_(i.shape,a);return n.runWebGLProgram(o,[i],i.dtype)}const p_={kernelName:d.kd,backendName:"webgl",kernelFunc:h_};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m_={kernelName:d.ld,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{k:a,sorted:o}=r,s=n.texData.get(i.dataId).values,[u,c]=Yb(s,i.shape,i.dtype,a,o);return[n.makeTensorInfo(u.shape,u.dtype,u.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g_={kernelName:d.nd,backendName:"webgl",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{axis:i}=n,{x:a}=e;Lg(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(a.dataId),{outputValues:s,outputShape:u,indices:c}=Zb(o,i,a.shape,a.dtype);return[r.makeTensorInfo(u,a.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b_={kernelName:d.od,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{value:i}=e;let{axis:a}=r;a<0&&(a+=i.shape.length);const o=i,s=o.shape.length,u=i.shape[a],c=new Array(s-1);let l=0;for(let t=0;t<s;t++)t!==a&&(c[l++]=o.shape[t]);const d=[],f=new Array(s).fill(0),h=o.shape.slice();h[a]=1;const p=new Array(u);for(let t=0;t<p.length;t++){f[a]=t;const e=Lv({inputs:{x:o},backend:n,attrs:{begin:f,size:h}}),r=Ry({inputs:{x:e},backend:n,attrs:{shape:c}});p[t]=r,d.push(e)}return d.forEach(t=>n.disposeIntermediateTensorInfo(t)),p}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y_{constructor(t,e){this.variableNames=["x","segmentIds"];const n=t.windowSize,r=t.batchSize,i=t.inSize,a=t.numSegments,o=a*Math.ceil(i/n);this.outputShape=[r,o];const s=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ";let l="";i%n>0&&(l=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return initializationValue;\n        }\n      `);let d="";i%n>0&&(d=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ${l}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${d}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${a})) * float(${n}));\n        int currentSeg = int(mod(float(outIdx), float(${a})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${s}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${c}\n        }\n\n        int inIdx = inOffset + ${s};\n        if (${1===u}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${c}\n        } else if (${2===u}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${c}\n        } else if (${3===u}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${c}\n        }\n        setOutput(sumValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v_=[ck,dk,Yy,Jy,Qy,ev,iv,sv,uv,cv,hv,pv,gv,yv,kv,xv,_v,Sv,Ev,Tv,Fv,Dv,$v,qv,Wv,Xv,Jv,tx,rx,xy,dx,kx,Ox,bx,Ax,Cx,_x,Sx,Nx,Fx,$x,Rx,zx,Vx,Gx,qx,Xx,Yx,Zx,Qx,ew,rw,ow,uw,dw,pw,bw,vw,kw,_w,Ew,jw,Nw,Fw,Iw,$w,Bw,yy,zw,ux,Pw,Ww,Vw,Oy,Hw,Kw,Yw,tk,Zw,nk,ik,ok,hk,bk,gk,xk,wk,kk,mk,Ok,_k,Ck,jk,Tk,Lk,$y,qk,Uk,Gk,Xk,Vv,Yk,Qk,tO,iO,oO,Cy,sO,cO,Hv,Ik,dO,mO,hO,By,yO,xO,kO,_O,EO,jO,TO,DO,MO,RO,zO,PO,WO,VO,HO,Pv,zk,KO,YO,JO,ZO,t_,n_,i_,a_,s_,Rk,Gy,c_,d_,p_,m_,Xy,g_,b_,{kernelName:d.pd,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,segmentIds:a}=e,{numSegments:o}=r,s=i.shape.length,u=[];let c=0;const l=d.Ld.getAxesPermutation([c],s);let f=i;null!=l&&(f=Hy({inputs:{x:i},backend:n,attrs:{perm:l}}),u.push(f),c=d.Ld.getInnerMostAxes(1,s)[0]);const h=d.Ld.segment_util.computeOutShape(f.shape,c,o),p=d.qi.sizeFromShape([f.shape[c]]),m=Ry({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}});u.push(m);const g=Object(d.Rh)(i.dtype),b=(t,e,r,i,a)=>{const o=t.shape[0],s=t.shape[1],c=d.Ld.segment_util.segOpComputeOptimalWindowSize(s,a),l=new y_({windowSize:c,inSize:s,batchSize:o,numSegments:a},e),f=n.compileAndRun(l,[t,r],i);if(u.push(f),f.shape[1]===a)return f;const h=uO({backend:n,attrs:{start:0,stop:a,step:1,dtype:"float32"}}),p=h_({inputs:{x:h},backend:n,attrs:{reps:[s/c]}});u.push(h),u.push(p);return b(f,e,p,i,a)},y=Ry({inputs:{x:b(m,"unsortedSegmentSum",a,g,o)},backend:n,attrs:{shape:h}});let v=y;if(null!=l){u.push(y);const t=d.Ld.getUndoAxesPermutation(l);v=Hy({inputs:{x:v},backend:n,attrs:{perm:t}})}return u.forEach(t=>n.disposeIntermediateTensorInfo(t)),v}},Zk];
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */for(const t of v_)Object(d.Tg)(t);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/** @license See the LICENSE file. */n.d(e,"version",(function(){return x_})),n.d(e,"AdadeltaOptimizer",(function(){return d.d})),n.d(e,"AdagradOptimizer",(function(){return d.e})),n.d(e,"AdamOptimizer",(function(){return d.f})),n.d(e,"AdamaxOptimizer",(function(){return d.g})),n.d(e,"MomentumOptimizer",(function(){return d.bc})),n.d(e,"Optimizer",(function(){return d.mc})),n.d(e,"RMSPropOptimizer",(function(){return d.tc})),n.d(e,"SGDOptimizer",(function(){return d.Lc})),n.d(e,"Tensor",(function(){return d.id})),n.d(e,"TensorBuffer",(function(){return d.jd})),n.d(e,"Variable",(function(){return d.qd})),n.d(e,"Rank",(function(){return d.vc})),n.d(e,"sumOutType",(function(){return d.Rh})),n.d(e,"upcastType",(function(){return d.pi})),n.d(e,"Reduction",(function(){return d.zc})),n.d(e,"customGrad",(function(){return d.re})),n.d(e,"grad",(function(){return d.if})),n.d(e,"grads",(function(){return d.jf})),n.d(e,"valueAndGrad",(function(){return d.ri})),n.d(e,"valueAndGrads",(function(){return d.si})),n.d(e,"variableGrads",(function(){return d.ui})),n.d(e,"Environment",(function(){return d.db})),n.d(e,"env",(function(){return d.Me})),n.d(e,"ENV",(function(){return d.ab})),n.d(e,"version_core",(function(){return d.vi})),n.d(e,"nextFrame",(function(){return d.og})),n.d(e,"browser",(function(){return d.Vd})),n.d(e,"io",(function(){return d.sf})),n.d(e,"math",(function(){return d.Sf})),n.d(e,"serialization",(function(){return d.lh})),n.d(e,"test_util",(function(){return d.ci})),n.d(e,"util",(function(){return d.qi})),n.d(e,"backend_util",(function(){return d.Ld})),n.d(e,"tensor_util",(function(){return d.bi})),n.d(e,"slice_util",(function(){return d.zh})),n.d(e,"gather_util",(function(){return d.df})),n.d(e,"scatter_util",(function(){return d.ih})),n.d(e,"device_util",(function(){return d.we})),n.d(e,"kernel_impls",(function(){return d.yf})),n.d(e,"KernelBackend",(function(){return d.Cb})),n.d(e,"DataStorage",(function(){return d.Q})),n.d(e,"abs",(function(){return d.td})),n.d(e,"acos",(function(){return d.ud})),n.d(e,"acosh",(function(){return d.vd})),n.d(e,"add",(function(){return d.wd})),n.d(e,"addN",(function(){return d.xd})),n.d(e,"all",(function(){return d.zd})),n.d(e,"any",(function(){return d.Ad})),n.d(e,"argMax",(function(){return d.Bd})),n.d(e,"argMin",(function(){return d.Cd})),n.d(e,"asin",(function(){return d.Dd})),n.d(e,"asinh",(function(){return d.Ed})),n.d(e,"atan",(function(){return d.Fd})),n.d(e,"atan2",(function(){return d.Gd})),n.d(e,"atanh",(function(){return d.Hd})),n.d(e,"avgPool",(function(){return d.Id})),n.d(e,"avgPool3d",(function(){return d.Jd})),n.d(e,"basicLSTMCell",(function(){return d.Md})),n.d(e,"batchToSpaceND",(function(){return d.Rd})),n.d(e,"batchNorm",(function(){return d.Nd})),n.d(e,"batchNorm2d",(function(){return d.Od})),n.d(e,"batchNorm3d",(function(){return d.Pd})),n.d(e,"batchNorm4d",(function(){return d.Qd})),n.d(e,"bincount",(function(){return d.Sd})),n.d(e,"broadcastTo",(function(){return d.Ud})),n.d(e,"buffer",(function(){return d.Wd})),n.d(e,"cast",(function(){return d.Xd})),n.d(e,"ceil",(function(){return d.Yd})),n.d(e,"clipByValue",(function(){return d.Zd})),n.d(e,"clone",(function(){return d.ae})),n.d(e,"complex",(function(){return d.be})),n.d(e,"concat",(function(){return d.ce})),n.d(e,"concat1d",(function(){return d.de})),n.d(e,"concat2d",(function(){return d.ee})),n.d(e,"concat3d",(function(){return d.fe})),n.d(e,"concat4d",(function(){return d.ge})),n.d(e,"conv1d",(function(){return d.he})),n.d(e,"conv2d",(function(){return d.ie})),n.d(e,"conv2dTranspose",(function(){return d.je})),n.d(e,"conv3d",(function(){return d.ke})),n.d(e,"conv3dTranspose",(function(){return d.le})),n.d(e,"cos",(function(){return d.ne})),n.d(e,"cosh",(function(){return d.oe})),n.d(e,"cumsum",(function(){return d.qe})),n.d(e,"denseBincount",(function(){return d.se})),n.d(e,"depthToSpace",(function(){return d.ue})),n.d(e,"depthwiseConv2d",(function(){return d.ve})),n.d(e,"diag",(function(){return d.xe})),n.d(e,"dilation2d",(function(){return d.ye})),n.d(e,"div",(function(){return d.Ce})),n.d(e,"divNoNan",(function(){return d.De})),n.d(e,"dot",(function(){return d.Fe})),n.d(e,"elu",(function(){return d.He})),n.d(e,"equal",(function(){return d.Ne})),n.d(e,"erf",(function(){return d.Pe})),n.d(e,"exp",(function(){return d.Qe})),n.d(e,"expandDims",(function(){return d.Re})),n.d(e,"expm1",(function(){return d.Se})),n.d(e,"eye",(function(){return d.Te})),n.d(e,"fill",(function(){return d.Ve})),n.d(e,"floor",(function(){return d.Ye})),n.d(e,"floorDiv",(function(){return d.Ze})),n.d(e,"gather",(function(){return d.bf})),n.d(e,"greater",(function(){return d.kf})),n.d(e,"greaterEqual",(function(){return d.lf})),n.d(e,"imag",(function(){return d.pf})),n.d(e,"isFinite",(function(){return d.uf})),n.d(e,"isInf",(function(){return d.vf})),n.d(e,"isNaN",(function(){return d.wf})),n.d(e,"leakyRelu",(function(){return d.zf})),n.d(e,"less",(function(){return d.Af})),n.d(e,"lessEqual",(function(){return d.Bf})),n.d(e,"linspace",(function(){return d.Ff})),n.d(e,"localResponseNormalization",(function(){return d.Gf})),n.d(e,"log",(function(){return d.Hf})),n.d(e,"log1p",(function(){return d.If})),n.d(e,"logSigmoid",(function(){return d.Jf})),n.d(e,"logSoftmax",(function(){return d.Kf})),n.d(e,"logSumExp",(function(){return d.Lf})),n.d(e,"logicalAnd",(function(){return d.Mf})),n.d(e,"logicalNot",(function(){return d.Nf})),n.d(e,"logicalOr",(function(){return d.Of})),n.d(e,"logicalXor",(function(){return d.Pf})),n.d(e,"matMul",(function(){return d.Rf})),n.d(e,"max",(function(){return d.Tf})),n.d(e,"maxPool",(function(){return d.Uf})),n.d(e,"maxPool3d",(function(){return d.Vf})),n.d(e,"maxPoolWithArgmax",(function(){return d.Wf})),n.d(e,"maximum",(function(){return d.Xf})),n.d(e,"mean",(function(){return d.Zf})),n.d(e,"min",(function(){return d.bg})),n.d(e,"minimum",(function(){return d.cg})),n.d(e,"mirrorPad",(function(){return d.eg})),n.d(e,"mod",(function(){return d.fg})),n.d(e,"moments",(function(){return d.hg})),n.d(e,"mul",(function(){return d.jg})),n.d(e,"multiRNNCell",(function(){return d.lg})),n.d(e,"multinomial",(function(){return d.mg})),n.d(e,"neg",(function(){return d.ng})),n.d(e,"notEqual",(function(){return d.qg})),n.d(e,"oneHot",(function(){return d.sg})),n.d(e,"ones",(function(){return d.tg})),n.d(e,"onesLike",(function(){return d.ug})),n.d(e,"outerProduct",(function(){return d.wg})),n.d(e,"pad",(function(){return d.xg})),n.d(e,"pad1d",(function(){return d.yg})),n.d(e,"pad2d",(function(){return d.zg})),n.d(e,"pad3d",(function(){return d.Ag})),n.d(e,"pad4d",(function(){return d.Bg})),n.d(e,"pool",(function(){return d.Cg})),n.d(e,"pow",(function(){return d.Dg})),n.d(e,"prelu",(function(){return d.Fg})),n.d(e,"print",(function(){return d.Gg})),n.d(e,"prod",(function(){return d.Hg})),n.d(e,"rand",(function(){return d.Jg})),n.d(e,"randomGamma",(function(){return d.Kg})),n.d(e,"randomNormal",(function(){return d.Lg})),n.d(e,"randomUniform",(function(){return d.Mg})),n.d(e,"range",(function(){return d.Ng})),n.d(e,"real",(function(){return d.Pg})),n.d(e,"reciprocal",(function(){return d.Qg})),n.d(e,"relu",(function(){return d.Ug})),n.d(e,"relu6",(function(){return d.Vg})),n.d(e,"reshape",(function(){return d.Xg})),n.d(e,"reverse",(function(){return d.Yg})),n.d(e,"reverse1d",(function(){return d.Zg})),n.d(e,"reverse2d",(function(){return d.ah})),n.d(e,"reverse3d",(function(){return d.bh})),n.d(e,"reverse4d",(function(){return d.ch})),n.d(e,"round",(function(){return d.eh})),n.d(e,"rsqrt",(function(){return d.fh})),n.d(e,"scalar",(function(){return d.gh})),n.d(e,"selu",(function(){return d.jh})),n.d(e,"separableConv2d",(function(){return d.kh})),n.d(e,"setdiff1dAsync",(function(){return d.oh})),n.d(e,"sigmoid",(function(){return d.ph})),n.d(e,"sign",(function(){return d.qh})),n.d(e,"sin",(function(){return d.sh})),n.d(e,"sinh",(function(){return d.th})),n.d(e,"slice",(function(){return d.uh})),n.d(e,"slice1d",(function(){return d.vh})),n.d(e,"slice2d",(function(){return d.wh})),n.d(e,"slice3d",(function(){return d.xh})),n.d(e,"slice4d",(function(){return d.yh})),n.d(e,"softmax",(function(){return d.Ah})),n.d(e,"softplus",(function(){return d.Bh})),n.d(e,"spaceToBatchND",(function(){return d.Ch})),n.d(e,"fft",(function(){return d.Ue})),n.d(e,"ifft",(function(){return d.of})),n.d(e,"irfft",(function(){return d.tf})),n.d(e,"rfft",(function(){return d.dh})),n.d(e,"split",(function(){return d.Fh})),n.d(e,"sqrt",(function(){return d.Gh})),n.d(e,"square",(function(){return d.Hh})),n.d(e,"squaredDifference",(function(){return d.Ih})),n.d(e,"squeeze",(function(){return d.Kh})),n.d(e,"stack",(function(){return d.Lh})),n.d(e,"step",(function(){return d.Mh})),n.d(e,"stridedSlice",(function(){return d.Nh})),n.d(e,"sub",(function(){return d.Oh})),n.d(e,"sum",(function(){return d.Qh})),n.d(e,"tan",(function(){return d.Sh})),n.d(e,"tanh",(function(){return d.Th})),n.d(e,"tensor",(function(){return d.Uh})),n.d(e,"tensor1d",(function(){return d.Vh})),n.d(e,"tensor2d",(function(){return d.Wh})),n.d(e,"tensor3d",(function(){return d.Xh})),n.d(e,"tensor4d",(function(){return d.Yh})),n.d(e,"tensor5d",(function(){return d.Zh})),n.d(e,"tensor6d",(function(){return d.ai})),n.d(e,"tile",(function(){return d.ei})),n.d(e,"topk",(function(){return d.gi})),n.d(e,"truncatedNormal",(function(){return d.ji})),n.d(e,"unique",(function(){return d.ki})),n.d(e,"unsortedSegmentSum",(function(){return d.ni})),n.d(e,"unstack",(function(){return d.oi})),n.d(e,"variable",(function(){return d.ti})),n.d(e,"where",(function(){return d.wi})),n.d(e,"whereAsync",(function(){return d.xi})),n.d(e,"zeros",(function(){return d.yi})),n.d(e,"zerosLike",(function(){return d.zi})),n.d(e,"op",(function(){return d.vg})),n.d(e,"OP_SCOPE_SUFFIX",(function(){return d.jc})),n.d(e,"image",(function(){return d.qf})),n.d(e,"linalg",(function(){return d.Ef})),n.d(e,"losses",(function(){return d.Qf})),n.d(e,"spectral",(function(){return d.Eh})),n.d(e,"fused",(function(){return d.af})),n.d(e,"signal",(function(){return d.rh})),n.d(e,"train",(function(){return d.hi})),n.d(e,"enableProdMode",(function(){return d.Je})),n.d(e,"enableDebugMode",(function(){return d.Ie})),n.d(e,"disableDeprecationWarnings",(function(){return d.ze})),n.d(e,"deprecationWarn",(function(){return d.te})),n.d(e,"disposeVariables",(function(){return d.Be})),n.d(e,"engine",(function(){return d.Le})),n.d(e,"memory",(function(){return d.ag})),n.d(e,"profile",(function(){return d.Ig})),n.d(e,"tidy",(function(){return d.di})),n.d(e,"dispose",(function(){return d.Ae})),n.d(e,"keep",(function(){return d.xf})),n.d(e,"time",(function(){return d.fi})),n.d(e,"setBackend",(function(){return d.mh})),n.d(e,"ready",(function(){return d.Og})),n.d(e,"getBackend",(function(){return d.ef})),n.d(e,"removeBackend",(function(){return d.Wg})),n.d(e,"findBackend",(function(){return d.We})),n.d(e,"findBackendFactory",(function(){return d.Xe})),n.d(e,"registerBackend",(function(){return d.Rg})),n.d(e,"backend",(function(){return d.Kd})),n.d(e,"setPlatform",(function(){return d.nh})),n.d(e,"getKernel",(function(){return d.gf})),n.d(e,"getGradient",(function(){return d.ff})),n.d(e,"getKernelsForBackend",(function(){return d.hf})),n.d(e,"registerKernel",(function(){return d.Tg})),n.d(e,"registerGradient",(function(){return d.Sg})),n.d(e,"unregisterKernel",(function(){return d.mi})),n.d(e,"unregisterGradient",(function(){return d.li})),n.d(e,"copyRegisteredKernels",(function(){return d.me})),n.d(e,"Abs",(function(){return d.a})),n.d(e,"Acos",(function(){return d.b})),n.d(e,"Acosh",(function(){return d.c})),n.d(e,"Add",(function(){return d.h})),n.d(e,"AddN",(function(){return d.i})),n.d(e,"All",(function(){return d.j})),n.d(e,"Any",(function(){return d.k})),n.d(e,"ArgMax",(function(){return d.l})),n.d(e,"ArgMin",(function(){return d.m})),n.d(e,"Asin",(function(){return d.n})),n.d(e,"Asinh",(function(){return d.o})),n.d(e,"Atan",(function(){return d.p})),n.d(e,"Atanh",(function(){return d.r})),n.d(e,"Atan2",(function(){return d.q})),n.d(e,"AvgPool",(function(){return d.s})),n.d(e,"AvgPoolGrad",(function(){return d.v})),n.d(e,"AvgPool3D",(function(){return d.t})),n.d(e,"AvgPool3DGrad",(function(){return d.u})),n.d(e,"BatchMatMul",(function(){return d.w})),n.d(e,"BatchToSpaceND",(function(){return d.x})),n.d(e,"Bincount",(function(){return d.y})),n.d(e,"BroadcastTo",(function(){return d.z})),n.d(e,"Cast",(function(){return d.A})),n.d(e,"Ceil",(function(){return d.B})),n.d(e,"ClipByValue",(function(){return d.C})),n.d(e,"Complex",(function(){return d.D})),n.d(e,"ComplexAbs",(function(){return d.E})),n.d(e,"Concat",(function(){return d.F})),n.d(e,"Conv2D",(function(){return d.G})),n.d(e,"Conv2DBackpropFilter",(function(){return d.H})),n.d(e,"Conv2DBackpropInput",(function(){return d.I})),n.d(e,"Conv3D",(function(){return d.J})),n.d(e,"Conv3DBackpropFilterV2",(function(){return d.K})),n.d(e,"Conv3DBackpropInputV2",(function(){return d.L})),n.d(e,"Cos",(function(){return d.M})),n.d(e,"Cosh",(function(){return d.N})),n.d(e,"Cumsum",(function(){return d.P})),n.d(e,"CropAndResize",(function(){return d.O})),n.d(e,"DenseBincount",(function(){return d.R})),n.d(e,"DepthToSpace",(function(){return d.S})),n.d(e,"DepthwiseConv2dNative",(function(){return d.T})),n.d(e,"DepthwiseConv2dNativeBackpropFilter",(function(){return d.U})),n.d(e,"DepthwiseConv2dNativeBackpropInput",(function(){return d.V})),n.d(e,"Diag",(function(){return d.W})),n.d(e,"Dilation2D",(function(){return d.X})),n.d(e,"Dilation2DBackpropInput",(function(){return d.Z})),n.d(e,"Dilation2DBackpropFilter",(function(){return d.Y})),n.d(e,"RealDiv",(function(){return d.xc})),n.d(e,"Elu",(function(){return d.bb})),n.d(e,"EluGrad",(function(){return d.cb})),n.d(e,"Erf",(function(){return d.fb})),n.d(e,"Equal",(function(){return d.eb})),n.d(e,"Exp",(function(){return d.gb})),n.d(e,"ExpandDims",(function(){return d.hb})),n.d(e,"Expm1",(function(){return d.ib})),n.d(e,"FFT",(function(){return d.jb})),n.d(e,"Fill",(function(){return d.kb})),n.d(e,"FlipLeftRight",(function(){return d.lb})),n.d(e,"Floor",(function(){return d.mb})),n.d(e,"FloorDiv",(function(){return d.nb})),n.d(e,"FusedBatchNorm",(function(){return d.pb})),n.d(e,"GatherV2",(function(){return d.tb})),n.d(e,"GatherNd",(function(){return d.sb})),n.d(e,"Greater",(function(){return d.ub})),n.d(e,"GreaterEqual",(function(){return d.vb})),n.d(e,"Identity",(function(){return d.xb})),n.d(e,"IFFT",(function(){return d.wb})),n.d(e,"Imag",(function(){return d.yb})),n.d(e,"IsFinite",(function(){return d.zb})),n.d(e,"IsInf",(function(){return d.Ab})),n.d(e,"IsNan",(function(){return d.Bb})),n.d(e,"LeakyRelu",(function(){return d.Fb})),n.d(e,"Less",(function(){return d.Gb})),n.d(e,"LessEqual",(function(){return d.Hb})),n.d(e,"LinSpace",(function(){return d.Ib})),n.d(e,"Log",(function(){return d.Jb})),n.d(e,"Log1p",(function(){return d.Kb})),n.d(e,"LogicalAnd",(function(){return d.Mb})),n.d(e,"LogicalNot",(function(){return d.Nb})),n.d(e,"LogicalOr",(function(){return d.Ob})),n.d(e,"LogSoftmax",(function(){return d.Lb})),n.d(e,"LRN",(function(){return d.Db})),n.d(e,"LRNGrad",(function(){return d.Eb})),n.d(e,"Max",(function(){return d.Pb})),n.d(e,"Maximum",(function(){return d.Vb})),n.d(e,"MaxPool",(function(){return d.Qb})),n.d(e,"MaxPoolGrad",(function(){return d.Tb})),n.d(e,"MaxPool3D",(function(){return d.Rb})),n.d(e,"MaxPool3DGrad",(function(){return d.Sb})),n.d(e,"MaxPoolWithArgmax",(function(){return d.Ub})),n.d(e,"Mean",(function(){return d.Wb})),n.d(e,"Min",(function(){return d.Xb})),n.d(e,"Minimum",(function(){return d.Yb})),n.d(e,"MirrorPad",(function(){return d.Zb})),n.d(e,"Mod",(function(){return d.ac})),n.d(e,"Multinomial",(function(){return d.cc})),n.d(e,"Multiply",(function(){return d.dc})),n.d(e,"Neg",(function(){return d.ec})),n.d(e,"NotEqual",(function(){return d.ic})),n.d(e,"NonMaxSuppressionV3",(function(){return d.fc})),n.d(e,"NonMaxSuppressionV4",(function(){return d.gc})),n.d(e,"NonMaxSuppressionV5",(function(){return d.hc})),n.d(e,"OnesLike",(function(){return d.lc})),n.d(e,"OneHot",(function(){return d.kc})),n.d(e,"Pack",(function(){return d.nc})),n.d(e,"PadV2",(function(){return d.oc})),n.d(e,"Pool",(function(){return d.pc})),n.d(e,"Pow",(function(){return d.qc})),n.d(e,"Prelu",(function(){return d.rc})),n.d(e,"Prod",(function(){return d.sc})),n.d(e,"Range",(function(){return d.uc})),n.d(e,"Real",(function(){return d.wc})),n.d(e,"Reciprocal",(function(){return d.yc})),n.d(e,"Relu",(function(){return d.Ac})),n.d(e,"Reshape",(function(){return d.Cc})),n.d(e,"ResizeNearestNeighbor",(function(){return d.Fc})),n.d(e,"ResizeNearestNeighborGrad",(function(){return d.Gc})),n.d(e,"ResizeBilinear",(function(){return d.Dc})),n.d(e,"ResizeBilinearGrad",(function(){return d.Ec})),n.d(e,"Relu6",(function(){return d.Bc})),n.d(e,"Reverse",(function(){return d.Hc})),n.d(e,"Round",(function(){return d.Jc})),n.d(e,"Rsqrt",(function(){return d.Kc})),n.d(e,"ScatterNd",(function(){return d.Mc})),n.d(e,"Select",(function(){return d.Nc})),n.d(e,"Selu",(function(){return d.Oc})),n.d(e,"Slice",(function(){return d.Tc})),n.d(e,"Sin",(function(){return d.Rc})),n.d(e,"Sinh",(function(){return d.Sc})),n.d(e,"Sign",(function(){return d.Qc})),n.d(e,"Sigmoid",(function(){return d.Pc})),n.d(e,"Softplus",(function(){return d.Vc})),n.d(e,"Sqrt",(function(){return d.Zc})),n.d(e,"Sum",(function(){return d.fd})),n.d(e,"SpaceToBatchND",(function(){return d.Wc})),n.d(e,"SplitV",(function(){return d.Yc})),n.d(e,"Softmax",(function(){return d.Uc})),n.d(e,"SquaredDifference",(function(){return d.bd})),n.d(e,"Square",(function(){return d.ad})),n.d(e,"Sub",(function(){return d.ed})),n.d(e,"SparseToDense",(function(){return d.Xc})),n.d(e,"StridedSlice",(function(){return d.dd})),n.d(e,"Tan",(function(){return d.gd})),n.d(e,"Tanh",(function(){return d.hd})),n.d(e,"Tile",(function(){return d.kd})),n.d(e,"TopK",(function(){return d.ld})),n.d(e,"Transpose",(function(){return d.md})),n.d(e,"Unique",(function(){return d.nd})),n.d(e,"Unpack",(function(){return d.od})),n.d(e,"UnsortedSegmentSum",(function(){return d.pd})),n.d(e,"ZerosLike",(function(){return d.rd})),n.d(e,"Step",(function(){return d.cd})),n.d(e,"FromPixels",(function(){return d.ob})),n.d(e,"RotateWithOffset",(function(){return d.Ic})),n.d(e,"_FusedMatMul",(function(){return d.sd})),n.d(e,"FusedConv2D",(function(){return d.qb})),n.d(e,"FusedDepthwiseConv2D",(function(){return d.rb})),n.d(e,"booleanMaskAsync",(function(){return d.Td})),n.d(e,"equalStrict",(function(){return d.Oe})),n.d(e,"greaterEqualStrict",(function(){return d.mf})),n.d(e,"greaterStrict",(function(){return d.nf})),n.d(e,"lessEqualStrict",(function(){return d.Cf})),n.d(e,"lessStrict",(function(){return d.Df})),n.d(e,"notEqualStrict",(function(){return d.rg})),n.d(e,"addStrict",(function(){return d.yd})),n.d(e,"divStrict",(function(){return d.Ee})),n.d(e,"maximumStrict",(function(){return d.Yf})),n.d(e,"minimumStrict",(function(){return d.dg})),n.d(e,"modStrict",(function(){return d.gg})),n.d(e,"mulStrict",(function(){return d.kg})),n.d(e,"powStrict",(function(){return d.Eg})),n.d(e,"squaredDifferenceStrict",(function(){return d.Jh})),n.d(e,"subStrict",(function(){return d.Ph})),n.d(e,"transpose",(function(){return d.ii})),n.d(e,"norm",(function(){return d.pg})),n.d(e,"movingAverage",(function(){return d.ig})),n.d(e,"scatterND",(function(){return d.hh})),n.d(e,"sparseToDense",(function(){return d.Dh})),n.d(e,"gatherND",(function(){return d.cf})),n.d(e,"dropout",(function(){return d.Ge})),n.d(e,"enclosingPowerOfTwo",(function(){return d.Ke})),n.d(e,"cosineWindow",(function(){return d.pe})),n.d(e,"inTopKAsync",(function(){return d.rf})),n.d(e,"CallbackList",(function(){return ze})),n.d(e,"CustomCallback",(function(){return qe})),n.d(e,"History",(function(){return Pe})),n.d(e,"Callback",(function(){return Ho})),n.d(e,"callbacks",(function(){return Jo})),n.d(e,"EarlyStopping",(function(){return Yo})),n.d(e,"InputSpec",(function(){return Ee})),n.d(e,"SymbolicTensor",(function(){return Se})),n.d(e,"LayersModel",(function(){return Zn})),n.d(e,"input",(function(){return or})),n.d(e,"loadLayersModel",(function(){return ar})),n.d(e,"model",(function(){return rr})),n.d(e,"registerCallbackConstructor",(function(){return sr})),n.d(e,"sequential",(function(){return ir})),n.d(e,"RNN",(function(){return ai})),n.d(e,"Sequential",(function(){return nr})),n.d(e,"LayerVariable",(function(){return _e})),n.d(e,"version_layers",(function(){return"2.8.2"})),n.d(e,"constraints",(function(){return r})),n.d(e,"initializers",(function(){return i})),n.d(e,"layers",(function(){return a})),n.d(e,"metrics",(function(){return o})),n.d(e,"models",(function(){return s})),n.d(e,"regularizers",(function(){return u})),n.d(e,"GraphModel",(function(){return Hc})),n.d(e,"loadGraphModel",(function(){return Xc})),n.d(e,"deregisterOp",(function(){return es.a})),n.d(e,"registerOp",(function(){return es.c})),n.d(e,"version_converter",(function(){return"2.8.2"})),n.d(e,"data",(function(){return c}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const x_={"tfjs-core":d.vi,"tfjs-backend-cpu":"2.8.2","tfjs-backend-webgl":"2.8.2","tfjs-data":_l,"tfjs-layers":"2.8.2","tfjs-converter":"2.8.2",tfjs:"2.8.2"}},function(t,e,n){const r=n(119);t.exports={re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:n(164).SEMVER_SPEC_VERSION,SemVer:n(51),compareIdentifiers:n(217).compareIdentifiers,rcompareIdentifiers:n(217).rcompareIdentifiers,parse:n(120),valid:n(374),clean:n(375),inc:n(376),diff:n(377),major:n(378),minor:n(379),patch:n(380),prerelease:n(381),compare:n(69),rcompare:n(382),compareLoose:n(383),compareBuild:n(219),sort:n(384),rsort:n(385),gt:n(167),lt:n(220),eq:n(218),neq:n(285),gte:n(221),lte:n(222),cmp:n(286),coerce:n(386),Comparator:n(168),Range:n(70),satisfies:n(169),toComparators:n(390),maxSatisfying:n(391),minSatisfying:n(392),minVersion:n(393),validRange:n(394),outside:n(223),gtr:n(395),ltr:n(396),intersects:n(397),simplifyRange:n(398),subset:n(399)}},function(t,e,n){"use strict";var r=n(145);e.a=function(t){let e=t,n=t;function i(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const a=r+i>>>1;n(t[a],e)<0?r=a+1:i=a}return r}return 1===t.length&&(e=(e,n)=>t(e)-n,n=function(t){return(e,n)=>Object(r.a)(t(e),n)}(t)),{left:i,center:function(t,n,r,a){null==r&&(r=0),null==a&&(a=t.length);const o=i(t,n,r,a-1);return o>r&&e(t[o-1],n)>-e(t[o],n)?o-1:o},right:function(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const a=r+i>>>1;n(t[a],e)>0?i=a:r=a+1}return r}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(t).slice(1,3);return{library:e[0],version:e[1]}}},function(t,e,n){"use strict";var r=function(t){return t},i=function(t){if(null==t)return r;var e,n,i=t.scale[0],a=t.scale[1],o=t.translate[0],s=t.translate[1];return function(t,r){r||(e=n=0);var u=2,c=t.length,l=new Array(c);for(l[0]=(e+=t[0])*i+o,l[1]=(n+=t[1])*a+s;u<c;)l[u]=t[u],++u;return l}},a=function(t,e){return"string"==typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return o(t,e)}))}:o(t,e)};function o(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,a=s(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:a}:null==r?{type:"Feature",id:n,properties:i,geometry:a}:{type:"Feature",id:n,bbox:r,properties:i,geometry:a}}function s(t,e){var n=i(t.transform),r=t.arcs;function a(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],a=0,o=i.length;a<o;++a)e.push(n(i[a],a));t<0&&function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}(e,o)}function o(t){return n(t)}function s(t){for(var e=[],n=0,r=t.length;n<r;++n)a(t[n],e);return e.length<2&&e.push(e[0]),e}function u(t){for(var e=s(t);e.length<4;)e.push(e[0]);return e}function c(t){return t.map(u)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=o(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(o);break;case"LineString":n=s(e.arcs);break;case"MultiLineString":n=e.arcs.map(s);break;case"Polygon":n=c(e.arcs);break;case"MultiPolygon":n=e.arcs.map(c);break;default:return null}return{type:r,coordinates:n}}(e)}var u=function(t,e){var n={},r={},i={},a=[],o=-1;function s(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){n[t<0?~t:t]=1})),a.push(i)}}return e.forEach((function(n,r){var i,a=t.arcs[n<0?~n:n];a.length<3&&!a[1][0]&&!a[1][1]&&(i=e[++o],e[o]=n,e[r]=i)})),e.forEach((function(e){var n,a,o=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1];return e<0?[n,i]:[i,n]}(e),s=o[0],u=o[1];if(n=i[s])if(delete i[n.end],n.push(e),n.end=u,a=r[u]){delete r[a.start];var c=a===n?n:n.concat(a);r[c.start=n.start]=i[c.end=a.end]=c}else r[n.start]=i[n.end]=n;else if(n=r[u])if(delete r[n.start],n.unshift(e),n.start=s,a=i[s]){delete i[a.end];var l=a===n?n:a.concat(n);r[l.start=a.start]=i[l.end=n.end]=l}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=s]=i[n.end=u]=n})),s(i,r),s(r,i),e.forEach((function(t){n[t<0?~t:t]||a.push([t])})),a},c=function(t){return s(t,l.apply(this,arguments))};function l(t,e,n){var r,i,a;if(arguments.length>1)r=d(t,e,n);else for(i=0,r=new Array(a=t.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:u(t,r)}}function d(t,e,n){var r,i=[],a=[];function o(t){var e=t<0?~t:t;(a[e]||(a[e]=[])).push({i:t,g:r})}function s(t){t.forEach(o)}function u(t){t.forEach(s)}return function t(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":u(e.arcs);break;case"MultiPolygon":!function(t){t.forEach(u)}(e.arcs)}}(e),a.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c}))},,,,function(t,e){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,i=t.indexOf("["),a=t.indexOf("]");-1!=i&&-1!=a&&(t=t.substring(0,i)+t.substring(i,a).replace(/:/g,";")+t.substring(a,t.length));for(var o=n.exec(t||""),s={},u=14;u--;)s[r[u]]=o[u]||"";return-1!=i&&-1!=a&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){(function(e){t.exports=function(t){return n&&e.isBuffer(t)||r&&(t instanceof ArrayBuffer||function(t){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer}(t))};var n="function"==typeof e&&"function"==typeof e.isBuffer,r="function"==typeof ArrayBuffer}).call(this,n(94).Buffer)},function(t,e,n){var r=n(339),i=n(244),a=n(149),o=n(214),s=n(245),u=n(246),c=n(160)("socket.io-client:manager"),l=n(243),d=n(356),f=Object.prototype.hasOwnProperty;function h(t,e){if(!(this instanceof h))return new h(t,e);t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=e.parser||o;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}t.exports=h,h.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},h.prototype.updateSocketIds=function(){for(var t in this.nsps)f.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},h.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},a(h.prototype),h.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},h.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},h.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},h.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},h.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},h.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},h.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},h.prototype.open=h.prototype.connect=function(t,e){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var a=s(n,"open",(function(){i.onopen(),t&&t()})),o=s(n,"error",(function(e){if(c("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",e),t){var n=new Error("Connection error");n.data=e,t(n)}else i.maybeReconnectOnOpen()}));if(!1!==this._timeout){var u=this._timeout;c("connect attempt will timeout after %d",u);var l=setTimeout((function(){c("connect attempt timed out after %d",u),a.destroy(),n.close(),n.emit("error","timeout"),i.emitAll("connect_timeout",u)}),u);this.subs.push({destroy:function(){clearTimeout(l)}})}return this.subs.push(a),this.subs.push(o),this},h.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(s(t,"data",u(this,"ondata"))),this.subs.push(s(t,"ping",u(this,"onping"))),this.subs.push(s(t,"pong",u(this,"onpong"))),this.subs.push(s(t,"error",u(this,"onerror"))),this.subs.push(s(t,"close",u(this,"onclose"))),this.subs.push(s(this.decoder,"decoded",u(this,"ondecoded")))},h.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},h.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},h.prototype.ondata=function(t){this.decoder.add(t)},h.prototype.ondecoded=function(t){this.emit("packet",t)},h.prototype.onerror=function(t){c("error",t),this.emitAll("error",t)},h.prototype.socket=function(t,e){var n=this.nsps[t];if(!n){n=new i(this,t,e),this.nsps[t]=n;var r=this;n.on("connecting",a),n.on("connect",(function(){n.id=r.generateId(t)})),this.autoConnect&&a()}function a(){~l(r.connecting,n)||r.connecting.push(n)}return n},h.prototype.destroy=function(t){var e=l(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},h.prototype.packet=function(t){c("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,(function(n){for(var r=0;r<n.length;r++)e.engine.write(n[r],t.options);e.encoding=!1,e.processPacketQueue()})))},h.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},h.prototype.cleanup=function(){c("cleanup");for(var t=this.subs.length,e=0;e<t;e++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},h.prototype.close=h.prototype.disconnect=function(){c("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},h.prototype.onclose=function(t){c("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},h.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();c("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var n=setTimeout((function(){t.skipReconnect||(c("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open((function(e){e?(c("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(c("reconnect success"),t.onreconnect())})))}),e);this.subs.push({destroy:function(){clearTimeout(n)}})}},h.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},function(t,e,n){var r=n(215),i=n(342),a=n(352),o=n(353);e.polling=function(t){var e=!1,n=!1,o=!1!==t.jsonp;if("undefined"!=typeof location){var s="https:"===location.protocol,u=location.port;u||(u=s?443:80),e=t.hostname!==location.hostname||u!==t.port,n=t.secure!==s}if(t.xdomain=e,t.xscheme=n,"open"in new r(t)&&!t.forceJSONP)return new i(t);if(!o)throw new Error("JSONP disabled");return new a(t)},e.websocket=o},function(t,e,n){var r=n(216),i=n(161),a=n(116),o=n(162),s=n(242),u=n(163)("engine.io-client:polling");t.exports=l;var c=null!=new(n(215))({xdomain:!1}).responseType;function l(t){var e=t&&t.forceBase64;c&&!e||(this.supportsBinary=!1),r.call(this,t)}o(l,r),l.prototype.name="polling",l.prototype.doOpen=function(){this.poll()},l.prototype.pause=function(t){var e=this;function n(){u("paused"),e.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(u("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){u("pre-pause polling complete"),--r||n()}))),this.writable||(u("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){u("pre-pause writing complete"),--r||n()})))}else n()},l.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},l.prototype.onData=function(t){var e=this;u("polling got data %s",t);a.decodePayload(t,this.socket.binaryType,(function(t,n,r){if("opening"===e.readyState&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},l.prototype.doClose=function(){var t=this;function e(){u("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(u("transport open - closing"),e()):(u("transport not open - deferring close"),this.once("open",e))},l.prototype.write=function(t){var e=this;this.writable=!1;var n=function(){e.writable=!0,e.emit("drain")};a.encodePayload(t,this.supportsBinary,(function(t){e.doWrite(t,n)}))},l.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(t[this.timestampParam]=s()),this.supportsBinary||t.sid||(t.b64=1),t=i.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(n=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+t}},function(t,e,n){(function(e){var r=n(344),i=Object.prototype.toString,a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),o="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);t.exports=function t(n){if(!n||"object"!=typeof n)return!1;if(r(n)){for(var i=0,s=n.length;i<s;i++)if(t(n[i]))return!0;return!1}if("function"==typeof e&&e.isBuffer&&e.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||a&&n instanceof Blob||o&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return t(n.toJSON(),!0);for(var u in n)if(Object.prototype.hasOwnProperty.call(n,u)&&t(n[u]))return!0;return!1}}).call(this,n(94).Buffer)},function(t,e,n){"use strict";var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a={},o=0,s=0;function u(t){var e="";do{e=i[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function c(){var t=u(+new Date);return t!==r?(o=0,r=t):t+"."+u(o++)}for(;s<64;s++)a[i[s]]=s;c.encode=u,c.decode=function(t){var e=0;for(s=0;s<t.length;s++)e=64*e+a[t.charAt(s)];return e},t.exports=c},function(t,e){var n=[].indexOf;t.exports=function(t,e){if(n)return t.indexOf(e);for(var r=0;r<t.length;++r)if(t[r]===e)return r;return-1}},function(t,e,n){var r=n(214),i=n(149),a=n(355),o=n(245),s=n(246),u=n(160)("socket.io-client:socket"),c=n(161),l=n(241);t.exports=h;var d={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=i.prototype.emit;function h(t,e,n){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}i(h.prototype),h.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[o(t,"open",s(this,"onopen")),o(t,"packet",s(this,"onpacket")),o(t,"close",s(this,"onclose"))]}},h.prototype.open=h.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},h.prototype.send=function(){var t=a(arguments);return t.unshift("message"),this.emit.apply(this,t),this},h.prototype.emit=function(t){if(d.hasOwnProperty(t))return f.apply(this,arguments),this;var e=a(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:l(e))?r.BINARY_EVENT:r.EVENT,data:e,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},h.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},h.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"==typeof this.query?c.encode(this.query):this.query;u("sending connect packet with query %s",t),this.packet({type:r.CONNECT,query:t})}else this.packet({type:r.CONNECT})},h.prototype.onclose=function(t){u("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},h.prototype.onpacket=function(t){var e=t.nsp===this.nsp,n=t.type===r.ERROR&&"/"===t.nsp;if(e||n)switch(t.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(t);break;case r.ACK:case r.BINARY_ACK:this.onack(t);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",t.data)}},h.prototype.onevent=function(t){var e=t.data||[];u("emitting event %j",e),null!=t.id&&(u("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?f.apply(this,e):this.receiveBuffer.push(e)},h.prototype.ack=function(t){var e=this,n=!1;return function(){if(!n){n=!0;var i=a(arguments);u("sending ack %j",i),e.packet({type:l(i)?r.BINARY_ACK:r.ACK,id:t,data:i})}}},h.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(u("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):u("bad ack %s",t.id)},h.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},h.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)f.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},h.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},h.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},h.prototype.close=h.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},h.prototype.compress=function(t){return this.flags.compress=t,this},h.prototype.binary=function(t){return this.flags.binary=t,this}},function(t,e){t.exports=function(t,e,n){return t.on(e,n),{destroy:function(){t.removeListener(e,n)}}}},function(t,e){var n=[].slice;t.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return e.apply(t,r.concat(n.call(arguments)))}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({acos_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","acos")};return r.a.runKernel(i.b,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({acosh_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","acosh")};return r.a.runKernel(i.c,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({addN_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){o.b(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),o.b(t.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got "+t.length);const e=t.map((t,e)=>Object(a.a)(t,"tensors"+e,"addN")),n=e[0];e.forEach(t=>{if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(t=>{if(!o.a(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return r.a.runKernel(i.e,s)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({asin_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","asin")};return r.a.runKernel(i.j,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({asinh_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","asinh")};return r.a.runKernel(i.k,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({atan_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","atan")};return r.a.runKernel(i.l,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({atanh_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","atanh")};return r.a.runKernel(i.n,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(5),i=n(19),a=n(3),o=n(1),s=n(7),u=n(11),c=n(27),l=n(4),d=n(8);const f=Object(l.b)({avgPool3d_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,l,f,h="NDHWC",p){null==p?p=[1,1,1]:Object(i.b)("dilations is deprecated, this field will be gone in v3.0.0.");const m=Object(o.a)(t,"x","avgPool3d","float32");let g=m,b=!1;4===m.rank&&(b=!0,g=Object(d.a)(m,[1,m.shape[0],m.shape[1],m.shape[2],m.shape[3]])),s.b(5===g.rank,()=>`Error in avgPool3d: x must be rank 5 but got rank ${g.rank}.`),s.b("NDHWC"===h,()=>"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+h),s.b(c.h(n,p),()=>`Error in avgPool3d: Either strides or dilations must be 1. Got strides ${n} and dilations '${p}'`),null!=f&&s.b(s.v(l),()=>`Error in avgPool3d: pad must be an integer when using, dimRoundingMode ${f} but got pad ${l}.`);const y={x:g},v={filterSize:e,strides:n,pad:l,dimRoundingMode:f,dataFormat:h,dilations:p};let x=r.a.runKernel(a.p,y,v);return x=Object(u.a)(x,g.dtype),b?Object(d.a)(x,[x.shape[1],x.shape[2],x.shape[3],x.shape[4]]):x}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({bincount_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n){const s=Object(a.a)(t,"x","bincount"),u=Object(a.a)(e,"weights","bincount");o.b("int32"===s.dtype,()=>"Error in bincount: input dtype must be int32, but got "+s.dtype),o.b(n>=0,()=>`size must be non-negative, but got ${n}.`),o.b(u.size===s.size||0===u.size,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: `+u.shape+".");const c={x:s,weights:u},l={size:n};return r.a.runKernel(i.u,c,l)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({ceil_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","ceil")};return r.a.runKernel(i.x,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({clipByValue_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n){const s=Object(a.a)(t,"x","clipByValue");o.b(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`);const u={x:s},c={clipValueMin:e,clipValueMax:n};return r.a.runKernel(i.y,u,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(27),u=n(4),c=n(8);const l=Object(u.b)({conv3d_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,u,l="NDHWC",d=[1,1,1]){const f=Object(a.a)(t,"x","conv3d"),h=Object(a.a)(e,"filter","conv3d");let p=f,m=!1;4===f.rank&&(m=!0,p=Object(c.a)(f,[1,f.shape[0],f.shape[1],f.shape[2],f.shape[3]])),o.b(5===p.rank,()=>`Error in conv3d: input must be rank 5, but got rank ${p.rank}.`),o.b(5===h.rank,()=>"Error in conv3d: filter must be rank 5, but got rank "+h.rank+"."),o.b(p.shape[4]===h.shape[3],()=>`Error in conv3d: depth of input (${p.shape[4]}) must match input depth for filter ${h.shape[3]}.`),o.b(Object(s.h)(n,d),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${d}'`),o.b("NDHWC"===l,()=>`Error in conv3d: got dataFormat of ${l} but only NDHWC is currently supported.`);const g={x:p,filter:h},b={strides:n,pad:u,dataFormat:l,dilations:d},y=r.a.runKernel(i.F,g,b);return m?Object(c.a)(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(4);const u=Object(s.b)({denseBincount_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,s=!1){const u=Object(a.a)(t,"x","denseBincount"),c=Object(a.a)(e,"weights","denseBincount");o.b("int32"===u.dtype,()=>"Error in denseBincount: input dtype must be int32, but got "+u.dtype),o.b(u.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${u.rank}.`),o.b(n>=0,()=>`size must be non-negative, but got ${n}.`),o.b(c.size===u.size||0===c.size,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${u.shape}, weights shape: `+c.shape+".");const l={x:u,weights:c},d={size:n,binaryOutput:s};return r.a.runKernel(i.M,l,d)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=n(3),a=n(1),o=n(7),s=n(11),u=n(4);const c=Object(u.b)({erf_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){let e=Object(a.a)(t,"x","erf");o.b("int32"===e.dtype||"float32"===e.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===e.dtype&&(e=Object(s.a)(e,"float32"));const n={x:e};return r.a.runKernel(i.Y,n)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({expm1_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","expm1")};return r.a.runKernel(i.bb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({isFinite_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","isFinite")};return r.a.runKernel(i.sb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({isInf_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","isInf")};return r.a.runKernel(i.tb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({isNaN_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","isNaN")};return r.a.runKernel(i.ub,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(5),i=n(3);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function a(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const a={start:t,stop:e,num:n};return r.a.runKernel(i.Ab,{},a)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(34),i=n(1),a=n(9),o=n(28),s=n(4),u=n(85),c=n(189);const l=Object(s.b)({logSigmoid_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e=Object(i.a)(t,"x","logSigmoid");return Object(r.a)(t=>({value:Object(o.a)(Object(c.a)(Object(o.a)(t))),gradFunc:e=>Object(a.a)(e,Object(u.a)(Object(o.a)(t)))}))(e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(34),i=n(1),a=n(11),o=n(40),s=n(72),u=n(66),c=n(9),l=n(4),d=n(13),f=n(18);const h=Object(l.b)({logSoftmax_:
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=-1){const n=Object(i.a)(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Object(r.a)((t,n)=>{const r=Object(u.a)(t,e,!0),i=Object(d.a)(t,r),l=Object(d.a)(Object(a.a)(i,"float32"),Object(s.a)(Object(f.a)(Object(o.a)(i),e,!0)));n([l]);return{value:l,gradFunc:(t,n)=>{const[r]=n,i=Object(o.a)(r);return Object(d.a)(t,Object(c.a)(Object(f.a)(t,e,!0),i))}}})(n)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(5),i=n(19),a=n(3),o=n(1),s=n(7),u=n(27),c=n(4),l=n(8);const d=Object(c.b)({maxPool3d_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=[1,1,1],n,c,d,f="NDHWC",h){null==h?h=[1,1,1]:Object(i.b)("dilations is deprecated, this field will be gone in v3.0.0.");const p=Object(o.a)(t,"x","maxPool3d");let m=p,g=!1;4===p.rank&&(g=!0,m=Object(l.a)(p,[1,p.shape[0],p.shape[1],p.shape[2],p.shape[3]])),s.b(5===m.rank,()=>`Error in maxPool3d: x must be rank 5 but got rank ${m.rank}.`),s.b("NDHWC"===f,()=>"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+f),s.b(u.h(n,h),()=>`Error in maxPool3d: Either strides or dilations must be 1. Got strides ${n} and dilations '${h}'`),null!=d&&s.b(s.v(c),()=>`Error in maxPool3d: pad must be an integer when using, dimRoundingMode ${d} but got pad ${c}.`);const b={x:m},y={filterSize:e,strides:n,pad:c,dimRoundingMode:d,dataFormat:f,dilations:h},v=r.a.runKernel(a.Jb,b,y);return g?Object(l.a)(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({maxPoolWithArgmax_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,o,s=!1){const u={x:Object(a.a)(t,"x","maxPoolWithArgmax")},c={filterSize:e,strides:n,pad:o,includeBatchInIndex:s},l=r.a.runKernel(i.Mb,u,c);return{result:l[0],indexes:l[1]}}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(4),s=n(8);const u=Object(o.b)({multinomial_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,o=!1){const u=Object(a.a)(t,"logits","multinomial"),c=u.size,l=u.rank;if(c<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+c+".");if(l>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+l);n=n||Math.random();const d={logits:1===l?Object(s.a)(u,[1,-1]):u},f={numSamples:e,seed:n,normalized:o},h=r.a.runKernel(i.Tb,d,f);return 1===l?Object(s.a)(h,[h.size]):h}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({onesLike_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","onesLike")};return r.a.runKernel(i.bc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({reciprocal_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","reciprocal")};return r.a.runKernel(i.lc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({round_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","round")};return r.a.runKernel(i.vc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(6),i=n(1),a=n(7);const o=
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
async function(t,e){const n=Object(i.a)(t,"x","setdiff1d"),o=Object(i.a)(e,"y","setdiff1d");a.b(n.dtype===o.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${o.dtype}).`),a.b(1===n.rank,()=>`x should be 1D tensor, but got x (${n.shape}).`),a.b(1===o.rank,()=>`y should be 1D tensor, but got y (${o.shape}).`);const s=await n.data(),u=await o.data(),c=new Set(u);let l=0;for(let t=0;t<s.length;t++)c.has(s[t])||l++;const d=new r.b([l],n.dtype),f=new r.b([l],"int32");for(let t=0,e=0;t<s.length;t++)c.has(s[t])||(d.values[e]=s[t],f.values[e]=t,e++);return[d.toTensor(),f.toTensor()]}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({sign_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","sign")};return r.a.runKernel(i.Bc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({softmax_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=-1){const n=Object(a.a)(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const o={logits:n},s={dim:e};return r.a.runKernel(i.Fc,o,s)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({stridedSlice_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,o,s=0,u=0,c=0,l=0,d=0){const f={x:Object(a.a)(t,"x","stridedSlice")},h={begin:e,end:n,strides:o,beginMask:s,endMask:u,ellipsisMask:c,newAxisMask:l,shrinkAxisMask:d};return r.a.runKernel(i.Oc,f,h)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({tan_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t){const e={x:Object(a.a)(t,"x","tan")};return r.a.runKernel(i.Rc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(46),i=n(4),a=n(107);const o=Object(i.b)({truncatedNormal_:
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e=0,n=1,i,o){if(null!=i&&"bool"===i)throw new Error("Unsupported data type $ { dtype }");const s=new a.a(e,n,i,!0,o),u=Object(r.a)(t,i);for(let t=0;t<u.values.length;t++)u.values[t]=s.nextValue();return u.toTensor()}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return m})),n.d(e,"d",(function(){return g})),n.d(e,"e",(function(){return b})),n.d(e,"f",(function(){return y}));var r=n(19),i=n(1),a=n(7),o=n(79),s=n(45),u=n(53),c=n(99),l=n(54),d=n(102),f=n(4);const h=Object(f.b)({equalStrict_:function(t,e){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");const n=Object(i.a)(t,"a","equalStrict"),s=Object(i.a)(e,"b","equalStrict");return Object(a.e)(n.shape,s.shape,"Error in equalStrict: "),Object(o.a)(n,s)}}),p=Object(f.b)({greaterEqualStrict_:function(t,e){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");const n=Object(i.a)(t,"a","greaterEqualStrict"),o=Object(i.a)(e,"b","greaterEqualStrict");return Object(a.e)(n.shape,o.shape,"Error in greaterEqualStrict: "),Object(u.a)(n,o)}}),m=Object(f.b)({greaterStrict_:function(t,e){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");const n=Object(i.a)(t,"a","greaterStrict"),o=Object(i.a)(e,"b","greaterStrict");return Object(a.e)(n.shape,o.shape,"Error in greaterStrict: "),Object(s.a)(n,o)}}),g=Object(f.b)({lessEqualStrict_:function(t,e){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");const n=Object(i.a)(t,"a","lessEqualStrict"),o=Object(i.a)(e,"b","lessEqualStrict");return Object(a.e)(n.shape,o.shape,"Error in lessEqualStrict: "),Object(l.a)(n,o)}}),b=Object(f.b)({lessStrict_:function(t,e){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");const n=Object(i.a)(t,"a","lessStrict"),o=Object(i.a)(e,"b","lessStrict");return Object(a.e)(n.shape,o.shape,"Error in lessStrict: "),Object(c.a)(n,o)}}),y=Object(f.b)({notEqualStrict_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");const n=Object(i.a)(t,"a","notEqualStrict"),o=Object(i.a)(e,"b","notEqualStrict");return Object(a.e)(n.shape,o.shape,"Error in notEqualStrict: "),Object(d.a)(n,o)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return g})),n.d(e,"b",(function(){return b})),n.d(e,"c",(function(){return y})),n.d(e,"d",(function(){return v})),n.d(e,"e",(function(){return x})),n.d(e,"f",(function(){return w})),n.d(e,"g",(function(){return k})),n.d(e,"h",(function(){return O})),n.d(e,"i",(function(){return _}));var r=n(19),i=n(1),a=n(7),o=n(12),s=n(14),u=n(77),c=n(101),l=n(135),d=n(9),f=n(4),h=n(47),p=n(104),m=n(13);const g=Object(f.b)({addStrict_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");const n=Object(i.a)(t,"a","addStrict"),s=Object(i.a)(e,"b","addStrict");return a.e(n.shape,s.shape,"Error in addStrict: "),Object(o.a)(n,s)}}),b=Object(f.b)({divStrict_:function(t,e){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");const n=Object(i.a)(t,"a","div"),o=Object(i.a)(e,"b","div");return a.e(n.shape,o.shape,"Error in divideStrict: "),Object(s.a)(n,o)}}),y=Object(f.b)({maximumStrict_:function(t,e){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");const n=Object(i.a)(t,"a","maximumStrict"),o=Object(i.a)(e,"b","maximumStrict");return a.e(n.shape,o.shape,"Error in maximumStrict: "),Object(u.a)(n,o)}}),v=Object(f.b)({minimumStrict_:function(t,e){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");const n=Object(i.a)(t,"a","minimumStrict"),o=Object(i.a)(e,"b","minimumStrict");return a.e(n.shape,o.shape,"Error in minimumStrict: "),Object(c.a)(n,o)}}),x=Object(f.b)({modStrict_:function(t,e){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");const n=Object(i.a)(t,"a","modStrict"),o=Object(i.a)(e,"b","modStrict");return a.e(n.shape,o.shape,"Error in modStrict: "),Object(l.a)(n,o)}}),w=Object(f.b)({mulStrict_:function(t,e){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");const n=Object(i.a)(t,"a","mul"),o=Object(i.a)(e,"b","mul");return a.e(n.shape,o.shape,"Error in multiplyStrict: "),Object(d.a)(n,o)}}),k=Object(f.b)({powStrict_:function(t,e){return Object(r.b)("strict variants of ops have been deprecated and will be removed in future"),a.e(t.shape,e.shape,"Error in powStrict: "),Object(h.a)(t,e)}}),O=Object(f.b)({squaredDifferenceStrict_:function(t,e){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");const n=Object(i.a)(t,"a","squaredDifferenceStrict"),o=Object(i.a)(e,"b","squaredDifferenceStrict");return a.e(n.shape,o.shape,"Error in squaredDifferenceStrict: "),Object(p.a)(n,o)}}),_=Object(f.b)({subStrict_:function(t,e){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");const n=Object(i.a)(t,"a","subStrict"),o=Object(i.a)(e,"b","subStrict");return a.e(n.shape,o.shape,"Error in subStrict: "),Object(m.a)(n,o)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(5),i=n(3),a=n(1),o=n(4),s=n(122);const u=Object(o.b)({scatterND_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n){const o=Object(a.a)(t,"indices","scatterND","int32"),u=Object(a.a)(e,"updates","scatterND");s.validateInput(u,o,n);const c={indices:o,updates:u},l={shape:n};return r.a.runKernel(i.xc,c,l)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(5),i=n(3),a=n(1),o=n(4);const s=Object(o.b)({gatherND_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e){const n=Object(a.a)(e,"indices","gatherND","int32"),o={params:Object(a.a)(t,"x","gatherND"),indices:n};return r.a.runKernel(i.lb,o)}})},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return i}));
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:void 0!==t?t:t=>t();function i(){return new Promise(t=>r(()=>t()))}}).call(this,n(368).setImmediate)},function(t,e,n){const r=n(69);t.exports=(t,e,n)=>0!==r(t,e,n)},function(t,e,n){const r=n(218),i=n(285),a=n(167),o=n(221),s=n(220),u=n(222);t.exports=(t,e,n,c)=>{switch(e){case"===":return"object"==typeof t&&(t=t.version),"object"==typeof n&&(n=n.version),t===n;case"!==":return"object"==typeof t&&(t=t.version),"object"==typeof n&&(n=n.version),t!==n;case"":case"=":case"==":return r(t,n,c);case"!=":return i(t,n,c);case">":return a(t,n,c);case">=":return o(t,n,c);case"<":return s(t,n,c);case"<=":return u(t,n,c);default:throw new TypeError("Invalid operator: "+e)}}},function(t){t.exports={a:"5.13.0"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.processStyleName=void 0,e.createMarkupForStyles=function(t,e){var n="";for(var i in t){var a=0===i.indexOf("--");if(t.hasOwnProperty(i)&&"label"!==i){var o=t[i];0,null!=o&&(a?n+=i+":"+o+";":(n+=s(i)+":",n+=(0,r.default)(i,o,e)+";"))}}return n||null};o(n(401));var r=o(n(403)),i=o(n(406)),a=o(n(408));o(n(289));function o(t){return t&&t.__esModule?t:{default:t}}var s=e.processStyleName=(0,a.default)(i.default)},function(t,e,n){"use strict";var r=n(405);t.exports=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isSurfaceInfo=function(t){return null!=t.name},e.isSurface=function(t){return t.drawArea instanceof HTMLElement}},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});const r=n(428);let i;e.visor=function(){if("undefined"==typeof document)throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById("tfjs-visor-container")&&null!=i)return i;let t,e=document.getElementById("tfjs-visor-container");function n(e,n){let i=null;return t=r.VisorComponent.render(e,t,{ref:t=>i=t,surfaceList:Array.from(n.values())}),i}null==e&&(e=document.createElement("div"),e.id="tfjs-visor-container",document.body.appendChild(e));const o=new Map,s=n(e,o);return i=new a(s,e,o,n),i};class a{constructor(t,e,n,r){this.visorComponent=t,this.el=e,this.surfaceList=n,this.renderVisor=r}surface(t){const{name:e}=t,n=null==t.tab?"Visor":t.tab;if(null==e||!("string"==typeof e||e instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");const r=Object.assign({},t,{tab:n}),i=`${e}-${n}`;return this.surfaceList.has(i)||this.surfaceList.set(i,r),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(e,n)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(t){if(!this.visorComponent.state.tabs.has(t))throw new Error(`Tab '${t}' does not exist`);this.visorComponent.setState({activeTab:t})}}e.Visor=a},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(n(121)),o=n(95),s=n(170),u=n(71);e.linechart=function(t,e,n={}){return r(this,void 0,void 0,(function*(){const r=Array.isArray(e.values[0])?e.values:[e.values],i=r[0].length,l=e.series?e.series:r.map((t,e)=>"Series "+(e+1));s.assert(l.length===r.length,"Must have an equal number of series labels as there are data series"),null!=n.seriesColors&&s.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const d=[];for(let t=0;t<i;t++){const e={x:t};l.forEach((n,i)=>{const a=r[i][t].y;e[n]=a,e[n+"-name"]=n}),d.push(e)}const f=Object.assign({},c,n),h={x:{field:"x",type:f.xType,title:f.xLabel},tooltip:[{field:"x",type:"quantitative"},...l.map(t=>({field:t,type:"quantitative"}))]},p=l.map(t=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:t,type:f.yType,title:f.yLabel,scale:f.zoomToFit?{zero:!1}:null!=f.yAxisDomain?{domain:f.yAxisDomain}:void 0},color:{field:t+"-name",type:"nominal",legend:{values:l,title:null},scale:{range:f.seriesColors}}}})),m=u.getDrawArea(t),g={width:f.width||o.getDefaultWidth(m),height:f.height||o.getDefaultHeight(m),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:f.fontSize,titleFontSize:f.fontSize},text:{fontSize:f.fontSize},legend:{labelFontSize:f.fontSize,titleFontSize:f.fontSize}},data:{values:d},encoding:h,layer:[...p,{mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}}]};return yield a.default(m,g,{actions:!1,mode:"vega-lite",defaultStyle:!1}),Promise.resolve()}))};const c={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},function(t,e,n){"use strict";var r=n(5),i=n(3);var a=n(1),o=n(4);n.d(e,"a",(function(){return s}));const s=Object(o.b)({sparseToDense_:
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function(t,e,n,o=0){const s=Object(a.a)(t,"sparseIndices","sparseToDense","int32"),u=Object(a.a)(e,"sparseValues","sparseToDense"),c=Object(a.a)(o,"defaultValue","sparseToDense",u.dtype);!function(t,e,n,r){if("int32"!==t.dtype)throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const i=t.rank>0?t.shape[0]:1,a=t.rank>1?t.shape[1]:1;if(n.length!==a)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${a}.`);const o=e.size;if(0!==e.rank&&(1!==e.rank||o!==i))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${i}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(s,u,n,c);const l={sparseIndices:s,sparseValues:u,defaultValue:c},d={outputShape:n};return r.a.runKernel(i.Ic,l,d)}})},function(t,e,n){var r=n(328),i=n(214),a=n(238),o=n(160)("socket.io-client");t.exports=e=u;var s=e.managers={};function u(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,i=r(t),u=i.source,c=i.id,l=i.path,d=s[c]&&l in s[c].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||d?(o("ignoring socket cache for %s",u),n=a(u,e)):(s[c]||(o("new io instance for %s",u),s[c]=a(u,e)),n=s[c]),i.query&&!e.query&&(e.query=i.query),n.socket(i.path,e)}e.protocol=i.protocol,e.connect=u,e.Manager=n(238),e.Socket=n(244)},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));const r=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));const r=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}]},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return o}));var r=n(0),i=n(44),a=n(314);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
class o extends i.a{decodeUTF8(){return new s(this)}}class s extends a.a{constructor(t){super(),this.upstream=t,this.impl=new u(t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class u extends i.b{constructor(t){if(super(),this.upstream=t,Object(r.Me)().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:t}=n(370);this.decoder=new t("utf8")}}summary(){return this.upstream.summary()+" -> Utf8"}async pump(){const e=await this.upstream.next();let n,i;return!e.done&&(n=e.value,i=Object(r.Me)().get("IS_BROWSER")?this.decoder.decode(n,{stream:!0}):this.decoder.write(t.from(n.buffer)),this.outputQueue.push(i),!0)}}}).call(this,n(94).Buffer)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(44);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class i extends r.a{split(t){return new a(this,t)}}class a extends i{constructor(t,e){super(),this.upstream=t,this.impl=new o(t,e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class o extends r.b{constructor(t,e){super(),this.upstream=t,this.separator=e,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){const t=await this.upstream.next();if(t.done)return""!==this.carryover&&(this.outputQueue.push(this.carryover),this.carryover="",!0);const e=t.value.split(this.separator);e[0]=this.carryover+e[0];for(const t of e.slice(0,-1))this.outputQueue.push(t);return this.carryover=e[e.length-1],!0}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(91),i=n(321),a=n(90),o=n(320),s=n(158),u=n(159);function c(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function l(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function d(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function f(t){var e=t.dateTime,n=t.date,s=t.time,u=t.periods,f=t.days,p=t.shortDays,m=t.months,g=t.shortMonths,b=v(u),y=x(u),Z=v(f),yt=x(f),Nt=v(p),Tt=x(p),Ft=v(m),Dt=x(m),It=v(g),Mt=x(g),$t={a:function(t){return p[t.getDay()]},A:function(t){return f[t.getDay()]},b:function(t){return g[t.getMonth()]},B:function(t){return m[t.getMonth()]},c:null,d:P,e:P,f:G,g:rt,G:at,H:q,I:W,j:U,L:V,m:H,M:X,p:function(t){return u[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:St,s:jt,S:K,u:Y,U:J,V:Q,w:tt,W:et,x:null,X:null,y:nt,Y:it,Z:ot,"%":Et},Rt={a:function(t){return p[t.getUTCDay()]},A:function(t){return f[t.getUTCDay()]},b:function(t){return g[t.getUTCMonth()]},B:function(t){return m[t.getUTCMonth()]},c:null,d:st,e:st,f:ft,g:Ot,G:At,H:ut,I:ct,j:lt,L:dt,m:ht,M:pt,p:function(t){return u[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:St,s:jt,S:mt,u:gt,U:bt,V:vt,w:xt,W:wt,x:null,X:null,y:kt,Y:_t,Z:Ct,"%":Et},Bt={a:function(t,e,n){var r=Nt.exec(e.slice(n));return r?(t.w=Tt.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=Z.exec(e.slice(n));return r?(t.w=yt.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=It.exec(e.slice(n));return r?(t.m=Mt.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=Ft.exec(e.slice(n));return r?(t.m=Dt.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return Pt(t,e,n,r)},d:T,e:T,f:R,g:E,G:C,H:D,I:D,j:F,L:$,m:N,M:I,p:function(t,e,n){var r=b.exec(e.slice(n));return r?(t.p=y.get(r[0].toLowerCase()),n+r[0].length):-1},q:j,Q:z,s:L,S:M,u:k,U:O,V:_,w:w,W:A,x:function(t,e,r){return Pt(t,n,e,r)},X:function(t,e,n){return Pt(t,s,e,n)},y:E,Y:C,Z:S,"%":B};function zt(t,e){return function(n){var r,i,a,o=[],s=-1,u=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===t.charCodeAt(s)&&(o.push(t.slice(u,s)),null!=(i=h[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),u=s+1);return o.push(t.slice(u,s)),o.join("")}}function Lt(t,e){return function(n){var s,u,f=d(1900,void 0,1);if(Pt(f,t,n+="",0)!=n.length)return null;if("Q"in f)return new Date(f.Q);if("s"in f)return new Date(1e3*f.s+("L"in f?f.L:0));if(e&&!("Z"in f)&&(f.Z=0),"p"in f&&(f.H=f.H%12+12*f.p),void 0===f.m&&(f.m="q"in f?f.q:0),"V"in f){if(f.V<1||f.V>53)return null;"w"in f||(f.w=1),"Z"in f?(u=(s=l(d(f.y,0,1))).getUTCDay(),s=u>4||0===u?r.a.ceil(s):Object(r.a)(s),s=i.a.offset(s,7*(f.V-1)),f.y=s.getUTCFullYear(),f.m=s.getUTCMonth(),f.d=s.getUTCDate()+(f.w+6)%7):(u=(s=c(d(f.y,0,1))).getDay(),s=u>4||0===u?a.a.ceil(s):Object(a.a)(s),s=o.a.offset(s,7*(f.V-1)),f.y=s.getFullYear(),f.m=s.getMonth(),f.d=s.getDate()+(f.w+6)%7)}else("W"in f||"U"in f)&&("w"in f||(f.w="u"in f?f.u%7:"W"in f?1:0),u="Z"in f?l(d(f.y,0,1)).getUTCDay():c(d(f.y,0,1)).getDay(),f.m=0,f.d="W"in f?(f.w+6)%7+7*f.W-(u+5)%7:f.w+7*f.U-(u+6)%7);return"Z"in f?(f.H+=f.Z/100|0,f.M+=f.Z%100,l(f)):c(f)}}function Pt(t,e,n,r){for(var i,a,o=0,s=e.length,u=n.length;o<s;){if(r>=u)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=Bt[i in h?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return $t.x=zt(n,$t),$t.X=zt(s,$t),$t.c=zt(e,$t),Rt.x=zt(n,Rt),Rt.X=zt(s,Rt),Rt.c=zt(e,Rt),{format:function(t){var e=zt(t+="",$t);return e.toString=function(){return t},e},parse:function(t){var e=Lt(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=zt(t+="",Rt);return e.toString=function(){return t},e},utcParse:function(t){var e=Lt(t+="",!0);return e.toString=function(){return t},e}}}var h={"-":"",_:" ",0:"0"},p=/^\s*\d+/,m=/^%/,g=/[\\^$*+?|[\]().{}]/g;function b(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function y(t){return t.replace(g,"\\$&")}function v(t){return new RegExp("^(?:"+t.map(y).join("|")+")","i")}function x(t){return new Map(t.map((t,e)=>[t.toLowerCase(),e]))}function w(t,e,n){var r=p.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function k(t,e,n){var r=p.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function O(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function _(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function A(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function C(t,e,n){var r=p.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function E(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function S(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function j(t,e,n){var r=p.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function N(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function T(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function F(t,e,n){var r=p.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function D(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function I(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function M(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function $(t,e,n){var r=p.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function R(t,e,n){var r=p.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function B(t,e,n){var r=m.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function z(t,e,n){var r=p.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function L(t,e,n){var r=p.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function P(t,e){return b(t.getDate(),e,2)}function q(t,e){return b(t.getHours(),e,2)}function W(t,e){return b(t.getHours()%12||12,e,2)}function U(t,e){return b(1+o.a.count(Object(s.a)(t),t),e,3)}function V(t,e){return b(t.getMilliseconds(),e,3)}function G(t,e){return V(t,e)+"000"}function H(t,e){return b(t.getMonth()+1,e,2)}function X(t,e){return b(t.getMinutes(),e,2)}function K(t,e){return b(t.getSeconds(),e,2)}function Y(t){var e=t.getDay();return 0===e?7:e}function J(t,e){return b(a.b.count(Object(s.a)(t)-1,t),e,2)}function Z(t){var e=t.getDay();return e>=4||0===e?Object(a.c)(t):a.c.ceil(t)}function Q(t,e){return t=Z(t),b(a.c.count(Object(s.a)(t),t)+(4===Object(s.a)(t).getDay()),e,2)}function tt(t){return t.getDay()}function et(t,e){return b(a.a.count(Object(s.a)(t)-1,t),e,2)}function nt(t,e){return b(t.getFullYear()%100,e,2)}function rt(t,e){return b((t=Z(t)).getFullYear()%100,e,2)}function it(t,e){return b(t.getFullYear()%1e4,e,4)}function at(t,e){var n=t.getDay();return b((t=n>=4||0===n?Object(a.c)(t):a.c.ceil(t)).getFullYear()%1e4,e,4)}function ot(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+b(e/60|0,"0",2)+b(e%60,"0",2)}function st(t,e){return b(t.getUTCDate(),e,2)}function ut(t,e){return b(t.getUTCHours(),e,2)}function ct(t,e){return b(t.getUTCHours()%12||12,e,2)}function lt(t,e){return b(1+i.a.count(Object(u.a)(t),t),e,3)}function dt(t,e){return b(t.getUTCMilliseconds(),e,3)}function ft(t,e){return dt(t,e)+"000"}function ht(t,e){return b(t.getUTCMonth()+1,e,2)}function pt(t,e){return b(t.getUTCMinutes(),e,2)}function mt(t,e){return b(t.getUTCSeconds(),e,2)}function gt(t){var e=t.getUTCDay();return 0===e?7:e}function bt(t,e){return b(r.b.count(Object(u.a)(t)-1,t),e,2)}function yt(t){var e=t.getUTCDay();return e>=4||0===e?Object(r.c)(t):r.c.ceil(t)}function vt(t,e){return t=yt(t),b(r.c.count(Object(u.a)(t),t)+(4===Object(u.a)(t).getUTCDay()),e,2)}function xt(t){return t.getUTCDay()}function wt(t,e){return b(r.a.count(Object(u.a)(t)-1,t),e,2)}function kt(t,e){return b(t.getUTCFullYear()%100,e,2)}function Ot(t,e){return b((t=yt(t)).getUTCFullYear()%100,e,2)}function _t(t,e){return b(t.getUTCFullYear()%1e4,e,4)}function At(t,e){var n=t.getUTCDay();return b((t=n>=4||0===n?Object(r.c)(t):r.c.ceil(t)).getUTCFullYear()%1e4,e,4)}function Ct(){return"+0000"}function Et(){return"%"}function St(t){return+t}function jt(t){return Math.floor(+t/1e3)}},function(t){t.exports={name:"vega-lite",author:'Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',version:"4.13.1",collaborators:["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],homepage:"https://vega.github.io/vega-lite/",description:"Vega-Lite is a concise high-level language for interactive visualization.",main:"build/vega-lite.js",unpkg:"build/vega-lite.min.js",jsdelivr:"build/vega-lite.min.js",module:"build/src/index",types:"build/src/index.d.ts",bin:{vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},directories:{test:"test"},scripts:{changelog:"conventional-changelog -p angular -r 2",build:"yarn build:only","build:only":"yarn tsc:src && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"find build ! -name 'vega-lite-schema.json' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup 'yarn tsc:src -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Rollup 'yarn tsc:site -w' 'rollup -c site/rollup.config.js -w'","watch:test":"jest --watch"},repository:{type:"git",url:"https://github.com/vega/vega-lite.git"},license:"BSD-3-Clause",bugs:{url:"https://github.com/vega/vega-lite/issues"},devDependencies:{"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2",ajv:"^6.12.2",chai:"^4.2.0",cheerio:"^1.0.0-rc.3",codecov:"^3.7.0",concurrently:"^5.2.0","conventional-changelog-cli":"^2.0.34",d3:"^5.16.0",eslint:"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3",jest:"^26.0.1","jest-puppeteer":"^4.4.0",mkdirp:"^1.0.4",prettier:"^2.0.5",puppeteer:"^3.1.0",rollup:"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7",terser:"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1",typescript:"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},dependencies:{"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0",tslib:"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0",yargs:"~15.3.1"},peerDependencies:{vega:"^5.12.1"},jest:{preset:"jest-puppeteer",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:!1}}},function(t,e,n){(function(e){var n=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var n,r,i;try{n=Map}catch(t){n=function(){}}try{r=Set}catch(t){r=function(){}}try{i=Promise}catch(t){i=function(){}}function a(o,u,c,l,d){"object"==typeof u&&(c=u.depth,l=u.prototype,d=u.includeNonEnumerable,u=u.circular);var f=[],h=[],p=void 0!==e;return void 0===u&&(u=!0),void 0===c&&(c=1/0),function o(c,m){if(null===c)return null;if(0===m)return c;var g,b;if("object"!=typeof c)return c;if(t(c,n))g=new n;else if(t(c,r))g=new r;else if(t(c,i))g=new i((function(t,e){c.then((function(e){t(o(e,m-1))}),(function(t){e(o(t,m-1))}))}));else if(a.__isArray(c))g=[];else if(a.__isRegExp(c))g=new RegExp(c.source,s(c)),c.lastIndex&&(g.lastIndex=c.lastIndex);else if(a.__isDate(c))g=new Date(c.getTime());else{if(p&&e.isBuffer(c))return g=e.allocUnsafe?e.allocUnsafe(c.length):new e(c.length),c.copy(g),g;t(c,Error)?g=Object.create(c):void 0===l?(b=Object.getPrototypeOf(c),g=Object.create(b)):(g=Object.create(l),b=l)}if(u){var y=f.indexOf(c);if(-1!=y)return h[y];f.push(c),h.push(g)}for(var v in t(c,n)&&c.forEach((function(t,e){var n=o(e,m-1),r=o(t,m-1);g.set(n,r)})),t(c,r)&&c.forEach((function(t){var e=o(t,m-1);g.add(e)})),c){var x;b&&(x=Object.getOwnPropertyDescriptor(b,v)),x&&null==x.set||(g[v]=o(c[v],m-1))}if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(c);for(v=0;v<w.length;v++){var k=w[v];(!(_=Object.getOwnPropertyDescriptor(c,k))||_.enumerable||d)&&(g[k]=o(c[k],m-1),_.enumerable||Object.defineProperty(g,k,{enumerable:!1}))}}if(d){var O=Object.getOwnPropertyNames(c);for(v=0;v<O.length;v++){var _,A=O[v];(_=Object.getOwnPropertyDescriptor(c,A))&&_.enumerable||(g[A]=o(c[A],m-1),Object.defineProperty(g,A,{enumerable:!1}))}}return g}(o,c)}function o(t){return Object.prototype.toString.call(t)}function s(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return a.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},a.__objToStr=o,a.__isDate=function(t){return"object"==typeof t&&"[object Date]"===o(t)},a.__isArray=function(t){return"object"==typeof t&&"[object Array]"===o(t)},a.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===o(t)},a.__getRegExpFlags=s,a}();t.exports&&(t.exports=n)}).call(this,n(94).Buffer)},function(t,e,n){"use strict";t.exports=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(e.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(e)){if((r=e.length)!=n.length)return!1;for(i=r;0!=i--;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((r=(a=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;0!=i--;){var o=a[i];if(!t(e[o],n[o]))return!1}return!0}return e!=e&&n!=n}},function(t){t.exports={name:"vega-tooltip",version:"0.23.2",description:"A tooltip plugin for Vega-Lite and Vega visualizations.",main:"build/vega-tooltip.js",module:"build/src/index.js",unpkg:"build/vega-tooltip.min.js",jsdelivr:"build/vega-tooltip.min.js",typings:"build/src/index.d.ts",repository:{type:"git",url:"https://github.com/vega/vega-tooltip.git"},keywords:["vega-lite","vega","tooltip"],author:{name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},collaborators:["Dominik Moritz","Sira Horradarn","Zening Qu","Kanit Wongsuphasawat","Yuri Astrakhan","Jeffrey Heer"],license:"BSD-3-Clause",bugs:{url:"https://github.com/vega/vega-tooltip/issues"},homepage:"https://github.com/vega/vega-tooltip#readme",scripts:{prepare:"beemo create-config --silent","tsc:src":"tsc -b tsconfig.src.json",build:"yarn tsc:src && rollup -c",clean:"rm -rf build examples/data && rm -f src/style.ts","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && yarn copy:build && gh-pages -d examples && yarn clean",prettierbase:"beemo prettier 'examples/*.{html,scss,css}'",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",postbuild:"terser build/vega-tooltip.js -c -m -o build/vega-tooltip.min.js",prebuild:"mkdir -p build && yarn copy:data && ./build-style.sh",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",start:"yarn build && concurrently --kill-others -n Server,Typescript,Rollup 'browser-sync start -s -f build examples --serveStatic examples' 'yarn tsc:src -w' 'rollup -c -w'",pretest:"./build-style.sh",test:"jest"},devDependencies:{"@rollup/plugin-commonjs":"13.0.0","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^8.1.0","@types/jest":"^26.0.4","browser-sync":"^2.26.7",codecov:"^3.7.0",concurrently:"^5.2.0","gh-pages":"^3.1.0",jest:"^26.1.0","node-sass":"^4.14.1",path:"^0.12.7",rollup:"^2.21.0",terser:"^4.8.0","ts-jest":"^26.1.1",typescript:"^3.9.6","vega-datasets":"^2.1.0","vega-lite-dev-config":"^0.11.8","vega-typings":"^0.18.0"},dependencies:{"vega-util":"^1.14.1"},beemo:{module:"vega-lite-dev-config",drivers:["prettier","eslint"]},jest:{testURL:"http://localhost/",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["node_modules","<rootDir>/build","src"]}}},function(t,e,n){"use strict";var r=n(30),i=n(32),a=Object(r.a)(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*i.c)/i.a,t=>t.getDate()-1);e.a=a;a.range},function(t,e,n){"use strict";var r=n(30),i=n(32),a=Object(r.a)((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/i.a}),(function(t){return t.getUTCDate()-1}));e.a=a;a.range},function(t,e,n){"use strict";n.r(e);var r=n(295),i=n.n(r);const a=n(227),o=n(372);let s=new class{constructor(){this.clientSocket=i()(location.origin,{reconnection:!1}),this.clientSocket.on("error",t=>{console.log("Socket error",t)})}on(t,e){this.clientSocket.on(t,(n,r)=>{console.log("[socket] on "+t,n),e(n,e=>{this.clientSocket&&this.clientSocket.connected&&(console.log("[socket] resp "+t,e),r(e))})})}emit(t,e,n){this.clientSocket&&this.clientSocket.connected&&(console.log("[socket] emit "+t,e),this.clientSocket.emit(t,e,r=>{console.log("[socket] emit callback "+t,e),n(null,r)}))}open(){this.clientSocket.connected||this.clientSocket.open()}disconnect(){this.clientSocket.disconnect()}};window.tf=a,window.tfvis=o,window.socket=s,s.on("disconnect",()=>{}),s.on("model",async t=>{window.model=await a.loadLayersModel(`${location.origin}${t.modelUrl}`),window.modelUrl=t.modelUrl,window.weightPathPrefix=t.weightPathPrefix,document.querySelector(t.container.selector+" .tf-label").innerHTML=t.container.name,o.show.modelSummary(document.querySelector(t.container.selector+" .area"),window.model)}),s.on("scatterplot",t=>{document.querySelector(t.container.selector+" .tf-label").innerHTML=t.container.name,o.render.scatterplot(document.querySelector(t.container.selector+" .area"),t.data,t.options)});let u={};s.on("showFitCallbacks",t=>{document.querySelector(t.container.selector+" .tf-label").innerHTML=t.container.name,u[t.container.selector]=u[t.container.selector]||o.show.fitCallbacks(document.querySelector(t.container.selector+" .area"),t.metrics,t.options),u[t.container.selector][t.field].apply(null,t.args)}),s.on("connect",()=>{u={};for(let t of document.querySelectorAll(".panels .panel > div"))t.innerHTML=""}),setInterval(()=>{s.open()},1e3)},,,,,,function(t,e,n){var r=n(235),i=n(160)("socket.io-client:url");t.exports=function(t,e){var n=t;e=e||"undefined"!=typeof location&&location,null==t&&(t=e.protocol+"//"+e.host);"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?e.protocol+t:e.host+t),/^(https?|wss?):\/\//.test(t)||(i("protocol-less url %s",t),t=void 0!==e?e.protocol+"//"+t:"https://"+t),i("parse %s",t),n=r(t));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));n.path=n.path||"/";var a=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port,n.href=n.protocol+"://"+a+(e&&e.port===n.port?"":":"+n.port),n}},function(t,e,n){function r(t){var n;function r(){if(r.enabled){var t=r,i=+new Date,a=i-(n||i);t.diff=a,t.prev=n,t.curr=i,n=i;for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var u=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;u++;var i=e.formatters[r];if("function"==typeof i){var a=o[u];n=i.call(t,a),o.splice(u,1),u--}return n})),e.formatArgs.call(t,o);var c=r.log||e.log||console.log.bind(console);c.apply(t,o)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=i,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function i(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var a=e.instances[n];a.enabled=e.enabled(a.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(330),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e){var n=1e3,r=6e4,i=60*r,a=24*i;function o(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,e){e=e||{};var s,u=typeof t;if("string"===u&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var o=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"days":case"day":case"d":return o*a;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(t);if("number"===u&&!1===isNaN(t))return e.long?o(s=t,a,"day")||o(s,i,"hour")||o(s,r,"minute")||o(s,n,"second")||s+" ms":function(t){if(t>=a)return Math.round(t/a)+"d";if(t>=i)return Math.round(t/i)+"h";if(t>=r)return Math.round(t/r)+"m";if(t>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){(function(r){function i(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(332)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,a=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(i++,"%c"===t&&(a=i))})),t.splice(a,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=i,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(i())}).call(this,n(93))},function(t,e,n){function r(t){var n;function r(){if(r.enabled){var t=r,i=+new Date,a=i-(n||i);t.diff=a,t.prev=n,t.curr=i,n=i;for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var u=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;u++;var i=e.formatters[r];if("function"==typeof i){var a=o[u];n=i.call(t,a),o.splice(u,1),u--}return n})),e.formatArgs.call(t,o);var c=r.log||e.log||console.log.bind(console);c.apply(t,o)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=i,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function i(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var a=e.instances[n];a.enabled=e.enabled(a.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(333),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e){var n=1e3,r=6e4,i=60*r,a=24*i;function o(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,e){e=e||{};var s,u=typeof t;if("string"===u&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var o=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"days":case"day":case"d":return o*a;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(t);if("number"===u&&!1===isNaN(t))return e.long?o(s=t,a,"day")||o(s,i,"hour")||o(s,r,"minute")||o(s,n,"second")||s+" ms":function(t){if(t>=a)return Math.round(t/a)+"d";if(t>=i)return Math.round(t/i)+"h";if(t>=r)return Math.round(t/r)+"m";if(t>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if((n=r[i])===e||n.fn===e){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,n){var r=n(236),i=n(237),a=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===a.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===a.call(File);e.deconstructPacket=function(t){var e=[],n=t.data,a=t;return a.data=function t(e,n){if(!e)return e;if(i(e)){var a={_placeholder:!0,num:n.length};return n.push(e),a}if(r(e)){for(var o=new Array(e.length),s=0;s<e.length;s++)o[s]=t(e[s],n);return o}if("object"==typeof e&&!(e instanceof Date)){o={};for(var u in e)o[u]=t(e[u],n);return o}return e}(n,e),a.attachments=e.length,{packet:a,buffers:e}},e.reconstructPacket=function(t,e){return t.data=function t(e,n){if(!e)return e;if(e&&e._placeholder)return n[e.num];if(r(e))for(var i=0;i<e.length;i++)e[i]=t(e[i],n);else if("object"==typeof e)for(var a in e)e[a]=t(e[a],n);return e}(t.data,e),t.attachments=void 0,t},e.removeBlobs=function(t,e){var n=0,a=t;!function t(u,c,l){if(!u)return u;if(o&&u instanceof Blob||s&&u instanceof File){n++;var d=new FileReader;d.onload=function(){l?l[c]=this.result:a=this.result,--n||e(a)},d.readAsArrayBuffer(u)}else if(r(u))for(var f=0;f<u.length;f++)t(u[f],f,u);else if("object"==typeof u&&!i(u))for(var h in u)t(u[h],h,u)}(a),n||e(a)}},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=c(t),o=r[0],s=r[1],u=new a(function(t,e,n){return 3*(e+n)/4-n}(0,o,s)),l=0,d=s>0?o-4:o;for(n=0;n<d;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;2===s&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,u[l++]=255&e);1===s&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e);return u},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,a=[],o=0,s=n-i;o<s;o+=16383)a.push(l(t,o,o+16383>s?s:o+16383));1===i?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=o.length;s<u;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var i,a,o=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(t,e,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,d=n?i-1:0,f=n?-1:1,h=t[e+d];for(d+=f,a=h&(1<<-l)-1,h>>=-l,l+=s;l>0;a=256*a+t[e+d],d+=f,l-=8);for(o=a&(1<<-l)-1,a>>=-l,l+=r;l>0;o=256*o+t[e+d],d+=f,l-=8);if(0===a)a=1-c;else{if(a===u)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,r),a-=c}return(h?-1:1)*o*Math.pow(2,a-r)},e.write=function(t,e,n,r,i,a){var o,s,u,c=8*a-i-1,l=(1<<c)-1,d=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:a-1,p=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+d>=1?f/u:f*Math.pow(2,1-d))*u>=2&&(o++,u/=2),o+d>=l?(s=0,o=l):o+d>=1?(s=(e*u-1)*Math.pow(2,i),o+=d):(s=e*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;t[n+h]=255&s,h+=p,s/=256,i-=8);for(o=o<<i|s,c+=i;c>0;t[n+h]=255&o,h+=p,o/=256,c-=8);t[n+h-p]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){t.exports=n(340),t.exports.parser=n(116)},function(t,e,n){var r=n(239),i=n(149),a=n(163)("engine.io-client:socket"),o=n(243),s=n(116),u=n(235),c=n(161);function l(t,e){if(!(this instanceof l))return new l(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t?(t=u(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=u(e.host).host),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.transportOptions=e.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=void 0===e.rejectUnauthorized||e.rejectUnauthorized,this.forceNode=!!e.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),e.localAddress&&(this.localAddress=e.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}t.exports=l,l.priorWebsocketSuccess=!1,i(l.prototype),l.protocol=s.protocol,l.Socket=l,l.Transport=n(216),l.transports=n(239),l.parser=n(116),l.prototype.createTransport=function(t){a('creating transport "%s"',t);var e=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}(this.query);e.EIO=s.protocol,e.transport=t;var n=this.transportOptions[t]||{};return this.id&&(e.sid=this.id),new r[t]({query:e,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},l.prototype.open=function(){var t;if(this.rememberUpgrade&&l.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout((function(){e.emit("error","No transports available")}),0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},l.prototype.setTransport=function(t){a("setting transport %s",t.name);var e=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",(function(){e.onDrain()})).on("packet",(function(t){e.onPacket(t)})).on("error",(function(t){e.onError(t)})).on("close",(function(){e.onClose("transport close")}))},l.prototype.probe=function(t){a('probing transport "%s"',t);var e=this.createTransport(t,{probe:1}),n=!1,r=this;function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}n||(a('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",(function(i){if(!n)if("pong"===i.type&&"probe"===i.data){if(a('probe transport "%s" pong',t),r.upgrading=!0,r.emit("upgrading",e),!e)return;l.priorWebsocketSuccess="websocket"===e.name,a('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(a("changing transport and sending upgrade packet"),f(),r.setTransport(e),e.send([{type:"upgrade"}]),r.emit("upgrade",e),e=null,r.upgrading=!1,r.flush())}))}else{a('probe transport "%s" failed',t);var o=new Error("probe error");o.transport=e.name,r.emit("upgradeError",o)}})))}function o(){n||(n=!0,f(),e.close(),e=null)}function s(n){var i=new Error("probe error: "+n);i.transport=e.name,o(),a('probe transport "%s" failed because of error: %s',t,n),r.emit("upgradeError",i)}function u(){s("transport closed")}function c(){s("socket closed")}function d(t){e&&t.name!==e.name&&(a('"%s" works - aborting "%s"',t.name,e.name),o())}function f(){e.removeListener("open",i),e.removeListener("error",s),e.removeListener("close",u),r.removeListener("close",c),r.removeListener("upgrading",d)}l.priorWebsocketSuccess=!1,e.once("open",i),e.once("error",s),e.once("close",u),this.once("close",c),this.once("upgrading",d),e.open()},l.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",l.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},l.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else a('packet received with socket readyState "%s"',this.readyState)},l.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},l.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout((function(){"closed"!==e.readyState&&e.onClose("ping timeout")}),t||e.pingInterval+e.pingTimeout)},l.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout((function(){a("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)}),t.pingInterval)},l.prototype.ping=function(){var t=this;this.sendPacket("ping",(function(){t.emit("ping")}))},l.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},l.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},l.prototype.write=l.prototype.send=function(t,e,n){return this.sendPacket("message",t,e,n),this},l.prototype.sendPacket=function(t,e,n,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:t,data:e,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},l.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():e()})):this.upgrading?r():e()}function e(){t.onClose("forced close"),a("socket closing - telling transport to close"),t.transport.close()}function n(){t.removeListener("upgrade",n),t.removeListener("upgradeError",n),e()}function r(){t.once("upgrade",n),t.once("upgradeError",n)}return this},l.prototype.onError=function(t){a("socket error %j",t),l.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},l.prototype.onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){a('socket close with reason: "%s"',t);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0}},l.prototype.filterUpgrades=function(t){for(var e=[],n=0,r=t.length;n<r;n++)~o(this.transports,t[n])&&e.push(t[n]);return e}},function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},function(t,e,n){var r=n(215),i=n(240),a=n(149),o=n(162),s=n(163)("engine.io-client:polling-xhr");function u(){}function c(t){if(i.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,"undefined"!=typeof location){var e="https:"===location.protocol,n=location.port;n||(n=e?443:80),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==e}}function l(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}if(t.exports=c,t.exports.Request=l,o(c,i),c.prototype.supportsBinary=!0,c.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new l(t)},c.prototype.doWrite=function(t,e){var n="string"!=typeof t&&void 0!==t,r=this.request({method:"POST",data:t,isBinary:n}),i=this;r.on("success",e),r.on("error",(function(t){i.onError("xhr post error",t)})),this.sendXhr=r},c.prototype.doPoll=function(){s("xhr poll");var t=this.request(),e=this;t.on("data",(function(t){e.onData(t)})),t.on("error",(function(t){e.onError("xhr poll error",t)})),this.pollXhr=t},a(l.prototype),l.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new r(t),n=this;try{s("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&e.setRequestHeader(i,this.extraHeaders[i])}catch(t){}if("POST"===this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=!0),this.requestTimeout&&(e.timeout=this.requestTimeout),this.hasXDR()?(e.onload=function(){n.onLoad()},e.onerror=function(){n.onError(e.responseText)}):e.onreadystatechange=function(){if(2===e.readyState)try{var t=e.getResponseHeader("Content-Type");n.supportsBinary&&"application/octet-stream"===t&&(e.responseType="arraybuffer")}catch(t){}4===e.readyState&&(200===e.status||1223===e.status?n.onLoad():setTimeout((function(){n.onError(e.status)}),0))},s("xhr data %s",this.data),e.send(this.data)}catch(t){return void setTimeout((function(){n.onError(t)}),0)}"undefined"!=typeof document&&(this.index=l.requestsCount++,l.requests[this.index]=this)},l.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},l.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},l.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},l.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=u:this.xhr.onreadystatechange=u,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete l.requests[this.index],this.xhr=null}},l.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type")}catch(t){}t="application/octet-stream"===e&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},l.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},l.prototype.abort=function(){this.cleanup()},l.requestsCount=0,l.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",f);else if("function"==typeof addEventListener){var d="onpagehide"in self?"pagehide":"unload";addEventListener(d,f,!1)}function f(){for(var t in l.requests)l.requests.hasOwnProperty(t)&&l.requests[t].abort()}},function(t,e){t.exports=Object.keys||function(t){var e=[],n=Object.prototype.hasOwnProperty;for(var r in t)n.call(t,r)&&e.push(r);return e}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){t.exports=function(t,e,n){var r=t.byteLength;if(e=e||0,n=n||r,t.slice)return t.slice(e,n);if(e<0&&(e+=r),n<0&&(n+=r),n>r&&(n=r),e>=r||e>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(t),a=new Uint8Array(n-e),o=e,s=0;o<n;o++,s++)a[s]=i[o];return a.buffer}},function(t,e){function n(){}t.exports=function(t,e,r){var i=!1;return r=r||n,a.count=t,0===t?e():a;function a(t,n){if(a.count<=0)throw new Error("after called too many times");--a.count,t?(i=!0,e(t),e=r):0!==a.count||i||e(null,n)}}},function(t,e){
/*! https://mths.be/utf8js v2.1.2 by @mathias */
var n,r,i,a=String.fromCharCode;function o(t){for(var e,n,r=[],i=0,a=t.length;i<a;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<a?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function s(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function u(t,e){return a(t>>e&63|128)}function c(t,e){if(0==(4294967168&t))return a(t);var n="";return 0==(4294965248&t)?n=a(t>>6&31|192):0==(4294901760&t)?(s(t,e)||(t=65533),n=a(t>>12&15|224),n+=u(t,6)):0==(4292870144&t)&&(n=a(t>>18&7|240),n+=u(t,12),n+=u(t,6)),n+=a(63&t|128)}function l(){if(i>=r)throw Error("Invalid byte index");var t=255&n[i];if(i++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function d(t){var e,a;if(i>r)throw Error("Invalid byte index");if(i==r)return!1;if(e=255&n[i],i++,0==(128&e))return e;if(192==(224&e)){if((a=(31&e)<<6|l())>=128)return a;throw Error("Invalid continuation byte")}if(224==(240&e)){if((a=(15&e)<<12|l()<<6|l())>=2048)return s(a,t)?a:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&(a=(7&e)<<18|l()<<12|l()<<6|l())>=65536&&a<=1114111)return a;throw Error("Invalid UTF-8 detected")}t.exports={version:"2.1.2",encode:function(t,e){for(var n=!1!==(e=e||{}).strict,r=o(t),i=r.length,a=-1,s="";++a<i;)s+=c(r[a],n);return s},decode:function(t,e){var s=!1!==(e=e||{}).strict;n=o(t),r=n.length,i=0;for(var u,c=[];!1!==(u=d(s));)c.push(u);return function(t){for(var e,n=t.length,r=-1,i="";++r<n;)(e=t[r])>65535&&(i+=a((e-=65536)>>>10&1023|55296),e=56320|1023&e),i+=a(e);return i}(c)}}},function(t,e){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<t.length;r++)n[t.charCodeAt(r)]=r;e.encode=function(e){var n,r=new Uint8Array(e),i=r.length,a="";for(n=0;n<i;n+=3)a+=t[r[n]>>2],a+=t[(3&r[n])<<4|r[n+1]>>4],a+=t[(15&r[n+1])<<2|r[n+2]>>6],a+=t[63&r[n+2]];return i%3==2?a=a.substring(0,a.length-1)+"=":i%3==1&&(a=a.substring(0,a.length-2)+"=="),a},e.decode=function(t){var e,r,i,a,o,s=.75*t.length,u=t.length,c=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var l=new ArrayBuffer(s),d=new Uint8Array(l);for(e=0;e<u;e+=4)r=n[t.charCodeAt(e)],i=n[t.charCodeAt(e+1)],a=n[t.charCodeAt(e+2)],o=n[t.charCodeAt(e+3)],d[c++]=r<<2|i>>4,d[c++]=(15&i)<<4|a>>2,d[c++]=(3&a)<<6|63&o;return l}}()},function(t,e){var n=void 0!==n?n:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),i=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),a=n&&n.prototype.append&&n.prototype.getBlob;function o(t){return t.map((function(t){if(t.buffer instanceof ArrayBuffer){var e=t.buffer;if(t.byteLength!==e.byteLength){var n=new Uint8Array(t.byteLength);n.set(new Uint8Array(e,t.byteOffset,t.byteLength)),e=n.buffer}return e}return t}))}function s(t,e){e=e||{};var r=new n;return o(t).forEach((function(t){r.append(t)})),e.type?r.getBlob(e.type):r.getBlob()}function u(t,e){return new Blob(o(t),e||{})}"undefined"!=typeof Blob&&(s.prototype=Blob.prototype,u.prototype=Blob.prototype),t.exports=r?i?Blob:u:a?s:void 0},function(t,e,n){function r(t){var n;function r(){if(r.enabled){var t=r,i=+new Date,a=i-(n||i);t.diff=a,t.prev=n,t.curr=i,n=i;for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var u=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;u++;var i=e.formatters[r];if("function"==typeof i){var a=o[u];n=i.call(t,a),o.splice(u,1),u--}return n})),e.formatArgs.call(t,o);var c=r.log||e.log||console.log.bind(console);c.apply(t,o)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=i,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function i(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var a=e.instances[n];a.enabled=e.enabled(a.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(351),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e){var n=1e3,r=6e4,i=60*r,a=24*i;function o(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,e){e=e||{};var s,u=typeof t;if("string"===u&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var o=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"days":case"day":case"d":return o*a;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(t);if("number"===u&&!1===isNaN(t))return e.long?o(s=t,a,"day")||o(s,i,"hour")||o(s,r,"minute")||o(s,n,"second")||s+" ms":function(t){if(t>=a)return Math.round(t/a)+"d";if(t>=i)return Math.round(t/i)+"h";if(t>=r)return Math.round(t/r)+"m";if(t>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){(function(e){var r=n(240),i=n(162);t.exports=l;var a,o=/\n/g,s=/\\n/g;function u(){}function c(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:{}}function l(t){if(r.call(this,t),this.query=this.query||{},!a){var e=c();a=e.___eio=e.___eio||[]}this.index=a.length;var n=this;a.push((function(t){n.onData(t)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){n.script&&(n.script.onerror=u)}),!1)}i(l,r),l.prototype.supportsBinary=!1,l.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},l.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)}),100)},l.prototype.doWrite=function(t,e){var n=this;if(!this.form){var r,i=document.createElement("form"),a=document.createElement("textarea"),u=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=u,i.method="POST",i.setAttribute("accept-charset","utf-8"),a.name="d",i.appendChild(a),document.body.appendChild(i),this.form=i,this.area=a}function c(){l(),e()}function l(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(t){n.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(t)}catch(t){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),l(),t=t.replace(s,"\\\n"),this.area.value=t.replace(o,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&c()}:this.iframe.onload=c}}).call(this,n(148))},function(t,e,n){(function(e){var r,i,a=n(216),o=n(116),s=n(161),u=n(162),c=n(242),l=n(163)("engine.io-client:websocket");if("undefined"!=typeof WebSocket)r=WebSocket;else if("undefined"!=typeof self)r=self.WebSocket||self.MozWebSocket;else try{i=n(354)}catch(t){}var d=r||i;function f(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=r&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(d=i),a.call(this,t)}t.exports=f,u(f,a),f.prototype.name="websocket",f.prototype.supportsBinary=!0,f.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?e?new d(t,e):new d(t):new d(t,e,n)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},f.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},f.prototype.write=function(t){var n=this;this.writable=!1;for(var r=t.length,i=0,a=r;i<a;i++)!function(t){o.encodePacket(t,n.supportsBinary,(function(i){if(!n.usingBrowserWebSocket){var a={};if(t.options&&(a.compress=t.options.compress),n.perMessageDeflate)("string"==typeof i?e.byteLength(i):i.length)<n.perMessageDeflate.threshold&&(a.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,a)}catch(t){l("websocket closed before onclose event")}--r||s()}))}(t[i]);function s(){n.emit("flush"),setTimeout((function(){n.writable=!0,n.emit("drain")}),0)}},f.prototype.onClose=function(){a.prototype.onClose.call(this)},f.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},f.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",n="";return this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||(t.b64=1),(t=s.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+t},f.prototype.check=function(){return!(!d||"__initialize"in d&&this.name===f.prototype.name)}}).call(this,n(94).Buffer)},function(t,e){},function(t,e){t.exports=function(t,e){for(var n=[],r=(e=e||0)||0;r<t.length;r++)n[r-e]=t[r];return n}},function(t,e){function n(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=n,n.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(t){this.ms=t},n.prototype.setMax=function(t){this.max=t},n.prototype.setJitter=function(t){this.jitter=t}},function(t,e,n){"use strict";(function(t){var e=n(23);
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r=()=>n(358);let i;class a{constructor(){this.util=n(359),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return null!=Object(e.c)().global.fetch?Object(e.c)().global.fetch(t,n):(null==i&&(i=r()),i(t,n))}now(){const e=t.hrtime();return 1e3*e[0]+e[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}}Object(e.c)().get("IS_NODE")&&Object(e.c)().setPlatform("node",new a)}).call(this,n(93))},function(t,e){},function(t,e){},function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function u(t,e){var n=new o(t),r=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n(61)&&n(118)?void 0===(r=function(){return u}.call(e,n,e,i))||(i.exports=r):this.alea=u}(0,t,n(61))}).call(this,n(117)(t))},function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function u(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n(61)&&n(118)?void 0===(r=function(){return u}.call(e,n,e,i))||(i.exports=r):this.xor128=u}(0,t,n(61))}).call(this,n(117)(t))},function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function u(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n(61)&&n(118)?void 0===(r=function(){return u}.call(e,n,e,i))||(i.exports=r):this.xorwow=u}(0,t,n(61))}).call(this,n(117)(t))},function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function s(t,e){return e.x=t.x.slice(),e.i=t.i,e}function u(t,e){null==t&&(t=+new Date);var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.x&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n(61)&&n(118)?void 0===(r=function(){return u}.call(e,n,e,i))||(i.exports=r):this.xorshift7=u}(0,t,n(61))}).call(this,n(117)(t))},function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,a=-32;a<u;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=o,t.X=s,t.i=i}(e,t)}function s(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function u(t,e){null==t&&(t=+new Date);var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.X&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n(61)&&n(118)?void 0===(r=function(){return u}.call(e,n,e,i))||(i.exports=r):this.xor4096=u}(0,t,n(61))}).call(this,n(117)(t))},function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function u(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n(61)&&n(118)?void 0===(r=function(){return u}.call(e,n,e,i))||(i.exports=r):this.tychei=u}(0,t,n(61))}).call(this,n(117)(t))},function(t,e,n){var r;!function(i,a){var o,s=this,u=a.pow(256,6),c=a.pow(2,52),l=2*c;function d(t,e,n){var r=[],d=p(function t(e,n){var r,i=[],a=typeof e;if(n&&"object"==a)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==a?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,m(i)]:null==t?function(){try{var t;return o&&(t=o.randomBytes)?t=t(256):(t=new Uint8Array(256),(s.crypto||s.msCrypto).getRandomValues(t)),m(t)}catch(t){var e=s.navigator,n=e&&e.plugins;return[+new Date,s,n,s.screen,m(i)]}}():t,3),r),g=new f(r),b=function(){for(var t=g.g(6),e=u,n=0;t<c;)t=256*(t+n),e*=256,n=g.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|g.g(4)},b.quick=function(){return g.g(4)/4294967296},b.double=b,p(m(g.S),i),(e.pass||n||function(t,e,n,r){return r&&(r.S&&h(r,g),t.state=function(){return h(g,{})}),n?(a.random=t,e):t})(b,d,"global"in e?e.global:this==a,e.state)}function f(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,o=r.S=[];for(n||(t=[n++]);i<256;)o[i]=i++;for(i=0;i<256;i++)o[i]=o[a=255&a+t[i%n]+(e=o[i])],o[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,o=r.S;t--;)e=o[i=255&i+1],n=256*n+o[255&(o[i]=o[a=255&a+e])+(o[a]=e)];return r.i=i,r.j=a,n})(256)}function h(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function p(t,e){for(var n,r=t+"",i=0;i<r.length;)e[255&i]=255&(n^=19*e[255&i])+r.charCodeAt(i++);return m(e)}function m(t){return String.fromCharCode.apply(0,t)}if(a.seedrandom=d,p(a.random(),i),t.exports){t.exports=d;try{o=n(367)}catch(t){}}else void 0===(r=function(){return d}.call(e,n,e,t))||(t.exports=r)}([],Math)},function(t,e){},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function a(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new a(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new a(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(369),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(148))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,a,o,s,u=1,c={},l=!1,d=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){p(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((a=new MessageChannel).port1.onmessage=function(t){p(t.data)},r=function(t){a.port2.postMessage(t)}):d&&"onreadystatechange"in d.createElement("script")?(i=d.documentElement,r=function(t){var e=d.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(p,0,t)}:(o="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&p(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),r=function(e){t.postMessage(o+e,"*")}),f.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return c[u]=i,r(u),u++},f.clearImmediate=h}function h(t){delete c[t]}function p(t){if(l)setTimeout(p,0,t);else{var e=c[t];if(e){l=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{h(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(148),n(93))},function(t,e){},function(t,e){},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});const r=n(373),i=n(431),a=n(432),o=n(226),s=n(293),u=n(433),c=n(172),l=n(434),d=n(435),f=n(436),h=n(437),p=n(171),m=n(438);e.version_vis=m.version;const g={barchart:r.barchart,table:c.table,histogram:o.histogram,linechart:s.linechart,scatterplot:u.scatterplot,confusionMatrix:i.confusionMatrix,heatmap:a.heatmap};e.render=g;const b={accuracy:p.accuracy,perClassAccuracy:p.perClassAccuracy,confusionMatrix:p.confusionMatrix};e.metrics=b;const y={history:l.history,fitCallbacks:l.fitCallbacks,perClassAccuracy:f.showPerClassAccuracy,valuesDistribution:h.valuesDistribution,layer:d.layer,modelSummary:d.modelSummary};e.show=y;var v=n(292);e.visor=v.visor,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(291))},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(n(121)),o=n(95),s=n(71);e.barchart=function(t,e,n={}){return r(this,void 0,void 0,(function*(){const r=s.getDrawArea(t),i=e,l=Object.assign({},u,n);if(c.has(r)){const t=c.get(r);if(s.shallowEquals(l,t.lastOptions)){yield s.nextFrame();const e=t.view,n=e.changeset().remove(()=>!0).insert(i);return void(yield e.change("values",n).runAsync())}}const{xLabel:d,yLabel:f,xType:h,yType:p}=l;let m=null;null!=d&&(m={title:d});let g=null;null!=f&&(g={title:f});let b;b=null!=l.color?Array.isArray(l.color)?{field:"index",type:"nominal",scale:{range:l.color}}:{value:l.color}:{value:"#4C78A0"};const y={width:l.width||o.getDefaultWidth(r),height:l.height||o.getDefaultHeight(r),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:l.fontSize,titleFontSize:l.fontSize},text:{fontSize:l.fontSize},legend:{labelFontSize:l.fontSize,titleFontSize:l.fontSize}},data:{values:i,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:h,axis:m},y:{field:"value",type:p,axis:g},color:b}};yield s.nextFrame();const v=yield a.default(r,y,{actions:!1,mode:"vega-lite",defaultStyle:!1});c.set(r,{view:v.view,lastOptions:l})}))};const u={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},c=new Map},function(t,e,n){const r=n(120);t.exports=(t,e)=>{const n=r(t,e);return n?n.version:null}},function(t,e,n){const r=n(120);t.exports=(t,e)=>{const n=r(t.trim().replace(/^[=v]+/,""),e);return n?n.version:null}},function(t,e,n){const r=n(51);t.exports=(t,e,n,i)=>{"string"==typeof n&&(i=n,n=void 0);try{return new r(t,n).inc(e,i).version}catch(t){return null}}},function(t,e,n){const r=n(120),i=n(218);t.exports=(t,e)=>{if(i(t,e))return null;{const n=r(t),i=r(e),a=n.prerelease.length||i.prerelease.length,o=a?"pre":"",s=a?"prerelease":"";for(const t in n)if(("major"===t||"minor"===t||"patch"===t)&&n[t]!==i[t])return o+t;return s}}},function(t,e,n){const r=n(51);t.exports=(t,e)=>new r(t,e).major},function(t,e,n){const r=n(51);t.exports=(t,e)=>new r(t,e).minor},function(t,e,n){const r=n(51);t.exports=(t,e)=>new r(t,e).patch},function(t,e,n){const r=n(120);t.exports=(t,e)=>{const n=r(t,e);return n&&n.prerelease.length?n.prerelease:null}},function(t,e,n){const r=n(69);t.exports=(t,e,n)=>r(e,t,n)},function(t,e,n){const r=n(69);t.exports=(t,e)=>r(t,e,!0)},function(t,e,n){const r=n(219);t.exports=(t,e)=>t.sort((t,n)=>r(t,n,e))},function(t,e,n){const r=n(219);t.exports=(t,e)=>t.sort((t,n)=>r(n,t,e))},function(t,e,n){const r=n(51),i=n(120),{re:a,t:o}=n(119);t.exports=(t,e)=>{if(t instanceof r)return t;if("number"==typeof t&&(t=String(t)),"string"!=typeof t)return null;let n=null;if((e=e||{}).rtl){let e;for(;(e=a[o.COERCERTL].exec(t))&&(!n||n.index+n[0].length!==t.length);)n&&e.index+e[0].length===n.index+n[0].length||(n=e),a[o.COERCERTL].lastIndex=e.index+e[1].length+e[2].length;a[o.COERCERTL].lastIndex=-1}else n=t.match(a[o.COERCE]);return null===n?null:i(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,e)}},function(t,e,n){"use strict";const r=n(388),i=Symbol("max"),a=Symbol("length"),o=Symbol("lengthCalculator"),s=Symbol("allowStale"),u=Symbol("maxAge"),c=Symbol("dispose"),l=Symbol("noDisposeOnSet"),d=Symbol("lruList"),f=Symbol("cache"),h=Symbol("updateAgeOnGet"),p=()=>1;const m=(t,e,n)=>{const r=t[f].get(e);if(r){const e=r.value;if(g(t,e)){if(y(t,r),!t[s])return}else n&&(t[h]&&(r.value.now=Date.now()),t[d].unshiftNode(r));return e.value}},g=(t,e)=>{if(!e||!e.maxAge&&!t[u])return!1;const n=Date.now()-e.now;return e.maxAge?n>e.maxAge:t[u]&&n>t[u]},b=t=>{if(t[a]>t[i])for(let e=t[d].tail;t[a]>t[i]&&null!==e;){const n=e.prev;y(t,e),e=n}},y=(t,e)=>{if(e){const n=e.value;t[c]&&t[c](n.key,n.value),t[a]-=n.length,t[f].delete(n.key),t[d].removeNode(e)}};class v{constructor(t,e,n,r,i){this.key=t,this.value=e,this.length=n,this.now=r,this.maxAge=i||0}}const x=(t,e,n,r)=>{let i=n.value;g(t,i)&&(y(t,n),t[s]||(i=void 0)),i&&e.call(r,i.value,i.key,t)};t.exports=class{constructor(t){if("number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[i]=t.max||1/0;const e=t.length||p;if(this[o]="function"!=typeof e?p:e,this[s]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw new TypeError("maxAge must be a number");this[u]=t.maxAge||0,this[c]=t.dispose,this[l]=t.noDisposeOnSet||!1,this[h]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!=typeof t||t<0)throw new TypeError("max must be a non-negative number");this[i]=t||1/0,b(this)}get max(){return this[i]}set allowStale(t){this[s]=!!t}get allowStale(){return this[s]}set maxAge(t){if("number"!=typeof t)throw new TypeError("maxAge must be a non-negative number");this[u]=t,b(this)}get maxAge(){return this[u]}set lengthCalculator(t){"function"!=typeof t&&(t=p),t!==this[o]&&(this[o]=t,this[a]=0,this[d].forEach(t=>{t.length=this[o](t.value,t.key),this[a]+=t.length})),b(this)}get lengthCalculator(){return this[o]}get length(){return this[a]}get itemCount(){return this[d].length}rforEach(t,e){e=e||this;for(let n=this[d].tail;null!==n;){const r=n.prev;x(this,t,n,e),n=r}}forEach(t,e){e=e||this;for(let n=this[d].head;null!==n;){const r=n.next;x(this,t,n,e),n=r}}keys(){return this[d].toArray().map(t=>t.key)}values(){return this[d].toArray().map(t=>t.value)}reset(){this[c]&&this[d]&&this[d].length&&this[d].forEach(t=>this[c](t.key,t.value)),this[f]=new Map,this[d]=new r,this[a]=0}dump(){return this[d].map(t=>!g(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[d]}set(t,e,n){if((n=n||this[u])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,s=this[o](e,t);if(this[f].has(t)){if(s>this[i])return y(this,this[f].get(t)),!1;const o=this[f].get(t).value;return this[c]&&(this[l]||this[c](t,o.value)),o.now=r,o.maxAge=n,o.value=e,this[a]+=s-o.length,o.length=s,this.get(t),b(this),!0}const h=new v(t,e,s,r,n);return h.length>this[i]?(this[c]&&this[c](t,e),!1):(this[a]+=h.length,this[d].unshift(h),this[f].set(t,this[d].head),b(this),!0)}has(t){if(!this[f].has(t))return!1;const e=this[f].get(t).value;return!g(this,e)}get(t){return m(this,t,!0)}peek(t){return m(this,t,!1)}pop(){const t=this[d].tail;return t?(y(this,t),t.value):null}del(t){y(this,this[f].get(t))}load(t){this.reset();const e=Date.now();for(let n=t.length-1;n>=0;n--){const r=t[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const t=i-e;t>0&&this.set(r.k,r.v,t)}}}prune(){this[f].forEach((t,e)=>m(this,e,!1))}}},function(t,e,n){"use strict";function r(t){var e=this;if(e instanceof r||(e=new r),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach((function(t){e.push(t)}));else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)e.push(arguments[n]);return e}function i(t,e,n){var r=e===t.head?new s(n,null,e,t):new s(n,e,e.next,t);return null===r.next&&(t.tail=r),null===r.prev&&(t.head=r),t.length++,r}function a(t,e){t.tail=new s(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function o(t,e){t.head=new s(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function s(t,e,n,r){if(!(this instanceof s))return new s(t,e,n,r);this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}t.exports=r,r.Node=s,r.create=r,r.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,e},r.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},r.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},r.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)a(this,arguments[t]);return this.length},r.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)o(this,arguments[t]);return this.length},r.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},r.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},r.prototype.forEach=function(t,e){e=e||this;for(var n=this.head,r=0;null!==n;r++)t.call(e,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(t,e){e=e||this;for(var n=this.tail,r=this.length-1;null!==n;r--)t.call(e,n.value,r,this),n=n.prev},r.prototype.get=function(t){for(var e=0,n=this.head;null!==n&&e<t;e++)n=n.next;if(e===t&&null!==n)return n.value},r.prototype.getReverse=function(t){for(var e=0,n=this.tail;null!==n&&e<t;e++)n=n.prev;if(e===t&&null!==n)return n.value},r.prototype.map=function(t,e){e=e||this;for(var n=new r,i=this.head;null!==i;)n.push(t.call(e,i.value,this)),i=i.next;return n},r.prototype.mapReverse=function(t,e){e=e||this;for(var n=new r,i=this.tail;null!==i;)n.push(t.call(e,i.value,this)),i=i.prev;return n},r.prototype.reduce=function(t,e){var n,r=this.head;if(arguments.length>1)n=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=t(n,r.value,i),r=r.next;return n},r.prototype.reduceReverse=function(t,e){var n,r=this.tail;if(arguments.length>1)n=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=t(n,r.value,i),r=r.prev;return n},r.prototype.toArray=function(){for(var t=new Array(this.length),e=0,n=this.head;null!==n;e++)t[e]=n.value,n=n.next;return t},r.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,n=this.tail;null!==n;e++)t[e]=n.value,n=n.prev;return t},r.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new r;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,a=this.head;null!==a&&i<t;i++)a=a.next;for(;null!==a&&i<e;i++,a=a.next)n.push(a.value);return n},r.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new r;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,a=this.tail;null!==a&&i>e;i--)a=a.prev;for(;null!==a&&i>t;i--,a=a.prev)n.push(a.value);return n},r.prototype.splice=function(t,e,...n){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var r=0,a=this.head;null!==a&&r<t;r++)a=a.next;var o=[];for(r=0;a&&r<e;r++)o.push(a.value),a=this.removeNode(a);null===a&&(a=this.tail),a!==this.head&&a!==this.tail&&(a=a.prev);for(r=0;r<n.length;r++)a=i(this,a,n[r]);return o},r.prototype.reverse=function(){for(var t=this.head,e=this.tail,n=t;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=e,this.tail=t,this};try{n(389)(r)}catch(t){}},function(t,e,n){"use strict";t.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}},function(t,e,n){const r=n(70);t.exports=(t,e)=>new r(t,e).set.map(t=>t.map(t=>t.value).join(" ").trim().split(" "))},function(t,e,n){const r=n(51),i=n(70);t.exports=(t,e,n)=>{let a=null,o=null,s=null;try{s=new i(e,n)}catch(t){return null}return t.forEach(t=>{s.test(t)&&(a&&-1!==o.compare(t)||(a=t,o=new r(a,n)))}),a}},function(t,e,n){const r=n(51),i=n(70);t.exports=(t,e,n)=>{let a=null,o=null,s=null;try{s=new i(e,n)}catch(t){return null}return t.forEach(t=>{s.test(t)&&(a&&1!==o.compare(t)||(a=t,o=new r(a,n)))}),a}},function(t,e,n){const r=n(51),i=n(70),a=n(167);t.exports=(t,e)=>{t=new i(t,e);let n=new r("0.0.0");if(t.test(n))return n;if(n=new r("0.0.0-0"),t.test(n))return n;n=null;for(let e=0;e<t.set.length;++e){const i=t.set[e];let o=null;i.forEach(t=>{const e=new r(t.semver.version);switch(t.operator){case">":0===e.prerelease.length?e.patch++:e.prerelease.push(0),e.raw=e.format();case"":case">=":o&&!a(e,o)||(o=e);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+t.operator)}}),!o||n&&!a(n,o)||(n=o)}return n&&t.test(n)?n:null}},function(t,e,n){const r=n(70);t.exports=(t,e)=>{try{return new r(t,e).range||"*"}catch(t){return null}}},function(t,e,n){const r=n(223);t.exports=(t,e,n)=>r(t,e,">",n)},function(t,e,n){const r=n(223);t.exports=(t,e,n)=>r(t,e,"<",n)},function(t,e,n){const r=n(70);t.exports=(t,e,n)=>(t=new r(t,n),e=new r(e,n),t.intersects(e))},function(t,e,n){const r=n(169),i=n(69);t.exports=(t,e,n)=>{const a=[];let o=null,s=null;const u=t.sort((t,e)=>i(t,e,n));for(const t of u){r(t,e,n)?(s=t,o||(o=t)):(s&&a.push([o,s]),s=null,o=null)}o&&a.push([o,null]);const c=[];for(const[t,e]of a)t===e?c.push(t):e||t!==u[0]?e?t===u[0]?c.push("<="+e):c.push(`${t} - ${e}`):c.push(">="+t):c.push("*");const l=c.join(" || "),d="string"==typeof e.raw?e.raw:String(e);return l.length<d.length?l:e}},function(t,e,n){const r=n(70),{ANY:i}=n(168),a=n(169),o=n(69),s=(t,e,n)=>{if(t===e)return!0;if(1===t.length&&t[0].semver===i)return 1===e.length&&e[0].semver===i;const r=new Set;let s,l,d,f,h,p,m;for(const e of t)">"===e.operator||">="===e.operator?s=u(s,e,n):"<"===e.operator||"<="===e.operator?l=c(l,e,n):r.add(e.semver);if(r.size>1)return null;if(s&&l){if(d=o(s.semver,l.semver,n),d>0)return null;if(0===d&&(">="!==s.operator||"<="!==l.operator))return null}for(const t of r){if(s&&!a(t,String(s),n))return null;if(l&&!a(t,String(l),n))return null;for(const r of e)if(!a(t,String(r),n))return!1;return!0}for(const t of e){if(m=m||">"===t.operator||">="===t.operator,p=p||"<"===t.operator||"<="===t.operator,s)if(">"===t.operator||">="===t.operator){if(f=u(s,t,n),f===t&&f!==s)return!1}else if(">="===s.operator&&!a(s.semver,String(t),n))return!1;if(l)if("<"===t.operator||"<="===t.operator){if(h=c(l,t,n),h===t&&h!==l)return!1}else if("<="===l.operator&&!a(l.semver,String(t),n))return!1;if(!t.operator&&(l||s)&&0!==d)return!1}return!(s&&p&&!l&&0!==d)&&!(l&&m&&!s&&0!==d)},u=(t,e,n)=>{if(!t)return e;const r=o(t.semver,e.semver,n);return r>0?t:r<0||">"===e.operator&&">="===t.operator?e:t},c=(t,e,n)=>{if(!t)return e;const r=o(t.semver,e.semver,n);return r<0?t:r>0||"<"===e.operator&&"<="===t.operator?e:t};t.exports=(t,e,n)=>{if(t===e)return!0;t=new r(t,n),e=new r(e,n);let i=!1;t:for(const r of t.set){for(const t of e.set){const e=s(r,t,n);if(i=i||null!==e,e)continue t}if(i)return!1}return!0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StyleSheet=d;var r,i=n(224),a=(r=i)&&r.__esModule?r:{default:r};function o(t){return t[t.length-1]}function s(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}var u="undefined"!=typeof window,c=function(){if(u){var t=document.createElement("div");return t.innerHTML="\x3c!--[if lt IE 10]><i></i><![endif]--\x3e",1===t.getElementsByTagName("i").length}}();function l(){var t=document.createElement("style");return t.type="text/css",t.setAttribute("data-glamor",""),t.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(t),t}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.speedy,n=void 0===e||e,r=t.maxLength,i=void 0===r?u&&c?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=i,this.ctr=0}(0,a.default)(d.prototype,{getSheet:function(){return s(o(this.tags))},inject:function(){var t=this;if(this.injected)throw new Error("already injected stylesheet!");u?this.tags[0]=l():this.sheet={cssRules:[],insertRule:function(e){t.sheet.cssRules.push({cssText:e})}},this.injected=!0},speedy:function(t){if(0!==this.ctr)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+t+") earlier in your app, or call flush() before speedy("+t+")");this.isSpeedy=!!t},_insert:function(t){try{var e=this.getSheet();e.insertRule(t,-1!==t.indexOf("@import")?0:e.cssRules.length)}catch(t){0}},insert:function(t){if(u)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(t);else if(-1!==t.indexOf("@import")){var e=o(this.tags);e.insertBefore(document.createTextNode(t),e.firstChild)}else o(this.tags).appendChild(document.createTextNode(t));else this.sheet.insertRule(t,-1!==t.indexOf("@import")?0:this.sheet.cssRules.length);return this.ctr++,u&&this.ctr%this.maxLength==0&&this.tags.push(l()),this.ctr-1},delete:function(t){return this.replace(t,"")},flush:function(){u?(this.tags.forEach((function(t){return t.parentNode.removeChild(t)})),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!u)return this.sheet.cssRules;var t=[];return this.tags.forEach((function(e){return t.splice.apply(t,[t.length,0].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(Array.from(s(e).cssRules))))})),t}})},function(t,e,n){"use strict";var r=n(402),i=/^-ms-/;t.exports=function(t){return r(t.replace(i,"ms-"))}},function(t,e,n){"use strict";var r=/-(.)/g;t.exports=function(t){return t.replace(r,(function(t,e){return e.toUpperCase()}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(n(404));i(n(289));function i(t){return t&&t.__esModule?t:{default:t}}var a=r.default.isUnitlessNumber;e.default=function(t,e,n){return null==e||"boolean"==typeof e||""===e?"":isNaN(e)||0===e||a.hasOwnProperty(t)&&a[t]?""+e:("string"==typeof e&&(e=e.trim()),e+"px")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};var i=["Webkit","ms","Moz","O"];Object.keys(r).forEach((function(t){i.forEach((function(e){r[function(t,e){return t+e.charAt(0).toUpperCase()+e.substring(1)}(e,t)]=r[t]}))}));var a={isUnitlessNumber:r,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}};e.default=a},function(t,e,n){"use strict";function r(t){return function(){return t}}var i=function(){};i.thatReturns=r,i.thatReturnsFalse=r(!1),i.thatReturnsTrue=r(!0),i.thatReturnsNull=r(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(t){return t},t.exports=i},function(t,e,n){"use strict";var r=n(407),i=/^ms-/;t.exports=function(t){return r(t).replace(i,"-ms-")}},function(t,e,n){"use strict";var r=/([A-Z])/g;t.exports=function(t){return t.replace(r,"-$1").toLowerCase()}},function(t,e,n){"use strict";t.exports=function(t){var e={};return function(n){return e.hasOwnProperty(n)||(e[n]=t.call(this,n)),e[n]}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function i(t){if(function(t){return null==t||!1===t||"object"===(void 0===t?"undefined":r(t))&&0===Object.keys(t).length}(t))return null;if("object"!==(void 0===t?"undefined":r(t)))return t;for(var e={},n=Object.keys(t),i=!1,o=0;o<n.length;o++){var s=t[n[o]],u=a(s);null!==u&&u===s||(i=!0),null!==u&&(e[n[o]]=u)}return 0===Object.keys(e).length?null:i?e:t}function a(t){return Array.isArray(t)?(n=!1,r=[],(e=t).forEach((function(t){var e=a(t);null!==e&&e===t||(n=!0),null!==e&&r.push(e)})),0==r.length?null:n?r:e):i(t);var e,n,r}e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e.PluginSet=u,e.fallbacks=function(t){if(Object.keys(t.style).map((function(e){return Array.isArray(t.style[e])})).indexOf(!0)>=0){var e=t.style,n=Object.keys(e).reduce((function(t,n){return t[n]=Array.isArray(e[n])?e[n].join("; "+(0,a.processStyleName)(n)+": "):e[n],t}),{});return(0,i.default)({},t,{style:n})}return t},e.contentWrap=function(t){if(t.style.content){var e=t.style.content;return c.indexOf(e)>=0||/^(attr|calc|counters?|url)\(/.test(e)?t:e.charAt(0)!==e.charAt(e.length-1)||'"'!==e.charAt(0)&&"'"!==e.charAt(0)?r({},t,{style:r({},t.style,{content:'"'+e+'"'})}):t}return t},e.prefixes=function(t){return(0,i.default)({},t,{style:(0,o.default)(r({},t.style))})};var i=s(n(224)),a=n(288),o=s(n(411));function s(t){return t&&t.__esModule?t:{default:t}}function u(t){this.fns=t||[]}(0,i.default)(u.prototype,{add:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e){t.fns.indexOf(e)>=0||(t.fns=[e].concat(t.fns))}))},remove:function(t){this.fns=this.fns.filter((function(e){return e!==t}))},clear:function(){this.fns=[]},transform:function(t){return this.fns.reduce((function(t,e){return e(t)}),t)}});var c=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){for(var e in t){var n=t[e],r=(0,a.default)(b,e,n,t,y);r&&(t[e]=r),(0,i.default)(y,e,t)}return t};var r=g(n(412)),i=g(n(413)),a=g(n(414)),o=g(n(415)),s=g(n(416)),u=g(n(417)),c=g(n(418)),l=g(n(419)),d=g(n(420)),f=g(n(421)),h=g(n(422)),p=g(n(423)),m=g(n(424));function g(t){return t&&t.__esModule?t:{default:t}}var b=[s.default,o.default,u.default,l.default,d.default,f.default,h.default,p.default,m.default,c.default],y=r.default.prefixMap},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=["Webkit"],i=["Moz"],a=["ms"],o=["Webkit","Moz"],s=["Webkit","ms"],u=["Webkit","Moz","ms"];e.default={plugins:[],prefixMap:{appearance:o,userSelect:u,textEmphasisPosition:r,textEmphasis:r,textEmphasisStyle:r,textEmphasisColor:r,boxDecorationBreak:r,clipPath:r,maskImage:r,maskMode:r,maskRepeat:r,maskPosition:r,maskClip:r,maskOrigin:r,maskSize:r,maskComposite:r,mask:r,maskBorderSource:r,maskBorderMode:r,maskBorderSlice:r,maskBorderWidth:r,maskBorderOutset:r,maskBorderRepeat:r,maskBorder:r,maskType:r,textDecorationStyle:r,textDecorationSkip:r,textDecorationLine:r,textDecorationColor:r,filter:r,fontFeatureSettings:r,breakAfter:u,breakBefore:u,breakInside:u,columnCount:o,columnFill:o,columnGap:o,columnRule:o,columnRuleColor:o,columnRuleStyle:o,columnRuleWidth:o,columns:o,columnSpan:o,columnWidth:o,writingMode:s,flex:r,flexBasis:r,flexDirection:r,flexGrow:r,flexFlow:r,flexShrink:r,flexWrap:r,alignContent:r,alignItems:r,alignSelf:r,justifyContent:r,order:r,transform:r,transformOrigin:r,transformOriginX:r,transformOriginY:r,backfaceVisibility:r,perspective:r,perspectiveOrigin:r,transformStyle:r,transformOriginZ:r,animation:r,animationDelay:r,animationDirection:r,animationFillMode:r,animationDuration:r,animationIterationCount:r,animationName:r,animationPlayState:r,animationTimingFunction:r,backdropFilter:r,fontKerning:r,scrollSnapType:s,scrollSnapPointsX:s,scrollSnapPointsY:s,scrollSnapDestination:s,scrollSnapCoordinate:s,shapeImageThreshold:r,shapeImageMargin:r,shapeImageOutside:r,hyphens:u,flowInto:s,flowFrom:s,regionFragment:s,textAlignLast:i,tabSize:i,wrapFlow:a,wrapThrough:a,wrapMargin:a,gridTemplateColumns:a,gridTemplateRows:a,gridTemplateAreas:a,gridTemplate:a,gridAutoColumns:a,gridAutoRows:a,gridAutoFlow:a,grid:a,gridRowStart:a,gridColumnStart:a,gridRowEnd:a,gridRow:a,gridColumn:a,gridColumnEnd:a,gridColumnGap:a,gridRowGap:a,gridArea:a,gridGap:a,textSizeAdjust:s,borderImage:r,borderImageOutset:r,borderImageRepeat:r,borderImageSlice:r,borderImageSource:r,borderImageWidth:r,transitionDelay:r,transitionDuration:r,transitionProperty:r,transitionTimingFunction:r}},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){if(t.hasOwnProperty(e))for(var r=t[e],i=0,o=r.length;i<o;++i)n[r[i]+(0,a.default)(e)]=n[e]};var r,i=n(290),a=(r=i)&&r.__esModule?r:{default:r};t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,r,i){for(var a=0,o=t.length;a<o;++a){var s=t[a](e,n,r,i);if(s)return s}},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("cursor"===t&&i.hasOwnProperty(e))return r.map((function(t){return t+e}))};var r=["-webkit-","-moz-",""],i={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"==typeof e&&!(0,a.default)(e)&&e.indexOf("cross-fade(")>-1)return o.map((function(t){return e.replace(/cross-fade\(/g,t+"cross-fade(")}))};var r,i=n(152),a=(r=i)&&r.__esModule?r:{default:r};var o=["-webkit-",""];t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"==typeof e&&!(0,a.default)(e)&&e.indexOf("filter(")>-1)return o.map((function(t){return e.replace(/filter\(/g,t+"filter(")}))};var r,i=n(152),a=(r=i)&&r.__esModule?r:{default:r};var o=["-webkit-",""];t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("display"===t&&r.hasOwnProperty(e))return r[e]};var r={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){"flexDirection"===t&&"string"==typeof e&&(e.indexOf("column")>-1?n.WebkitBoxOrient="vertical":n.WebkitBoxOrient="horizontal",e.indexOf("reverse")>-1?n.WebkitBoxDirection="reverse":n.WebkitBoxDirection="normal");i.hasOwnProperty(t)&&(n[i[t]]=r[e]||e)};var r={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},i={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"==typeof e&&!(0,a.default)(e)&&s.test(e))return o.map((function(t){return t+e}))};var r,i=n(152),a=(r=i)&&r.__esModule?r:{default:r};var o=["-webkit-","-moz-",""],s=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"==typeof e&&!(0,a.default)(e)&&e.indexOf("image-set(")>-1)return o.map((function(t){return e.replace(/image-set\(/g,t+"image-set(")}))};var r,i=n(152),a=(r=i)&&r.__esModule?r:{default:r};var o=["-webkit-",""];t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("position"===t&&"sticky"===e)return["-webkit-sticky","sticky"]},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(i.hasOwnProperty(t)&&a.hasOwnProperty(e))return r.map((function(t){return t+e}))};var r=["-webkit-","-moz-",""],i={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},a={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,o){if("string"==typeof e&&s.hasOwnProperty(t)){var c=function(t,e){if((0,i.default)(t))return t;for(var n=t.split(/,(?![^()]*(?:\([^()]*\))?\))/g),a=0,o=n.length;a<o;++a){var s=n[a],c=[s];for(var l in e){var d=(0,r.default)(l);if(s.indexOf(d)>-1&&"order"!==d)for(var f=e[l],h=0,p=f.length;h<p;++h)c.unshift(s.replace(d,u[f[h]]+d))}n[a]=c.join(",")}return n.join(",")}(e,o),l=c.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(t){return!/-moz-|-ms-/.test(t)})).join(",");if(t.indexOf("Webkit")>-1)return l;var d=c.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(t){return!/-webkit-|-ms-/.test(t)})).join(",");return t.indexOf("Moz")>-1?d:(n["Webkit"+(0,a.default)(t)]=l,n["Moz"+(0,a.default)(t)]=d,c)}};var r=o(n(425)),i=o(n(152)),a=o(n(290));function o(t){return t&&t.__esModule?t:{default:t}}var s={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},u={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return(0,a.default)(t)};var r,i=n(426),a=(r=i)&&r.__esModule?r:{default:r};t.exports=e.default},function(t,e,n){"use strict";n.r(e);var r=/[A-Z]/g,i=/^ms-/,a={};function o(t){return"-"+t.toLowerCase()}e.default=function(t){if(a.hasOwnProperty(t))return a[t];var e=t.replace(r,o);return a[t]=i.test(e)?"-"+e:e}},function(t,e,n){"use strict";function r(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)+(t.charCodeAt(e++)<<16)+(t.charCodeAt(e)<<24)}function i(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)}function a(t,e){return(65535&(t|=0))*(e|=0)+(((t>>>16)*e&65535)<<16)|0}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=1540483477,o=e^t.length,s=t.length,u=0;for(;s>=4;){var c=r(t,u);c=a(c,n),c=a(c^=c>>>24,n),o=a(o,n),o^=c,u+=4,s-=4}switch(s){case 3:o^=i(t,u),o=a(o^=t.charCodeAt(u+2)<<16,n);break;case 2:o=a(o^=i(t,u),n);break;case 1:o=a(o^=t.charCodeAt(u),n)}return o=a(o^=o>>>13,n),(o^=o>>>15)>>>0}},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});const r=n(225),i=n(151),a=n(429),o=n(430);class s extends r.Component{static render(t,e,n){return r.render(r.h(s,Object.assign({},n)),t,e)}constructor(t){super(t),this.surfaces=new Map;const e=null==t.startOpen||t.startOpen;this.state={isOpen:e,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(t,e){const n=this.surfaceId(t,e);let r;if(!this.surfaces.has(n))throw Error("Surface not found with id: "+n);return r=this.surfaces.get(n),{container:r.container,label:r.label,drawArea:r.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(t,e){return t+e}setTabs(t){const e=t.map(t=>t.tab),n=this.state.tabs;let r;for(const t of e)n.has(t)||(n.add(t),r=t);null!=r&&this.setState({tabs:n,activeTab:r})}getTabs(){return this.state.tabs}registerSurface(t,e,n){const r=this.surfaceId(t,e);this.surfaces.set(r,n)}keyHandler(t){192===t.keyCode&&(t.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(t){this.setState({activeTab:t})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(t){this.setTabs(t.surfaceList)}render(){const{isOpen:t,isFullscreen:e,activeTab:n}=this.state,{surfaceList:s}=this.props,c=Array.from(this.getTabs().values()),l=e?"90vw":"550px",d=i.css({width:l,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),f=i.css({right:"0"}),h=i.css({right:`calc(-${l} - 10px)`}),p=t?f:h,m=i.css({});return r.h("div",{className:`${d} ${p} visor`,"data-isopen":t,"data-isfullscreen":e},r.h(u,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:e}),r.h(o.Tabs,{tabNames:c,activeTab:n,handleClick:this.setActiveTab.bind(this)}),r.h("div",{className:m+" visor-surfaces"},s.map(t=>r.h(a.SurfaceComponent,{key:t.name+t.tab,name:t.name,tab:t.tab,styles:t.styles,registerSurface:this.registerSurface.bind(this),visible:n===t.tab}))))}}function u(t){const{isFullScreen:e,fullScreenHandler:n,closeHandler:a}=t,o=i.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),s=i.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),u=i.css({marginLeft:"auto"});return r.h("div",{className:o+" visor-controls"},r.h("button",{className:""+s,onClick:n},e?"Minimize":"Maximize"),r.h("button",{className:`${s} ${u}`,onClick:a},"Hide"))}e.VisorComponent=s},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});const r=n(225),i=n(151);class a extends r.Component{componentDidMount(){const{name:t,tab:e}=this.props;this.props.registerSurface(t,e,this)}componentDidUpdate(){return!1}render(){const{name:t,visible:e,styles:n}=this.props,o=Object.assign({},a.defaultStyles,n),{width:s,height:u}=o;let{maxHeight:c,maxWidth:l}=o;c=u===a.defaultStyles.height?c:u,l=s===a.defaultStyles.width?l:s;const d=i.css({display:e?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:u,width:s,maxHeight:c,maxWidth:l,overflow:"auto"}),f=i.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),h=i.css({boxSizing:"border-box"});return r.h("div",{className:d+" tf-surface",ref:t=>this.container=t,"data-visible":e},r.h("div",{className:f+" tf-label",ref:t=>this.label=t},t),r.h("div",{className:h+" tf-draw-area",ref:t=>this.drawArea=t}))}}a.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},e.SurfaceComponent=a},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});const r=n(225),i=n(151);class a extends r.Component{render(){const{tabNames:t,activeTab:e,handleClick:n}=this.props,a=t.length>0?t.map(t=>r.h(o,{key:t,id:t,handleClick:n,isActive:t===e},t)):null,s=i.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return r.h("div",{className:s+" visor-tabs"},a)}}e.Tabs=a;class o extends r.Component{render(){const{children:t,isActive:e,handleClick:n,id:a}=this.props,o=i.css({borderBottomColor:e?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return r.h("a",{className:o+" tf-tab","data-isactive":e,onClick:()=>n(a)},t)}}},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(n(121)),o=n(95),s=n(71);e.confusionMatrix=function(t,e,n={}){return r(this,void 0,void 0,(function*(){const r=Object.assign({},u,n),i=s.getDrawArea(t),c=[],l=e.values,d=e.tickLabels||[],f=0===d.length;let h=!0;for(let t=0;t<l.length;t++){const e=f?"Class "+t:d[t];f&&d.push(e);for(let n=0;n<l[t].length;n++){const i=f?"Class "+n:d[n],a=l[t][n];t!==n||r.shadeDiagonal?(c.push({label:e,prediction:i,count:a,scaleCount:a}),0!==a&&(h=!1)):c.push({label:e,prediction:i,count:a,noFill:!0})}}if(!r.shadeDiagonal&&h)for(const t of c)!0===t.noFill&&(t.noFill=!1,t.scaleCount=t.count);const p={width:r.width||o.getDefaultWidth(i),height:r.height||o.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize}},data:{values:c},encoding:{x:{field:"prediction",type:"ordinal",title:r.xLabel||"prediction",scale:{domain:d}},y:{field:"label",type:"ordinal",title:r.yLabel||"label",scale:{domain:d}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:r.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};!1===r.shadeDiagonal&&p.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),r.showTextOverlay&&p.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}});const m="string"==typeof r.colorMap?{scheme:r.colorMap}:r.colorMap;p.layer[0].encoding.color.scale.range=m,yield a.default(i,p,{actions:!1,mode:"vega-lite",defaultStyle:!1})}))};const u={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]}},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(n(227)),s=a(n(121)),u=n(95),c=n(170),l=n(71);function d(t,e,n){const r=t instanceof o.Tensor?t.shape:[t.length,t[0].length];0===n?c.assert(r[0]===e.length,`Length of xTickLabels (${e.length}) must match number of rows (${r[0]})`):1===n&&c.assert(r[1]===e.length,`Length of yTickLabels (${e.length}) must match number of columns (${r[1]})`)}e.heatmap=function(t,e,n={}){return r(this,void 0,void 0,(function*(){const i=Object.assign({},f,n),a=l.getDrawArea(t);let h=e.values;i.rowMajor&&(h=yield function(t){return r(this,void 0,void 0,(function*(){let e,n;t instanceof o.Tensor?(e=t.shape,n=t.transpose()):(e=[t.length,t[0].length],n=o.tidy(()=>o.tensor2d(t).transpose())),c.assert(2===n.rank,"Input to renderHeatmap must be a 2d array or Tensor2d");const r=yield n.array();n.dispose();const i=[r.length,r[0].length];return c.assert(e[0]===i[1]&&e[1]===i[0],`Unexpected transposed shape. Original ${e} : Transposed ${i}`),r}))}(e.values));const{xTickLabels:p,yTickLabels:m}=e;if(null!=p){d(h,p,0)}if(null!=m){d(h,m,1)}const g=[];if(h instanceof o.Tensor){c.assert(2===h.rank,"Input to renderHeatmap must be a 2d array or Tensor2d");const t=yield h.data(),[e,n]=h.shape;for(let r=0;r<e;r++){const e=p?`${p[r]}@tfidx@${r}`:r;for(let i=0;i<n;i++){const a=m?`${m[i]}@tfidx@${i}`:i,o=t[r*n+i];g.push({x:e,y:a,value:o})}}}else{const t=h;for(let e=0;e<t.length;e++){const n=p?`${p[e]}@tfidx@${e}`:e;for(let r=0;r<t[e].length;r++){const i=m?`${m[r]}@tfidx@${r}`:r,a=t[e][r];g.push({x:n,y:i,value:a})}}}const b={actions:!1,mode:"vega-lite",defaultStyle:!1},y={width:i.width||u.getDefaultWidth(a),height:i.height||u.getDefaultHeight(a),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:g},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:i.xType,title:i.xLabel,sort:"x"},y:{field:"y",type:i.yType,title:i.yLabel,sort:"y"},fill:{field:"value",type:"quantitative"}}},v=new RegExp("@tfidx@\\d+$");let x;switch(p&&(y.encoding.x.axis={labelExpr:"replace(datum.value, regexp(/@tfidx@\\d+$/), '')"}),m&&(y.encoding.y.axis={labelExpr:"replace(datum.value, regexp(/@tfidx@\\d+$/), '')"}),(p||m)&&(b.tooltip={sanitize:t=>String(t).replace(v,"")}),i.colorMap){case"blues":x=["#f7fbff","#4292c6"];break;case"greyscale":x=["#000000","#ffffff"];break;case"viridis":default:x="viridis"}if("viridis"!==x){y.encoding.fill.scale={range:x}}if(i.domain){const t=y.encoding.fill;null!=t.scale?t.scale=Object.assign({},t.scale,{domain:i.domain}):t.scale={domain:i.domain}}yield s.default(a,y,b)}))};const f={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1}},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(n(121)),o=n(95),s=n(170),u=n(71);e.scatterplot=function(t,e,n={}){return r(this,void 0,void 0,(function*(){let r=e.values;const i=null==e.series?[]:e.series;r=Array.isArray(r[0])?r:[r];const l=[];r.forEach((t,e)=>{const n=null!=i[e]?i[e]:"Series "+(e+1),r=t.map(t=>Object.assign({},t,{series:n}));l.push(...r)}),null!=n.seriesColors&&s.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const d=u.getDrawArea(t),f=Object.assign({},c,n),h={width:f.width||o.getDefaultWidth(d),height:f.height||o.getDefaultHeight(d),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:f.fontSize,titleFontSize:f.fontSize},text:{fontSize:f.fontSize},legend:{labelFontSize:f.fontSize,titleFontSize:f.fontSize}},data:{values:l},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:f.xType,title:f.xLabel,scale:f.zoomToFit?{zero:!1}:null!=f.xAxisDomain?{domain:f.xAxisDomain}:void 0},y:{field:"y",type:f.yType,title:f.yLabel,scale:f.zoomToFit?{zero:!1}:null!=f.yAxisDomain?{domain:f.yAxisDomain}:void 0},color:{field:"series",type:"nominal",scale:{range:f.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield a.default(d,h,{actions:!1,mode:"vega-lite",defaultStyle:!1}),Promise.resolve()}))};const c={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(293),a=n(71),o=n(95);function s(t,e,n,s={}){return r(this,void 0,void 0,(function*(){const r=a.getDrawArea(t),l={};for(const t of n)if(/val_/.test(t)){const r=t.replace("val_","");u(l,r);const i=c(e,t,n.indexOf(t));l[r].series.push(t),l[r].values.push(i)}else{const r=c(e,t,n.indexOf(t));u(l,t),l[t].series.push(t),l[t].values.push(r)}const d=Object.keys(l),f=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},s),h=[];for(const t of d){const e=o.subSurface(r,t),n=l[t].series,a=l[t].values;n.every(t=>Boolean(t.match("acc")))&&(f.zoomToFitAccuracy?f.zoomToFit=!0:(f.yAxisDomain=[0,1],delete f.zoomToFit));const s=i.linechart(e,{values:a,series:n},f);h.push(s)}yield Promise.all(h)}))}function u(t,e){null==t[e]&&(t[e]={series:[],values:[]})}function c(t,e,n){if(Array.isArray(t)){const r=Array.isArray(t[0])?t[n]:t,i=[];for(let t=0;t<r.length;t++){const n=r[t];i.push({x:t,y:n[e]})}return i}return t.history[e].map((t,e)=>({x:e,y:t}))}function l(t,e,n){return null==t[e]&&(t[e]={}),null==t[e][n]&&(t[e][n]=[]),t[e][n]}e.history=s,e.fitCallbacks=function(t,e,n={}){const i={},u=n.callbacks||["onEpochEnd","onBatchEnd"],c=a.getDrawArea(t),d=Object.assign({},n);delete d.callbacks;const f={};return u.forEach(t=>{f[t]=function(t){return(n,u)=>r(this,void 0,void 0,(function*(){/batch/i.test(t)?d.xLabel="Batch":/epoch/i.test(t)&&(d.xLabel="Epoch");const n=[],r=[];for(const a of e)if(null!=u[a]){r.push(a);const e=l(i,t,a);e.push({[a]:u[a]}),n.push(e)}s(o.subSurface(c,t,{title:t}),n,r,d),yield a.nextFrame()}))}(t)}),f}},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(226),a=n(71),o=n(172),s=n(95),u=n(171);function c(t){let e;if(Array.isArray(t.outputShape[0])){e=`[${t.outputShape.map(t=>l(t)).join(", ")}]`}else e=l(t.outputShape);return{name:t.name,trainable:t.trainable,parameters:t.countParams(),outputShape:e}}function l(t){const e=t.slice();return 0===e.length?"Scalar":(null===e[0]&&(e[0]="batch"),`[${e.join(",")}]`)}e.modelSummary=function(t,e){return r(this,void 0,void 0,(function*(){const n=a.getDrawArea(t),r=function(t){return{layers:t.layers.map(c)}}(e).layers.map(t=>[t.name,t.outputShape,t.parameters,t.trainable]);o.table(n,{headers:["Layer Name","Output Shape","# Of Params","Trainable"],values:r})}))},e.layer=function(t,e){return r(this,void 0,void 0,(function*(){const n=a.getDrawArea(t),c=yield function(t){return r(this,void 0,void 0,(function*(){const e=t.getWeights(),n=t.weights,r=e.map(u.tensorStats),i=yield Promise.all(r),a=e.map(t=>t.shape);return e.map((t,e)=>({name:n[e].name,stats:i[e],shape:l(a[e]),weight:t}))}))}(e),d=s.subSurface(n,"layer-weights-info"),f=c.map(t=>[t.name,t.shape,t.stats.min,t.stats.max,t.weight.size,t.stats.numZeros,t.stats.numNans,t.stats.numInfs]);o.table(d,{headers:["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],values:f});const h=s.subSurface(n,"select-layer"),p=s.subSurface(n,"param-distribution");!function(t,e,n){const r=`\n    <select>\n      ${t.map(t=>`<option value=${t}>${t}</option>`)}\n    </select>\n  `,i=`<div><button>Show Values Distribution for:</button>${r}</div>`;e.innerHTML=i;const a=e.querySelector("button"),o=e.querySelector("select");a.addEventListener("click",()=>{n(o.selectedOptions[0].label)})}(c.map(t=>t.name),h,t=>r(this,void 0,void 0,(function*(){const e=c.filter(e=>e.name===t)[0],n=yield e.weight.data();i.histogram(p,n,{height:150,width:460,stats:!1})})))}))}},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(71),a=n(172);e.showPerClassAccuracy=function(t,e,n){return r(this,void 0,void 0,(function*(){const r=i.getDrawArea(t),o=[];for(let t=0;t<e.length;t++){const r=n?n[t]:t.toString(),i=e[t];o.push([r,i.accuracy,i.count])}return a.table(r,{headers:["Class","Accuracy","# Samples"],values:o})}))}},function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(226),a=n(71),o=n(171);e.valuesDistribution=function(t,e){return r(this,void 0,void 0,(function*(){const n=a.getDrawArea(t),r=yield o.tensorStats(e),s=yield e.data();i.histogram(n,s,{height:150,stats:r})}))}},function(t,e,n){"use strict";
/** @license See the LICENSE file. */Object.defineProperty(e,"__esModule",{value:!0});e.version="1.4.3"},function(t,e,n){"use strict";n.r(e);var r="http://www.w3.org/1999/xhtml",i={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},a=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),i.hasOwnProperty(e)?{space:i[e],local:t}:t};function o(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===r&&e.documentElement.namespaceURI===r?e.createElement(t):e.createElementNS(n,t)}}function s(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var u=function(t){var e=a(t);return(e.local?s:o)(e)};function c(){}var l=function(t){return null==t?c:function(){return this.querySelector(t)}};function d(){return[]}var f=function(t){return null==t?d:function(){return this.querySelectorAll(t)}},h=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var p=document.documentElement;if(!p.matches){var m=p.webkitMatchesSelector||p.msMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector;h=function(t){return function(){return m.call(this,t)}}}}var g=h,b=function(t){return new Array(t.length)};function y(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}y.prototype={constructor:y,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function v(t,e,n,r,i,a){for(var o,s=0,u=e.length,c=a.length;s<c;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new y(t,a[s]);for(;s<u;++s)(o=e[s])&&(i[s]=o)}function x(t,e,n,r,i,a,o){var s,u,c,l={},d=e.length,f=a.length,h=new Array(d);for(s=0;s<d;++s)(u=e[s])&&(h[s]=c="$"+o.call(u,u.__data__,s,e),c in l?i[s]=u:l[c]=u);for(s=0;s<f;++s)(u=l[c="$"+o.call(t,a[s],s,a)])?(r[s]=u,u.__data__=a[s],l[c]=null):n[s]=new y(t,a[s]);for(s=0;s<d;++s)(u=e[s])&&l[h[s]]===u&&(i[s]=u)}function w(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function k(t){return function(){this.removeAttribute(t)}}function O(t){return function(){this.removeAttributeNS(t.space,t.local)}}function _(t,e){return function(){this.setAttribute(t,e)}}function A(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function C(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function E(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var S=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function j(t){return function(){this.style.removeProperty(t)}}function N(t,e,n){return function(){this.style.setProperty(t,e,n)}}function T(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function F(t,e){return t.style.getPropertyValue(e)||S(t).getComputedStyle(t,null).getPropertyValue(e)}function D(t){return function(){delete this[t]}}function I(t,e){return function(){this[t]=e}}function M(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function $(t){return t.trim().split(/^|\s+/)}function R(t){return t.classList||new B(t)}function B(t){this._node=t,this._names=$(t.getAttribute("class")||"")}function z(t,e){for(var n=R(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function L(t,e){for(var n=R(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function P(t){return function(){z(this,t)}}function q(t){return function(){L(this,t)}}function W(t,e){return function(){(e.apply(this,arguments)?z:L)(this,t)}}B.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function U(){this.textContent=""}function V(t){return function(){this.textContent=t}}function G(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function H(){this.innerHTML=""}function X(t){return function(){this.innerHTML=t}}function K(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Y(){this.nextSibling&&this.parentNode.appendChild(this)}function J(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Z(){return null}function Q(){var t=this.parentNode;t&&t.removeChild(this)}function tt(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function et(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}var nt={},rt=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(nt={mouseenter:"mouseover",mouseleave:"mouseout"}));function it(t,e,n){return t=at(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function at(t,e,n){return function(r){var i=rt;rt=r;try{t.call(this,this.__data__,e,n)}finally{rt=i}}}function ot(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function st(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function ut(t,e,n){var r=nt.hasOwnProperty(t.type)?it:at;return function(i,a,o){var s,u=this.__on,c=r(e,a,o);if(u)for(var l=0,d=u.length;l<d;++l)if((s=u[l]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=c,s.capture=n),void(s.value=e);this.addEventListener(t.type,c,n),s={type:t.type,name:t.name,value:e,listener:c,capture:n},u?u.push(s):this.__on=[s]}}function ct(t,e,n,r){var i=rt;t.sourceEvent=rt,rt=t;try{return e.apply(n,r)}finally{rt=i}}function lt(t,e,n){var r=S(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function dt(t,e){return function(){return lt(this,t,e)}}function ft(t,e){return function(){return lt(this,t,e.apply(this,arguments))}}var ht=[null];function pt(t,e){this._groups=t,this._parents=e}function mt(){return new pt([[document.documentElement]],ht)}pt.prototype=mt.prototype={constructor:pt,select:function(t){"function"!=typeof t&&(t=l(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=e[i],u=s.length,c=r[i]=new Array(u),d=0;d<u;++d)(a=s[d])&&(o=t.call(a,a.__data__,d,s))&&("__data__"in a&&(o.__data__=a.__data__),c[d]=o);return new pt(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=f(t));for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o,s=e[a],u=s.length,c=0;c<u;++c)(o=s[c])&&(r.push(t.call(o,o.__data__,c,s)),i.push(o));return new pt(r,i)},filter:function(t){"function"!=typeof t&&(t=g(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,u=r[i]=[],c=0;c<s;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&u.push(a);return new pt(r,this._parents)},data:function(t,e){if(!t)return p=new Array(this.size()),l=-1,this.each((function(t){p[++l]=t})),p;var n,r=e?x:v,i=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=a.length,s=new Array(o),u=new Array(o),c=new Array(o),l=0;l<o;++l){var d=i[l],f=a[l],h=f.length,p=t.call(d,d&&d.__data__,l,i),m=p.length,g=u[l]=new Array(m),b=s[l]=new Array(m);r(d,f,g,b,c[l]=new Array(h),p,e);for(var y,w,k=0,O=0;k<m;++k)if(y=g[k]){for(k>=O&&(O=k+1);!(w=b[O])&&++O<m;);y._next=w||null}}return(s=new pt(s,i))._enter=u,s._exit=c,s},enter:function(){return new pt(this._enter||this._groups.map(b),this._parents)},exit:function(){return new pt(this._exit||this._groups.map(b),this._parents)},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var u,c=e[s],l=n[s],d=c.length,f=o[s]=new Array(d),h=0;h<d;++h)(u=c[h]||l[h])&&(f[h]=u);for(;s<r;++s)o[s]=e[s];return new pt(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=w);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],u=s.length,c=i[a]=new Array(u),l=0;l<u;++l)(o=s[l])&&(c[l]=o);c.sort(e)}return new pt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,s=a.length;o<s;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=a(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?O:k:"function"==typeof e?n.local?E:C:n.local?A:_)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?j:"function"==typeof e?T:N)(t,e,null==n?"":n)):F(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?D:"function"==typeof e?M:I)(t,e)):this.node()[t]},classed:function(t,e){var n=$(t+"");if(arguments.length<2){for(var r=R(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?W:e?P:q)(n,e))},text:function(t){return arguments.length?this.each(null==t?U:("function"==typeof t?G:V)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?H:("function"==typeof t?K:X)(t)):this.node().innerHTML},raise:function(){return this.each(Y)},lower:function(){return this.each(J)},append:function(t){var e="function"==typeof t?t:u(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:u(t),r=null==e?Z:"function"==typeof e?e:l(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Q)},clone:function(t){return this.select(t?et:tt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=ot(t+""),o=a.length;if(!(arguments.length<2)){for(s=e?ut:st,null==n&&(n=!1),r=0;r<o;++r)this.each(s(a[r],e,n));return this}var s=this.node().__on;if(s)for(var u,c=0,l=s.length;c<l;++c)for(r=0,u=s[c];r<o;++r)if((i=a[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(t,e){return this.each(("function"==typeof e?ft:dt)(t,e))}};var gt=mt,bt=function(t){return"string"==typeof t?new pt([[document.querySelector(t)]],[document.documentElement]):new pt([[t]],ht)},yt=function(t){return bt(u(t).call(document.documentElement))},vt=0;function xt(){return new wt}function wt(){this._="@"+(++vt).toString(36)}wt.prototype=xt.prototype={constructor:wt,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var kt=function(){for(var t,e=rt;t=e.sourceEvent;)e=t;return e},Ot=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]},_t=function(t){var e=kt();return e.changedTouches&&(e=e.changedTouches[0]),Ot(t,e)},At=function(t){return"string"==typeof t?new pt([document.querySelectorAll(t)],[document.documentElement]):new pt([null==t?[]:t],ht)},Ct=function(t,e,n){arguments.length<3&&(n=e,e=kt().changedTouches);for(var r,i=0,a=e?e.length:0;i<a;++i)if((r=e[i]).identifier===n)return Ot(t,r);return null},Et=function(t,e){null==e&&(e=kt().touches);for(var n=0,r=e?e.length:0,i=new Array(r);n<r;++n)i[n]=Ot(t,e[n]);return i};n.d(e,"create",(function(){return yt})),n.d(e,"creator",(function(){return u})),n.d(e,"local",(function(){return xt})),n.d(e,"matcher",(function(){return g})),n.d(e,"mouse",(function(){return _t})),n.d(e,"namespace",(function(){return a})),n.d(e,"namespaces",(function(){return i})),n.d(e,"clientPoint",(function(){return Ot})),n.d(e,"select",(function(){return bt})),n.d(e,"selectAll",(function(){return At})),n.d(e,"selection",(function(){return gt})),n.d(e,"selector",(function(){return l})),n.d(e,"selectorAll",(function(){return f})),n.d(e,"style",(function(){return F})),n.d(e,"touch",(function(){return Ct})),n.d(e,"touches",(function(){return Et})),n.d(e,"window",(function(){return S})),n.d(e,"event",(function(){return rt})),n.d(e,"customEvent",(function(){return ct}))},function(t,e,n){"use strict";var r={},i={};function a(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function o(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function s(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function u(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+s(-e,6):e>9999?"+"+s(e,6):s(e,4))+"-"+s(t.getUTCMonth()+1,2)+"-"+s(t.getUTCDate(),2)+(a?"T"+s(n,2)+":"+s(r,2)+":"+s(i,2)+"."+s(a,3)+"Z":i?"T"+s(n,2)+":"+s(r,2)+":"+s(i,2)+"Z":r||n?"T"+s(n,2)+":"+s(r,2)+"Z":"")}e.a=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function s(t,e){var a,o=[],s=t.length,u=0,c=0,l=s<=0,d=!1;function f(){if(l)return i;if(d)return d=!1,r;var e,a,o=u;if(34===t.charCodeAt(o)){for(;u++<s&&34!==t.charCodeAt(u)||34===t.charCodeAt(++u););return(e=u)>=s?l=!0:10===(a=t.charCodeAt(u++))?d=!0:13===a&&(d=!0,10===t.charCodeAt(u)&&++u),t.slice(o+1,e-1).replace(/""/g,'"')}for(;u<s;){if(10===(a=t.charCodeAt(e=u++)))d=!0;else if(13===a)d=!0,10===t.charCodeAt(u)&&++u;else if(a!==n)continue;return t.slice(o,e)}return l=!0,t.slice(o,s)}for(10===t.charCodeAt(s-1)&&--s,13===t.charCodeAt(s-1)&&--s;(a=f())!==i;){for(var h=[];a!==r&&a!==i;)h.push(a),a=f();e&&null==(h=e(h,c++))||o.push(h)}return o}function c(e,n){return e.map((function(e){return n.map((function(t){return d(e[t])})).join(t)}))}function l(e){return e.map(d).join(t)}function d(t){return null==t?"":t instanceof Date?u(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,r,i=s(t,(function(t,i){if(n)return n(t,i-1);r=t,n=e?function(t,e){var n=a(t);return function(r,i){return e(n(r),i,t)}}(t,e):a(t)}));return i.columns=r||[],i},parseRows:s,format:function(e,n){return null==n&&(n=o(e)),[n.map(d).join(t)].concat(c(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=o(t)),c(t,e).join("\n")},formatRows:function(t){return t.map(l).join("\n")},formatRow:l,formatValue:d}}},,,,,,,,function(t,e,n){"use strict";var r=n(30),i=Object(r.a)((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()}));e.a=i;i.range},function(t,e,n){"use strict";var r=n(30),i=n(32),a=Object(r.a)((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*i.d-t.getMinutes()*i.c)}),(function(t,e){t.setTime(+t+e*i.b)}),(function(t,e){return(e-t)/i.b}),(function(t){return t.getHours()}));e.a=a;a.range},function(t,e,n){"use strict";var r=n(30),i=n(32),a=Object(r.a)((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*i.d)}),(function(t,e){t.setTime(+t+e*i.c)}),(function(t,e){return(e-t)/i.c}),(function(t){return t.getMinutes()}));e.a=a;a.range},function(t,e,n){"use strict";var r=n(30),i=n(32),a=Object(r.a)((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*i.d)}),(function(t,e){return(e-t)/i.d}),(function(t){return t.getUTCSeconds()}));e.a=a;a.range},function(t,e,n){"use strict";var r=n(30),i=Object(r.a)((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Object(r.a)((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):i:null},e.a=i;i.range},function(t,e,n){"use strict";var r=n(30),i=Object(r.a)((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()}));e.a=i;i.range},function(t,e,n){"use strict";var r=n(30),i=n(32),a=Object(r.a)((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*i.b)}),(function(t,e){return(e-t)/i.b}),(function(t){return t.getUTCHours()}));e.a=a;a.range},function(t,e,n){"use strict";var r=n(30),i=n(32),a=Object(r.a)((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*i.c)}),(function(t,e){return(e-t)/i.c}),(function(t){return t.getUTCMinutes()}));e.a=a;a.range},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return s}));var r=Math.sqrt(50),i=Math.sqrt(10),a=Math.sqrt(2);function o(t,e,n){var o=(e-t)/Math.max(0,n),s=Math.floor(Math.log(o)/Math.LN10),u=o/Math.pow(10,s);return s>=0?(u>=r?10:u>=i?5:u>=a?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(u>=r?10:u>=i?5:u>=a?2:1)}function s(t,e,n){var o=Math.abs(e-t)/Math.max(0,n),s=Math.pow(10,Math.floor(Math.log(o)/Math.LN10)),u=o/s;return u>=r?s*=10:u>=i?s*=5:u>=a&&(s*=2),e<t?-s:s}e.a=function(t,e,n){var r,i,a,s,u=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(s=o(t,e,n))||!isFinite(s))return[];if(s>0)for(t=Math.ceil(t/s),e=Math.floor(e/s),a=new Array(i=Math.ceil(e-t+1));++u<i;)a[u]=(t+u)*s;else for(s=-s,t=Math.ceil(t*s),e=Math.floor(e*s),a=new Array(i=Math.ceil(e-t+1));++u<i;)a[u]=(t+u)/s;return r&&a.reverse(),a}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return s}));var r,i,a,o,s,u,c=n(315);u={dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},r=Object(c.a)(u),i=r.format,a=r.parse,o=r.utcFormat,s=r.utcParse}]);